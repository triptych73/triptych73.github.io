{"version":3,"file":"main.nodejs.js","mappings":"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IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,EAAM,IAAM,GAAM,IAAM,GAAM,IAAM,EAAM,IAAM,EAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,EAAM,IAAM,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,EAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,GAAM,IAAM,EAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,EAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,EAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,EAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAC//Co6B,EAAI,CAAC,GAAM,EAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,EAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,EAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,EAAM,IAAM,IAAM,GAAM,EAAM,IAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,EAAM,IAAM,IAAM,IAAM,EAAM,EAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,IAAM,GAAM,IAAM,EAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,GAAM,IAAM,GAAM,IAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,GAAM,IAAM,GAAM,GAAM,GAAM,EAAM,IAAM,IAAM,IAAM,IAAM,GAAM,IAAM,IAAM,GAAM,GAAM,GAAM,GAAM,GAAM,KAG//CC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,EAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,EAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,SAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,EAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,EAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAG1/FC,EAAK,CAAC,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,EAAY,UAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,EAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,SAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,SAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,EAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,WAAY,SAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,SAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,EAAY,WAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,UAAY,WAAY,YAG1/F9I,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/F8I,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,SAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,SAAY,UAAY,UAAY,WAAY,UAAY,UAAY,UAAY,UAAY,SAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,YAC1/FC,EAAK,CAAC,EAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,WAAY,UAAY,UAAY,UAAY,UAAY,UAAY,UA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AO,IAAA8vD,cAAa,CAAC,EAAG,GAAI,CAACthE,KAAKghE,WAAYhhE,KAAK2nE,WACrD,EAnBF,0BACS,EAAAnoB,MAAQ,yBCDjB,SAASo0F,EAAyBtlF,GACjC,OAAOA,GAAKA,EAAE2G,YAAc/nD,OAAOC,UAAUC,eAAeC,KAAKihD,EAAG,WAAaA,EAAW,QAAIA,CACjG,CAEA,MAAMulF,EAAY,IAAIl6B,WAAW,CAC/B,EACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,SACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,SACA,WACA,WACA,WACA,SACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,WACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WACA,WACA,WACA,UACA,WAC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","sources":["../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/lib/util.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/internal/meta.js","../../../external/werift/packages/common/src/binary.ts","../../../external/werift/packages/dtls/src/cipher/prf.ts","../../../external/werift/packages/rtp/src/rtp/rtx.ts","../../../external/werift/packages/rtp/src/srtp/context/context.ts","../external node-commonjs \"buffer\"","../../../external/werift/node_modules/fast-deep-equal/index.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/when.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/numbers.js","../../../external/werift/packages/dtls/src/flight/client/flight1.ts","../../../external/werift/node_modules/debug/src/node.js","../../../common/src/rtsp-server.ts","../../../external/werift/packages/dtls/src/index.ts","../../../external/werift/packages/ice/src/ice.ts","../../../external/werift/node_modules/@fidm/x509/build/x509.js","../../../external/werift/node_modules/@leichtgewicht/ip-codec/index.cjs","../../../external/werift/packages/webrtc/src/sctpManager.ts","../../../sdk/dist/src|sync","../src/main.ts","../src/werift-signaling-session.ts","../../../external/werift/packages/dtls/src/flight/server/flight6.ts","../../../server/src/promise-utils.ts","../src/rtp-forwarders.ts","../../../external/werift/packages/rtp/src/rtp/red/handler.ts","../../../external/werift/packages/ice/src/turn/protocol.ts","../../../external/werift/packages/dtls/src/handshake/message/server/keyExchange.ts","../../../external/werift/packages/dtls/src/socket.ts","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/reserved.js","../../../external/werift/packages/dtls/src/cipher/namedCurve.ts","../../../external/werift/packages/common/src/log.ts","../../../external/werift/packages/dtls/src/handshake/message/finished.ts","../../../external/werift/packages/ice/src/utils.ts","../../../external/werift/packages/webrtc/src/media/extension/rtpExtension.ts","../../../external/werift/node_modules/@noble/hashes/hmac.js","../external node-commonjs \"os\"","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/lib/binary-stream.js","../../../external/werift/node_modules/is-property/is-property.js","../external node-commonjs \"process\"","../../../external/werift/packages/rtp/src/imports/common.ts","../src/webrtc-required-codecs.ts","../../../external/werift/packages/dtls/src/handshake/extensions/useSrtp.ts","../../../external/werift/packages/rtp/src/srtp/cipher/gcm.ts","../../../external/werift/packages/rtp/src/rtp/rtp.ts","../../../external/werift/packages/sctp/src/chunk.ts","../../../external/werift/packages/ice/src/helper.ts","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/lib/encoding-length.js","../../../external/werift/packages/dtls/src/context/srtp.ts","../../../external/werift/packages/dtls/src/flight/server/flight2.ts","../../../common/src/ffmpeg-helpers.ts","../../../external/werift/node_modules/@fidm/x509/build/pki.js","../../../sdk/dist/src/storage-settings.js","../../../external/werift/packages/dtls/src/cipher/ec.ts","../../../external/werift/packages/dtls/src/record/receive.ts","../../../external/werift/node_modules/@noble/curves/abstract/curve.js","../../../external/werift/packages/webrtc/src/imports/dtls.ts","../../../external/werift/packages/dtls/src/record/message/plaintext.ts","../../../external/werift/node_modules/@noble/hashes/utils.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/lib/encode.js","../../../external/werift/packages/rtp/src/rtcp/rtpfb/nack.ts","../../../external/werift/node_modules/is-plain-object/index.js","../src/ice-servers.ts","../../../external/werift/packages/sctp/src/index.ts","../../../common/src/settings-mixin.ts","../src/webrtc-camera.ts","../../../external/werift/packages/rtp/src/rtp/red/encoder.ts","../../../external/werift/packages/dtls/src/flight/client/flight5.ts","../../../external/werift/node_modules/turbo-crc32/src/create-table.js","../external node-commonjs \"tty\"","../../../external/werift/packages/ice/src/candidate.ts","../../../external/werift/packages/rtp/src/srtp/cipher/index.ts","../external node-commonjs \"stream\"","../../../external/werift/packages/webrtc/src/imports/ice.ts","../../../common/node_modules/http-auth-utils/dist/utils.js","../../../external/werift/packages/ice/src/imports/common.ts","../../../external/werift/packages/ice/src/exceptions.ts","../../../external/werift/packages/rtp/src/rtcp/rtpfb/twcc.ts","../../../server/src/rpc-buffer-serializer.ts","../../../common/src/zygote.ts","../../../external/werift/packages/ice/src/stun/transaction.ts","../../../external/werift/packages/dtls/src/handshake/message/client/certificateVerify.ts","../../../external/werift/packages/rtp/src/codec/vp9.ts","../../../external/werift/packages/dtls/src/flight/client/flight3.ts","../../../external/werift/packages/dtls/src/handshake/extensions/ellipticCurves.ts","../../../sdk/dist/src/index.js","../../../external/werift/packages/ice/src/dns/lookup.ts","../../../external/werift/node_modules/@noble/curves/_shortw_utils.js","../../../external/werift/node_modules/has-flag/index.js","../../../external/werift/node_modules/debug/src/common.js","../../../external/werift/packages/dtls/src/record/message/header.ts","../../../common/src/autoenable-mixin-provider.ts","../../../external/werift/packages/rtp/src/rtcp/sr.ts","../../../external/werift/node_modules/@noble/hashes/_md.js","../external node-commonjs \"perf_hooks\"","../../../server/src/media-helpers.ts","../../../external/werift/packages/dtls/src/handshake/message/certificate.ts","../../../external/werift/node_modules/thunky/index.js","../../../external/werift/packages/rtp/src/rtcp/rtpfb/index.ts","../../../external/werift/packages/webrtc/src/media/sender/senderBWE.ts","../node_modules/ip/lib/ip.js","../../../external/werift/node_modules/debug/src/browser.js","../../homekit/src/types/camera/h264-packetizer.ts","../../../external/werift/node_modules/@noble/curves/abstract/hash-to-curve.js","../../../external/werift/packages/dtls/src/flight/server/flight4.ts","../../../external/werift/packages/dtls/src/imports/rtp.ts","../../../external/werift/packages/dtls/src/flight/flight.ts","../../../external/werift/packages/dtls/src/handshake/binary.ts","../../../server/src/deferred.ts","../../../common/src/rtc-signaling.ts","../external node-commonjs \"module\"","../src/werift.ts","../../../external/werift/packages/rtp/src/srtp/context/srtcp.ts","../../homekit/src/types/camera/jitter-buffer.ts","../../../external/werift/packages/sctp/src/helper.ts","../../../common/src/listen-cluster.ts","../../../external/werift/packages/webrtc/src/media/track.ts","../../../external/werift/node_modules/reflect-metadata/Reflect.js","../../../common/src/media-helpers.ts","../../../external/werift/packages/rtp/src/codec/h264.ts","../../../external/werift/packages/rtp/src/rtcp/psfb/index.ts","../src/h265-packetizer.ts","../../../external/werift/packages/webrtc/src/media/rtpTransceiver.ts","../../../external/werift/packages/common/src/promise.ts","../../../external/werift/packages/webrtc/src/transport/ice.ts","../../../external/werift/node_modules/@noble/curves/abstract/utils.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/select.js","../../../external/werift/node_modules/ip/lib/ip.js","../../../external/werift/node_modules/@noble/curves/p256.js","../../../external/werift/packages/dtls/src/handshake/message/alert.ts","../../../external/werift/packages/dtls/src/helper.ts","../../../external/werift/packages/webrtc/src/media/rtpSender.ts","../../../external/werift/packages/dtls/src/cipher/const.ts","../../../external/werift/packages/rtp/src/rtcp/header.ts","../../../external/werift/packages/ice/src/stun/attributes.ts","../../../external/werift/packages/webrtc/src/sdp.ts","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/array.js","../../../external/werift/packages/rtp/src/codec/base.ts","../../../external/werift/packages/sctp/src/imports/common.ts","../external node-commonjs \"events\"","../../../external/werift/packages/rtp/src/codec/opus.ts","../../../external/werift/node_modules/tweetnacl/nacl-fast.js","../../../external/werift/packages/webrtc/src/media/stats.ts","../../../external/werift/packages/webrtc/src/media/parameters.ts","../../../server/src/sleep.ts","../../../external/werift/node_modules/debug/src/index.js","../../../external/werift/node_modules/@noble/hashes/cryptoNode.js","../../../external/werift/packages/ice/src/stun/const.ts","../../../external/werift/node_modules/@shinyoshiaki/jspack/jspack.js","../external node-commonjs \"tls\"","../../../external/werift/packages/rtp/src/index.ts","../src/peerconnection-util.ts","../src/werift-util.ts","../../../external/werift/packages/rtp/src/helper.ts","../../../common/src/sdp-utils.ts","../../../external/werift/node_modules/@fidm/asn1/build/pem.js","../../../external/werift/packages/dtls/src/handshake/message/client/hello.ts","../../../server/src/rpc-serializer.ts","../../../external/werift/packages/rtp/src/srtp/context/srtp.ts","../../../external/werift/packages/dtls/src/imports/common.ts","../../../external/werift/node_modules/dns-packet/classes.js","../external node-commonjs \"child_process\"","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/string.js","../../../external/werift/packages/rtp/src/rtcp/psfb/fullIntraRequest.ts","../../../external/werift/node_modules/@fidm/x509/build/index.js","../../../external/werift/packages/rtp/src/rtcp/rtpfb/const.ts","../../../external/werift/packages/webrtc/src/imports/common.ts","../../../common/src/async-queue.ts","../../../external/werift/packages/webrtc/src/transport/dtls.ts","../../../external/werift/packages/webrtc/src/media/receiver/nack.ts","../../../external/werift/node_modules/int64-buffer/int64-buffer.js","../../../external/werift/node_modules/@noble/curves/abstract/modular.js","../../../external/werift/node_modules/@noble/hashes/_assert.js","../../../external/werift/packages/rtp/src/rtcp/rr.ts","../../../external/werift/packages/webrtc/src/types/domain.ts","../../../external/werift/node_modules/@fidm/asn1/build/common.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/buffer.js","../../../external/werift/packages/common/src/event.ts","../../../external/werift/packages/dtls/src/record/const.ts","../../../external/werift/packages/dtls/src/handshake/extensions/extendedMasterSecret.ts","../../../external/werift/packages/dtls/src/cipher/suites/aead.ts","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/internal/symbols.js","../../../external/werift/packages/rtp/src/srtp/const.ts","../../../external/werift/packages/dtls/src/cipher/create.ts","../src/wrtc-to-rtsp.ts","../../../external/werift/packages/webrtc/src/imports/rtp.ts","../../../external/werift/packages/webrtc/src/secureTransportManager.ts","../../../external/werift/packages/webrtc/src/media/index.ts","../../../external/werift/packages/dtls/src/record/builder.ts","../../../external/werift/packages/dtls/src/handshake/extensions/renegotiationIndication.ts","../../../external/werift/node_modules/turbo-crc32/crc32c.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/index.js","../../../external/werift/node_modules/turbo-crc32/src/crc32-by-1.js","../../../external/werift/packages/webrtc/src/const.ts","../external node-commonjs \"timers/promises\"","../../../external/werift/packages/dtls/src/handshake/message/server/certificateRequest.ts","../../../external/werift/node_modules/@noble/curves/abstract/weierstrass.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/internal/linked-list.js","../../../external/werift/packages/rtp/src/srtp/session.ts","../../../external/werift/packages/rtp/src/codec/index.ts","../../../external/werift/node_modules/generate-function/index.js","../../../external/werift/packages/webrtc/src/transport/sctp.ts","../../../external/werift/packages/rtp/src/rtcp/sdes.ts","../external node-commonjs \"crypto\"","../../../external/werift/packages/webrtc/src/media/receiver/statistics.ts","../external node-commonjs \"url\"","../../../external/werift/node_modules/aes-js/index.js","../../../external/werift/packages/dtls/src/record/message/fragment.ts","../../../external/werift/packages/rtp/src/util.ts","../../../external/werift/packages/rtp/src/rtcp/psfb/pictureLossIndication.ts","../../../external/werift/node_modules/buffer-crc32/dist/index.cjs","../external node-commonjs \"dgram\"","../../../external/werift/node_modules/dns-packet/types.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/types/bool.js","../../../common/node_modules/http-auth-utils/dist/mechanisms/basic.js","../../../common/node_modules/http-auth-utils/dist/mechanisms/digest.js","../../../common/node_modules/yerror/dist/index.js","../../../external/werift/packages/common/src/network.ts","../../../external/werift/packages/dtls/src/handshake/message/server/helloDone.ts","../../../external/werift/packages/webrtc/src/transceiverManager.ts","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/lib/transaction.js","../../../external/werift/packages/dtls/src/client.ts","../../../external/werift/packages/dtls/src/context/cipher.ts","../external node-commonjs \"node:crypto\"","../../../external/werift/packages/dtls/src/context/transport.ts","../../../common/src/sleep.ts","../../../external/werift/packages/webrtc/src/media/extension/rtcpFeedback.ts","../../../external/werift/packages/rtp/src/rtcp/rtcp.ts","../../../external/werift/packages/webrtc/src/index.ts","../../../external/werift/packages/ice/src/stun/protocol.ts","../../../external/werift/node_modules/pvtsutils/build/index.es.js","../../../external/werift/node_modules/pvutils/build/utils.es.js","../../../external/werift/node_modules/asn1js/build/index.es.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/enums.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/types/bit_string.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/types/octet_string.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/converters.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/helper.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/storage.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/schema.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/decorators.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/errors/schema_validation.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/parser.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/serializer.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/objects.js","../../../external/werift/node_modules/@peculiar/asn1-schema/build/es2015/convert.js","../../../external/werift/node_modules/tslib/tslib.es6.mjs","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/ip_converter.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/name.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/general_name.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/object_identifiers.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/authority_information_access.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/authority_key_identifier.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/basic_constraints.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/general_names.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/certificate_issuer.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/certificate_policies.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/crl_number.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/crl_delta_indicator.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/crl_distribution_points.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/crl_freshest.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/crl_issuing_distribution_point.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/crl_reason.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/extended_key_usage.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/inhibit_any_policy.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/invalidity_date.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/issuer_alternative_name.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/key_usage.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/name_constraints.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/policy_constraints.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/policy_mappings.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/subject_alternative_name.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/attribute.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/subject_directory_attributes.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/subject_key_identifier.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/private_key_usage_period.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/entrust_version_info.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extensions/subject_info_access.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/algorithm_identifier.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/subject_public_key_info.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/time.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/validity.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/extension.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/types.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/tbs_certificate.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/certificate.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/tbs_cert_list.js","../../../external/werift/node_modules/@peculiar/asn1-x509/build/es2015/certificate_list.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/issuer_and_serial_number.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/signer_identifier.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/types.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/attribute.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/signer_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/attributes.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/aa_clear_attrs.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/attr_spec.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/aa_controls.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/issuer_serial.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/object_digest_info.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/v2_form.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/attr_cert_issuer.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/attr_cert_validity_period.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/holder.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/attribute_certificate_info.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/class_list.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/attribute_certificate.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/security_category.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/clearance.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/ietf_attr_syntax.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/target.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/proxy_info.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/role_syntax.js","../../../external/werift/node_modules/@peculiar/asn1-x509-attr/build/es2015/svce_auth_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/certificate_choices.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/content_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/encapsulated_content_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/encrypted_content_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/other_key_attribute.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/key_agree_recipient_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/key_trans_recipient_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/kek_recipient_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/password_recipient_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/recipient_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/recipient_infos.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/revocation_info_choice.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/originator_info.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/enveloped_data.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/object_identifiers.js","../../../external/werift/node_modules/@peculiar/asn1-cms/build/es2015/signed_data.js","../../../external/werift/node_modules/@peculiar/asn1-ecc/build/es2015/object_identifiers.js","../../../external/werift/node_modules/@peculiar/asn1-ecc/build/es2015/algorithms.js","../../../external/werift/node_modules/@peculiar/asn1-ecc/build/es2015/rfc3279.js","../../../external/werift/node_modules/@peculiar/asn1-ecc/build/es2015/ec_parameters.js","../../../external/werift/node_modules/@peculiar/asn1-ecc/build/es2015/ec_private_key.js","../../../external/werift/node_modules/@peculiar/asn1-ecc/build/es2015/ec_signature_value.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/object_identifiers.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/algorithms.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/parameters/rsaes_oaep.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/parameters/rsassa_pss.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/parameters/rsassa_pkcs1_v1_5.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/other_prime_info.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/rsa_private_key.js","../../../external/werift/node_modules/@peculiar/asn1-rsa/build/es2015/rsa_public_key.js","../../../external/werift/node_modules/tsyringe/dist/esm5/types/lifecycle.js","../../../external/werift/node_modules/tsyringe/node_modules/tslib/tslib.es6.js","../../../external/werift/node_modules/tsyringe/dist/esm5/providers/class-provider.js","../../../external/werift/node_modules/tsyringe/dist/esm5/providers/factory-provider.js","../../../external/werift/node_modules/tsyringe/dist/esm5/lazy-helpers.js","../../../external/werift/node_modules/tsyringe/dist/esm5/providers/injection-token.js","../../../external/werift/node_modules/tsyringe/dist/esm5/providers/token-provider.js","../../../external/werift/node_modules/tsyringe/dist/esm5/providers/value-provider.js","../../../external/werift/node_modules/tsyringe/dist/esm5/registry-base.js","../../../external/werift/node_modules/tsyringe/dist/esm5/registry.js","../../../external/werift/node_modules/tsyringe/dist/esm5/resolution-context.js","../../../external/werift/node_modules/tsyringe/dist/esm5/error-helpers.js","../../../external/werift/node_modules/tsyringe/dist/esm5/interceptors.js","../../../external/werift/node_modules/tsyringe/dist/esm5/dependency-container.js","../../../external/werift/node_modules/tsyringe/dist/esm5/providers/provider.js","../../../external/werift/node_modules/tsyringe/dist/esm5/types/disposable.js","../../../external/werift/node_modules/tsyringe/dist/esm5/reflection-helpers.js","../../../external/werift/node_modules/tsyringe/dist/esm5/decorators/injectable.js","../../../external/werift/node_modules/tsyringe/dist/esm5/index.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/attribute.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/authenticated_safe.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/bags/cert_bag.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/bags/crl_bag.js","../../../external/werift/node_modules/@peculiar/asn1-pkcs8/build/es2015/encrypted_private_key_info.js","../../../external/werift/node_modules/@peculiar/asn1-pkcs8/build/es2015/private_key_info.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/bags/key_bag.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/bags/pkcs8_shrouded_key_bag.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/bags/secret_bag.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/mac_data.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/pfx.js","../../../external/werift/node_modules/@peculiar/asn1-pfx/build/es2015/safe_bag.js","../../../external/werift/node_modules/@peculiar/asn1-pkcs9/build/es2015/index.js","../../../external/werift/node_modules/@peculiar/asn1-csr/build/es2015/attributes.js","../../../external/werift/node_modules/@peculiar/asn1-csr/build/es2015/certification_request_info.js","../../../external/werift/node_modules/@peculiar/asn1-csr/build/es2015/certification_request.js","../../../external/werift/node_modules/@peculiar/x509/build/x509.es.js","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/lib/decode.js","../../../external/werift/packages/dtls/src/handshake/extensions/signature.ts","../src/ffmpeg-to-wrtc.ts","../../../external/werift/packages/dtls/src/handshake/message/server/helloVerifyRequest.ts","../../../external/werift/packages/webrtc/src/peerConnection.ts","../../../external/werift/packages/rtp/src/rtp/red/packet.ts","../../../external/werift/node_modules/@noble/hashes/sha256.js","../../../external/werift/packages/webrtc/src/media/sender/cumulativeResult.ts","../../../server/src/rpc.ts","../../../external/werift/node_modules/turbo-crc32/src/crc32-by-4.js","../../../external/werift/packages/dtls/src/context/dtls.ts","../external node-commonjs \"worker_threads\"","../../../external/werift/packages/webrtc/src/media/receiver/receiverTwcc.ts","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/lib/not-enough-data-error.js","../../../external/werift/node_modules/dns-packet/opcodes.js","../../../external/werift/packages/dtls/src/handshake/message/changeCipherSpec.ts","../../../external/werift/packages/common/src/transport.ts","../../../external/werift/packages/rtp/src/codec/vp8.ts","../../../external/werift/packages/webrtc/src/sdpManager.ts","../../../external/werift/node_modules/multicast-dns/index.js","../../../external/werift/packages/rtp/src/rtp/headerExtension.ts","../../../external/werift/node_modules/turbo-crc32/src/crc32-by-8.js","../../../common/src/read-stream.ts","../../../external/werift/node_modules/dns-packet/optioncodes.js","../../../external/werift/node_modules/supports-color/index.js","../../../external/werift/node_modules/ms/index.js","../../../external/werift/packages/rtp/src/codec/av1.ts","../../../server/src/listen-zero.ts","../../../external/werift/packages/webrtc/src/helper.ts","../../../external/werift/node_modules/@shinyoshiaki/binary-data/src/node_modules/internal/buffer-list.js","../../../external/werift/packages/webrtc/src/media/codec.ts","../../../external/werift/packages/common/src/number.ts","../../../external/werift/packages/webrtc/src/utils.ts","../../../external/werift/node_modules/dns-packet/index.js","../../../external/werift/packages/rtp/src/rtcp/psfb/remb.ts","../external node-commonjs \"util\"","../../../external/werift/packages/sctp/src/sctp.ts","../../../external/werift/packages/dtls/src/handshake/message/server/hello.ts","../../../external/werift/packages/rtp/src/srtp/srtcp.ts","../../../external/werift/packages/webrtc/src/media/rtpReceiver.ts","../../../external/werift/node_modules/@fidm/asn1/build/asn1.js","../../../external/werift/node_modules/@minhducsun2002/leb128/dist/index.js","../external node-commonjs \"net\"","../../../external/werift/packages/dtls/src/cipher/key-exchange.ts","../../../external/werift/packages/dtls/src/cipher/suites/abstract.ts","../../../external/werift/node_modules/@fidm/x509/build/common.js","../../homekit/src/types/camera/opus-repacketizer.ts","../../../external/werift/packages/ice/src/index.ts","../../../external/werift/packages/webrtc/src/dataChannel.ts","../../../external/werift/packages/rtp/src/srtp/cipher/ctr.ts","../../../external/werift/packages/sctp/src/const.ts","../../../external/werift/node_modules/@fidm/asn1/build/index.js","../../../external/werift/packages/common/src/index.ts","../../../external/werift/packages/webrtc/src/media/router.ts","../../../external/werift/packages/dtls/src/handshake/const.ts","../../../external/werift/node_modules/dns-packet/rcodes.js","../../../external/werift/packages/dtls/src/server.ts","../src/session-control.ts","../../../external/werift/packages/dtls/src/handshake/random.ts","../../../external/werift/packages/ice/src/iceBase.ts","../../../external/werift/packages/rtp/src/srtp/srtp.ts","../../../external/werift/packages/dtls/src/util/binary.ts","../../../sdk/dist/types/gen/index.js","../../../external/werift/packages/ice/src/stun/message.ts","../external node-commonjs \"fs\"","../../../external/werift/packages/dtls/src/handshake/message/client/keyExchange.ts","../../../external/werift/node_modules/isobject/index.js","../../../external/werift/packages/sctp/src/param.ts","../webpack/bootstrap","../webpack/runtime/define property getters","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object","../webpack/startup"],"sourcesContent":["'use strict';\n\nconst isPlainObject = require('is-plain-object');\n\nmodule.exports = {\n  isType,\n  isUserType: isPlainObject,\n  isFunction,\n  isDecodeType,\n  isEncodeType,\n};\n\n/**\n * Check if argument is data type.\n * @param {*} type\n * @returns {bool}\n */\nfunction isType(type) {\n  return isObject(type) && isFunction(type.encode) && isFunction(type.decode);\n}\n\n/**\n * Check if argument is function.\n * @param {*} value\n * @returns {bool}\n */\nfunction isFunction(value) {\n  return typeof value === 'function';\n}\n\n/**\n * Check if argument is object.\n * @param {*} value\n * @returns {bool}\n */\nfunction isObject(value) {\n  return typeof value === 'object' && value !== null;\n}\n\n/**\n * Check if argument is data type and able to decode data.\n * @param {*} type\n * @returns {bool}\n */\nfunction isDecodeType(type) {\n  return isObject(type) && isFunction(type.decode);\n}\n\n/**\n * Check if argument is data type and able to encode data.\n * @param {*} type\n * @returns {bool}\n */\nfunction isEncodeType(type) {\n  return isObject(type) && isFunction(type.encode);\n}\n","'use strict';\n\nconst symbols = require('internal/symbols');\n\n/**\n * Store extended info between encode/decode calls.\n */\nmodule.exports = class Metadata {\n  /**\n   * @class Metadata\n   */\n  constructor() {\n    // The number of bytes are processed.\n    this[symbols.bytes] = 0;\n\n    // Root node.\n    this.node = undefined;\n\n    // Current node.\n    this.current = undefined;\n  }\n\n  /**\n   * The number of bytes are processed.\n   * @returns {number}\n   */\n  get bytes() {\n    return this[symbols.bytes];\n  }\n\n  /**\n   * Clone provided metadata.\n   * @param {Metadata} metadata\n   * @returns {Metadata}\n   */\n  static clone(metadata) {\n    const meta = new Metadata();\n\n    if (metadata instanceof Metadata) {\n      meta.node = metadata.node;\n      meta.current = metadata.current;\n    }\n\n    return meta;\n  }\n\n  /**\n   * Remove internal references to processed nodes.\n   * @param {Metadata} metadata\n   */\n  static clean(metadata) {\n    if (metadata instanceof Metadata) {\n      metadata.node = undefined;\n      metadata.current = undefined;\n    }\n  }\n};\n","import { randomBytes } from \"crypto\";\nimport { jspack } from \"@shinyoshiaki/jspack\";\n\nexport function random16() {\n  return jspack.Unpack(\"!H\", randomBytes(2))[0];\n}\n\nexport function random32() {\n  return jspack.Unpack(\"!L\", randomBytes(4))[0];\n}\n\nexport function bufferXor(a: Buffer, b: Buffer): Buffer {\n  if (a.length !== b.length) {\n    throw new TypeError(\n      \"[webrtc-stun] You can not XOR buffers which length are different\",\n    );\n  }\n\n  const length = a.length;\n  const buffer = Buffer.allocUnsafe(length);\n\n  for (let i = 0; i < length; i++) {\n    buffer[i] = a[i] ^ b[i];\n  }\n\n  return buffer;\n}\n\nexport function bufferArrayXor(arr: Buffer[]): Buffer {\n  const length = [...arr]\n    .sort((a, b) => a.length - b.length)\n    .reverse()[0].length;\n  const xored = Buffer.allocUnsafe(length);\n\n  for (let i = 0; i < length; i++) {\n    xored[i] = 0;\n    arr.forEach((buffer) => {\n      xored[i] ^= buffer[i] ?? 0;\n    });\n  }\n\n  return xored;\n}\n\nexport class BitWriter {\n  value = 0;\n\n  constructor(private bitLength: number) {}\n\n  set(size: number, startIndex: number, value: number) {\n    value &= (1 << size) - 1;\n    this.value |= value << (this.bitLength - size - startIndex);\n\n    return this;\n  }\n\n  get buffer() {\n    const length = Math.ceil(this.bitLength / 8);\n    const buf = Buffer.alloc(length);\n    buf.writeUIntBE(this.value, 0, length);\n    return buf;\n  }\n}\n\nexport class BitWriter2 {\n  private _value = 0n;\n  offset = 0n;\n\n  /**\n   * value\n   */\n  constructor(\n    /**Max 32bit */\n    private bitLength: number,\n  ) {\n    if (bitLength > 32) {\n      throw new Error();\n    }\n  }\n\n  set(value: number, size: number = 1) {\n    let value_b = BigInt(value);\n    const size_b = BigInt(size);\n\n    value_b &= (1n << size_b) - 1n;\n    this._value |= value_b << (BigInt(this.bitLength) - size_b - this.offset);\n    this.offset += size_b;\n    return this;\n  }\n\n  get value() {\n    return Number(this._value);\n  }\n\n  get buffer() {\n    const length = Math.ceil(this.bitLength / 8);\n    const buf = Buffer.alloc(length);\n    buf.writeUIntBE(this.value, 0, length);\n    return buf;\n  }\n}\n\nexport function getBit(bits: number, startIndex: number, length: number = 1) {\n  let bin = bits.toString(2).split(\"\");\n  bin = [...Array(8 - bin.length).fill(\"0\"), ...bin];\n  const s = bin.slice(startIndex, startIndex + length).join(\"\");\n  const v = Number.parseInt(s, 2);\n  return v;\n}\n\nexport function paddingByte(bits: number) {\n  const dec = bits.toString(2).split(\"\");\n  return [...[...Array(8 - dec.length)].map(() => \"0\"), ...dec].join(\"\");\n}\n\nexport function paddingBits(bits: number, expectLength: number) {\n  const dec = bits.toString(2);\n  return [...[...Array(expectLength - dec.length)].map(() => \"0\"), ...dec].join(\n    \"\",\n  );\n}\n\nexport function bufferWriter(bytes: number[], values: (number | bigint)[]) {\n  return createBufferWriter(bytes)(values);\n}\n\nexport function createBufferWriter(bytes: number[], singleBuffer?: boolean) {\n  const length = bytes.reduce((acc, cur) => acc + cur, 0);\n  const reuseBuffer = singleBuffer ? Buffer.alloc(length) : undefined;\n\n  return (values: (number | bigint)[]) => {\n    const buf = reuseBuffer || Buffer.alloc(length);\n    let offset = 0;\n\n    values.forEach((v, i) => {\n      const size = bytes[i];\n      if (size === 8) buf.writeBigUInt64BE(v as bigint, offset);\n      else buf.writeUIntBE(v as number, offset, size);\n      offset += size;\n    });\n    return buf;\n  };\n}\n\nexport function bufferWriterLE(bytes: number[], values: (number | bigint)[]) {\n  const length = bytes.reduce((acc, cur) => acc + cur, 0);\n  const buf = Buffer.alloc(length);\n  let offset = 0;\n\n  values.forEach((v, i) => {\n    const size = bytes[i];\n    if (size === 8) buf.writeBigUInt64LE(v as bigint, offset);\n    else buf.writeUIntLE(v as number, offset, size);\n\n    offset += size;\n  });\n  return buf;\n}\n\nexport function bufferReader(buf: Buffer, bytes: number[]) {\n  let offset = 0;\n  return bytes.map((v) => {\n    let read: number | bigint;\n    if (v === 8) {\n      read = buf.readBigUInt64BE(offset);\n    } else {\n      read = buf.readUIntBE(offset, v);\n    }\n\n    offset += v;\n\n    return read as any;\n  });\n}\n\nexport class BufferChain {\n  buffer: Buffer;\n\n  constructor(size: number) {\n    this.buffer = Buffer.alloc(size);\n  }\n\n  writeInt16BE(value: number, offset?: number | undefined) {\n    this.buffer.writeInt16BE(value, offset);\n    return this;\n  }\n\n  writeUInt8(value: number, offset?: number | undefined) {\n    this.buffer.writeUInt8(value, offset);\n    return this;\n  }\n}\n\nexport const dumpBuffer = (data: Buffer) =>\n  \"0x\" +\n  data\n    .toString(\"hex\")\n    .replace(/(.)(.)/g, \"$1$2 \")\n    .split(\" \")\n    .filter((s) => s != undefined && s.length > 0)\n    .join(\",0x\");\n\nexport function buffer2ArrayBuffer(buf: Buffer) {\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.byteLength);\n}\n\nexport class BitStream {\n  private position = 0;\n  private bitsPending = 0;\n\n  constructor(public uint8Array: Buffer) {}\n\n  writeBits(bits: number, value: number): BitStream {\n    if (bits == 0) {\n      return this;\n    }\n    value &= 0xffffffff >>> (32 - bits);\n    let bitsConsumed;\n    if (this.bitsPending > 0) {\n      if (this.bitsPending > bits) {\n        this.uint8Array[this.position - 1] |=\n          value << (this.bitsPending - bits);\n        bitsConsumed = bits;\n        this.bitsPending -= bits;\n      } else if (this.bitsPending == bits) {\n        this.uint8Array[this.position - 1] |= value;\n        bitsConsumed = bits;\n        this.bitsPending = 0;\n      } else {\n        this.uint8Array[this.position - 1] |=\n          value >> (bits - this.bitsPending);\n        // ???\n        bitsConsumed = this.bitsPending;\n        this.bitsPending = 0;\n      }\n    } else {\n      bitsConsumed = Math.min(8, bits);\n      this.bitsPending = 8 - bitsConsumed;\n      this.uint8Array[this.position++] =\n        (value >> (bits - bitsConsumed)) << this.bitsPending;\n    }\n    bits -= bitsConsumed;\n    if (bits > 0) {\n      this.writeBits(bits, value);\n    }\n\n    return this;\n  }\n\n  readBits(bits: number) {\n    return this._readBits(bits);\n  }\n\n  private _readBits(bits: number, bitBuffer?: number): number {\n    if (typeof bitBuffer == \"undefined\") {\n      bitBuffer = 0;\n    }\n    if (bits == 0) {\n      return bitBuffer;\n    }\n    let partial: number;\n    let bitsConsumed: number;\n    if (this.bitsPending > 0) {\n      const byte =\n        this.uint8Array[this.position - 1] & (0xff >> (8 - this.bitsPending));\n      bitsConsumed = Math.min(this.bitsPending, bits);\n      this.bitsPending -= bitsConsumed;\n      partial = byte >> this.bitsPending;\n    } else {\n      bitsConsumed = Math.min(8, bits);\n      this.bitsPending = 8 - bitsConsumed;\n      partial = this.uint8Array[this.position++] >> this.bitsPending;\n    }\n    bits -= bitsConsumed;\n    bitBuffer = (bitBuffer << bitsConsumed) | partial;\n    return bits > 0 ? this._readBits(bits, bitBuffer) : bitBuffer;\n  }\n\n  seekTo(bitPos: number) {\n    this.position = (bitPos / 8) | 0;\n    this.bitsPending = bitPos % 8;\n    if (this.bitsPending > 0) {\n      this.bitsPending = 8 - this.bitsPending;\n      this.position++;\n    }\n  }\n}\n","import { createHash, createHmac } from \"crypto\";\nimport { createDecode } from \"@shinyoshiaki/binary-data\";\nimport nacl from \"tweetnacl\";\n\nimport { NamedCurveAlgorithm, type NamedCurveAlgorithms } from \"./const\";\nimport { p256PreMasterSecret } from \"./ec\";\n\nexport function prfPreMasterSecret(\n  publicKey: Buffer,\n  privateKey: Buffer,\n  curve: NamedCurveAlgorithms,\n) {\n  switch (curve) {\n    case NamedCurveAlgorithm.secp256r1_23:\n      return p256PreMasterSecret({ publicKey, privateKey });\n    case NamedCurveAlgorithm.x25519_29:\n      return Buffer.from(nacl.scalarMult(privateKey, publicKey));\n    default:\n      throw new Error();\n  }\n}\n\nexport function hmac(algorithm: string, secret: Buffer, data: Buffer) {\n  const hash = createHmac(algorithm, secret);\n  hash.update(data);\n  return hash.digest();\n}\n\nexport function prfPHash(\n  secret: Buffer,\n  seed: Buffer,\n  requestedLegth: number,\n  algorithm = \"sha256\",\n) {\n  const totalLength = requestedLegth;\n  const bufs: Buffer[] = [];\n  let Ai = seed; // A0\n\n  do {\n    Ai = hmac(algorithm, secret, Ai); // A(i) = HMAC(secret, A(i-1))\n    const output = hmac(algorithm, secret, Buffer.concat([Ai, seed]));\n\n    bufs.push(output);\n    requestedLegth -= output.length; // eslint-disable-line no-param-reassign\n  } while (requestedLegth > 0);\n\n  return Buffer.concat(bufs, totalLength);\n}\n\nexport function prfMasterSecret(\n  preMasterSecret: Buffer,\n  clientRandom: Buffer,\n  serverRandom: Buffer,\n) {\n  const seed = Buffer.concat([\n    Buffer.from(\"master secret\"),\n    clientRandom,\n    serverRandom,\n  ]);\n  return prfPHash(preMasterSecret, seed, 48);\n}\n\nexport function prfExtendedMasterSecret(\n  preMasterSecret: Buffer,\n  handshakes: Buffer,\n) {\n  const sessionHash = hash(\"sha256\", handshakes);\n  const label = \"extended master secret\";\n  return prfPHash(\n    preMasterSecret,\n    Buffer.concat([Buffer.from(label), sessionHash]),\n    48,\n  );\n}\n\nexport function exportKeyingMaterial(\n  label: string,\n  length: number,\n  masterSecret: Buffer,\n  localRandom: Buffer,\n  remoteRandom: Buffer,\n  isClient: boolean,\n) {\n  const clientRandom = isClient ? localRandom : remoteRandom;\n  const serverRandom = isClient ? remoteRandom : localRandom;\n  const seed = Buffer.concat([Buffer.from(label), clientRandom, serverRandom]);\n  return prfPHash(masterSecret, seed, length);\n}\n\nexport function hash(algorithm: string, data: Buffer) {\n  return createHash(algorithm).update(data).digest();\n}\n\nexport function prfVerifyData(\n  masterSecret: Buffer,\n  handshakes: Buffer,\n  label: string,\n  size = 12,\n) {\n  const bytes = hash(\"sha256\", handshakes);\n  return prfPHash(\n    masterSecret,\n    Buffer.concat([Buffer.from(label), bytes]),\n    size,\n  );\n}\n\nexport function prfVerifyDataClient(masterSecret: Buffer, handshakes: Buffer) {\n  return prfVerifyData(masterSecret, handshakes, \"client finished\");\n}\n\nexport function prfVerifyDataServer(masterSecret: Buffer, handshakes: Buffer) {\n  return prfVerifyData(masterSecret, handshakes, \"server finished\");\n}\n\nexport function prfEncryptionKeys(\n  masterSecret: Buffer,\n  clientRandom: Buffer,\n  serverRandom: Buffer,\n  prfKeyLen: number,\n  prfIvLen: number,\n  prfNonceLen: number,\n  algorithm = \"sha256\",\n) {\n  const size = prfKeyLen * 2 + prfIvLen * 2;\n  const secret = masterSecret;\n  const seed = Buffer.concat([serverRandom, clientRandom]);\n  const keyBlock = prfPHash(\n    secret,\n    Buffer.concat([Buffer.from(\"key expansion\"), seed]),\n    size,\n    algorithm,\n  );\n  const stream = createDecode(keyBlock);\n\n  const clientWriteKey = stream.readBuffer(prfKeyLen);\n  const serverWriteKey = stream.readBuffer(prfKeyLen);\n\n  const clientNonceImplicit = stream.readBuffer(prfIvLen);\n  const serverNonceImplicit = stream.readBuffer(prfIvLen);\n\n  const clientNonce = Buffer.alloc(prfNonceLen, 0);\n  const serverNonce = Buffer.alloc(prfNonceLen, 0);\n\n  clientNonceImplicit.copy(clientNonce, 0);\n  serverNonceImplicit.copy(serverNonce, 0);\n\n  return { clientWriteKey, serverWriteKey, clientNonce, serverNonce };\n}\n","import { jspack } from \"@shinyoshiaki/jspack\";\n\nimport { RtpHeader, RtpPacket } from \"./rtp\";\n\nexport function unwrapRtx(rtx: RtpPacket, payloadType: number, ssrc: number) {\n  const packet = new RtpPacket(\n    new RtpHeader({\n      payloadType,\n      marker: rtx.header.marker,\n      sequenceNumber: jspack.Unpack(\"!H\", rtx.payload.subarray(0, 2))[0],\n      timestamp: rtx.header.timestamp,\n      ssrc,\n    }),\n    rtx.payload.subarray(2),\n  );\n  return packet;\n}\n\nexport function wrapRtx(\n  packet: RtpPacket,\n  payloadType: number,\n  sequenceNumber: number,\n  ssrc: number,\n) {\n  const rtx = new RtpPacket(\n    new RtpHeader({\n      payloadType,\n      marker: packet.header.marker,\n      sequenceNumber,\n      timestamp: packet.header.timestamp,\n      ssrc,\n      csrc: packet.header.csrc,\n      extensions: packet.header.extensions,\n    }),\n    Buffer.concat([\n      Buffer.from(jspack.Pack(\"!H\", [packet.header.sequenceNumber])),\n      packet.payload,\n    ]),\n  );\n  return rtx;\n}\n","import { createHmac } from \"crypto\";\nimport AES from \"aes-js\";\n\nimport type { CipherAesBase } from \"../cipher\";\nimport { CipherAesCtr } from \"../cipher/ctr\";\nimport { CipherAesGcm } from \"../cipher/gcm\";\nimport {\n  ProtectionProfileAeadAes128Gcm,\n  ProtectionProfileAes128CmHmacSha1_80,\n  type SrtpProfile,\n} from \"../const\";\n\nexport class Context {\n  srtpSSRCStates: { [ssrc: number]: SrtpSsrcState } = {};\n  srtpSessionKey: Buffer;\n  srtpSessionSalt: Buffer;\n  srtpSessionAuthTag: Buffer;\n  srtpSessionAuth: ReturnType<typeof createHmac>;\n  srtcpSSRCStates: { [ssrc: number]: SrtcpSSRCState } = {};\n  srtcpSessionKey: Buffer;\n  srtcpSessionSalt: Buffer;\n  srtcpSessionAuthTag: Buffer;\n  srtcpSessionAuth: ReturnType<typeof createHmac>;\n\n  cipher: CipherAesBase;\n\n  constructor(\n    public masterKey: Buffer,\n    public masterSalt: Buffer,\n    public profile: SrtpProfile,\n  ) {\n    {\n      // aes-js plaintext require 16byte\n      // so need to padding to 14 byte\n      const diff = 14 - masterSalt.length;\n      if (diff > 0) {\n        this.masterSalt = Buffer.concat([masterSalt, Buffer.alloc(diff)]);\n      }\n    }\n\n    this.srtpSessionKey = this.generateSessionKey(0);\n    this.srtpSessionSalt = this.generateSessionSalt(2);\n    this.srtpSessionAuthTag = this.generateSessionAuthTag(1);\n    this.srtpSessionAuth = createHmac(\"sha1\", this.srtpSessionAuthTag);\n\n    this.srtcpSessionKey = this.generateSessionKey(3);\n    this.srtcpSessionSalt = this.generateSessionSalt(5);\n    this.srtcpSessionAuthTag = this.generateSessionAuthTag(4);\n    this.srtcpSessionAuth = createHmac(\"sha1\", this.srtcpSessionAuthTag);\n\n    switch (profile) {\n      case ProtectionProfileAes128CmHmacSha1_80:\n        this.cipher = new CipherAesCtr(\n          this.srtpSessionKey,\n          this.srtpSessionSalt,\n          this.srtcpSessionKey,\n          this.srtcpSessionSalt,\n          this.srtpSessionAuthTag,\n          this.srtcpSessionAuthTag,\n        );\n        break;\n      case ProtectionProfileAeadAes128Gcm:\n        this.cipher = new CipherAesGcm(\n          this.srtpSessionKey,\n          this.srtpSessionSalt,\n          this.srtcpSessionKey,\n          this.srtcpSessionSalt,\n        );\n        break;\n    }\n  }\n\n  generateSessionKey(label: number) {\n    let sessionKey = Buffer.from(this.masterSalt);\n\n    const labelAndIndexOverKdr = Buffer.from([\n      label,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n    ]);\n    for (\n      let i = labelAndIndexOverKdr.length - 1, j = sessionKey.length - 1;\n      i >= 0;\n      i--, j--\n    ) {\n      sessionKey[j] = sessionKey[j] ^ labelAndIndexOverKdr[i];\n    }\n\n    sessionKey = Buffer.concat([sessionKey, Buffer.from([0x00, 0x00])]);\n    const block = new AES.AES(this.masterKey);\n    return Buffer.from(block.encrypt(sessionKey) as ArrayBuffer);\n  }\n\n  generateSessionSalt(label: number) {\n    let sessionSalt: Buffer = Buffer.from(this.masterSalt);\n    const labelAndIndexOverKdr = Buffer.from([\n      label,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n    ]);\n    for (\n      let i = labelAndIndexOverKdr.length - 1, j = sessionSalt.length - 1;\n      i >= 0;\n      i--, j--\n    ) {\n      sessionSalt[j] = sessionSalt[j] ^ labelAndIndexOverKdr[i];\n    }\n    sessionSalt = Buffer.concat([sessionSalt, Buffer.from([0x00, 0x00])]);\n    const block = new AES.AES(this.masterKey);\n    sessionSalt = Buffer.from(block.encrypt(sessionSalt) as ArrayBuffer);\n    return sessionSalt.subarray(0, 14);\n  }\n\n  generateSessionAuthTag(label: number) {\n    const sessionAuthTag = Buffer.from(this.masterSalt);\n    const labelAndIndexOverKdr = Buffer.from([\n      label,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n      0x00,\n    ]);\n    for (\n      let i = labelAndIndexOverKdr.length - 1, j = sessionAuthTag.length - 1;\n      i >= 0;\n      i--, j--\n    ) {\n      sessionAuthTag[j] = sessionAuthTag[j] ^ labelAndIndexOverKdr[i];\n    }\n    let firstRun: Buffer = Buffer.concat([\n      sessionAuthTag,\n      Buffer.from([0x00, 0x00]),\n    ]);\n    let secondRun: Buffer = Buffer.concat([\n      sessionAuthTag,\n      Buffer.from([0x00, 0x01]),\n    ]);\n    const block = new AES.AES(this.masterKey);\n    firstRun = Buffer.from(block.encrypt(firstRun) as ArrayBuffer);\n    secondRun = Buffer.from(block.encrypt(secondRun) as ArrayBuffer);\n    return Buffer.concat([firstRun, secondRun.subarray(0, 4)]);\n  }\n\n  getSrtpSsrcState(ssrc: number) {\n    let s = this.srtpSSRCStates[ssrc];\n    if (s) return s;\n    s = {\n      ssrc,\n      rolloverCounter: 0,\n      lastSequenceNumber: 0,\n    };\n    this.srtpSSRCStates[ssrc] = s;\n    return s;\n  }\n\n  getSrtcpSsrcState(ssrc: number) {\n    let s = this.srtcpSSRCStates[ssrc];\n    if (s) return s;\n    s = {\n      srtcpIndex: 0,\n      ssrc,\n    };\n    this.srtcpSSRCStates[ssrc] = s;\n    return s;\n  }\n\n  // 3.3.1.  Packet Index Determination, and ROC, s_l Update\n  // In particular, out-of-order RTP packets with\n  // sequence numbers close to 2^16 or zero must be properly handled.\n  updateRolloverCount(sequenceNumber: number, s: SrtpSsrcState) {\n    if (!s.rolloverHasProcessed) {\n      s.rolloverHasProcessed = true;\n    } else if (sequenceNumber === 0) {\n      if (s.lastSequenceNumber > MaxROCDisorder) {\n        s.rolloverCounter++;\n      }\n    } else if (\n      s.lastSequenceNumber < MaxROCDisorder &&\n      sequenceNumber > MaxSequenceNumber - MaxROCDisorder\n    ) {\n      // https://github.com/shinyoshiaki/werift-webrtc/issues/94\n      if (s.rolloverCounter > 0) {\n        s.rolloverCounter--;\n      }\n    } else if (\n      sequenceNumber < MaxROCDisorder &&\n      s.lastSequenceNumber > MaxSequenceNumber - MaxROCDisorder\n    ) {\n      s.rolloverCounter++;\n    }\n    s.lastSequenceNumber = sequenceNumber;\n  }\n\n  generateSrtpAuthTag(buf: Buffer, roc: number) {\n    this.srtpSessionAuth = createHmac(\"sha1\", this.srtpSessionAuthTag);\n    const rocRaw = Buffer.alloc(4);\n    rocRaw.writeUInt32BE(roc);\n\n    return this.srtpSessionAuth\n      .update(buf)\n      .update(rocRaw)\n      .digest()\n      .slice(0, 10);\n  }\n\n  index(ssrc: number) {\n    const s = this.srtcpSSRCStates[ssrc];\n    if (!s) {\n      return 0;\n    }\n    return s.srtcpIndex;\n  }\n\n  setIndex(ssrc: number, index: number) {\n    const s = this.getSrtcpSsrcState(ssrc);\n    s.srtcpIndex = index % 0x7fffffff;\n  }\n}\n\nexport interface SrtpSsrcState {\n  ssrc: number;\n  rolloverCounter: number;\n  rolloverHasProcessed?: boolean;\n  lastSequenceNumber: number;\n}\n\nexport type SrtcpSSRCState = {\n  srtcpIndex: number;\n  ssrc: number;\n};\n\nconst MaxROCDisorder = 100;\nconst MaxSequenceNumber = 65535;\n","module.exports = require(\"buffer\");","'use strict';\n\n// do not edit .js files directly - edit src/index.jst\n\n\n\nmodule.exports = function equal(a, b) {\n  if (a === b) return true;\n\n  if (a && b && typeof a == 'object' && typeof b == 'object') {\n    if (a.constructor !== b.constructor) return false;\n\n    var length, i, keys;\n    if (Array.isArray(a)) {\n      length = a.length;\n      if (length != b.length) return false;\n      for (i = length; i-- !== 0;)\n        if (!equal(a[i], b[i])) return false;\n      return true;\n    }\n\n\n\n    if (a.constructor === RegExp) return a.source === b.source && a.flags === b.flags;\n    if (a.valueOf !== Object.prototype.valueOf) return a.valueOf() === b.valueOf();\n    if (a.toString !== Object.prototype.toString) return a.toString() === b.toString();\n\n    keys = Object.keys(a);\n    length = keys.length;\n    if (length !== Object.keys(b).length) return false;\n\n    for (i = length; i-- !== 0;)\n      if (!Object.prototype.hasOwnProperty.call(b, keys[i])) return false;\n\n    for (i = length; i-- !== 0;) {\n      var key = keys[i];\n\n      if (!equal(a[key], b[key])) return false;\n    }\n\n    return true;\n  }\n\n  // true if both NaN, false otherwise\n  return a!==a && b!==b;\n};\n","'use strict';\n\nconst { isType, isFunction, isUserType } = require('lib/util');\nconst symbols = require('internal/symbols');\nconst { decodeCommon } = require('lib/decode');\nconst { encodeCommon } = require('lib/encode');\nconst { encodingLengthCommon } = require('lib/encoding-length');\nconst Metadata = require('internal/meta');\n\nmodule.exports = when;\n\n/**\n * Type for conditions.\n * @param {Function|bool} condition\n * @param {Object} type Any builtin type or schema.\n * @returns {Object}\n */\nfunction when(condition, type) {\n  if (!isType(type) && !isUserType(type)) {\n    throw new TypeError('Argument #2 should be a valid type.');\n  }\n\n  const result = {\n    encode,\n    decode,\n    encodingLength,\n    [symbols.skip]: false,\n  };\n\n  return result;\n\n  /**\n   * Encode value if condition is truthy.\n   * @param {any} value\n   * @param {EncodeStream} wstream\n   */\n  function encode(value, wstream) {\n    const context = Metadata.clone(this);\n    encode.bytes = 0;\n\n    const status = isFunction(condition)\n      ? Boolean(condition(context))\n      : Boolean(condition);\n\n    result[symbols.skip] = !status;\n\n    if (!status) {\n      Metadata.clean(context);\n      return;\n    }\n\n    encodeCommon(value, wstream, type, context);\n    encode.bytes = context.bytes;\n\n    Metadata.clean(context);\n  }\n\n  /**\n   * Decode value if condition is truthy.\n   * @param {DecodeStream} rstream\n   * @returns {any}\n   */\n  function decode(rstream) {\n    const context = Metadata.clone(this);\n    decode.bytes = 0;\n\n    const status = isFunction(condition)\n      ? Boolean(condition(context))\n      : Boolean(condition);\n\n    result[symbols.skip] = !status;\n\n    if (!status) {\n      Metadata.clean(context);\n      return;\n    }\n\n    const value = decodeCommon(rstream, type, context);\n\n    decode.bytes = context.bytes;\n    Metadata.clean(context);\n\n    return value; // eslint-disable-line consistent-return\n  }\n\n  /**\n   * Get the number bytes of an encoded value\n   * when condition is truthy or 0.\n   * @param {any} value\n   * @returns {number}\n   */\n  function encodingLength(value) {\n    const context = Metadata.clone(this);\n\n    const status = isFunction(condition)\n      ? Boolean(condition(context))\n      : Boolean(condition);\n\n    if (status) {\n      encodingLengthCommon(value, type, context);\n    }\n\n    Metadata.clean(context);\n    return context.bytes;\n  }\n}\n","'use strict';\n\nconst createFunction = require('generate-function');\n\nmodule.exports = {\n  doublebe: createFastStub(8, 'writeDoubleBE', 'readDoubleBE'),\n  doublele: createFastStub(8, 'writeDoubleLE', 'readDoubleLE'),\n  floatbe: createFastStub(4, 'writeFloatBE', 'readFloatBE'),\n  floatle: createFastStub(4, 'writeFloatLE', 'readFloatLE'),\n  int8: createFastStub(1, 'writeInt8', 'readInt8'),\n  uint8: createFastStub(1, 'writeUInt8', 'readUInt8'),\n  int16be: createFastStub(2, 'writeInt16BE', 'readInt16BE'),\n  uint16be: createFastStub(2, 'writeUInt16BE', 'readUInt16BE'),\n  int16le: createFastStub(2, 'writeInt16LE', 'readInt16LE'),\n  uint16le: createFastStub(2, 'writeUInt16LE', 'readUInt16LE'),\n  int32be: createFastStub(4, 'writeInt32BE', 'readInt32BE'),\n  uint32be: createFastStub(4, 'writeUInt32BE', 'readUInt32BE'),\n  int32le: createFastStub(4, 'writeInt32LE', 'readInt32LE'),\n  uint32le: createFastStub(4, 'writeUInt32LE', 'readUInt32LE'),\n  int24be: createFastStubGeneric(3, 'writeIntBE', 'readIntBE'),\n  uint24be: createFastStubGeneric(3, 'writeUIntBE', 'readUIntBE'),\n  int24le: createFastStubGeneric(3, 'writeIntLE', 'readIntLE'),\n  uint24le: createFastStubGeneric(3, 'writeUIntLE', 'readUIntLE'),\n  int40be: createFastStubGeneric(5, 'writeIntBE', 'readIntBE'),\n  uint40be: createFastStubGeneric(5, 'writeUIntBE', 'readUIntBE'),\n  int40le: createFastStubGeneric(5, 'writeIntLE', 'readIntLE'),\n  uint40le: createFastStubGeneric(5, 'writeUIntLE', 'readUIntLE'),\n  int48be: createFastStubGeneric(6, 'writeIntBE', 'readIntBE'),\n  uint48be: createFastStubGeneric(6, 'writeUIntBE', 'readUIntBE'),\n  int48le: createFastStubGeneric(6, 'writeIntLE', 'readIntLE'),\n  uint48le: createFastStubGeneric(6, 'writeUIntLE', 'readUIntLE'),\n};\n\n/**\n * Generate number type for provided the number of bytes.\n * @param {number} size\n * @param {string} write\n * @param {string} read\n * @returns {Object}\n * @private\n */\nfunction createFastStub(size, write, read) {\n  const genread = createFunction();\n  const genwrite = createFunction();\n\n  genread(`\n    function decode_${read}(rstream) {\n      decode_${read}.bytes = ${genread.formats.d(size)};\n      return rstream.${read}()\n    }\n  `);\n\n  genwrite(`\n    function encode_${write}(value, wstream) {\n      wstream.${write}(value);\n      encode_${write}.bytes = ${genread.formats.d(size)};\n    }\n  `);\n\n  return {\n    encodingLength: () => size,\n    encode: genwrite.toFunction(),\n    decode: genread.toFunction(),\n  };\n}\n\n/**\n * Generate number type for provided the number of bytes.\n * @param {number} size\n * @param {string} write\n * @param {string} read\n * @returns {Object}\n * @private\n */\nfunction createFastStubGeneric(size, write, read) {\n  const genread = createFunction();\n  const genwrite = createFunction();\n\n  genread(`\n    function decode_${read}(rstream) {\n      decode_${read}.bytes = ${genread.formats.d(size)};\n      return rstream.${read}(${genread.formats.d(size)})\n    }\n  `);\n\n  genwrite(`\n    function encode_${write}(value, wstream) {\n      wstream.${write}(value, ${genread.formats.d(size)});\n      encode_${write}.bytes = ${genread.formats.d(size)};\n    }\n  `);\n\n  return {\n    encodingLength: () => size,\n    encode: genwrite.toFunction(),\n    decode: genread.toFunction(),\n  };\n}\n","import { CipherSuiteList } from \"../../cipher/const\";\nimport type { CipherContext } from \"../../context/cipher\";\nimport type { DtlsContext } from \"../../context/dtls\";\nimport type { TransportContext } from \"../../context/transport\";\nimport { ClientHello } from \"../../handshake/message/client/hello\";\nimport { DtlsRandom } from \"../../handshake/random\";\nimport type { Extension } from \"../../typings/domain\";\nimport { Flight } from \"../flight\";\n\nexport class Flight1 extends Flight {\n  constructor(\n    udp: TransportContext,\n    dtls: DtlsContext,\n    private cipher: CipherContext,\n  ) {\n    super(udp, dtls, 1, 3);\n  }\n\n  async exec(extensions: Extension[]) {\n    if (this.dtls.flight === 1) throw new Error();\n    this.dtls.flight = 1;\n\n    const hello = new ClientHello(\n      { major: 255 - 1, minor: 255 - 2 },\n      new DtlsRandom(),\n      Buffer.from([]),\n      Buffer.from([]),\n      CipherSuiteList,\n      [0], // don't compress\n      extensions,\n    );\n    this.dtls.version = hello.clientVersion;\n    this.cipher.localRandom = DtlsRandom.from(hello.random);\n\n    const packets = this.createPacket([hello]);\n    const buf = Buffer.concat(packets.map((v) => v.serialize()));\n    await this.transmit([buf]);\n  }\n}\n","/**\n * Module dependencies.\n */\n\nconst tty = require('tty');\nconst util = require('util');\n\n/**\n * This is the Node.js implementation of `debug()`.\n */\n\nexports.init = init;\nexports.log = log;\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.destroy = util.deprecate(\n\t() => {},\n\t'Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.'\n);\n\n/**\n * Colors.\n */\n\nexports.colors = [6, 2, 3, 4, 5, 1];\n\ntry {\n\t// Optional dependency (as in, doesn't need to be installed, NOT like optionalDependencies in package.json)\n\t// eslint-disable-next-line import/no-extraneous-dependencies\n\tconst supportsColor = require('supports-color');\n\n\tif (supportsColor && (supportsColor.stderr || supportsColor).level >= 2) {\n\t\texports.colors = [\n\t\t\t20,\n\t\t\t21,\n\t\t\t26,\n\t\t\t27,\n\t\t\t32,\n\t\t\t33,\n\t\t\t38,\n\t\t\t39,\n\t\t\t40,\n\t\t\t41,\n\t\t\t42,\n\t\t\t43,\n\t\t\t44,\n\t\t\t45,\n\t\t\t56,\n\t\t\t57,\n\t\t\t62,\n\t\t\t63,\n\t\t\t68,\n\t\t\t69,\n\t\t\t74,\n\t\t\t75,\n\t\t\t76,\n\t\t\t77,\n\t\t\t78,\n\t\t\t79,\n\t\t\t80,\n\t\t\t81,\n\t\t\t92,\n\t\t\t93,\n\t\t\t98,\n\t\t\t99,\n\t\t\t112,\n\t\t\t113,\n\t\t\t128,\n\t\t\t129,\n\t\t\t134,\n\t\t\t135,\n\t\t\t148,\n\t\t\t149,\n\t\t\t160,\n\t\t\t161,\n\t\t\t162,\n\t\t\t163,\n\t\t\t164,\n\t\t\t165,\n\t\t\t166,\n\t\t\t167,\n\t\t\t168,\n\t\t\t169,\n\t\t\t170,\n\t\t\t171,\n\t\t\t172,\n\t\t\t173,\n\t\t\t178,\n\t\t\t179,\n\t\t\t184,\n\t\t\t185,\n\t\t\t196,\n\t\t\t197,\n\t\t\t198,\n\t\t\t199,\n\t\t\t200,\n\t\t\t201,\n\t\t\t202,\n\t\t\t203,\n\t\t\t204,\n\t\t\t205,\n\t\t\t206,\n\t\t\t207,\n\t\t\t208,\n\t\t\t209,\n\t\t\t214,\n\t\t\t215,\n\t\t\t220,\n\t\t\t221\n\t\t];\n\t}\n} catch (error) {\n\t// Swallow - we only care if `supports-color` is available; it doesn't have to be.\n}\n\n/**\n * Build up the default `inspectOpts` object from the environment variables.\n *\n *   $ DEBUG_COLORS=no DEBUG_DEPTH=10 DEBUG_SHOW_HIDDEN=enabled node script.js\n */\n\nexports.inspectOpts = Object.keys(process.env).filter(key => {\n\treturn /^debug_/i.test(key);\n}).reduce((obj, key) => {\n\t// Camel-case\n\tconst prop = key\n\t\t.substring(6)\n\t\t.toLowerCase()\n\t\t.replace(/_([a-z])/g, (_, k) => {\n\t\t\treturn k.toUpperCase();\n\t\t});\n\n\t// Coerce string value into JS value\n\tlet val = process.env[key];\n\tif (/^(yes|on|true|enabled)$/i.test(val)) {\n\t\tval = true;\n\t} else if (/^(no|off|false|disabled)$/i.test(val)) {\n\t\tval = false;\n\t} else if (val === 'null') {\n\t\tval = null;\n\t} else {\n\t\tval = Number(val);\n\t}\n\n\tobj[prop] = val;\n\treturn obj;\n}, {});\n\n/**\n * Is stdout a TTY? Colored output is enabled when `true`.\n */\n\nfunction useColors() {\n\treturn 'colors' in exports.inspectOpts ?\n\t\tBoolean(exports.inspectOpts.colors) :\n\t\ttty.isatty(process.stderr.fd);\n}\n\n/**\n * Adds ANSI color escape codes if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\tconst {namespace: name, useColors} = this;\n\n\tif (useColors) {\n\t\tconst c = this.color;\n\t\tconst colorCode = '\\u001B[3' + (c < 8 ? c : '8;5;' + c);\n\t\tconst prefix = `  ${colorCode};1m${name} \\u001B[0m`;\n\n\t\targs[0] = prefix + args[0].split('\\n').join('\\n' + prefix);\n\t\targs.push(colorCode + 'm+' + module.exports.humanize(this.diff) + '\\u001B[0m');\n\t} else {\n\t\targs[0] = getDate() + name + ' ' + args[0];\n\t}\n}\n\nfunction getDate() {\n\tif (exports.inspectOpts.hideDate) {\n\t\treturn '';\n\t}\n\treturn new Date().toISOString() + ' ';\n}\n\n/**\n * Invokes `util.formatWithOptions()` with the specified arguments and writes to stderr.\n */\n\nfunction log(...args) {\n\treturn process.stderr.write(util.formatWithOptions(exports.inspectOpts, ...args) + '\\n');\n}\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\tif (namespaces) {\n\t\tprocess.env.DEBUG = namespaces;\n\t} else {\n\t\t// If you set a process.env field to null or undefined, it gets cast to the\n\t\t// string 'null' or 'undefined'. Just delete instead.\n\t\tdelete process.env.DEBUG;\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\n\nfunction load() {\n\treturn process.env.DEBUG;\n}\n\n/**\n * Init logic for `debug` instances.\n *\n * Create a new `inspectOpts` object in case `useColors` is set\n * differently for a particular `debug` instance.\n */\n\nfunction init(debug) {\n\tdebug.inspectOpts = {};\n\n\tconst keys = Object.keys(exports.inspectOpts);\n\tfor (let i = 0; i < keys.length; i++) {\n\t\tdebug.inspectOpts[keys[i]] = exports.inspectOpts[keys[i]];\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %o to `util.inspect()`, all on a single line.\n */\n\nformatters.o = function (v) {\n\tthis.inspectOpts.colors = this.useColors;\n\treturn util.inspect(v, this.inspectOpts)\n\t\t.split('\\n')\n\t\t.map(str => str.trim())\n\t\t.join(' ');\n};\n\n/**\n * Map %O to `util.inspect()`, allowing multiple lines if needed.\n */\n\nformatters.O = function (v) {\n\tthis.inspectOpts.colors = this.useColors;\n\treturn util.inspect(v, this.inspectOpts);\n};\n","import crypto, { randomBytes } from 'crypto';\nimport dgram from 'dgram';\nimport { once } from 'events';\nimport net from 'net';\nimport { Duplex, Readable, Writable } from 'stream';\nimport tls from 'tls';\nimport { URL } from 'url';\nimport { Deferred } from './deferred';\nimport { closeQuiet, createBindZero, createSquentialBindZero, listenZeroSingleClient } from './listen-cluster';\nimport { timeoutPromise } from './promise-utils';\nimport { readLength, readLine } from './read-stream';\nimport { MSection, parseSdp } from './sdp-utils';\nimport { sleep } from './sleep';\nimport { StreamChunk, StreamParser, StreamParserOptions } from './stream-parser';\n\nconst REQUIRED_WWW_AUTHENTICATE_KEYS = ['realm', 'nonce'];\n\ntype DigestWWWAuthenticateData = {\n    realm: string;\n    domain?: string;\n    nonce: string;\n    opaque?: string;\n    stale?: 'true' | 'false';\n    algorithm?: 'MD5' | 'MD5-sess' | 'token';\n    qop?: 'auth' | 'auth-int' | string;\n};\n\nexport const RTSP_FRAME_MAGIC = 36;\n\nexport interface Headers {\n    [header: string]: string\n}\n\nexport interface RtspStreamParser extends StreamParser {\n    sdp: Promise<string>;\n}\n\nexport async function readMessage(client: Readable): Promise<string[]> {\n    let currentHeaders: string[] = [];\n    while (true) {\n        let line = await readLine(client);\n        line = line.trim();\n        if (!line)\n            return currentHeaders;\n        currentHeaders.push(line);\n    }\n}\n\n\nexport async function readBody(client: Readable, response: Headers) {\n    const cl = parseInt(response['content-length']);\n    if (cl)\n        return readLength(client, cl)\n}\n\n\nexport function writeMessage(client: Writable, messageLine: string, body: Buffer, headers: Headers, console?: Console) {\n    let message = messageLine !== undefined ? `${messageLine}\\r\\n` : '';\n    if (body)\n        headers['Content-Length'] = body.length.toString();\n    for (const [key, value] of Object.entries(headers)) {\n        message += `${key}: ${value}\\r\\n`;\n    }\n    message += '\\r\\n';\n    client.write(message);\n    console?.log('rtsp outgoing message\\n', message);\n    console?.log();\n    if (body)\n        client.write(body);\n}\n\n// https://yumichan.net/video-processing/video-compression/introduction-to-h264-nal-unit/\n\nexport const H264_NAL_TYPE_RESERVED0 = 0;\nexport const H264_NAL_TYPE_RESERVED30 = 30;\nexport const H264_NAL_TYPE_RESERVED31 = 31;\n\nexport const H264_NAL_TYPE_IDR = 5;\nexport const H264_NAL_TYPE_SEI = 6;\nexport const H264_NAL_TYPE_SPS = 7;\nexport const H264_NAL_TYPE_PPS = 8;\n// aggregate NAL Unit\nexport const H264_NAL_TYPE_STAP_A = 24;\nexport const H264_NAL_TYPE_STAP_B = 25;\n// fragmented NAL Unit (need to match against first)\nexport const H264_NAL_TYPE_FU_A = 28;\nexport const H264_NAL_TYPE_FU_B = 29;\n\nexport const H264_NAL_TYPE_MTAP16 = 26;\nexport const H264_NAL_TYPE_MTAP32 = 27;\n\nexport const H265_NAL_TYPE_AGG = 48;\nexport const H265_NAL_TYPE_VPS = 32;\nexport const H265_NAL_TYPE_SPS = 33;\nexport const H265_NAL_TYPE_PPS = 34;\nexport const H265_NAL_TYPE_BLA_W_LP = 16;\nexport const H265_NAL_TYPE_BLA_W_RADL = 17;\nexport const H265_NAL_TYPE_BLA_N_LP = 18;\nexport const H265_NAL_TYPE_IDR_W_RADL = 19;\nexport const H265_NAL_TYPE_IDR_N_LP = 20;\nexport const H265_NAL_TYPE_CRA_NUT = 21;\nexport const H265_NAL_TYPE_FU = 49;\nexport const H265_NAL_TYPE_SEI_PREFIX = 39;\nexport const H265_NAL_TYPE_SEI_SUFFIX = 40;\n\nexport function findH264NaluType(streamChunk: StreamChunk, naluType: number) {\n    if (streamChunk.type !== 'h264')\n        return;\n    return findH264NaluTypeInNalu(streamChunk.chunks[streamChunk.chunks.length - 1].subarray(12), naluType);\n}\n\nexport function findH265NaluType(streamChunk: StreamChunk, naluType: number) {\n    if (streamChunk.type !== 'h265')\n        return;\n    return findH265NaluTypeInNalu(streamChunk.chunks[streamChunk.chunks.length - 1].subarray(12), naluType);\n}\n\nexport function parseH264NaluType(firstNaluByte: number) {\n    return firstNaluByte & 0x1f;\n}\n\nexport function findH264NaluTypeInNalu(nalu: Buffer, naluType: number) {\n    const checkNaluType = parseH264NaluType(nalu[0]);\n    if (checkNaluType === H264_NAL_TYPE_STAP_A) {\n        let pos = 1;\n        while (pos < nalu.length) {\n            const naluLength = nalu.readUInt16BE(pos);\n            pos += 2;\n            const stapaType = parseH264NaluType(nalu[pos]);\n            if (stapaType === naluType)\n                return nalu.subarray(pos, pos + naluLength);\n            pos += naluLength;\n        }\n    }\n    else if (checkNaluType === H264_NAL_TYPE_FU_A) {\n        const fuaType = parseH264NaluType(nalu[1]);\n        const isFuStart = !!(nalu[1] & 0x80);\n\n        if (fuaType === naluType && isFuStart)\n            return nalu.subarray(1);\n    }\n    else if (checkNaluType === naluType) {\n        return nalu;\n    }\n    return;\n}\n\nfunction parseH265NaluType(firstNaluByte: number) {\n    return (firstNaluByte & 0b01111110) >> 1;\n}\n\nexport function findH265NaluTypeInNalu(nalu: Buffer, naluType: number) {\n    const checkNaluType = parseH265NaluType(nalu[0]);\n    if (checkNaluType === H265_NAL_TYPE_AGG) {\n        let pos = 1;\n        while (pos < nalu.length) {\n            const naluLength = nalu.readUInt16BE(pos);\n            pos += 2;\n            const stapaType = parseH265NaluType(nalu[pos]);\n            if (stapaType === naluType)\n                return nalu.subarray(pos, pos + naluLength);\n            pos += naluLength;\n        }\n    }\n    else if (checkNaluType === naluType) {\n        return nalu;\n    }\n    return;\n}\n\nexport function getStartedH264NaluTypes(streamChunk: StreamChunk) {\n    if (streamChunk.type !== 'h264')\n        return new Set<number>();\n    return getNaluTypesInNalu(streamChunk.chunks[streamChunk.chunks.length - 1].subarray(12), true)\n}\n\nexport function getNaluTypesInNalu(nalu: Buffer, fuaRequireStart = false, fuaRequireEnd = false) {\n    const ret = new Set<number>();\n    const naluType = parseH264NaluType(nalu[0]);\n    if (naluType === H264_NAL_TYPE_STAP_A) {\n        ret.add(H264_NAL_TYPE_STAP_A);\n        let pos = 1;\n        while (pos < nalu.length) {\n            const naluLength = nalu.readUInt16BE(pos);\n            pos += 2;\n            const stapaType = parseH264NaluType(nalu[pos]);\n            ret.add(stapaType);\n            pos += naluLength;\n        }\n    }\n    else if (naluType === H264_NAL_TYPE_FU_A) {\n        ret.add(H264_NAL_TYPE_FU_A);\n        const fuaType = parseH264NaluType(nalu[1]);\n        if (fuaRequireStart) {\n            const isFuStart = !!(nalu[1] & 0x80);\n            if (isFuStart)\n                ret.add(fuaType);\n        }\n        else if (fuaRequireEnd) {\n            const isFuEnd = !!(nalu[1] & 0x40);\n            if (isFuEnd)\n                ret.add(fuaType);\n        }\n        else {\n            ret.add(fuaType);\n        }\n    }\n    else {\n        ret.add(naluType);\n    }\n\n    return ret;\n}\n\nexport function getStartedH265NaluTypes(streamChunk: StreamChunk) {\n    if (streamChunk.type !== 'h265')\n        return new Set<number>();\n    return getNaluTypesInH265Nalu(streamChunk.chunks[streamChunk.chunks.length - 1].subarray(12), true)\n}\n\nexport function getNaluTypesInH265Nalu(nalu: Buffer, fuaRequireStart = false, fuaRequireEnd = false) {\n    const ret = new Set<number>();\n    const naluType = parseH265NaluType(nalu[0]);\n    if (naluType === H265_NAL_TYPE_AGG) {\n        ret.add(H265_NAL_TYPE_AGG);\n        let pos = 2;\n        while (pos < nalu.length) {\n            const naluLength = nalu.readUInt16BE(pos);\n            pos += 2;\n            const stapaType = parseH265NaluType(nalu[pos]);\n            ret.add(stapaType);\n            pos += naluLength;\n        }\n    }\n    else if (naluType === H265_NAL_TYPE_FU) {\n        ret.add(H265_NAL_TYPE_FU);\n        const fuaType = nalu[2] & 0x3F;  // 6 bits\n        if (fuaRequireStart) {\n            const isFuStart = !!(nalu[2] & 0x80);\n            if (isFuStart)\n                ret.add(fuaType);\n        }\n        else if (fuaRequireEnd) {\n            const isFuEnd = !!(nalu[2] & 0x40);\n            if (isFuEnd)\n                ret.add(fuaType);\n        }\n        else {\n            ret.add(fuaType);\n        }\n    }\n    else {\n        ret.add(naluType);\n    }\n\n    return ret;\n}\n\nexport function isH265KeyFrameRelatedInSet(naluTypes: Set<number>, allowCodecInfo = true) {\n    if (naluTypes.has(H265_NAL_TYPE_IDR_N_LP)\n        || naluTypes.has(H265_NAL_TYPE_IDR_W_RADL)\n        || naluTypes.has(H265_NAL_TYPE_CRA_NUT)\n        || naluTypes.has(H265_NAL_TYPE_BLA_N_LP)\n        || naluTypes.has(H265_NAL_TYPE_BLA_W_LP)\n        || naluTypes.has(H265_NAL_TYPE_BLA_W_RADL)) {\n        return true;\n    }\n\n    if (allowCodecInfo) {\n        if (naluTypes.has(H265_NAL_TYPE_VPS)\n            || naluTypes.has(H265_NAL_TYPE_SPS)\n            || naluTypes.has(H265_NAL_TYPE_PPS))\n            return true;\n    }\n    return false;\n}\n\n\nexport function createRtspParser(options?: StreamParserOptions): RtspStreamParser {\n    let resolve: any;\n\n    return {\n        container: 'rtsp',\n        tcpProtocol: 'rtsp://127.0.0.1/' + randomBytes(8).toString('hex'),\n        inputArguments: [\n            '-rtsp_transport',\n            'tcp',\n        ],\n        outputArguments: [\n            '-rtsp_transport',\n            'tcp',\n            ...(options?.vcodec || []),\n            ...(options?.acodec || []),\n            // linux and windows seem to support 64000 but darwin is 32000?\n            '-pkt_size', '32000',\n            '-f', 'rtsp',\n        ],\n        findSyncFrame(streamChunks: StreamChunk[]) {\n            for (let prebufferIndex = 0; prebufferIndex < streamChunks.length; prebufferIndex++) {\n                const streamChunk = streamChunks[prebufferIndex];\n                if (streamChunk.type === 'h264') {\n                    const naluTypes = getStartedH264NaluTypes(streamChunk);\n                    if (naluTypes.has(H264_NAL_TYPE_SPS) || naluTypes.has(H264_NAL_TYPE_IDR)) {\n                        return streamChunks.slice(prebufferIndex);\n                    }\n                }\n                else if (streamChunk.type === 'h265') {\n                    const naluTypes = getStartedH265NaluTypes(streamChunk);\n\n                    if (isH265KeyFrameRelatedInSet(naluTypes)) {\n                        return streamChunks.slice(prebufferIndex);\n                    }\n                }\n            }\n\n            // oh well!\n        },\n        sdp: new Promise<string>(r => resolve = r),\n        async *parse(duplex, width, height) {\n            const server = new RtspServer(duplex);\n            await server.handleSetup();\n            resolve(server.sdp);\n            for await (const { type, rtcp, header, packet } of server.handleRecord()) {\n                yield {\n                    chunks: [header, packet],\n                    type: `${rtcp ? 'rtcp-' : ''}${type}`,\n                    width,\n                    height,\n                }\n            }\n        }\n    }\n}\n\nexport function parseHeaders(headers: string[]): Headers {\n    const ret: any = {};\n    for (const header of headers.slice(1)) {\n        const index = header.indexOf(':');\n        let value = '';\n        if (index !== -1)\n            value = header.substring(index + 1).trim();\n        const key = header.substring(0, index).toLowerCase();\n        ret[key] = value;\n    }\n    return ret;\n}\n\nexport function getFirstAuthenticateHeader(headers: string[]): string {\n    for (const header of headers.slice(1)) {\n        const index = header.indexOf(':');\n        let value = '';\n        if (index !== -1)\n            value = header.substring(index + 1).trim();\n        const key = header.substring(0, index).toLowerCase();\n        if (key === 'www-authenticate')\n            return value;\n    }\n}\n\nexport function parseSemicolonDelimited(value: string) {\n    const dict: { [key: string]: string } = {};\n    for (const part of value.split(';')) {\n        const [key, value] = part.split('=', 2);\n        dict[key] = value;\n    }\n\n    return dict;\n}\n\nexport interface RtspStatus {\n    line: string,\n    code: number,\n    version: string,\n    reason: string,\n}\n\nexport interface RtspServerResponse {\n    headers: Headers;\n    body: Buffer;\n    status: RtspStatus;\n}\n\nexport class RtspStatusError extends Error {\n    constructor(public status: RtspStatus) {\n        super(`RTSP Error: ${status.line}`);\n    }\n}\n\nexport class RtspBase {\n    client: net.Socket;\n    console?: Console;\n\n    constructor() {\n    }\n\n    write(messageLine: string, headers: Headers, body?: Buffer) {\n        writeMessage(this.client, messageLine, body, headers, this.console);\n    }\n\n    async readMessage(): Promise<string[]> {\n        const message = await readMessage(this.client);\n        this.console?.log('rtsp incoming message\\n', message.join('\\n'));\n        this.console?.log();\n        return message;\n    }\n}\n\nconst quote = (str: string): string => `\"${str.replace(/\"/g, '\\\\\"')}\"`;\n\nexport interface RtspClientSetupOptions {\n    type: 'tcp' | 'udp';\n    path?: string;\n    onRtp: (rtspHeader: Buffer, rtp: Buffer) => void;\n}\n\nexport interface RtspClientTcpSetupOptions extends RtspClientSetupOptions {\n    type: 'tcp';\n    port: number;\n}\n\nexport interface RtspClientUdpSetupOptions extends RtspClientSetupOptions {\n    type: 'udp';\n    dgram?: dgram.Socket;\n}\n\n// probably only works with scrypted rtsp server.\nexport class RtspClient extends RtspBase {\n    cseq = 0;\n    session: string;\n    wwwAuthenticate: string;\n    requestTimeout: number;\n    needKeepAlive = false;\n    setupOptions = new Map<number, RtspClientTcpSetupOptions>();\n    issuedTeardown = false;\n    hasGetParameter = true;\n    contentBase: string;\n\n    constructor(public readonly url: string) {\n        super();\n        const u = new URL(url);\n        const port = parseInt(u.port) || 554;\n        if (url.startsWith('rtsps')) {\n            this.client = tls.connect({\n                rejectUnauthorized: false,\n                port,\n                host: u.hostname,\n            })\n        }\n        else {\n            this.client = net.connect(port, u.hostname);\n        }\n        this.client.on('error', e => {\n            this.console?.log('client error', e);\n        });\n    }\n\n    async safeTeardown() {\n        // issue a teardown to upstream to close gracefully\n        if (this.issuedTeardown)\n            return;\n        this.issuedTeardown = true;\n        try {\n            this.writeTeardown();\n            await sleep(500);\n        }\n        catch (e) {\n        }\n        finally {\n            // will trigger after teardown returns\n            this.client.destroy();\n        }\n    }\n\n    async writeRequest(method: string, headers?: Headers, path?: string, body?: Buffer) {\n        headers = headers || {};\n\n        let fullUrl: string;\n        if (!path) {\n            fullUrl = this.url;\n        }\n        else {\n            // a=control may be a full or \"relative\" url.\n            if (path.includes('rtsp://') || path.includes('rtsps://') || path === '*') {\n                fullUrl = path;\n            }\n            else {\n                fullUrl = this.contentBase || this.url;\n\n                // strangely, relative RTSP urls do not behave like expected from an HTTP-ish server.\n                // ffmpeg will happily suffix path segments after query strings:\n                // SETUP rtsp://localhost:5554/cam/realmonitor?channel=1&subtype=0/trackID=0 RTSP/1.0\n                fullUrl += (fullUrl.endsWith('/') ? '' : '/') + path;\n            }\n        }\n\n        const sanitized = new URL(fullUrl);\n        sanitized.username = '';\n        sanitized.password = '';\n\n        const line = `${method} ${sanitized} RTSP/1.0`;\n        const cseq = this.cseq++;\n        headers['CSeq'] = cseq.toString();\n        headers['User-Agent'] = 'Scrypted';\n\n        if (this.wwwAuthenticate)\n            headers['Authorization'] = await this.createAuthorizationHeader(method, new URL(fullUrl));\n\n        if (this.session)\n            headers['Session'] = this.session;\n\n        this.write(line, headers, body);\n    }\n\n    async handleDataPayload(header: Buffer) {\n        // todo: fix this, because calling teardown outside of the read loop causes this.\n        if (header[0] !== RTSP_FRAME_MAGIC)\n            throw new Error('RTSP Client received invalid frame magic. This may be a bug in your camera firmware. If this error persists, switch your RTSP Parser to FFmpeg or Scrypted (UDP): ' + header.toString());\n\n        const channel = header.readUInt8(1);\n        const length = header.readUInt16BE(2);\n        const data = await readLength(this.client, length);\n\n        const options = this.setupOptions.get(channel);\n        options?.onRtp?.(header, data);\n    }\n\n    async readDataPayload() {\n        const header = await readLength(this.client, 4);\n        return this.handleDataPayload(header);\n    }\n\n    createBadHeader(header: Buffer) {\n        return new Error('RTSP Client received invalid frame magic. This may be a bug in your camera firmware. If this error persists, switch your RTSP Parser to FFmpeg or Scrypted (UDP): ' + header.toString());\n    }\n\n    async readLoopLegacy() {\n        try {\n            while (true) {\n                if (this.needKeepAlive) {\n                    this.needKeepAlive = false;\n                    if (this.hasGetParameter)\n                        await this.getParameter();\n                    else\n                        await this.options();\n                }\n                await this.readDataPayload();\n            }\n        }\n        catch (e) {\n            this.client.destroy(e as Error);\n            throw e;\n        }\n    }\n\n    async *handleStream(): AsyncGenerator<{\n        rtcp: boolean,\n        header: Buffer,\n        packet: Buffer,\n        channel: number,\n    }> {\n        while (true) {\n            const header = await readLength(this.client, 4);\n            // can this even happen? since the RTSP request method isn't a fixed\n            // value like the \"RTSP\" in the RTSP response, I don't think so?\n            if (header[0] !== RTSP_FRAME_MAGIC) {\n                if (header.toString() !== 'RTSP')\n                    throw this.createBadHeader(header);\n\n                this.client.unshift(header);\n\n                // do what with this?\n                const message = await super.readMessage();\n                const body = await this.readBody(parseHeaders(message));\n\n                continue;\n            }\n\n            const length = header.readUInt16BE(2);\n            const packet = await readLength(this.client, length);\n            const id = header.readUInt8(1);\n\n            yield {\n                channel: id,\n                rtcp: id % 2 === 1,\n                header,\n                packet,\n            }\n        }\n    }\n\n    async readLoop() {\n        const deferred = new Deferred<void>();\n\n        let header: Buffer;\n        let channel: number;\n        let length: number;\n\n        const read = async () => {\n            if (this.needKeepAlive) {\n                this.needKeepAlive = false;\n                if (this.hasGetParameter)\n                    this.writeGetParameter();\n                else\n                    this.writeOptions();\n            }\n\n            try {\n                while (true) {\n                    // get header if needed\n                    if (!header) {\n                        header = this.client.read(4);\n\n                        if (!header)\n                            return;\n\n                        // validate header once.\n                        if (header[0] !== RTSP_FRAME_MAGIC) {\n                            if (header.toString() !== 'RTSP')\n                                throw this.createBadHeader(header);\n\n                            this.client.unshift(header);\n                            header = undefined;\n\n                            // remove the listener to operate in pull mode.\n                            this.client.removeListener('readable', read);\n\n                            // do what with this?\n                            const message = await super.readMessage();\n                            const body = await this.readBody(parseHeaders(message));\n\n                            // readd the listener to operate in streaming mode.\n                            this.client.on('readable', read);\n\n                            continue;\n                        }\n\n                        channel = header.readUInt8(1);\n                        length = header.readUInt16BE(2);\n                    }\n\n                    const data = this.client.read(length);\n                    if (!data)\n                        return;\n\n                    const h = header;\n                    header = undefined;\n                    const options = this.setupOptions.get(channel);\n                    options?.onRtp?.(h, data);\n                }\n            }\n            catch (e) {\n                if (!deferred.finished)\n                    deferred.reject(e as Error);\n                this.client.destroy();\n            }\n        };\n\n        read();\n        this.client.on('readable', read);\n\n        await Promise.all([once(this.client, 'end')]);\n    }\n\n    // rtsp over tcp will actually interleave RTSP request/responses\n    // within the RTSP data stream. The only way to tell if it's a request/response\n    // is to see if the header + data starts with RTSP/1.0 message line.\n    // Or RTSP, if looking at only the header bytes. Then grab the response out.\n    async readMessage(): Promise<string[]> {\n        while (true) {\n            const header = await readLength(this.client, 4);\n            if (header[0] !== RTSP_FRAME_MAGIC) {\n                if (header.toString() === 'RTSP') {\n                    this.client.unshift(header);\n                    const message = await super.readMessage();\n                    return message;\n                }\n                throw this.createBadHeader(header);\n            }\n\n            await this.handleDataPayload(header);\n        }\n    }\n\n    async createAuthorizationHeader(method: string, url: URL) {\n        if (!this.wwwAuthenticate)\n            throw new Error('no WWW-Authenticate found');\n\n        const { BASIC } = await import('http-auth-utils');\n        // @ts-ignore\n        const { parseHTTPHeadersQuotedKeyValueSet } = await import('http-auth-utils/dist/utils');\n\n        const authedUrl = new URL(this.url);\n        const username = decodeURIComponent(authedUrl.username);\n        const password = decodeURIComponent(authedUrl.password);\n\n        if (this.wwwAuthenticate.includes('Basic')) {\n            const hash = BASIC.computeHash({ username, password });\n            return `Basic ${hash}`;\n        }\n\n        // hikvision sends out of spec 'random' name and value parameter,\n        // which causes the digest auth lib to fail. so, need to parse the header\n        // manually with a relax set of authorized parameters.\n        // https://github.com/koush/scrypted/issues/344#issuecomment-1223627956\n        // https://github.com/nfroidure/http-auth-utils/blob/7532d21a419ad098d1240c9e1b55855020df5d7f/src/mechanisms/digest.ts#L97\n        // const wwwAuth = DIGEST.parseWWWAuthenticateRest(this.wwwAuthenticate);\n        const wwwAuth = parseHTTPHeadersQuotedKeyValueSet(\n            this.wwwAuthenticate,\n            // the parser will call indexOf to see if the key is authorized. monkey patch this call.\n            // https://github.com/nfroidure/http-auth-utils/blob/17186d3eefb86535916d044c7f59a340bc765603/src/utils.ts#L43\n            {\n                indexOf: () => 0,\n            } as any,\n            REQUIRED_WWW_AUTHENTICATE_KEYS,\n        ) as DigestWWWAuthenticateData;\n\n        const strippedUrl = new URL(url.toString());\n        strippedUrl.username = '';\n        strippedUrl.password = '';\n\n        const ha1 = crypto.createHash('md5').update(`${username}:${wwwAuth.realm}:${password}`).digest('hex');\n        const ha2 = crypto.createHash('md5').update(`${method}:${strippedUrl}`).digest('hex');\n        const hash = crypto.createHash('md5').update(`${ha1}:${wwwAuth.nonce}:${ha2}`).digest('hex');\n\n        const params = {\n            username,\n            realm: wwwAuth.realm,\n            nonce: wwwAuth.nonce,\n            uri: strippedUrl.toString(),\n            algorithm: 'MD5',\n            response: hash,\n        };\n\n        const paramsString = Object.entries(params).map(([key, value]) => `${key}=${value && quote(value)}`).join(', ');\n        return `Digest ${paramsString}`;\n    }\n\n    async readBody(response: Headers) {\n        return readBody(this.client, response);\n    }\n\n    async request(method: string, headers?: Headers, path?: string, body?: Buffer, authenticating?: boolean): Promise<RtspServerResponse> {\n        await this.writeRequest(method, headers, path, body);\n\n        const message = this.requestTimeout ? await timeoutPromise(this.requestTimeout, this.readMessage()) : await this.readMessage();\n        const statusLine = message[0];\n        const [version, codeString, reason] = statusLine.split(' ', 3);\n        const code = parseInt(codeString);\n        const response = parseHeaders(message);\n\n        const status = {\n            line: statusLine,\n            code,\n            version,\n            reason,\n        };\n\n        if (code !== 200 && !response['www-authenticate'])\n            throw new RtspStatusError(status);\n\n        // it seems that the first www-authenticate header should be used, as latter ones that are\n        // offered are not actually valid? weird issue seen on tp-link that offers both DIGEST and BASIC.\n        const wwwAuthenticate = getFirstAuthenticateHeader(message) || response['www-authenticate']\n        if (wwwAuthenticate) {\n            if (authenticating)\n                throw new Error('auth failed');\n\n            this.wwwAuthenticate = wwwAuthenticate;\n\n            return this.request(method, headers, path, body, true);\n        }\n        return {\n            headers: response,\n            body: await this.readBody(response),\n            status,\n        }\n    }\n\n    async options() {\n        const headers: Headers = {};\n        const ret = await this.request('OPTIONS', headers);\n        const publicHeader = ret.headers['public'];\n        if (publicHeader)\n            this.hasGetParameter = publicHeader.toLowerCase().includes('get_parameter');\n        return ret;\n    }\n\n    writeOptions() {\n        return this.writeRequest('OPTIONS');\n    }\n\n    async getParameter() {\n        return this.request('GET_PARAMETER');\n    }\n\n    writeGetParameter() {\n        return this.writeRequest('GET_PARAMETER');\n    }\n\n    async describe(headers?: Headers) {\n        const response = await this.request('DESCRIBE', {\n            ...(headers || {}),\n            Accept: 'application/sdp',\n        });\n\n        this.contentBase = response.headers['content-base'] || response.headers['content-location'];\n        // content base may be a relative path? seems odd.\n        if (this.contentBase)\n            this.contentBase = new URL(this.contentBase, this.url).toString();\n        return response;\n    }\n\n    async setup(options: RtspClientTcpSetupOptions | RtspClientUdpSetupOptions, headers?: Headers) {\n        const protocol = options.type === 'udp' ? '' : '/TCP';\n        const client = options.type === 'udp' ? 'client_port' : 'interleaved';\n        let port: number;\n        if (options.type === 'tcp') {\n            port = options.port;\n        }\n        else {\n            if (!options.dgram) {\n                const udp = await createBindZero();\n                options.dgram = udp.server;\n                this.client.on('close', () => closeQuiet(udp.server));\n            }\n            port = options.dgram.address().port;\n            options.dgram.on('message', data => options.onRtp(undefined, data));\n        }\n        headers = Object.assign({\n            Transport: `RTP/AVP${protocol};unicast;${client}=${port}-${port + 1}`,\n        }, headers);\n        const response = await this.request('SETUP', headers, options.path);\n        let interleaved: {\n            begin: number;\n            end: number;\n        };\n        if (response.headers.session) {\n            const sessionDict = parseSemicolonDelimited(response.headers.session);\n            let timeout = parseInt(sessionDict['timeout']);\n            if (timeout) {\n                // if a timeout is requested, need to keep the session alive with periodic refresh.\n                // one suggestion is calling OPTIONS, but apparently GET_PARAMETER is more reliable.\n                // https://stackoverflow.com/a/39818378\n                let interval = (timeout - 5) * 1000;\n                let timer = setInterval(() => this.needKeepAlive = true, interval);\n                this.client.once('close', () => clearInterval(timer));\n            }\n\n            this.session = response.headers.session.split(';')[0];\n        }\n        if (response.headers.transport) {\n            const match = response.headers.transport.match(/.*?interleaved=([0-9]+)-([0-9]+)/);\n            if (match) {\n                const [_, begin, end] = match;\n                if (begin && end) {\n                    interleaved = {\n                        begin: parseInt(begin),\n                        end: parseInt(end),\n                    };\n                }\n            }\n        }\n        if (options.type === 'tcp')\n            this.setupOptions.set(interleaved ? interleaved.begin : port, options);\n        return Object.assign({ interleaved, options }, response);\n    }\n\n    async play(headers: Headers = {}, start = '0.000') {\n        headers['Range'] = `npt=${start}-`;\n        return this.request('PLAY', headers);\n    }\n\n    writePlay(start: string = '0.000') {\n        const headers: any = {\n            Range: `npt=${start}-`,\n        };\n        return this.writeRequest('PLAY', headers);\n    }\n\n    writeRtpPayload(header: Buffer, rtp: Buffer) {\n        this.client.write(header);\n        return this.client.write(Buffer.from(rtp));\n    }\n\n    send(rtp: Buffer, channel: number) {\n        const header = Buffer.alloc(4);\n        header.writeUInt8(RTSP_FRAME_MAGIC, 0);\n        header.writeUInt8(channel, 1);\n        header.writeUInt16BE(rtp.length, 2);\n\n        return this.writeRtpPayload(header, rtp);\n    }\n\n    async pause() {\n        return this.request('PAUSE');\n    }\n\n    async teardown() {\n        try {\n            // todo: fix this, because calling teardown outside of the read loop causes this.\n            return await this.request('TEARDOWN');\n        }\n        finally {\n            this.client.destroy();\n        }\n    }\n\n    writeTeardown() {\n        this.writeRequest('TEARDOWN');\n    }\n}\n\nexport interface RtspTrack {\n    protocol: 'tcp' | 'udp';\n    destination: number;\n    codec: string;\n    control: string;\n    rtp?: dgram.Socket;\n    rtcp?: dgram.Socket;\n}\n\nexport class RtspServer {\n    session: string;\n    console: Console;\n    setupTracks: {\n        [trackId: string]: RtspTrack;\n    } = {};\n\n    constructor(public client: Duplex, public sdp?: string, public udp?: boolean, public checkRequest?: (method: string, url: string, headers: Headers, rawMessage: string[]) => Promise<boolean>) {\n        this.session = randomBytes(4).toString('hex');\n        if (sdp)\n            sdp = sdp.trim();\n\n        if (client instanceof net.Socket)\n            client.setNoDelay(true);\n    }\n\n    async handleSetup(methods = ['play', 'record', 'teardown']) {\n        let currentHeaders: string[] = [];\n        while (true) {\n            let line = await readLine(this.client);\n            line = line.trim();\n            if (!line) {\n                const method = await this.headers(currentHeaders);\n                if (methods.includes(method))\n                    return method;\n                currentHeaders = [];\n                continue;\n            }\n            currentHeaders.push(line);\n        }\n    }\n\n    async handlePlayback() {\n        return this.handleSetup();\n    }\n\n    async handleTeardown() {\n        return this.handleSetup();\n    }\n\n    async *handleRecord(): AsyncGenerator<{\n        type: string,\n        rtcp: boolean,\n        header: Buffer,\n        packet: Buffer,\n    }> {\n        while (true) {\n            const header = await readLength(this.client, 4);\n            // can this even happen? since the RTSP request method isn't a fixed\n            // value like the \"RTSP\" in the RTSP response, I don't think so?\n            if (header[0] !== RTSP_FRAME_MAGIC)\n                throw new Error('RTSP Server expected frame magic but received: ' + header.toString());\n            const length = header.readUInt16BE(2);\n            const packet = await readLength(this.client, length);\n            const id = header.readUInt8(1);\n            const destination = id - (id % 2);\n            const track = Object.values(this.setupTracks).find(track => track.destination === destination);\n            if (!track)\n                throw new Error('RSTP Server received unknown channel: ' + id);\n\n            yield {\n                type: track.codec,\n                rtcp: id % 2 === 1,\n                header,\n                packet,\n            }\n        }\n    }\n\n    writeRtpPayload(header: Buffer, rtp: Buffer) {\n        this.client.write(header);\n        return this.client.write(Buffer.from(rtp));\n    }\n\n    send(rtp: Buffer, channel: number) {\n        const header = Buffer.alloc(4);\n        header.writeUInt8(36, 0);\n        header.writeUInt8(channel, 1);\n        header.writeUInt16BE(rtp.length, 2);\n\n        return this.writeRtpPayload(header, rtp);\n    }\n\n    sendUdp(udp: dgram.Socket, port: number, packet: Buffer) {\n        // todo: support non local host?\n        udp.send(packet, port, '127.0.0.1');\n    }\n\n    sendTrack(trackId: string, packet: Buffer, rtcp: boolean) {\n        const track = this.setupTracks[trackId];\n        if (!track) {\n            this.console?.warn('RTSP Server track not found:', trackId);\n            return true;\n        }\n\n        if (track.protocol === 'udp') {\n            if (!this.udp)\n                this.console?.warn('RTSP Server UDP socket not available.');\n            else\n                this.sendUdp(rtcp ? track.rtcp : track.rtp, track.destination, packet);\n            return true;\n        }\n\n        return this.send(packet, rtcp ? track.destination + 1 : track.destination);\n    }\n\n    availableOptions = ['DESCRIBE', 'OPTIONS', 'PAUSE', 'PLAY', 'SETUP', 'TEARDOWN', 'ANNOUNCE', 'RECORD', 'GET_PARAMETER'];\n    options(url: string, requestHeaders: Headers) {\n        const headers: Headers = {};\n        headers['Public'] = this.availableOptions.join(', ');\n\n        this.respond(200, 'OK', requestHeaders, headers);\n    }\n\n    async get_parameter(url: string, requestHeaders: Headers) {\n        const headers: Headers = {};\n        this.respond(200, 'OK', requestHeaders, headers);\n    }\n\n    describe(url: string, requestHeaders: Headers) {\n        const headers: Headers = {};\n        headers['Content-Base'] = url;\n        headers['Content-Type'] = 'application/sdp';\n        this.respond(200, 'OK', requestHeaders, headers, Buffer.from(this.sdp))\n    }\n\n    setupInterleaved(msection: MSection, low: number, high: number) {\n        this.setupTracks[msection.control] = {\n            control: msection.control,\n            protocol: 'tcp',\n            destination: low,\n            codec: msection.codec,\n        }\n    }\n\n\n    resolveInterleaved?: (msection: MSection) => [number, number];\n\n    // todo: use the sdp itself to determine the audio/video track ids so\n    // rewriting is not necessary.\n    async setup(url: string, requestHeaders: Headers) {\n        const headers: Headers = {};\n        let transport = requestHeaders['transport'];\n        headers['Session'] = this.session;\n        const parsedSdp = parseSdp(this.sdp);\n        const msection = parsedSdp.msections.find(msection => url.endsWith(msection.control));\n        if (!msection) {\n            this.respond(404, 'Not Found', requestHeaders, headers);\n            return;\n        }\n\n        if (transport.includes('TCP')) {\n            if (this.resolveInterleaved) {\n                const [low, high] = this.resolveInterleaved(msection);\n                this.setupInterleaved(msection, low, high);\n                transport = `RTP/AVP/TCP;unicast;interleaved=${low}-${high}`;\n            }\n            else {\n                const match = transport.match(/.*?interleaved=([0-9]+)-([0-9]+)/);\n                if (match) {\n                    const low = parseInt(match[1]);\n                    const high = parseInt(match[2]);\n                    this.setupInterleaved(msection, low, high);\n                }\n            }\n        }\n        else {\n            if (!this.udp) {\n                this.respond(461, 'Unsupported Transport', requestHeaders, {});\n                return;\n            }\n            const match = transport.match(/.*?client_port=([0-9]+)-([0-9]+)/);\n            const [_, rtp, rtcp] = match;\n\n            const [rtpServer, rtcpServer] = await createSquentialBindZero();\n            this.client.on('close', () => closeQuiet(rtpServer.server));\n            this.client.on('close', () => closeQuiet(rtcpServer.server));\n            this.setupTracks[msection.control] = {\n                control: msection.control,\n                protocol: 'udp',\n                destination: parseInt(rtp),\n                codec: msection.codec,\n                rtp: rtpServer.server,\n                rtcp: rtcpServer.server,\n            }\n            transport = transport.replace('RTP/AVP/UDP', 'RTP/AVP').replace('RTP/AVP', 'RTP/AVP/UDP');\n            transport += `;server_port=${rtpServer.port}-${rtcpServer.port}`;\n        }\n        headers['Transport'] = transport;\n        this.respond(200, 'OK', requestHeaders, headers)\n    }\n\n    play(url: string, requestHeaders: Headers) {\n        const headers: Headers = {};\n        const rtpInfos = Object.values(this.setupTracks).map(track => `url=${url}/${track.control}`);\n        // seq/rtptime was causing issues with gstreamer. commented out.\n        const rtpInfo = rtpInfos.join(','); // + ';seq=0;rtptime=0';\n        headers['RTP-Info'] = rtpInfo;\n        headers['Range'] = 'npt=now-';\n        headers['Session'] = this.session;\n        this.respond(200, 'OK', requestHeaders, headers);\n    }\n\n    async announce(url: string, requestHeaders: Headers) {\n        const contentLength = parseInt(requestHeaders['content-length']);\n        const sdpBuffer = await readLength(this.client, contentLength);\n        this.sdp = sdpBuffer.toString();\n        const headers: Headers = {};\n        headers['Session'] = this.session;\n\n        this.respond(200, 'OK', requestHeaders, headers);\n    }\n\n    async record(url: string, requestHeaders: Headers) {\n        const headers: Headers = {};\n        headers['Session'] = this.session;\n        this.respond(200, 'OK', requestHeaders, headers);\n    }\n\n    async teardown(url: string, requestHeaders: Headers) {\n        const headers: Headers = {};\n        headers['Session'] = this.session;\n        this.respond(200, 'OK', requestHeaders, headers);\n        this.client.destroy();\n    }\n\n    async headers(headers: string[]) {\n        this.console?.log('request headers', headers.join('\\n'));\n\n        let [method, url] = headers[0].split(' ', 2);\n        method = method.toLowerCase();\n        const requestHeaders = parseHeaders(headers);\n        if (this.checkRequest) {\n            let allow: boolean;\n            try {\n                allow = await this.checkRequest(method, url, requestHeaders, headers)\n            }\n            catch (e) {\n                this.console?.error('error checking request', e);\n            }\n            if (!allow) {\n                this.respond(400, 'Bad Request', requestHeaders, {});\n                this.client.destroy();\n                throw new Error('check request failed');\n            }\n        }\n\n        const thisAny = this as any;\n        if (!thisAny[method] || !this.availableOptions.includes(method.toUpperCase())) {\n            this.respond(400, 'Bad Request', requestHeaders, {});\n            return;\n        }\n\n        await thisAny[method](url, requestHeaders);\n        return method;\n    }\n\n    respond(code: number, message: string, requestHeaders: Headers, headers: Headers, buffer?: Buffer) {\n        let response = `RTSP/1.0 ${code} ${message}\\r\\n`;\n        if (requestHeaders['cseq'])\n            headers['CSeq'] = requestHeaders['cseq'];\n        if (buffer)\n            headers['Content-Length'] = buffer.length.toString();\n        for (const [key, value] of Object.entries(headers)) {\n            response += `${key}: ${value}\\r\\n`;\n        }\n        this.console?.log('response headers', response);\n        response += '\\r\\n';\n        this.client.write(response);\n        if (buffer) {\n            this.client.write(buffer);\n            this.console?.log('response body', buffer.toString());\n        }\n    }\n\n    destroy() {\n        this.client.destroy();\n        for (const track of Object.values(this.setupTracks)) {\n            closeQuiet(track.rtp);\n            closeQuiet(track.rtcp);\n        }\n    }\n}\n\nexport async function listenSingleRtspClient<T extends RtspServer>(options?: {\n    hostname: string,\n    pathToken?: string,\n    createServer?(duplex: Duplex): T,\n}) {\n    const pathToken = options?.pathToken || crypto.randomBytes(8).toString('hex');\n    let { url, clientPromise, server } = await listenZeroSingleClient(options?.hostname);\n\n    const rtspServerPath = '/' + pathToken;\n    url = url.replace('tcp:', 'rtsp:') + rtspServerPath;\n\n    const rtspServerPromise = clientPromise.then(client => {\n        const createServer = options?.createServer || (duplex => new RtspServer(duplex));\n\n        const rtspServer = createServer(client);\n        rtspServer.checkRequest = async (method, url, headers, message) => {\n            rtspServer.checkRequest = undefined;\n            const u = new URL(url);\n            return u.pathname === rtspServerPath;\n        };\n        return rtspServer as T;\n    });\n\n    return {\n        url,\n        rtspServerPromise,\n        server,\n    }\n}\n","export * from \"./context/cipher\";\nexport * from \"./context/srtp\";\nexport * from \"./cipher/const\";\nexport { DtlsClient } from \"./client\";\nexport { DtlsServer } from \"./server\";\nexport { DtlsSocket } from \"./socket\";\n\n/* Client                                          Server\n   ------                                          ------\n\n   ClientHello             -------->                           Flight 1\n\n\t\t\t\t\t\t   <-------    HelloVerifyRequest      Flight 2\n\n   ClientHello             -------->                           Flight 3\n\n\t\t\t\t\t\t\t\t\t\t\t  ServerHello    \\\n\t\t\t\t\t\t\t\t\t\t\t Certificate*     \\\n\t\t\t\t\t\t\t\t\t   ServerKeyExchange*      Flight 4\n\t\t\t\t\t\t\t\t\t  CertificateRequest*     /\n\t\t\t\t\t\t   <--------      ServerHelloDone    /\n\n   Certificate*                                              \\\n   ClientKeyExchange                                          \\\n   CertificateVerify*                                          Flight 5\n   [ChangeCipherSpec]                                         /\n   Finished                -------->                         /\n\n\t\t\t\t\t\t\t\t\t   [ChangeCipherSpec]    \\ Flight 6\n\t\t\t\t\t\t   <--------             Finished    /\n\n\t\t\t   Figure 1. Message Flights for Full Handshake\n\n=======================================================================\n\n   Client                                           Server\n   ------                                           ------\n\n   ClientHello             -------->                          Flight 1\n\n\t\t\t\t\t\t\t\t\t\t\t  ServerHello    \\\n\t\t\t\t\t\t\t\t\t   [ChangeCipherSpec]     Flight 2\n\t\t\t\t\t\t\t<--------             Finished    /\n\n   [ChangeCipherSpec]                                         \\Flight 3\n   Finished                 -------->                         /\n\n\t\t Figure 2. Message Flights for Session-Resuming Handshake\n\t\t\t\t\t\t   (No Cookie Exchange)\n*/\n\n// enum HandshakeType {\n//   hello_request = 0,\n//   client_hello = 1,\n//   server_hello = 2,\n//   hello_verify_request = 3,\n//   certificate = 11,\n//   server_key_exchange = 12,\n//   certificate_request = 13,\n//   server_hello_done = 14,\n//   certificate_verify = 15,\n//   client_key_exchange = 16,\n//   finished = 20,\n// }\n\n// enum ContentType {\n//   changeCipherSpec = 20,\n//   alert = 21,\n//   handshake = 22,\n//   applicationData = 23,\n// }\n\n// enum {\n//   close_notify(0),\n//   unexpected_message(10),\n//   bad_record_mac(20),\n//   decryption_failed_RESERVED(21),\n//   record_overflow(22),\n//   decompression_failure(30),\n//   handshake_failure(40),\n//   no_certificate_RESERVED(41),\n//   bad_certificate(42),\n//   unsupported_certificate(43),\n//   certificate_revoked(44),\n//   certificate_expired(45),\n//   certificate_unknown(46),\n//   illegal_parameter(47),\n//   unknown_ca(48),\n//   access_denied(49),\n//   decode_error(50),\n//   decrypt_error(51),\n//   export_restriction_RESERVED(60),\n//   protocol_version(70),\n//   insufficient_security(71),\n//   internal_error(80),\n//   user_canceled(90),\n//   no_renegotiation(100),\n//   unsupported_extension(110),\n//   (255)\n// } AlertDescription;\n","import { randomBytes } from \"crypto\";\nimport { isIPv4 } from \"net\";\n\nimport * as Int64 from \"int64-buffer\";\n\nimport isEqual from \"fast-deep-equal\";\nimport timers from \"timers/promises\";\nimport { type Address, Event, debug } from \"./imports/common\";\n\nimport { Candidate, candidateFoundation, candidatePriority } from \"./candidate\";\nimport { MdnsLookup } from \"./dns/lookup\";\nimport type { TransactionError } from \"./exceptions\";\nimport { type Cancelable, PQueue, cancelable, randomString } from \"./helper\";\nimport {\n  CONSENT_FAILURES,\n  CONSENT_INTERVAL,\n  CandidatePair,\n  CandidatePairState,\n  ICE_COMPLETED,\n  ICE_FAILED,\n  type IceConnection,\n  type IceOptions,\n  type IceState,\n  defaultOptions,\n  serverReflexiveCandidate,\n  sortCandidatePairs,\n  validateAddress,\n  validateRemoteCandidate,\n} from \"./iceBase\";\nimport { classes, methods } from \"./stun/const\";\nimport { Message } from \"./stun/message\";\nimport { StunProtocol } from \"./stun/protocol\";\nimport { createStunOverTurnClient } from \"./turn/protocol\";\nimport type { Protocol } from \"./types/model\";\nimport { getHostAddresses } from \"./utils\";\n\nconst log = debug(\"werift-ice : packages/ice/src/ice.ts : log\");\n\nexport class Connection implements IceConnection {\n  localUsername = randomString(4);\n  localPassword = randomString(22);\n  remoteIsLite = false;\n  remotePassword: string = \"\";\n  remoteUsername: string = \"\";\n  checkList: CandidatePair[] = [];\n  localCandidates: Candidate[] = [];\n  stunServer?: Address;\n  turnServer?: Address;\n  options: IceOptions;\n  remoteCandidatesEnd = false;\n  localCandidatesEnd = false;\n  generation = -1;\n  userHistory: { [username: string]: string } = {};\n  private readonly tieBreaker: bigint = BigInt(\n    new Int64.Uint64BE(randomBytes(64)).toString(),\n  );\n  state: IceState = \"new\";\n  lookup?: MdnsLookup;\n\n  private _remoteCandidates: Candidate[] = [];\n  // P2P\n  nominated?: CandidatePair;\n  private nominating = false;\n  private checkListDone = false;\n  private checkListState = new PQueue<number>();\n  private earlyChecks: [Message, Address, Protocol][] = [];\n  private earlyChecksDone = false;\n  private localCandidatesStart = false;\n  private protocols: Protocol[] = [];\n  private queryConsentHandle?: Cancelable<void>;\n\n  readonly onData = new Event<[Buffer]>();\n  readonly stateChanged = new Event<[IceState]>();\n  readonly onIceCandidate: Event<[Candidate]> = new Event();\n\n  constructor(\n    private _iceControlling: boolean,\n    options?: Partial<IceOptions>,\n  ) {\n    this.options = {\n      ...defaultOptions,\n      ...options,\n    };\n    const { stunServer, turnServer } = this.options;\n    this.stunServer = validateAddress(stunServer) ?? [\n      \"stun.l.google.com\",\n      19302,\n    ];\n    this.turnServer = validateAddress(turnServer);\n    this.restart();\n    log(\"new Connection\", this.options);\n  }\n\n  get iceControlling() {\n    return this._iceControlling;\n  }\n\n  set iceControlling(value: boolean) {\n    if (this.generation > 0 || this.nominated) {\n      return;\n    }\n    this._iceControlling = value;\n    for (const pair of this.checkList) {\n      pair.iceControlling = value;\n    }\n  }\n\n  async restart() {\n    this.generation++;\n\n    this.localUsername = randomString(4);\n    this.localPassword = randomString(22);\n    if (this.options.localPasswordPrefix) {\n      this.localPassword =\n        this.options.localPasswordPrefix +\n        this.localPassword.slice(this.options.localPasswordPrefix.length);\n    }\n    this.userHistory[this.localUsername] = this.localPassword;\n\n    this.remoteUsername = \"\";\n    this.remotePassword = \"\";\n    this.localCandidates = [];\n    this._remoteCandidates = [];\n    this.remoteCandidatesEnd = false;\n    this.localCandidatesEnd = false;\n    this.state = \"new\";\n    this.lookup?.close?.();\n    this.lookup = undefined;\n    this.nominated = undefined;\n    this.nominating = false;\n    this.checkList = [];\n    this.checkListDone = false;\n    this.checkListState = new PQueue<number>();\n    this.earlyChecks = [];\n    this.earlyChecksDone = false;\n    this.localCandidatesStart = false;\n\n    // protocolsincomingearlyCheck\n    for (const protocol of this.protocols) {\n      if (protocol.localCandidate) {\n        protocol.localCandidate.generation = this.generation;\n        protocol.localCandidate.ufrag = this.localUsername;\n      }\n    }\n\n    this.queryConsentHandle?.resolve?.();\n    this.queryConsentHandle = undefined;\n  }\n\n  resetNominatedPair() {\n    log(\"resetNominatedPair\");\n    this.nominated = undefined;\n    this.nominating = false;\n  }\n\n  setRemoteParams({\n    iceLite,\n    usernameFragment,\n    password,\n  }: {\n    iceLite: boolean;\n    usernameFragment: string;\n    password: string;\n  }) {\n    log(\"setRemoteParams\", { iceLite, usernameFragment, password });\n    this.remoteIsLite = iceLite;\n    this.remoteUsername = usernameFragment;\n    this.remotePassword = password;\n  }\n\n  // 4.1.1 Gathering Candidates\n  async gatherCandidates() {\n    if (!this.localCandidatesStart) {\n      this.localCandidatesStart = true;\n\n      let address = getHostAddresses(\n        this.options.useIpv4,\n        this.options.useIpv6,\n        {\n          useLinkLocalAddress: this.options.useLinkLocalAddress,\n        },\n      );\n      const { interfaceAddresses } = this.options;\n      if (interfaceAddresses) {\n        const filteredAddresses = address.filter((check) =>\n          Object.values(interfaceAddresses).includes(check),\n        );\n        if (filteredAddresses.length) {\n          address = filteredAddresses;\n        }\n      }\n      if (this.options.additionalHostAddresses) {\n        address = Array.from(\n          new Set([...this.options.additionalHostAddresses, ...address]),\n        );\n      }\n\n      const candidatePromises = this.getCandidatePromises(address, 5);\n      await Promise.allSettled(candidatePromises);\n\n      this.localCandidatesEnd = true;\n    }\n    this.setState(\"completed\");\n  }\n\n  private appendLocalCandidate(candidate: Candidate) {\n    this.localCandidates.push(candidate);\n    this.onIceCandidate.execute(candidate);\n  }\n\n  private ensureProtocol(protocol: Protocol) {\n    protocol.onRequestReceived.subscribe((msg, addr, data) => {\n      if (msg.messageMethod !== methods.BINDING) {\n        this.respondError(msg, addr, protocol, [400, \"Bad Request\"]);\n        return;\n      }\n\n      const txUsername = msg.getAttributeValue(\"USERNAME\");\n      // remotelocal\n      const { remoteUsername: localUsername } = decodeTxUsername(txUsername);\n      const localPassword =\n        this.userHistory[localUsername] ?? this.localPassword;\n\n      const { iceControlling } = this;\n\n      // 7.2.1.1.  Detecting and Repairing Role Conflicts\n      if (iceControlling && msg.attributesKeys.includes(\"ICE-CONTROLLING\")) {\n        if (this.tieBreaker >= msg.getAttributeValue(\"ICE-CONTROLLING\")) {\n          this.respondError(msg, addr, protocol, [487, \"Role Conflict\"]);\n          return;\n        } else {\n          this.switchRole(false);\n        }\n      } else if (\n        !iceControlling &&\n        msg.attributesKeys.includes(\"ICE-CONTROLLED\")\n      ) {\n        if (this.tieBreaker < msg.getAttributeValue(\"ICE-CONTROLLED\")) {\n          this.respondError(msg, addr, protocol, [487, \"Role Conflict\"]);\n        } else {\n          this.switchRole(true);\n          return;\n        }\n      }\n\n      if (\n        this.options.filterStunResponse &&\n        !this.options.filterStunResponse(msg, addr, protocol)\n      ) {\n        return;\n      }\n\n      // # send binding response\n      const response = new Message(\n        methods.BINDING,\n        classes.RESPONSE,\n        msg.transactionId,\n      );\n\n      response\n        .setAttribute(\"XOR-MAPPED-ADDRESS\", addr)\n        .addMessageIntegrity(Buffer.from(localPassword, \"utf8\"))\n        .addFingerprint();\n      protocol.sendStun(response, addr).catch((e) => {\n        log(\"sendStun error\", e);\n      });\n\n      if (this.checkList.length === 0 && !this.earlyChecksDone) {\n        this.earlyChecks.push([msg, addr, protocol]);\n      } else {\n        this.checkIncoming(msg, addr, protocol);\n      }\n    });\n    protocol.onDataReceived.subscribe((data) => {\n      try {\n        // Update statistics for the nominated pair\n        const activePair = this.nominated;\n        if (activePair && activePair.protocol === protocol) {\n          activePair.packetsReceived++;\n          activePair.bytesReceived += data.length;\n        }\n\n        this.onData.execute(data);\n      } catch (error) {\n        log(\"dataReceived\", error);\n      }\n    });\n  }\n\n  private getCandidatePromises(addresses: string[], timeout = 5) {\n    let candidatePromises: Promise<Candidate | void>[] = [];\n\n    addresses = addresses.filter((address) => {\n      // ice restart\n      if (this.protocols.find((protocol) => protocol.localIp === address)) {\n        return false;\n      }\n      return true;\n    });\n\n    const localStunPromises = addresses.map(async (address) => {\n      // # create transport\n      const protocol = new StunProtocol();\n      this.ensureProtocol(protocol);\n      try {\n        await protocol.connectionMade(\n          isIPv4(address),\n          this.options.portRange,\n          this.options.interfaceAddresses,\n        );\n\n        protocol.localIp = address;\n        this.protocols.push(protocol);\n\n        log(\"protocol\", protocol.localIp);\n\n        // # add host candidate\n        const candidateAddress: Address = [address, protocol.getExtraInfo()[1]];\n\n        protocol.localCandidate = new Candidate(\n          candidateFoundation(\"host\", \"udp\", candidateAddress[0]),\n          1,\n          \"udp\",\n          candidatePriority(\"host\"),\n          candidateAddress[0],\n          candidateAddress[1],\n          \"host\",\n          undefined,\n          undefined,\n          undefined,\n          this.generation,\n          this.localUsername,\n        );\n\n        this.pairLocalProtocol(protocol);\n        this.appendLocalCandidate(protocol.localCandidate);\n\n        return protocol;\n      } catch (error) {\n        log(\"error protocol STUN\", error);\n      }\n    });\n\n    candidatePromises.push(\n      ...localStunPromises.map((localPromise) =>\n        localPromise.then((l) => l?.localCandidate),\n      ),\n    );\n\n    const { stunServer, turnServer } = this;\n\n    if (stunServer) {\n      const stunCandidatePromises = localStunPromises.map(\n        async (protocolPromise) => {\n          const protocol = await protocolPromise;\n          if (!protocol) return;\n\n          const stunCandidatePromise = new Promise<Candidate | void>(\n            async (r, f) => {\n              const timer = setTimeout(f, timeout * 1000);\n              if (\n                protocol.localCandidate?.host &&\n                isIPv4(protocol.localCandidate?.host)\n              ) {\n                const candidate = await serverReflexiveCandidate(\n                  protocol,\n                  stunServer,\n                ).catch((error) => {\n                  log(\"error\", error);\n                });\n                if (candidate) {\n                  this.appendLocalCandidate(candidate);\n                }\n\n                clearTimeout(timer);\n                r(candidate);\n              } else {\n                clearTimeout(timer);\n                r();\n              }\n            },\n          ).catch((error) => {\n            log(\"query STUN server\", error);\n          });\n\n          return stunCandidatePromise;\n        },\n      );\n\n      candidatePromises.push(...stunCandidatePromises);\n    }\n\n    const { turnUsername, turnPassword } = this.options;\n    if (turnServer && turnUsername && turnPassword) {\n      const turnCandidatePromise = (async () => {\n        const protocol = await createStunOverTurnClient(\n          {\n            address: turnServer,\n            username: turnUsername,\n            password: turnPassword,\n          },\n          {\n            portRange: this.options.portRange,\n            interfaceAddresses: this.options.interfaceAddresses,\n            transport: this.options.turnTransport === \"tcp\" ? \"tcp\" : \"udp\",\n          },\n        ).catch(async (e) => {\n          if (this.options.turnTransport !== \"tcp\") {\n            return await createStunOverTurnClient(\n              {\n                address: turnServer,\n                username: turnUsername,\n                password: turnPassword,\n              },\n              {\n                portRange: this.options.portRange,\n                interfaceAddresses: this.options.interfaceAddresses,\n                transport: \"tcp\",\n              },\n            );\n          } else {\n            throw e;\n          }\n        });\n        this.ensureProtocol(protocol);\n        this.protocols.push(protocol);\n\n        const candidateAddress = protocol.turn.relayedAddress;\n        const relatedAddress = protocol.turn.mappedAddress;\n\n        log(\"turn candidateAddress\", candidateAddress);\n\n        protocol.localCandidate = new Candidate(\n          candidateFoundation(\"relay\", \"udp\", candidateAddress[0]),\n          1,\n          \"udp\",\n          candidatePriority(\"relay\"),\n          candidateAddress[0],\n          candidateAddress[1],\n          \"relay\",\n          relatedAddress[0],\n          relatedAddress[1],\n          undefined,\n          this.generation,\n          this.localUsername,\n        );\n        this.appendLocalCandidate(protocol.localCandidate);\n\n        return protocol.localCandidate;\n      })().catch((error) => {\n        log(\"query TURN server\", error);\n      });\n\n      if (this.options.forceTurn) {\n        candidatePromises = [];\n      }\n\n      candidatePromises.push(turnCandidatePromise);\n    }\n\n    return candidatePromises;\n  }\n\n  async connect() {\n    // \"\"\"\n    // Perform ICE handshake.\n    //\n    // This coroutine returns if a candidate pair was successfully nominated\n    // and raises an exception otherwise.\n    // \"\"\"\n    log(\"start connect ice\");\n    if (!this.localCandidatesEnd) {\n      if (!this.localCandidatesStart) {\n        throw new Error(\"Local candidates gathering was not performed\");\n      }\n    }\n    if (!this.remoteUsername || !this.remotePassword) {\n      throw new Error(\"Remote username or password is missing\");\n    }\n\n    // # 5.7.1. Forming Candidate Pairs\n    for (const c of this.remoteCandidates) {\n      this.pairRemoteCandidate(c);\n    }\n    this.sortCheckList();\n\n    this.unfreezeInitial();\n\n    log(\"earlyChecks\", this.localPassword, this.earlyChecks.length);\n    // # handle early checks\n    for (const earlyCheck of this.earlyChecks) {\n      this.checkIncoming(...earlyCheck);\n    }\n    this.earlyChecks = [];\n    this.earlyChecksDone = true;\n\n    // # perform checks\n    // 5.8.  Scheduling Checks\n    for (;;) {\n      if (this.state === \"closed\") break;\n      if (!this.schedulingChecks()) break;\n      await timers.setTimeout(20);\n    }\n\n    // # wait for completion\n    let res: number = ICE_FAILED;\n    while (this.checkList.length > 0 && res === ICE_FAILED) {\n      res = await this.checkListState.get();\n      log(\"checkListState\", res);\n    }\n\n    // # cancel remaining checks\n    for (const check of this.checkList) {\n      check.handle?.resolve?.();\n    }\n\n    if (res !== ICE_COMPLETED) {\n      throw new Error(\"ICE negotiation failed\");\n    }\n\n    // # start consent freshness tests\n    this.queryConsent();\n\n    this.setState(\"connected\");\n  }\n\n  private unfreezeInitial() {\n    // # unfreeze first pair for the first component\n    const [firstPair] = this.checkList;\n    if (!firstPair) return;\n    if (firstPair.state === CandidatePairState.FROZEN) {\n      firstPair.updateState(CandidatePairState.WAITING);\n    }\n\n    // # unfreeze pairs with same component but different foundations\n    const seenFoundations = new Set(firstPair.localCandidate.foundation);\n    for (const pair of this.checkList) {\n      if (\n        pair.component === firstPair.component &&\n        !seenFoundations.has(pair.localCandidate.foundation) &&\n        pair.state === CandidatePairState.FROZEN\n      ) {\n        pair.updateState(CandidatePairState.WAITING);\n        seenFoundations.add(pair.localCandidate.foundation);\n      }\n    }\n  }\n\n  // 5.8 Scheduling Checks\n  private schedulingChecks() {\n    // Ordinary Check\n    {\n      // # find the highest-priority pair that is in the waiting state\n      const pair = this.checkList\n        .filter((pair) => {\n          if (\n            this.options.forceTurn &&\n            pair.protocol.type === StunProtocol.type\n          )\n            return false;\n          return true;\n        })\n        .find((pair) => pair.state === CandidatePairState.WAITING);\n      if (pair) {\n        pair.handle = this.checkStart(pair);\n        return true;\n      }\n    }\n\n    {\n      // # find the highest-priority pair that is in the frozen state\n      const pair = this.checkList.find(\n        (pair) => pair.state === CandidatePairState.FROZEN,\n      );\n      if (pair) {\n        pair.handle = this.checkStart(pair);\n        return true;\n      }\n    }\n\n    // # if we expect more candidates, keep going\n    if (!this.remoteCandidatesEnd) {\n      return !this.checkListDone;\n    }\n\n    return false;\n  }\n\n  // 4.1.1.4 ?  life check\n  private queryConsent = () => {\n    if (this.queryConsentHandle) {\n      this.queryConsentHandle.resolve();\n    }\n\n    this.queryConsentHandle = cancelable(async (_, __, onCancel) => {\n      let failures = 0;\n      let canceled = false;\n\n      const cancelEvent = new AbortController();\n      onCancel.once(() => {\n        canceled = true;\n        failures += CONSENT_FAILURES;\n        cancelEvent.abort();\n        this.queryConsentHandle = undefined;\n      });\n\n      const { localUsername, remoteUsername, iceControlling } = this;\n\n      // \"\"\"\n      // Periodically check consent (RFC 7675).\n      // \"\"\"\n\n      try {\n        while (this.state !== \"closed\" && !canceled) {\n          // # randomize between 0.8 and 1.2 times CONSENT_INTERVAL\n          await timers.setTimeout(\n            CONSENT_INTERVAL * (0.8 + 0.4 * Math.random()) * 1000,\n            undefined,\n            { signal: cancelEvent.signal },\n          );\n\n          const nominated = this.nominated;\n          if (!nominated || canceled) {\n            break;\n          }\n\n          const request = this.buildRequest({\n            nominate: false,\n            localUsername,\n            remoteUsername,\n            iceControlling,\n          });\n          try {\n            await nominated.protocol.request(\n              request,\n              nominated.remoteAddr,\n              Buffer.from(this.remotePassword, \"utf8\"),\n              0,\n            );\n            failures = 0;\n            if (this.state === \"disconnected\") {\n              this.setState(\"connected\");\n            }\n          } catch (error) {\n            if (nominated.id === this.nominated?.id) {\n              log(\"no stun response\");\n              failures++;\n              this.setState(\"disconnected\");\n              break;\n            }\n          }\n          if (failures >= CONSENT_FAILURES) {\n            log(\"Consent to send expired\");\n            this.queryConsentHandle = undefined;\n            this.setState(\"closed\");\n            break;\n          }\n        }\n      } catch (error) {}\n    });\n  };\n\n  async close() {\n    // \"\"\"\n    // Close the connection.\n    // \"\"\"\n\n    this.setState(\"closed\");\n\n    // # stop consent freshness tests\n    this.queryConsentHandle?.resolve?.();\n\n    // # stop check list\n    if (this.checkList && !this.checkListDone) {\n      this.checkListState.put(\n        new Promise((r) => {\n          r(ICE_FAILED);\n        }),\n      );\n    }\n\n    this.nominated = undefined;\n    for (const protocol of this.protocols) {\n      if (protocol.close) {\n        await protocol.close();\n      }\n    }\n\n    this.protocols = [];\n    this.localCandidates = [];\n\n    this.lookup?.close?.();\n    this.lookup = undefined;\n  }\n\n  private setState(state: IceState) {\n    this.state = state;\n    this.stateChanged.execute(state);\n  }\n\n  async addRemoteCandidate(remoteCandidate: Candidate | undefined) {\n    // \"\"\"\n    // Add a remote candidate or signal end-of-candidates.\n\n    // To signal end-of-candidates, pass `None`.\n\n    // :param remote_candidate: A :class:`Candidate` instance or `None`.\n    // \"\"\"\n\n    if (!remoteCandidate) {\n      this.remoteCandidatesEnd = true;\n      return;\n    }\n\n    if (remoteCandidate.host.includes(\".local\")) {\n      try {\n        if (!this.lookup) {\n          this.lookup = new MdnsLookup();\n        }\n        const host = await this.lookup.lookup(remoteCandidate.host);\n        remoteCandidate.host = host;\n      } catch (error) {\n        return;\n      }\n    }\n\n    try {\n      validateRemoteCandidate(remoteCandidate);\n    } catch (error) {\n      return;\n    }\n\n    log(\"addRemoteCandidate\", remoteCandidate);\n    this._remoteCandidates.push(remoteCandidate);\n\n    this.pairRemoteCandidate(remoteCandidate);\n    this.sortCheckList();\n  }\n\n  send = async (data: Buffer) => {\n    const activePair = this.nominated;\n    if (activePair) {\n      await activePair.protocol.sendData(data, activePair.remoteAddr);\n\n      // Update statistics\n      activePair.packetsSent++;\n      activePair.bytesSent += data.length;\n    } else {\n      // log(\"Cannot send data, ice not connected\");\n      return;\n    }\n  };\n\n  getDefaultCandidate() {\n    const candidates = this.localCandidates.sort(\n      (a, b) => a.priority - b.priority,\n    );\n    const [candidate] = candidates;\n    return candidate;\n  }\n\n  // for test only\n  set remoteCandidates(value: Candidate[]) {\n    if (this.remoteCandidatesEnd)\n      throw new Error(\"Cannot set remote candidates after end-of-candidates.\");\n    this._remoteCandidates = [];\n    for (const remoteCandidate of value) {\n      try {\n        validateRemoteCandidate(remoteCandidate);\n      } catch (error) {\n        continue;\n      }\n      this._remoteCandidates.push(remoteCandidate);\n    }\n\n    this.remoteCandidatesEnd = true;\n  }\n  get remoteCandidates() {\n    return this._remoteCandidates;\n  }\n\n  get candidatePairs() {\n    return this.checkList;\n  }\n\n  private sortCheckList() {\n    sortCandidatePairs(this.checkList, this.iceControlling);\n  }\n\n  private findPair(protocol: Protocol, remoteCandidate: Candidate) {\n    const pair = this.checkList.find(\n      (pair) =>\n        isEqual(pair.protocol, protocol) &&\n        isEqual(pair.remoteCandidate, remoteCandidate),\n    );\n    return pair;\n  }\n\n  private switchRole(iceControlling: boolean) {\n    log(\"switch role\", iceControlling);\n    this.iceControlling = iceControlling;\n    this.sortCheckList();\n  }\n\n  private checkComplete(pair: CandidatePair) {\n    pair.handle = undefined;\n    if (pair.state === CandidatePairState.SUCCEEDED) {\n      // Updating the Nominated Flag\n\n      // https://www.rfc-editor.org/rfc/rfc8445#section-7.3.1.5,\n      // Once the nominated flag is set for a component of a data stream, it\n      // concludes the ICE processing for that component.  See Section 8.\n      // So disallow overwriting of the pair nominated for that component\n      if (\n        pair.nominated &&\n        // remotegeneration.localgeneration\n        (pair.remoteCandidate.generation != undefined\n          ? pair.remoteCandidate.generation === this.generation\n          : true) &&\n        this.nominated == undefined\n      ) {\n        log(\"nominated\", pair.toJSON());\n        this.nominated = pair;\n        this.nominating = false;\n\n        // 8.1.2.  Updating States\n\n        // The agent MUST remove all Waiting and Frozen pairs in the check\n        // list and triggered check queue for the same component as the\n        // nominated pairs for that media stream.\n        for (const p of this.checkList) {\n          if (\n            p.component === pair.component &&\n            [CandidatePairState.WAITING, CandidatePairState.FROZEN].includes(\n              p.state,\n            )\n          ) {\n            p.updateState(CandidatePairState.FAILED);\n          }\n        }\n      }\n\n      // Once there is at least one nominated pair in the valid list for\n      // every component of at least one media stream and the state of the\n      // check list is Running:\n      if (this.nominated) {\n        if (!this.checkListDone) {\n          log(\"ICE completed\");\n          this.checkListState.put(new Promise((r) => r(ICE_COMPLETED)));\n          this.checkListDone = true;\n        }\n        return;\n      }\n\n      log(\"not completed\", pair.toJSON());\n\n      // 7.1.3.2.3.  Updating Pair States\n      for (const p of this.checkList) {\n        if (\n          p.localCandidate.foundation === pair.localCandidate.foundation &&\n          p.state === CandidatePairState.FROZEN\n        ) {\n          p.updateState(CandidatePairState.WAITING);\n        }\n      }\n    }\n\n    {\n      const list = [CandidatePairState.SUCCEEDED, CandidatePairState.FAILED];\n      if (this.checkList.find(({ state }) => !list.includes(state))) {\n        return;\n      }\n    }\n\n    if (!this.iceControlling) {\n      const target = CandidatePairState.SUCCEEDED;\n      if (this.checkList.find(({ state }) => state === target)) {\n        return;\n      }\n    }\n\n    if (!this.checkListDone) {\n      log(\"ICE failed\");\n      this.checkListState.put(\n        new Promise((r) => {\n          r(ICE_FAILED);\n        }),\n      );\n    }\n  }\n\n  // 3.  Terminology : Check\n  checkStart = (pair: CandidatePair) =>\n    cancelable<void>(async (r) => {\n      // \"\"\"\n      // Starts a check.\n      // \"\"\"\n\n      log(\"check start\", pair.toJSON());\n\n      pair.updateState(CandidatePairState.IN_PROGRESS);\n      const result: { response?: Message; addr?: Address } = {};\n      const { remotePassword, remoteUsername, generation } = this;\n      const localUsername = pair.localCandidate.ufrag ?? this.localUsername;\n\n      const nominate = this.iceControlling && !this.remoteIsLite;\n      const request = this.buildRequest({\n        nominate,\n        localUsername,\n        remoteUsername,\n        iceControlling: this.iceControlling,\n      });\n\n      // Record start time for RTT calculation\n      const startTime = performance.now();\n\n      try {\n        const [response, addr] = await pair.protocol.request(\n          request,\n          pair.remoteAddr,\n          Buffer.from(remotePassword, \"utf8\"),\n          4,\n        );\n\n        // Calculate RTT\n        const endTime = performance.now();\n        const rtt = (endTime - startTime) / 1000; // Convert to seconds\n\n        // Update RTT statistics\n        pair.rtt = rtt;\n        pair.totalRoundTripTime += rtt;\n        pair.roundTripTimeMeasurements++;\n\n        log(\"response received\", request.toJSON(), response.toJSON(), addr, {\n          localUsername,\n          remoteUsername,\n          remotePassword,\n          generation,\n          rtt,\n        });\n        result.response = response;\n        result.addr = addr;\n      } catch (error: any) {\n        const exc: TransactionError = error;\n        // 7.1.3.1.  Failure Cases\n        log(\n          \"failure case\",\n          request.toJSON(),\n          exc.response ? JSON.stringify(exc.response.toJSON(), null, 2) : error,\n          {\n            localUsername,\n            remoteUsername,\n            remotePassword,\n            generation,\n          },\n          pair.remoteAddr,\n        );\n        if (exc.response?.getAttributeValue(\"ERROR-CODE\")[0] === 487) {\n          if (request.attributesKeys.includes(\"ICE-CONTROLLED\")) {\n            this.switchRole(true);\n          } else if (request.attributesKeys.includes(\"ICE-CONTROLLING\")) {\n            this.switchRole(false);\n          }\n          await this.checkStart(pair).awaitable;\n          r();\n          return;\n        }\n        if (exc.response?.getAttributeValue(\"ERROR-CODE\")[0] === 401) {\n          log(\"retry 401\", pair.toJSON());\n          await this.checkStart(pair).awaitable;\n          r();\n          return;\n        } else {\n          // timeout\n          log(\"checkStart CandidatePairState.FAILED\", pair.toJSON());\n          pair.updateState(CandidatePairState.FAILED);\n          this.checkComplete(pair);\n          r();\n          return;\n        }\n      }\n\n      // # check remote address matches\n      if (!isEqual(result.addr, pair.remoteAddr)) {\n        pair.updateState(CandidatePairState.FAILED);\n        this.checkComplete(pair);\n        r();\n        return;\n      }\n\n      // # success\n      if (nominate || pair.remoteNominated) {\n        // # nominated by agressive nomination or the remote party\n        pair.nominated = true;\n      } else if (this.iceControlling && !this.nominating) {\n        // # perform regular nomination\n        this.nominating = true;\n        const request = this.buildRequest({\n          nominate: true,\n          localUsername,\n          remoteUsername,\n          iceControlling: this.iceControlling,\n        });\n        try {\n          await pair.protocol.request(\n            request,\n            pair.remoteAddr,\n            Buffer.from(this.remotePassword, \"utf8\"),\n          );\n        } catch (error) {\n          pair.updateState(CandidatePairState.FAILED);\n          this.checkComplete(pair);\n          return;\n        }\n        pair.nominated = true;\n      }\n\n      pair.updateState(CandidatePairState.SUCCEEDED);\n      this.checkComplete(pair);\n      r();\n    });\n\n  private addPair(pair: CandidatePair) {\n    this.checkList.push(pair);\n    this.sortCheckList();\n  }\n\n  // 7.2.  STUN Server Procedures\n  // 7.2.1.37.2.1.47.2.1.5\n  checkIncoming(message: Message, addr: Address, protocol: Protocol) {\n    // \"\"\"\n    // Handle a successful incoming check.\n    // \"\"\"\n\n    const txUsername = message.getAttributeValue(\"USERNAME\");\n    const { remoteUsername: localUsername } = decodeTxUsername(txUsername);\n\n    // find remote candidate\n    let remoteCandidate: Candidate | undefined;\n    const [host, port] = addr;\n    for (const c of this.remoteCandidates) {\n      if (c.host === host && c.port === port) {\n        remoteCandidate = c;\n        break;\n      }\n    }\n    if (!remoteCandidate) {\n      // 7.2.1.3.  Learning Peer Reflexive Candidates\n      remoteCandidate = new Candidate(\n        randomString(10),\n        1,\n        \"udp\",\n        message.getAttributeValue(\"PRIORITY\"),\n        host,\n        port,\n        \"prflx\",\n        undefined,\n        undefined,\n        undefined,\n        undefined,\n        undefined,\n      );\n      this._remoteCandidates.push(remoteCandidate);\n    }\n\n    // find pair\n    let pair = this.findPair(protocol, remoteCandidate);\n    if (!pair) {\n      pair = new CandidatePair(protocol, remoteCandidate, this.iceControlling);\n      pair.updateState(CandidatePairState.WAITING);\n      this.addPair(pair);\n    }\n    pair.localCandidate.ufrag = localUsername;\n\n    log(\"Triggered Checks\", message.toJSON(), pair.toJSON(), {\n      localUsername: this.localUsername,\n      remoteUsername: this.remoteUsername,\n      localPassword: this.localPassword,\n      remotePassword: this.remotePassword,\n      generation: this.generation,\n    });\n\n    // 7.2.1.4.  Triggered Checks\n    if (\n      [CandidatePairState.WAITING, CandidatePairState.FAILED].includes(\n        pair.state,\n      )\n    ) {\n      pair.handle = this.checkStart(pair);\n    }\n\n    // 7.2.1.5. Updating the Nominated Flag\n    if (\n      message.attributesKeys.includes(\"USE-CANDIDATE\") &&\n      !this.iceControlling\n    ) {\n      pair.remoteNominated = true;\n      if (pair.state === CandidatePairState.SUCCEEDED) {\n        pair.nominated = true;\n        this.checkComplete(pair);\n      }\n    }\n  }\n\n  private tryPair(protocol: Protocol, remoteCandidate: Candidate) {\n    if (\n      protocol.localCandidate?.canPairWith(remoteCandidate) &&\n      !this.findPair(protocol, remoteCandidate)\n    ) {\n      const pair = new CandidatePair(\n        protocol,\n        remoteCandidate,\n        this.iceControlling,\n      );\n      if (\n        this.options.filterCandidatePair &&\n        !this.options.filterCandidatePair(pair)\n      ) {\n        return;\n      }\n      pair.updateState(CandidatePairState.WAITING);\n      this.addPair(pair);\n    }\n  }\n\n  private pairLocalProtocol(protocol: Protocol) {\n    for (const remoteCandidate of this.remoteCandidates) {\n      this.tryPair(protocol, remoteCandidate);\n    }\n  }\n\n  private pairRemoteCandidate = (remoteCandidate: Candidate) => {\n    for (const protocol of this.protocols) {\n      this.tryPair(protocol, remoteCandidate);\n    }\n  };\n\n  private buildRequest({\n    nominate,\n    remoteUsername,\n    localUsername,\n    iceControlling,\n  }: {\n    nominate: boolean;\n    remoteUsername: string;\n    localUsername: string;\n    iceControlling: boolean;\n  }) {\n    const txUsername = encodeTxUsername({ remoteUsername, localUsername });\n    const request = new Message(methods.BINDING, classes.REQUEST);\n    request\n      .setAttribute(\"USERNAME\", txUsername)\n      .setAttribute(\"PRIORITY\", candidatePriority(\"prflx\"));\n    if (iceControlling) {\n      request.setAttribute(\"ICE-CONTROLLING\", this.tieBreaker);\n      if (nominate) {\n        request.setAttribute(\"USE-CANDIDATE\", null);\n      }\n    } else {\n      request.setAttribute(\"ICE-CONTROLLED\", this.tieBreaker);\n    }\n    return request;\n  }\n\n  private respondError(\n    request: Message,\n    addr: Address,\n    protocol: Protocol,\n    errorCode: [number, string],\n  ) {\n    const response = new Message(\n      request.messageMethod,\n      classes.ERROR,\n      request.transactionId,\n    );\n    response\n      .setAttribute(\"ERROR-CODE\", errorCode)\n      .addMessageIntegrity(Buffer.from(this.localPassword, \"utf8\"))\n      .addFingerprint();\n    protocol.sendStun(response, addr).catch((e) => {\n      log(\"sendStun error\", e);\n    });\n  }\n}\n\nconst encodeTxUsername = ({\n  remoteUsername,\n  localUsername,\n}: {\n  remoteUsername: string;\n  localUsername: string;\n}) => {\n  return `${remoteUsername}:${localUsername}`;\n};\n\nconst decodeTxUsername = (txUsername: string) => {\n  const [remoteUsername, localUsername] = txUsername.split(\":\");\n  return { remoteUsername, localUsername };\n};\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/x509\n//\n// **License:** MIT\nconst util_1 = require(\"util\");\nconst crypto_1 = require(\"crypto\");\nconst asn1_1 = require(\"@fidm/asn1\");\nconst common_1 = require(\"./common\");\nconst pki_1 = require(\"./pki\");\n// short name OID mappings\nconst shortNames = Object.create(null);\nshortNames.CN = common_1.getOID('commonName');\nshortNames.commonName = 'CN';\nshortNames.C = common_1.getOID('countryName');\nshortNames.countryName = 'C';\nshortNames.L = common_1.getOID('localityName');\nshortNames.localityName = 'L';\nshortNames.ST = common_1.getOID('stateOrProvinceName');\nshortNames.stateOrProvinceName = 'ST';\nshortNames.O = common_1.getOID('organizationName');\nshortNames.organizationName = 'O';\nshortNames.OU = common_1.getOID('organizationalUnitName');\nshortNames.organizationalUnitName = 'OU';\nshortNames.E = common_1.getOID('emailAddress');\nshortNames.emailAddress = 'E';\nfunction getShortName(name) {\n    return shortNames[name] == null ? '' : shortNames[name];\n}\n// validator for an X.509v3 certificate\nconst x509CertificateValidator = {\n    name: 'Certificate',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.SEQUENCE,\n    value: [{\n            name: 'Certificate.TBSCertificate',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.SEQUENCE,\n            capture: 'tbsCertificate',\n            value: [{\n                    name: 'Certificate.TBSCertificate.version',\n                    class: asn1_1.Class.CONTEXT_SPECIFIC,\n                    tag: asn1_1.Tag.NONE,\n                    optional: true,\n                    value: [{\n                            name: 'Certificate.TBSCertificate.version.integer',\n                            class: asn1_1.Class.UNIVERSAL,\n                            tag: asn1_1.Tag.INTEGER,\n                            capture: 'certVersion',\n                        }],\n                }, {\n                    name: 'Certificate.TBSCertificate.serialNumber',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.INTEGER,\n                    capture: 'certSerialNumber',\n                }, {\n                    name: 'Certificate.TBSCertificate.signature',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.SEQUENCE,\n                    value: [{\n                            name: 'Certificate.TBSCertificate.signature.algorithm',\n                            class: asn1_1.Class.UNIVERSAL,\n                            tag: asn1_1.Tag.OID,\n                            capture: 'certinfoSignatureOID',\n                        }, {\n                            name: 'Certificate.TBSCertificate.signature.parameters',\n                            class: asn1_1.Class.UNIVERSAL,\n                            tag: asn1_1.Tag.OCTETSTRING,\n                            optional: true,\n                            capture: 'certinfoSignatureParams',\n                        }],\n                }, {\n                    name: 'Certificate.TBSCertificate.issuer',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.SEQUENCE,\n                    capture: 'certIssuer',\n                }, {\n                    name: 'Certificate.TBSCertificate.validity',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.SEQUENCE,\n                    value: [{\n                            name: 'Certificate.TBSCertificate.validity.notBefore',\n                            class: asn1_1.Class.UNIVERSAL,\n                            tag: [asn1_1.Tag.UTCTIME, asn1_1.Tag.GENERALIZEDTIME],\n                            capture: 'certValidityNotBefore',\n                        }, {\n                            name: 'Certificate.TBSCertificate.validity.notAfter',\n                            class: asn1_1.Class.UNIVERSAL,\n                            tag: [asn1_1.Tag.UTCTIME, asn1_1.Tag.GENERALIZEDTIME],\n                            capture: 'certValidityNotAfter',\n                        }],\n                }, {\n                    // Name (subject) (RDNSequence)\n                    name: 'Certificate.TBSCertificate.subject',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.SEQUENCE,\n                    capture: 'certSubject',\n                },\n                // SubjectPublicKeyInfo\n                pki_1.publicKeyValidator,\n                {\n                    // issuerUniqueID (optional)\n                    name: 'Certificate.TBSCertificate.issuerUniqueID',\n                    class: asn1_1.Class.CONTEXT_SPECIFIC,\n                    tag: asn1_1.Tag.BOOLEAN,\n                    optional: true,\n                    value: [{\n                            name: 'Certificate.TBSCertificate.issuerUniqueID.id',\n                            class: asn1_1.Class.UNIVERSAL,\n                            tag: asn1_1.Tag.BITSTRING,\n                            capture: 'certIssuerUniqueId',\n                        }],\n                }, {\n                    // subjectUniqueID (optional)\n                    name: 'Certificate.TBSCertificate.subjectUniqueID',\n                    class: asn1_1.Class.CONTEXT_SPECIFIC,\n                    tag: asn1_1.Tag.INTEGER,\n                    optional: true,\n                    value: [{\n                            name: 'Certificate.TBSCertificate.subjectUniqueID.id',\n                            class: asn1_1.Class.UNIVERSAL,\n                            tag: asn1_1.Tag.BITSTRING,\n                            capture: 'certSubjectUniqueId',\n                        }],\n                }, {\n                    // Extensions (optional)\n                    name: 'Certificate.TBSCertificate.extensions',\n                    class: asn1_1.Class.CONTEXT_SPECIFIC,\n                    tag: asn1_1.Tag.BITSTRING,\n                    capture: 'certExtensions',\n                    optional: true,\n                }],\n        }, {\n            // AlgorithmIdentifier (signature algorithm)\n            name: 'Certificate.signatureAlgorithm',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.SEQUENCE,\n            value: [{\n                    // algorithm\n                    name: 'Certificate.signatureAlgorithm.algorithm',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.OID,\n                    capture: 'certSignatureOID',\n                }, {\n                    name: 'Certificate.TBSCertificate.signature.parameters',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.OCTETSTRING,\n                    optional: true,\n                    capture: 'certSignatureParams',\n                }],\n        }, {\n            name: 'Certificate.signatureValue',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.BITSTRING,\n            capture: 'certSignature',\n        }],\n};\n/**\n * DistinguishedName for X.509v3 certificate.\n */\nclass DistinguishedName {\n    constructor() {\n        this.attributes = [];\n        this.uniqueId = null;\n    }\n    get commonName() {\n        return this.getFieldValue('commonName');\n    }\n    get organizationName() {\n        return this.getFieldValue('organizationName');\n    }\n    get organizationalUnitName() {\n        return this.getFieldValue('organizationalUnitName');\n    }\n    get countryName() {\n        return this.getFieldValue('countryName');\n    }\n    get localityName() {\n        return this.getFieldValue('localityName');\n    }\n    get serialName() {\n        return this.getFieldValue('serialName');\n    }\n    getHash() {\n        const hasher = crypto_1.createHash('sha1');\n        for (const attr of this.attributes) {\n            hasher.update(attr.oid);\n            hasher.update(attr.value);\n        }\n        return hasher.digest();\n    }\n    getField(key) {\n        for (const attr of this.attributes) {\n            if (key === attr.oid || key === attr.name || key === attr.shortName) {\n                return attr;\n            }\n        }\n        return null;\n    }\n    addField(attr) {\n        fillMissingFields([attr]);\n        this.attributes.push(attr);\n    }\n    setAttrs(attrs) {\n        // set new attributes, clear hash\n        fillMissingFields(attrs);\n        this.attributes = attrs;\n    }\n    toJSON() {\n        const obj = {};\n        for (const attr of this.attributes) {\n            const key = attr.shortName;\n            if (typeof key === 'string' && key !== '') {\n                obj[key] = attr.value;\n            }\n        }\n        obj.uniqueId = this.uniqueId;\n        obj.attributes = this.attributes;\n        return obj;\n    }\n    getFieldValue(key) {\n        const val = this.getField(key);\n        if (val != null) {\n            return val.value;\n        }\n        return '';\n    }\n}\nexports.DistinguishedName = DistinguishedName;\n/**\n * X.509v3 Certificate.\n */\nclass Certificate {\n    /**\n     * Parse one or more X.509 certificates from PEM formatted buffer.\n     * If there is no certificate, it will throw error.\n     * @param data PEM formatted buffer\n     */\n    static fromPEMs(data) {\n        const certs = [];\n        const pems = asn1_1.PEM.parse(data);\n        for (const pem of pems) {\n            if (pem.type !== 'CERTIFICATE' &&\n                pem.type !== 'X509 CERTIFICATE' &&\n                pem.type !== 'TRUSTED CERTIFICATE') {\n                throw new Error('Could not convert certificate from PEM: invalid type');\n            }\n            if (pem.procType.includes('ENCRYPTED')) {\n                throw new Error('Could not convert certificate from PEM: PEM is encrypted.');\n            }\n            const obj = asn1_1.ASN1.fromDER(pem.body);\n            certs.push(new Certificate(obj));\n        }\n        if (certs.length === 0) {\n            throw new Error('No Certificate');\n        }\n        return certs;\n    }\n    /**\n     * Parse an X.509 certificate from PEM formatted buffer.\n     * @param data PEM formatted buffer\n     */\n    static fromPEM(data) {\n        return Certificate.fromPEMs(data)[0];\n    }\n    /**\n     * Creates an X.509 certificate from an ASN.1 object\n     * @param obj an ASN.1 object\n     */\n    constructor(obj) {\n        // validate certificate and capture data\n        const captures = Object.create(null);\n        const err = obj.validate(x509CertificateValidator, captures);\n        if (err != null) {\n            throw new Error('Cannot read X.509 certificate: ' + err.message);\n        }\n        this.raw = obj.DER;\n        this.version = captures.certVersion == null ? 0 : (asn1_1.ASN1.parseIntegerNum(captures.certVersion.bytes) + 1);\n        this.serialNumber = asn1_1.ASN1.parseIntegerStr(captures.certSerialNumber.bytes);\n        this.signatureOID = asn1_1.ASN1.parseOID(captures.certSignatureOID.bytes);\n        this.signatureAlgorithm = common_1.getOIDName(this.signatureOID);\n        this.infoSignatureOID = asn1_1.ASN1.parseOID(captures.certinfoSignatureOID.bytes);\n        this.signature = asn1_1.ASN1.parseBitString(captures.certSignature.bytes).buf;\n        this.validFrom = asn1_1.ASN1.parseTime(captures.certValidityNotBefore.tag, captures.certValidityNotBefore.bytes);\n        this.validTo = asn1_1.ASN1.parseTime(captures.certValidityNotAfter.tag, captures.certValidityNotAfter.bytes);\n        this.issuer = new DistinguishedName();\n        this.issuer.setAttrs(RDNAttributesAsArray(captures.certIssuer));\n        if (captures.certIssuerUniqueId != null) {\n            this.issuer.uniqueId = asn1_1.ASN1.parseBitString(captures.certIssuerUniqueId.bytes);\n        }\n        this.subject = new DistinguishedName();\n        this.subject.setAttrs(RDNAttributesAsArray(captures.certSubject));\n        if (captures.certSubjectUniqueId != null) {\n            this.subject.uniqueId = asn1_1.ASN1.parseBitString(captures.certSubjectUniqueId.bytes);\n        }\n        this.extensions = [];\n        this.subjectKeyIdentifier = '';\n        this.authorityKeyIdentifier = '';\n        this.ocspServer = '';\n        this.issuingCertificateURL = '';\n        this.isCA = false;\n        this.maxPathLen = -1;\n        this.basicConstraintsValid = false;\n        this.keyUsage = 0;\n        this.dnsNames = [];\n        this.emailAddresses = [];\n        this.ipAddresses = [];\n        this.uris = [];\n        if (captures.certExtensions != null) {\n            this.extensions = certificateExtensionsFromAsn1(captures.certExtensions);\n            for (const ext of this.extensions) {\n                if (typeof ext.subjectKeyIdentifier === 'string') {\n                    this.subjectKeyIdentifier = ext.subjectKeyIdentifier;\n                }\n                if (typeof ext.authorityKeyIdentifier === 'string') {\n                    this.authorityKeyIdentifier = ext.authorityKeyIdentifier;\n                }\n                if (typeof ext.authorityInfoAccessOcsp === 'string') {\n                    this.ocspServer = ext.authorityInfoAccessOcsp;\n                }\n                if (typeof ext.authorityInfoAccessIssuers === 'string') {\n                    this.issuingCertificateURL = ext.authorityInfoAccessIssuers;\n                }\n                if (typeof ext.basicConstraintsValid === 'boolean') {\n                    this.isCA = ext.isCA;\n                    this.maxPathLen = ext.maxPathLen;\n                    this.basicConstraintsValid = ext.basicConstraintsValid;\n                }\n                if (typeof ext.keyUsage === 'number') {\n                    this.keyUsage = ext.keyUsage;\n                }\n                if (Array.isArray(ext.altNames)) {\n                    for (const item of ext.altNames) {\n                        if (item.dnsName != null) {\n                            this.dnsNames.push(item.dnsName);\n                        }\n                        if (item.email != null) {\n                            this.emailAddresses.push(item.email);\n                        }\n                        if (item.ip != null) {\n                            this.ipAddresses.push(item.ip);\n                        }\n                        if (item.uri != null) {\n                            this.uris.push(item.uri);\n                        }\n                    }\n                }\n            }\n        }\n        this.publicKey = new pki_1.PublicKey(captures.publicKeyInfo);\n        this.publicKeyRaw = this.publicKey.toDER();\n        this.tbsCertificate = captures.tbsCertificate;\n    }\n    /**\n     * Gets an extension by its name or oid.\n     * If extension exists and a key provided, it will return extension[key].\n     * ```js\n     * certificate.getExtension('keyUsage')\n     * certificate.getExtension('2.5.29.15')\n     * // => { oid: '2.5.29.15',\n     * //      critical: true,\n     * //      value: <Buffer 03 02 05 a0>,\n     * //      name: 'keyUsage',\n     * //      digitalSignature: true,\n     * //      nonRepudiation: false,\n     * //      keyEncipherment: true,\n     * //      dataEncipherment: false,\n     * //      keyAgreement: false,\n     * //      keyCertSign: false,\n     * //      cRLSign: false,\n     * //      encipherOnly: false,\n     * //      decipherOnly: false }\n     * certificate.getExtension('keyUsage', 'keyCertSign') // => false\n     * ```\n     * @param name extension name or OID\n     * @param key key in extension\n     */\n    getExtension(name, key = '') {\n        for (const ext of this.extensions) {\n            if (name === ext.oid || name === ext.name) {\n                return key === '' ? ext : ext[key];\n            }\n        }\n        return null;\n    }\n    /**\n     * Returns null if a subject certificate is valid, or error if invalid.\n     * Note that it does not check validity time, DNS name, ip or others.\n     * @param child subject's Certificate\n     */\n    checkSignature(child) {\n        // RFC 5280, 4.2.1.9:\n        // \"If the basic constraints extension is not present in a version 3\n        // certificate, or the extension is present but the cA boolean is not\n        // asserted, then the certified public key MUST NOT be used to verify\n        // certificate signatures.\"\n        // (not handler entrust broken SPKI, See http://www.entrust.net/knowledge-base/technote.cfm?tn=7869)\n        if (this.version === 3 && !this.basicConstraintsValid || (this.basicConstraintsValid && !this.isCA)) {\n            return new Error('The parent constraint violation error');\n        }\n        if (this.getExtension('keyUsage', 'keyCertSign') !== true) {\n            return new Error('The parent constraint violation error');\n        }\n        if (!child.isIssuer(this)) {\n            return new Error('The parent certificate did not issue the given child certificate');\n        }\n        const agl = getHashAgl(child.signatureOID);\n        if (agl === '') {\n            return new Error('Unknown child signature OID.');\n        }\n        const res = this.publicKey.verify(child.tbsCertificate.DER, child.signature, agl);\n        if (res === false) {\n            return new Error('Child signature not matched');\n        }\n        return null;\n    }\n    /**\n     * Returns true if this certificate's issuer matches the passed\n     * certificate's subject. Note that no signature check is performed.\n     * @param parent issuer's Certificate\n     */\n    isIssuer(parent) {\n        return this.issuer.getHash().equals(parent.subject.getHash());\n    }\n    /**\n     * Verifies the subjectKeyIdentifier extension value for this certificate\n     * against its public key.\n     */\n    verifySubjectKeyIdentifier() {\n        const ski = this.publicKey.getFingerprint('sha1', 'PublicKey');\n        return ski.toString('hex') === this.subjectKeyIdentifier;\n    }\n    /**\n     * Return a friendly JSON object for debuging.\n     */\n    toJSON() {\n        const obj = {};\n        for (const key of Object.keys(this)) {\n            obj[key] = toJSONify(this[key]);\n        }\n        delete obj.tbsCertificate;\n        return obj;\n    }\n    [util_1.inspect.custom](_depth, options) {\n        if (options.depth <= 2) {\n            options.depth = 10;\n        }\n        return `<${this.constructor.name} ${util_1.inspect(this.toJSON(), options)}>`;\n    }\n}\nexports.Certificate = Certificate;\nfunction certificateExtensionsFromAsn1(exts) {\n    const res = [];\n    for (const val of exts.mustCompound()) {\n        for (const ext of val.mustCompound()) {\n            res.push(certificateExtensionFromAsn1(ext));\n        }\n    }\n    return res;\n}\nfunction certificateExtensionFromAsn1(ext) {\n    // an extension has:\n    // [0] extnID      OBJECT IDENTIFIER\n    // [1] critical    BOOLEAN DEFAULT FALSE\n    // [2] extnValue   OCTET STRING\n    const e = {};\n    e.oid = asn1_1.ASN1.parseOID(ext.value[0].bytes);\n    e.critical = false;\n    if (ext.value[1].tag === asn1_1.Tag.BOOLEAN) {\n        e.critical = asn1_1.ASN1.parseBool(ext.value[1].bytes);\n        e.value = ext.value[2].bytes;\n    }\n    else {\n        e.value = ext.value[1].bytes;\n    }\n    // if the oid is known, get its name\n    e.name = common_1.getOIDName(e.oid);\n    switch (e.name) {\n        // handle key usage\n        case 'keyUsage':\n            decodeExtKeyUsage(e);\n            break;\n        case 'basicConstraints':\n            decodeExtBasicConstraints(e);\n            break;\n        case 'extKeyUsage':\n            decodeExtExtKeyUsage(e);\n            break;\n        case 'nsCertType':\n            decodeExtNsCertType(e);\n            break;\n        case 'subjectAltName':\n            decodeExtAltName(e);\n            break;\n        case 'issuerAltName':\n            decodeExtAltName(e);\n            break;\n        case 'subjectKeyIdentifier':\n            decodeExtSubjectKeyIdentifier(e);\n            break;\n        case 'authorityKeyIdentifier':\n            decodeExtAuthorityKeyIdentifier(e);\n            break;\n        case 'authorityInfoAccess':\n            decodeExtAuthorityInfoAccess(e);\n            break;\n    }\n    return e;\n}\nfunction decodeExtKeyUsage(e) {\n    // ev is a BITSTRING\n    const ev = asn1_1.ASN1.parseBitString(asn1_1.ASN1.fromDER(e.value).bytes);\n    let b2 = 0x00;\n    let b3 = 0x00;\n    e.keyUsage = 0;\n    for (let i = 0; i < 9; i++) {\n        if (ev.at(i) !== 0) {\n            e.keyUsage |= 1 << i;\n        }\n    }\n    if (ev.buf.length > 0) {\n        b2 = ev.buf[0];\n        b3 = ev.buf.length > 1 ? ev.buf[1] : 0;\n    }\n    // set flags\n    e.digitalSignature = (b2 & 0x80) === 0x80;\n    e.nonRepudiation = (b2 & 0x40) === 0x40;\n    e.keyEncipherment = (b2 & 0x20) === 0x20;\n    e.dataEncipherment = (b2 & 0x10) === 0x10;\n    e.keyAgreement = (b2 & 0x08) === 0x08;\n    e.keyCertSign = (b2 & 0x04) === 0x04;\n    e.cRLSign = (b2 & 0x02) === 0x02;\n    e.encipherOnly = (b2 & 0x01) === 0x01;\n    e.decipherOnly = (b3 & 0x80) === 0x80;\n}\nfunction decodeExtBasicConstraints(e) {\n    // handle basic constraints\n    // get value as SEQUENCE\n    const ev = asn1_1.ASN1.fromDER(e.value);\n    const vals = ev.mustCompound();\n    // get cA BOOLEAN flag (defaults to false)\n    if (vals.length > 0 && vals[0].tag === asn1_1.Tag.BOOLEAN) {\n        e.isCA = asn1_1.ASN1.parseBool(vals[0].bytes);\n    }\n    else {\n        e.isCA = false;\n    }\n    // get path length constraint\n    let value = null;\n    if (vals.length > 0 && vals[0].tag === asn1_1.Tag.INTEGER) {\n        value = vals[0].bytes;\n    }\n    else if (vals.length > 1) {\n        value = vals[1].bytes;\n    }\n    if (value !== null) {\n        e.maxPathLen = asn1_1.ASN1.parseInteger(value);\n    }\n    else {\n        e.maxPathLen = -1;\n    }\n    e.basicConstraintsValid = true;\n}\nfunction decodeExtExtKeyUsage(e) {\n    // handle extKeyUsage\n    // value is a SEQUENCE of OIDs\n    const ev = asn1_1.ASN1.fromDER(e.value);\n    const vals = ev.mustCompound();\n    for (const val of vals) {\n        e[common_1.getOIDName(asn1_1.ASN1.parseOID(val.bytes))] = true;\n    }\n}\nfunction decodeExtNsCertType(e) {\n    // ev is a BITSTRING\n    const ev = asn1_1.ASN1.parseBitString(asn1_1.ASN1.fromDER(e.value).bytes);\n    let b2 = 0x00;\n    if (ev.buf.length > 0) {\n        b2 = ev.buf[0];\n    }\n    // set flags\n    e.client = (b2 & 0x80) === 0x80;\n    e.server = (b2 & 0x40) === 0x40;\n    e.email = (b2 & 0x20) === 0x20;\n    e.objsign = (b2 & 0x10) === 0x10;\n    e.reserved = (b2 & 0x08) === 0x08;\n    e.sslCA = (b2 & 0x04) === 0x04;\n    e.emailCA = (b2 & 0x02) === 0x02;\n    e.objCA = (b2 & 0x01) === 0x01;\n}\nfunction decodeExtAltName(e) {\n    // handle subjectAltName/issuerAltName\n    e.altNames = [];\n    // ev is a SYNTAX SEQUENCE\n    const ev = asn1_1.ASN1.fromDER(e.value);\n    const vals = ev.mustCompound();\n    for (const gn of vals) {\n        // get GeneralName\n        const item = {\n            tag: gn.tag,\n            value: gn.bytes,\n        };\n        e.altNames.push(item);\n        switch (gn.tag) {\n            // rfc822Name, emailAddresses\n            case 1:\n                item.email = gn.bytes.toString();\n                break;\n            // dNSName\n            case 2:\n                item.dnsName = gn.bytes.toString();\n                break;\n            // uniformResourceIdentifier (URI)\n            case 6:\n                item.uri = gn.bytes.toString();\n                break;\n            // IPAddress\n            case 7:\n                // convert to IPv4/IPv6 string representation\n                item.ip = common_1.bytesToIP(gn.bytes);\n                break;\n            // registeredID\n            case 8:\n                item.oid = asn1_1.ASN1.parseOID(gn.bytes);\n                break;\n            default:\n            // unsupported\n        }\n    }\n}\nconst subjectKeyIdentifierValidator = {\n    name: 'subjectKeyIdentifier',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.OCTETSTRING,\n    capture: 'subjectKeyIdentifier',\n};\nfunction decodeExtSubjectKeyIdentifier(e) {\n    const captures = asn1_1.ASN1.parseDERWithTemplate(e.value, subjectKeyIdentifierValidator);\n    e.subjectKeyIdentifier = captures.subjectKeyIdentifier.bytes.toString('hex');\n}\nconst authorityKeyIdentifierValidator = {\n    name: 'authorityKeyIdentifier',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.SEQUENCE,\n    value: [{\n            name: 'authorityKeyIdentifier.value',\n            class: asn1_1.Class.CONTEXT_SPECIFIC,\n            tag: asn1_1.Tag.NONE,\n            capture: 'authorityKeyIdentifier',\n        }],\n};\nfunction decodeExtAuthorityKeyIdentifier(e) {\n    const captures = asn1_1.ASN1.parseDERWithTemplate(e.value, authorityKeyIdentifierValidator);\n    e.authorityKeyIdentifier = captures.authorityKeyIdentifier.bytes.toString('hex');\n}\nconst authorityInfoAccessValidator = {\n    name: 'authorityInfoAccess',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.SEQUENCE,\n    value: [{\n            name: 'authorityInfoAccess.authorityInfoAccessOcsp',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.SEQUENCE,\n            optional: true,\n            value: [{\n                    name: 'authorityInfoAccess.authorityInfoAccessOcsp.oid',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.OID,\n                }, {\n                    name: 'authorityInfoAccess.authorityInfoAccessOcsp.value',\n                    class: asn1_1.Class.CONTEXT_SPECIFIC,\n                    tag: asn1_1.Tag.OID,\n                    capture: 'authorityInfoAccessOcsp',\n                }],\n        }, {\n            name: 'authorityInfoAccess.authorityInfoAccessIssuers',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.SEQUENCE,\n            optional: true,\n            value: [{\n                    name: 'authorityInfoAccess.authorityInfoAccessIssuers.oid',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.OID,\n                }, {\n                    name: 'authorityInfoAccess.authorityInfoAccessIssuers.value',\n                    class: asn1_1.Class.CONTEXT_SPECIFIC,\n                    tag: asn1_1.Tag.OID,\n                    capture: 'authorityInfoAccessIssuers',\n                }],\n        }],\n};\nfunction decodeExtAuthorityInfoAccess(e) {\n    const captures = asn1_1.ASN1.parseDERWithTemplate(e.value, authorityInfoAccessValidator);\n    if (captures.authorityInfoAccessOcsp != null) {\n        e.authorityInfoAccessOcsp = captures.authorityInfoAccessOcsp.bytes.toString();\n    }\n    if (captures.authorityInfoAccessIssuers != null) {\n        e.authorityInfoAccessIssuers = captures.authorityInfoAccessIssuers.bytes.toString();\n    }\n}\n// Fills in missing fields in attributes.\nfunction fillMissingFields(attrs) {\n    for (const attr of attrs) {\n        // populate missing name\n        if (attr.name == null || attr.name === '') {\n            if (attr.oid != null) {\n                attr.name = common_1.getOIDName(attr.oid);\n            }\n            if (attr.name === '' && attr.shortName != null) {\n                attr.name = common_1.getOIDName(shortNames[attr.shortName]);\n            }\n        }\n        // populate missing type (OID)\n        if (attr.oid == null || attr.oid === '') {\n            if (attr.name !== '') {\n                attr.oid = common_1.getOID(attr.name);\n            }\n            else {\n                throw new Error('Attribute oid not specified.');\n            }\n        }\n        // populate missing shortname\n        if (attr.shortName == null || attr.shortName === '') {\n            attr.shortName = shortNames[attr.name] == null ? '' : shortNames[attr.name];\n        }\n        if (attr.value == null) {\n            throw new Error('Attribute value not specified.');\n        }\n    }\n}\n// Only support RSA and ECDSA\nfunction getHashAgl(oid) {\n    switch (common_1.getOIDName(oid)) {\n        case 'sha1WithRsaEncryption':\n            return 'sha1';\n        case 'md5WithRsaEncryption':\n            return 'md5';\n        case 'sha256WithRsaEncryption':\n            return 'sha256';\n        case 'sha384WithRsaEncryption':\n            return 'sha384';\n        case 'sha512WithRsaEncryption':\n            return 'sha512';\n        case 'RSASSA-PSS':\n            return 'sha256';\n        case 'ecdsaWithSha1':\n            return 'sha1';\n        case 'ecdsaWithSha256':\n            return 'sha256';\n        case 'ecdsaWithSha384':\n            return 'sha384';\n        case 'ecdsaWithSha512':\n            return 'sha512';\n        case 'dsaWithSha1':\n            return 'sha1';\n        case 'dsaWithSha256':\n            return 'sha256';\n        default:\n            return '';\n    }\n}\n// Converts an RDNSequence of ASN.1 DER-encoded RelativeDistinguishedName\n// sets into an array with objects that have type and value properties.\nfunction RDNAttributesAsArray(rdn) {\n    const rval = [];\n    // each value in 'rdn' in is a SET of RelativeDistinguishedName\n    // var set, attr, obj\n    for (const set of rdn.mustCompound()) {\n        // each value in the SET is an AttributeTypeAndValue sequence\n        // containing first a type (an OID) and second a value (defined by the OID)\n        for (const attr of set.mustCompound()) {\n            const values = attr.mustCompound();\n            const obj = {};\n            obj.oid = asn1_1.ASN1.parseOID(values[0].bytes);\n            obj.value = values[1].value;\n            obj.valueTag = values[1].tag;\n            obj.name = common_1.getOIDName(obj.oid);\n            obj.shortName = getShortName(obj.name);\n            rval.push(obj);\n        }\n    }\n    return rval;\n}\nfunction toJSONify(val) {\n    if (val != null && !(val instanceof Buffer) && typeof val.toJSON === 'function') {\n        return val.toJSON();\n    }\n    return val;\n}\n//# sourceMappingURL=x509.js.map","// GENERATED FILE. DO NOT EDIT.\nvar ipCodec = (function(exports) {\n  \"use strict\";\n  \n  Object.defineProperty(exports, \"__esModule\", {\n    value: true\n  });\n  exports.decode = decode;\n  exports.encode = encode;\n  exports.familyOf = familyOf;\n  exports.name = void 0;\n  exports.sizeOf = sizeOf;\n  exports.v6 = exports.v4 = void 0;\n  const v4Regex = /^(\\d{1,3}\\.){3,3}\\d{1,3}$/;\n  const v4Size = 4;\n  const v6Regex = /^(::)?(((\\d{1,3}\\.){3}(\\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;\n  const v6Size = 16;\n  const v4 = {\n    name: 'v4',\n    size: v4Size,\n    isFormat: ip => v4Regex.test(ip),\n  \n    encode(ip, buff, offset) {\n      offset = ~~offset;\n      buff = buff || new Uint8Array(offset + v4Size);\n      const max = ip.length;\n      let n = 0;\n  \n      for (let i = 0; i < max;) {\n        const c = ip.charCodeAt(i++);\n  \n        if (c === 46) {\n          // \".\"\n          buff[offset++] = n;\n          n = 0;\n        } else {\n          n = n * 10 + (c - 48);\n        }\n      }\n  \n      buff[offset] = n;\n      return buff;\n    },\n  \n    decode(buff, offset) {\n      offset = ~~offset;\n      return `${buff[offset++]}.${buff[offset++]}.${buff[offset++]}.${buff[offset]}`;\n    }\n  \n  };\n  exports.v4 = v4;\n  const v6 = {\n    name: 'v6',\n    size: v6Size,\n    isFormat: ip => ip.length > 0 && v6Regex.test(ip),\n  \n    encode(ip, buff, offset) {\n      offset = ~~offset;\n      let end = offset + v6Size;\n      let fill = -1;\n      let hexN = 0;\n      let decN = 0;\n      let prevColon = true;\n      let useDec = false;\n      buff = buff || new Uint8Array(offset + v6Size); // Note: This algorithm needs to check if the offset\n      // could exceed the buffer boundaries as it supports\n      // non-standard compliant encodings that may go beyond\n      // the boundary limits. if (offset < end) checks should\n      // not be necessary...\n  \n      for (let i = 0; i < ip.length; i++) {\n        let c = ip.charCodeAt(i);\n  \n        if (c === 58) {\n          // :\n          if (prevColon) {\n            if (fill !== -1) {\n              // Not Standard! (standard doesn't allow multiple ::)\n              // We need to treat\n              if (offset < end) buff[offset] = 0;\n              if (offset < end - 1) buff[offset + 1] = 0;\n              offset += 2;\n            } else if (offset < end) {\n              // :: in the middle\n              fill = offset;\n            }\n          } else {\n            // : ends the previous number\n            if (useDec === true) {\n              // Non-standard! (ipv4 should be at end only)\n              // A ipv4 address should not be found anywhere else but at\n              // the end. This codec also support putting characters\n              // after the ipv4 address..\n              if (offset < end) buff[offset] = decN;\n              offset++;\n            } else {\n              if (offset < end) buff[offset] = hexN >> 8;\n              if (offset < end - 1) buff[offset + 1] = hexN & 0xff;\n              offset += 2;\n            }\n  \n            hexN = 0;\n            decN = 0;\n          }\n  \n          prevColon = true;\n          useDec = false;\n        } else if (c === 46) {\n          // . indicates IPV4 notation\n          if (offset < end) buff[offset] = decN;\n          offset++;\n          decN = 0;\n          hexN = 0;\n          prevColon = false;\n          useDec = true;\n        } else {\n          prevColon = false;\n  \n          if (c >= 97) {\n            c -= 87; // a-f ... 97~102 -87 => 10~15\n          } else if (c >= 65) {\n            c -= 55; // A-F ... 65~70 -55 => 10~15\n          } else {\n            c -= 48; // 0-9 ... starting from charCode 48\n  \n            decN = decN * 10 + c;\n          } // We don't know yet if its a dec or hex number\n  \n  \n          hexN = (hexN << 4) + c;\n        }\n      }\n  \n      if (prevColon === false) {\n        // Commiting last number\n        if (useDec === true) {\n          if (offset < end) buff[offset] = decN;\n          offset++;\n        } else {\n          if (offset < end) buff[offset] = hexN >> 8;\n          if (offset < end - 1) buff[offset + 1] = hexN & 0xff;\n          offset += 2;\n        }\n      } else if (fill === 0) {\n        // Not Standard! (standard doesn't allow multiple ::)\n        // This means that a : was found at the start AND end which means the\n        // end needs to be treated as 0 entry...\n        if (offset < end) buff[offset] = 0;\n        if (offset < end - 1) buff[offset + 1] = 0;\n        offset += 2;\n      } else if (fill !== -1) {\n        // Non-standard! (standard doens't allow multiple ::)\n        // Here we find that there has been a :: somewhere in the middle\n        // and the end. To treat the end with priority we need to move all\n        // written data two bytes to the right.\n        offset += 2;\n  \n        for (let i = Math.min(offset - 1, end - 1); i >= fill + 2; i--) {\n          buff[i] = buff[i - 2];\n        }\n  \n        buff[fill] = 0;\n        buff[fill + 1] = 0;\n        fill = offset;\n      }\n  \n      if (fill !== offset && fill !== -1) {\n        // Move the written numbers to the end while filling the everything\n        // \"fill\" to the bytes with zeros.\n        if (offset > end - 2) {\n          // Non Standard support, when the cursor exceeds bounds.\n          offset = end - 2;\n        }\n  \n        while (end > fill) {\n          buff[--end] = offset < end && offset > fill ? buff[--offset] : 0;\n        }\n      } else {\n        // Fill the rest with zeros\n        while (offset < end) {\n          buff[offset++] = 0;\n        }\n      }\n  \n      return buff;\n    },\n  \n    decode(buff, offset) {\n      offset = ~~offset;\n      let result = '';\n  \n      for (let i = 0; i < v6Size; i += 2) {\n        if (i !== 0) {\n          result += ':';\n        }\n  \n        result += (buff[offset + i] << 8 | buff[offset + i + 1]).toString(16);\n      }\n  \n      return result.replace(/(^|:)0(:0)*:0(:|$)/, '$1::$3').replace(/:{3,4}/, '::');\n    }\n  \n  };\n  exports.v6 = v6;\n  const name = 'ip';\n  exports.name = name;\n  \n  function sizeOf(ip) {\n    if (v4.isFormat(ip)) return v4.size;\n    if (v6.isFormat(ip)) return v6.size;\n    throw Error(`Invalid ip address: ${ip}`);\n  }\n  \n  function familyOf(string) {\n    return sizeOf(string) === v4.size ? 1 : 2;\n  }\n  \n  function encode(ip, buff, offset) {\n    offset = ~~offset;\n    const size = sizeOf(ip);\n  \n    if (typeof buff === 'function') {\n      buff = buff(offset + size);\n    }\n  \n    if (size === v4.size) {\n      return v4.encode(ip, buff, offset);\n    }\n  \n    return v6.encode(ip, buff, offset);\n  }\n  \n  function decode(buff, offset, length) {\n    offset = ~~offset;\n    length = length || buff.length - offset;\n  \n    if (length === v4.size) {\n      return v4.decode(buff, offset, length);\n    }\n  \n    if (length === v6.size) {\n      return v6.decode(buff, offset, length);\n    }\n  \n    throw Error(`Invalid buffer size needs to be ${v4.size} for v4 or ${v6.size} for v6.`);\n  }\n  return \"default\" in exports ? exports.default : exports;\n})({});\nif (typeof define === 'function' && define.amd) define([], function() { return ipCodec; });\nelse if (typeof module === 'object' && typeof exports==='object') module.exports = ipCodec;\n","import { Event, debug } from \"./imports/common\";\n\nimport { RTCDataChannel, RTCDataChannelParameters } from \"./dataChannel\";\nimport {\n  type RTCDataChannelStats,\n  type RTCStats,\n  generateStatsId,\n  getStatsTimestamp,\n} from \"./media/stats\";\nimport type { MediaDescription } from \"./sdp\";\nimport { RTCSctpTransport } from \"./transport/sctp\";\n\nconst log = debug(\"werift:packages/webrtc/src/transport/sctpManager.ts\");\n\nexport class SctpTransportManager {\n  sctpTransport?: RTCSctpTransport;\n  sctpRemotePort?: number;\n  dataChannelsOpened = 0;\n  dataChannelsClosed = 0;\n  private dataChannels: RTCDataChannel[] = [];\n\n  readonly onDataChannel = new Event<[RTCDataChannel]>();\n\n  constructor() {}\n\n  createSctpTransport() {\n    const sctp = new RTCSctpTransport();\n    sctp.mid = undefined;\n    sctp.onDataChannel.subscribe((channel) => {\n      this.dataChannelsOpened++;\n      this.dataChannels.push(channel);\n      this.onDataChannel.execute(channel);\n    });\n\n    this.sctpTransport = sctp;\n\n    return sctp;\n  }\n\n  createDataChannel(\n    label: string,\n    options: Partial<{\n      maxPacketLifeTime?: number;\n      protocol: string;\n      maxRetransmits?: number;\n      ordered: boolean;\n      negotiated: boolean;\n      id?: number;\n    }> = {},\n  ): RTCDataChannel {\n    const base: typeof options = {\n      protocol: \"\",\n      ordered: true,\n      negotiated: false,\n    };\n    const settings: Required<typeof base> = { ...base, ...options } as any;\n\n    if (settings.maxPacketLifeTime && settings.maxRetransmits) {\n      throw new Error(\"can not select both\");\n    }\n\n    if (!this.sctpTransport) {\n      this.sctpTransport = this.createSctpTransport();\n    }\n\n    const parameters = new RTCDataChannelParameters({\n      id: settings.id,\n      label,\n      maxPacketLifeTime: settings.maxPacketLifeTime,\n      maxRetransmits: settings.maxRetransmits,\n      negotiated: settings.negotiated,\n      ordered: settings.ordered,\n      protocol: settings.protocol,\n    });\n\n    const channel = new RTCDataChannel(this.sctpTransport, parameters);\n    this.dataChannelsOpened++;\n    this.dataChannels.push(channel);\n    channel.stateChange.subscribe((state) => {\n      if (state === \"closed\") {\n        this.dataChannelsClosed++;\n        const index = this.dataChannels.indexOf(channel);\n        if (index !== -1) {\n          this.dataChannels.splice(index, 1);\n        }\n      }\n    });\n    return channel;\n  }\n\n  async connectSctp() {\n    if (!this.sctpTransport || !this.sctpRemotePort) {\n      return;\n    }\n\n    await this.sctpTransport.start(this.sctpRemotePort);\n    await this.sctpTransport.sctp.stateChanged.connected.asPromise();\n    log(\"sctp connected\");\n  }\n\n  setRemoteSCTP(remoteMedia: MediaDescription, mLineIndex: number) {\n    if (!this.sctpTransport) {\n      return;\n    }\n\n    // # configure sctp\n    this.sctpRemotePort = remoteMedia.sctpPort;\n    if (!this.sctpRemotePort) {\n      throw new Error(\"sctpRemotePort not exist\");\n    }\n\n    this.sctpTransport.setRemotePort(this.sctpRemotePort);\n    this.sctpTransport.mLineIndex = mLineIndex;\n    if (!this.sctpTransport.mid) {\n      this.sctpTransport.mid = remoteMedia.rtp.muxId;\n    }\n  }\n\n  async close() {\n    if (this.sctpTransport) {\n      await this.sctpTransport.stop();\n    }\n\n    this.onDataChannel.allUnsubscribe();\n  }\n\n  async getStats(): Promise<RTCStats[]> {\n    const timestamp = getStatsTimestamp();\n    const stats: RTCStats[] = [];\n\n    for (const channel of this.dataChannels) {\n      const channelStats: RTCDataChannelStats = {\n        type: \"data-channel\",\n        id: generateStatsId(\"data-channel\", channel.id),\n        timestamp,\n        label: channel.label,\n        protocol: channel.protocol,\n        dataChannelIdentifier: channel.id,\n        state: channel.readyState,\n        messagesSent: channel.messagesSent || 0,\n        bytesSent: channel.bytesSent || 0,\n        messagesReceived: channel.messagesReceived || 0,\n        bytesReceived: channel.bytesReceived || 0,\n      };\n      stats.push(channelStats);\n    }\n\n    return stats;\n  }\n}\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 394;\nmodule.exports = webpackEmptyContext;","import { AutoenableMixinProvider } from '@scrypted/common/src/autoenable-mixin-provider';\nimport { Deferred } from '@scrypted/common/src/deferred';\nimport { timeoutPromise } from '@scrypted/common/src/promise-utils';\nimport { legacyGetSignalingSessionOptions } from '@scrypted/common/src/rtc-signaling';\nimport { SettingsMixinDeviceBase, SettingsMixinDeviceOptions } from '@scrypted/common/src/settings-mixin';\nimport { createZygote } from '@scrypted/common/src/zygote';\nimport sdk, { DeviceCreator, DeviceCreatorSettings, DeviceProvider, FFmpegInput, Intercom, MediaConverter, MediaObject, MediaObjectOptions, MixinProvider, RTCSessionControl, RTCSignalingChannel, RTCSignalingClient, RTCSignalingOptions, RTCSignalingSession, RequestMediaStream, RequestMediaStreamOptions, ResponseMediaStreamOptions, ScryptedDeviceType, ScryptedInterface, ScryptedMimeTypes, ScryptedNativeId, Setting, SettingValue, Settings, VideoCamera, WritableDeviceState } from '@scrypted/sdk';\nimport { StorageSettings } from '@scrypted/sdk/storage-settings';\nimport { RpcPeer } from '@scrypted/server/src/rpc';\nimport { createDataChannelSerializer } from '@scrypted/server/src/rpc-serializer';\nimport crypto from 'crypto';\nimport ip from 'ip';\nimport os from 'os';\nimport { WebRTCConnectionManagement, createRTCPeerConnectionSink, createTrackForwarder } from \"./ffmpeg-to-wrtc\";\nimport { stunServers, turnServers, weriftStunServers, weriftTurnServers } from './ice-servers';\nimport { waitClosed } from './peerconnection-util';\nimport { WebRTCCamera } from \"./webrtc-camera\";\nimport { MediaStreamTrack, PeerConfig, RTCPeerConnection, defaultPeerConfig } from './werift';\nimport { WeriftSignalingSession } from './werift-signaling-session';\nimport { RTCPeerConnectionPipe, createRTCPeerConnectionSource, getRTCMediaStreamOptions } from './wrtc-to-rtsp';\n\nconst { mediaManager, systemManager, deviceManager } = sdk;\n\n// https://github.com/shinyoshiaki/werift-webrtc/issues/240\ndefaultPeerConfig.headerExtensions = {\n    video: [],\n    audio: [],\n};\n\nfunction delayWorkerExit(f: ReturnType<WebRTCPlugin['createTrackedFork']>) {\n    setTimeout(() => {\n        f.result.then(rr => rr.exit()).catch(() => { });\n    }, 1000);\n    setTimeout(() => {\n        f.worker.terminate();\n    }, 10000);\n}\n\nclass WebRTCMixin extends SettingsMixinDeviceBase<RTCSignalingClient & VideoCamera & RTCSignalingChannel & Intercom> implements RTCSignalingChannel, VideoCamera, Intercom {\n    storageSettings = new StorageSettings(this, {});\n    webrtcIntercom: Promise<Intercom>;\n\n    constructor(public plugin: WebRTCPlugin, options: SettingsMixinDeviceOptions<RTCSignalingClient & RTCSignalingChannel & Settings & VideoCamera & Intercom>) {\n        super(options);\n    }\n\n    async startIntercom(media: MediaObject): Promise<void> {\n        if (this.webrtcIntercom) {\n            const intercom = await this.webrtcIntercom;\n            return intercom.startIntercom(media);\n        }\n        if (this.mixinDeviceInterfaces.includes(ScryptedInterface.Intercom))\n            return this.mixinDevice.startIntercom(media);\n\n        if (this.mixinDeviceInterfaces.includes(ScryptedInterface.RTCSignalingClient)) {\n            const session = await this.mixinDevice.createRTCSignalingSession();\n\n            const ret = await createRTCPeerConnectionSink(\n                session,\n                this.console,\n                undefined,\n                media,\n                this.plugin.storageSettings.values.requireOpus,\n                this.plugin.storageSettings.values.maximumCompatibilityMode,\n                this.plugin.getRTCConfiguration(),\n                await this.plugin.getWeriftConfiguration(),\n            );\n            return;\n        }\n\n        // odd code path for arlo that has a webrtc connection only for the speaker\n        if ((this.type === ScryptedDeviceType.Speaker || this.type === ScryptedDeviceType.SmartSpeaker)\n            && this.mixinDeviceInterfaces.includes(ScryptedInterface.RTCSignalingChannel)) {\n\n            this.console.log('starting webrtc speaker intercom');\n\n            const pc = new RTCPeerConnection();\n            const atrack = new MediaStreamTrack({ kind: 'audio' });\n            const audioTransceiver = pc.addTransceiver(atrack);\n            const weriftSignalingSession = new WeriftSignalingSession(this.console, pc);\n            const control = await this.mixinDevice.startRTCSignalingSession(weriftSignalingSession);\n\n            const forwarder = await createTrackForwarder({\n                timeStart: Date.now(),\n                videoTransceiver: undefined,\n                audioTransceiver,\n                isLocalNetwork: undefined, destinationId: undefined, ipv4: undefined, type: undefined,\n                requestMediaStream: async () => media,\n                maximumCompatibilityMode: false,\n                clientOptions: undefined,\n            });\n\n            waitClosed(pc).finally(() => forwarder.kill());\n            forwarder.killPromise.finally(() => pc.close());\n\n            forwarder.killPromise.finally(() => control.endSession());\n            return;\n        }\n\n        throw new Error(\"webrtc session not connected.\");\n    }\n\n    async stopIntercom(): Promise<void> {\n        if (this.webrtcIntercom) {\n            const intercom = await this.webrtcIntercom;\n            return intercom.stopIntercom();\n        }\n\n        if (this.mixinDeviceInterfaces.includes(ScryptedInterface.Intercom))\n            return this.mixinDevice.stopIntercom();\n        throw new Error(\"webrtc session not connected.\");\n    }\n\n    async startRTCSignalingSession(session: RTCSignalingSession): Promise<RTCSessionControl> {\n        // if the camera natively has RTCSignalingChannel and the client is not a weird non-browser\n        // thing like Alexa, etc, pass through. Otherwise proxy/transcode.\n\n        // but, maybe we should always proxy?\n\n        const options = await legacyGetSignalingSessionOptions(session);\n        if (this.mixinDeviceInterfaces.includes(ScryptedInterface.RTCSignalingChannel) && !options?.proxy)\n            return this.mixinDevice.startRTCSignalingSession(session);\n\n        const device = systemManager.getDeviceById<VideoCamera & Intercom>(this.id);\n        const hasIntercom = this.mixinDeviceInterfaces.includes(ScryptedInterface.Intercom);\n\n        const requestMediaStream: RequestMediaStream = async options => device.getVideoStream(options);\n        const mo = await mediaManager.createMediaObject(requestMediaStream, ScryptedMimeTypes.RequestMediaStream, {\n            sourceId: device.id,\n        });\n\n        return createRTCPeerConnectionSink(\n            session,\n            this.console,\n            hasIntercom ? 'sendrecv' : 'recvonly',\n            mo,\n            this.plugin.storageSettings.values.requireOpus,\n            this.plugin.storageSettings.values.maximumCompatibilityMode,\n            this.plugin.getRTCConfiguration(),\n            await this.plugin.getWeriftConfiguration(options?.disableTurn),\n            options?.requiresAnswer === true ? false : true,\n        );\n    }\n\n    getMixinSettings(): Promise<Setting[]> {\n        return this.storageSettings.getSettings();\n    }\n\n    putMixinSetting(key: string, value: SettingValue): Promise<void> {\n        return this.storageSettings.putSetting(key, value);\n    }\n\n    createVideoStreamOptions() {\n        const ret = getRTCMediaStreamOptions('webrtc', 'WebRTC');\n        ret.source = 'cloud';\n        return ret;\n    }\n\n    async getVideoStream(options?: RequestMediaStreamOptions): Promise<MediaObject> {\n        if (this.mixinDeviceInterfaces.includes(ScryptedInterface.VideoCamera) && options?.id !== 'webrtc') {\n            return this.mixinDevice.getVideoStream(options);\n        }\n\n        const result = this.plugin.createTrackedFork();\n\n        const fork = await result.result;\n        try {\n            const { getIntercom, mediaObject, pcClose } = await fork.createRTCPeerConnectionSource({\n                __json_copy_serialize_children: true,\n                nativeId: this.nativeId,\n                mixinId: this.id,\n                mediaStreamOptions: this.createVideoStreamOptions(),\n                startRTCSignalingSession: (session) => this.mixinDevice.startRTCSignalingSession(session),\n                maximumCompatibilityMode: this.plugin.storageSettings.values.maximumCompatibilityMode,\n            });\n\n            this.webrtcIntercom = getIntercom();\n            const pcc = pcClose();\n            pcc.finally(() => {\n                this.webrtcIntercom = undefined;\n                delayWorkerExit(result);\n            });\n\n            return mediaObject;\n        }\n        catch (e) {\n            delayWorkerExit(result);\n            throw e;\n        }\n    }\n\n    async getVideoStreamOptions(): Promise<ResponseMediaStreamOptions[]> {\n        let ret: ResponseMediaStreamOptions[] = [];\n        if (this.mixinDeviceInterfaces.includes(ScryptedInterface.VideoCamera)) {\n            ret = await this.mixinDevice.getVideoStreamOptions();\n        }\n        ret.push(this.createVideoStreamOptions());\n        return ret;\n    }\n}\n\nexport class WebRTCPlugin extends AutoenableMixinProvider implements DeviceCreator, DeviceProvider, MediaConverter, MixinProvider, Settings {\n    storageSettings = new StorageSettings(this, {\n        iceInterfaceAddresses: {\n            title: 'ICE Interface Addresses',\n            description: 'The ICE interface addresses to bind and share with the peer.',\n            choices: [\n                'Default',\n                'Scrypted Server Address',\n                'All Addresses',\n            ],\n            defaultValue: 'Default',\n        },\n        requireOpus: {\n            group: 'Advanced',\n            title: 'Require Opus Audio Codec',\n            type: 'boolean',\n        },\n        maximumCompatibilityMode: {\n            group: 'Advanced',\n            title: 'Maximum Compatibility Mode',\n            description: 'Debug: Enables maximum compatibility with WebRTC clients by transcoding to known safe reference codecs. This setting will automatically reset when the plugin or Scrypted restarts.',\n            defaultValue: false,\n            type: 'boolean',\n        },\n        useTurnServer: {\n            group: 'Advanced',\n            title: 'Use TURN Servers',\n            description: 'Uses a intermediary server to send video streams when necessary. Traverses around restrictive NATs.',\n            type: 'boolean',\n            defaultValue: true,\n        },\n        activeConnections: {\n            readonly: true,\n            title: \"Current Open Connections\",\n            description: \"The WebRTC connections that are currently open.\",\n            onGet: async () => {\n                return {\n                    defaultValue: this.activeConnections,\n                }\n            },\n        },\n        ipv4Ban: {\n            group: 'Advanced',\n            title: '6to4 Ban',\n            description: 'The following IP addresses will trigger forcing an IPv6 connection. The default list includes T-Mobile\\'s 6to4 gateway.',\n            defaultValue: [\n                // '192.0.0.4',\n            ],\n            choices: [\n                '192.0.0.4',\n            ],\n            combobox: true,\n            multiple: true,\n        },\n        debugLog: {\n            group: 'Advanced',\n            title: 'Debug Log',\n            type: 'boolean',\n        },\n        rtcConfiguration: {\n            group: 'Advanced',\n            title: \"Custom Client RTC Configuration\",\n            type: 'textarea',\n            description: \"RTCConfiguration that can be used to specify custom TURN and STUN servers. https://gist.github.com/koush/f7dafec7dbca04982a76db8243abc57e\",\n        },\n        weriftConfiguration: {\n            group: 'Advanced',\n            title: \"Custom Server RTC Configuration\",\n            type: 'textarea',\n            description: \"RTCConfiguration that can be used to specify custom TURN and STUN servers. https://gist.github.com/koush/631d38ac8647a86baaac7b22d863f010\",\n        },\n    });\n    activeConnections = 0;\n    zygote = createZygote<Awaited<ReturnType<typeof fork>>>();\n\n    constructor() {\n        super();\n\n        // never want this on, should only be used for debugging.\n        this.storageSettings.values.maximumCompatibilityMode = false;\n\n        this.converters = [\n            [\"*/*\", ScryptedMimeTypes.RTCSignalingChannel],\n            [ScryptedMimeTypes.RTCSignalingSession, ScryptedMimeTypes.RTCConnectionManagement],\n            [ScryptedMimeTypes.RTCSignalingChannel, ScryptedMimeTypes.FFmpegInput],\n        ]\n\n        deviceManager.onDevicesChanged({ devices: [] });\n    }\n\n    shouldUnshiftMixin(): boolean {\n        // it shouldn't matter where this mixin is in the chain, i don't think?\n        return true;\n    }\n\n    getSettings(): Promise<Setting[]> {\n        return this.storageSettings.getSettings();\n    }\n\n    putSetting(key: string, value: SettingValue): Promise<void> {\n        return this.storageSettings.putSetting(key, value);\n    }\n\n    async convertToSignalingChannel(data: any, fromMimeType: string, toMimeType: string, options?: MediaObjectOptions): Promise<RTCSignalingChannel> {\n        const plugin = this;\n\n        const console = deviceManager.getMixinConsole(options?.sourceId, this.nativeId);\n\n        if (fromMimeType !== ScryptedMimeTypes.FFmpegInput && fromMimeType !== ScryptedMimeTypes.RequestMediaStream) {\n            try {\n                const mo = await mediaManager.createMediaObject(data, fromMimeType);\n                data = await mediaManager.convertMediaObjectToJSON<FFmpegInput>(mo, ScryptedMimeTypes.FFmpegInput);\n            }\n            catch (e) {\n                console.error('failed to create media object:', e);\n                throw new Error(`@scrypted/webrtc is unable to convert ${fromMimeType} to ${ScryptedMimeTypes.RTCSignalingChannel}`);\n            }\n            fromMimeType = ScryptedMimeTypes.FFmpegInput;\n        }\n\n        if (fromMimeType === ScryptedMimeTypes.FFmpegInput) {\n            const ffmpegInput: FFmpegInput = typeof data === 'object' && !Buffer.isBuffer(data) ? data : JSON.parse(data.toString());\n            const mo = await mediaManager.createFFmpegMediaObject(ffmpegInput, {\n                sourceId: options?.sourceId,\n            });\n\n            let intercom = sdk.systemManager.getDeviceById<Intercom>(mo.sourceId);\n            if (!intercom.interfaces?.includes(ScryptedInterface.Intercom))\n                intercom = undefined;\n\n            const audioDirection = intercom ? 'sendrecv' : undefined;\n\n            class OnDemandSignalingChannel implements RTCSignalingChannel {\n                async startRTCSignalingSession(session: RTCSignalingSession): Promise<RTCSessionControl> {\n                    return createRTCPeerConnectionSink(session, console,\n                        audioDirection,\n                        mo,\n                        plugin.storageSettings.values.requireOpus,\n                        plugin.storageSettings.values.maximumCompatibilityMode,\n                        plugin.getRTCConfiguration(),\n                        await plugin.getWeriftConfiguration(),\n                    );\n                }\n            }\n\n            return new OnDemandSignalingChannel();\n        }\n\n        const rms = data as RequestMediaStream;\n        const mo = await mediaManager.createMediaObject(rms, ScryptedMimeTypes.RequestMediaStream);\n        class OnDemandSignalingChannel implements RTCSignalingChannel {\n            async startRTCSignalingSession(session: RTCSignalingSession): Promise<RTCSessionControl> {\n                return createRTCPeerConnectionSink(session, console,\n                    undefined,\n                    mo,\n                    plugin.storageSettings.values.requireOpus,\n                    plugin.storageSettings.values.maximumCompatibilityMode,\n                    plugin.getRTCConfiguration(),\n                    await plugin.getWeriftConfiguration(),\n                );\n            }\n        }\n\n        return new OnDemandSignalingChannel();\n    }\n\n    async convertToRTCConnectionManagement(result: ReturnType<typeof this.zygote>, data: any, fromMimeType: string, toMimeType: string, options?: MediaObjectOptions) {\n        const weriftConfiguration = await this.getWeriftConfiguration();\n        const session = data as RTCSignalingSession;\n        const maximumCompatibilityMode = !!this.storageSettings.values.maximumCompatibilityMode;\n        const clientOptions = await legacyGetSignalingSessionOptions(session);\n\n        let connection: WebRTCConnectionManagement;\n        try {\n            const { createConnection } = await result.result;\n            connection = await createConnection(session,\n                this.storageSettings.values.requireOpus,\n                maximumCompatibilityMode,\n                clientOptions,\n                {\n                    configuration: this.getRTCConfiguration(),\n                    weriftConfiguration,\n                    ipv4Ban: this.storageSettings.values.ipv4Ban,\n                }\n            );\n        }\n        catch (e) {\n            delayWorkerExit(result);\n            throw e;\n        }\n        await connection.negotiateRTCSignalingSession();\n        await connection.waitConnected();\n\n        return connection;\n    }\n\n    async convertToFFmpegInput(result: ReturnType<typeof this.zygote>, data: any, fromMimeType: string, toMimeType: string, options?: MediaObjectOptions) {\n        const channel = data as RTCSignalingChannel;\n        try {\n            const { createRTCPeerConnectionSource } = await result.result;\n            const rtcSource = await createRTCPeerConnectionSource({\n                __json_copy_serialize_children: true,\n                nativeId: undefined,\n                mixinId: undefined,\n                mediaStreamOptions: {\n                    id: 'webrtc',\n                    name: 'WebRTC',\n                    source: 'cloud',\n                },\n                startRTCSignalingSession: (session) => channel.startRTCSignalingSession(session),\n                maximumCompatibilityMode: this.storageSettings.values.maximumCompatibilityMode,\n            });\n\n            const mediaStreamUrl = rtcSource.mediaObject;\n            return await mediaManager.convertMediaObjectToJSON<FFmpegInput>(mediaStreamUrl, ScryptedMimeTypes.FFmpegInput);\n        } catch (e) {\n            delayWorkerExit(result);\n            throw e;\n        }\n    }\n\n    createTrackedFork() {\n        const result = this.zygote();\n        this.activeConnections++;\n        result.worker.on('exit', () => {\n            this.activeConnections--;\n        });\n        return result;\n    }\n\n    async convertMedia(data: any, fromMimeType: string, toMimeType: string, options?: MediaObjectOptions) {\n        if (fromMimeType === ScryptedMimeTypes.RTCSignalingSession && toMimeType === ScryptedMimeTypes.RTCConnectionManagement) {\n            const result = this.createTrackedFork();\n            try {\n                const connection = await timeoutPromise(2 * 60 * 1000, this.convertToRTCConnectionManagement(result, data, fromMimeType, toMimeType, options));\n                // wait a bit to allow ffmpegs to get terminated by the thread.\n                connection.waitClosed().finally(() => delayWorkerExit(result));\n                return connection;\n            }\n            catch (e) {\n                delayWorkerExit(result);\n                throw e;\n            }\n        }\n        else if (fromMimeType === ScryptedMimeTypes.RTCSignalingChannel && toMimeType === ScryptedMimeTypes.FFmpegInput) {\n            const result = this.createTrackedFork();\n            try {\n                return await timeoutPromise(2 * 60 * 1000, this.convertToFFmpegInput(result, data, fromMimeType, toMimeType, options));\n            }\n            catch (e) {\n                delayWorkerExit(result);\n                throw e;\n            }\n        }\n        else if (toMimeType === ScryptedMimeTypes.RTCSignalingChannel) {\n            return this.convertToSignalingChannel(data, fromMimeType, toMimeType, options);\n        }\n        else {\n            throw new Error(`@scrypted/webrtc is unable to convert ${fromMimeType} to ${toMimeType}`);\n        }\n    }\n\n    async canMixin(type: ScryptedDeviceType, interfaces: string[]): Promise<string[]> {\n        // if this is a webrtc camera, also proxy the signaling channel too\n        // for inflexible clients.\n        if (interfaces.includes(ScryptedInterface.RTCSignalingChannel) || interfaces.includes(ScryptedInterface.RTCSignalingClient)) {\n            const ret = [\n                ScryptedInterface.RTCSignalingChannel,\n                ScryptedInterface.Settings,\n            ];\n            if (type === ScryptedDeviceType.Speaker) {\n                ret.push(ScryptedInterface.Intercom);\n            }\n            else if (type === ScryptedDeviceType.SmartSpeaker) {\n                ret.push(ScryptedInterface.Intercom, ScryptedInterface.Microphone);\n            }\n            else if (type === ScryptedDeviceType.Camera || type === ScryptedDeviceType.Doorbell) {\n                ret.push(ScryptedInterface.VideoCamera, ScryptedInterface.Intercom);\n            }\n            else if (type === ScryptedDeviceType.Display) {\n                // intercom too?\n                ret.push(ScryptedInterface.Intercom, ScryptedInterface.Display);\n            }\n            else if (type === ScryptedDeviceType.SmartDisplay) {\n                // intercom too?\n                ret.push(ScryptedInterface.Intercom, ScryptedInterface.Microphone, ScryptedInterface.Display, ScryptedInterface.VideoCamera);\n            }\n            else {\n                return;\n            }\n\n            return ret;\n        }\n        else if ([\n            ScryptedDeviceType.Camera,\n            ScryptedDeviceType.Doorbell,\n        ].includes(type) && interfaces.includes(ScryptedInterface.VideoCamera)) {\n            return [\n                ScryptedInterface.RTCSignalingChannel,\n                // ScryptedInterface.Settings,\n            ];\n        }\n    }\n\n    async getMixin(mixinDevice: any, mixinDeviceInterfaces: ScryptedInterface[], mixinDeviceState: WritableDeviceState): Promise<any> {\n        return new WebRTCMixin(this, {\n            mixinDevice,\n            mixinDeviceInterfaces,\n            mixinDeviceState,\n            group: 'WebRTC',\n            groupKey: 'webrtc',\n            mixinProviderNativeId: this.nativeId,\n        })\n    }\n\n    async releaseMixin(id: string, mixinDevice: any): Promise<void> {\n        await mixinDevice.release();\n    }\n\n    async getCreateDeviceSettings(): Promise<Setting[]> {\n        return [\n            {\n                key: 'name',\n                title: 'Name',\n                description: 'The name of the browser connected camera.',\n            }\n        ];\n    }\n\n    async createDevice(settings: DeviceCreatorSettings): Promise<string> {\n        const nativeId = crypto.randomBytes(8).toString('hex');\n        await deviceManager.onDeviceDiscovered({\n            name: settings.name?.toString(),\n            type: ScryptedDeviceType.Camera,\n            nativeId,\n            interfaces: [\n                ScryptedInterface.RTCSignalingClient,\n                ScryptedInterface.Display,\n                ScryptedInterface.Intercom,\n\n                // RTCSignalingChannel is actually implemented as a loopback from the browser, but\n                // since the feed needs to be tee'd to multiple clients, use VideoCamera instead\n                // to do that.\n                ScryptedInterface.VideoCamera,\n            ],\n        });\n        return nativeId;\n    }\n\n    async getDevice(nativeId: string) {\n        return new WebRTCCamera(this, nativeId);\n    }\n\n    async releaseDevice(id: string, nativeId: string): Promise<void> {\n    }\n\n    getRTCConfiguration(): RTCConfiguration {\n        if (this.storageSettings.values.rtcConfiguration) {\n            try {\n                return JSON.parse(this.storageSettings.values.rtcConfiguration);\n            }\n            catch (e) {\n                this.console.error('Custom RTC configuration failed. Invalid JSON?', e);\n            }\n        }\n        // google seems to be throttling requests on their open stun server... using a hosted one seems faster.\n        const iceServers = this.storageSettings.values.useTurnServer ? [...turnServers] : [...stunServers];\n        return {\n            iceServers,\n        };\n    }\n\n    async getWeriftConfiguration(disableTurn?: boolean): Promise<Partial<PeerConfig>> {\n        let ret: Partial<PeerConfig>;\n        if (this.storageSettings.values.weriftConfiguration) {\n            try {\n                ret = JSON.parse(this.storageSettings.values.weriftConfiguration);\n            }\n            catch (e) {\n                this.console.error('Custom Werift configuration failed. Invalid JSON?', e);\n            }\n        }\n\n        const iceServers = this.storageSettings.values.useTurnServer && !disableTurn\n            ? [...weriftStunServers, ...weriftTurnServers]\n            : [...weriftStunServers];\n\n        let iceAdditionalHostAddresses: string[];\n        let iceUseIpv4: boolean;\n        let iceUseIpv6: boolean;\n        if (this.storageSettings.values.iceInterfaceAddresses !== 'All Addresses') {\n            try {\n                // if local addresses are set in scrypted, use those.\n                iceAdditionalHostAddresses = await sdk.endpointManager.getLocalAddresses();\n            }\n            catch (e) {\n            }\n        }\n\n        iceAdditionalHostAddresses ||= [];\n\n        if (iceAdditionalHostAddresses.length) {\n            // sanity check that atleast one of these addresses is valid... ip may change on server.\n            const ni = Object.values(os.networkInterfaces()).flat();\n            iceAdditionalHostAddresses = iceAdditionalHostAddresses.filter(la => ni.find(check => check.address === la));\n            if (iceAdditionalHostAddresses.length) {\n                // disable the default address collection mechanism and use the explicitly provided list.\n                iceUseIpv4 = false;\n                iceUseIpv6 = false;\n            }\n        }\n\n        // the additional addresses don't need to be validated? maybe?\n        if (ret?.iceAdditionalHostAddresses)\n            iceAdditionalHostAddresses.push(...ret.iceAdditionalHostAddresses);\n\n        // deduplicate\n        iceAdditionalHostAddresses = [...new Set(iceAdditionalHostAddresses)];\n\n        if (!iceAdditionalHostAddresses.length)\n            iceAdditionalHostAddresses = undefined;\n\n        return {\n            iceServers,\n            iceUseIpv4,\n            iceUseIpv6,\n            iceAdditionalHostAddresses,\n            ...ret,\n        };\n    }\n}\n\nfunction delayProcessExit() {\n    setTimeout(() => {\n        process.exit(0);\n    }, 1000);\n}\n\nasync function createConnection(\n    clientSession: RTCSignalingSession,\n    requireOpus: boolean,\n    maximumCompatibilityMode: boolean,\n    clientOptions: RTCSignalingOptions,\n    options: {\n        disableIntercom?: boolean;\n        configuration: RTCConfiguration;\n        weriftConfiguration: Partial<PeerConfig>;\n        ipv4Ban?: string[];\n    }) {\n\n    // T-Mobile has a bad 6to4 gateway. When 192.0.0.4 is detected, all ipv4 addresses, besides relay addresses for ipv6 addresses, should be ignored.\n    // thus, the candidate should only be configured if the remote host or relatedAddress is IPv6.\n\n    // a=candidate:2099470302 1 udp 2113937151 192.0.0.4 54018 typ host generation 0 network-cost 999\n    // a=candidate:2171408532 1 udp 2113939711 2607:fb90:eef3:16d9:ad3:fa57:997f:e9e2 43501 typ host generation 0 network-cost 999\n    // a=candidate:1759977254 1 udp 1677729535 172.59.218.164 24868 typ srflx raddr 192.0.0.4 rport 54018 generation 0 network-cost 999\n    // a=candidate:1759256926 1 udp 1677732095 2607:fb90:eef3:16d9:ad3:fa57:997f:e9e2 43501 typ srflx raddr 2607:fb90:eef3:16d9:ad3:fa57:997f:e9e2 rport 43501 generation 0 network-cost 999\n    // a=candidate:821872401 1 udp 33565183 2604:2dc0:200:26d:: 62773 typ relay raddr 2607:fb90:eef3:16d9:ad3:fa57:997f:e9e2 rport 43501 generation 0 network-cost 999\n    // a=candidate:3452552806 1 udp 33562623 147.135.36.109 61385 typ relay raddr 172.59.218.164 rport 24868 generation 0 network-cost 999\n\n    let banned = false;\n    options.weriftConfiguration.iceFilterCandidatePair = (pair) => {\n        // console.log('pair', pair.protocol.type, pair.localCandidate.host, pair.remoteCandidate.host, pair.remoteCandidate.relatedAddress);\n\n        const wasBanned = banned;\n        banned ||= options.ipv4Ban?.includes(pair.remoteCandidate.host);\n        banned ||= options.ipv4Ban?.includes(pair.remoteCandidate.relatedAddress);\n\n        if (!wasBanned && banned) {\n            console.warn('Banned 6to4 gateway detected, forcing IPv6.', pair.remoteCandidate.host, pair.remoteCandidate.relatedAddress);\n        }\n\n        if (!banned)\n            return true;\n\n        if (!ip.isV4Format(pair.remoteCandidate.host))\n            return true;\n        if (!ip.isV4Format(pair.remoteCandidate.relatedAddress))\n            return true;\n        return false;\n    }\n\n    const cleanup = new Deferred<string>();\n    cleanup.promise.catch(e => this.console.log('cleaning up rtc connection:', e.message));\n\n    const connection = new WebRTCConnectionManagement(console, clientSession, requireOpus, maximumCompatibilityMode, clientOptions, options);\n    cleanup.promise.finally(() => connection.close().catch(() => { }));\n    const { pc } = connection;\n    waitClosed(pc).then(() => cleanup.resolve('peer connection closed'));\n\n    const dc = pc.createDataChannel('rpc');\n\n    const serializer = createDataChannelSerializer(dc);\n    const rpcPeer = new RpcPeer('webrtc-plugin', 'webrtc-client', serializer.sendMessage);\n    serializer.setupRpcPeer(rpcPeer);\n    dc.onmessage = (event) => {\n        if (event.data instanceof Buffer) {\n            serializer.onData(event.data);\n        }\n    };\n\n    // connect webrtc plugin directly to another plugin's object and proxy it over the datachannel.\n    // useful for generators.\n    const connectRPCObject: typeof sdk.connectRPCObject = async (o) => {\n        const ret = await sdk.connectRPCObject(o);\n        return ret;\n    };\n    rpcPeer.params.connectRPCObject = connectRPCObject;\n\n    return connection;\n}\n\nexport async function fork() {\n    return {\n        exit() {\n            delayProcessExit();\n        },\n        async createRTCPeerConnectionSource(options: {\n            __json_copy_serialize_children: true,\n            mixinId: string,\n            nativeId: ScryptedNativeId,\n            mediaStreamOptions: ResponseMediaStreamOptions,\n            startRTCSignalingSession: (session: RTCSignalingSession) => Promise<RTCSessionControl | undefined>,\n            maximumCompatibilityMode: boolean,\n        }): Promise<RTCPeerConnectionPipe> {\n            try {\n                const ret = await createRTCPeerConnectionSource({\n                    nativeId: this.nativeId,\n                    mixinId: options.mixinId,\n                    mediaStreamOptions: options.mediaStreamOptions,\n                    startRTCSignalingSession: (session) => options.startRTCSignalingSession(session),\n                    maximumCompatibilityMode: options.maximumCompatibilityMode,\n                });\n                ret.pcClose().finally(() => delayProcessExit());\n                return ret;\n            }\n            catch (e) {\n                delayProcessExit();\n                throw e;\n            }\n        },\n\n        async createConnection(\n            clientSession: RTCSignalingSession,\n            requireOpus: boolean,\n            maximumCompatibilityMode: boolean,\n            clientOptions: RTCSignalingOptions,\n            options: {\n                disableIntercom?: boolean;\n                configuration: RTCConfiguration;\n                weriftConfiguration: Partial<PeerConfig>;\n                ipv4Ban?: string[];\n            }) {\n            try {\n                const ret = await createConnection(clientSession, requireOpus, maximumCompatibilityMode, clientOptions, options);\n                ret.waitClosed().finally(() => delayProcessExit());\n                // let states: typeof ret.pc.iceConnectionState[] = [];\n                // ret.pc.iceConnectionStateChange.subscribe(state => {\n                //     states.push(state);\n                // });\n                // setInterval(() => {\n                //     console.log('Connection is still active', ret.pc.connectionState, ret.pc.iceConnectionState);\n                // }, 10000);\n                return ret;\n            }\n            catch (e) {\n                delayProcessExit();\n                throw e;\n            }\n        }\n    }\n}\n\nexport default WebRTCPlugin;\n","import { RTCIceCandidate, RTCPeerConnection } from \"./werift\";\nimport { RTCAVSignalingSetup, RTCSignalingOptions, RTCSignalingSendIceCandidate, RTCSignalingSession } from '@scrypted/sdk';\nimport { createRawResponse } from \"./werift-util\";\nimport { sleep } from \"@scrypted/common/src/sleep\";\nimport ip from 'ip';\n\nfunction isV6Only(address: string) {\n    return !ip.isV4Format(address) && ip.isV6Format(address);\n}\n\nexport class WeriftSignalingSession implements RTCSignalingSession {\n    remoteDescription: Promise<any>;\n    __proxy_props: { options: {}; };\n    options: RTCSignalingOptions = {};\n\n    constructor(public console: Console, public pc: RTCPeerConnection) {\n    }\n\n    async getOptions(): Promise<RTCSignalingOptions> {\n        return {};\n    }\n\n    localHasV6 = false;\n    async createLocalDescription(type: \"offer\" | \"answer\", setup: RTCAVSignalingSetup, sendIceCandidate: RTCSignalingSendIceCandidate): Promise<RTCSessionDescriptionInit> {\n        // werift turn does not seem to work? maybe? sometimes it does? we ignore it here, and that's fine as only 1 side\n        // needs turn.\n        // stun candidates will come through here, if connection is slow to establish.\n        this.pc.onIceCandidate.subscribe(candidate => {\n            this.localHasV6 ||= isV6Only(candidate.candidate?.split(' ')?.[4]);\n\n            // this.console.log('local candidate', candidate.candidate);\n\n            sendIceCandidate?.({\n                candidate: candidate.candidate,\n                sdpMid: candidate.sdpMid,\n                sdpMLineIndex: candidate.sdpMLineIndex,\n            });\n        });\n\n        let ret: RTCSessionDescriptionInit;\n        if (type === 'offer') {\n            let offer = await this.pc.createOffer();\n            if (!sendIceCandidate)\n                offer = (await this.pc.setLocalDescription(offer)).toJSON();\n            else\n                this.pc.setLocalDescription(offer);\n            ret = createRawResponse(offer);\n        }\n        else {\n            if (!sendIceCandidate)\n                await this.remoteDescription;\n            let answer = await this.pc.createAnswer();\n            if (!sendIceCandidate)\n                answer = (await this.pc.setLocalDescription(answer)).toJSON();\n            else\n                this.pc.setLocalDescription(answer);\n            ret = createRawResponse(answer);\n        }\n        return ret;\n    }\n\n    async setRemoteDescription(description: RTCSessionDescriptionInit, setup: RTCAVSignalingSetup) {\n        this.remoteDescription = this.pc.setRemoteDescription(description as any);\n    }\n\n    remoteHasV6 = false;\n    async addIceCandidate(candidate: RTCIceCandidateInit) {\n        this.remoteHasV6 ||= isV6Only(candidate.candidate?.split(' ')?.[4]);\n\n        if (candidate.candidate?.includes('relay')) {\n            // note: this code is done, werift was modified to ban bad ips like 6to4 relays from tmobile.\n\n            // todo: fix this in werift or verify it still occurs at later point\n            // werift seems to choose whatever candidate pair results in the fastest connection.\n            // this makes it sometimes choose the STUN or TURN candidate even when\n            // on the local network.\n            // if (this.remoteHasV6 && !this.localHasV6) {\n            //     this.console.log('Possible mobile network IPv6to4 translation detected.');\n            // }\n            // else {\n            //     await sleep(500);\n            // }\n\n            await sleep(500);\n        }\n        else if (candidate.candidate?.includes('srflx')) {\n            await sleep(250);\n        }\n\n        await this.pc.addIceCandidate(new RTCIceCandidate(candidate));\n    }\n}","import { createCipher } from \"../../cipher/create\";\nimport {\n  prfExtendedMasterSecret,\n  prfMasterSecret,\n  prfPreMasterSecret,\n} from \"../../cipher/prf\";\nimport type { CipherContext } from \"../../context/cipher\";\nimport type { DtlsContext } from \"../../context/dtls\";\nimport type { TransportContext } from \"../../context/transport\";\nimport { HandshakeType } from \"../../handshake/const\";\nimport { Certificate } from \"../../handshake/message/certificate\";\nimport { ChangeCipherSpec } from \"../../handshake/message/changeCipherSpec\";\nimport { CertificateVerify } from \"../../handshake/message/client/certificateVerify\";\nimport { ClientKeyExchange } from \"../../handshake/message/client/keyExchange\";\nimport { Finished } from \"../../handshake/message/finished\";\nimport { debug } from \"../../imports/common\";\nimport { createPlaintext } from \"../../record/builder\";\nimport { ContentType } from \"../../record/const\";\nimport type { FragmentedHandshake } from \"../../record/message/fragment\";\nimport { Flight } from \"../flight\";\n\nconst log = debug(\"werift-dtls : packages/dtls/flight/server/flight6.ts\");\n\nexport class Flight6 extends Flight {\n  constructor(\n    udp: TransportContext,\n    dtls: DtlsContext,\n    private cipher: CipherContext,\n  ) {\n    super(udp, dtls, 6);\n  }\n\n  handleHandshake(handshake: FragmentedHandshake) {\n    this.dtls.bufferHandshakeCache([handshake], false, 5);\n\n    const message = (() => {\n      switch (handshake.msg_type) {\n        case HandshakeType.certificate_11:\n          return Certificate.deSerialize(handshake.fragment);\n        case HandshakeType.certificate_verify_15:\n          return CertificateVerify.deSerialize(handshake.fragment);\n        case HandshakeType.client_key_exchange_16:\n          return ClientKeyExchange.deSerialize(handshake.fragment);\n        case HandshakeType.finished_20:\n          return Finished.deSerialize(handshake.fragment);\n      }\n    })();\n\n    if (message) {\n      const handler = handlers[message.msgType];\n      if (!handler) {\n        // todo handle certificate_11\n        // todo handle certificate_verify_15\n        return;\n      }\n      handler({ dtls: this.dtls, cipher: this.cipher })(message);\n    }\n  }\n\n  async exec() {\n    if (this.dtls.flight === 6) {\n      log(this.dtls.sessionId, \"flight6 twice\");\n      this.send(this.dtls.lastMessage);\n      return;\n    }\n    this.dtls.flight = 6;\n\n    const messages = [this.sendChangeCipherSpec(), this.sendFinished()];\n    this.dtls.lastMessage = messages;\n    await this.transmit(messages);\n  }\n\n  private sendChangeCipherSpec() {\n    const changeCipherSpec = ChangeCipherSpec.createEmpty().serialize();\n    const packets = createPlaintext(this.dtls)(\n      [{ type: ContentType.changeCipherSpec, fragment: changeCipherSpec }],\n      ++this.dtls.recordSequenceNumber,\n    );\n    const buf = Buffer.concat(packets.map((v) => v.serialize()));\n    return buf;\n  }\n\n  private sendFinished() {\n    const cache = Buffer.concat(\n      this.dtls.sortedHandshakeCache.map((v) => v.serialize()),\n    );\n\n    const localVerifyData = this.cipher.verifyData(cache);\n    const finish = new Finished(localVerifyData);\n\n    this.dtls.epoch = 1;\n    const [packet] = this.createPacket([finish]);\n    this.dtls.recordSequenceNumber = 0;\n\n    const buf = this.cipher.encryptPacket(packet).serialize();\n    return buf;\n  }\n}\n\nconst handlers: {\n  [key: number]: (contexts: {\n    dtls: DtlsContext;\n    cipher: CipherContext;\n  }) => (message: any) => void;\n} = {};\n\nhandlers[HandshakeType.client_key_exchange_16] =\n  ({ cipher, dtls }) =>\n  (message: ClientKeyExchange) => {\n    cipher.remoteKeyPair = {\n      curve: cipher.namedCurve,\n      publicKey: message.publicKey,\n    };\n    if (\n      !cipher.remoteKeyPair.publicKey ||\n      !cipher.localKeyPair ||\n      !cipher.remoteRandom ||\n      !cipher.localRandom\n    )\n      throw new Error(\"not exist\");\n\n    const preMasterSecret = prfPreMasterSecret(\n      cipher.remoteKeyPair.publicKey,\n      cipher.localKeyPair.privateKey,\n      cipher.localKeyPair.curve,\n    );\n\n    log(\n      dtls.sessionId,\n      \"extendedMasterSecret\",\n      dtls.options.extendedMasterSecret,\n      dtls.remoteExtendedMasterSecret,\n    );\n\n    const handshakes = Buffer.concat(\n      dtls.sortedHandshakeCache.map((v) => v.serialize()),\n    );\n    cipher.masterSecret =\n      dtls.options.extendedMasterSecret && dtls.remoteExtendedMasterSecret\n        ? prfExtendedMasterSecret(preMasterSecret, handshakes)\n        : prfMasterSecret(\n            preMasterSecret,\n            cipher.remoteRandom.serialize(),\n            cipher.localRandom.serialize(),\n          );\n\n    cipher.cipher = createCipher(cipher.cipherSuite!);\n    cipher.cipher.init(\n      cipher.masterSecret,\n      cipher.localRandom.serialize(),\n      cipher.remoteRandom.serialize(),\n    );\n    log(dtls.sessionId, \"setup cipher\", cipher.cipher.summary);\n  };\n\nhandlers[HandshakeType.finished_20] =\n  ({ dtls }) =>\n  (message: Finished) => {\n    log(dtls.sessionId, \"finished\", message);\n  };\n","export interface RefreshPromise<T> {\n    promise: Promise<T>;\n    cacheDuration: number;\n}\n\nexport function singletonPromise<T>(rp: undefined | RefreshPromise<T>, method: () => Promise<T>, cacheDuration = 0) {\n    if (rp?.promise)\n        return rp;\n\n    const promise = method();\n    if (!rp) {\n        rp = {\n            promise,\n            cacheDuration,\n        }\n    }\n    else {\n        rp.promise = promise;\n    }\n    promise.finally(() => setTimeout(() => rp.promise = undefined, rp.cacheDuration));\n    return rp;\n}\n\nexport class TimeoutError<T> extends Error {\n    constructor(public promise: Promise<T>) {\n        super('Operation Timed Out');\n    }\n}\n\nexport function timeoutPromise<T>(timeout: number, promise: Promise<T>): Promise<T> {\n    return new Promise<T>((resolve, reject) => {\n        const t = setTimeout(() => reject(new TimeoutError(promise)), timeout);\n\n        promise\n            .then(v => {\n                clearTimeout(t);\n                resolve(v);\n            })\n            .catch(e => {\n                clearTimeout(t);\n                reject(e);\n            });\n    })\n}\n\nexport function timeoutFunction<T>(timeout: number, f: (isTimedOut: () => boolean) => Promise<T>): Promise<T> {\n    return new Promise<T>((resolve, reject) => {\n        let isTimedOut = false;\n        const promise = f(() => isTimedOut);\n\n        const t = setTimeout(() => {\n            isTimedOut = true;\n            reject(new TimeoutError(promise));\n        }, timeout);\n\n        promise\n            .then(v => {\n                clearTimeout(t);\n                resolve(v);\n            })\n            .catch(e => {\n                clearTimeout(t);\n                reject(e);\n            });\n    })\n}\n\nexport function createPromiseDebouncer<T>() {\n    let current: Promise<T>;\n\n    return (func: () => Promise<T>): Promise<T> => {\n        if (!current)\n            current = func().finally(() => current = undefined);\n        return current;\n    }\n}\n\nexport function createMapPromiseDebouncer<T>() {\n    const map = new Map<string, Promise<T>>();\n\n    return (key: any, debounce: number, func: () => Promise<T>): Promise<T> => {\n        const keyStr = JSON.stringify(key);\n        let value = map.get(keyStr);\n        if (!value) {\n            value = func().finally(() => {\n                if (!debounce) {\n                    map.delete(keyStr);\n                    return;\n                }\n                setTimeout(() => map.delete(keyStr), debounce);\n            });\n            map.set(keyStr, value);\n        }\n        return value;\n    }\n}\n","import { Deferred } from \"@scrypted/common/src/deferred\";\nimport { closeQuiet, createBindZero, listenZeroSingleClient } from \"@scrypted/common/src/listen-cluster\";\nimport { ffmpegLogInitialOutput, safeKillFFmpeg, safePrintFFmpegArguments } from \"@scrypted/common/src/media-helpers\";\nimport { RtspClient, RtspServer, RtspServerResponse, RtspStatusError } from \"@scrypted/common/src/rtsp-server\";\nimport { MSection, RTPMap, addTrackControls, parseSdp, replaceSectionPort } from \"@scrypted/common/src/sdp-utils\";\nimport sdk, { FFmpegInput } from \"@scrypted/sdk\";\nimport child_process, { ChildProcess } from 'child_process';\nimport dgram from 'dgram';\nimport { Writable } from \"stream\";\nimport { RtpPacket } from \"../../../external/werift/packages/rtp/src/rtp/rtp\";\n\nconst { mediaManager } = sdk;\n\ntype StringWithAutocomplete<T> = T | (string & Record<never, never>);\n\nexport type RtpCodecCopy = StringWithAutocomplete<\"copy\">;\n\nexport interface RtpTrack {\n    negotiate?: (msection: MSection) => Promise<boolean>;\n    codecCopy?: RtpCodecCopy;\n    alternateCodecs?: string[];\n    ffmpegDestination?: string;\n    packetSize?: number;\n    encoderArguments: string[];\n    outputArguments?: string[];\n    onRtp(rtp: Buffer, codec: string): void;\n    onMSection?: (msection: MSection) => void;\n    firstPacket?: (rtp: Buffer, codec: string) => void;\n    payloadType?: number;\n    rtcpPort?: number;\n    ssrc?: number;\n    srtp?: {\n        crytoSuite: string;\n        key: Buffer;\n    };\n    bind?: Awaited<ReturnType<typeof createBindZero>>;\n}\n\nexport type RtpTracks = {\n    audio?: RtpTrack;\n    video?: RtpTrack;\n};\n\nexport type RtpSockets = {\n    audio?: dgram.Socket;\n    video?: dgram.Socket;\n};\n\nfunction createPacketDelivery(track: RtpTrack) {\n    const original = track.onRtp;\n    track.onRtp = (rtp, codec) => {\n        track.onRtp = original;\n        track.firstPacket?.(rtp, codec);\n        track.onRtp(rtp, codec);\n    }\n\n    return (rtp: Buffer, codec: string) => track.onRtp(rtp, codec);\n}\n\nfunction attachTrackDgram(track: RtpTrack, server: dgram.Socket, codec: () =>string) {\n    const delivery = createPacketDelivery(track);\n    server?.on('message', rtp => delivery(rtp, codec()));\n}\n\nasync function setupRtspClient(console: Console, rtspClient: RtspClient, channel: number, section: MSection, rtspClientForceTcp: boolean, deliver: ReturnType<typeof createPacketDelivery>) {\n    const codec = section.codec;\n    try {\n        if (!rtspClientForceTcp) {\n            const result = await rtspClient.setup({\n                type: 'udp',\n                path: section.control,\n                onRtp: (rtspHeader, rtp) => deliver(rtp, codec),\n            });\n            // console.log('rtsp/udp', section.codec, result);\n            return false;\n        }\n    }\n    catch (e) {\n        if (!(e instanceof RtspStatusError))\n            throw e;\n    }\n    await rtspClient.setup({\n        type: 'tcp',\n        port: channel,\n        path: section.control,\n        onRtp: (rtspHeader, rtp) => deliver(rtp, codec),\n    });\n    // console.log('rtsp/tcp', section.codec);\n    return true;\n}\n\nasync function createTrackForwarders(console: Console, killDeferred: Deferred<void>, rtpTracks: RtpTracks) {\n\n    for (const key of Object.keys(rtpTracks)) {\n        const track: RtpTrack = rtpTracks[key];\n        track.bind = await createBindZero();\n        track.bind.server.setRecvBufferSize(1024 * 1024);\n        const { server, port } = track.bind;\n        killDeferred.promise.finally(() => closeQuiet(server));\n        const outputArguments = track.outputArguments = [];\n        if (track.payloadType)\n            outputArguments.push('-payload_type', track.payloadType.toString());\n        if (track.ssrc)\n            outputArguments.push('-ssrc', track.ssrc.toString());\n\n    }\n}\n\nfunction isCodecCopy(desiredCodec: RtpCodecCopy, checkCodec: string) {\n    return desiredCodec === 'copy'\n        || (desiredCodec && desiredCodec === checkCodec);\n}\n\nexport type RtpForwarderProcess = Awaited<ReturnType<typeof startRtpForwarderProcess>>;\n\nexport async function startRtpForwarderProcess(console: Console, ffmpegInput: FFmpegInput, rtpTracks: RtpTracks, options?: {\n    ffmpegPath?: string,\n    rtspClientForceTcp?: boolean,\n    rtspMode?: 'udp' | 'tcp' | 'pull',\n    onRtspClient?: (rtspClient: RtspClient, optionsResponse: RtspServerResponse) => Promise<boolean>,\n}) {\n    if (!rtpTracks.audio)\n        delete rtpTracks.audio;\n    if (!rtpTracks.video)\n        delete rtpTracks.video;\n\n    const killDeferred = new Deferred<void>();\n\n    const killGuard = (track: RtpTrack) => {\n        const old = track?.onRtp;\n        if (old) {\n            track.onRtp = (rtp, codec) => {\n                if (killDeferred.finished)\n                    return;\n                const payloadType = rtp.readUint8(1) & 0x7f;\n                // ignore rtcp.\n                if (payloadType >= 72 && payloadType <= 76)\n                    return;\n                old(rtp, codec);\n            }\n        }\n    }\n    killGuard(rtpTracks.video);\n    killGuard(rtpTracks.audio);\n\n    let { inputArguments } = ffmpegInput;\n    let rtspClient: RtspClient;\n    killDeferred.promise.finally(() => rtspClient?.safeTeardown());\n    let pipeSdp: string;\n\n    let rtspClientHooked = false;\n    const { rtspMode, onRtspClient, rtspClientForceTcp } = options || {};\n    const { video, audio } = rtpTracks;\n    rtpTracks = Object.assign({}, rtpTracks);\n    const videoCodec = video?.codecCopy;\n    const audioCodec = audio?.codecCopy;\n    const ffmpegPath = options?.ffmpegPath || await mediaManager.getFFmpegPath();\n\n    const isRtsp = ffmpegInput.container?.startsWith('rtsp');\n\n    let rtspSdp: string;\n    const sdpDeferred = new Deferred<string>();\n    killDeferred.promise.finally(() => {\n        if (!sdpDeferred.finished)\n            sdpDeferred.reject(new Error('killed'));\n    });\n    const videoSectionDeferred = new Deferred<MSection>();\n    const audioSectionDeferred = new Deferred<MSection>();\n    videoSectionDeferred.promise.then(s => video?.onMSection?.(s));\n    audioSectionDeferred.promise.then(s => audio?.onMSection?.(s));\n    let allowAudioTranscoderExit = false;\n\n    if (ffmpegInput.url\n        && isRtsp\n        && (!video || isCodecCopy(videoCodec, ffmpegInput.mediaStreamOptions?.video?.codec))) {\n\n        // console.log('video codec matched:', rtpTracks.video.codecCopy);\n\n        delete rtpTracks.video;\n\n        rtspClient = new RtspClient(ffmpegInput.url);\n        rtspClient.requestTimeout = 10000;\n\n        try {\n            const optionsResponse = await rtspClient.options();\n            const describe = await rtspClient.describe();\n            rtspSdp = describe.body.toString();\n            const parsedSdp = parseSdp(rtspSdp);\n            let videoSection: MSection;\n\n            let channel = 0;\n\n            if (video) {\n                videoSection = parsedSdp.msections.find(msection => msection.type === 'video' && (msection.codec === videoCodec || videoCodec === 'copy'));\n                // maybe fallback to udp forwarding/transcoding?\n                if (!videoSection)\n                    throw new Error(`advertised video codec ${videoCodec} not found in sdp.`);\n\n                if (!videoSection.codec) {\n                    console.warn('Unable to determine sdpvideo codec? Please report this to @koush on Discord.');\n                    console.warn(rtspSdp);\n                }\n\n                videoSectionDeferred.resolve(videoSection);\n\n                const setup = new Set<MSection>();\n                setup.add(videoSection);\n\n                for (const alternateCodec of video.alternateCodecs|| []) {\n                    const section = parsedSdp.msections.find(msection => msection.type === 'video' && msection.codec === alternateCodec);\n                    if (!section || setup.has(section))\n                        continue;\n                    setup.add(section);\n                }\n\n                const delivery = createPacketDelivery(video);\n                for (const section of setup) {\n                    await setupRtspClient(console, rtspClient, channel, section, rtspClientForceTcp, delivery);\n                    channel += 2;\n                }\n            }\n            else {\n                videoSectionDeferred.resolve(undefined);\n            }\n\n            const audioSections = parsedSdp.msections.filter(msection => msection.type === 'audio');\n            let audioSection = audioSections.find(msection => (msection.codec && msection.codec === audioCodec) || audioCodec === 'copy');\n            if (!audioSection) {\n                for (const check of audioSections) {\n                    if (await audio?.negotiate?.(check) === true) {\n                        audioSection = check;\n                        break;\n                    }\n                }\n            }\n\n            console.log('a/v', videoCodec, audioCodec, 'found', videoSection?.codec, audioSection?.codec);\n\n            if (audio) {\n                if (audioSection) {\n\n                    // console.log('audio codec matched:', audio.codecCopy);\n\n                    delete rtpTracks.audio;\n\n                    audioSectionDeferred.resolve(audioSection);\n\n                    const setup = new Set<MSection>();\n                    setup.add(audioSection);\n\n                    for (const alternateCodec of audio.alternateCodecs || []) {\n                        const section = parsedSdp.msections.find(msection => msection.type === 'audio' && msection.codec === alternateCodec);\n                        if (!section || setup.has(section))\n                            continue;\n                        setup.add(section);\n                    }\n\n                    const delivery = createPacketDelivery(audio);\n                    for (const section of setup) {\n                        await setupRtspClient(console, rtspClient, channel, section, rtspClientForceTcp, delivery);\n                        channel += 2;\n                    }\n                }\n                else {\n                    // console.log('audio codec transcoding:', audio.codecCopy);\n\n                    const newSdp = parseSdp(rtspSdp);\n                    const audioSection = newSdp.msections.find(msection => msection.type === 'audio');\n\n                    if (!audioSection) {\n                        delete rtpTracks.audio;\n                        console.warn(`audio section not found in sdp.`);\n                        audioSectionDeferred.resolve(undefined);\n                    }\n                    else {\n                        newSdp.msections = newSdp.msections.filter(msection => msection === audioSection);\n                        const audioSdp = addTrackControls(replaceSectionPort(newSdp.toSdp(), 'audio', 0));\n                        const parsedAudioSdp = parseSdp(audioSdp);\n                        const audioControl = parsedAudioSdp.msections.find(msection => msection.type === 'audio').control;\n\n                        let firstPacket = true;\n                        let adts = false;\n\n                        // if the rtsp client is over tcp, then the restream server must also be tcp, as\n                        // the rtp packets (which can be a max of 64k) may be too large for udp.\n                        const clientIsTcp = await setupRtspClient(console, rtspClient, channel, audioSection, false, rtp => {\n                            // live555 sends rtp aac packets without AU header followed by ADTS packets (which contain codec info)\n                            // which ffmpeg can not handle.\n                            // the solution is to demux the adts and send that to ffmpeg raw.\n                            // https://github.com/mpv-player/mpv/issues/5669#issuecomment-932519409\n                            if (firstPacket) {\n                                firstPacket = false;\n                                if (audioSection.codec === 'aac') {\n                                    const packet = RtpPacket.deSerialize(rtp);\n                                    const buf = packet.payload;\n                                    // adts header is 12 bits of 1s\n                                    if (buf[0] == 0xff && (buf[1] & 0xf0) == 0xf0) {\n                                        adts = true;\n                                        allowAudioTranscoderExit = true;\n                                        const ffmpegArgs = [\n                                            '-hide_banner',\n                                            '-f', 'aac',\n                                            '-i', 'pipe:3',\n                                            ...audio.encoderArguments,\n                                            ...audio.outputArguments,\n                                        ];\n\n                                        safePrintFFmpegArguments(console, ffmpegArgs);\n                                        const cp = child_process.spawn(ffmpegPath, ffmpegArgs, {\n                                            stdio: ['pipe', 'pipe', 'pipe', 'pipe', 'pipe'],\n                                        });\n                                        ffmpegLogInitialOutput(console, cp);\n                                        killDeferred.promise.finally(() => safeKillFFmpeg(cp));\n                                        cp.on('exit', () => killDeferred.resolve(undefined));\n                                        cp.on('error', () => killDeferred.resolve(undefined));\n\n                                        audioPipe = cp.stdio[3] as Writable;\n                                    }\n                                }\n                            }\n\n                            if (!adts) {\n                                rtspServer?.sendTrack(audioControl, rtp, false);\n                            }\n                            else {\n                                const packet = RtpPacket.deSerialize(rtp);\n                                audioPipe?.write(packet.payload);\n                            }\n                        });\n\n                        const audioClient = await listenZeroSingleClient('127.0.0.1');\n                        let audioPipe: Writable;\n                        killDeferred.promise.finally(() => audioClient.clientPromise.then(client => client.destroy()));\n                        let rtspServer: RtspServer;\n                        audioClient.clientPromise.then(async client => {\n                            const r = new RtspServer(client, audioSdp, !clientIsTcp);\n                            killDeferred.promise.finally(() => r.destroy());\n                            await r.handlePlayback();\n                            rtspServer = r;\n                        })\n                            .catch(e => {\n                                if (!killDeferred.finished)\n                                    killDeferred.reject(e);\n                            });\n\n                        audio.ffmpegDestination = '127.0.0.1';\n                        audio.srtp = undefined;\n\n                        inputArguments = [\n                            '-analyzeduration', '0',\n                            '-probesize', '512',\n                            '-i', `rtsp://${audioClient.host}:${audioClient.port}`,\n                        ];\n                    }\n                }\n            }\n            else {\n                audioSectionDeferred.resolve(undefined);\n            }\n\n            rtspClientHooked = await onRtspClient?.(rtspClient, optionsResponse);\n            if (!rtspClientHooked)\n                await rtspClient.play();\n        }\n        catch (e) {\n            rtspClient.client.destroy();\n            throw e;\n        }\n    }\n    else {\n        console.log('video codec/container not matched, transcoding:', videoCodec, JSON.stringify(ffmpegInput));\n    }\n\n    let rtpVideoCodec: string;\n    let rtpAudioCodec: string;\n    const reportTranscodedSections = (sdp: string) => {\n        sdpDeferred.resolve(sdp);\n        const parsedSdp = parseSdp(sdp);\n        const videoSection = parsedSdp.msections.find(msection => msection.type === 'video');\n        const audioSection = parsedSdp.msections.find(msection => msection.type === 'audio');\n\n        rtpVideoCodec = videoSection?.codec;\n        rtpAudioCodec = audioSection?.codec;\n\n        videoSectionDeferred.resolve(videoSection);\n        audioSectionDeferred.resolve(audioSection);\n\n        return { videoSection, audioSection };\n    }\n\n    await createTrackForwarders(console, killDeferred, rtpTracks);\n\n    rtspClient?.client.on('close', () => killDeferred.resolve(undefined));\n\n    const useRtp = !rtspMode;\n    const rtspServerDeferred = new Deferred<RtspServer>();\n\n    // will no op if there's no tracks\n    let cp: ChildProcess;\n    if (Object.keys(rtpTracks).length) {\n        if (useRtp) {\n            rtspServerDeferred.resolve(undefined);\n\n            for (const key of Object.keys(rtpTracks)) {\n                const track: RtpTrack = rtpTracks[key];\n\n                let destination = track.ffmpegDestination || '127.0.0.1';\n                if (destination === '127.0.0.1')\n                    destination = `${destination}:${track.bind.port}`;\n                const params = new URLSearchParams();\n                let url = `rtp://${destination}`;\n                if (track.rtcpPort)\n                    params.set('rtcpport', track.rtcpPort.toString());\n                if (track.packetSize)\n                    params.set('pkt_size', track.packetSize.toString());\n                if (track.srtp) {\n                    url = `s${url}`;\n                    track.outputArguments.push(\n                        \"-srtp_out_suite\", track.srtp.crytoSuite,\n                        \"-srtp_out_params\", track.srtp.key.toString('base64'),\n                    );\n                }\n                url = `${url}?${params}`;\n\n                track.outputArguments.push('-dn', '-sn');\n                if (key !== 'video')\n                    track.outputArguments.push('-vn');\n                if (key !== 'audio')\n                    track.outputArguments.push('-an');\n                track.outputArguments.push('-f', 'rtp');\n                track.outputArguments.push(url);\n            }\n        }\n\n        const outputArguments: string[] = [];\n\n        for (const key of Object.keys(rtpTracks)) {\n            const track: RtpTrack = rtpTracks[key];\n            outputArguments.push(...track.encoderArguments, ...track.outputArguments);\n        }\n\n        const args = [\n            '-hide_banner',\n\n            ...inputArguments,\n            ...outputArguments,\n        ];\n\n        if (useRtp) {\n            if (video?.bind?.server)\n                attachTrackDgram(video, video.bind.server, () => rtpVideoCodec);\n            if (audio?.bind?.server)\n                attachTrackDgram(audio, audio.bind.server, () => rtpAudioCodec);\n\n            args.push(\n                '-sdp_file', 'pipe:4',\n            );\n        }\n        else {\n            // seems better to use udp for audio timing/chop.\n            const useUdp = rtspMode === 'udp';\n\n            const serverPort = await listenZeroSingleClient('127.0.0.1');\n\n            args.push(\n                '-rtsp_transport',\n                useUdp ? 'udp' : 'tcp',\n                '-f', 'rtsp',\n                `rtsp://127.0.0.1:${serverPort.port}`\n            );\n\n            serverPort.clientPromise.then(async (client) => {\n                client.on('close', () => killDeferred.resolve(undefined));\n                killDeferred.promise.finally(() => client.destroy());\n\n                const rtspServer = new RtspServer(client, undefined, useUdp);\n                // rtspServer.console = console;\n\n                await rtspServer.handleSetup(['announce']);\n                const { videoSection, audioSection } = reportTranscodedSections(rtspServer.sdp);\n                await rtspServer.handleSetup();\n\n                if (video)\n                    attachTrackDgram(video, rtspServer.setupTracks[videoSection?.control]?.rtp, () => videoSection.codec);\n                if (audio)\n                    attachTrackDgram(audio, rtspServer.setupTracks[audioSection?.control]?.rtp, () => audioSection.codec);\n\n                rtspServerDeferred.resolve(rtspServer);\n\n                if (rtspMode !== 'pull') {\n                    let firstVideoPacket = true;\n                    let firstAudioPacket = true;\n                    for await (const rtspSample of rtspServer.handleRecord()) {\n                        if (rtspSample.type === videoSection.codec) {\n                            if (firstVideoPacket) {\n                                firstVideoPacket = false;\n                                video.firstPacket?.(rtspSample.packet, videoSection.codec);\n                            }\n                            video.onRtp(rtspSample.packet, videoSection.codec);\n                        }\n                        else if (rtspSample.type === audioSection?.codec) {\n                            if (firstAudioPacket) {\n                                firstAudioPacket = false;\n                                rtpTracks.audio.firstPacket?.(rtspSample.packet, audioSection?.codec);\n                            }\n                            audio.onRtp(rtspSample.packet, audioSection?.codec);\n                        }\n                        else {\n                            console.warn('unexpected rtsp sample', rtspSample.type);\n                        }\n                    }\n                }\n            })\n                .catch(e => {\n                    if (!killDeferred.finished)\n                        killDeferred.reject(e);\n                });\n        }\n\n        safePrintFFmpegArguments(console, args);\n\n        cp = child_process.spawn(ffmpegPath, args, {\n            stdio: ['pipe', 'pipe', 'pipe', 'pipe', 'pipe', 'pipe'],\n        });\n        killDeferred.promise.finally(() => safeKillFFmpeg(cp));\n        cp.on('exit', () => {\n            if (!allowAudioTranscoderExit)\n                killDeferred.resolve(undefined);\n        });\n        cp.on('error', () => {\n            if (!allowAudioTranscoderExit)\n                killDeferred.resolve(undefined);\n        });\n        if (pipeSdp) {\n            const pipe = cp.stdio[3] as Writable;\n            pipe.write(pipeSdp);\n            pipe.end();\n        }\n        ffmpegLogInitialOutput(console, cp);\n\n        if (useRtp) {\n            cp.stdio[4].on('data', data => {\n                const transcodeSdp = data.toString();\n                reportTranscodedSections(transcodeSdp);\n            });\n        }\n    }\n    else {\n        // console.log('bypassing ffmpeg, perfect codecs');\n        sdpDeferred.resolve(rtspSdp);\n    }\n\n    if (!rtspClientHooked && rtspClient) {\n        process.nextTick(async () => {\n            try {\n                await rtspClient.readLoop();\n            }\n            catch (e) {\n            }\n            killDeferred.resolve(undefined);\n        });\n    }\n\n    const resolvedSdp = new Deferred<string>();\n    resolvedSdp.promise.catch(() => { });\n    (async () => {\n        try {\n            const videoSection = await videoSectionDeferred.promise;\n            const audioSection = await audioSectionDeferred.promise;\n            let sdp = `v=0\no=- 0 0 IN IP4 127.0.0.1\ns=Media Server\nc=IN IP4 127.0.0.1\nt=0 0`;\n            const parsed = parseSdp(sdp);\n            if (videoSection)\n                parsed.msections.push(videoSection);\n            if (audioSection)\n                parsed.msections.push(audioSection);\n            sdp = parsed.toSdp();\n            resolvedSdp.resolve(sdp);\n        }\n        catch (e) {\n            resolvedSdp.reject(e);\n        }\n    })();\n\n    return {\n        cp,\n        rtspServer: rtspServerDeferred.promise,\n        sdpContents: resolvedSdp.promise,\n        videoSection: videoSectionDeferred.promise,\n        audioSection: audioSectionDeferred.promise,\n        kill: () => killDeferred.resolve(undefined),\n        killPromise: killDeferred.promise,\n        get killed() {\n            return killDeferred.finished;\n        },\n    }\n}\n","import { type Red, RtpHeader, RtpPacket, uint16Add, uint32Add } from \"../..\";\n\n// 0                   1                    2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3  4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |F|   block PT  |  timestamp offset         |   block length    |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n// 0 1 2 3 4 5 6 7\n// +-+-+-+-+-+-+-+-+\n// |0|   Block PT  |\n// +-+-+-+-+-+-+-+-+\n\nexport class RedHandler {\n  private readonly size = 150;\n  private sequenceNumbers: number[] = [];\n\n  push(red: Red, base: RtpPacket) {\n    const packets: RtpPacket[] = [];\n\n    red.blocks.forEach(({ blockPT, timestampOffset, block }, i) => {\n      const sequenceNumber = uint16Add(\n        base.header.sequenceNumber,\n        -(red.blocks.length - (i + 1)),\n      );\n      if (timestampOffset) {\n        packets.push(\n          new RtpPacket(\n            new RtpHeader({\n              timestamp: uint32Add(base.header.timestamp, -timestampOffset),\n              payloadType: blockPT,\n              ssrc: base.header.ssrc,\n              sequenceNumber,\n              marker: true,\n            }),\n            block,\n          ),\n        );\n      } else {\n        packets.push(\n          new RtpPacket(\n            new RtpHeader({\n              timestamp: base.header.timestamp,\n              payloadType: blockPT,\n              ssrc: base.header.ssrc,\n              sequenceNumber,\n              marker: true,\n            }),\n            block,\n          ),\n        );\n      }\n    });\n\n    const filtered = packets.filter((p) => {\n      // duplicate\n      if (this.sequenceNumbers.includes(p.header.sequenceNumber)) {\n        return false;\n      } else {\n        // buffer overflow\n        if (this.sequenceNumbers.length > this.size) {\n          this.sequenceNumbers.shift();\n        }\n        this.sequenceNumbers.push(p.header.sequenceNumber);\n        return true;\n      }\n    });\n    return filtered;\n  }\n}\n","import { createHash } from \"crypto\";\nimport { jspack } from \"@shinyoshiaki/jspack\";\n\nimport { setTimeout } from \"timers/promises\";\n\nimport type { Candidate } from \"../candidate\";\nimport { TransactionFailed } from \"../exceptions\";\nimport { type Cancelable, cancelable, randomTransactionId } from \"../helper\";\nimport {\n  type Address,\n  Event,\n  EventDisposer,\n  type InterfaceAddresses,\n  TcpTransport,\n  type Transport,\n  UdpTransport,\n  bufferReader,\n  debug,\n  int,\n} from \"../imports/common\";\nimport { classes, methods } from \"../stun/const\";\nimport { Message, paddingLength, parseMessage } from \"../stun/message\";\nimport { Transaction } from \"../stun/transaction\";\n\nimport type { Protocol } from \"../types/model\";\n\nconst log = debug(\"werift-ice:packages/ice/src/turn/protocol.ts\");\n\nconst DEFAULT_CHANNEL_REFRESH_TIME = 500;\nconst DEFAULT_ALLOCATION_LIFETIME = 600;\nconst UDP_TRANSPORT = 0x11000000;\n\nexport class StunOverTurnProtocol implements Protocol {\n  static type = \"turn\";\n  readonly type = StunOverTurnProtocol.type;\n  localCandidate!: Candidate;\n  private disposer = new EventDisposer();\n  onRequestReceived: Event<[Message, Address, Buffer]> = new Event();\n  onDataReceived: Event<[Buffer]> = new Event();\n\n  constructor(public turn: TurnProtocol) {\n    turn.onData\n      .subscribe((data, addr) => {\n        this.handleStunMessage(data, addr);\n      })\n      .disposer(this.disposer);\n  }\n\n  private handleStunMessage = (data: Buffer, addr: Address) => {\n    try {\n      const message = parseMessage(data);\n      if (!message) {\n        this.onDataReceived.execute(data);\n        return;\n      }\n\n      if (\n        message.messageClass === classes.RESPONSE ||\n        message.messageClass === classes.ERROR\n      ) {\n        const transaction = this.turn.transactions[message.transactionIdHex];\n        if (transaction) {\n          transaction.responseReceived(message, addr);\n        }\n      } else if (message.messageClass === classes.REQUEST) {\n        this.onRequestReceived.execute(message, addr, data);\n      }\n    } catch (error) {\n      log(\"datagramReceived error\", error);\n    }\n  };\n\n  async request(request: Message, addr: Address, integrityKey?: Buffer) {\n    if (this.turn.transactions[request.transactionIdHex]) {\n      throw new Error(\"exist\");\n    }\n\n    if (integrityKey) {\n      request.addMessageIntegrity(integrityKey);\n      request.addFingerprint();\n    }\n\n    const transaction = new Transaction(request, addr, this);\n    this.turn.transactions[request.transactionIdHex] = transaction;\n\n    try {\n      return await transaction.run();\n    } catch (e) {\n      throw e;\n    } finally {\n      delete this.turn.transactions[request.transactionIdHex];\n    }\n  }\n  async connectionMade() {}\n  async sendData(data: Buffer, addr: Address) {\n    await this.turn.sendData(data, addr);\n  }\n  async sendStun(message: Message, addr: Address) {\n    await this.turn.sendData(message.bytes, addr);\n  }\n  async close() {\n    this.disposer.dispose();\n    return this.turn.close();\n  }\n}\n\nexport class TurnProtocol implements Protocol {\n  static type = \"turn\";\n  readonly type = TurnProtocol.type;\n  readonly onData = new Event<[Buffer, Address]>();\n  onRequestReceived: Event<[Message, Address, Buffer]> = new Event();\n  onDataReceived: Event<[Buffer]> = new Event();\n  integrityKey?: Buffer;\n  nonce?: Buffer;\n  realm?: string;\n  relayedAddress!: Address;\n  mappedAddress!: Address;\n  localCandidate!: Candidate;\n  transactions: { [hexId: string]: Transaction } = {};\n  private refreshHandle?: Cancelable<void>;\n  private channelNumber = 0x4000;\n  private channelByAddr: {\n    [addr: string]: { number: number; address: Address };\n  } = {};\n  private addrByChannel: { [channel: number]: Address } = {};\n  /**sec */\n  private channelRefreshTime: number;\n  private channelBinding?: Promise<void>;\n  private channelRefreshAt = 0;\n  private tcpBuffer: Buffer = Buffer.alloc(0);\n  private permissionByAddr: { [addr: string]: boolean } = {};\n  private creatingPermission: Promise<void> = Promise.resolve();\n\n  constructor(\n    public server: Address,\n    public username: string,\n    public password: string,\n    public lifetime: number,\n    public transport: Transport,\n    public options: {\n      /**sec */\n      channelRefreshTime?: number;\n    } = {},\n  ) {\n    this.channelRefreshTime =\n      this.options.channelRefreshTime ?? DEFAULT_CHANNEL_REFRESH_TIME;\n  }\n\n  async connectionMade() {\n    this.transport.onData = (data, addr) => {\n      this.dataReceived(data, addr);\n    };\n\n    const request = new Message(methods.ALLOCATE, classes.REQUEST);\n    request\n      .setAttribute(\"LIFETIME\", this.lifetime)\n      .setAttribute(\"REQUESTED-TRANSPORT\", UDP_TRANSPORT);\n\n    const [response] = await this.requestWithRetry(request, this.server).catch(\n      (e) => {\n        log(\"connect error\", e);\n        throw e;\n      },\n    );\n    this.relayedAddress = response.getAttributeValue(\"XOR-RELAYED-ADDRESS\");\n    this.mappedAddress = response.getAttributeValue(\"XOR-MAPPED-ADDRESS\");\n    const exp = response.getAttributeValue(\"LIFETIME\");\n    log(\"connect\", this.relayedAddress, this.mappedAddress, { exp });\n\n    this.refresh(exp);\n  }\n\n  private handleChannelData(data: Buffer) {\n    const [channel, length] = jspack.Unpack(\"!HH\", data.slice(0, 4));\n    const addr = this.addrByChannel[channel];\n\n    if (addr) {\n      const payload = data.subarray(4, 4 + length);\n      this.onData.execute(payload, addr);\n    }\n  }\n\n  private handleSTUNMessage(data: Buffer, addr: Address) {\n    try {\n      const message = parseMessage(data);\n      if (!message) {\n        throw new Error(\"not stun message\");\n      }\n\n      if (\n        message.messageClass === classes.RESPONSE ||\n        message.messageClass === classes.ERROR\n      ) {\n        const transaction = this.transactions[message.transactionIdHex];\n        if (transaction) {\n          transaction.responseReceived(message, addr);\n        }\n      } else if (message.messageClass === classes.REQUEST) {\n        this.onData.execute(data, addr);\n      }\n\n      if (message.getAttributeValue(\"DATA\")) {\n        const buf: Buffer = message.getAttributeValue(\"DATA\");\n        this.onData.execute(buf, addr);\n      }\n    } catch (error) {\n      log(\"parse error\", data.toString());\n    }\n  }\n\n  private dataReceived(data: Buffer, addr: Address) {\n    const datagramReceived = (data: Buffer, addr: Address) => {\n      if (data.length >= 4 && isChannelData(data)) {\n        this.handleChannelData(data);\n      } else {\n        this.handleSTUNMessage(data, addr);\n      }\n    };\n\n    if (this.transport.type === \"tcp\") {\n      this.tcpBuffer = Buffer.concat([this.tcpBuffer, data]);\n      while (this.tcpBuffer.length >= 4) {\n        let [, length] = bufferReader(this.tcpBuffer.subarray(0, 4), [2, 2]);\n        length += paddingLength(length);\n        const fullLength = isChannelData(this.tcpBuffer)\n          ? 4 + length\n          : 20 + length;\n        if (this.tcpBuffer.length < fullLength) {\n          break;\n        }\n\n        datagramReceived(this.tcpBuffer.subarray(0, fullLength), addr);\n        this.tcpBuffer = this.tcpBuffer.subarray(fullLength);\n      }\n    } else {\n      datagramReceived(data, addr);\n    }\n  }\n\n  private async send(data: Buffer, addr: Address) {\n    if (this.transport.closed) {\n      return;\n    }\n\n    if (this.transport.type === \"tcp\") {\n      const padding = paddingLength(data.length);\n      await this.transport.send(\n        padding > 0 ? Buffer.concat([data, Buffer.alloc(padding)]) : data,\n        addr,\n      );\n    } else {\n      await this.transport.send(data, addr);\n    }\n  }\n\n  private async createPermission(peerAddress: Address) {\n    const request = new Message(methods.CREATE_PERMISSION, classes.REQUEST);\n    request\n      .setAttribute(\"XOR-PEER-ADDRESS\", peerAddress)\n      .setAttribute(\"USERNAME\", this.username)\n      .setAttribute(\"REALM\", this.realm)\n      .setAttribute(\"NONCE\", this.nonce);\n    await this.request(request, this.server).catch((e) => {\n      request;\n      throw e;\n    });\n  }\n\n  private refresh = (exp: number) => {\n    this.refreshHandle = cancelable<void>(async (_, __, onCancel) => {\n      let run = true;\n      onCancel.once(() => {\n        run = false;\n      });\n\n      while (run) {\n        // refresh before expire\n        const delay = (5 / 6) * exp * 1000;\n        log(\"refresh delay\", delay, { exp });\n        await setTimeout(delay);\n\n        const request = new Message(methods.REFRESH, classes.REQUEST);\n        request.setAttribute(\"LIFETIME\", exp);\n\n        try {\n          const [message] = await this.requestWithRetry(request, this.server);\n          exp = message.getAttributeValue(\"LIFETIME\");\n          log(\"refresh\", { exp });\n        } catch (error) {\n          log(\"refresh error\", error);\n        }\n      }\n    });\n  };\n\n  async request(request: Message, addr: Address): Promise<[Message, Address]> {\n    if (this.transactions[request.transactionIdHex]) {\n      throw new Error(\"exist\");\n    }\n    if (this.integrityKey) {\n      request\n        .setAttribute(\"USERNAME\", this.username)\n        .setAttribute(\"REALM\", this.realm)\n        .setAttribute(\"NONCE\", this.nonce)\n        .addMessageIntegrity(this.integrityKey)\n        .addFingerprint();\n    }\n\n    const transaction = new Transaction(request, addr, this);\n    this.transactions[request.transactionIdHex] = transaction;\n\n    try {\n      return await transaction.run();\n    } catch (e) {\n      throw e;\n    } finally {\n      delete this.transactions[request.transactionIdHex];\n    }\n  }\n\n  async requestWithRetry(\n    request: Message,\n    addr: Address,\n  ): Promise<[Message, Address]> {\n    let message: Message, address: Address;\n    try {\n      [message, address] = await this.request(request, addr);\n    } catch (error) {\n      if (error instanceof TransactionFailed == false) {\n        log(\"requestWithRetry error\", error);\n        throw error;\n      }\n\n      // resolve dns address\n      this.server = error.addr;\n\n      const [errorCode] = error.response.getAttributeValue(\"ERROR-CODE\");\n      const nonce = error.response.getAttributeValue(\"NONCE\");\n      const realm = error.response.getAttributeValue(\"REALM\");\n\n      if (\n        ((errorCode === 401 && realm) || (errorCode === 438 && this.realm)) &&\n        nonce\n      ) {\n        log(\"retry with nonce\", errorCode);\n\n        this.nonce = nonce;\n        if (errorCode === 401) {\n          this.realm = realm;\n        }\n        this.integrityKey = makeIntegrityKey(\n          this.username,\n          this.realm!,\n          this.password,\n        );\n\n        request.transactionId = randomTransactionId();\n        [message, address] = await this.request(request, this.server);\n      } else {\n        throw error;\n      }\n    }\n    return [message!, address!];\n  }\n\n  async sendData(data: Buffer, addr: Address) {\n    const channel = await this.getChannel(addr).catch((e) => {\n      return new Error(\"channelBind error\");\n    });\n\n    if (channel instanceof Error) {\n      await this.getPermission(addr);\n      const indicate = new Message(methods.SEND, classes.INDICATION)\n        .setAttribute(\"DATA\", data)\n        .setAttribute(\"XOR-PEER-ADDRESS\", addr);\n\n      await this.sendStun(indicate, this.server);\n      return;\n    }\n\n    const header = jspack.Pack(\"!HH\", [channel.number, data.length]);\n    await this.send(Buffer.concat([Buffer.from(header), data]), this.server);\n  }\n\n  async getPermission(addr: Address) {\n    await this.creatingPermission;\n\n    const permitted = this.permissionByAddr[addr.join(\":\")];\n    if (!permitted) {\n      this.creatingPermission = this.createPermission(addr);\n      this.permissionByAddr[addr.join(\":\")] = true;\n      await this.creatingPermission.catch((e) => {\n        log(\"createPermission error\", e);\n        throw e;\n      });\n    }\n  }\n\n  async getChannel(addr: Address) {\n    if (this.channelBinding) {\n      await this.channelBinding;\n    }\n\n    let channel = this.channelByAddr[addr.join(\":\")];\n\n    if (!channel) {\n      this.channelByAddr[addr.join(\":\")] = {\n        number: this.channelNumber++,\n        address: addr,\n      };\n      channel = this.channelByAddr[addr.join(\":\")];\n      this.addrByChannel[channel.number] = addr;\n\n      this.channelBinding = this.channelBind(channel.number, addr);\n      await this.channelBinding.catch((e) => {\n        log(\"channelBind error\", e);\n        throw e;\n      });\n      this.channelRefreshAt = int(Date.now() / 1000) + this.channelRefreshTime;\n      this.channelBinding = undefined;\n      log(\"channelBind\", channel);\n    } else if (this.channelRefreshAt < int(Date.now() / 1000)) {\n      this.channelBinding = this.channelBind(channel.number, addr);\n      this.channelRefreshAt = int(Date.now() / 1000) + this.channelRefreshTime;\n      await this.channelBinding.catch((e) => {\n        log(\"channelBind error\", e);\n        throw e;\n      });\n      this.channelBinding = undefined;\n      log(\"channelBind refresh\", channel);\n    }\n    return channel;\n  }\n\n  private async channelBind(channelNumber: number, addr: Address) {\n    const request = new Message(methods.CHANNEL_BIND, classes.REQUEST);\n    request\n      .setAttribute(\"CHANNEL-NUMBER\", channelNumber)\n      .setAttribute(\"XOR-PEER-ADDRESS\", addr);\n    const [response] = await this.requestWithRetry(request, this.server);\n    if (response.messageMethod !== methods.CHANNEL_BIND) {\n      throw new Error(\"should be CHANNEL_BIND\");\n    }\n  }\n\n  async sendStun(message: Message, addr: Address) {\n    await this.send(message.bytes, addr);\n  }\n\n  async close() {\n    this.refreshHandle?.resolve?.();\n    await this.transport.close();\n  }\n}\n\nexport interface TurnClientConfig {\n  address: Address;\n  username: string;\n  password: string;\n}\nexport interface TurnClientOptions {\n  lifetime?: number;\n  ssl?: boolean;\n  transport?: \"udp\" | \"tcp\";\n  portRange?: [number, number];\n  interfaceAddresses?: InterfaceAddresses;\n}\n\nexport async function createTurnClient(\n  { address, username, password }: TurnClientConfig,\n  {\n    lifetime,\n    portRange,\n    interfaceAddresses,\n    transport: transportType,\n  }: TurnClientOptions = {},\n) {\n  lifetime ??= DEFAULT_ALLOCATION_LIFETIME;\n  transportType ??= \"udp\";\n\n  const transport =\n    transportType === \"udp\"\n      ? await UdpTransport.init(\"udp4\", { portRange, interfaceAddresses })\n      : await TcpTransport.init(address);\n\n  const turn = new TurnProtocol(\n    address,\n    username,\n    password,\n    lifetime,\n    transport,\n  );\n\n  await turn.connectionMade();\n  return turn;\n}\n\nexport async function createStunOverTurnClient(\n  {\n    address,\n    username,\n    password,\n  }: {\n    address: Address;\n    username: string;\n    password: string;\n  },\n  {\n    lifetime,\n    portRange,\n    interfaceAddresses,\n    transport: transportType,\n  }: {\n    lifetime?: number;\n    ssl?: boolean;\n    transport?: \"udp\" | \"tcp\";\n    portRange?: [number, number];\n    interfaceAddresses?: InterfaceAddresses;\n  } = {},\n) {\n  const turn = await createTurnClient(\n    {\n      address,\n      username,\n      password,\n    },\n    {\n      lifetime,\n      portRange,\n      interfaceAddresses,\n      transport: transportType,\n    },\n  );\n  const turnTransport = new StunOverTurnProtocol(turn);\n  return turnTransport;\n}\n\nexport function makeIntegrityKey(\n  username: string,\n  realm: string,\n  password: string,\n) {\n  return createHash(\"md5\")\n    .update(Buffer.from([username, realm, password].join(\":\")))\n    .digest();\n}\n\nfunction isChannelData(data: Buffer) {\n  return (data[0] & 0xc0) == 0x40;\n}\n","import { decode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type { CurveTypes, NamedCurveAlgorithms } from \"../../../cipher/const\";\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type { Handshake } from \"../../../typings/domain\";\nimport { encodeBuffer } from \"../../../util/binary\";\nimport { HandshakeType } from \"../../const\";\n\nexport class ServerKeyExchange implements Handshake {\n  msgType = HandshakeType.server_key_exchange_12;\n  messageSeq?: number;\n\n  static readonly spec = {\n    ellipticCurveType: types.uint8,\n    namedCurve: types.uint16be,\n    publicKeyLength: types.uint8,\n    publicKey: types.buffer((ctx: any) => ctx.current.publicKeyLength),\n    hashAlgorithm: types.uint8,\n    signatureAlgorithm: types.uint8,\n    signatureLength: types.uint16be,\n    signature: types.buffer((ctx: any) => ctx.current.signatureLength),\n  };\n\n  constructor(\n    public ellipticCurveType: CurveTypes,\n    public namedCurve: NamedCurveAlgorithms,\n    public publicKeyLength: number,\n    public publicKey: Buffer,\n    public hashAlgorithm: number,\n    public signatureAlgorithm: number,\n    public signatureLength: number,\n    public signature: Buffer,\n  ) {}\n\n  static createEmpty() {\n    return new ServerKeyExchange(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    const res = decode(buf, ServerKeyExchange.spec);\n    return new ServerKeyExchange(\n      //@ts-ignore\n      ...Object.values(res),\n    );\n  }\n\n  serialize() {\n    const res = encodeBuffer(this, ServerKeyExchange.spec);\n    return res;\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","import { decode, types } from \"@shinyoshiaki/binary-data\";\n\nimport { setTimeout } from \"timers/promises\";\nimport { Event, type Transport, debug } from \"./imports/common\";\n\nimport {\n  NamedCurveAlgorithmList,\n  type SignatureHash,\n  signatures,\n} from \"./cipher/const\";\nimport { exportKeyingMaterial } from \"./cipher/prf\";\nimport { SessionType, type SessionTypes } from \"./cipher/suites/abstract\";\nimport { CipherContext } from \"./context/cipher\";\nimport { DtlsContext } from \"./context/dtls\";\nimport { SrtpContext } from \"./context/srtp\";\nimport { TransportContext } from \"./context/transport\";\nimport { EllipticCurves } from \"./handshake/extensions/ellipticCurves\";\nimport { ExtendedMasterSecret } from \"./handshake/extensions/extendedMasterSecret\";\nimport { RenegotiationIndication } from \"./handshake/extensions/renegotiationIndication\";\nimport { Signature } from \"./handshake/extensions/signature\";\nimport { UseSRTP } from \"./handshake/extensions/useSrtp\";\nimport type { SrtpProfile } from \"./imports/rtp\";\nimport { createPlaintext } from \"./record/builder\";\nimport { ContentType } from \"./record/const\";\nimport { FragmentedHandshake } from \"./record/message/fragment\";\nimport { parsePacket, parsePlainText } from \"./record/receive\";\nimport type { Extension } from \"./typings/domain\";\n\nconst log = debug(\"werift-dtls : packages/dtls/src/socket.ts : log\");\nconst err = debug(\"werift-dtls : packages/dtls/src/socket.ts : err\");\n\nexport class DtlsSocket {\n  readonly onConnect = new Event();\n  readonly onData = new Event<[Buffer]>();\n  readonly onError = new Event<[Error]>();\n  readonly onClose = new Event();\n  readonly transport: TransportContext;\n  cipher: CipherContext;\n  dtls: DtlsContext;\n  srtp: SrtpContext = new SrtpContext();\n\n  connected = false;\n  extensions: Extension[] = [];\n  onHandleHandshakes!: (assembled: FragmentedHandshake[]) => Promise<void>;\n\n  private bufferFragmentedHandshakes: FragmentedHandshake[] = [];\n\n  constructor(\n    public options: Options,\n    public sessionType: SessionTypes,\n  ) {\n    this.dtls = new DtlsContext(this.options, this.sessionType);\n    this.cipher = new CipherContext(\n      this.sessionType,\n      this.options.cert,\n      this.options.key,\n      this.options.signatureHash,\n    );\n    this.transport = new TransportContext(this.options.transport);\n    this.setupExtensions();\n    this.transport.socket.onData = this.udpOnMessage;\n  }\n\n  renegotiation() {\n    log(\"renegotiation\", this.sessionType);\n    this.connected = false;\n    this.cipher = new CipherContext(\n      this.sessionType,\n      this.options.cert,\n      this.options.key,\n      this.options.signatureHash,\n    );\n    this.dtls = new DtlsContext(this.options, this.sessionType);\n    this.srtp = new SrtpContext();\n    this.extensions = [];\n    this.bufferFragmentedHandshakes = [];\n  }\n\n  private udpOnMessage = (data: Buffer) => {\n    const packets = parsePacket(data);\n\n    for (const packet of packets) {\n      try {\n        const messages = parsePlainText(this.dtls, this.cipher)(packet);\n        for (const message of messages) {\n          switch (message.type) {\n            case ContentType.handshake:\n              {\n                const handshake = message.data as FragmentedHandshake;\n                const handshakes = this.handleFragmentHandshake([handshake]);\n                const assembled = Object.values(\n                  handshakes.reduce(\n                    (acc: { [type: string]: FragmentedHandshake[] }, cur) => {\n                      if (!acc[cur.msg_type]) acc[cur.msg_type] = [];\n                      acc[cur.msg_type].push(cur);\n                      return acc;\n                    },\n                    {},\n                  ),\n                )\n                  .map((v) => FragmentedHandshake.assemble(v))\n                  .sort((a, b) => a.msg_type - b.msg_type);\n\n                this.onHandleHandshakes(assembled).catch((error) => {\n                  err(this.dtls.sessionId, \"onHandleHandshakes error\", error);\n                  this.onError.execute(error);\n                });\n              }\n              break;\n            case ContentType.applicationData:\n              {\n                this.onData.execute(message.data as Buffer);\n              }\n              break;\n            case ContentType.alert:\n              this.onClose.execute();\n              break;\n          }\n        }\n      } catch (error) {\n        err(this.dtls.sessionId, \"catch udpOnMessage error\", error);\n      }\n    }\n  };\n\n  private setupExtensions() {\n    log(this.dtls.sessionId, \"support srtpProfiles\", this.options.srtpProfiles);\n    if (this.options.srtpProfiles && this.options.srtpProfiles.length > 0) {\n      const useSrtp = UseSRTP.create(\n        this.options.srtpProfiles,\n        Buffer.from([0x00]),\n      );\n      this.extensions.push(useSrtp.extension);\n    }\n\n    {\n      const curve = EllipticCurves.createEmpty();\n      curve.data = NamedCurveAlgorithmList;\n      this.extensions.push(curve.extension);\n    }\n\n    {\n      const signature = Signature.createEmpty();\n      // libwebrtc/OpenSSL require 4=1 , 4=3 signatureHash\n      signature.data = signatures;\n      this.extensions.push(signature.extension);\n    }\n    if (this.options.extendedMasterSecret) {\n      this.extensions.push({\n        type: ExtendedMasterSecret.type,\n        data: Buffer.alloc(0),\n      });\n    }\n\n    {\n      const renegotiationIndication = RenegotiationIndication.createEmpty();\n      this.extensions.push(renegotiationIndication.extension);\n    }\n  }\n\n  protected waitForReady = (condition: () => boolean) =>\n    new Promise<void>(async (r, f) => {\n      for (let i = 0; i < 10; i++) {\n        if (condition()) {\n          r();\n          break;\n        } else {\n          await setTimeout(100 * i);\n        }\n      }\n      f(\"waitForReady timeout\");\n    });\n\n  handleFragmentHandshake(messages: FragmentedHandshake[]) {\n    let handshakes = messages.filter((v) => {\n      // find fragmented\n      if (v.fragment_length !== v.length) {\n        this.bufferFragmentedHandshakes.push(v);\n        return false;\n      }\n      return true;\n    });\n\n    if (this.bufferFragmentedHandshakes.length > 1) {\n      const [last] = this.bufferFragmentedHandshakes.slice(-1);\n      if (last.fragment_offset + last.fragment_length === last.length) {\n        handshakes = [...this.bufferFragmentedHandshakes, ...handshakes];\n        this.bufferFragmentedHandshakes = [];\n      }\n    }\n    return handshakes; // return un fragmented handshakes\n  }\n\n  /**send application data */\n  send = async (buf: Buffer) => {\n    const pkt = createPlaintext(this.dtls)(\n      [{ type: ContentType.applicationData, fragment: buf }],\n      ++this.dtls.recordSequenceNumber,\n    )[0];\n    await this.transport.send(this.cipher.encryptPacket(pkt).serialize());\n  };\n\n  close() {\n    this.transport.socket.close();\n  }\n\n  extractSessionKeys(keyLength: number, saltLength: number) {\n    const keyingMaterial = this.exportKeyingMaterial(\n      \"EXTRACTOR-dtls_srtp\",\n      keyLength * 2 + saltLength * 2,\n    );\n\n    const { clientKey, serverKey, clientSalt, serverSalt } = decode(\n      keyingMaterial,\n      {\n        clientKey: types.buffer(keyLength),\n        serverKey: types.buffer(keyLength),\n        clientSalt: types.buffer(saltLength),\n        serverSalt: types.buffer(saltLength),\n      },\n    );\n\n    if (this.sessionType === SessionType.CLIENT) {\n      return {\n        localKey: clientKey,\n        localSalt: clientSalt,\n        remoteKey: serverKey,\n        remoteSalt: serverSalt,\n      };\n    } else {\n      return {\n        localKey: serverKey,\n        localSalt: serverSalt,\n        remoteKey: clientKey,\n        remoteSalt: clientSalt,\n      };\n    }\n  }\n\n  exportKeyingMaterial(label: string, length: number) {\n    return exportKeyingMaterial(\n      label,\n      length,\n      this.cipher.masterSecret,\n      this.cipher.localRandom.serialize(),\n      this.cipher.remoteRandom.serialize(),\n      this.sessionType === SessionType.CLIENT,\n    );\n  }\n}\n\nexport interface Options {\n  transport: Transport;\n  srtpProfiles?: SrtpProfile[];\n  cert?: string;\n  key?: string;\n  signatureHash?: SignatureHash;\n  certificateRequest?: boolean;\n  extendedMasterSecret?: boolean;\n}\n","'use strict';\n\nconst { decodeCommon } = require('lib/decode');\nconst { encodeCommon } = require('lib/encode');\nconst { encodingLengthCommon } = require('lib/encoding-length');\nconst { isType, isFunction } = require('lib/util');\nconst symbols = require('internal/symbols');\nconst Metadata = require('internal/meta');\n\nmodule.exports = reserved;\n\n/**\n * Type for reserved data.\n * @param {Object} type Any builtin type or schema.\n * @param {number} size The number of reserved items.\n * @returns {Object}\n */\nfunction reserved(type, size = 1) {\n  if (!isType(type)) {\n    throw new TypeError('Invalid data type.');\n  }\n\n  if (!Number.isInteger(size) && !isFunction(size)) {\n    throw new TypeError('Argument #2 should be a valid integer or function.');\n  }\n\n  return {\n    [symbols.skip]: true,\n    encodingLength,\n    decode,\n    encode,\n  };\n\n  /**\n   * Get the number of bytes to encode value.\n   * @param {any} value\n   * @returns {number}\n   */\n  function encodingLength(value) {\n    // eslint-disable-next-line no-invalid-this\n    const context = Metadata.clone(this);\n\n    const count = isFunction(size) ? size(context) : size;\n\n    encodingLengthCommon(value, type, context);\n    Metadata.clean(context);\n\n    return context.bytes * count;\n  }\n\n  /**\n   * Silently decode items.\n   * @param {DecodeStream} rstream\n   */\n  function decode(rstream) {\n    // eslint-disable-next-line no-invalid-this\n    const context = Metadata.clone(this);\n    decode.bytes = 0;\n\n    const count = isFunction(size) ? size(context) : size;\n\n    if (count === 0) {\n      Metadata.clean(context);\n      return;\n    }\n\n    for (let i = count; i > 0; i -= 1) {\n      decodeCommon(rstream, type, context);\n    }\n\n    decode.bytes = context.bytes;\n    Metadata.clean(context);\n  }\n\n  /**\n   * Encode reserved data.\n   * Fill with zeros the number of required bytes.\n   * @param {any} value\n   * @param {EncodeStream} wstream\n   */\n  function encode(value, wstream) {\n    encode.bytes = 0;\n\n    // eslint-disable-next-line no-invalid-this\n    const context = Metadata.clone(this);\n\n    const count = isFunction(size) ? size(context) : size;\n\n    if (count === 0) {\n      Metadata.clean(context);\n      return;\n    }\n\n    for (let i = count; i > 0; i -= 1) {\n      encodeCommon(0, wstream, type, context);\n    }\n\n    encode.bytes = context.bytes;\n    Metadata.clean(context);\n  }\n}\n","import nacl from \"tweetnacl\";\n\nimport { NamedCurveAlgorithm, type NamedCurveAlgorithms } from \"./const\";\nimport { p256Keypair } from \"./ec\";\n\nexport interface NamedCurveKeyPair {\n  curve: NamedCurveAlgorithms;\n  publicKey: Buffer;\n  privateKey: Buffer;\n}\n\nexport function generateKeyPair(\n  namedCurve: NamedCurveAlgorithms,\n): NamedCurveKeyPair {\n  switch (namedCurve) {\n    case NamedCurveAlgorithm.secp256r1_23: {\n      const { privateKey, publicKey } = p256Keypair();\n\n      return {\n        curve: namedCurve,\n        privateKey,\n        publicKey,\n      };\n    }\n    case NamedCurveAlgorithm.x25519_29: {\n      const keys = nacl.box.keyPair();\n\n      return {\n        curve: namedCurve,\n        privateKey: Buffer.from(keys.secretKey.buffer),\n        publicKey: Buffer.from(keys.publicKey.buffer),\n      };\n    }\n    default:\n      throw new Error();\n  }\n}\n","import Debug from \"debug\";\n\nexport class WeriftError extends Error {\n  message!: string;\n  payload?: object;\n  path?: string;\n\n  constructor(props: Pick<WeriftError, \"message\" | \"payload\" | \"path\">) {\n    super(props.message);\n  }\n\n  toJSON() {\n    return {\n      message: this.message,\n      payload: JSON.parse(JSON.stringify(this.payload)),\n      path: this.path,\n    };\n  }\n}\n\nexport const debug = Debug.debug;\n","import { FragmentedHandshake } from \"../../record/message/fragment\";\nimport type { Handshake } from \"../../typings/domain\";\nimport { HandshakeType } from \"../const\";\n\n// 7.4.9.  Finished\n\nexport class Finished implements Handshake {\n  msgType = HandshakeType.finished_20;\n  messageSeq?: number;\n\n  constructor(public verifyData: Buffer) {}\n\n  static createEmpty() {\n    return new Finished(undefined as any);\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new Finished(buf);\n  }\n\n  serialize() {\n    return this.verifyData;\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","import os from \"os\";\nimport nodeIp from \"ip\";\nimport {\n  type Address,\n  type InterfaceAddresses,\n  debug,\n  normalizeFamilyNodeV18,\n} from \"./imports/common\";\nimport { classes, methods } from \"./stun/const\";\nimport { Message } from \"./stun/message\";\nimport { StunProtocol } from \"./stun/protocol\";\n\nconst logger = debug(\"werift-ice : packages/ice/src/utils.ts\");\n\nexport async function getGlobalIp(\n  stunServer?: Address,\n  interfaceAddresses?: InterfaceAddresses,\n) {\n  const protocol = new StunProtocol();\n  await protocol.connectionMade(true, undefined, interfaceAddresses);\n  const request = new Message(methods.BINDING, classes.REQUEST);\n  const [response] = await protocol.request(\n    request,\n    stunServer ?? [\"stun.l.google.com\", 19302],\n  );\n  await protocol.close();\n\n  const address = response.getAttributeValue(\"XOR-MAPPED-ADDRESS\");\n  return address[0] as string;\n}\n\nexport function isLinkLocalAddress(info: os.NetworkInterfaceInfo) {\n  return (\n    (normalizeFamilyNodeV18(info.family) === 4 &&\n      info.address?.startsWith(\"169.254.\")) ||\n    (normalizeFamilyNodeV18(info.family) === 6 &&\n      info.address?.startsWith(\"fe80::\"))\n  );\n}\n\nexport function nodeIpAddress(\n  family: number,\n  {\n    useLinkLocalAddress,\n  }: {\n    /** such as google cloud run */\n    useLinkLocalAddress?: boolean;\n  } = {},\n): string[] {\n  // https://chromium.googlesource.com/external/webrtc/+/master/rtc_base/network.cc#236\n  const costlyNetworks = [\"ipsec\", \"tun\", \"utun\", \"tap\"];\n  const banNetworks = [\"vmnet\", \"veth\"];\n\n  const interfaces = os.networkInterfaces();\n\n  logger(interfaces);\n\n  const all = Object.keys(interfaces)\n    .map((nic) => {\n      for (const word of [...costlyNetworks, ...banNetworks]) {\n        if (nic.startsWith(word)) {\n          return {\n            nic,\n            addresses: [],\n          };\n        }\n      }\n      const addresses = interfaces[nic]!.filter(\n        (details) =>\n          normalizeFamilyNodeV18(details.family) === family &&\n          !nodeIp.isLoopback(details.address) &&\n          (useLinkLocalAddress ? true : !isLinkLocalAddress(details)),\n      );\n      return {\n        nic,\n        addresses: addresses.map((address) => address.address),\n      };\n    })\n    .filter((address) => !!address);\n\n  // os.networkInterfaces doesn't actually return addresses in a good order.\n  // have seen instances where en0 (ethernet) is after en1 (wlan), etc.\n  // eth0 > eth1\n  all.sort((a, b) => a.nic.localeCompare(b.nic));\n  return Object.values(all).flatMap((entry) => entry.addresses);\n}\n\nexport function getHostAddresses(\n  useIpv4: boolean,\n  useIpv6: boolean,\n  options: {\n    /** such as google cloud run */\n    useLinkLocalAddress?: boolean;\n  } = {},\n) {\n  const address: string[] = [];\n  if (useIpv4) {\n    address.push(...nodeIpAddress(4, options));\n  }\n  if (useIpv6) {\n    address.push(...nodeIpAddress(6, options));\n  }\n  return address;\n}\n\nexport const url2Address = (url?: string) => {\n  if (!url) return;\n  const [address, port] = url.split(\":\");\n  return [address, Number.parseInt(port)] as Address;\n};\n","import { RTP_EXTENSION_URI } from \"../../imports/rtp\";\nimport { RTCRtpHeaderExtensionParameters } from \"../parameters\";\n\nexport function useSdesMid() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.sdesMid,\n  });\n}\n\nexport function useSdesRTPStreamId() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.sdesRTPStreamID,\n  });\n}\n\nexport function useRepairedRtpStreamId() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.repairedRtpStreamId,\n  });\n}\n\nexport function useTransportWideCC() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.transportWideCC,\n  });\n}\n\nexport function useAbsSendTime() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.absSendTime,\n  });\n}\n\nexport function useDependencyDescriptor() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.dependencyDescriptor,\n  });\n}\n\nexport function useAudioLevelIndication() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.audioLevelIndication,\n  });\n}\n\nexport function useVideoOrientation() {\n  return new RTCRtpHeaderExtensionParameters({\n    uri: RTP_EXTENSION_URI.videoOrientation,\n  });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.hmac = exports.HMAC = void 0;\n/**\n * HMAC: RFC2104 message authentication code.\n * @module\n */\nconst _assert_js_1 = require(\"./_assert.js\");\nconst utils_js_1 = require(\"./utils.js\");\nclass HMAC extends utils_js_1.Hash {\n    constructor(hash, _key) {\n        super();\n        this.finished = false;\n        this.destroyed = false;\n        (0, _assert_js_1.ahash)(hash);\n        const key = (0, utils_js_1.toBytes)(_key);\n        this.iHash = hash.create();\n        if (typeof this.iHash.update !== 'function')\n            throw new Error('Expected instance of class which extends utils.Hash');\n        this.blockLen = this.iHash.blockLen;\n        this.outputLen = this.iHash.outputLen;\n        const blockLen = this.blockLen;\n        const pad = new Uint8Array(blockLen);\n        // blockLen can be bigger than outputLen\n        pad.set(key.length > blockLen ? hash.create().update(key).digest() : key);\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36;\n        this.iHash.update(pad);\n        // By doing update (processing of first block) of outer hash here we can re-use it between multiple calls via clone\n        this.oHash = hash.create();\n        // Undo internal XOR && apply outer XOR\n        for (let i = 0; i < pad.length; i++)\n            pad[i] ^= 0x36 ^ 0x5c;\n        this.oHash.update(pad);\n        pad.fill(0);\n    }\n    update(buf) {\n        (0, _assert_js_1.aexists)(this);\n        this.iHash.update(buf);\n        return this;\n    }\n    digestInto(out) {\n        (0, _assert_js_1.aexists)(this);\n        (0, _assert_js_1.abytes)(out, this.outputLen);\n        this.finished = true;\n        this.iHash.digestInto(out);\n        this.oHash.update(out);\n        this.oHash.digestInto(out);\n        this.destroy();\n    }\n    digest() {\n        const out = new Uint8Array(this.oHash.outputLen);\n        this.digestInto(out);\n        return out;\n    }\n    _cloneInto(to) {\n        // Create new instance without calling constructor since key already in state and we don't know it.\n        to || (to = Object.create(Object.getPrototypeOf(this), {}));\n        const { oHash, iHash, finished, destroyed, blockLen, outputLen } = this;\n        to = to;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        to.blockLen = blockLen;\n        to.outputLen = outputLen;\n        to.oHash = oHash._cloneInto(to.oHash);\n        to.iHash = iHash._cloneInto(to.iHash);\n        return to;\n    }\n    destroy() {\n        this.destroyed = true;\n        this.oHash.destroy();\n        this.iHash.destroy();\n    }\n}\nexports.HMAC = HMAC;\n/**\n * HMAC: RFC2104 message authentication code.\n * @param hash - function that would be used e.g. sha256\n * @param key - message key\n * @param message - message data\n * @example\n * import { hmac } from '@noble/hashes/hmac';\n * import { sha256 } from '@noble/hashes/sha2';\n * const mac1 = hmac(sha256, 'key', 'message');\n */\nconst hmac = (hash, key, message) => new HMAC(hash, key).update(message).digest();\nexports.hmac = hmac;\nexports.hmac.create = (hash, key) => new HMAC(hash, key);\n//# sourceMappingURL=hmac.js.map","module.exports = require(\"os\");","'use strict';\n\nconst { Transform } = require('stream');\nconst createFunction = require('generate-function');\nconst BufferList = require('internal/buffer-list');\nconst NotEnoughDataError = require('lib/not-enough-data-error');\n\nconst kbuffer = Symbol('buffer');\n\n/**\n * Binary data queue.\n * Also represent a part of BufferList API.\n */\nclass BinaryStream extends Transform {\n  /**\n   * @class Binary\n   * @param {Object} options\n   */\n  constructor(options = {}) {\n    super(options);\n\n    this[kbuffer] = new BufferList();\n  }\n\n  /**\n   * @returns {BufferList}\n   */\n  get buffer() {\n    return this[kbuffer];\n  }\n\n  /**\n   * @returns {number}\n   */\n  get length() {\n    return this.buffer.length;\n  }\n\n  /**\n   * @param {Buffer} buf\n   */\n  append(buf) {\n    this.buffer.append(buf);\n  }\n\n  /**\n   * @param {number} i\n   * @returns {number}\n   */\n  get(i) {\n    return this.buffer.get(i);\n  }\n\n  /**\n   * @param {number} [start]\n   * @param {number} [end]\n   * @returns {Buffer}\n   */\n  slice(start, end) {\n    return this.buffer.slice(start, end);\n  }\n\n  /**\n   * @param {number} bytes\n   */\n  consume(bytes) {\n    this.buffer.consume(bytes);\n  }\n\n  /**\n   * @param {string} encoding\n   * @param {number} [start]\n   * @param {number} [end]\n   * @returns {string}\n   */\n  toString(encoding, start, end) {\n    return this.buffer.toString(encoding, start, end);\n  }\n\n  /**\n   * Returns the first (least) index of an element\n   * within the list equal to the specified value,\n   * or -1 if none is found.\n   * @param {number} byte\n   * @param {number} [offset]\n   * @returns {number}\n   */\n  indexOf(byte, offset = 0) {\n    return this.buffer.indexOf(byte, offset);\n  }\n\n  /**\n   * Read provided amount of bytes from stream.\n   * @param {number} size\n   * @returns {Buffer}\n   */\n  readBuffer(size) {\n    assertSize(size, this.length);\n\n    const buf = this.slice(0, size);\n    this.consume(size);\n\n    return buf;\n  }\n\n  /**\n   * Write provided chunk to the stream.\n   * @param {Buffer} chunk\n   */\n  writeBuffer(chunk) {\n    this.append(chunk);\n  }\n}\n\nconst fixedReadMethods = {\n  readDoubleBE: 8,\n  readDoubleLE: 8,\n  readFloatBE: 4,\n  readFloatLE: 4,\n  readInt32BE: 4,\n  readInt32LE: 4,\n  readUInt32BE: 4,\n  readUInt32LE: 4,\n  readInt16BE: 2,\n  readInt16LE: 2,\n  readUInt16BE: 2,\n  readUInt16LE: 2,\n  readInt8: 1,\n  readUInt8: 1,\n};\n\nconst metaReadMethods = ['readIntBE', 'readIntLE', 'readUIntBE', 'readUIntLE'];\n\nObject.keys(fixedReadMethods).forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function binary_${method}() {\n      const bytes = ${gen.formats.d(fixedReadMethods[method])};\n      assertSize(bytes, this.length);\n\n      const res = this.buffer.${method}(0);\n      this.consume(bytes);\n\n      return res;\n    }\n  `);\n\n  BinaryStream.prototype[method] = gen.toFunction({ assertSize });\n});\n\nmetaReadMethods.forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function binary_${method}(size) {\n      assertSize(size, this.length);\n\n      const res = this.buffer.${method}(size, 0);\n      this.consume(size);\n      return res;\n    }\n  `);\n\n  BinaryStream.prototype[method] = gen.toFunction({ assertSize });\n});\n\nconst fixedWriteMethods = [\n  'writeDoubleBE',\n  'writeDoubleLE',\n  'writeFloatBE',\n  'writeFloatLE',\n  'writeInt32BE',\n  'writeInt32LE',\n  'writeUInt32BE',\n  'writeUInt32LE',\n  'writeInt16BE',\n  'writeInt16LE',\n  'writeUInt16BE',\n  'writeUInt16LE',\n  'writeInt8',\n  'writeUInt8',\n];\n\nfixedWriteMethods.forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function binary_${method}(value) {\n      this.buffer.${method}(value);\n    }\n  `);\n\n  BinaryStream.prototype[method] = gen.toFunction();\n});\n\nconst metaWriteMethods = [\n  'writeIntBE',\n  'writeIntLE',\n  'writeUIntBE',\n  'writeUIntLE',\n];\n\nmetaWriteMethods.forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function binary_${method}(value, size) {\n      this.buffer.${method}(value, size);\n    }\n  `);\n\n  BinaryStream.prototype[method] = gen.toFunction();\n});\n\n/**\n * Check if stream is able to read requested amound of data.\n * @param {number} size Requested data size to read.\n * @param {number} length The number of bytes in stream.\n */\nfunction assertSize(size, length) {\n  if (size > length) {\n    throw new NotEnoughDataError(size, length);\n  }\n}\n\nmodule.exports = BinaryStream;\n","\"use strict\"\nfunction isProperty(str) {\n  return /^[$A-Z\\_a-z\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc][$A-Z\\_a-z\\xaa\\xb5\\xba\\xc0-\\xd6\\xd8-\\xf6\\xf8-\\u02c1\\u02c6-\\u02d1\\u02e0-\\u02e4\\u02ec\\u02ee\\u0370-\\u0374\\u0376\\u0377\\u037a-\\u037d\\u0386\\u0388-\\u038a\\u038c\\u038e-\\u03a1\\u03a3-\\u03f5\\u03f7-\\u0481\\u048a-\\u0527\\u0531-\\u0556\\u0559\\u0561-\\u0587\\u05d0-\\u05ea\\u05f0-\\u05f2\\u0620-\\u064a\\u066e\\u066f\\u0671-\\u06d3\\u06d5\\u06e5\\u06e6\\u06ee\\u06ef\\u06fa-\\u06fc\\u06ff\\u0710\\u0712-\\u072f\\u074d-\\u07a5\\u07b1\\u07ca-\\u07ea\\u07f4\\u07f5\\u07fa\\u0800-\\u0815\\u081a\\u0824\\u0828\\u0840-\\u0858\\u08a0\\u08a2-\\u08ac\\u0904-\\u0939\\u093d\\u0950\\u0958-\\u0961\\u0971-\\u0977\\u0979-\\u097f\\u0985-\\u098c\\u098f\\u0990\\u0993-\\u09a8\\u09aa-\\u09b0\\u09b2\\u09b6-\\u09b9\\u09bd\\u09ce\\u09dc\\u09dd\\u09df-\\u09e1\\u09f0\\u09f1\\u0a05-\\u0a0a\\u0a0f\\u0a10\\u0a13-\\u0a28\\u0a2a-\\u0a30\\u0a32\\u0a33\\u0a35\\u0a36\\u0a38\\u0a39\\u0a59-\\u0a5c\\u0a5e\\u0a72-\\u0a74\\u0a85-\\u0a8d\\u0a8f-\\u0a91\\u0a93-\\u0aa8\\u0aaa-\\u0ab0\\u0ab2\\u0ab3\\u0ab5-\\u0ab9\\u0abd\\u0ad0\\u0ae0\\u0ae1\\u0b05-\\u0b0c\\u0b0f\\u0b10\\u0b13-\\u0b28\\u0b2a-\\u0b30\\u0b32\\u0b33\\u0b35-\\u0b39\\u0b3d\\u0b5c\\u0b5d\\u0b5f-\\u0b61\\u0b71\\u0b83\\u0b85-\\u0b8a\\u0b8e-\\u0b90\\u0b92-\\u0b95\\u0b99\\u0b9a\\u0b9c\\u0b9e\\u0b9f\\u0ba3\\u0ba4\\u0ba8-\\u0baa\\u0bae-\\u0bb9\\u0bd0\\u0c05-\\u0c0c\\u0c0e-\\u0c10\\u0c12-\\u0c28\\u0c2a-\\u0c33\\u0c35-\\u0c39\\u0c3d\\u0c58\\u0c59\\u0c60\\u0c61\\u0c85-\\u0c8c\\u0c8e-\\u0c90\\u0c92-\\u0ca8\\u0caa-\\u0cb3\\u0cb5-\\u0cb9\\u0cbd\\u0cde\\u0ce0\\u0ce1\\u0cf1\\u0cf2\\u0d05-\\u0d0c\\u0d0e-\\u0d10\\u0d12-\\u0d3a\\u0d3d\\u0d4e\\u0d60\\u0d61\\u0d7a-\\u0d7f\\u0d85-\\u0d96\\u0d9a-\\u0db1\\u0db3-\\u0dbb\\u0dbd\\u0dc0-\\u0dc6\\u0e01-\\u0e30\\u0e32\\u0e33\\u0e40-\\u0e46\\u0e81\\u0e82\\u0e84\\u0e87\\u0e88\\u0e8a\\u0e8d\\u0e94-\\u0e97\\u0e99-\\u0e9f\\u0ea1-\\u0ea3\\u0ea5\\u0ea7\\u0eaa\\u0eab\\u0ead-\\u0eb0\\u0eb2\\u0eb3\\u0ebd\\u0ec0-\\u0ec4\\u0ec6\\u0edc-\\u0edf\\u0f00\\u0f40-\\u0f47\\u0f49-\\u0f6c\\u0f88-\\u0f8c\\u1000-\\u102a\\u103f\\u1050-\\u1055\\u105a-\\u105d\\u1061\\u1065\\u1066\\u106e-\\u1070\\u1075-\\u1081\\u108e\\u10a0-\\u10c5\\u10c7\\u10cd\\u10d0-\\u10fa\\u10fc-\\u1248\\u124a-\\u124d\\u1250-\\u1256\\u1258\\u125a-\\u125d\\u1260-\\u1288\\u128a-\\u128d\\u1290-\\u12b0\\u12b2-\\u12b5\\u12b8-\\u12be\\u12c0\\u12c2-\\u12c5\\u12c8-\\u12d6\\u12d8-\\u1310\\u1312-\\u1315\\u1318-\\u135a\\u1380-\\u138f\\u13a0-\\u13f4\\u1401-\\u166c\\u166f-\\u167f\\u1681-\\u169a\\u16a0-\\u16ea\\u16ee-\\u16f0\\u1700-\\u170c\\u170e-\\u1711\\u1720-\\u1731\\u1740-\\u1751\\u1760-\\u176c\\u176e-\\u1770\\u1780-\\u17b3\\u17d7\\u17dc\\u1820-\\u1877\\u1880-\\u18a8\\u18aa\\u18b0-\\u18f5\\u1900-\\u191c\\u1950-\\u196d\\u1970-\\u1974\\u1980-\\u19ab\\u19c1-\\u19c7\\u1a00-\\u1a16\\u1a20-\\u1a54\\u1aa7\\u1b05-\\u1b33\\u1b45-\\u1b4b\\u1b83-\\u1ba0\\u1bae\\u1baf\\u1bba-\\u1be5\\u1c00-\\u1c23\\u1c4d-\\u1c4f\\u1c5a-\\u1c7d\\u1ce9-\\u1cec\\u1cee-\\u1cf1\\u1cf5\\u1cf6\\u1d00-\\u1dbf\\u1e00-\\u1f15\\u1f18-\\u1f1d\\u1f20-\\u1f45\\u1f48-\\u1f4d\\u1f50-\\u1f57\\u1f59\\u1f5b\\u1f5d\\u1f5f-\\u1f7d\\u1f80-\\u1fb4\\u1fb6-\\u1fbc\\u1fbe\\u1fc2-\\u1fc4\\u1fc6-\\u1fcc\\u1fd0-\\u1fd3\\u1fd6-\\u1fdb\\u1fe0-\\u1fec\\u1ff2-\\u1ff4\\u1ff6-\\u1ffc\\u2071\\u207f\\u2090-\\u209c\\u2102\\u2107\\u210a-\\u2113\\u2115\\u2119-\\u211d\\u2124\\u2126\\u2128\\u212a-\\u212d\\u212f-\\u2139\\u213c-\\u213f\\u2145-\\u2149\\u214e\\u2160-\\u2188\\u2c00-\\u2c2e\\u2c30-\\u2c5e\\u2c60-\\u2ce4\\u2ceb-\\u2cee\\u2cf2\\u2cf3\\u2d00-\\u2d25\\u2d27\\u2d2d\\u2d30-\\u2d67\\u2d6f\\u2d80-\\u2d96\\u2da0-\\u2da6\\u2da8-\\u2dae\\u2db0-\\u2db6\\u2db8-\\u2dbe\\u2dc0-\\u2dc6\\u2dc8-\\u2dce\\u2dd0-\\u2dd6\\u2dd8-\\u2dde\\u2e2f\\u3005-\\u3007\\u3021-\\u3029\\u3031-\\u3035\\u3038-\\u303c\\u3041-\\u3096\\u309d-\\u309f\\u30a1-\\u30fa\\u30fc-\\u30ff\\u3105-\\u312d\\u3131-\\u318e\\u31a0-\\u31ba\\u31f0-\\u31ff\\u3400-\\u4db5\\u4e00-\\u9fcc\\ua000-\\ua48c\\ua4d0-\\ua4fd\\ua500-\\ua60c\\ua610-\\ua61f\\ua62a\\ua62b\\ua640-\\ua66e\\ua67f-\\ua697\\ua6a0-\\ua6ef\\ua717-\\ua71f\\ua722-\\ua788\\ua78b-\\ua78e\\ua790-\\ua793\\ua7a0-\\ua7aa\\ua7f8-\\ua801\\ua803-\\ua805\\ua807-\\ua80a\\ua80c-\\ua822\\ua840-\\ua873\\ua882-\\ua8b3\\ua8f2-\\ua8f7\\ua8fb\\ua90a-\\ua925\\ua930-\\ua946\\ua960-\\ua97c\\ua984-\\ua9b2\\ua9cf\\uaa00-\\uaa28\\uaa40-\\uaa42\\uaa44-\\uaa4b\\uaa60-\\uaa76\\uaa7a\\uaa80-\\uaaaf\\uaab1\\uaab5\\uaab6\\uaab9-\\uaabd\\uaac0\\uaac2\\uaadb-\\uaadd\\uaae0-\\uaaea\\uaaf2-\\uaaf4\\uab01-\\uab06\\uab09-\\uab0e\\uab11-\\uab16\\uab20-\\uab26\\uab28-\\uab2e\\uabc0-\\uabe2\\uac00-\\ud7a3\\ud7b0-\\ud7c6\\ud7cb-\\ud7fb\\uf900-\\ufa6d\\ufa70-\\ufad9\\ufb00-\\ufb06\\ufb13-\\ufb17\\ufb1d\\ufb1f-\\ufb28\\ufb2a-\\ufb36\\ufb38-\\ufb3c\\ufb3e\\ufb40\\ufb41\\ufb43\\ufb44\\ufb46-\\ufbb1\\ufbd3-\\ufd3d\\ufd50-\\ufd8f\\ufd92-\\ufdc7\\ufdf0-\\ufdfb\\ufe70-\\ufe74\\ufe76-\\ufefc\\uff21-\\uff3a\\uff41-\\uff5a\\uff66-\\uffbe\\uffc2-\\uffc7\\uffca-\\uffcf\\uffd2-\\uffd7\\uffda-\\uffdc0-9\\u0300-\\u036f\\u0483-\\u0487\\u0591-\\u05bd\\u05bf\\u05c1\\u05c2\\u05c4\\u05c5\\u05c7\\u0610-\\u061a\\u064b-\\u0669\\u0670\\u06d6-\\u06dc\\u06df-\\u06e4\\u06e7\\u06e8\\u06ea-\\u06ed\\u06f0-\\u06f9\\u0711\\u0730-\\u074a\\u07a6-\\u07b0\\u07c0-\\u07c9\\u07eb-\\u07f3\\u0816-\\u0819\\u081b-\\u0823\\u0825-\\u0827\\u0829-\\u082d\\u0859-\\u085b\\u08e4-\\u08fe\\u0900-\\u0903\\u093a-\\u093c\\u093e-\\u094f\\u0951-\\u0957\\u0962\\u0963\\u0966-\\u096f\\u0981-\\u0983\\u09bc\\u09be-\\u09c4\\u09c7\\u09c8\\u09cb-\\u09cd\\u09d7\\u09e2\\u09e3\\u09e6-\\u09ef\\u0a01-\\u0a03\\u0a3c\\u0a3e-\\u0a42\\u0a47\\u0a48\\u0a4b-\\u0a4d\\u0a51\\u0a66-\\u0a71\\u0a75\\u0a81-\\u0a83\\u0abc\\u0abe-\\u0ac5\\u0ac7-\\u0ac9\\u0acb-\\u0acd\\u0ae2\\u0ae3\\u0ae6-\\u0aef\\u0b01-\\u0b03\\u0b3c\\u0b3e-\\u0b44\\u0b47\\u0b48\\u0b4b-\\u0b4d\\u0b56\\u0b57\\u0b62\\u0b63\\u0b66-\\u0b6f\\u0b82\\u0bbe-\\u0bc2\\u0bc6-\\u0bc8\\u0bca-\\u0bcd\\u0bd7\\u0be6-\\u0bef\\u0c01-\\u0c03\\u0c3e-\\u0c44\\u0c46-\\u0c48\\u0c4a-\\u0c4d\\u0c55\\u0c56\\u0c62\\u0c63\\u0c66-\\u0c6f\\u0c82\\u0c83\\u0cbc\\u0cbe-\\u0cc4\\u0cc6-\\u0cc8\\u0cca-\\u0ccd\\u0cd5\\u0cd6\\u0ce2\\u0ce3\\u0ce6-\\u0cef\\u0d02\\u0d03\\u0d3e-\\u0d44\\u0d46-\\u0d48\\u0d4a-\\u0d4d\\u0d57\\u0d62\\u0d63\\u0d66-\\u0d6f\\u0d82\\u0d83\\u0dca\\u0dcf-\\u0dd4\\u0dd6\\u0dd8-\\u0ddf\\u0df2\\u0df3\\u0e31\\u0e34-\\u0e3a\\u0e47-\\u0e4e\\u0e50-\\u0e59\\u0eb1\\u0eb4-\\u0eb9\\u0ebb\\u0ebc\\u0ec8-\\u0ecd\\u0ed0-\\u0ed9\\u0f18\\u0f19\\u0f20-\\u0f29\\u0f35\\u0f37\\u0f39\\u0f3e\\u0f3f\\u0f71-\\u0f84\\u0f86\\u0f87\\u0f8d-\\u0f97\\u0f99-\\u0fbc\\u0fc6\\u102b-\\u103e\\u1040-\\u1049\\u1056-\\u1059\\u105e-\\u1060\\u1062-\\u1064\\u1067-\\u106d\\u1071-\\u1074\\u1082-\\u108d\\u108f-\\u109d\\u135d-\\u135f\\u1712-\\u1714\\u1732-\\u1734\\u1752\\u1753\\u1772\\u1773\\u17b4-\\u17d3\\u17dd\\u17e0-\\u17e9\\u180b-\\u180d\\u1810-\\u1819\\u18a9\\u1920-\\u192b\\u1930-\\u193b\\u1946-\\u194f\\u19b0-\\u19c0\\u19c8\\u19c9\\u19d0-\\u19d9\\u1a17-\\u1a1b\\u1a55-\\u1a5e\\u1a60-\\u1a7c\\u1a7f-\\u1a89\\u1a90-\\u1a99\\u1b00-\\u1b04\\u1b34-\\u1b44\\u1b50-\\u1b59\\u1b6b-\\u1b73\\u1b80-\\u1b82\\u1ba1-\\u1bad\\u1bb0-\\u1bb9\\u1be6-\\u1bf3\\u1c24-\\u1c37\\u1c40-\\u1c49\\u1c50-\\u1c59\\u1cd0-\\u1cd2\\u1cd4-\\u1ce8\\u1ced\\u1cf2-\\u1cf4\\u1dc0-\\u1de6\\u1dfc-\\u1dff\\u200c\\u200d\\u203f\\u2040\\u2054\\u20d0-\\u20dc\\u20e1\\u20e5-\\u20f0\\u2cef-\\u2cf1\\u2d7f\\u2de0-\\u2dff\\u302a-\\u302f\\u3099\\u309a\\ua620-\\ua629\\ua66f\\ua674-\\ua67d\\ua69f\\ua6f0\\ua6f1\\ua802\\ua806\\ua80b\\ua823-\\ua827\\ua880\\ua881\\ua8b4-\\ua8c4\\ua8d0-\\ua8d9\\ua8e0-\\ua8f1\\ua900-\\ua909\\ua926-\\ua92d\\ua947-\\ua953\\ua980-\\ua983\\ua9b3-\\ua9c0\\ua9d0-\\ua9d9\\uaa29-\\uaa36\\uaa43\\uaa4c\\uaa4d\\uaa50-\\uaa59\\uaa7b\\uaab0\\uaab2-\\uaab4\\uaab7\\uaab8\\uaabe\\uaabf\\uaac1\\uaaeb-\\uaaef\\uaaf5\\uaaf6\\uabe3-\\uabea\\uabec\\uabed\\uabf0-\\uabf9\\ufb1e\\ufe00-\\ufe0f\\ufe20-\\ufe26\\ufe33\\ufe34\\ufe4d-\\ufe4f\\uff10-\\uff19\\uff3f]*$/.test(str)\n}\nmodule.exports = isProperty","module.exports = require(\"process\");","export * from \"../../../common/src\";\n","import { AudioStreamOptions } from \"@scrypted/sdk\";\nimport { RTCRtpCodecParameters } from \"./werift\";\n\nexport const requiredVideoCodec = new RTCRtpCodecParameters({\n    mimeType: \"video/H264\",\n    clockRate: 90000,\n    rtcpFeedback: [\n        { type: \"transport-cc\" },\n        { type: \"ccm\", parameter: \"fir\" },\n        { type: \"nack\" },\n        { type: \"nack\", parameter: \"pli\" },\n        { type: \"goog-remb\" },\n    ],\n    parameters: 'level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f'\n});\n\nexport const optionalVideoCodec = new RTCRtpCodecParameters({\n    mimeType: \"video/H265\",\n    clockRate: 90000,\n    rtcpFeedback: [\n        { type: \"transport-cc\" },\n        { type: \"ccm\", parameter: \"fir\" },\n        { type: \"nack\" },\n        { type: \"nack\", parameter: \"pli\" },\n        { type: \"goog-remb\" },\n    ],\n    parameters: 'level-asymmetry-allowed=1;packetization-mode=1;profile-level-id=42e01f'\n});\n\nexport const requiredAudioCodecs = [\n    new RTCRtpCodecParameters({\n        mimeType: \"audio/opus\",\n        clockRate: 48000,\n        channels: 2,\n        payloadType: 111,\n    }),\n    // new RTCRtpCodecParameters({\n    //     mimeType: \"audio/G722\",\n    //     clockRate: 8000,\n    //     channels: 1,\n    //     payloadType: 9,\n    // }),\n    new RTCRtpCodecParameters({\n        mimeType: \"audio/PCMU\",\n        clockRate: 8000,\n        channels: 1,\n        payloadType: 0,\n    }),\n    new RTCRtpCodecParameters({\n        mimeType: \"audio/PCMA\",\n        clockRate: 8000,\n        channels: 1,\n        payloadType: 8,\n    }),\n];\n\nexport const opusAudioCodecOnly = [\n    new RTCRtpCodecParameters({\n        mimeType: \"audio/opus\",\n        clockRate: 48000,\n        channels: 2,\n        payloadType: 111,\n    }),\n];\n\nexport function getAudioCodec(outputCodecParameters: RTCRtpCodecParameters) {\n    if (outputCodecParameters.name === 'PCMA') {\n        return {\n            name: 'pcm_alaw',\n            encoder: 'pcm_alaw',\n            sampleRate: 8000,\n        };\n    }\n    if (outputCodecParameters.name === 'PCMU') {\n        return {\n            name: 'pcm_mulaw',\n            encoder: 'pcm_mulaw',\n            sampleRate: 8000,\n        };\n    }\n    return {\n        name: 'opus',\n        encoder: 'libopus',\n        sampleRate: 16000,\n    };\n}\n\nexport function getFFmpegRtpAudioOutputArguments(audio: AudioStreamOptions, outputCodecParameters: RTCRtpCodecParameters, maximumCompatibilityMode: boolean) {\n    const ret: string[] = [];\n\n    const { encoder, name, sampleRate } = getAudioCodec(outputCodecParameters);\n\n    if (audio?.codec === name && (!audio?.sampleRate || audio?.sampleRate === sampleRate) && !maximumCompatibilityMode) {\n        ret.push('-acodec', 'copy');\n    }\n    else {\n        ret.push(\n            '-acodec', encoder,\n            '-flags', '+global_header',\n            '-ar', `${outputCodecParameters.clockRate}`,\n            // choose a better birate? this is on the high end recommendation for voice.\n            '-b:a', '40k',\n            '-bufsize', '96k',\n            '-ac', outputCodecParameters.channels.toString(),\n        )\n\n        if (encoder === 'libopus')\n            ret.push(\n                '-application', 'lowdelay',\n                // webrtc is supposed to support various frame durations but\n                // in practice it expects the default 20 in various implementations.\n                // '-frame_duration', '60',\n            );\n    }\n    return ret;\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type { Extension } from \"../../typings/domain\";\n\nexport class UseSRTP {\n  static type = 14; // 9.  IANA Considerations\n  static readonly spec = {\n    type: types.uint16be,\n    data: types.buffer(types.uint16be),\n  };\n\n  type: number = UseSRTP.type;\n  data: Buffer = Buffer.from([]);\n  profiles: number[] = [];\n  mki: Buffer = Buffer.from([0x00]);\n\n  constructor(props: Partial<UseSRTP> = {}) {\n    Object.assign(this, props);\n  }\n\n  static create(profiles: number[], mki: Buffer) {\n    const v = new UseSRTP({\n      profiles,\n      mki,\n    });\n    return v;\n  }\n\n  static deSerialize(buf: Buffer) {\n    const useSrtp = new UseSRTP(decode(buf, UseSRTP.spec));\n    const profileLength = useSrtp.data.readUInt16BE();\n\n    const profiles = new Array(profileLength / 2);\n    for (let i = 0; i < profiles.length; i++) {\n      profiles[i] = useSrtp.data.readUInt16BE(i * 2 + 2);\n    }\n    useSrtp.profiles = profiles;\n    useSrtp.mki = useSrtp.data.slice(profileLength + 2);\n    return useSrtp;\n  }\n\n  serialize() {\n    const profileLength = Buffer.alloc(2);\n    profileLength.writeUInt16BE(this.profiles.length * 2);\n    const data = Buffer.concat([\n      profileLength,\n      ...this.profiles.map((profile) => {\n        const buf = Buffer.alloc(2);\n        buf.writeUInt16BE(profile);\n        return buf;\n      }),\n      this.mki,\n    ]);\n    this.data = data;\n    const res = encode(this, UseSRTP.spec).slice();\n    return Buffer.from(res);\n  }\n\n  static fromData(buf: Buffer) {\n    const head = Buffer.alloc(4);\n    head.writeUInt16BE(UseSRTP.type);\n    head.writeUInt16BE(buf.length, 2);\n    return UseSRTP.deSerialize(Buffer.concat([head, buf]));\n  }\n\n  get extension(): Extension {\n    return {\n      type: this.type,\n      data: this.serialize().slice(4),\n    };\n  }\n}\n","import { createCipheriv, createDecipheriv } from \"crypto\";\n\nimport { CipherAesBase } from \".\";\nimport { createBufferWriter } from \"../../../../common/src\";\nimport { growBufferSize } from \"../../helper\";\nimport { RtcpHeader } from \"../../rtcp/header\";\nimport { RtpHeader } from \"../../rtp/rtp\";\n\nexport class CipherAesGcm extends CipherAesBase {\n  readonly aeadAuthTagLen = 16;\n  readonly rtpIvWriter = createBufferWriter([2, 4, 4, 2], true);\n  readonly rtcpIvWriter = createBufferWriter([2, 4, 2, 4], true);\n  readonly aadWriter = createBufferWriter([4], true);\n\n  constructor(\n    srtpSessionKey: Buffer,\n    srtpSessionSalt: Buffer,\n    srtcpSessionKey: Buffer,\n    srtcpSessionSalt: Buffer,\n  ) {\n    super(srtpSessionKey, srtpSessionSalt, srtcpSessionKey, srtcpSessionSalt);\n  }\n\n  encryptRtp(header: RtpHeader, payload: Buffer, rolloverCounter: number) {\n    const hdr = header.serialize(header.serializeSize);\n\n    const iv = this.rtpInitializationVector(header, rolloverCounter);\n\n    const cipher = createCipheriv(\"aes-128-gcm\", this.srtpSessionKey, iv);\n    cipher.setAAD(hdr);\n    const enc = cipher.update(payload);\n    cipher.final();\n\n    const authTag = cipher.getAuthTag();\n\n    const dst = Buffer.concat([hdr, enc, authTag]);\n    return dst;\n  }\n\n  decryptRtp(cipherText: Buffer, rolloverCounter: number): [Buffer, RtpHeader] {\n    const header = RtpHeader.deSerialize(cipherText);\n\n    let dst = Buffer.from([]);\n    dst = growBufferSize(dst, cipherText.length - this.aeadAuthTagLen);\n    cipherText.slice(0, header.payloadOffset).copy(dst);\n\n    const iv = this.rtpInitializationVector(header, rolloverCounter);\n\n    const enc = cipherText.slice(\n      header.payloadOffset,\n      cipherText.length - this.aeadAuthTagLen,\n    );\n\n    const cipher = createDecipheriv(\"aes-128-gcm\", this.srtpSessionKey, iv);\n    const dec = cipher.update(enc);\n\n    dec.copy(dst, header.payloadOffset);\n\n    return [dst, header];\n  }\n\n  encryptRTCP(rtcpPacket: Buffer, srtcpIndex: number): Buffer {\n    const ssrc = rtcpPacket.readUInt32BE(4);\n\n    const addPos = rtcpPacket.length + this.aeadAuthTagLen;\n    let dst = Buffer.from([]);\n    dst = growBufferSize(dst, addPos + srtcpIndexSize);\n    rtcpPacket.slice(0, 8).copy(dst);\n\n    const iv = this.rtcpInitializationVector(ssrc, srtcpIndex);\n    const aad = this.rtcpAdditionalAuthenticatedData(rtcpPacket, srtcpIndex);\n\n    const cipher = createCipheriv(\"aes-128-gcm\", this.srtcpSessionKey, iv);\n    cipher.setAAD(aad);\n    const enc = cipher.update(rtcpPacket.slice(8));\n    cipher.final();\n    enc.copy(dst, 8);\n\n    const authTag = cipher.getAuthTag();\n    authTag.copy(dst, 8 + enc.length);\n    aad.slice(8, 12).copy(dst, addPos);\n\n    return dst;\n  }\n\n  decryptRTCP(encrypted: Buffer): [Buffer, RtcpHeader] {\n    const header = RtcpHeader.deSerialize(encrypted);\n    const aadPos = encrypted.length - srtcpIndexSize;\n\n    const dst = Buffer.alloc(aadPos - this.aeadAuthTagLen);\n    encrypted.slice(0, 8).copy(dst);\n\n    const ssrc = encrypted.readUInt32BE(4);\n\n    let srtcpIndex = encrypted.readUInt32BE(encrypted.length - 4);\n    srtcpIndex &= ~(rtcpEncryptionFlag << 24);\n\n    const iv = this.rtcpInitializationVector(ssrc, srtcpIndex);\n    const aad = this.rtcpAdditionalAuthenticatedData(encrypted, srtcpIndex);\n\n    const cipher = createDecipheriv(\"aes-128-gcm\", this.srtcpSessionKey, iv);\n    cipher.setAAD(aad);\n    const dec = cipher.update(encrypted.slice(8, aadPos));\n\n    dec.copy(dst, 8);\n\n    return [dst, header];\n  }\n\n  // https://tools.ietf.org/html/rfc7714#section-8.1\n  private rtpInitializationVector(header: RtpHeader, rolloverCounter: number) {\n    const iv = this.rtpIvWriter([\n      0,\n      header.ssrc,\n      rolloverCounter,\n      header.sequenceNumber,\n    ]);\n    for (let i = 0; i < iv.length; i++) {\n      iv[i] ^= this.srtpSessionSalt[i];\n    }\n    return iv;\n  }\n\n  // https://tools.ietf.org/html/rfc7714#section-9.1\n  private rtcpInitializationVector(ssrc: number, srtcpIndex: number) {\n    const iv = this.rtcpIvWriter([0, ssrc, 0, srtcpIndex]);\n    for (let i = 0; i < iv.length; i++) {\n      iv[i] ^= this.srtcpSessionSalt[i];\n    }\n    return iv;\n  }\n\n  // https://datatracker.ietf.org/doc/html/rfc7714#section-17\n  private rtcpAdditionalAuthenticatedData(\n    rtcpPacket: Buffer,\n    srtcpIndex: number,\n  ) {\n    const aad = Buffer.concat([\n      rtcpPacket.subarray(0, 8),\n      this.aadWriter([srtcpIndex]),\n    ]);\n    aad[8] |= rtcpEncryptionFlag;\n    return aad;\n  }\n}\n\nconst srtcpIndexSize = 4;\nconst rtcpEncryptionFlag = 0x80;\n","import { BitWriter, getBit } from \"../../../common/src\";\n\nexport type Extension = { id: number; payload: Buffer };\n\nexport const ExtensionProfiles = {\n  OneByte: 0xbede, // 48862\n  TwoByte: 0x1000, // 4096\n} as const;\ntype ExtensionProfile =\n  (typeof ExtensionProfiles)[keyof typeof ExtensionProfiles];\n\nconst seqNumOffset = 2;\nconst timestampOffset = 4;\nconst ssrcOffset = 8;\nconst csrcOffset = 12;\nconst csrcSize = 4;\n\n/*\n *  0                   1                   2                   3\n *  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n * |V=2|P|X|  CC   |M|     PT      |       sequence number         |\n * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n * |                           timestamp                           |\n * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n * |           synchronization source (SSRC) identifier            |\n * +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+\n * |            contributing source (CSRC) identifiers             |\n * |                             ....                              |\n * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n */\n\nexport class RtpHeader {\n  version = 2;\n  padding = false;\n  paddingSize = 0;\n  extension = false;\n  marker = false;\n  payloadOffset = 0;\n  payloadType = 0;\n  /**16bit, */\n  sequenceNumber = 0;\n  /**32bit microsec (milli/1000), */\n  timestamp = 0;\n  ssrc = 0;\n  csrcLength = 0;\n  csrc: number[] = [];\n  extensionProfile: ExtensionProfile = ExtensionProfiles.OneByte;\n  /**deserialize only */\n  extensionLength?: number;\n  extensions: Extension[] = [];\n  constructor(props: Partial<RtpHeader> = {}) {\n    Object.assign(this, props);\n  }\n\n  static deSerialize(rawPacket: Buffer) {\n    const h = new RtpHeader();\n    let currOffset = 0;\n    const v_p_x_cc = rawPacket[currOffset++];\n    h.version = getBit(v_p_x_cc, 0, 2);\n    h.padding = getBit(v_p_x_cc, 2) > 0;\n    h.extension = getBit(v_p_x_cc, 3) > 0;\n    h.csrcLength = getBit(v_p_x_cc, 4, 4);\n    h.csrc = [...Array(h.csrcLength)].map(() => {\n      const csrc = rawPacket.readUInt32BE(currOffset);\n      currOffset += 4;\n      return csrc;\n    });\n    currOffset += csrcOffset - 1;\n\n    const m_pt = rawPacket[1];\n    h.marker = getBit(m_pt, 0) > 0;\n    h.payloadType = getBit(m_pt, 1, 7);\n\n    h.sequenceNumber = rawPacket.readUInt16BE(seqNumOffset);\n    h.timestamp = rawPacket.readUInt32BE(timestampOffset);\n    h.ssrc = rawPacket.readUInt32BE(ssrcOffset);\n\n    for (let i = 0; i < h.csrc.length; i++) {\n      const offset = csrcOffset + i * csrcSize;\n      h.csrc[i] = rawPacket.subarray(offset).readUInt32BE();\n    }\n    if (h.extension) {\n      h.extensionProfile = rawPacket\n        .subarray(currOffset)\n        .readUInt16BE() as ExtensionProfile;\n      currOffset += 2;\n      const extensionLength = rawPacket.subarray(currOffset).readUInt16BE() * 4;\n      h.extensionLength = extensionLength;\n      currOffset += 2;\n\n      switch (h.extensionProfile) {\n        // RFC 8285 RTP One Byte Header Extension\n        case ExtensionProfiles.OneByte:\n          {\n            const end = currOffset + extensionLength;\n            while (currOffset < end) {\n              if (rawPacket[currOffset] === 0x00) {\n                currOffset++;\n                continue;\n              }\n\n              const extId = rawPacket[currOffset] >> 4;\n              const len =\n                (rawPacket[currOffset] & (rawPacket[currOffset] ^ 0xf0)) + 1; // and not &^\n              currOffset++;\n              if (extId === 0xf) {\n                break;\n              }\n              const extension: Extension = {\n                id: extId,\n                payload: rawPacket.subarray(currOffset, currOffset + len),\n              };\n              h.extensions = [...h.extensions, extension];\n              currOffset += len;\n            }\n          }\n          break;\n        // RFC 8285 RTP Two Byte Header Extension\n        case ExtensionProfiles.TwoByte:\n          {\n            const end = currOffset + extensionLength;\n            while (currOffset < end) {\n              if (rawPacket[currOffset] === 0x00) {\n                currOffset++;\n                continue;\n              }\n              const extId = rawPacket[currOffset];\n              currOffset++;\n              const len = rawPacket[currOffset];\n              currOffset++;\n\n              const extension: Extension = {\n                id: extId,\n                payload: rawPacket.subarray(currOffset, currOffset + len),\n              };\n              h.extensions = [...h.extensions, extension];\n              currOffset += len;\n            }\n          }\n          break;\n        default:\n          {\n            const extension: Extension = {\n              id: 0,\n              payload: rawPacket.subarray(\n                currOffset,\n                currOffset + extensionLength,\n              ),\n            };\n            h.extensions = [...h.extensions, extension];\n            currOffset += h.extensions[0].payload.length;\n          }\n          break;\n      }\n    }\n    h.payloadOffset = currOffset;\n    if (h.padding) {\n      h.paddingSize = rawPacket[rawPacket.length - 1];\n    }\n\n    return h;\n  }\n\n  get serializeSize() {\n    const { csrc, extensionProfile, extensions } = this;\n\n    let size = 12 + csrc.length * csrcSize;\n\n    if (extensions.length > 0 || this.extension === true) {\n      let extSize = 4;\n      switch (extensionProfile) {\n        case ExtensionProfiles.OneByte:\n          for (const extension of extensions) {\n            extSize += 1 + extension.payload.length;\n          }\n          break;\n        case ExtensionProfiles.TwoByte:\n          for (const extension of extensions) {\n            extSize += 2 + extension.payload.length;\n          }\n          break;\n        default:\n          extSize += extensions[0].payload.length;\n      }\n      size += Math.floor((extSize + 3) / 4) * 4;\n    }\n\n    return size;\n  }\n\n  serialize(size: number) {\n    const buf = Buffer.alloc(size);\n    let offset = 0;\n\n    const v_p_x_cc = new BitWriter(8);\n    v_p_x_cc.set(2, 0, this.version);\n    if (this.padding) v_p_x_cc.set(1, 2, 1);\n    if (this.extensions.length > 0) this.extension = true;\n    if (this.extension) v_p_x_cc.set(1, 3, 1);\n    v_p_x_cc.set(4, 4, this.csrc.length);\n    buf.writeUInt8(v_p_x_cc.value, offset++);\n\n    const m_pt = new BitWriter(8);\n    if (this.marker) m_pt.set(1, 0, 1);\n    m_pt.set(7, 1, this.payloadType);\n    buf.writeUInt8(m_pt.value, offset++);\n\n    buf.writeUInt16BE(this.sequenceNumber, seqNumOffset);\n    offset += 2;\n    buf.writeUInt32BE(this.timestamp, timestampOffset);\n    offset += 4;\n    buf.writeUInt32BE(this.ssrc, ssrcOffset);\n    offset += 4;\n\n    for (const csrc of this.csrc) {\n      buf.writeUInt32BE(csrc, offset);\n      offset += 4;\n    }\n\n    if (this.extension) {\n      const extHeaderPos = offset;\n      buf.writeUInt16BE(this.extensionProfile, offset);\n      offset += 4;\n      const startExtensionsPos = offset;\n\n      switch (this.extensionProfile) {\n        case ExtensionProfiles.OneByte:\n          for (const extension of this.extensions) {\n            buf.writeUInt8(\n              (extension.id << 4) | (extension.payload.length - 1),\n              offset++,\n            );\n            extension.payload.copy(buf, offset);\n            offset += extension.payload.length;\n          }\n          break;\n        case ExtensionProfiles.TwoByte: // 1\n          for (const extension of this.extensions) {\n            buf.writeUInt8(extension.id, offset++);\n            buf.writeUInt8(extension.payload.length, offset++);\n            extension.payload.copy(buf, offset);\n            offset += extension.payload.length;\n          }\n          break;\n        default: {\n          const extLen = this.extensions[0].payload.length;\n          if (extLen % 4 != 0) {\n            throw new Error();\n          }\n          this.extensions[0].payload.copy(buf, offset);\n          offset += extLen;\n        }\n      }\n\n      const extSize = offset - startExtensionsPos;\n      const roundedExtSize = Math.trunc((extSize + 3) / 4) * 4;\n\n      buf.writeUInt16BE(Math.trunc(roundedExtSize / 4), extHeaderPos + 2);\n      // padding 4 bytes boundaries\n      for (let i = 0; i < roundedExtSize - extSize; i++) {\n        buf.writeUInt8(0, offset);\n        offset++;\n      }\n    }\n    this.payloadOffset = offset;\n    return buf;\n  }\n}\n\nexport class RtpPacket {\n  constructor(\n    public header: RtpHeader,\n    public payload: Buffer,\n  ) {}\n\n  get serializeSize() {\n    return this.header.serializeSize + this.payload.length;\n  }\n\n  clone() {\n    return new RtpPacket(new RtpHeader({ ...this.header }), this.payload);\n  }\n\n  serialize() {\n    let buf = this.header.serialize(\n      this.header.serializeSize + this.payload.length,\n    );\n    const { payloadOffset } = this.header;\n    this.payload.copy(buf, payloadOffset);\n    if (this.header.padding) {\n      const padding = Buffer.alloc(this.header.paddingSize);\n      padding.writeUInt8(this.header.paddingSize, this.header.paddingSize - 1);\n      buf = Buffer.concat([buf, padding]);\n    }\n\n    return buf;\n  }\n\n  static deSerialize(buf: Buffer) {\n    const header = RtpHeader.deSerialize(buf);\n    const p = new RtpPacket(\n      header,\n      buf.subarray(header.payloadOffset, buf.length - header.paddingSize),\n    );\n    return p;\n  }\n\n  clear() {\n    this.payload = null as any;\n  }\n}\n","// ID Value    Chunk Type\n// -----       ----------\n// 0          - Payload Data (DATA)\n// 1          - Initiation (INIT)\n// 2          - Initiation Acknowledgement (INIT ACK)\n// 3          - Selective Acknowledgement (SACK)\n// 4          - Heartbeat Request (HEARTBEAT)\n// 5          - Heartbeat Acknowledgement (HEARTBEAT ACK)\n// 6          - Abort (ABORT)\n// 7          - Shutdown (SHUTDOWN)\n// 8          - Shutdown Acknowledgement (SHUTDOWN ACK)\n// 9          - Operation Error (ERROR)\n// 10         - State Cookie (COOKIE ECHO)\n// 11         - Cookie Acknowledgement (COOKIE ACK)\n// 12         - Reserved for Explicit Congestion Notification Echo\n//              (ECNE)\n// 13         - Reserved for Congestion Window Reduced (CWR)\n// 14         - Shutdown Complete (SHUTDOWN COMPLETE)\n// 15 to 62   - available\n// 63         - reserved for IETF-defined Chunk Extensions\n// 64 to 126  - available\n// 127        - reserved for IETF-defined Chunk Extensions\n// 128 to 190 - available\n// 191        - reserved for IETF-defined Chunk Extensions\n// 192 to 254 - available\n// 255        - reserved for IETF-defined Chunk Extensions\n\nimport crc32c from \"turbo-crc32/crc32c.js\";\n\nexport class Chunk {\n  public get body(): Buffer | undefined {\n    return this._body;\n  }\n  public set body(value: Buffer | undefined) {\n    this._body = value;\n  }\n  static type = -1;\n\n  constructor(\n    public flags = 0,\n    private _body: Buffer | undefined = Buffer.from(\"\"),\n  ) {}\n\n  get type() {\n    return Chunk.type;\n  }\n\n  get bytes() {\n    if (!this.body) throw new Error();\n\n    const header = Buffer.alloc(4);\n    header.writeUInt8(this.type, 0);\n    header.writeUInt8(this.flags, 1);\n    header.writeUInt16BE(this.body.length + 4, 2);\n\n    const data = Buffer.concat([\n      header,\n      this.body,\n      ...[...Array(padL(this.body.length))].map(() => Buffer.from(\"\\x00\")),\n    ]);\n    return data;\n  }\n}\n\nexport class BaseInitChunk extends Chunk {\n  initiateTag: number;\n  advertisedRwnd: number;\n  outboundStreams: number;\n  inboundStreams: number;\n  initialTsn: number;\n  params: [number, Buffer][];\n\n  constructor(\n    public flags = 0,\n    body?: Buffer,\n  ) {\n    super(flags, body);\n\n    if (body) {\n      this.initiateTag = body.readUInt32BE(0);\n      this.advertisedRwnd = body.readUInt32BE(4);\n      this.outboundStreams = body.readUInt16BE(8);\n      this.inboundStreams = body.readUInt16BE(10);\n      this.initialTsn = body.readUInt32BE(12);\n      this.params = decodeParams(body.slice(16));\n    } else {\n      this.initiateTag = 0;\n      this.advertisedRwnd = 0;\n      this.outboundStreams = 0;\n      this.inboundStreams = 0;\n      this.initialTsn = 0;\n      this.params = [];\n    }\n  }\n\n  get body() {\n    const body = Buffer.alloc(16);\n    body.writeUInt32BE(this.initiateTag, 0);\n    body.writeUInt32BE(this.advertisedRwnd, 4);\n    body.writeUInt16BE(this.outboundStreams, 8);\n    body.writeUInt16BE(this.inboundStreams, 10);\n    body.writeUInt32BE(this.initialTsn, 12);\n    return Buffer.concat([body, encodeParams(this.params)]);\n  }\n}\n\nexport class InitChunk extends BaseInitChunk {\n  static type = 1 as const;\n\n  get type() {\n    return InitChunk.type;\n  }\n}\n\nexport class InitAckChunk extends BaseInitChunk {\n  static type = 2 as const;\n\n  get type() {\n    return InitAckChunk.type;\n  }\n}\n\nexport class ReConfigChunk extends BaseInitChunk {\n  static type = 130 as const;\n\n  get type() {\n    return ReConfigChunk.type;\n  }\n}\n\nexport class ForwardTsnChunk extends Chunk {\n  static type = 192 as const;\n  streams: [number, number][] = [];\n  cumulativeTsn: number;\n\n  constructor(\n    public flags = 0,\n    body: Buffer | undefined,\n  ) {\n    super(flags, body);\n\n    if (body) {\n      this.cumulativeTsn = body.readUInt32BE(0);\n      let pos = 4;\n      while (pos < body.length) {\n        this.streams.push([body.readUInt16BE(pos), body.readUInt16BE(pos + 2)]);\n        pos += 4;\n      }\n    } else {\n      this.cumulativeTsn = 0;\n    }\n  }\n\n  get type() {\n    return ForwardTsnChunk.type;\n  }\n\n  set body(_: Buffer) {}\n\n  get body() {\n    const body = Buffer.alloc(4);\n    body.writeUInt32BE(this.cumulativeTsn, 0);\n    return Buffer.concat([\n      body,\n      ...this.streams.map(([id, seq]) => {\n        const streamBuffer = Buffer.alloc(4);\n        streamBuffer.writeUInt16BE(id, 0);\n        streamBuffer.writeUInt16BE(seq, 2);\n        return streamBuffer;\n      }),\n    ]);\n  }\n}\n\nexport class DataChunk extends Chunk {\n  static type = 0 as const;\n  get type() {\n    return DataChunk.type;\n  }\n  tsn: number = 0;\n  streamId: number = 0;\n  streamSeqNum: number = 0;\n  protocol: number = 0;\n  userData: Buffer = Buffer.from(\"\");\n  abandoned: boolean = false;\n  acked: boolean = false;\n  misses: number = 0;\n  retransmit: boolean = false;\n  sentCount: number = 0;\n  bookSize: number = 0;\n  expiry?: number;\n  maxRetransmits?: number;\n  sentTime?: number;\n\n  constructor(\n    public flags = 0,\n    body: Buffer | undefined,\n  ) {\n    super(flags, body);\n    if (body) {\n      this.tsn = body.readUInt32BE(0);\n      this.streamId = body.readUInt16BE(4);\n      this.streamSeqNum = body.readUInt16BE(6);\n      this.protocol = body.readUInt32BE(8);\n      this.userData = body.slice(12);\n    }\n  }\n\n  get bytes() {\n    const length = 16 + this.userData.length;\n    const header = Buffer.alloc(16);\n    header.writeUInt8(this.type, 0);\n    header.writeUInt8(this.flags, 1);\n    header.writeUInt16BE(length, 2);\n    header.writeUInt32BE(this.tsn, 4);\n    header.writeUInt16BE(this.streamId, 8);\n    header.writeUInt16BE(this.streamSeqNum, 10);\n    header.writeUInt32BE(this.protocol, 12);\n\n    let data = Buffer.concat([header, this.userData]);\n    if (length % 4) {\n      data = Buffer.concat([\n        data,\n        ...[...Array(padL(length))].map(() => Buffer.from(\"\\x00\")),\n      ]);\n    }\n    return data;\n  }\n}\n\nexport class CookieEchoChunk extends Chunk {\n  static type = 10 as const;\n\n  get type() {\n    return CookieEchoChunk.type;\n  }\n}\n\nexport class CookieAckChunk extends Chunk {\n  static type = 11 as const;\n\n  get type() {\n    return CookieAckChunk.type;\n  }\n}\n\nexport class BaseParamsChunk extends Chunk {\n  params: [number, Buffer][] = [];\n  constructor(\n    public flags = 0,\n    body: Buffer | undefined = undefined,\n  ) {\n    super(flags, body);\n    if (body) {\n      this.params = decodeParams(body);\n    }\n  }\n\n  get body() {\n    return encodeParams(this.params);\n  }\n}\n\nexport class AbortChunk extends BaseParamsChunk {\n  static type = 6 as const;\n\n  get type() {\n    return AbortChunk.type;\n  }\n}\n\nexport class ErrorChunk extends BaseParamsChunk {\n  static type = 9 as const;\n  static readonly CODE = {\n    InvalidStreamIdentifier: 1,\n    MissingMandatoryParameter: 2,\n    StaleCookieError: 3,\n    OutofResource: 4,\n    UnresolvableAddress: 5,\n    UnrecognizedChunkType: 6,\n    InvalidMandatoryParameter: 7,\n    UnrecognizedParameters: 8,\n    NoUserData: 9,\n    CookieReceivedWhileShuttingDown: 10,\n    RestartofanAssociationwithNewAddresses: 11,\n    UserInitiatedAbort: 12,\n    ProtocolViolation: 13,\n  } as const;\n\n  get type() {\n    return ErrorChunk.type;\n  }\n\n  get descriptions() {\n    return this.params.map(([code, body]) => {\n      const name = (Object.entries(ErrorChunk.CODE).find(\n        ([, num]) => num === code,\n      ) || [])[0];\n      return { name, body };\n    });\n  }\n}\n\nexport class HeartbeatChunk extends BaseParamsChunk {\n  static type = 4 as const;\n\n  get type() {\n    return HeartbeatChunk.type;\n  }\n}\n\nexport class HeartbeatAckChunk extends BaseParamsChunk {\n  static type = 5 as const;\n\n  get type() {\n    return HeartbeatAckChunk.type;\n  }\n}\n\n// https://tools.ietf.org/html/rfc6525#section-3.1\n// chunkReconfig represents an SCTP Chunk used to reconfigure streams.\n//\n//  0                   1                   2                   3\n//  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// | Type = 130    |  Chunk Flags  |      Chunk Length             |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// \\                                                               \\\n// /                  Re-configuration Parameter                   /\n// \\                                                               \\\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// \\                                                               \\\n// /             Re-configuration Parameter (optional)             /\n// \\                                                               \\\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\nexport class ReconfigChunk extends BaseParamsChunk {\n  static type = 130 as const;\n\n  get type() {\n    return ReconfigChunk.type;\n  }\n}\n\nexport class SackChunk extends Chunk {\n  static type = 3;\n  get type() {\n    return SackChunk.type;\n  }\n\n  gaps: [number, number][] = [];\n  duplicates: number[] = [];\n  cumulativeTsn = 0;\n  advertisedRwnd = 0;\n\n  constructor(\n    public flags = 0,\n    body: Buffer | undefined,\n  ) {\n    super(flags, body);\n\n    if (body) {\n      this.cumulativeTsn = body.readUInt32BE(0);\n      this.advertisedRwnd = body.readUInt32BE(4);\n      const nbGaps = body.readUInt16BE(8);\n      const nbDuplicates = body.readUInt16BE(10);\n\n      let pos = 12;\n\n      [...Array(nbGaps)].forEach(() => {\n        this.gaps.push([body.readUInt16BE(pos), body.readUInt16BE(pos + 2)]);\n        pos += 4;\n      });\n\n      [...Array(nbDuplicates)].forEach(() => {\n        this.duplicates.push(body.readUInt32BE(pos));\n        pos += 4;\n      });\n    }\n  }\n\n  get bytes() {\n    const length = 16 + 4 * (this.gaps.length + this.duplicates.length);\n    const header = Buffer.alloc(16);\n    header.writeUInt8(this.type, 0);\n    header.writeUInt8(this.flags, 1);\n    header.writeUInt16BE(length, 2);\n    header.writeUInt32BE(this.cumulativeTsn, 4);\n    header.writeUInt32BE(this.advertisedRwnd, 8);\n    header.writeUInt16BE(this.gaps.length, 12);\n    header.writeUInt16BE(this.duplicates.length, 14);\n\n    let data = Buffer.concat([\n      header,\n      ...this.gaps.map((gap) => {\n        const gapBuffer = Buffer.alloc(4);\n        gapBuffer.writeUInt16BE(gap[0], 0);\n        gapBuffer.writeUInt16BE(gap[1], 2);\n        return gapBuffer;\n      }),\n    ]);\n    data = Buffer.concat([\n      data,\n      ...this.duplicates.map((tsn) => {\n        const tsnBuffer = Buffer.alloc(4);\n        tsnBuffer.writeUInt32BE(tsn, 0);\n        return tsnBuffer;\n      }),\n    ]);\n    return data;\n  }\n}\n\nexport class ShutdownChunk extends Chunk {\n  static type = 7;\n  get type() {\n    return ShutdownChunk.type;\n  }\n\n  cumulativeTsn = 0;\n\n  constructor(\n    public flags = 0,\n    body: Buffer | undefined,\n  ) {\n    super(flags, body);\n\n    if (body) {\n      this.cumulativeTsn = body.readUInt32BE(0);\n    }\n  }\n\n  get body() {\n    const body = Buffer.alloc(4);\n    body.writeUInt32BE(this.cumulativeTsn, 0);\n    return body;\n  }\n}\n\nexport class ShutdownAckChunk extends Chunk {\n  static type = 8;\n  get type() {\n    return ShutdownAckChunk.type;\n  }\n}\n\nexport class ShutdownCompleteChunk extends Chunk {\n  static type = 14;\n  get type() {\n    return ShutdownCompleteChunk.type;\n  }\n}\n\nconst CHUNK_CLASSES: (typeof Chunk)[] = [\n  DataChunk,\n  InitChunk,\n  InitAckChunk,\n  SackChunk,\n  HeartbeatChunk,\n  HeartbeatAckChunk,\n  AbortChunk,\n  ShutdownChunk,\n  ShutdownAckChunk,\n  ErrorChunk,\n  CookieEchoChunk,\n  CookieAckChunk,\n  ShutdownCompleteChunk,\n  ReconfigChunk,\n  ForwardTsnChunk,\n];\n\nexport const CHUNK_BY_TYPE = CHUNK_CLASSES.reduce(\n  (acc: { [key: string]: typeof Chunk }, cur) => {\n    acc[cur.type] = cur;\n    return acc;\n  },\n  {},\n);\n\nfunction padL(l: number) {\n  const m = l % 4;\n  return m ? 4 - m : 0;\n}\n\nfunction encodeParams(params: [number, Buffer][]) {\n  let body = Buffer.from(\"\");\n  let padding = Buffer.from(\"\");\n  params.forEach(([type, value]) => {\n    const length = value.length + 4;\n    const paramHeader = Buffer.alloc(4);\n    paramHeader.writeUInt16BE(type, 0);\n    paramHeader.writeUInt16BE(length, 2);\n    body = Buffer.concat([body, padding, paramHeader, value]);\n    padding = Buffer.concat(\n      [...Array(padL(length))].map(() => Buffer.from(\"\\x00\")),\n    );\n  });\n  return body;\n}\n\nexport function decodeParams(body: Buffer): [number, Buffer][] {\n  const params: [number, Buffer][] = [];\n  let pos = 0;\n  while (pos <= body.length - 4) {\n    const type = body.readUInt16BE(pos);\n    const length = body.readUInt16BE(pos + 2);\n    params.push([type, body.slice(pos + 4, pos + length)]);\n    pos += length + padL(length);\n  }\n  return params;\n}\n\nexport function parsePacket(data: Buffer): [number, number, number, Chunk[]] {\n  if (data.length < 12)\n    throw new Error(\"SCTP packet length is less than 12 bytes\");\n\n  const sourcePort = data.readUInt16BE(0);\n  const destinationPort = data.readUInt16BE(2);\n  const verificationTag = data.readUInt32BE(4);\n\n  const checkSum = data.readUInt32LE(8);\n\n  const expect = crc32c(\n    Buffer.concat([\n      data.slice(0, 8),\n      Buffer.from(\"\\x00\\x00\\x00\\x00\"),\n      data.slice(12),\n    ]),\n  );\n\n  if (checkSum !== expect) throw new Error(\"SCTP packet has invalid checksum\");\n\n  const chunks: Chunk[] = [];\n  let pos = 12;\n  while (pos + 4 <= data.length) {\n    const chunkType = data.readUInt8(pos);\n    const chunkFlags = data.readUInt8(pos + 1);\n    const chunkLength = data.readUInt16BE(pos + 2);\n    const chunkBody = data.slice(pos + 4, pos + chunkLength);\n    const ChunkClass = CHUNK_BY_TYPE[chunkType.toString()];\n    if (ChunkClass) {\n      chunks.push(new ChunkClass(chunkFlags, chunkBody));\n    } else {\n      throw new Error(\"unknown\");\n    }\n    pos += chunkLength + padL(chunkLength);\n  }\n  return [sourcePort, destinationPort, verificationTag, chunks];\n}\n\nexport function serializePacket(\n  sourcePort: number,\n  destinationPort: number,\n  verificationTag: number,\n  chunk: Chunk,\n) {\n  const header = Buffer.alloc(8);\n  header.writeUInt16BE(sourcePort, 0);\n  header.writeUInt16BE(destinationPort, 2);\n  header.writeUInt32BE(verificationTag, 4);\n\n  const body = chunk.bytes;\n\n  const checksum: number = crc32c(\n    Buffer.concat([header, Buffer.from(\"\\x00\\x00\\x00\\x00\"), body]),\n  );\n  const checkSumBuf = Buffer.alloc(4);\n  checkSumBuf.writeUInt32LE(checksum, 0);\n\n  const packet = Buffer.concat([header, checkSumBuf, body]);\n\n  return packet;\n}\n","import { randomBytes } from \"crypto\";\n\nimport { Event } from \"./imports/common\";\n\nexport function randomString(length: number) {\n  return randomBytes(length).toString(\"hex\").substring(0, length);\n}\n\nexport function randomTransactionId() {\n  return randomBytes(12);\n}\n\nexport function bufferXor(a: Buffer, b: Buffer): Buffer {\n  if (a.length !== b.length) {\n    throw new TypeError(\n      \"[webrtc-stun] You can not XOR buffers which length are different\",\n    );\n  }\n\n  const length = a.length;\n  const buffer = Buffer.allocUnsafe(length);\n\n  for (let i = 0; i < length; i++) {\n    buffer[i] = a[i] ^ b[i];\n  }\n\n  return buffer;\n}\n\nexport function difference<T>(x: Set<T>, y: Set<T>) {\n  return new Set([...x].filter((e) => !y.has(e)));\n}\n\n// infinite size queue\nexport class PQueue<T> {\n  private queue: Promise<T>[] = [];\n  private wait = new Event<[Promise<T>]>();\n\n  put(v: Promise<T>) {\n    this.queue.push(v);\n    if (this.queue.length === 1) {\n      this.wait.execute(v);\n    }\n  }\n\n  get(): Promise<T> {\n    const v = this.queue.shift();\n    if (!v) {\n      return new Promise((r) => {\n        this.wait.subscribe((v) => {\n          this.queue.shift();\n          r(v);\n        });\n      });\n    }\n    return v!;\n  }\n}\n\nexport const cancelable = <T>(\n  ex: (\n    resolve: (value: T | PromiseLike<T>) => void,\n    reject: (reason?: any) => void,\n    onCancel: Event<[any]>,\n  ) => Promise<void>,\n) => {\n  let resolve!: (value: T | PromiseLike<T>) => void;\n  let reject!: (reason?: any) => void;\n\n  const p = new Promise<T>((r, f) => {\n    resolve = r;\n    reject = f;\n  });\n  p.then(() => {\n    onCancel.execute(undefined);\n    onCancel.complete();\n  }).catch((e) => {\n    onCancel.execute(e ?? new Error());\n    onCancel.complete();\n  });\n\n  const onCancel = new Event<[any]>();\n\n  ex(resolve, reject, onCancel).catch(() => {});\n\n  return { awaitable: p, resolve, reject };\n};\n\nexport type Cancelable<T> = ReturnType<typeof cancelable<T>>;\n","'use strict';\n\nconst { isUserType, isType } = require('lib/util');\nconst Metadata = require('internal/meta');\nconst symbols = require('internal/symbols');\n\nmodule.exports = {\n  encodingLength,\n  encodingLengthCommon,\n};\n\n/**\n * Get the number of bytes to encode `obj` using `schema`.\n * @param {*} obj Any valid js object.\n * @param {Object} schema\n * @returns {number}\n */\nfunction encodingLength(obj, schema) {\n  const context = new Metadata();\n\n  encodingLengthCommon(obj, schema, context);\n  Metadata.clean(context);\n\n  return context.bytes;\n}\n\n/**\n * @param {any} item\n * @param {Object} typeOrSchema\n * @param {Metadata} context\n */\nfunction encodingLengthCommon(item, typeOrSchema, context) {\n  if (isType(typeOrSchema)) {\n    context[symbols.bytes] += typeOrSchema.encodingLength.call(context, item);\n  } else {\n    encodingLengthSchema(item, typeOrSchema, context);\n  }\n}\n\n/**\n * @param {any} item\n * @param {Object} schema\n * @param {Metadata} context\n */\nfunction encodingLengthSchema(item, schema, context) {\n  if (!isUserType(schema)) {\n    throw new TypeError('Argument `schema` should be a plain object.');\n  }\n\n  if (context.node === undefined) {\n    context.node = item;\n    context.current = item;\n  } else {\n    context.current = item;\n  }\n\n  const keys = Object.keys(schema);\n\n  for (let i = 0; i < keys.length; i += 1) {\n    const key = keys[i];\n    const type = schema[key];\n    const value = item[key];\n\n    if (!isType(type)) {\n      encodingLengthSchema(value, type, context);\n      context.current = item;\n      continue; // eslint-disable-line no-continue\n    }\n\n    context[symbols.bytes] += type.encodingLength.call(context, value);\n  }\n}\n","import type { SrtpProfile } from \"../imports/rtp\";\n\nexport class SrtpContext {\n  srtpProfile?: SrtpProfile;\n\n  static findMatchingSRTPProfile(remote: SrtpProfile[], local: SrtpProfile[]) {\n    for (const v of local) {\n      if (remote.includes(v)) return v;\n    }\n  }\n}\n","import { randomBytes } from \"crypto\";\n\nimport {\n  CipherSuite,\n  NamedCurveAlgorithmList,\n  type NamedCurveAlgorithms,\n  SignatureAlgorithm,\n} from \"../../cipher/const\";\nimport { generateKeyPair } from \"../../cipher/namedCurve\";\nimport type { CipherContext } from \"../../context/cipher\";\nimport type { DtlsContext } from \"../../context/dtls\";\nimport { SrtpContext } from \"../../context/srtp\";\nimport type { TransportContext } from \"../../context/transport\";\nimport { EllipticCurves } from \"../../handshake/extensions/ellipticCurves\";\nimport { ExtendedMasterSecret } from \"../../handshake/extensions/extendedMasterSecret\";\nimport { RenegotiationIndication } from \"../../handshake/extensions/renegotiationIndication\";\nimport { Signature } from \"../../handshake/extensions/signature\";\nimport { UseSRTP } from \"../../handshake/extensions/useSrtp\";\nimport type { ClientHello } from \"../../handshake/message/client/hello\";\nimport { ServerHelloVerifyRequest } from \"../../handshake/message/server/helloVerifyRequest\";\nimport { DtlsRandom } from \"../../handshake/random\";\nimport { type SrtpProfile, debug } from \"../../imports/rtp\";\nimport { createFragments, createPlaintext } from \"../../record/builder\";\nimport { ContentType } from \"../../record/const\";\n\nconst log = debug(\"werift-dtls : packages/dtls/flight/server/flight2.ts : log\");\n\n// HelloVerifyRequest do not retransmit\n\nexport const flight2 =\n  (\n    udp: TransportContext,\n    dtls: DtlsContext,\n    cipher: CipherContext,\n    srtp: SrtpContext,\n  ) =>\n  (clientHello: ClientHello) => {\n    log(\"dtls version\", clientHello.clientVersion);\n\n    dtls.flight = 2;\n\n    // if flight 2 restarts due to packet loss, sequence numbers are reused from the top:\n    // https://datatracker.ietf.org/doc/html/rfc6347#section-4.2.2\n    // The first message each side transmits in each handshake always has\n    // message_seq = 0.  Whenever each new message is generated, the\n    // message_seq value is incremented by one.  Note that in the case of a\n    // rehandshake, this implies that the HelloRequest will have message_seq = 0\n    // and the ServerHello will have message_seq = 1.  When a message is\n    // retransmitted, the same message_seq value is used.\n    dtls.recordSequenceNumber = 0;\n    dtls.sequenceNumber = 0;\n\n    clientHello.extensions.forEach((extension) => {\n      switch (extension.type) {\n        case EllipticCurves.type:\n          {\n            const curves = EllipticCurves.fromData(extension.data).data;\n            log(dtls.sessionId, \"curves\", curves);\n            const curve = curves.filter((curve) =>\n              NamedCurveAlgorithmList.includes(curve as any),\n            )[0] as NamedCurveAlgorithms;\n            cipher.namedCurve = curve;\n            log(dtls.sessionId, \"curve selected\", cipher.namedCurve);\n          }\n          break;\n        case Signature.type:\n          {\n            if (!cipher.signatureHashAlgorithm)\n              throw new Error(\"need to set certificate\");\n\n            const signatureHash = Signature.fromData(extension.data).data;\n            log(dtls.sessionId, \"hash,signature\", signatureHash);\n            const signature = signatureHash.find(\n              (v) => v.signature === cipher.signatureHashAlgorithm?.signature,\n            )?.signature;\n            const hash = signatureHash.find(\n              (v) => v.hash === cipher.signatureHashAlgorithm?.hash,\n            )?.hash;\n            if (signature == undefined || hash == undefined) {\n              throw new Error(\"invalid signatureHash\");\n            }\n          }\n          break;\n        case UseSRTP.type:\n          {\n            if (!dtls.options?.srtpProfiles) return;\n            if (dtls.options.srtpProfiles.length === 0) return;\n\n            const useSrtp = UseSRTP.fromData(extension.data);\n            log(dtls.sessionId, \"srtp profiles\", useSrtp.profiles);\n            const profile = SrtpContext.findMatchingSRTPProfile(\n              useSrtp.profiles as SrtpProfile[],\n              dtls.options?.srtpProfiles,\n            );\n            if (!profile) {\n              throw new Error();\n            }\n            srtp.srtpProfile = profile;\n            log(dtls.sessionId, \"srtp profile selected\", srtp.srtpProfile);\n          }\n          break;\n        case ExtendedMasterSecret.type:\n          {\n            dtls.remoteExtendedMasterSecret = true;\n          }\n          break;\n        case RenegotiationIndication.type:\n          {\n            log(dtls.sessionId, \"RenegotiationIndication\", extension.data);\n          }\n          break;\n        case 43:\n          {\n            // todo dtls1.3\n            const data = extension.data.subarray(1);\n            const versions = [...data].map((v) => v.toString(10));\n            log(\"dtls supported version\", versions);\n          }\n          break;\n      }\n    });\n\n    cipher.localRandom = new DtlsRandom();\n    cipher.remoteRandom = DtlsRandom.from(clientHello.random);\n\n    const suites = clientHello.cipherSuites;\n    log(dtls.sessionId, \"cipher suites\", suites);\n    const suite = (() => {\n      switch (cipher.signatureHashAlgorithm?.signature) {\n        case SignatureAlgorithm.ecdsa_3:\n          return CipherSuite.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_49195;\n        case SignatureAlgorithm.rsa_1:\n          return CipherSuite.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_49199;\n      }\n    })();\n    if (suite === undefined || !suites.includes(suite)) {\n      throw new Error(\"dtls cipher suite negotiation failed\");\n    }\n    cipher.cipherSuite = suite;\n    log(dtls.sessionId, \"selected cipherSuite\", cipher.cipherSuite);\n\n    cipher.localKeyPair = generateKeyPair(cipher.namedCurve);\n\n    dtls.cookie ||= randomBytes(20);\n    const helloVerifyReq = new ServerHelloVerifyRequest(\n      {\n        major: 255 - 1,\n        minor: 255 - 2,\n      },\n      dtls.cookie,\n    );\n    const fragments = createFragments(dtls)([helloVerifyReq]);\n    const packets = createPlaintext(dtls)(\n      fragments.map((fragment) => ({\n        type: ContentType.handshake,\n        fragment: fragment.serialize(),\n      })),\n      ++dtls.recordSequenceNumber,\n    );\n\n    const chunk = packets.map((v) => v.serialize());\n    for (const buf of chunk) {\n      udp.send(buf);\n    }\n  };\n","export function addVideoFilterArguments(videoArgs: string[], videoFilter: string, filterName = 'unfilteredRecording') {\n    const filterIndex = videoArgs.findIndex(f => f === '-filter_complex');\n    if (filterIndex !== undefined && filterIndex !== -1)\n        videoArgs[filterIndex + 1] = videoArgs[filterIndex + 1] + `[${filterName}] ; [${filterName}] ${videoFilter}`;\n    else\n        videoArgs.push('-filter_complex', videoFilter);\n}\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/x509\n//\n// **License:** MIT\nconst util_1 = require(\"util\");\nconst crypto_1 = require(\"crypto\");\nconst tweetnacl_1 = require(\"tweetnacl\");\nconst asn1_1 = require(\"@fidm/asn1\");\nconst common_1 = require(\"./common\");\n/**\n * ASN.1 Template for PKCS#8 Public Key.\n */\nexports.publicKeyValidator = {\n    name: 'PublicKeyInfo',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.SEQUENCE,\n    capture: 'publicKeyInfo',\n    value: [{\n            name: 'PublicKeyInfo.AlgorithmIdentifier',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.SEQUENCE,\n            value: [{\n                    name: 'PublicKeyAlgorithmIdentifier.algorithm',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.OID,\n                    capture: 'publicKeyOID',\n                }],\n        }, {\n            name: 'PublicKeyInfo.PublicKey',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.BITSTRING,\n            capture: 'publicKey',\n        }],\n};\n/**\n * ASN.1 Template for PKCS#8 Private Key. https://tools.ietf.org/html/rfc5208\n */\nexports.privateKeyValidator = {\n    name: 'PrivateKeyInfo',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.SEQUENCE,\n    capture: 'privateKeyInfo',\n    value: [{\n            name: 'PrivateKeyInfo.Version',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyVersion',\n        }, {\n            name: 'PrivateKeyInfo.AlgorithmIdentifier',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.SEQUENCE,\n            value: [{\n                    name: 'PrivateKeyAlgorithmIdentifier.algorithm',\n                    class: asn1_1.Class.UNIVERSAL,\n                    tag: asn1_1.Tag.OID,\n                    capture: 'privateKeyOID',\n                }],\n        }, {\n            name: 'PrivateKeyInfo.PrivateKey',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.OCTETSTRING,\n            capture: 'privateKey',\n        }],\n};\n// validator for an RSA public key\nconst rsaPublicKeyValidator = {\n    // RSAPublicKey\n    name: 'RSAPublicKey',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.SEQUENCE,\n    value: [{\n            // modulus (n)\n            name: 'RSAPublicKey.modulus',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'publicKeyModulus',\n        }, {\n            // publicExponent (e)\n            name: 'RSAPublicKey.exponent',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'publicKeyExponent',\n        }],\n};\nconst rsaPrivateKeyValidator = {\n    // RSAPrivateKey\n    name: 'RSAPrivateKey',\n    class: asn1_1.Class.UNIVERSAL,\n    tag: asn1_1.Tag.SEQUENCE,\n    value: [{\n            // Version (INTEGER)\n            name: 'RSAPrivateKey.version',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyVersion',\n        }, {\n            // modulus (n)\n            name: 'RSAPrivateKey.modulus',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyModulus',\n        }, {\n            // publicExponent (e)\n            name: 'RSAPrivateKey.publicExponent',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyPublicExponent',\n        }, {\n            // privateExponent (d)\n            name: 'RSAPrivateKey.privateExponent',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyPrivateExponent',\n        }, {\n            // prime1 (p)\n            name: 'RSAPrivateKey.prime1',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyPrime1',\n        }, {\n            // prime2 (q)\n            name: 'RSAPrivateKey.prime2',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyPrime2',\n        }, {\n            // exponent1 (d mod (p-1))\n            name: 'RSAPrivateKey.exponent1',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyExponent1',\n        }, {\n            // exponent2 (d mod (q-1))\n            name: 'RSAPrivateKey.exponent2',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyExponent2',\n        }, {\n            // coefficient ((inverse of q) mod p)\n            name: 'RSAPrivateKey.coefficient',\n            class: asn1_1.Class.UNIVERSAL,\n            tag: asn1_1.Tag.INTEGER,\n            capture: 'privateKeyCoefficient',\n        }],\n};\nconst EdDSAPrivateKeyOIDs = [\n    // https://tools.ietf.org/html/draft-ietf-curdle-pkix-10\n    common_1.getOID('X25519'),\n    common_1.getOID('X448'),\n    common_1.getOID('Ed25519'),\n    common_1.getOID('Ed448'),\n];\n/**\n * PKCS#8 Public Key\n */\nclass PublicKey {\n    constructor(obj) {\n        const captures = {};\n        const err = obj.validate(exports.publicKeyValidator, captures);\n        if (err != null) {\n            throw new Error('Cannot read X.509 public key: ' + err.message);\n        }\n        this.oid = asn1_1.ASN1.parseOID(captures.publicKeyOID.bytes);\n        this.algo = common_1.getOIDName(this.oid);\n        this._pkcs8 = obj;\n        this._keyRaw = asn1_1.ASN1.parseBitString(captures.publicKey.bytes).buf;\n        this._finalKey = this._keyRaw;\n        this._finalPEM = '';\n    }\n    /**\n     * Parse an PublicKey for X.509 certificate from PKCS#8 PEM formatted buffer or PKCS#1 RSA PEM formatted buffer.\n     * @param pem PEM formatted buffer\n     */\n    static fromPEM(pem) {\n        const msg = asn1_1.PEM.parse(pem)[0];\n        if (msg.procType.includes('ENCRYPTED')) {\n            throw new Error('Could not convert public key from PEM, PEM is encrypted.');\n        }\n        const obj = asn1_1.ASN1.fromDER(msg.body, true);\n        switch (msg.type) {\n            case 'PUBLIC KEY': // PKCS#8\n                return new PublicKey(obj);\n            case 'RSA PUBLIC KEY': // PKCS#1\n                const _pkcs8 = asn1_1.ASN1.Seq([\n                    // AlgorithmIdentifier\n                    asn1_1.ASN1.Seq([\n                        // algorithm\n                        asn1_1.ASN1.OID(common_1.getOID('rsaEncryption')),\n                        // optional parameters\n                        asn1_1.ASN1.Null(),\n                    ]),\n                    // PublicKey\n                    asn1_1.ASN1.BitString(obj.DER),\n                ]);\n                return new PublicKey(_pkcs8);\n            default:\n                throw new Error('Could not convert public key from PEM, recommend PKCS#8 PEM');\n        }\n    }\n    /**\n     * Registers an external Verifier with object identifier.\n     * Built-in verifiers: Ed25519, RSA, others see https://nodejs.org/api/crypto.html#crypto_class_verify\n     * ```js\n     * PublicKey.addVerifier(getOID('Ed25519'), function (this: PublicKey, data: Buffer, signature: Buffer): boolean {\n     *   return ed25519.detached.verify(data, signature, this.keyRaw)\n     * })\n     * ```\n     * @param oid algorithm object identifier\n     * @param fn Verifier function\n     */\n    static addVerifier(oid, fn) {\n        oid = common_1.getOID(oid);\n        if (oid === '') {\n            throw new Error(`Invalid object identifier: ${oid}`);\n        }\n        if (PublicKey._verifiers[oid] != null) {\n            throw new Error(`Verifier ${oid} exists`);\n        }\n        PublicKey._verifiers[oid] = fn;\n    }\n    /**\n     * underlying key buffer\n     */\n    get keyRaw() {\n        return this._finalKey;\n    }\n    /**\n     * Returns true if the provided data and the given signature matched.\n     * ```js\n     * certificate.publicKey.verify(data, signature, 'sha256') // => true or false\n     * ```\n     * @param data data to verify\n     * @param signature signature that signed by private key\n     * @param hashAlgorithm hash algorithm, such as 'sha256', 'sha1'\n     */\n    verify(data, signature, hashAlgorithm) {\n        const verifier = PublicKey._verifiers[this.oid];\n        if (verifier != null) {\n            const sum = crypto_1.createHash(hashAlgorithm).update(data).digest();\n            return verifier.call(this, sum, signature);\n        }\n        const verify = crypto_1.createVerify(hashAlgorithm);\n        verify.update(data);\n        return verify.verify(this.toPEM(), signature);\n    }\n    /**\n     * Returns the digest of the PublicKey with given hash algorithm.\n     * ```js\n     * certificate.publicKey.getFingerprint('sha1', 'PublicKey') // => Buffer\n     * ```\n     * @param hashAlgorithm hash algorithm, such as 'sha256', 'sha1'\n     * @param type 'PublicKey' or 'PublicKeyInfo'\n     */\n    getFingerprint(hashAlgorithm, type = 'PublicKey') {\n        let bytes;\n        switch (type) {\n            case 'PublicKeyInfo':\n                bytes = this._pkcs8.DER;\n                break;\n            case 'PublicKey':\n                bytes = this._keyRaw;\n                break;\n            default:\n                throw new Error(`Unknown fingerprint type \"${type}\".`);\n        }\n        const hasher = crypto_1.createHash(hashAlgorithm);\n        hasher.update(bytes);\n        return hasher.digest();\n    }\n    /**\n     * Returns an ASN.1 object of this PublicKey\n     */\n    toASN1() {\n        return this._pkcs8;\n    }\n    /**\n     * Returns an DER formatted buffer of this PublicKey\n     */\n    toDER() {\n        return this._pkcs8.DER;\n    }\n    /**\n     * Returns an PEM formatted string of this PublicKey\n     */\n    toPEM() {\n        if (this._finalPEM === '') {\n            this._finalPEM = new asn1_1.PEM('PUBLIC KEY', this._pkcs8.DER).toString();\n        }\n        return this._finalPEM;\n    }\n    /**\n     * Return a friendly JSON object for debuging.\n     */\n    toJSON() {\n        return {\n            oid: this.oid,\n            algo: this.algo,\n            publicKey: this._keyRaw,\n        };\n    }\n    [util_1.inspect.custom](_depth, options) {\n        return `<${this.constructor.name} ${util_1.inspect(this.toJSON(), options)}>`;\n    }\n}\nPublicKey._verifiers = Object.create(null);\nexports.PublicKey = PublicKey;\n/**\n * PKCS#8 Private Key\n */\nclass PrivateKey {\n    constructor(obj) {\n        // get RSA params\n        const captures = Object.create(null);\n        const err = obj.validate(exports.privateKeyValidator, captures);\n        if (err != null) {\n            throw new Error('Cannot read X.509 private key: ' + err.message);\n        }\n        this.version = asn1_1.ASN1.parseIntegerNum(captures.privateKeyVersion.bytes) + 1;\n        this.oid = asn1_1.ASN1.parseOID(captures.privateKeyOID.bytes);\n        this.algo = common_1.getOIDName(this.oid);\n        this._pkcs8 = obj;\n        this._keyRaw = captures.privateKey.bytes;\n        this._publicKeyRaw = null;\n        this._finalKey = this._keyRaw;\n        this._finalPEM = '';\n        if (EdDSAPrivateKeyOIDs.includes(this.oid)) {\n            this._finalKey = this._keyRaw = asn1_1.ASN1.parseDER(this._keyRaw, asn1_1.Class.UNIVERSAL, asn1_1.Tag.OCTETSTRING).bytes;\n            if (this.oid === '1.3.101.112') {\n                const keypair = tweetnacl_1.sign.keyPair.fromSeed(this._keyRaw);\n                this._publicKeyRaw = Buffer.from(keypair.publicKey);\n                this._finalKey = Buffer.from(keypair.secretKey);\n            }\n            else if (this.version === 2) {\n                for (const val of obj.mustCompound()) {\n                    if (val.class === asn1_1.Class.CONTEXT_SPECIFIC && val.tag === 1) {\n                        this._publicKeyRaw = asn1_1.ASN1.parseBitString(val.bytes).buf;\n                        this._finalKey = Buffer.concat([this._keyRaw, this._publicKeyRaw]);\n                    }\n                }\n            }\n        }\n    }\n    /**\n     * Parse an PrivateKey for X.509 certificate from PKCS#8 PEM formatted buffer or PKCS#1 RSA PEM formatted buffer.\n     * @param pem PEM formatted buffer\n     */\n    static fromPEM(pem) {\n        const msg = asn1_1.PEM.parse(pem)[0];\n        if (msg.procType.includes('ENCRYPTED')) {\n            throw new Error('Could not convert private key from PEM, PEM is encrypted.');\n        }\n        let obj = asn1_1.ASN1.fromDER(msg.body, true);\n        switch (msg.type) {\n            case 'PRIVATE KEY': // PKCS#8\n                return new PrivateKey(obj);\n            case 'RSA PRIVATE KEY': // PKCS#1\n                obj = asn1_1.ASN1.Seq([\n                    // Version (INTEGER)\n                    obj.value[0],\n                    // AlgorithmIdentifier\n                    asn1_1.ASN1.Seq([\n                        // algorithm\n                        asn1_1.ASN1.OID(common_1.getOID('rsaEncryption')),\n                        // optional parameters\n                        asn1_1.ASN1.Null(),\n                    ]),\n                    // PrivateKey\n                    new asn1_1.ASN1(asn1_1.Class.UNIVERSAL, asn1_1.Tag.OCTETSTRING, obj.DER),\n                ]);\n                return new PrivateKey(obj);\n            default:\n                throw new Error('Could not convert private key from PEM, recommend PKCS#8 PEM');\n        }\n    }\n    /**\n     * Registers an external Signer with object identifier.\n     * Built-in verifiers: Ed25519, RSA, others see https://nodejs.org/api/crypto.html#crypto_class_sign\n     * ```js\n     * PrivateKey.addSigner(getOID('Ed25519'), function (this: PrivateKey, data: Buffer): Buffer {\n     *   const key = this.keyRaw\n     *   if (key.length !== 64) {\n     *     throw new Error('Invalid signing key.')\n     *   }\n     *   return Buffer.from(ed25519.detached(data, key))\n     * })\n     * ```\n     * @param oid algorithm object identifier\n     * @param fn Verifier function\n     */\n    static addSigner(oid, fn) {\n        oid = common_1.getOID(oid);\n        if (oid === '') {\n            throw new Error(`Invalid object identifier: ${oid}`);\n        }\n        if (PrivateKey._signers[oid] != null) {\n            throw new Error(`Signer ${oid} exists`);\n        }\n        PrivateKey._signers[oid] = fn;\n    }\n    /**\n     * underlying key buffer\n     */\n    get keyRaw() {\n        return this._finalKey;\n    }\n    /**\n     * Returns publicKey buffer, it is used for Ed25519/Ed448.\n     */\n    get publicKeyRaw() {\n        return this._publicKeyRaw;\n    }\n    /**\n     * Returns signature for the given data and hash algorithm.\n     * @param data\n     * @param hashAlgorithm\n     */\n    sign(data, hashAlgorithm) {\n        const signer = PrivateKey._signers[this.oid];\n        if (signer != null) {\n            const sum = crypto_1.createHash(hashAlgorithm).update(data).digest();\n            return signer.call(this, sum);\n        }\n        const sign = crypto_1.createSign(hashAlgorithm);\n        sign.update(data);\n        return sign.sign(this.toPEM());\n    }\n    /**\n     * Returns an ASN.1 object of this PrivateKey\n     */\n    toASN1() {\n        return this._pkcs8;\n    }\n    /**\n     * Returns an DER formatted buffer of this PrivateKey\n     */\n    toDER() {\n        return this._pkcs8.DER;\n    }\n    /**\n     * Returns an PEM formatted string of this PrivateKey\n     */\n    toPEM() {\n        if (this._finalPEM === '') {\n            this._finalPEM = new asn1_1.PEM('PRIVATE KEY', this._pkcs8.DER).toString();\n        }\n        return this._finalPEM;\n    }\n    /**\n     * Return a friendly JSON object for debuging.\n     */\n    toJSON() {\n        return {\n            version: this.version,\n            oid: this.oid,\n            algo: this.algo,\n            privateKey: this._keyRaw,\n            publicKey: this._publicKeyRaw,\n        };\n    }\n    [util_1.inspect.custom](_depth, options) {\n        return `<${this.constructor.name} ${util_1.inspect(this.toJSON(), options)}>`;\n    }\n}\nPrivateKey._signers = Object.create(null);\nexports.PrivateKey = PrivateKey;\n/**\n * PKCS#1 RSA Public Key\n */\nclass RSAPublicKey extends PublicKey {\n    static fromPublicKey(publicKey) {\n        return new RSAPublicKey(publicKey.toASN1());\n    }\n    constructor(obj) {\n        super(obj);\n        if (common_1.getOID(this.oid) !== common_1.getOID('rsaEncryption')) {\n            throw new Error(`Invalid RSA public key, unknown OID: ${this.oid}`);\n        }\n        // get RSA params\n        const captures = Object.create(null);\n        this._pkcs1 = asn1_1.ASN1.fromDER(this._keyRaw, true);\n        const err = this._pkcs1.validate(rsaPublicKeyValidator, captures);\n        if (err != null) {\n            throw new Error('Cannot read RSA public key: ' + err.message);\n        }\n        this.modulus = asn1_1.ASN1.parseIntegerStr(captures.publicKeyModulus.bytes);\n        this.exponent = asn1_1.ASN1.parseIntegerNum(captures.publicKeyExponent.bytes);\n    }\n    /**\n     * Returns an PKCS#1 ASN.1 object of this RSAPublicKey\n     */\n    toASN1() {\n        return this._pkcs1;\n    }\n    /**\n     * Returns an PKCS#1 DER formatted buffer of this RSAPublicKey\n     */\n    toDER() {\n        return this._keyRaw;\n    }\n    /**\n     * Returns an PKCS#1 PEM formatted string of this RSAPublicKey\n     */\n    toPEM() {\n        if (this._finalPEM === '') {\n            this._finalPEM = new asn1_1.PEM('RSA PUBLIC KEY', this._keyRaw).toString();\n        }\n        return this._finalPEM;\n    }\n    /**\n     * Returns an PKCS#8 PEM formatted string of this RSAPublicKey\n     */\n    toPublicKeyPEM() {\n        return new asn1_1.PEM('PUBLIC KEY', this._pkcs8.DER).toString();\n    }\n    /**\n     * Return a friendly JSON object for debuging.\n     */\n    toJSON() {\n        return {\n            oid: this.oid,\n            algo: this.algo,\n            modulus: trimLeadingZeroByte(this.modulus),\n            exponent: this.exponent,\n        };\n    }\n    [util_1.inspect.custom](_depth, options) {\n        return `<${this.constructor.name} ${util_1.inspect(this.toJSON(), options)}>`;\n    }\n}\nexports.RSAPublicKey = RSAPublicKey;\n/**\n * PKCS#1 RSA Private Key\n */\nclass RSAPrivateKey extends PrivateKey {\n    static fromPrivateKey(privateKey) {\n        return new RSAPrivateKey(privateKey.toASN1());\n    }\n    constructor(obj) {\n        super(obj);\n        if (common_1.getOID(this.oid) !== common_1.getOID('rsaEncryption')) {\n            throw new Error(`Invalid RSA private key, unknown OID: ${this.oid}`);\n        }\n        // get RSA params\n        const captures = Object.create(null);\n        this._pkcs1 = asn1_1.ASN1.fromDER(this._keyRaw, true);\n        const err = this._pkcs1.validate(rsaPrivateKeyValidator, captures);\n        if (err != null) {\n            throw new Error('Cannot read RSA private key: ' + err.message);\n        }\n        this.publicExponent = asn1_1.ASN1.parseIntegerNum(captures.privateKeyPublicExponent.bytes);\n        this.privateExponent = asn1_1.ASN1.parseIntegerStr(captures.privateKeyPrivateExponent.bytes);\n        this.modulus = asn1_1.ASN1.parseIntegerStr(captures.privateKeyModulus.bytes);\n        this.prime1 = asn1_1.ASN1.parseIntegerStr(captures.privateKeyPrime1.bytes);\n        this.prime2 = asn1_1.ASN1.parseIntegerStr(captures.privateKeyPrime2.bytes);\n        this.exponent1 = asn1_1.ASN1.parseIntegerStr(captures.privateKeyExponent1.bytes);\n        this.exponent2 = asn1_1.ASN1.parseIntegerStr(captures.privateKeyExponent2.bytes);\n        this.coefficient = asn1_1.ASN1.parseIntegerStr(captures.privateKeyCoefficient.bytes);\n    }\n    /**\n     * Returns an PKCS#1 ASN.1 object of this RSAPrivateKey\n     */\n    toASN1() {\n        return this._pkcs1;\n    }\n    /**\n     * Returns an PKCS#1 DER formatted buffer of this RSAPrivateKey\n     */\n    toDER() {\n        return this._keyRaw;\n    }\n    /**\n     * Returns an PKCS#1 PEM formatted string of this RSAPrivateKey\n     */\n    toPEM() {\n        if (this._finalPEM === '') {\n            this._finalPEM = new asn1_1.PEM('RSA PRIVATE KEY', this._keyRaw).toString();\n        }\n        return this._finalPEM;\n    }\n    /**\n     * Returns an PKCS#8 PEM formatted string of this RSAPrivateKey\n     */\n    toPrivateKeyPEM() {\n        return new asn1_1.PEM('PRIVATE KEY', this._pkcs8.DER).toString();\n    }\n    /**\n     * Return a friendly JSON object for debuging.\n     */\n    toJSON() {\n        return {\n            version: this.version,\n            oid: this.oid,\n            algo: this.algo,\n            publicExponent: this.publicExponent,\n            privateExponent: trimLeadingZeroByte(this.privateExponent),\n            modulus: trimLeadingZeroByte(this.modulus),\n            prime1: trimLeadingZeroByte(this.prime1),\n            prime2: trimLeadingZeroByte(this.prime2),\n            exponent1: trimLeadingZeroByte(this.exponent1),\n            exponent2: trimLeadingZeroByte(this.exponent2),\n            coefficient: trimLeadingZeroByte(this.coefficient),\n        };\n    }\n    [util_1.inspect.custom](_depth, options) {\n        return `<${this.constructor.name} ${util_1.inspect(this.toJSON(), options)}>`;\n    }\n}\nexports.RSAPrivateKey = RSAPrivateKey;\n// leading 00 byte is signed representation for BigInteger\n// https://stackoverflow.com/questions/8515691/getting-1-byte-extra-in-the-modulus-rsa-key-and-sometimes-for-exponents-also\nfunction trimLeadingZeroByte(hex) {\n    return (hex.length % 8 !== 0) && hex.startsWith('00') ? hex.slice(2) : hex;\n}\nPublicKey.addVerifier(common_1.getOID('Ed25519'), function (data, signature) {\n    return tweetnacl_1.sign.detached.verify(data, signature, this.keyRaw);\n});\nPrivateKey.addSigner(common_1.getOID('Ed25519'), function (data) {\n    const key = this.keyRaw;\n    if (key.length !== 64) {\n        throw new Error('Invalid signing key.');\n    }\n    return Buffer.from(tweetnacl_1.sign.detached(data, key));\n});\n//# sourceMappingURL=pki.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StorageSettings = void 0;\nconst _1 = __importStar(require(\".\"));\nconst { systemManager } = _1.default;\nfunction parseValue(value, setting, readDefaultValue, rawDevice) {\n    if (value === null || value === undefined) {\n        return readDefaultValue();\n    }\n    const type = setting.multiple ? 'array' : setting.type;\n    if (type === 'boolean') {\n        if (value === 'true')\n            return true;\n        if (value === 'false')\n            return false;\n        return readDefaultValue() || false;\n    }\n    if (type === 'number') {\n        const n = parseFloat(value);\n        if (!isNaN(n))\n            return n;\n        return readDefaultValue() || 0;\n    }\n    if (type === 'integer') {\n        const n = parseInt(value);\n        if (!isNaN(n))\n            return n;\n        return readDefaultValue() || 0;\n    }\n    if (type === 'array') {\n        if (!value)\n            return readDefaultValue() || [];\n        try {\n            return JSON.parse(value);\n        }\n        catch (e) {\n            return readDefaultValue() || [];\n        }\n    }\n    if (type === 'device') {\n        if (rawDevice)\n            return value;\n        return systemManager.getDeviceById(value) || systemManager.getDeviceById(readDefaultValue());\n    }\n    // string type, so check if it is json.\n    if (value && setting.json) {\n        try {\n            return JSON.parse(value);\n        }\n        catch (e) {\n            return readDefaultValue();\n        }\n    }\n    return value || readDefaultValue();\n}\nclass StorageSettings {\n    constructor(device, settings) {\n        this.device = device;\n        this.settings = settings;\n        this.values = {};\n        this.hasValue = {};\n        for (const key of Object.keys(settings)) {\n            const setting = settings[key];\n            const rawGet = () => this.getItem(key);\n            let get;\n            if (setting.type !== 'clippath') {\n                get = rawGet;\n            }\n            else {\n                // maybe need a mapPut. clippath is the only complex type at the moment.\n                get = () => {\n                    try {\n                        return JSON.parse(rawGet());\n                    }\n                    catch (e) {\n                    }\n                };\n            }\n            Object.defineProperty(this.values, key, {\n                get,\n                set: value => this.putSetting(key, value),\n                enumerable: true,\n            });\n            Object.defineProperty(this.hasValue, key, {\n                get: () => this.device.storage.getItem(key) != null,\n                enumerable: true,\n            });\n        }\n    }\n    get keys() {\n        const ret = {};\n        for (const key of Object.keys(this.settings)) {\n            ret[key] = key;\n        }\n        return ret;\n    }\n    async getSettings() {\n        const onGet = await this.options?.onGet?.();\n        const ret = [];\n        for (const [key, setting] of Object.entries(this.settings)) {\n            let s = Object.assign({}, setting);\n            if (onGet?.[key])\n                s = Object.assign(s, onGet[key]);\n            if (s.onGet)\n                s = Object.assign(s, await s.onGet());\n            if (s.hide || await this.options?.hide?.[key]?.())\n                continue;\n            s.key = key;\n            s.value = this.getItemInternal(key, s, true);\n            if (typeof s.deviceFilter === 'function')\n                s.deviceFilter = s.deviceFilter.toString();\n            ret.push(s);\n            delete s.onPut;\n            delete s.onGet;\n            delete s.mapPut;\n            delete s.mapGet;\n        }\n        return ret;\n    }\n    async putSetting(key, value) {\n        const setting = this.settings[key];\n        let oldValue;\n        if (setting)\n            oldValue = this.getItemInternal(key, setting);\n        return this.putSettingInternal(setting, oldValue, key, value);\n    }\n    putSettingInternal(setting, oldValue, key, value) {\n        if (!setting?.noStore) {\n            if (setting?.mapPut)\n                value = setting.mapPut(oldValue, value);\n            // nullish values should be removed, since Storage can't persist them correctly.\n            if (value == null)\n                this.device.storage.removeItem(key);\n            else if (typeof value === 'object')\n                this.device.storage.setItem(key, JSON.stringify(value));\n            else\n                this.device.storage.setItem(key, value?.toString());\n        }\n        setting?.onPut?.(oldValue, value);\n        if (!setting?.hide)\n            this.device.onDeviceEvent(_1.ScryptedInterface.Settings, undefined);\n    }\n    getItemInternal(key, setting, rawDevice) {\n        if (!setting)\n            return this.device.storage.getItem(key);\n        const readDefaultValue = () => {\n            if (setting.persistedDefaultValue != null) {\n                this.putSettingInternal(setting, undefined, key, setting.persistedDefaultValue);\n                return setting.persistedDefaultValue;\n            }\n            return setting.defaultValue;\n        };\n        const ret = parseValue(this.device.storage.getItem(key), setting, readDefaultValue, rawDevice);\n        return setting.mapGet ? setting.mapGet(ret) : ret;\n    }\n    getItem(key) {\n        return this.getItemInternal(key, this.settings[key]);\n    }\n}\nexports.StorageSettings = StorageSettings;\n//# sourceMappingURL=storage-settings.js.map","import { p256 } from \"@noble/curves/p256\";\n\nexport const p256Keypair = (): { privateKey: Buffer; publicKey: Buffer } => {\n  const priv = p256.utils.randomPrivateKey();\n  const pub = p256.getPublicKey(priv, false);\n  const privateKey = Buffer.from(priv);\n  const publicKey = Buffer.from(pub);\n\n  return {\n    privateKey,\n    publicKey,\n  };\n};\n\nexport const p256PreMasterSecret = ({\n  publicKey,\n  privateKey,\n}: {\n  publicKey: Buffer;\n  privateKey: Buffer;\n}): Buffer => {\n  const res = p256.getSharedSecret(privateKey, publicKey);\n  const secret = Buffer.from(res).subarray(1);\n\n  return secret;\n};\n","import type { CipherContext } from \"../context/cipher\";\nimport type { DtlsContext } from \"../context/dtls\";\nimport { Alert } from \"../handshake/message/alert\";\nimport { debug } from \"../imports/common\";\nimport { AlertDesc, ContentType } from \"./const\";\nimport { FragmentedHandshake } from \"./message/fragment\";\nimport { DtlsPlaintext } from \"./message/plaintext\";\n\nconst log = debug(\"werift-dtls : packages/dtls/record/receive.ts : log\");\nconst err = debug(\"werift-dtls : packages/dtls/record/receive.ts : err\");\n\nexport const parsePacket = (data: Buffer) => {\n  let start = 0;\n  const packets: DtlsPlaintext[] = [];\n  while (data.length > start) {\n    const fragmentLength = data.readUInt16BE(start + 11);\n    if (data.length < start + (12 + fragmentLength)) {\n      break;\n    }\n    const packet = DtlsPlaintext.deSerialize(data.subarray(start));\n    packets.push(packet);\n\n    start += 13 + fragmentLength;\n  }\n\n  return packets;\n};\n\nexport const parsePlainText =\n  (dtls: DtlsContext, cipher: CipherContext) =>\n  (\n    plain: DtlsPlaintext,\n  ): {\n    type: ContentType;\n    data: any;\n  }[] => {\n    const contentType = plain.recordLayerHeader.contentType;\n\n    switch (contentType) {\n      case ContentType.changeCipherSpec: {\n        log(dtls.sessionId, \"change cipher spec\");\n        return [\n          {\n            type: ContentType.changeCipherSpec,\n            data: undefined,\n          },\n        ];\n      }\n      case ContentType.handshake: {\n        let raw = plain.fragment;\n        try {\n          if (plain.recordLayerHeader.epoch > 0) {\n            log(dtls.sessionId, \"decrypt handshake\");\n            raw = cipher.decryptPacket(plain);\n          }\n        } catch (error) {\n          err(dtls.sessionId, \"decrypt failed\", error);\n          throw error;\n        }\n        try {\n          let start = 0;\n          const handshakes: { type: ContentType; data: any }[] = [];\n          while (raw.length > start) {\n            const handshake = FragmentedHandshake.deSerialize(\n              raw.subarray(start),\n            );\n            handshakes.push({ type: ContentType.handshake, data: handshake });\n            start += handshake.fragment_length + 12;\n          }\n\n          return handshakes;\n        } catch (error) {\n          err(dtls.sessionId, \"decSerialize failed\", error, raw);\n          throw error;\n        }\n      }\n      case ContentType.applicationData: {\n        return [\n          {\n            type: ContentType.applicationData,\n            data: cipher.decryptPacket(plain),\n          },\n        ];\n      }\n      case ContentType.alert: {\n        let alert = Alert.deSerialize(plain.fragment);\n\n        // TODO impl more better about handle encrypted alert\n        if (AlertDesc[alert.description] == undefined) {\n          const dec = cipher.decryptPacket(plain);\n          alert = Alert.deSerialize(dec);\n        }\n        err(\n          dtls.sessionId,\n          \"ContentType.alert\",\n          alert,\n          AlertDesc[alert.description],\n          \"flight\",\n          dtls.flight,\n          \"lastFlight\",\n          dtls.lastFlight,\n        );\n        if (alert.level > 1) {\n          throw new Error(\"alert fatal error\");\n        }\n        return [{ type: ContentType.alert, data: undefined }];\n      }\n      default: {\n        return [{ type: ContentType.alert, data: undefined }];\n      }\n    }\n  };\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.wNAF = wNAF;\nexports.pippenger = pippenger;\nexports.precomputeMSMUnsafe = precomputeMSMUnsafe;\nexports.validateBasic = validateBasic;\n/**\n * Methods for elliptic curve multiplication by scalars.\n * Contains wNAF, pippenger\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nconst modular_js_1 = require(\"./modular.js\");\nconst utils_js_1 = require(\"./utils.js\");\nconst _0n = BigInt(0);\nconst _1n = BigInt(1);\nfunction constTimeNegate(condition, item) {\n    const neg = item.negate();\n    return condition ? neg : item;\n}\nfunction validateW(W, bits) {\n    if (!Number.isSafeInteger(W) || W <= 0 || W > bits)\n        throw new Error('invalid window size, expected [1..' + bits + '], got W=' + W);\n}\nfunction calcWOpts(W, bits) {\n    validateW(W, bits);\n    const windows = Math.ceil(bits / W) + 1; // +1, because\n    const windowSize = 2 ** (W - 1); // -1 because we skip zero\n    return { windows, windowSize };\n}\nfunction validateMSMPoints(points, c) {\n    if (!Array.isArray(points))\n        throw new Error('array expected');\n    points.forEach((p, i) => {\n        if (!(p instanceof c))\n            throw new Error('invalid point at index ' + i);\n    });\n}\nfunction validateMSMScalars(scalars, field) {\n    if (!Array.isArray(scalars))\n        throw new Error('array of scalars expected');\n    scalars.forEach((s, i) => {\n        if (!field.isValid(s))\n            throw new Error('invalid scalar at index ' + i);\n    });\n}\n// Since points in different groups cannot be equal (different object constructor),\n// we can have single place to store precomputes\nconst pointPrecomputes = new WeakMap();\nconst pointWindowSizes = new WeakMap(); // This allows use make points immutable (nothing changes inside)\nfunction getW(P) {\n    return pointWindowSizes.get(P) || 1;\n}\n/**\n * Elliptic curve multiplication of Point by scalar. Fragile.\n * Scalars should always be less than curve order: this should be checked inside of a curve itself.\n * Creates precomputation tables for fast multiplication:\n * - private scalar is split by fixed size windows of W bits\n * - every window point is collected from window's table & added to accumulator\n * - since windows are different, same point inside tables won't be accessed more than once per calc\n * - each multiplication is 'Math.ceil(CURVE_ORDER / ) + 1' point additions (fixed for any scalar)\n * - +1 window is neccessary for wNAF\n * - wNAF reduces table size: 2x less memory + 2x faster generation, but 10% slower multiplication\n *\n * @todo Research returning 2d JS array of windows, instead of a single window.\n * This would allow windows to be in different memory locations\n */\nfunction wNAF(c, bits) {\n    return {\n        constTimeNegate,\n        hasPrecomputes(elm) {\n            return getW(elm) !== 1;\n        },\n        // non-const time multiplication ladder\n        unsafeLadder(elm, n, p = c.ZERO) {\n            let d = elm;\n            while (n > _0n) {\n                if (n & _1n)\n                    p = p.add(d);\n                d = d.double();\n                n >>= _1n;\n            }\n            return p;\n        },\n        /**\n         * Creates a wNAF precomputation window. Used for caching.\n         * Default window size is set by `utils.precompute()` and is equal to 8.\n         * Number of precomputed points depends on the curve size:\n         * 2^(1) * (Math.ceil( / ) + 1), where:\n         * -  is the window size\n         * -  is the bitlength of the curve order.\n         * For a 256-bit curve and window size 8, the number of precomputed points is 128 * 33 = 4224.\n         * @param elm Point instance\n         * @param W window size\n         * @returns precomputed point tables flattened to a single array\n         */\n        precomputeWindow(elm, W) {\n            const { windows, windowSize } = calcWOpts(W, bits);\n            const points = [];\n            let p = elm;\n            let base = p;\n            for (let window = 0; window < windows; window++) {\n                base = p;\n                points.push(base);\n                // =1, because we skip zero\n                for (let i = 1; i < windowSize; i++) {\n                    base = base.add(p);\n                    points.push(base);\n                }\n                p = base.double();\n            }\n            return points;\n        },\n        /**\n         * Implements ec multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @returns real and fake (for const-time) points\n         */\n        wNAF(W, precomputes, n) {\n            // TODO: maybe check that scalar is less than group order? wNAF behavious is undefined otherwise\n            // But need to carefully remove other checks before wNAF. ORDER == bits here\n            const { windows, windowSize } = calcWOpts(W, bits);\n            let p = c.ZERO;\n            let f = c.BASE;\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                // This code was first written with assumption that 'f' and 'p' will never be infinity point:\n                // since each addition is multiplied by 2 ** W, it cannot cancel each other. However,\n                // there is negate now: it is possible that negated element from low value\n                // would be the same as high element, which will create carry into next window.\n                // It's not obvious how this can fail, but still worth investigating later.\n                // Check if we're onto Zero point.\n                // Add random point inside current window to f.\n                const offset1 = offset;\n                const offset2 = offset + Math.abs(wbits) - 1; // -1 because we skip zero\n                const cond1 = window % 2 !== 0;\n                const cond2 = wbits < 0;\n                if (wbits === 0) {\n                    // The most important part for const-time getPublicKey\n                    f = f.add(constTimeNegate(cond1, precomputes[offset1]));\n                }\n                else {\n                    p = p.add(constTimeNegate(cond2, precomputes[offset2]));\n                }\n            }\n            // JIT-compiler should not eliminate f here, since it will later be used in normalizeZ()\n            // Even if the variable is still unused, there are some checks which will\n            // throw an exception, so compiler needs to prove they won't happen, which is hard.\n            // At this point there is a way to F be infinity-point even if p is not,\n            // which makes it less const-time: around 1 bigint multiply.\n            return { p, f };\n        },\n        /**\n         * Implements ec unsafe (non const-time) multiplication using precomputed tables and w-ary non-adjacent form.\n         * @param W window size\n         * @param precomputes precomputed tables\n         * @param n scalar (we don't check here, but should be less than curve order)\n         * @param acc accumulator point to add result of multiplication\n         * @returns point\n         */\n        wNAFUnsafe(W, precomputes, n, acc = c.ZERO) {\n            const { windows, windowSize } = calcWOpts(W, bits);\n            const mask = BigInt(2 ** W - 1); // Create mask with W ones: 0b1111 for W=4 etc.\n            const maxNumber = 2 ** W;\n            const shiftBy = BigInt(W);\n            for (let window = 0; window < windows; window++) {\n                const offset = window * windowSize;\n                if (n === _0n)\n                    break; // No need to go over empty scalar\n                // Extract W bits.\n                let wbits = Number(n & mask);\n                // Shift number by W bits.\n                n >>= shiftBy;\n                // If the bits are bigger than max size, we'll split those.\n                // +224 => 256 - 32\n                if (wbits > windowSize) {\n                    wbits -= maxNumber;\n                    n += _1n;\n                }\n                if (wbits === 0)\n                    continue;\n                let curr = precomputes[offset + Math.abs(wbits) - 1]; // -1 because we skip zero\n                if (wbits < 0)\n                    curr = curr.negate();\n                // NOTE: by re-using acc, we can save a lot of additions in case of MSM\n                acc = acc.add(curr);\n            }\n            return acc;\n        },\n        getPrecomputes(W, P, transform) {\n            // Calculate precomputes on a first run, reuse them after\n            let comp = pointPrecomputes.get(P);\n            if (!comp) {\n                comp = this.precomputeWindow(P, W);\n                if (W !== 1)\n                    pointPrecomputes.set(P, transform(comp));\n            }\n            return comp;\n        },\n        wNAFCached(P, n, transform) {\n            const W = getW(P);\n            return this.wNAF(W, this.getPrecomputes(W, P, transform), n);\n        },\n        wNAFCachedUnsafe(P, n, transform, prev) {\n            const W = getW(P);\n            if (W === 1)\n                return this.unsafeLadder(P, n, prev); // For W=1 ladder is ~x2 faster\n            return this.wNAFUnsafe(W, this.getPrecomputes(W, P, transform), n, prev);\n        },\n        // We calculate precomputes for elliptic curve point multiplication\n        // using windowed method. This specifies window size and\n        // stores precomputed values. Usually only base point would be precomputed.\n        setWindowSize(P, W) {\n            validateW(W, bits);\n            pointWindowSizes.set(P, W);\n            pointPrecomputes.delete(P);\n        },\n    };\n}\n/**\n * Pippenger algorithm for multi-scalar multiplication (MSM, Pa + Qb + Rc + ...).\n * 30x faster vs naive addition on L=4096, 10x faster with precomputes.\n * For N=254bit, L=1, it does: 1024 ADD + 254 DBL. For L=5: 1536 ADD + 254 DBL.\n * Algorithmically constant-time (for same L), even when 1 point + scalar, or when scalar = 0.\n * @param c Curve Point constructor\n * @param fieldN field over CURVE.N - important that it's not over CURVE.P\n * @param points array of L curve points\n * @param scalars array of L scalars (aka private keys / bigints)\n */\nfunction pippenger(c, fieldN, points, scalars) {\n    // If we split scalars by some window (let's say 8 bits), every chunk will only\n    // take 256 buckets even if there are 4096 scalars, also re-uses double.\n    // TODO:\n    // - https://eprint.iacr.org/2024/750.pdf\n    // - https://tches.iacr.org/index.php/TCHES/article/view/10287\n    // 0 is accepted in scalars\n    validateMSMPoints(points, c);\n    validateMSMScalars(scalars, fieldN);\n    if (points.length !== scalars.length)\n        throw new Error('arrays of points and scalars must have equal length');\n    const zero = c.ZERO;\n    const wbits = (0, utils_js_1.bitLen)(BigInt(points.length));\n    const windowSize = wbits > 12 ? wbits - 3 : wbits > 4 ? wbits - 2 : wbits ? 2 : 1; // in bits\n    const MASK = (1 << windowSize) - 1;\n    const buckets = new Array(MASK + 1).fill(zero); // +1 for zero array\n    const lastBits = Math.floor((fieldN.BITS - 1) / windowSize) * windowSize;\n    let sum = zero;\n    for (let i = lastBits; i >= 0; i -= windowSize) {\n        buckets.fill(zero);\n        for (let j = 0; j < scalars.length; j++) {\n            const scalar = scalars[j];\n            const wbits = Number((scalar >> BigInt(i)) & BigInt(MASK));\n            buckets[wbits] = buckets[wbits].add(points[j]);\n        }\n        let resI = zero; // not using this will do small speed-up, but will lose ct\n        // Skip first bucket, because it is zero\n        for (let j = buckets.length - 1, sumI = zero; j > 0; j--) {\n            sumI = sumI.add(buckets[j]);\n            resI = resI.add(sumI);\n        }\n        sum = sum.add(resI);\n        if (i !== 0)\n            for (let j = 0; j < windowSize; j++)\n                sum = sum.double();\n    }\n    return sum;\n}\n/**\n * Precomputed multi-scalar multiplication (MSM, Pa + Qb + Rc + ...).\n * @param c Curve Point constructor\n * @param fieldN field over CURVE.N - important that it's not over CURVE.P\n * @param points array of L curve points\n * @returns function which multiplies points with scaars\n */\nfunction precomputeMSMUnsafe(c, fieldN, points, windowSize) {\n    /**\n     * Performance Analysis of Window-based Precomputation\n     *\n     * Base Case (256-bit scalar, 8-bit window):\n     * - Standard precomputation requires:\n     *   - 31 additions per scalar  256 scalars = 7,936 ops\n     *   - Plus 255 summary additions = 8,191 total ops\n     *   Note: Summary additions can be optimized via accumulator\n     *\n     * Chunked Precomputation Analysis:\n     * - Using 32 chunks requires:\n     *   - 255 additions per chunk\n     *   - 256 doublings\n     *   - Total: (255  32) + 256 = 8,416 ops\n     *\n     * Memory Usage Comparison:\n     * Window Size | Standard Points | Chunked Points\n     * ------------|-----------------|---------------\n     *     4-bit   |     520         |      15\n     *     8-bit   |    4,224        |     255\n     *    10-bit   |   13,824        |   1,023\n     *    16-bit   |  557,056        |  65,535\n     *\n     * Key Advantages:\n     * 1. Enables larger window sizes due to reduced memory overhead\n     * 2. More efficient for smaller scalar counts:\n     *    - 16 chunks: (16  255) + 256 = 4,336 ops\n     *    - ~2x faster than standard 8,191 ops\n     *\n     * Limitations:\n     * - Not suitable for plain precomputes (requires 256 constant doublings)\n     * - Performance degrades with larger scalar counts:\n     *   - Optimal for ~256 scalars\n     *   - Less efficient for 4096+ scalars (Pippenger preferred)\n     */\n    validateW(windowSize, fieldN.BITS);\n    validateMSMPoints(points, c);\n    const zero = c.ZERO;\n    const tableSize = 2 ** windowSize - 1; // table size (without zero)\n    const chunks = Math.ceil(fieldN.BITS / windowSize); // chunks of item\n    const MASK = BigInt((1 << windowSize) - 1);\n    const tables = points.map((p) => {\n        const res = [];\n        for (let i = 0, acc = p; i < tableSize; i++) {\n            res.push(acc);\n            acc = acc.add(p);\n        }\n        return res;\n    });\n    return (scalars) => {\n        validateMSMScalars(scalars, fieldN);\n        if (scalars.length > points.length)\n            throw new Error('array of scalars must be smaller than array of points');\n        let res = zero;\n        for (let i = 0; i < chunks; i++) {\n            // No need to double if accumulator is still zero.\n            if (res !== zero)\n                for (let j = 0; j < windowSize; j++)\n                    res = res.double();\n            const shiftBy = BigInt(chunks * windowSize - (i + 1) * windowSize);\n            for (let j = 0; j < scalars.length; j++) {\n                const n = scalars[j];\n                const curr = Number((n >> shiftBy) & MASK);\n                if (!curr)\n                    continue; // skip zero scalars chunks\n                res = res.add(tables[j][curr - 1]);\n            }\n        }\n        return res;\n    };\n}\nfunction validateBasic(curve) {\n    (0, modular_js_1.validateField)(curve.Fp);\n    (0, utils_js_1.validateObject)(curve, {\n        n: 'bigint',\n        h: 'bigint',\n        Gx: 'field',\n        Gy: 'field',\n    }, {\n        nBitLength: 'isSafeInteger',\n        nByteLength: 'isSafeInteger',\n    });\n    // Set defaults\n    return Object.freeze({\n        ...(0, modular_js_1.nLength)(curve.n, curve.nBitLength),\n        ...curve,\n        ...{ p: curve.Fp.ORDER },\n    });\n}\n//# sourceMappingURL=curve.js.map","export * from \"../../../dtls/src\";\n","import { dumpBuffer } from \"../../helper\";\nimport { type DtlsPlaintextHeader, MACHeader } from \"./header\";\n\nexport class DtlsPlaintext {\n  constructor(\n    public recordLayerHeader: DtlsPlaintextHeader,\n    public fragment: Buffer,\n  ) {}\n\n  get summary() {\n    return {\n      header: this.recordLayerHeader,\n      fragment: dumpBuffer(this.fragment),\n    };\n  }\n\n  static createEmpty() {\n    return new DtlsPlaintext(undefined as any, undefined as any);\n  }\n\n  static deSerialize(buf: Buffer) {\n    if (buf.length < 13) {\n      throw new Error(\"Invalid DTLS record: buffer is too short\");\n    }\n\n    const contentType = buf.readUInt8(0);\n    const majorVersion = buf.readUInt8(1);\n    const minorVersion = buf.readUInt8(2);\n    const epoch = buf.readUInt16BE(3);\n\n    // Read the 6-byte sequence number as a 48-bit integer\n    const sequenceNumber = buf.slice(5, 11).readUIntBE(0, 6);\n\n    const contentLen = buf.readUInt16BE(11);\n\n    // Ensure the buffer has enough data for the fragment\n    if (buf.length < 13 + contentLen) {\n      throw new Error(\"Invalid DTLS record: fragment length exceeds buffer\");\n    }\n\n    const fragment = buf.slice(13, 13 + contentLen);\n\n    const r = new DtlsPlaintext(\n      {\n        contentType,\n        protocolVersion: { major: majorVersion, minor: minorVersion },\n        epoch,\n        sequenceNumber,\n        contentLen,\n      },\n      fragment,\n    );\n    return r;\n  }\n\n  serialize() {\n    const fragmentLength = this.fragment.length;\n    // 13 bytes for headers + fragment length\n    const totalLength = 13 + fragmentLength;\n\n    const buffer = Buffer.alloc(totalLength);\n\n    buffer.writeUInt8(this.recordLayerHeader.contentType, 0);\n    buffer.writeUInt8(this.recordLayerHeader.protocolVersion.major, 1);\n    buffer.writeUInt8(this.recordLayerHeader.protocolVersion.minor, 2);\n    buffer.writeUInt16BE(this.recordLayerHeader.epoch, 3);\n    buffer.writeUIntBE(this.recordLayerHeader.sequenceNumber, 5, 6);\n    buffer.writeUInt16BE(fragmentLength, 11);\n    this.fragment.copy(buffer, 13);\n\n    return buffer;\n  }\n\n  computeMACHeader() {\n    return new MACHeader(\n      this.recordLayerHeader.epoch,\n      this.recordLayerHeader.sequenceNumber,\n      this.recordLayerHeader.contentType,\n      this.recordLayerHeader.protocolVersion,\n      this.recordLayerHeader.contentLen,\n    ).serialize();\n  }\n}\n","\"use strict\";\n/**\n * Utilities for hex, bytes, CSPRNG.\n * @module\n */\n/*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Hash = exports.nextTick = exports.byteSwapIfBE = exports.isLE = void 0;\nexports.isBytes = isBytes;\nexports.u8 = u8;\nexports.u32 = u32;\nexports.createView = createView;\nexports.rotr = rotr;\nexports.rotl = rotl;\nexports.byteSwap = byteSwap;\nexports.byteSwap32 = byteSwap32;\nexports.bytesToHex = bytesToHex;\nexports.hexToBytes = hexToBytes;\nexports.asyncLoop = asyncLoop;\nexports.utf8ToBytes = utf8ToBytes;\nexports.toBytes = toBytes;\nexports.concatBytes = concatBytes;\nexports.checkOpts = checkOpts;\nexports.wrapConstructor = wrapConstructor;\nexports.wrapConstructorWithOpts = wrapConstructorWithOpts;\nexports.wrapXOFConstructorWithOpts = wrapXOFConstructorWithOpts;\nexports.randomBytes = randomBytes;\n// We use WebCrypto aka globalThis.crypto, which exists in browsers and node.js 16+.\n// node.js versions earlier than v19 don't declare it in global scope.\n// For node.js, package.json#exports field mapping rewrites import\n// from `crypto` to `cryptoNode`, which imports native module.\n// Makes the utils un-importable in browsers without a bundler.\n// Once node.js 18 is deprecated (2025-04-30), we can just drop the import.\nconst crypto_1 = require(\"@noble/hashes/crypto\");\nconst _assert_js_1 = require(\"./_assert.js\");\n// export { isBytes } from './_assert.js';\n// We can't reuse isBytes from _assert, because somehow this causes huge perf issues\nfunction isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n// Cast array to different type\nfunction u8(arr) {\n    return new Uint8Array(arr.buffer, arr.byteOffset, arr.byteLength);\n}\nfunction u32(arr) {\n    return new Uint32Array(arr.buffer, arr.byteOffset, Math.floor(arr.byteLength / 4));\n}\n// Cast array to view\nfunction createView(arr) {\n    return new DataView(arr.buffer, arr.byteOffset, arr.byteLength);\n}\n/** The rotate right (circular right shift) operation for uint32 */\nfunction rotr(word, shift) {\n    return (word << (32 - shift)) | (word >>> shift);\n}\n/** The rotate left (circular left shift) operation for uint32 */\nfunction rotl(word, shift) {\n    return (word << shift) | ((word >>> (32 - shift)) >>> 0);\n}\n/** Is current platform little-endian? Most are. Big-Endian platform: IBM */\nexports.isLE = (() => new Uint8Array(new Uint32Array([0x11223344]).buffer)[0] === 0x44)();\n// The byte swap operation for uint32\nfunction byteSwap(word) {\n    return (((word << 24) & 0xff000000) |\n        ((word << 8) & 0xff0000) |\n        ((word >>> 8) & 0xff00) |\n        ((word >>> 24) & 0xff));\n}\n/** Conditionally byte swap if on a big-endian platform */\nexports.byteSwapIfBE = exports.isLE\n    ? (n) => n\n    : (n) => byteSwap(n);\n/** In place byte swap for Uint32Array */\nfunction byteSwap32(arr) {\n    for (let i = 0; i < arr.length; i++) {\n        arr[i] = byteSwap(arr[i]);\n    }\n}\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * Convert byte array to hex string.\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nfunction bytesToHex(bytes) {\n    (0, _assert_js_1.abytes)(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 };\nfunction asciiToBase16(ch) {\n    if (ch >= asciis._0 && ch <= asciis._9)\n        return ch - asciis._0; // '2' => 50-48\n    if (ch >= asciis.A && ch <= asciis.F)\n        return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n    if (ch >= asciis.a && ch <= asciis.f)\n        return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n    return;\n}\n/**\n * Convert hex string to byte array.\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nfunction hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n    }\n    return array;\n}\n/**\n * There is no setImmediate in browser and setTimeout is slow.\n * Call of async fn will return Promise, which will be fullfiled only on\n * next scheduler queue processing step and this is exactly what we need.\n */\nconst nextTick = async () => { };\nexports.nextTick = nextTick;\n/** Returns control to thread each 'tick' ms to avoid blocking. */\nasync function asyncLoop(iters, tick, cb) {\n    let ts = Date.now();\n    for (let i = 0; i < iters; i++) {\n        cb(i);\n        // Date.now() is not monotonic, so in case if clock goes backwards we return return control too\n        const diff = Date.now() - ts;\n        if (diff >= 0 && diff < tick)\n            continue;\n        await (0, exports.nextTick)();\n        ts += diff;\n    }\n}\n/**\n * Convert JS string to byte array.\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nfunction utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error('utf8ToBytes expected string, got ' + typeof str);\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n/**\n * Normalizes (non-hex) string or Uint8Array to Uint8Array.\n * Warning: when Uint8Array is passed, it would NOT get copied.\n * Keep in mind for future mutable operations.\n */\nfunction toBytes(data) {\n    if (typeof data === 'string')\n        data = utf8ToBytes(data);\n    (0, _assert_js_1.abytes)(data);\n    return data;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nfunction concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        (0, _assert_js_1.abytes)(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n/** For runtime check if class implements interface */\nclass Hash {\n    // Safe version that clones internal state\n    clone() {\n        return this._cloneInto();\n    }\n}\nexports.Hash = Hash;\nfunction checkOpts(defaults, opts) {\n    if (opts !== undefined && {}.toString.call(opts) !== '[object Object]')\n        throw new Error('Options should be object or undefined');\n    const merged = Object.assign(defaults, opts);\n    return merged;\n}\n/** Wraps hash function, creating an interface on top of it */\nfunction wrapConstructor(hashCons) {\n    const hashC = (msg) => hashCons().update(toBytes(msg)).digest();\n    const tmp = hashCons();\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = () => hashCons();\n    return hashC;\n}\nfunction wrapConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\nfunction wrapXOFConstructorWithOpts(hashCons) {\n    const hashC = (msg, opts) => hashCons(opts).update(toBytes(msg)).digest();\n    const tmp = hashCons({});\n    hashC.outputLen = tmp.outputLen;\n    hashC.blockLen = tmp.blockLen;\n    hashC.create = (opts) => hashCons(opts);\n    return hashC;\n}\n/** Cryptographically secure PRNG. Uses internal OS-level `crypto.getRandomValues`. */\nfunction randomBytes(bytesLength = 32) {\n    if (crypto_1.crypto && typeof crypto_1.crypto.getRandomValues === 'function') {\n        return crypto_1.crypto.getRandomValues(new Uint8Array(bytesLength));\n    }\n    // Legacy Node.js compatibility\n    if (crypto_1.crypto && typeof crypto_1.crypto.randomBytes === 'function') {\n        return crypto_1.crypto.randomBytes(bytesLength);\n    }\n    throw new Error('crypto.getRandomValues must be defined');\n}\n//# sourceMappingURL=utils.js.map","'use strict';\n\nconst { isUserType, isEncodeType, isType } = require('lib/util');\nconst symbols = require('internal/symbols');\nconst Metadata = require('internal/meta');\nconst BinaryStream = require('lib/binary-stream');\n\nmodule.exports = {\n  encode,\n  encodeCommon,\n};\n\n/**\n * @param {any} obj\n * @param {any} type\n * @param {BinaryStream} [target]\n * @returns {BinaryStream}\n */\nfunction encode(obj, type, target) {\n  const meta = new Metadata();\n\n  // Check for legacy interface.\n  if (type instanceof BinaryStream) {\n    const tmp = target;\n    target = type; // eslint-disable-line no-param-reassign\n    type = tmp; // eslint-disable-line no-param-reassign\n  }\n\n  if (!(target instanceof BinaryStream)) {\n    target = new BinaryStream(); // eslint-disable-line no-param-reassign\n  }\n\n  encodeCommon(obj, target, type, meta);\n\n  encode.bytes = meta.bytes;\n  Metadata.clean(meta);\n\n  return target;\n}\n\n/**\n * @param {any} object\n * @param {EncodeStream} wstream\n * @param {any} typeOrSchema\n * @param {Metadata} context\n */\nfunction encodeCommon(object, wstream, typeOrSchema, context) {\n  if (isType(typeOrSchema)) {\n    typeOrSchema.encode.call(context, object, wstream);\n    context[symbols.bytes] += typeOrSchema.encode.bytes;\n  } else {\n    encodeSchema(object, wstream, typeOrSchema, context);\n  }\n}\n\n/**\n * @param {any} object\n * @param {EncodeStream} wstream\n * @param {any} schema\n * @param {Metadata} context\n */\nfunction encodeSchema(object, wstream, schema, context) {\n  assertSchema(schema);\n\n  if (context.node === undefined) {\n    context.node = object;\n    context.current = object;\n  } else {\n    context.current = object;\n  }\n\n  const keys = Object.keys(schema);\n\n  for (let i = 0; i < keys.length; i += 1) {\n    const key = keys[i];\n    const type = schema[key];\n    const value = object[key];\n\n    if (!isEncodeType(type)) {\n      encodeSchema(value, wstream, type, context);\n      context.current = object;\n\n      continue; // eslint-disable-line no-continue\n    }\n\n    type.encode.call(context, value, wstream);\n    context[symbols.bytes] += type.encode.bytes;\n  }\n}\n\n/**\n * Check if argument is schema.\n * @param {Object} schema\n * @private\n */\nfunction assertSchema(schema) {\n  if (!isUserType(schema)) {\n    throw new TypeError('Argument `schema` should be a plain object.');\n  }\n}\n","import { bufferReader, bufferWriter } from \"../../../../common/src\";\nimport { RtcpHeader } from \"../header\";\nimport { RtcpTransportLayerFeedbackType } from \"./const\";\n\n// 0                   1                   2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |            PID                |             BLP               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n// Packet ID (PID)\n// bitmask of following lost packets (BLP):\n\nexport class GenericNack {\n  static count = 1;\n  readonly count = GenericNack.count;\n  header!: RtcpHeader;\n  senderSsrc!: number;\n  mediaSourceSsrc!: number;\n  lost: number[] = [];\n\n  toJSON() {\n    return {\n      lost: this.lost,\n      senderSsrc: this.senderSsrc,\n      mediaSourceSsrc: this.mediaSourceSsrc,\n    };\n  }\n\n  constructor(props: Partial<GenericNack> = {}) {\n    Object.assign(this, props);\n    if (!this.header) {\n      this.header = new RtcpHeader({\n        type: RtcpTransportLayerFeedbackType,\n        count: this.count,\n        version: 2,\n      });\n    }\n  }\n\n  static deSerialize(data: Buffer, header: RtcpHeader) {\n    const [senderSsrc, mediaSourceSsrc] = bufferReader(data, [4, 4]);\n\n    const lost: number[] = [];\n    for (let pos = 8; pos < data.length; pos += 4) {\n      const [pid, blp] = bufferReader(data.subarray(pos), [2, 2]);\n      lost.push(pid);\n      for (let diff = 0; diff < 16; diff++) {\n        if ((blp >> diff) & 1) {\n          lost.push(pid + diff + 1);\n        }\n      }\n    }\n\n    return new GenericNack({\n      header,\n      senderSsrc,\n      mediaSourceSsrc,\n      lost,\n    });\n  }\n\n  serialize() {\n    const ssrcPair = bufferWriter(\n      [4, 4],\n      [this.senderSsrc, this.mediaSourceSsrc],\n    );\n\n    const fci: Buffer[] = [];\n    if (this.lost.length > 0) {\n      let headPid = this.lost[0],\n        blp = 0;\n      this.lost.slice(1).forEach((pid) => {\n        const diff = pid - headPid - 1;\n        if (diff >= 0 && diff < 16) {\n          blp |= 1 << diff;\n        } else {\n          fci.push(bufferWriter([2, 2], [headPid, blp]));\n          headPid = pid;\n          blp = 0;\n        }\n      });\n      fci.push(bufferWriter([2, 2], [headPid, blp]));\n    }\n    const buf = Buffer.concat([ssrcPair, Buffer.concat(fci)]);\n    this.header.length = buf.length / 4;\n    return Buffer.concat([this.header.serialize(), buf]);\n  }\n}\n","/*!\n * is-plain-object <https://github.com/jonschlinkert/is-plain-object>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nvar isObject = require('isobject');\n\nfunction isObjectObject(o) {\n  return isObject(o) === true\n    && Object.prototype.toString.call(o) === '[object Object]';\n}\n\nmodule.exports = function isPlainObject(o) {\n  var ctor,prot;\n\n  if (isObjectObject(o) === false) return false;\n\n  // If has modified constructor\n  ctor = o.constructor;\n  if (typeof ctor !== 'function') return false;\n\n  // If has modified prototype\n  prot = ctor.prototype;\n  if (isObjectObject(prot) === false) return false;\n\n  // If constructor does not have an Object-specific method\n  if (prot.hasOwnProperty('isPrototypeOf') === false) {\n    return false;\n  }\n\n  // Most likely a plain Object\n  return true;\n};\n","import { RTCIceServer as WeriftRTCIceServer } from \"./werift\";\n\nconst server = \"turn.scrypted.app:3478\";\nconst turn = `turn:${server}`;\nconst stun = `stun:${server}`;\nconst creds = {\n    username: \"foo\",\n    credential: \"bar\",\n};\n\nconst turnServer = {\n    urls: [turn],\n    ...creds,\n};\nconst stunServer = {\n    urls: [stun],\n    ...creds,\n};\nconst googleStunServer = {\n    urls: [\"stun:stun.l.google.com:19302\"],\n};\n\nfunction toWerift(s: typeof turnServer | RTCIceServer) {\n    return {\n        urls: typeof s.urls === 'string' ? s.urls : s.urls[0],\n        username: s.username,\n        credential: s.credential,\n    }\n}\n\nexport function toWeriftConfiguration(configuration: RTCConfiguration) {\n    return {\n        iceServers: configuration.iceServers.map(toWerift),\n    }\n}\n\nexport const turnServers = [\n    turnServer,\n    stunServer,\n    googleStunServer,\n];\n\nexport const stunServers = [\n    stunServer,\n    googleStunServer,\n];\n\nexport const weriftTurnServers: WeriftRTCIceServer[] = turnServers.map(toWerift);\nexport const weriftStunServers: WeriftRTCIceServer[] = stunServers.map(toWerift);\n","export { SCTP_STATE, WEBRTC_PPID } from \"./const\";\nexport { SCTP } from \"./sctp\";\nexport type { Transport } from \"./transport\";\n","import { Settings, Setting, MixinDeviceBase, ScryptedInterface, SettingValue, MixinDeviceOptions } from \"@scrypted/sdk\";\nimport sdk from \"@scrypted/sdk\";\n\nconst { deviceManager } = sdk;\n\nexport interface SettingsMixinDeviceOptions<T> extends MixinDeviceOptions<T & Settings> {\n    group: string;\n    groupKey: string;\n}\n\nexport abstract class SettingsMixinDeviceBase<T> extends MixinDeviceBase<T & Settings> implements Settings {\n    settingsGroup: string;\n    settingsGroupKey: string;\n\n    constructor(options: SettingsMixinDeviceOptions<T>) {\n        super(options);\n\n        this.settingsGroup = options.group;\n        this.settingsGroupKey = options.groupKey;\n        process.nextTick(() => deviceManager.onMixinEvent(this.id, this, ScryptedInterface.Settings, null));\n    }\n\n    abstract getMixinSettings(): Promise<Setting[]>;\n    abstract putMixinSetting(key: string, value: SettingValue): Promise<boolean|void>;\n\n    async getSettings(): Promise<Setting[]> {\n        const settingsPromise = this.mixinDeviceInterfaces.includes(ScryptedInterface.Settings) ? this.mixinDevice.getSettings() : undefined;\n        const mixinSettingsPromise = this.getMixinSettings();\n        const allSettings: Setting[] = [];\n\n        try {\n            const settings = (await settingsPromise) || [];\n            allSettings.push(...settings);\n        }\n        catch (e) {\n            const name = this.name;\n            const description = `${name} Extension settings failed to load.`;\n            this.console.error(description, e)\n            allSettings.push({\n                key: Math.random().toString(),\n                title: name,\n                value: 'Settings Error',\n                group: 'Errors',\n                description,\n                readonly: true,\n            });\n        }\n\n        try {\n            const mixinSettings = (await mixinSettingsPromise) || [];\n            for (const setting of mixinSettings) {\n                setting.group = setting.group || this.settingsGroup;\n                setting.key = this.settingsGroupKey + ':' + setting.key;\n            }\n            allSettings.push(...mixinSettings);\n        }\n        catch (e) {\n            const name = deviceManager.getDeviceState(this.mixinProviderNativeId).name;\n            const description = `${name} Extension settings failed to load.`;\n            this.console.error(description, e)\n            allSettings.push({\n                key: Math.random().toString(),\n                title: name,\n                value: 'Settings Error',\n                group: 'Errors',\n                description,\n                readonly: true,\n            });\n        }\n\n        return allSettings;\n    }\n\n    async putSetting(key: string, value: SettingValue) {\n        const prefix = this.settingsGroupKey + ':';\n        if (!key?.startsWith(prefix)) {\n            return this.mixinDevice.putSetting(key, value);\n        }\n\n        if (!await this.putMixinSetting(key.substring(prefix.length), value))\n            deviceManager.onMixinEvent(this.id, this, ScryptedInterface.Settings, null);\n    }\n\n    async release() {\n        await deviceManager.onMixinEvent(this.id, this, ScryptedInterface.Settings, null);\n    }\n}\n","import { Intercom, MediaObject, RequestMediaStreamOptions, ResponseMediaStreamOptions, RTCAVSignalingSetup, RTCSessionControl, RTCSignalingChannel, RTCSignalingClient, RTCSignalingOptions, RTCSignalingSendIceCandidate, RTCSignalingSession, ScryptedDeviceBase, VideoCamera } from \"@scrypted/sdk\";\nimport { WebRTCPlugin } from \"./main\";\nimport { createRTCPeerConnectionSource, getRTCMediaStreamOptions } from \"./wrtc-to-rtsp\";\n\nconst useSdp = true;\n\nexport class WebRTCCamera extends ScryptedDeviceBase implements VideoCamera, RTCSignalingClient, RTCSignalingChannel, Intercom {\n    pendingClient: (session: RTCSignalingSession) => void;\n    intercom: Promise<Intercom>;\n\n    constructor(public plugin: WebRTCPlugin, nativeId: string) {\n        super(nativeId);\n    }\n\n    async startIntercom(media: MediaObject): Promise<void> {\n        const intercom = await this.intercom;\n        if (!intercom)\n            throw new Error('no webrtc session')\n        return intercom.startIntercom(media);\n    }\n\n    async stopIntercom(): Promise<void> {\n        const intercom = await this.intercom;\n        if (!intercom)\n            throw new Error('no webrtc session')\n        return intercom.stopIntercom();\n    }\n\n    async getVideoStream(options?: RequestMediaStreamOptions): Promise<MediaObject> {\n        const mediaStreamOptions = getRTCMediaStreamOptions('webrtc', 'WebRTC');\n\n        // todo: sdk.fork\n        const { mediaObject, getIntercom } = await createRTCPeerConnectionSource({\n            mixinId: undefined,\n            nativeId: this.nativeId,\n            mediaStreamOptions,\n            startRTCSignalingSession: session => this.startRTCSignalingSession(session),\n            maximumCompatibilityMode: this.plugin.storageSettings.values.maximumCompatibilityMode,\n        });\n\n        this.intercom?.then(intercom => intercom.stopIntercom());\n        this.intercom = getIntercom();\n\n        return mediaObject;\n    }\n\n    async getVideoStreamOptions(): Promise<ResponseMediaStreamOptions[]> {\n        const mediaStreamOptions = getRTCMediaStreamOptions('webrtc', 'WebRTC');\n        return [\n            mediaStreamOptions,\n        ];\n    }\n\n    async startRTCSignalingSession(session: RTCSignalingSession): Promise<RTCSessionControl> {\n        if (!this.pendingClient)\n            throw new Error('Browser client is not connected. Click \"Stream Web Camera\".');\n\n        class CompletedSession implements RTCSignalingSession {\n            __proxy_props = { \n                options: {},\n            };\n            options: {};\n\n            async getOptions(): Promise<RTCSignalingOptions> {\n                return {};\n            }\n            createLocalDescription(type: \"offer\" | \"answer\", setup: RTCAVSignalingSetup, sendIceCandidate: RTCSignalingSendIceCandidate): Promise<RTCSessionDescriptionInit> {\n                return session.createLocalDescription(type, setup, sendIceCandidate);\n            }\n            setRemoteDescription(description: RTCSessionDescriptionInit, setup: RTCAVSignalingSetup): Promise<void> {\n                return session.setRemoteDescription(description, setup);\n            }\n            addIceCandidate(candidate: RTCIceCandidateInit): Promise<void> {\n                return session.addIceCandidate(candidate);\n            }\n        }\n\n        this.pendingClient(new CompletedSession());\n        this.pendingClient = undefined;\n\n        return;\n    }\n\n    createRTCSignalingSession(): Promise<RTCSignalingSession> {\n        return new Promise(resolve => {\n            this.pendingClient = resolve;\n        });\n    }\n}\n","import { uint32Add } from \"../../../../common/src\";\nimport { Red } from \"./packet\";\n\nexport class RedEncoder {\n  private cache: { block: Buffer; timestamp: number; blockPT: number }[] = [];\n  cacheSize = 10;\n\n  constructor(public distance = 1) {}\n\n  push(payload: { block: Buffer; timestamp: number; blockPT: number }) {\n    this.cache.push(payload);\n    if (this.cache.length > this.cacheSize) {\n      this.cache.shift();\n    }\n  }\n\n  build() {\n    const red = new Red();\n    const redundantPayloads = this.cache.slice(-(this.distance + 1));\n\n    const presentPayload = redundantPayloads.pop();\n    if (!presentPayload) {\n      return red;\n    }\n\n    redundantPayloads.forEach((redundant) => {\n      const timestampOffset = uint32Add(\n        presentPayload.timestamp,\n        -redundant.timestamp,\n      );\n      if (timestampOffset > Max14Uint) {\n        return;\n      }\n      red.blocks.push({\n        block: redundant.block,\n        blockPT: redundant.blockPT,\n        timestampOffset,\n      });\n    });\n    red.blocks.push({\n      block: presentPayload.block,\n      blockPT: presentPayload.blockPT,\n    });\n    return red;\n  }\n}\n\nconst Max14Uint = (0x01 << 14) - 1;\n","import { SignatureAlgorithm, SignatureScheme } from \"../../cipher/const\";\nimport { createCipher } from \"../../cipher/create\";\nimport { generateKeyPair } from \"../../cipher/namedCurve\";\nimport {\n  prfExtendedMasterSecret,\n  prfMasterSecret,\n  prfPreMasterSecret,\n} from \"../../cipher/prf\";\nimport type { CipherContext } from \"../../context/cipher\";\nimport type { DtlsContext } from \"../../context/dtls\";\nimport { SrtpContext } from \"../../context/srtp\";\nimport type { TransportContext } from \"../../context/transport\";\nimport { HandshakeType } from \"../../handshake/const\";\nimport { ExtendedMasterSecret } from \"../../handshake/extensions/extendedMasterSecret\";\nimport { RenegotiationIndication } from \"../../handshake/extensions/renegotiationIndication\";\nimport { UseSRTP } from \"../../handshake/extensions/useSrtp\";\nimport { Certificate } from \"../../handshake/message/certificate\";\nimport { ChangeCipherSpec } from \"../../handshake/message/changeCipherSpec\";\nimport { CertificateVerify } from \"../../handshake/message/client/certificateVerify\";\nimport { ClientKeyExchange } from \"../../handshake/message/client/keyExchange\";\nimport { Finished } from \"../../handshake/message/finished\";\nimport { ServerCertificateRequest } from \"../../handshake/message/server/certificateRequest\";\nimport { ServerHello } from \"../../handshake/message/server/hello\";\nimport { ServerHelloDone } from \"../../handshake/message/server/helloDone\";\nimport { ServerKeyExchange } from \"../../handshake/message/server/keyExchange\";\nimport { DtlsRandom } from \"../../handshake/random\";\nimport { type SrtpProfile, debug } from \"../../imports/rtp\";\nimport { createPlaintext } from \"../../record/builder\";\nimport { ContentType } from \"../../record/const\";\nimport type { FragmentedHandshake } from \"../../record/message/fragment\";\nimport { Flight } from \"../flight\";\n\nconst log = debug(\n  \"werift-dtls : packages/dtls/src/flight/client/flight5.ts : log\",\n);\n\nexport class Flight5 extends Flight {\n  constructor(\n    udp: TransportContext,\n    dtls: DtlsContext,\n    private cipher: CipherContext,\n    private srtp: SrtpContext,\n  ) {\n    super(udp, dtls, 5, 7);\n  }\n\n  handleHandshake(handshake: FragmentedHandshake) {\n    this.dtls.bufferHandshakeCache([handshake], false, 4);\n    const message = (() => {\n      switch (handshake.msg_type) {\n        case HandshakeType.server_hello_2:\n          return ServerHello.deSerialize(handshake.fragment);\n        case HandshakeType.certificate_11:\n          return Certificate.deSerialize(handshake.fragment);\n        case HandshakeType.server_key_exchange_12:\n          return ServerKeyExchange.deSerialize(handshake.fragment);\n        case HandshakeType.certificate_request_13:\n          return ServerCertificateRequest.deSerialize(handshake.fragment);\n        case HandshakeType.server_hello_done_14:\n          return ServerHelloDone.deSerialize(handshake.fragment);\n      }\n    })();\n\n    if (message) {\n      handlers[message.msgType]({\n        dtls: this.dtls,\n        cipher: this.cipher,\n        srtp: this.srtp,\n      })(message);\n    }\n  }\n\n  async exec() {\n    if (this.dtls.flight === 5) {\n      log(this.dtls.sessionId, \"flight5 twice\");\n      this.send(this.dtls.lastMessage);\n      return;\n    }\n    this.dtls.flight = 5;\n\n    const needCertificate = this.dtls.requestedCertificateTypes.length > 0;\n    log(this.dtls.sessionId, \"send flight5\", needCertificate);\n\n    const messages = [\n      needCertificate && this.sendCertificate(),\n      this.sendClientKeyExchange(),\n      needCertificate && this.sendCertificateVerify(),\n      this.sendChangeCipherSpec(),\n      this.sendFinished(),\n    ].filter((v) => v) as Buffer[];\n\n    this.dtls.lastMessage = messages;\n    await this.transmit(messages);\n  }\n\n  private sendCertificate() {\n    const certificate = new Certificate([Buffer.from(this.cipher.localCert)]);\n\n    const packets = this.createPacket([certificate]);\n\n    const buf = Buffer.concat(packets.map((v) => v.serialize()));\n    return buf;\n  }\n\n  private sendClientKeyExchange() {\n    if (!this.cipher.localKeyPair) throw new Error();\n\n    const clientKeyExchange = new ClientKeyExchange(\n      this.cipher.localKeyPair.publicKey,\n    );\n    const packets = this.createPacket([clientKeyExchange]);\n    const buf = Buffer.concat(packets.map((v) => v.serialize()));\n\n    const localKeyPair = this.cipher.localKeyPair;\n    const remoteKeyPair = this.cipher.remoteKeyPair;\n\n    if (!remoteKeyPair.publicKey) throw new Error(\"not exist\");\n\n    const preMasterSecret = prfPreMasterSecret(\n      remoteKeyPair.publicKey,\n      localKeyPair.privateKey,\n      localKeyPair.curve,\n    );\n\n    log(\n      this.dtls.sessionId,\n      \"extendedMasterSecret\",\n      this.dtls.options.extendedMasterSecret,\n      this.dtls.remoteExtendedMasterSecret,\n    );\n\n    const handshakes = Buffer.concat(\n      this.dtls.sortedHandshakeCache.map((v) => v.serialize()),\n    );\n    this.cipher.masterSecret =\n      this.dtls.options.extendedMasterSecret &&\n      this.dtls.remoteExtendedMasterSecret\n        ? prfExtendedMasterSecret(preMasterSecret, handshakes)\n        : prfMasterSecret(\n            preMasterSecret,\n            this.cipher.localRandom.serialize(),\n            this.cipher.remoteRandom.serialize(),\n          );\n\n    this.cipher.cipher = createCipher(this.cipher.cipherSuite);\n    this.cipher.cipher.init(\n      this.cipher.masterSecret,\n      this.cipher.remoteRandom.serialize(),\n      this.cipher.localRandom.serialize(),\n    );\n    log(this.dtls.sessionId, \"cipher\", this.cipher.cipher.summary);\n\n    return buf;\n  }\n\n  private sendCertificateVerify() {\n    const cache = Buffer.concat(\n      this.dtls.sortedHandshakeCache.map((v) => v.serialize()),\n    );\n    const signed = this.cipher.signatureData(cache, \"sha256\");\n    const signatureScheme = (() => {\n      switch (this.cipher.signatureHashAlgorithm?.signature) {\n        case SignatureAlgorithm.ecdsa_3:\n          return SignatureScheme.ecdsa_secp256r1_sha256;\n        case SignatureAlgorithm.rsa_1:\n          return SignatureScheme.rsa_pkcs1_sha256;\n      }\n    })();\n    if (!signatureScheme) throw new Error();\n    log(\n      this.dtls.sessionId,\n      \"signatureScheme\",\n      this.cipher.signatureHashAlgorithm?.signature,\n      signatureScheme,\n    );\n\n    const certificateVerify = new CertificateVerify(signatureScheme, signed);\n    const packets = this.createPacket([certificateVerify]);\n    const buf = Buffer.concat(packets.map((v) => v.serialize()));\n    return buf;\n  }\n\n  private sendChangeCipherSpec() {\n    const changeCipherSpec = ChangeCipherSpec.createEmpty().serialize();\n    const packets = createPlaintext(this.dtls)(\n      [{ type: ContentType.changeCipherSpec, fragment: changeCipherSpec }],\n      ++this.dtls.recordSequenceNumber,\n    );\n    const buf = Buffer.concat(packets.map((v) => v.serialize()));\n    return buf;\n  }\n\n  private sendFinished() {\n    const cache = Buffer.concat(\n      this.dtls.sortedHandshakeCache.map((v) => v.serialize()),\n    );\n    const localVerifyData = this.cipher.verifyData(cache);\n\n    const finish = new Finished(localVerifyData);\n    this.dtls.epoch = 1;\n    const [packet] = this.createPacket([finish]);\n    // log(\n    //   this.dtls.sessionId,\n    //   \"raw finish packet\",\n    //   packet.summary,\n    //   this.dtls.sortedHandshakeCache.map((h) => h.summary),\n    // );\n\n    this.dtls.recordSequenceNumber = 0;\n\n    const buf = this.cipher.encryptPacket(packet).serialize();\n    log(this.dtls.sessionId, \"finished\", this.cipher.cipher.summary);\n    return buf;\n  }\n}\n\nconst handlers: {\n  [key: number]: (contexts: {\n    dtls: DtlsContext;\n    cipher: CipherContext;\n    srtp: SrtpContext;\n  }) => (message: any) => void;\n} = {};\n\nhandlers[HandshakeType.server_hello_2] =\n  ({ cipher, srtp, dtls }) =>\n  (message: ServerHello) => {\n    log(dtls.sessionId, \"serverHello\", message.cipherSuite);\n    cipher.remoteRandom = DtlsRandom.from(message.random);\n    cipher.cipherSuite = message.cipherSuite;\n    log(dtls.sessionId, \"selected cipherSuite\", cipher.cipherSuite);\n\n    if (message.extensions) {\n      message.extensions.forEach((extension) => {\n        switch (extension.type) {\n          case UseSRTP.type:\n            {\n              const useSrtp = UseSRTP.fromData(extension.data);\n              const profile = SrtpContext.findMatchingSRTPProfile(\n                useSrtp.profiles as SrtpProfile[],\n                dtls.options.srtpProfiles || [],\n              );\n              log(dtls.sessionId, \"selected srtp profile\", profile);\n              if (profile == undefined) return;\n              srtp.srtpProfile = profile;\n            }\n            break;\n          case ExtendedMasterSecret.type:\n            dtls.remoteExtendedMasterSecret = true;\n            break;\n          case RenegotiationIndication.type:\n            log(dtls.sessionId, \"RenegotiationIndication\");\n            break;\n        }\n      });\n    }\n  };\n\nhandlers[HandshakeType.certificate_11] =\n  ({ cipher, dtls }) =>\n  (message: Certificate) => {\n    log(dtls.sessionId, \"handshake certificate\", message);\n    cipher.remoteCertificate = message.certificateList[0];\n  };\n\nhandlers[HandshakeType.server_key_exchange_12] =\n  ({ cipher, dtls }) =>\n  (message: ServerKeyExchange) => {\n    if (!cipher.localRandom || !cipher.remoteRandom) throw new Error();\n    log(dtls.sessionId, \"ServerKeyExchange\", message);\n\n    log(dtls.sessionId, \"selected curve\", message.namedCurve);\n    cipher.remoteKeyPair = {\n      curve: message.namedCurve,\n      publicKey: message.publicKey,\n    };\n    cipher.localKeyPair = generateKeyPair(message.namedCurve);\n  };\n\nhandlers[HandshakeType.certificate_request_13] =\n  ({ dtls }) =>\n  (message: ServerCertificateRequest) => {\n    log(dtls.sessionId, \"certificate_request\", message);\n    dtls.requestedCertificateTypes = message.certificateTypes;\n    dtls.requestedSignatureAlgorithms = message.signatures;\n  };\n\nhandlers[HandshakeType.server_hello_done_14] =\n  ({ dtls }) =>\n  (msg) => {\n    log(dtls.sessionId, \"server_hello_done\", msg);\n  };\n","'use strict';\n\nmodule.exports = {\n  createTable,\n  createSlicedTable,\n};\n\n/**\n * Create classic lookup table for provided CRC polynom.\n * @param {number} polynom\n * @returns {number[]}\n */\nfunction createTable(polynom) {\n  const table = new Uint32Array(256);\n\n  for (let i = 0; i < table.length; i += 1) {\n    let crc = i;\n\n    for (let j = 0; j < 8; j += 1) {\n      // eslint-disable-next-line no-bitwise\n      crc = crc & 1 ? (crc >>> 1) ^ polynom : crc >>> 1;\n    }\n\n    table[i] = crc;\n  }\n\n  return table;\n}\n\n/**\n * Create lookup table for Slicing By N algorithm.\n * @param {number} polynom\n * @returns {Array<number[]>}\n */\nfunction createSlicedTable(polynom) {\n  const lookup = new Array(8);\n  const table = createTable(polynom);\n\n  lookup[0] = table;\n\n  for (let slice = 1; slice < lookup.length; slice += 1) {\n    lookup[slice] = new Uint32Array(256);\n\n    for (let i = 0; i < 256; i += 1) {\n      lookup[slice][i] =\n        // eslint-disable-next-line no-bitwise\n        (lookup[slice - 1][i] >>> 8) ^ lookup[0][lookup[slice - 1][i] & 0xff];\n    }\n  }\n\n  return lookup;\n}\n","module.exports = require(\"tty\");","import { createHash } from \"crypto\";\nimport { isIPv4 } from \"net\";\n\nexport class Candidate {\n  // An ICE candidate.\n\n  constructor(\n    public foundation: string,\n    public component: number,\n    public transport: string,\n    public priority: number,\n    public host: string,\n    public port: number,\n    public type: string,\n    public relatedAddress?: string,\n    public relatedPort?: number,\n    public tcptype?: string,\n    public generation?: number,\n    public ufrag?: string,\n  ) {}\n\n  static fromSdp(sdp: string) {\n    // Parse a :class:`Candidate` from SDP.\n    // .. code-block:: python\n    //    Candidate.from_sdp(\n    //     '6815297761 1 udp 659136 1.2.3.4 31102 typ host generation 0 ufrag b7l3')\n\n    const bits = sdp.split(\" \");\n    if (bits.length < 8) {\n      throw new Error(\"SDP does not have enough properties\");\n    }\n\n    // \n    const kwargs = {\n      foundation: bits[0],\n      component: Number(bits[1]),\n      transport: bits[2],\n      priority: Number(bits[3]),\n      host: bits[4],\n      port: Number(bits[5]),\n      type: bits[7],\n    };\n\n    for (let i = 8, il = bits.length - 1; i < il; i += 2) {\n      if (bits[i] === \"raddr\") {\n        (kwargs as any)[\"related_address\"] = bits[i + 1];\n      } else if (bits[i] === \"rport\") {\n        (kwargs as any)[\"related_port\"] = Number(bits[i + 1]);\n      } else if (bits[i] === \"tcptype\") {\n        (kwargs as any)[\"tcptype\"] = bits[i + 1];\n      } else if (bits[i] === \"generation\") {\n        (kwargs as any)[\"generation\"] = Number(bits[i + 1]);\n      } else if (bits[i] === \"ufrag\") {\n        (kwargs as any)[\"ufrag\"] = bits[i + 1];\n      }\n    }\n    const { foundation, component, transport, priority, host, port, type } =\n      kwargs;\n\n    return new Candidate(\n      foundation,\n      component,\n      transport,\n      priority,\n      host,\n      port,\n      type,\n      (kwargs as any)[\"related_address\"],\n      (kwargs as any)[\"related_port\"],\n      (kwargs as any)[\"tcptype\"],\n      (kwargs as any)[\"generation\"],\n      (kwargs as any)[\"ufrag\"],\n    );\n  }\n\n  canPairWith(other: Candidate) {\n    // \"\"\"\n    // A local candidate is paired with a remote candidate if and only if\n    // the two candidates have the same component ID and have the same IP\n    // address version.\n    // \"\"\"\n    const a = isIPv4(this.host);\n    const b = isIPv4(other.host);\n    return (\n      this.component === other.component &&\n      this.transport.toLowerCase() === other.transport.toLowerCase() &&\n      a === b\n    );\n  }\n\n  toSdp() {\n    let sdp = `${this.foundation} ${this.component} ${this.transport} ${this.priority} ${this.host} ${this.port} typ ${this.type}`;\n\n    if (this.relatedAddress) sdp += ` raddr ${this.relatedAddress}`;\n    if (this.relatedPort != undefined) sdp += ` rport ${this.relatedPort}`;\n    if (this.tcptype) sdp += ` tcptype ${this.tcptype}`;\n    if (this.generation != undefined) sdp += ` generation ${this.generation}`;\n    if (this.ufrag != undefined) sdp += ` ufrag ${this.ufrag}`;\n\n    return sdp;\n  }\n}\n\nexport function candidateFoundation(\n  candidateType: string,\n  candidateTransport: string,\n  baseAddress: string,\n) {\n  // \"\"\"\n  // See RFC 5245 - 4.1.1.3. Computing Foundations\n  // \"\"\"\n  const key = `${candidateType}|${candidateTransport}|${baseAddress}`;\n\n  return createHash(\"md5\").update(key, \"ascii\").digest(\"hex\").slice(7);\n}\n\n// priority\nexport function candidatePriority(candidateType: string, localPref = 65535) {\n  const candidateComponent: number = 1;\n  // See RFC 5245 - 4.1.2.1. Recommended Formula\n  let typePref = 0;\n  if (candidateType === \"host\") {\n    typePref = 126;\n  } else if (candidateType === \"prflx\") {\n    typePref = 110;\n  } else if (candidateType === \"srflx\") {\n    typePref = 100;\n  } else {\n    typePref = 0;\n  }\n  return (\n    (1 << 24) * typePref + (1 << 8) * localPref + (256 - candidateComponent)\n  );\n}\n","import type { RtcpHeader } from \"../../rtcp/header\";\nimport type { RtpHeader } from \"../../rtp/rtp\";\n\nexport abstract class CipherAesBase {\n  constructor(\n    public srtpSessionKey: Buffer,\n    public srtpSessionSalt: Buffer,\n    public srtcpSessionKey: Buffer,\n    public srtcpSessionSalt: Buffer,\n  ) {}\n\n  encryptRtp(\n    header: RtpHeader,\n    payload: Buffer,\n    rolloverCounter: number,\n  ): Buffer {\n    return Buffer.from([]);\n  }\n\n  decryptRtp(cipherText: Buffer, rolloverCounter: number): [Buffer, RtpHeader] {\n    return [] as any;\n  }\n\n  encryptRTCP(rawRtcp: Buffer, srtcpIndex: number): Buffer {\n    return Buffer.from([]);\n  }\n\n  decryptRTCP(encrypted: Buffer): [Buffer, RtcpHeader] {\n    return [] as any;\n  }\n}\n","module.exports = require(\"stream\");","export * from \"../../../ice/src\";\n","import { YError } from 'yerror';\nconst QUOTE = '\"';\nconst EQUAL = '=';\nconst SEPARATOR = ', ';\n/*\n * Regular expression for matching the key-value pairs\n * \\w+     = The key\n * =       = The equal sign\n * \".*?\"   = Value option 1: A double-quoted value (using the non-greedy *? to stop at the first doublequote)\n * [^\",]+  = Value option 2: A string without commas or double-quotes\n * (?=,|$) = Zero-width (as in not captured) positive lookahead assertion.\n *           The previous match will only be valid if it's followed by a \" literal\n *           or the end of the string\n */\nconst KEYVALUE_REGEXP = /\\w+=(\".*?\"|[^\",]+)(?=,|$)/g;\n// FIXME: Create a real parser\nexport function parseHTTPHeadersQuotedKeyValueSet(contents, authorizedKeys, requiredKeys = [], valuesToNormalize = []) {\n    const matches = contents.trim().match(KEYVALUE_REGEXP);\n    if (!matches)\n        throw new YError('E_MALFORMED_QUOTEDKEYVALUE', contents);\n    const data = matches\n        .map((part, partPosition) => {\n        const [key, ...rest] = part.split(EQUAL);\n        const value = rest.join(EQUAL);\n        if (0 === rest.length) {\n            throw new YError('E_MALFORMED_QUOTEDKEYVALUE', partPosition, part);\n        }\n        return [key, value];\n    })\n        .reduce(function (parsedValues, [name, value], valuePosition) {\n        const normalizedName = name.toLowerCase();\n        if (-1 === authorizedKeys.indexOf(normalizedName)) {\n            throw new YError('E_UNAUTHORIZED_KEY', valuePosition, normalizedName);\n        }\n        /*\n         * Regular expression for stripping paired starting and ending double quotes off the value:\n         * ^      = The beginning of the string\n         * \"      = The first double quote\n         * .+     = One or more characters of any kind\n         * (?=\"$) = Zero-width (as in not captured) positive lookahead assertion.\n         *          The previous match will only be valid if it's followed by a \" literal\n         *          or the end of the string\n         * \"      = The ending double quote\n         * $      = The end of the string\n         */\n        const strippedValue = value.replace(/^\"(.+(?=\"$))\"$/, '$1');\n        parsedValues[normalizedName] = valuesToNormalize.includes(normalizedName)\n            ? strippedValue.toLowerCase()\n            : strippedValue;\n        return parsedValues;\n    }, {});\n    _checkRequiredKeys(requiredKeys, data);\n    return data;\n}\nexport function buildHTTPHeadersQuotedKeyValueSet(data, authorizedKeys, requiredKeys = []) {\n    _checkRequiredKeys(requiredKeys, data);\n    return authorizedKeys.reduce(function (contents, key) {\n        if (data[key]) {\n            return (contents +\n                (contents ? SEPARATOR : '') +\n                key +\n                EQUAL +\n                QUOTE +\n                data[key] +\n                QUOTE);\n        }\n        return contents;\n    }, '');\n}\nfunction _checkRequiredKeys(requiredKeys, data) {\n    requiredKeys.forEach((name) => {\n        if ('undefined' === typeof data[name]) {\n            throw new YError('E_REQUIRED_KEY', name);\n        }\n    });\n}\n//# sourceMappingURL=utils.js.map","export * from \"../../../common/src\";\n","import type { Address } from \"./imports/common\";\nimport type { Message } from \"./stun/message\";\n\nexport class TransactionError extends Error {\n  response?: Message;\n  addr?: Address;\n}\n\nexport class TransactionFailed extends TransactionError {\n  constructor(\n    public response: Message,\n    public addr: Address,\n  ) {\n    super();\n  }\n\n  get str() {\n    let out = \"STUN transaction failed\";\n    const attribute = this.response.getAttributeValue(\"ERROR-CODE\");\n    if (attribute) {\n      const [code, msg] = attribute;\n      out += ` (${code} - ${msg})`;\n    }\n    return out;\n  }\n}\n\nexport class TransactionTimeout extends TransactionError {\n  get str() {\n    return \"STUN transaction timed out\";\n  }\n}\n","import {\n  BitWriter2,\n  bufferReader,\n  bufferWriter,\n  debug,\n  getBit,\n} from \"../../imports/common\";\nimport { RtcpHeader } from \"../header\";\n\nconst log = debug(\"werift/rtp/rtcp/rtpfb/twcc\");\n\n/* RTP Extensions for Transport-wide Congestion Control\n * draft-holmer-rmcat-transport-wide-cc-extensions-01\n\n   0               1               2               3\n   0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7 0 1 2 3 4 5 6 7\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |V=2|P|  FMT=15 |    PT=205     |           length              |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |                     SSRC of packet sender                     |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |                      SSRC of media source                     |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |      base sequence number     |      packet status count      |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |                 reference time                | fb pkt. count |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |          packet chunk         |         packet chunk          |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  .                                                               .\n  .                                                               .\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |         packet chunk          |  recv delta   |  recv delta   |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  .                                                               .\n  .                                                               .\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n  |           recv delta          |  recv delta   | zero padding  |\n  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n */\n\nexport class TransportWideCC {\n  static count = 15;\n  count = TransportWideCC.count;\n  length = 2;\n\n  senderSsrc!: number;\n  mediaSourceSsrc!: number;\n  baseSequenceNumber!: number;\n  packetStatusCount!: number;\n  /** 24bit multiples of 64ms */\n  referenceTime!: number;\n  fbPktCount!: number;\n  packetChunks: (RunLengthChunk | StatusVectorChunk)[] = [];\n  recvDeltas: RecvDelta[] = [];\n  header!: RtcpHeader;\n\n  constructor(props: Partial<TransportWideCC> = {}) {\n    Object.assign(this, props);\n    if (!this.header) {\n      this.header = new RtcpHeader({\n        type: 205,\n        count: this.count,\n        version: 2,\n      });\n    }\n  }\n\n  static deSerialize(data: Buffer, header: RtcpHeader) {\n    const [\n      senderSsrc,\n      mediaSsrc,\n      baseSequenceNumber,\n      packetStatusCount,\n      referenceTime,\n      fbPktCount,\n    ] = bufferReader(data, [4, 4, 2, 2, 3, 1]);\n    const packetChunks: (RunLengthChunk | StatusVectorChunk)[] = [];\n    const recvDeltas: RecvDelta[] = [];\n\n    let packetStatusPos = 16;\n    for (let processedPacketNum = 0; processedPacketNum < packetStatusCount; ) {\n      const type = getBit(\n        data.slice(packetStatusPos, packetStatusPos + 1)[0],\n        0,\n        1,\n      );\n      let iPacketStatus: RunLengthChunk | StatusVectorChunk | undefined;\n      switch (type) {\n        case PacketChunk.TypeTCCRunLengthChunk:\n          {\n            const packetStatus = RunLengthChunk.deSerialize(\n              data.slice(packetStatusPos, packetStatusPos + 2),\n            );\n            iPacketStatus = packetStatus;\n            const packetNumberToProcess = Math.min(\n              packetStatusCount - processedPacketNum,\n              packetStatus.runLength,\n            );\n            if (\n              packetStatus.packetStatus ===\n                PacketStatus.TypeTCCPacketReceivedSmallDelta ||\n              packetStatus.packetStatus ===\n                PacketStatus.TypeTCCPacketReceivedLargeDelta\n            ) {\n              for (let _ = 0; _ < packetNumberToProcess; _++) {\n                recvDeltas.push(\n                  new RecvDelta({ type: packetStatus.packetStatus as any }),\n                );\n              }\n            }\n            processedPacketNum += packetNumberToProcess;\n          }\n          break;\n        case PacketChunk.TypeTCCStatusVectorChunk:\n          {\n            const packetStatus = StatusVectorChunk.deSerialize(\n              data.slice(packetStatusPos, packetStatusPos + 2),\n            );\n            iPacketStatus = packetStatus;\n            if (packetStatus.symbolSize === 0) {\n              packetStatus.symbolList.forEach((v) => {\n                if (v === PacketStatus.TypeTCCPacketReceivedSmallDelta) {\n                  recvDeltas.push(\n                    new RecvDelta({\n                      type: PacketStatus.TypeTCCPacketReceivedSmallDelta,\n                    }),\n                  );\n                }\n              });\n            }\n            if (packetStatus.symbolSize === 1) {\n              packetStatus.symbolList.forEach((v) => {\n                if (\n                  v === PacketStatus.TypeTCCPacketReceivedSmallDelta ||\n                  v === PacketStatus.TypeTCCPacketReceivedLargeDelta\n                ) {\n                  recvDeltas.push(\n                    new RecvDelta({\n                      type: v,\n                    }),\n                  );\n                }\n              });\n            }\n            processedPacketNum += packetStatus.symbolList.length;\n          }\n          break;\n      }\n      if (!iPacketStatus) throw new Error();\n      packetStatusPos += 2;\n      packetChunks.push(iPacketStatus);\n    }\n\n    let recvDeltaPos = packetStatusPos;\n    recvDeltas.forEach((delta) => {\n      if (delta.type === PacketStatus.TypeTCCPacketReceivedSmallDelta) {\n        delta.deSerialize(data.slice(recvDeltaPos, recvDeltaPos + 1));\n        recvDeltaPos++;\n      }\n      if (delta.type === PacketStatus.TypeTCCPacketReceivedLargeDelta) {\n        delta.deSerialize(data.slice(recvDeltaPos, recvDeltaPos + 2));\n        recvDeltaPos += 2;\n      }\n    });\n\n    return new TransportWideCC({\n      senderSsrc,\n      mediaSourceSsrc: mediaSsrc,\n      baseSequenceNumber,\n      packetStatusCount,\n      referenceTime,\n      fbPktCount,\n      recvDeltas,\n      packetChunks,\n      header,\n    });\n  }\n\n  serialize() {\n    const constBuf = bufferWriter(\n      [4, 4, 2, 2, 3, 1],\n      [\n        this.senderSsrc,\n        this.mediaSourceSsrc,\n        this.baseSequenceNumber,\n        this.packetStatusCount,\n        this.referenceTime,\n        this.fbPktCount,\n      ],\n    );\n\n    const chunks = Buffer.concat(\n      this.packetChunks.map((chunk) => chunk.serialize()),\n    );\n\n    const deltas = Buffer.concat(\n      this.recvDeltas\n        .map((delta) => {\n          try {\n            return delta.serialize();\n          } catch (error: any) {\n            log(error?.message);\n            return undefined;\n          }\n        })\n        .filter((v) => v) as Buffer[],\n    );\n\n    const buf = Buffer.concat([constBuf, chunks, deltas]);\n\n    if (this.header.padding && buf.length % 4 !== 0) {\n      const rest = 4 - (buf.length % 4);\n      const padding = Buffer.alloc(rest);\n      padding[padding.length - 1] = padding.length;\n\n      this.header.length = Math.floor((buf.length + padding.length) / 4);\n      return Buffer.concat([this.header.serialize(), buf, padding]);\n    }\n\n    this.header.length = Math.floor(buf.length / 4);\n    return Buffer.concat([this.header.serialize(), buf]);\n  }\n\n  get packetResults(): PacketResult[] {\n    const currentSequenceNumber = this.baseSequenceNumber - 1;\n    const results = this.packetChunks\n      .filter((v) => v instanceof RunLengthChunk)\n      .flatMap((chunk) =>\n        (chunk as RunLengthChunk).results(currentSequenceNumber),\n      );\n\n    let deltaIdx = 0;\n    const referenceTime = BigInt(this.referenceTime) * 64n;\n    let currentReceivedAtMs = referenceTime;\n\n    for (const result of results) {\n      const recvDelta = this.recvDeltas[deltaIdx];\n      if (!result.received || !recvDelta) {\n        continue;\n      }\n      currentReceivedAtMs += BigInt(recvDelta.delta) / 1000n;\n      result.delta = recvDelta.delta;\n      result.receivedAtMs = Number(currentReceivedAtMs);\n      deltaIdx++;\n    }\n    return results;\n  }\n}\n\n//  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |T| S |       Run Length        |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\nexport class RunLengthChunk {\n  type!: PacketChunk.TypeTCCRunLengthChunk;\n  packetStatus!: PacketStatus;\n  /** 13bit */\n  runLength!: number;\n\n  constructor(props: Partial<RunLengthChunk> = {}) {\n    Object.assign(this, props);\n    this.type = PacketChunk.TypeTCCRunLengthChunk;\n  }\n\n  static deSerialize(data: Buffer) {\n    const packetStatus = getBit(data[0], 1, 2);\n    const runLength = (getBit(data[0], 3, 5) << 8) + data[1];\n\n    return new RunLengthChunk({ type: 0, packetStatus, runLength });\n  }\n\n  serialize() {\n    const buf = new BitWriter2(16)\n      .set(0)\n      .set(this.packetStatus, 2)\n      .set(this.runLength, 13).buffer;\n\n    return buf;\n  }\n\n  results(currentSequenceNumber: number) {\n    const received =\n      this.packetStatus === PacketStatus.TypeTCCPacketReceivedSmallDelta ||\n      this.packetStatus === PacketStatus.TypeTCCPacketReceivedLargeDelta;\n\n    const results: PacketResult[] = [];\n    for (let i = 0; i <= this.runLength; ++i) {\n      results.push(\n        new PacketResult({ sequenceNumber: ++currentSequenceNumber, received }),\n      );\n    }\n    return results;\n  }\n}\n\n//  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |T|S|       symbol list         |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\nexport class StatusVectorChunk {\n  type!: number;\n  symbolSize!: number;\n  symbolList: number[] = [];\n\n  constructor(props: Partial<StatusVectorChunk> = {}) {\n    Object.assign(this, props);\n  }\n\n  static deSerialize(data: Buffer) {\n    const type = PacketChunk.TypeTCCStatusVectorChunk;\n    let symbolSize = getBit(data[0], 1, 1);\n    const symbolList: number[] = [];\n\n    function range(n: number, cb: (i: number) => void) {\n      for (let i = 0; i < n; i++) {\n        cb(i);\n      }\n    }\n\n    switch (symbolSize) {\n      case 0:\n        range(6, (i) => symbolList.push(getBit(data[0], 2 + i, 1)));\n        range(8, (i) => symbolList.push(getBit(data[1], i, 1)));\n        break;\n      case 1:\n        range(3, (i) => symbolList.push(getBit(data[0], 2 + i * 2, 2)));\n        range(4, (i) => symbolList.push(getBit(data[1], i * 2, 2)));\n        break;\n      default:\n        symbolSize = (getBit(data[0], 2, 6) << 8) + data[1];\n    }\n\n    return new StatusVectorChunk({ type, symbolSize, symbolList });\n  }\n\n  serialize() {\n    const buf = Buffer.alloc(2);\n\n    const writer = new BitWriter2(16).set(1).set(this.symbolSize);\n    const bits = this.symbolSize === 0 ? 1 : 2;\n\n    this.symbolList.forEach((v) => {\n      writer.set(v, bits);\n    });\n    buf.writeUInt16BE(writer.value);\n    return buf;\n  }\n}\n\nexport class RecvDelta {\n  /**optional (If undefined, it will be set automatically.)*/\n  type?:\n    | PacketStatus.TypeTCCPacketReceivedSmallDelta\n    | PacketStatus.TypeTCCPacketReceivedLargeDelta;\n  /**micro sec */\n  delta!: number;\n\n  constructor(props: Partial<RecvDelta> = {}) {\n    Object.assign(this, props);\n  }\n\n  static deSerialize(data: Buffer) {\n    let type: number | undefined;\n    let delta: number | undefined;\n\n    if (data.length === 1) {\n      type = PacketStatus.TypeTCCPacketReceivedSmallDelta;\n      delta = 250 * data[0];\n    } else if (data.length === 2) {\n      type = PacketStatus.TypeTCCPacketReceivedLargeDelta;\n      delta = 250 * data.readInt16BE();\n    }\n\n    if (type === undefined || delta === undefined) throw new Error();\n\n    return new RecvDelta({ type, delta });\n  }\n\n  deSerialize(data: Buffer) {\n    const res = RecvDelta.deSerialize(data);\n    this.delta = res.delta;\n  }\n\n  parsed = false; // todo refactor\n  parseDelta() {\n    this.delta = Math.floor(this.delta / 250);\n\n    if (this.delta < 0 || this.delta > 255) {\n      if (this.delta > 32767) this.delta = 32767; // maxInt16\n      if (this.delta < -32768) this.delta = -32768; // minInt16\n      if (!this.type) this.type = PacketStatus.TypeTCCPacketReceivedLargeDelta;\n    } else {\n      if (!this.type) this.type = PacketStatus.TypeTCCPacketReceivedSmallDelta;\n    }\n    this.parsed = true;\n  }\n\n  serialize() {\n    if (!this.parsed) this.parseDelta();\n    if (this.type === PacketStatus.TypeTCCPacketReceivedSmallDelta) {\n      const buf = Buffer.alloc(1);\n      buf.writeUInt8(this.delta);\n      return buf;\n    } else if (this.type === PacketStatus.TypeTCCPacketReceivedLargeDelta) {\n      const buf = Buffer.alloc(2);\n      buf.writeInt16BE(this.delta);\n      return buf;\n    }\n\n    throw new Error(\"errDeltaExceedLimit \" + this.delta + \" \" + this.type);\n  }\n}\n\nexport enum PacketChunk {\n  TypeTCCRunLengthChunk = 0,\n  TypeTCCStatusVectorChunk = 1,\n  packetStatusChunkLength = 2,\n}\n\nexport enum PacketStatus {\n  TypeTCCPacketNotReceived = 0,\n  TypeTCCPacketReceivedSmallDelta = 1,\n  TypeTCCPacketReceivedLargeDelta = 2,\n  TypeTCCPacketReceivedWithoutDelta = 3,\n}\n\nexport class PacketResult {\n  sequenceNumber = 0;\n  delta = 0;\n  received = false;\n  receivedAtMs = 0;\n  constructor(props: Partial<PacketResult>) {\n    Object.assign(this, props);\n  }\n}\n","import { RpcSerializer } from \"./rpc\";\n\nexport class BufferSerializer implements RpcSerializer {\n    serialize(value: Buffer) {\n        console.warn('Using slow buffer serialization. Ensure the peer supports SidebandBufferSerializer.');\n        return value.toString('base64');\n    }\n    deserialize(serialized: any) {\n        console.warn('Using slow buffer deserialization. Ensure the peer supports SidebandBufferSerializer.');\n        return Buffer.from(serialized, 'base64');\n    }\n}\n\nexport class SidebandBufferSerializer implements RpcSerializer {\n    bufferSerializer = new BufferSerializer();\n\n    serialize(value: any, serializationContext?: any) {\n        if (!serializationContext)\n            return this.bufferSerializer.serialize(value);\n        const buffers: Buffer[] = serializationContext.buffers = serializationContext.buffers || [];\n        buffers.push(value);\n        return buffers.length - 1;\n    }\n\n    deserialize(serialized: any, serializationContext?: any) {\n        if (!serializationContext?.buffers)\n            return this.bufferSerializer.deserialize(serialized);\n        const buffers: Buffer[] = serializationContext.buffers;\n        return buffers[serialized];\n    }\n}\n","import sdk, { ForkOptions, PluginFork } from '@scrypted/sdk';\nimport { createAsyncQueue } from './async-queue';\nimport os from 'os';\n\nexport type Zygote<T> = () => PluginFork<T>;\n\nexport function createService<T, V>(options: ForkOptions, create: (t: Promise<T>) => Promise<V>): {\n    getResult: () => Promise<V>,\n    terminate: () => void,\n} {\n    let killed = false;\n    let currentResult: Promise<V>;\n    let currentFork: ReturnType<typeof sdk.fork<T>>;\n\n    return {\n        getResult() {\n            if (killed)\n                throw new Error('service terminated');\n\n            if (currentResult)\n                return currentResult;\n\n            currentFork = sdk.fork<T>(options);\n            currentFork.worker.on('exit', () => currentResult = undefined);\n            currentResult = create(currentFork.result);\n            currentResult.catch(() => {\n                currentResult = undefined;\n            });\n            return currentResult;\n        },\n\n        terminate() {\n            if (killed)\n                return;\n\n            killed = true;\n            currentFork.worker.terminate();\n            currentFork = undefined;\n            currentResult = undefined;\n        }\n    }\n}\n\nexport function createZygote<T>(options?: ForkOptions): Zygote<T> {\n    let zygote = sdk.fork<T>(options);\n    function* next() {\n        while (true) {\n            const cur = zygote;\n            zygote = sdk.fork<T>(options);\n            yield cur;\n        }\n    }\n\n    const gen = next();\n    return () => {\n        const ret = gen.next();\n        if (ret.done || !ret.value)\n            throw new Error('Zygote exhausted');\n        return ret.value;\n    };\n}\n\n\nexport function createZygoteWorkQueue<T>(maxWorkers: number = os.cpus().length >> 1) {\n    const queue = createAsyncQueue<(doWork: (fork: PluginFork<T>) => Promise<any>) => Promise<any>>();\n    let forks = 0;\n\n    return async <R>(doWork: (fork: PluginFork<T>) => Promise<R>): Promise<R> => {\n        const check = queue.take();\n        if (check)\n            return check(doWork);\n\n        if (maxWorkers && forks < maxWorkers) {\n            let exited = false;\n            const controller = new AbortController();\n            // necessary to prevent unhandledrejection errors\n            controller.signal.addEventListener('abort', () => { });\n            const fork = sdk.fork<T>();\n            forks++;\n            fork.worker.on('exit', () => {\n                forks--;\n                exited = true;\n                controller.abort();\n            });\n\n            let timeout: NodeJS.Timeout;\n            const queueFork = () => {\n                clearTimeout(timeout);\n                timeout = setTimeout(() => {\n                    // keep one alive.\n                    if (forks === 1)\n                        return;\n                    fork.worker.terminate();\n                }, 30000);\n\n                queue.submit(async v2 => {\n                    clearTimeout(timeout);\n                    try {\n                        return await v2(fork);\n                    }\n                    finally {\n                        if (!exited) {\n                            queueFork();\n                        }\n                    }\n                }, controller.signal);\n            }\n\n            queueFork();\n        }\n\n        const d = await queue.dequeue();\n        return d(doWork);\n    };\n}\n","import { type Address, Event, debug } from \"../imports/common\";\n\nimport { TransactionFailed, TransactionTimeout } from \"../exceptions\";\nimport type { Protocol } from \"../types/model\";\nimport { RETRY_MAX, RETRY_RTO, classes } from \"./const\";\nimport type { Message } from \"./message\";\n\nconst log = debug(\"werift-ice:packages/ice/src/stun/transaction.ts\");\n\nexport class Transaction {\n  private timeoutDelay = RETRY_RTO;\n  ended = false;\n  private tries = 0;\n  private readonly triesMax: number;\n  private readonly onResponse = new Event<[Message, Address]>();\n\n  constructor(\n    private request: Message,\n    private addr: Address,\n    private protocol: Protocol,\n    private retransmissions?: number,\n  ) {\n    this.triesMax =\n      1 + (this.retransmissions ? this.retransmissions : RETRY_MAX);\n  }\n\n  responseReceived = (message: Message, addr: Address) => {\n    if (this.onResponse.length > 0) {\n      if (message.messageClass === classes.RESPONSE) {\n        this.onResponse.execute(message, addr);\n        this.onResponse.complete();\n      } else {\n        this.onResponse.error(new TransactionFailed(message, addr));\n      }\n    }\n  };\n\n  run = async () => {\n    try {\n      this.retry().catch((e) => {\n        log(\"retry failed\", e);\n      });\n      const res = await this.onResponse.asPromise();\n      return res;\n    } catch (error) {\n      throw error;\n    } finally {\n      this.cancel();\n    }\n  };\n\n  private retry = async () => {\n    while (this.tries < this.triesMax && !this.ended) {\n      this.protocol.sendStun(this.request, this.addr).catch((e) => {\n        log(\"send stun failed\", e);\n      });\n      await new Promise((r) => setTimeout(r, this.timeoutDelay));\n      if (this.ended) {\n        break;\n      }\n      this.timeoutDelay *= 2;\n      this.tries++;\n    }\n    if (this.tries >= this.triesMax) {\n      log(`retry failed times:${this.tries} maxLimit:${this.triesMax}`);\n      this.onResponse.error(new TransactionTimeout());\n    }\n  };\n\n  cancel() {\n    this.ended = true;\n  }\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type { SignatureSchemes } from \"../../../cipher/const\";\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type { Handshake } from \"../../../typings/domain\";\nimport { HandshakeType } from \"../../const\";\n\nexport class CertificateVerify implements Handshake {\n  msgType = HandshakeType.certificate_verify_15;\n  messageSeq?: number;\n\n  static readonly spec = {\n    algorithm: types.uint16be,\n    signature: types.buffer(types.uint16be),\n  };\n\n  constructor(\n    public algorithm: SignatureSchemes,\n    public signature: Buffer,\n  ) {}\n\n  static createEmpty() {\n    return new CertificateVerify(undefined as any, undefined as any);\n  }\n\n  static deSerialize(buf: Buffer) {\n    const res = decode(buf, CertificateVerify.spec);\n    return new CertificateVerify(\n      //@ts-ignore\n      ...Object.values(res),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, CertificateVerify.spec).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","// RTP Payload Format for VP9 Video draft-ietf-payload-vp9-16 https://datatracker.ietf.org/doc/html/draft-ietf-payload-vp9\n\nimport { getBit, paddingByte } from \"../../../common/src\";\nimport type { RtpHeader } from \"../rtp/rtp\";\nimport type { DePacketizerBase } from \"./base\";\n\n//          0 1 2 3 4 5 6 7\n//         +-+-+-+-+-+-+-+-+\n//         |I|P|L|F|B|E|V|Z| (REQUIRED)\n//         +-+-+-+-+-+-+-+-+\n//    I:   |M| PICTURE ID  | (REQUIRED)\n//         +-+-+-+-+-+-+-+-+\n//    M:   | EXTENDED PID  | (RECOMMENDED)\n//         +-+-+-+-+-+-+-+-+\n//    L:   | TID |U| SID |D| (Conditionally RECOMMENDED)\n//         +-+-+-+-+-+-+-+-+                             -\\\n//    P,F: | P_DIFF      |N| (Conditionally REQUIRED)    - up to 3 times\n//         +-+-+-+-+-+-+-+-+                             -/\n//    V:   | SS            |\n//         | ..            |\n//         +-+-+-+-+-+-+-+-+\n\n//          0 1 2 3 4 5 6 7\n//         +-+-+-+-+-+-+-+-+\n//         |I|P|L|F|B|E|V|Z| (REQUIRED)\n//         +-+-+-+-+-+-+-+-+\n//    I:   |M| PICTURE ID  | (RECOMMENDED)\n//         +-+-+-+-+-+-+-+-+\n//    M:   | EXTENDED PID  | (RECOMMENDED)\n//         +-+-+-+-+-+-+-+-+\n//    L:   | TID |U| SID |D| (Conditionally RECOMMENDED)\n//         +-+-+-+-+-+-+-+-+\n//         |   TL0PICIDX   | (Conditionally REQUIRED)\n//         +-+-+-+-+-+-+-+-+\n//    V:   | SS            |\n//         | ..            |\n//         +-+-+-+-+-+-+-+-+\n\nexport class Vp9RtpPayload implements DePacketizerBase {\n  /**Picture ID (PID) present */\n  iBit!: number;\n  /**Inter-picture predicted frame */\n  pBit!: number;\n  /**Layer indices present */\n  lBit!: number;\n  /**Flexible mode */\n  fBit!: number;\n  /**Start of a frame */\n  bBit!: number;\n  /**End of a frame */\n  eBit!: number;\n  /**Scalability structure */\n  vBit!: number;\n  zBit!: number;\n  m?: number;\n  pictureId?: number;\n  tid?: number;\n  u?: number;\n  sid?: number;\n  /**inter_layer_predicted */\n  d?: number;\n  tl0PicIdx?: number;\n  pDiff: number[] = [];\n  n_s?: number;\n  y?: number;\n  g?: number;\n  width: number[] = [];\n  height: number[] = [];\n  n_g = 0;\n  pgT: number[] = [];\n  pgU: number[] = [];\n  pgP_Diff: number[][] = [];\n  payload!: Buffer;\n\n  static deSerialize(buf: Buffer) {\n    const { p, offset } = this.parseRtpPayload(buf);\n    p.payload = buf.subarray(offset);\n    return p;\n  }\n\n  static parseRtpPayload(buf: Buffer) {\n    const p = new Vp9RtpPayload();\n    let offset = 0;\n\n    p.iBit = getBit(buf[offset], 0); // PictureId present .\n    p.pBit = getBit(buf[offset], 1); // Inter-picture predicted.\n    p.lBit = getBit(buf[offset], 2); // Layer indices present.\n    p.fBit = getBit(buf[offset], 3); // Flexible mode.\n    p.bBit = getBit(buf[offset], 4); // Begins frame flag.\n    p.eBit = getBit(buf[offset], 5); // Ends frame flag.\n    p.vBit = getBit(buf[offset], 6); // Scalability structure present.\n    p.zBit = getBit(buf[offset], 7); // Not used for inter-layer prediction\n    offset++;\n\n    if (p.iBit) {\n      p.m = getBit(buf[offset], 0);\n\n      if (p.m) {\n        const _7 = paddingByte(getBit(buf[offset], 1, 7));\n        const _8 = paddingByte(buf[offset + 1]);\n        p.pictureId = Number.parseInt(_7 + _8, 2);\n        offset += 2;\n      } else {\n        p.pictureId = getBit(buf[offset], 1, 7);\n        offset++;\n      }\n    }\n\n    if (p.lBit) {\n      p.tid = getBit(buf[offset], 0, 3);\n      p.u = getBit(buf[offset], 3);\n      p.sid = getBit(buf[offset], 4, 3);\n      p.d = getBit(buf[offset], 7);\n      offset++;\n      if (p.fBit === 0) {\n        p.tl0PicIdx = buf[offset];\n        offset++;\n      }\n    }\n\n    if (p.fBit && p.pBit) {\n      for (;;) {\n        p.pDiff = [...p.pDiff, getBit(buf[offset], 0, 7)];\n        const n = getBit(buf[offset], 7);\n        offset++;\n        if (n === 0) break;\n      }\n    }\n\n    // Scalability structure (SS):\n    //\n    //      +-+-+-+-+-+-+-+-+\n    // V:   | N_S |Y|G|-|-|-|\n    //      +-+-+-+-+-+-+-+-+              -|\n    // Y:   |     WIDTH     | (OPTIONAL)    .\n    //      +               +               .\n    //      |               | (OPTIONAL)    .\n    //      +-+-+-+-+-+-+-+-+               . N_S + 1 times\n    //      |     HEIGHT    | (OPTIONAL)    .\n    //      +               +               .\n    //      |               | (OPTIONAL)    .\n    //      +-+-+-+-+-+-+-+-+              -|\n    // G:   |      N_G      | (OPTIONAL)\n    //      +-+-+-+-+-+-+-+-+                           -|\n    // N_G: |  T  |U| R |-|-| (OPTIONAL)                 .\n    //      +-+-+-+-+-+-+-+-+              -|            . N_G times\n    //      |    P_DIFF     | (OPTIONAL)    . R times    .\n    //      +-+-+-+-+-+-+-+-+              -|           -|\n    //\n    if (p.vBit) {\n      p.n_s = getBit(buf[offset], 0, 3);\n      p.y = getBit(buf[offset], 3);\n      p.g = getBit(buf[offset], 4);\n      offset++;\n\n      if (p.y) {\n        [...Array(p.n_s + 1)].forEach(() => {\n          p.width.push(buf.readUInt16BE(offset));\n          offset += 2;\n          p.height.push(buf.readUInt16BE(offset));\n          offset += 2;\n        });\n      }\n\n      if (p.g) {\n        p.n_g = buf[offset];\n        offset++;\n      }\n\n      if (p.n_g > 0) {\n        [...Array(p.n_g).keys()].forEach((i) => {\n          p.pgT.push(getBit(buf[offset], 0, 3));\n          p.pgU.push(getBit(buf[offset], 3));\n          const r = getBit(buf[offset], 4, 2);\n          offset++;\n\n          p.pgP_Diff[i] = [];\n          if (r > 0) {\n            [...Array(r)].forEach(() => {\n              p.pgP_Diff[i].push(buf[offset]);\n              offset++;\n            });\n          }\n        });\n      }\n    }\n    return { offset, p };\n  }\n\n  static isDetectedFinalPacketInSequence(header: RtpHeader) {\n    return header.marker;\n  }\n\n  get isKeyframe() {\n    return !!(!this.pBit && this.bBit && (!this.sid || !this.lBit));\n  }\n\n  get isPartitionHead() {\n    return this.bBit && (!this.lBit || !this.d);\n  }\n}\n","import type { DtlsContext } from \"../../context/dtls\";\nimport type { TransportContext } from \"../../context/transport\";\nimport type { ClientHello } from \"../../handshake/message/client/hello\";\nimport type { ServerHelloVerifyRequest } from \"../../handshake/message/server/helloVerifyRequest\";\nimport { debug } from \"../../imports/common\";\nimport { Flight } from \"../flight\";\n\nconst log = debug(\n  \"werift-dtls : packages/dtls/src/flight/client/flight3.ts : log\",\n);\n\nexport class Flight3 extends Flight {\n  constructor(udp: TransportContext, dtls: DtlsContext) {\n    super(udp, dtls, 3, 5);\n  }\n\n  async exec(verifyReq: ServerHelloVerifyRequest) {\n    if (this.dtls.flight === 3) throw new Error();\n    this.dtls.flight = 3;\n\n    this.dtls.handshakeCache = [];\n\n    const [clientHello] = this.dtls.lastFlight as [ClientHello];\n    log(\"dtls version\", clientHello.clientVersion);\n    clientHello.cookie = verifyReq.cookie;\n    this.dtls.cookie = verifyReq.cookie;\n\n    const packets = this.createPacket([clientHello]);\n\n    const buf = Buffer.concat(packets.map((v) => v.serialize()));\n    await this.transmit([buf]);\n  }\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type { Extension } from \"../../typings/domain\";\n\n// rfc4492\nexport class EllipticCurves {\n  static type = 10;\n  static readonly spec = {\n    type: types.uint16be,\n    data: types.array(types.uint16be, types.uint16be, \"bytes\"),\n  };\n\n  public type: number = EllipticCurves.type;\n  public data: number[] = [];\n\n  constructor(props: Partial<EllipticCurves> = {}) {\n    Object.assign(this, props);\n  }\n\n  static createEmpty() {\n    return new EllipticCurves();\n  }\n\n  static fromData(buf: Buffer) {\n    return new EllipticCurves({\n      type: EllipticCurves.type,\n      data: decode(buf, EllipticCurves.spec.data),\n    });\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new EllipticCurves(decode(buf, EllipticCurves.spec));\n  }\n\n  serialize() {\n    return Buffer.from(encode(this, EllipticCurves.spec).slice());\n  }\n\n  get extension(): Extension {\n    return {\n      type: this.type,\n      data: this.serialize().slice(2),\n    };\n  }\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sdk = exports.MixinDeviceBase = exports.ScryptedDeviceBase = void 0;\n__exportStar(require(\"../types/gen/index\"), exports);\nconst fs_1 = __importDefault(require(\"fs\"));\nconst index_1 = require(\"../types/gen/index\");\nconst module_1 = require(\"module\");\n/**\n * @category Core Reference\n */\nclass ScryptedDeviceBase extends index_1.DeviceBase {\n    constructor(nativeId) {\n        super();\n        this.nativeId = nativeId;\n    }\n    get storage() {\n        if (!this._storage) {\n            this._storage = exports.sdk.deviceManager.getDeviceStorage(this.nativeId);\n        }\n        return this._storage;\n    }\n    get log() {\n        if (!this._log) {\n            this._log = exports.sdk.deviceManager.getDeviceLogger(this.nativeId);\n        }\n        return this._log;\n    }\n    get console() {\n        if (!this._console) {\n            this._console = exports.sdk.deviceManager.getDeviceConsole(this.nativeId);\n        }\n        return this._console;\n    }\n    async createMediaObject(data, mimeType) {\n        return exports.sdk.mediaManager.createMediaObject(data, mimeType, {\n            sourceId: this.id,\n        });\n    }\n    getMediaObjectConsole(mediaObject) {\n        if (typeof mediaObject.sourceId !== 'string')\n            return this.console;\n        return exports.sdk.deviceManager.getMixinConsole(mediaObject.sourceId, this.nativeId);\n    }\n    _lazyLoadDeviceState() {\n        if (!this._deviceState) {\n            if (this.nativeId) {\n                this._deviceState = exports.sdk.deviceManager.getDeviceState(this.nativeId);\n            }\n            else {\n                this._deviceState = exports.sdk.deviceManager.getDeviceState();\n            }\n        }\n    }\n    /**\n     * Fire an event for this device.\n     */\n    onDeviceEvent(eventInterface, eventData) {\n        return exports.sdk.deviceManager.onDeviceEvent(this.nativeId, eventInterface, eventData);\n    }\n}\nexports.ScryptedDeviceBase = ScryptedDeviceBase;\n/**\n * @category Mixin Reference\n */\nclass MixinDeviceBase extends index_1.DeviceBase {\n    constructor(options) {\n        super();\n        this._listeners = new Set();\n        this.mixinDevice = options.mixinDevice;\n        this.mixinDeviceInterfaces = options.mixinDeviceInterfaces;\n        this.mixinStorageSuffix = options.mixinStorageSuffix;\n        this._deviceState = options.mixinDeviceState;\n        this.nativeId = exports.sdk.systemManager.getDeviceById(this.id).nativeId;\n        this.mixinProviderNativeId = options.mixinProviderNativeId;\n        // RpcProxy will trap all properties, and the following check/hack will determine\n        // if the device state came from another node worker thread.\n        // This should ultimately be discouraged and warned at some point in the future.\n        if (this._deviceState.__rpcproxy_traps_all_properties && typeof this._deviceState.id === 'string') {\n            this._deviceState = exports.sdk.deviceManager.createDeviceState(this._deviceState.id, this._deviceState.setState);\n        }\n    }\n    get storage() {\n        if (!this._storage) {\n            const mixinStorageSuffix = this.mixinStorageSuffix;\n            const mixinStorageKey = this.id + (mixinStorageSuffix ? ':' + mixinStorageSuffix : '');\n            this._storage = exports.sdk.deviceManager.getMixinStorage(mixinStorageKey, this.mixinProviderNativeId);\n        }\n        return this._storage;\n    }\n    get console() {\n        if (!this._console) {\n            if (exports.sdk.deviceManager.getMixinConsole)\n                this._console = exports.sdk.deviceManager.getMixinConsole(this.id, this.mixinProviderNativeId);\n            else\n                this._console = exports.sdk.deviceManager.getDeviceConsole(this.mixinProviderNativeId);\n        }\n        return this._console;\n    }\n    async createMediaObject(data, mimeType) {\n        return exports.sdk.mediaManager.createMediaObject(data, mimeType, {\n            sourceId: this.id,\n        });\n    }\n    getMediaObjectConsole(mediaObject) {\n        if (typeof mediaObject.sourceId !== 'string')\n            return this.console;\n        return exports.sdk.deviceManager.getMixinConsole(mediaObject.sourceId, this.mixinProviderNativeId);\n    }\n    /**\n     * Fire an event for this device.\n     */\n    onDeviceEvent(eventInterface, eventData) {\n        return exports.sdk.deviceManager.onMixinEvent(this.id, this, eventInterface, eventData);\n    }\n    _lazyLoadDeviceState() {\n    }\n    manageListener(listener) {\n        this._listeners.add(listener);\n    }\n    release() {\n        for (const l of this._listeners) {\n            l.removeListener();\n        }\n    }\n}\nexports.MixinDeviceBase = MixinDeviceBase;\n(function () {\n    function _createGetState(state) {\n        return function () {\n            this._lazyLoadDeviceState();\n            // @ts-ignore: accessing private property\n            return this._deviceState?.[state];\n        };\n    }\n    function _createSetState(state) {\n        return function (value) {\n            this._lazyLoadDeviceState();\n            // @ts-ignore: accessing private property\n            if (!this._deviceState) {\n                console.warn('device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.');\n            }\n            else {\n                // @ts-ignore: accessing private property\n                this._deviceState[state] = value;\n            }\n        };\n    }\n    for (const field of Object.values(index_1.ScryptedInterfaceProperty)) {\n        if (field === index_1.ScryptedInterfaceProperty.nativeId)\n            continue;\n        Object.defineProperty(ScryptedDeviceBase.prototype, field, {\n            set: _createSetState(field),\n            get: _createGetState(field),\n        });\n        Object.defineProperty(MixinDeviceBase.prototype, field, {\n            set: _createSetState(field),\n            get: _createGetState(field),\n        });\n    }\n})();\nexports.sdk = {};\ntry {\n    let loaded = false;\n    try {\n        // todo: remove usage of process.env.SCRYPTED_SDK_MODULE, only existed in prerelease builds.\n        // import.meta is not a reliable way to detect es module support in webpack since webpack\n        // evaluates that to true at runtime.\n        const esModule = process.env.SCRYPTED_SDK_ES_MODULE || process.env.SCRYPTED_SDK_MODULE;\n        const cjsModule = process.env.SCRYPTED_SDK_CJS_MODULE || process.env.SCRYPTED_SDK_MODULE;\n        // @ts-expect-error\n        if (esModule && typeof import.meta !== 'undefined') {\n            // @ts-expect-error\n            const require = (0, module_1.createRequire)(import.meta.url);\n            const sdkModule = require(esModule);\n            Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n            loaded = true;\n        }\n        else if (cjsModule) {\n            // @ts-expect-error\n            if (typeof __non_webpack_require__ !== 'undefined') {\n                // @ts-expect-error\n                const sdkModule = __non_webpack_require__(process.env.SCRYPTED_SDK_MODULE);\n                Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n                loaded = true;\n            }\n            else {\n                const sdkModule = require(cjsModule);\n                Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n                loaded = true;\n            }\n        }\n    }\n    catch (e) {\n        console.warn(\"failed to load sdk module\", e);\n        throw e;\n    }\n    if (!loaded) {\n        let runtimeAPI;\n        try {\n            runtimeAPI = pluginRuntimeAPI;\n        }\n        catch (e) {\n        }\n        Object.assign(exports.sdk, {\n            log: deviceManager.getDeviceLogger(undefined),\n            deviceManager,\n            endpointManager,\n            mediaManager,\n            systemManager,\n            pluginHostAPI,\n            ...runtimeAPI,\n        });\n    }\n    try {\n        let descriptors = {\n            ...index_1.ScryptedInterfaceDescriptors,\n        };\n        try {\n            const sdkJson = JSON.parse(fs_1.default.readFileSync('../sdk.json').toString());\n            const customDescriptors = sdkJson.interfaceDescriptors;\n            if (customDescriptors) {\n                descriptors = {\n                    ...descriptors,\n                    ...customDescriptors,\n                };\n            }\n        }\n        catch (e) {\n            console.warn('failed to load custom interface descriptors', e);\n        }\n        exports.sdk.systemManager.setScryptedInterfaceDescriptors?.(index_1.TYPES_VERSION, descriptors)?.catch(() => { });\n    }\n    catch (e) {\n    }\n}\ncatch (e) {\n    console.error('sdk initialization error, import @scrypted/types or use @scrypted/client instead', e);\n}\nexports.default = exports.sdk;\n//# sourceMappingURL=index.js.map","import mdns from \"multicast-dns\";\nimport worker_thread from \"worker_threads\";\n\ninterface DnsLookupRequest {\n  host: string;\n}\n\ninterface DnsLookupResult extends DnsLookupRequest {\n  err?: string;\n  address?: string;\n  family?: number;\n}\n\nexport class MdnsLookup {\n  cache = new Map<string, Promise<string>>();\n  mdnsInstance = mdns();\n\n  constructor() {\n    this.mdnsInstance.setMaxListeners(50);\n  }\n\n  lookup(host: string): Promise<string> {\n    return new Promise((r, f) => {\n      const cleanup = () => {\n        this.mdnsInstance.removeListener(\"response\", l);\n        clearTimeout(timeout);\n      };\n\n      const timeout = setTimeout(() => {\n        cleanup();\n        f(new Error(\"No mDNS response\"));\n      }, 10000);\n\n      const l = (response: mdns.ResponsePacket) => {\n        const a = response.answers?.[0];\n        if (a?.type !== \"A\") {\n          return;\n        }\n        if (a.name !== host) {\n          return;\n        }\n\n        cleanup();\n        r(a.data);\n      };\n      this.mdnsInstance.on(\"response\", l);\n\n      this.mdnsInstance.query(host, \"A\");\n    });\n  }\n\n  close() {\n    this.mdnsInstance.destroy();\n  }\n}\n\nexport class DnsLookup {\n  thread: worker_thread.Worker;\n  cache = new Map<string, Promise<string>>();\n\n  constructor() {\n    const lookupWorkerFunction = () => {\n      const worker_thread = global.require(\"worker_threads\");\n      const { lookup } = global.require(\"dns\");\n\n      const dnsLookup = (host: string) =>\n        lookup(host, (err: Error, address: string, family: number) => {\n          const res: DnsLookupResult = {\n            err: err?.message,\n            address,\n            family,\n            host,\n          };\n          worker_thread.parentPort?.postMessage(res);\n          process.exit();\n        });\n\n      worker_thread.parentPort?.on(\"message\", (message: DnsLookupRequest) => {\n        const { host } = message;\n        dnsLookup(host);\n      });\n    };\n\n    const lookupEval = `(${lookupWorkerFunction})()`;\n\n    this.thread = new worker_thread.Worker(lookupEval, {\n      eval: true,\n    });\n\n    this.thread.setMaxListeners(100);\n  }\n\n  async lookup(host: string): Promise<string> {\n    let cached = this.cache.get(host);\n    if (cached) {\n      return cached;\n    }\n    cached = new Promise((r, f) => {\n      const exitListener = (exitCode: number) =>\n        f(new Error(`dns.lookup thread exited unexpectedly: ${exitCode}`));\n\n      const threadMessageListener = (result: DnsLookupResult) => {\n        if (result.host !== host) {\n          return;\n        }\n\n        this.thread.removeListener(\"message\", threadMessageListener);\n        this.thread.removeListener(\"exit\", exitListener);\n\n        if (!result.address)\n          return f(new Error(result.err || \"dns.lookup thread unknown error\"));\n        r(result.address);\n      };\n\n      this.thread.on(\"message\", threadMessageListener);\n      this.thread.on(\"exit\", exitListener);\n\n      this.thread.postMessage({\n        host,\n      } as DnsLookupRequest);\n    });\n\n    this.cache.set(host, cached);\n    return cached;\n  }\n\n  close() {\n    return this.thread.terminate();\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.getHash = getHash;\nexports.createCurve = createCurve;\n/**\n * Utilities for short weierstrass curves, combined with noble-hashes.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nconst hmac_1 = require(\"@noble/hashes/hmac\");\nconst utils_1 = require(\"@noble/hashes/utils\");\nconst weierstrass_js_1 = require(\"./abstract/weierstrass.js\");\n/** connects noble-curves to noble-hashes */\nfunction getHash(hash) {\n    return {\n        hash,\n        hmac: (key, ...msgs) => (0, hmac_1.hmac)(hash, key, (0, utils_1.concatBytes)(...msgs)),\n        randomBytes: utils_1.randomBytes,\n    };\n}\nfunction createCurve(curveDef, defHash) {\n    const create = (hash) => (0, weierstrass_js_1.weierstrass)({ ...curveDef, ...getHash(hash) });\n    return { ...create(defHash), create };\n}\n//# sourceMappingURL=_shortw_utils.js.map","'use strict';\n\nmodule.exports = (flag, argv = process.argv) => {\n\tconst prefix = flag.startsWith('-') ? '' : (flag.length === 1 ? '-' : '--');\n\tconst position = argv.indexOf(prefix + flag);\n\tconst terminatorPosition = argv.indexOf('--');\n\treturn position !== -1 && (terminatorPosition === -1 || position < terminatorPosition);\n};\n","\n/**\n * This is the common logic for both the Node.js and web browser\n * implementations of `debug()`.\n */\n\nfunction setup(env) {\n\tcreateDebug.debug = createDebug;\n\tcreateDebug.default = createDebug;\n\tcreateDebug.coerce = coerce;\n\tcreateDebug.disable = disable;\n\tcreateDebug.enable = enable;\n\tcreateDebug.enabled = enabled;\n\tcreateDebug.humanize = require('ms');\n\tcreateDebug.destroy = destroy;\n\n\tObject.keys(env).forEach(key => {\n\t\tcreateDebug[key] = env[key];\n\t});\n\n\t/**\n\t* The currently active debug mode names, and names to skip.\n\t*/\n\n\tcreateDebug.names = [];\n\tcreateDebug.skips = [];\n\n\t/**\n\t* Map of special \"%n\" handling functions, for the debug \"format\" argument.\n\t*\n\t* Valid key names are a single, lower or upper-case letter, i.e. \"n\" and \"N\".\n\t*/\n\tcreateDebug.formatters = {};\n\n\t/**\n\t* Selects a color for a debug namespace\n\t* @param {String} namespace The namespace string for the debug instance to be colored\n\t* @return {Number|String} An ANSI color code for the given namespace\n\t* @api private\n\t*/\n\tfunction selectColor(namespace) {\n\t\tlet hash = 0;\n\n\t\tfor (let i = 0; i < namespace.length; i++) {\n\t\t\thash = ((hash << 5) - hash) + namespace.charCodeAt(i);\n\t\t\thash |= 0; // Convert to 32bit integer\n\t\t}\n\n\t\treturn createDebug.colors[Math.abs(hash) % createDebug.colors.length];\n\t}\n\tcreateDebug.selectColor = selectColor;\n\n\t/**\n\t* Create a debugger with the given `namespace`.\n\t*\n\t* @param {String} namespace\n\t* @return {Function}\n\t* @api public\n\t*/\n\tfunction createDebug(namespace) {\n\t\tlet prevTime;\n\t\tlet enableOverride = null;\n\t\tlet namespacesCache;\n\t\tlet enabledCache;\n\n\t\tfunction debug(...args) {\n\t\t\t// Disabled?\n\t\t\tif (!debug.enabled) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst self = debug;\n\n\t\t\t// Set `diff` timestamp\n\t\t\tconst curr = Number(new Date());\n\t\t\tconst ms = curr - (prevTime || curr);\n\t\t\tself.diff = ms;\n\t\t\tself.prev = prevTime;\n\t\t\tself.curr = curr;\n\t\t\tprevTime = curr;\n\n\t\t\targs[0] = createDebug.coerce(args[0]);\n\n\t\t\tif (typeof args[0] !== 'string') {\n\t\t\t\t// Anything else let's inspect with %O\n\t\t\t\targs.unshift('%O');\n\t\t\t}\n\n\t\t\t// Apply any `formatters` transformations\n\t\t\tlet index = 0;\n\t\t\targs[0] = args[0].replace(/%([a-zA-Z%])/g, (match, format) => {\n\t\t\t\t// If we encounter an escaped % then don't increase the array index\n\t\t\t\tif (match === '%%') {\n\t\t\t\t\treturn '%';\n\t\t\t\t}\n\t\t\t\tindex++;\n\t\t\t\tconst formatter = createDebug.formatters[format];\n\t\t\t\tif (typeof formatter === 'function') {\n\t\t\t\t\tconst val = args[index];\n\t\t\t\t\tmatch = formatter.call(self, val);\n\n\t\t\t\t\t// Now we need to remove `args[index]` since it's inlined in the `format`\n\t\t\t\t\targs.splice(index, 1);\n\t\t\t\t\tindex--;\n\t\t\t\t}\n\t\t\t\treturn match;\n\t\t\t});\n\n\t\t\t// Apply env-specific formatting (colors, etc.)\n\t\t\tcreateDebug.formatArgs.call(self, args);\n\n\t\t\tconst logFn = self.log || createDebug.log;\n\t\t\tlogFn.apply(self, args);\n\t\t}\n\n\t\tdebug.namespace = namespace;\n\t\tdebug.useColors = createDebug.useColors();\n\t\tdebug.color = createDebug.selectColor(namespace);\n\t\tdebug.extend = extend;\n\t\tdebug.destroy = createDebug.destroy; // XXX Temporary. Will be removed in the next major release.\n\n\t\tObject.defineProperty(debug, 'enabled', {\n\t\t\tenumerable: true,\n\t\t\tconfigurable: false,\n\t\t\tget: () => {\n\t\t\t\tif (enableOverride !== null) {\n\t\t\t\t\treturn enableOverride;\n\t\t\t\t}\n\t\t\t\tif (namespacesCache !== createDebug.namespaces) {\n\t\t\t\t\tnamespacesCache = createDebug.namespaces;\n\t\t\t\t\tenabledCache = createDebug.enabled(namespace);\n\t\t\t\t}\n\n\t\t\t\treturn enabledCache;\n\t\t\t},\n\t\t\tset: v => {\n\t\t\t\tenableOverride = v;\n\t\t\t}\n\t\t});\n\n\t\t// Env-specific initialization logic for debug instances\n\t\tif (typeof createDebug.init === 'function') {\n\t\t\tcreateDebug.init(debug);\n\t\t}\n\n\t\treturn debug;\n\t}\n\n\tfunction extend(namespace, delimiter) {\n\t\tconst newDebug = createDebug(this.namespace + (typeof delimiter === 'undefined' ? ':' : delimiter) + namespace);\n\t\tnewDebug.log = this.log;\n\t\treturn newDebug;\n\t}\n\n\t/**\n\t* Enables a debug mode by namespaces. This can include modes\n\t* separated by a colon and wildcards.\n\t*\n\t* @param {String} namespaces\n\t* @api public\n\t*/\n\tfunction enable(namespaces) {\n\t\tcreateDebug.save(namespaces);\n\t\tcreateDebug.namespaces = namespaces;\n\n\t\tcreateDebug.names = [];\n\t\tcreateDebug.skips = [];\n\n\t\tconst split = (typeof namespaces === 'string' ? namespaces : '')\n\t\t\t.trim()\n\t\t\t.replace(' ', ',')\n\t\t\t.split(',')\n\t\t\t.filter(Boolean);\n\n\t\tfor (const ns of split) {\n\t\t\tif (ns[0] === '-') {\n\t\t\t\tcreateDebug.skips.push(ns.slice(1));\n\t\t\t} else {\n\t\t\t\tcreateDebug.names.push(ns);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Checks if the given string matches a namespace template, honoring\n\t * asterisks as wildcards.\n\t *\n\t * @param {String} search\n\t * @param {String} template\n\t * @return {Boolean}\n\t */\n\tfunction matchesTemplate(search, template) {\n\t\tlet searchIndex = 0;\n\t\tlet templateIndex = 0;\n\t\tlet starIndex = -1;\n\t\tlet matchIndex = 0;\n\n\t\twhile (searchIndex < search.length) {\n\t\t\tif (templateIndex < template.length && (template[templateIndex] === search[searchIndex] || template[templateIndex] === '*')) {\n\t\t\t\t// Match character or proceed with wildcard\n\t\t\t\tif (template[templateIndex] === '*') {\n\t\t\t\t\tstarIndex = templateIndex;\n\t\t\t\t\tmatchIndex = searchIndex;\n\t\t\t\t\ttemplateIndex++; // Skip the '*'\n\t\t\t\t} else {\n\t\t\t\t\tsearchIndex++;\n\t\t\t\t\ttemplateIndex++;\n\t\t\t\t}\n\t\t\t} else if (starIndex !== -1) { // eslint-disable-line no-negated-condition\n\t\t\t\t// Backtrack to the last '*' and try to match more characters\n\t\t\t\ttemplateIndex = starIndex + 1;\n\t\t\t\tmatchIndex++;\n\t\t\t\tsearchIndex = matchIndex;\n\t\t\t} else {\n\t\t\t\treturn false; // No match\n\t\t\t}\n\t\t}\n\n\t\t// Handle trailing '*' in template\n\t\twhile (templateIndex < template.length && template[templateIndex] === '*') {\n\t\t\ttemplateIndex++;\n\t\t}\n\n\t\treturn templateIndex === template.length;\n\t}\n\n\t/**\n\t* Disable debug output.\n\t*\n\t* @return {String} namespaces\n\t* @api public\n\t*/\n\tfunction disable() {\n\t\tconst namespaces = [\n\t\t\t...createDebug.names,\n\t\t\t...createDebug.skips.map(namespace => '-' + namespace)\n\t\t].join(',');\n\t\tcreateDebug.enable('');\n\t\treturn namespaces;\n\t}\n\n\t/**\n\t* Returns true if the given mode name is enabled, false otherwise.\n\t*\n\t* @param {String} name\n\t* @return {Boolean}\n\t* @api public\n\t*/\n\tfunction enabled(name) {\n\t\tfor (const skip of createDebug.skips) {\n\t\t\tif (matchesTemplate(name, skip)) {\n\t\t\t\treturn false;\n\t\t\t}\n\t\t}\n\n\t\tfor (const ns of createDebug.names) {\n\t\t\tif (matchesTemplate(name, ns)) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\t/**\n\t* Coerce `val`.\n\t*\n\t* @param {Mixed} val\n\t* @return {Mixed}\n\t* @api private\n\t*/\n\tfunction coerce(val) {\n\t\tif (val instanceof Error) {\n\t\t\treturn val.stack || val.message;\n\t\t}\n\t\treturn val;\n\t}\n\n\t/**\n\t* XXX DO NOT USE. This is a temporary stub function.\n\t* XXX It WILL be removed in the next major release.\n\t*/\n\tfunction destroy() {\n\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t}\n\n\tcreateDebug.enable(createDebug.load());\n\n\treturn createDebug;\n}\n\nmodule.exports = setup;\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\nimport { ProtocolVersion } from \"../../handshake/binary\";\n\nexport interface DtlsPlaintextHeader {\n  contentType: number;\n  protocolVersion: {\n    major: number;\n    minor: number;\n  };\n  epoch: number;\n  sequenceNumber: number;\n  contentLen: number;\n}\n\nexport class MACHeader {\n  static readonly spec = {\n    epoch: types.uint16be,\n    sequenceNumber: types.uint48be,\n    contentType: types.uint8,\n    protocolVersion: ProtocolVersion,\n    contentLen: types.uint16be,\n  };\n\n  constructor(\n    public epoch: number,\n    public sequenceNumber: number,\n    public contentType: number,\n    public protocolVersion: { major: number; minor: number },\n    public contentLen: number,\n  ) {}\n\n  static createEmpty() {\n    return new MACHeader(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new MACHeader(\n      //@ts-ignore\n      ...Object.values(decode(buf, MACHeader.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, MACHeader.spec).slice();\n    return Buffer.from(res);\n  }\n}\n","import { ScryptedDevice, ScryptedDeviceBase, ScryptedDeviceType, ScryptedInterface } from \"@scrypted/sdk\";\nimport sdk from \"@scrypted/sdk\";\n\nconst { systemManager } = sdk;\n\n\nexport abstract class AutoenableMixinProvider extends ScryptedDeviceBase {\n    hasEnabledMixin: { [id: string]: string } = {};\n    pluginsComponent: Promise<any>;\n\n    constructor(nativeId?: string, public autoIncludeToken = 'v4') {\n        super(nativeId);\n\n        try {\n            this.hasEnabledMixin = JSON.parse(this.storage.getItem('hasEnabledMixin'));\n        }\n        catch (e) {\n            this.hasEnabledMixin = {};\n        }\n\n        this.pluginsComponent = systemManager.getComponent('plugins');\n\n        // watch for descriptor changes.\n        systemManager.listen(async (eventSource, eventDetails, eventData) => {\n            if (eventDetails.eventInterface !== ScryptedInterface.ScryptedDevice || eventDetails.property)\n                return;\n\n            this.maybeEnableMixin(eventSource);\n        });\n\n        process.nextTick(() => {\n            for (const id of Object.keys(systemManager.getSystemState())) {\n                const device = systemManager.getDeviceById(id);\n                this.maybeEnableMixin(device);\n            }\n        });\n    }\n\n    async shouldEnableMixin(device: ScryptedDevice) {\n        return true;\n    }\n\n    checkHasEnabledMixin(device: ScryptedDevice) {\n        return this.hasEnabledMixin[device.id] === this.autoIncludeToken;\n    }\n\n    shouldUnshiftMixin(device: ScryptedDevice) {\n        return false;\n    }\n\n    async maybeEnableMixin(device: ScryptedDevice) {\n        if (!device || device.mixins?.includes(this.id))\n            return;\n\n        if (this.checkHasEnabledMixin(device))\n            return;\n\n        const match = await this.canMixin(device.type, device.interfaces);\n        if (!match)\n            return;\n\n        if (!await this.shouldEnableMixin(device))\n            return;\n\n        this.log.i('auto enabling mixin for ' + device.name)\n        const mixins = (device.mixins || []).slice();\n        if (this.shouldUnshiftMixin(device))\n            mixins.unshift(this.id);\n        else\n            mixins.push(this.id);\n        const plugins = await this.pluginsComponent;\n        await plugins.setMixins(device.id, mixins);\n        this.setHasEnabledMixin(device.id);\n    }\n\n    setHasEnabledMixin(id: string) {\n        if (this.hasEnabledMixin[id] === this.autoIncludeToken)\n            return;\n        this.hasEnabledMixin[id] = this.autoIncludeToken;\n        this.storage.setItem('hasEnabledMixin', JSON.stringify(this.hasEnabledMixin));\n    }\n\n    abstract canMixin(type: ScryptedDeviceType | string, interfaces: string[]): Promise<string[] | null | undefined | void>;\n}\n","import { bufferReader, bufferWriter } from \"../../../common/src\";\nimport { RtcpHeader } from \"./header\";\nimport { RtcpReceiverInfo } from \"./rr\";\n\n// https://datatracker.ietf.org/doc/html/rfc3550#section-6.4.1\n//         0                   1                   2                   3\n//         0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// header |V=2|P|    RC   |   PT=SR=200   |             length            |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |                         SSRC of sender                        |\n//        +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+\n// sender |              NTP timestamp, most significant word             |\n// info   +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |             NTP timestamp, least significant word             |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |                         RTP timestamp                         |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |                     sender's packet count                     |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |                      sender's octet count                     |\n//        +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+\n// report |                 SSRC_1 (SSRC of first source)                 |\n// block  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//   1    | fraction lost |       cumulative number of packets lost       |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |           extended highest sequence number received           |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |                      interarrival jitter                      |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |                         last SR (LSR)                         |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//        |                   delay since last SR (DLSR)                  |\n//        +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+\n// report |                 SSRC_2 (SSRC of second source)                |\n// block  +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n//   2    :                               ...                             :\n//        +=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+=+\n//        |                  profile-specific extensions                  |\n//        +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\nexport class RtcpSrPacket {\n  ssrc = 0;\n  senderInfo!: RtcpSenderInfo;\n  reports: RtcpReceiverInfo[] = [];\n  static readonly type = 200;\n  readonly type = RtcpSrPacket.type;\n\n  constructor(props: Pick<RtcpSrPacket, \"senderInfo\"> & Partial<RtcpSrPacket>) {\n    Object.assign(this, props);\n  }\n\n  toJSON() {\n    return {\n      ssrc: this.ssrc,\n      senderInfo: this.senderInfo.toJSON(),\n      reports: this.reports.map((r) => r.toJSON()),\n    };\n  }\n\n  serialize() {\n    let payload = Buffer.alloc(4);\n    payload.writeUInt32BE(this.ssrc);\n    payload = Buffer.concat([payload, this.senderInfo.serialize()]);\n    payload = Buffer.concat([\n      payload,\n      ...this.reports.map((report) => report.serialize()),\n    ]);\n    return RtcpHeader.serialize(\n      RtcpSrPacket.type,\n      this.reports.length,\n      payload,\n      Math.floor(payload.length / 4),\n    );\n  }\n\n  static deSerialize(payload: Buffer, count: number) {\n    const ssrc = payload.readUInt32BE();\n    const senderInfo = RtcpSenderInfo.deSerialize(payload.subarray(4, 24));\n    let pos = 24;\n    const reports: RtcpReceiverInfo[] = [];\n    for (let _ = 0; _ < count; _++) {\n      reports.push(\n        RtcpReceiverInfo.deSerialize(payload.subarray(pos, pos + 24)),\n      );\n      pos += 24;\n    }\n    const packet = new RtcpSrPacket({ ssrc, senderInfo, reports });\n    return packet;\n  }\n}\n\nexport class RtcpSenderInfo {\n  ntpTimestamp!: bigint;\n  rtpTimestamp!: number;\n  packetCount!: number;\n  octetCount!: number;\n\n  constructor(props: Partial<RtcpSenderInfo> = {}) {\n    Object.assign(this, props);\n  }\n\n  toJSON() {\n    return {\n      ntpTimestamp: ntpTime2Sec(this.ntpTimestamp),\n      rtpTimestamp: this.rtpTimestamp,\n    };\n  }\n\n  serialize() {\n    return bufferWriter(\n      [8, 4, 4, 4],\n      [this.ntpTimestamp, this.rtpTimestamp, this.packetCount, this.octetCount],\n    );\n  }\n\n  static deSerialize(data: Buffer) {\n    const [ntpTimestamp, rtpTimestamp, packetCount, octetCount] = bufferReader(\n      data,\n      [8, 4, 4, 4],\n    );\n\n    return new RtcpSenderInfo({\n      ntpTimestamp,\n      rtpTimestamp,\n      packetCount,\n      octetCount,\n    });\n  }\n}\n\nexport const ntpTime2Sec = (ntp: bigint) => {\n  const [ntpSec, ntpMsec] = bufferReader(bufferWriter([8], [ntp]), [4, 4]);\n\n  return Number(`${ntpSec}.${ntpMsec}`);\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HashMD = void 0;\nexports.setBigUint64 = setBigUint64;\nexports.Chi = Chi;\nexports.Maj = Maj;\n/**\n * Internal Merkle-Damgard hash utils.\n * @module\n */\nconst _assert_js_1 = require(\"./_assert.js\");\nconst utils_js_1 = require(\"./utils.js\");\n/** Polyfill for Safari 14. https://caniuse.com/mdn-javascript_builtins_dataview_setbiguint64 */\nfunction setBigUint64(view, byteOffset, value, isLE) {\n    if (typeof view.setBigUint64 === 'function')\n        return view.setBigUint64(byteOffset, value, isLE);\n    const _32n = BigInt(32);\n    const _u32_max = BigInt(0xffffffff);\n    const wh = Number((value >> _32n) & _u32_max);\n    const wl = Number(value & _u32_max);\n    const h = isLE ? 4 : 0;\n    const l = isLE ? 0 : 4;\n    view.setUint32(byteOffset + h, wh, isLE);\n    view.setUint32(byteOffset + l, wl, isLE);\n}\n/** Choice: a ? b : c */\nfunction Chi(a, b, c) {\n    return (a & b) ^ (~a & c);\n}\n/** Majority function, true if any two inputs is true. */\nfunction Maj(a, b, c) {\n    return (a & b) ^ (a & c) ^ (b & c);\n}\n/**\n * Merkle-Damgard hash construction base class.\n * Could be used to create MD5, RIPEMD, SHA1, SHA2.\n */\nclass HashMD extends utils_js_1.Hash {\n    constructor(blockLen, outputLen, padOffset, isLE) {\n        super();\n        this.blockLen = blockLen;\n        this.outputLen = outputLen;\n        this.padOffset = padOffset;\n        this.isLE = isLE;\n        this.finished = false;\n        this.length = 0;\n        this.pos = 0;\n        this.destroyed = false;\n        this.buffer = new Uint8Array(blockLen);\n        this.view = (0, utils_js_1.createView)(this.buffer);\n    }\n    update(data) {\n        (0, _assert_js_1.aexists)(this);\n        const { view, buffer, blockLen } = this;\n        data = (0, utils_js_1.toBytes)(data);\n        const len = data.length;\n        for (let pos = 0; pos < len;) {\n            const take = Math.min(blockLen - this.pos, len - pos);\n            // Fast path: we have at least one block in input, cast it to view and process\n            if (take === blockLen) {\n                const dataView = (0, utils_js_1.createView)(data);\n                for (; blockLen <= len - pos; pos += blockLen)\n                    this.process(dataView, pos);\n                continue;\n            }\n            buffer.set(data.subarray(pos, pos + take), this.pos);\n            this.pos += take;\n            pos += take;\n            if (this.pos === blockLen) {\n                this.process(view, 0);\n                this.pos = 0;\n            }\n        }\n        this.length += data.length;\n        this.roundClean();\n        return this;\n    }\n    digestInto(out) {\n        (0, _assert_js_1.aexists)(this);\n        (0, _assert_js_1.aoutput)(out, this);\n        this.finished = true;\n        // Padding\n        // We can avoid allocation of buffer for padding completely if it\n        // was previously not allocated here. But it won't change performance.\n        const { buffer, view, blockLen, isLE } = this;\n        let { pos } = this;\n        // append the bit '1' to the message\n        buffer[pos++] = 0b10000000;\n        this.buffer.subarray(pos).fill(0);\n        // we have less than padOffset left in buffer, so we cannot put length in\n        // current block, need process it and pad again\n        if (this.padOffset > blockLen - pos) {\n            this.process(view, 0);\n            pos = 0;\n        }\n        // Pad until full block byte with zeros\n        for (let i = pos; i < blockLen; i++)\n            buffer[i] = 0;\n        // Note: sha512 requires length to be 128bit integer, but length in JS will overflow before that\n        // You need to write around 2 exabytes (u64_max / 8 / (1024**6)) for this to happen.\n        // So we just write lowest 64 bits of that value.\n        setBigUint64(view, blockLen - 8, BigInt(this.length * 8), isLE);\n        this.process(view, 0);\n        const oview = (0, utils_js_1.createView)(out);\n        const len = this.outputLen;\n        // NOTE: we do division by 4 later, which should be fused in single op with modulo by JIT\n        if (len % 4)\n            throw new Error('_sha2: outputLen should be aligned to 32bit');\n        const outLen = len / 4;\n        const state = this.get();\n        if (outLen > state.length)\n            throw new Error('_sha2: outputLen bigger than state');\n        for (let i = 0; i < outLen; i++)\n            oview.setUint32(4 * i, state[i], isLE);\n    }\n    digest() {\n        const { buffer, outputLen } = this;\n        this.digestInto(buffer);\n        const res = buffer.slice(0, outputLen);\n        this.destroy();\n        return res;\n    }\n    _cloneInto(to) {\n        to || (to = new this.constructor());\n        to.set(...this.get());\n        const { blockLen, buffer, length, finished, destroyed, pos } = this;\n        to.length = length;\n        to.pos = pos;\n        to.finished = finished;\n        to.destroyed = destroyed;\n        if (length % blockLen)\n            to.buffer.set(buffer);\n        return to;\n    }\n}\nexports.HashMD = HashMD;\n//# sourceMappingURL=_md.js.map","module.exports = require(\"perf_hooks\");","import { ChildProcess } from \"child_process\";\nimport process from 'process';\nimport { sleep } from \"./sleep\";\n\nconst filtered = [\n    'decode_slice_header error',\n    'no frame!',\n    'non-existing PPS',\n];\n\nexport async function safeKillFFmpeg(cp: ChildProcess) {\n    if (!cp)\n        return;\n    if (cp.exitCode != null)\n        return;\n    await new Promise(async resolve => {\n        cp.on('exit', resolve);\n        // this will allow ffmpeg to send rtsp TEARDOWN etc\n        try {\n            cp.stdin!.on('error', () => { });\n            cp.stdin!.write('q\\n');\n        }\n        catch (e) {\n        }\n\n        await sleep(2000);\n        for (const f of cp.stdio) {\n            try {\n                f?.destroy();\n            }\n            catch (e) {\n            }\n        }\n        cp.kill();\n        await sleep(2000);\n        cp.kill('SIGKILL');\n    });\n}\n\nexport function ffmpegLogInitialOutput(console: Console, cp: ChildProcess, forever?: boolean, storage?: Storage) {\n    if (!console)\n        return;\n\n    const SCRYPTED_FFMPEG_NOISY = !!process.env.SCRYPTED_FFMPEG_NOISY || !!storage?.getItem('SCRYPTED_FFMPEG_NOISY');\n\n    function logger(log: (str: string) => void): (buffer: Buffer) => void {\n        const ret = (buffer: Buffer) => {\n            const str = buffer.toString();\n\n            for (const filter of filtered) {\n                if (str.indexOf(filter) !== -1)\n                    return;\n            }\n\n            if (!SCRYPTED_FFMPEG_NOISY && !forever && (str.indexOf('frame=') !== -1 || str.indexOf('size=') !== -1)) {\n                log(str);\n                log('video/audio detected, discarding further input');\n                cp.stdout!.removeListener('data', ret);\n                cp.stderr!.removeListener('data', ret);\n                return;\n            }\n\n            log(str);\n        }\n\n        return ret;\n    };\n    cp.stdout?.on('data', logger(console.log));\n    cp.stderr?.on('data', logger(console.error));\n    cp.on('exit', () => console.log('ffmpeg exited'));\n}\n\nexport function safePrintFFmpegArguments(console: Console, args: string[]) {\n    if (!console)\n        return;\n    const ret = [];\n    let redactNext = false;\n    for (const arg of args) {\n        try {\n            if (redactNext) {\n                const url = new URL(arg);\n                ret.push(`${url.protocol}[REDACTED]`)\n            }\n            else {\n                ret.push(arg);\n            }\n        }\n        catch (e) {\n            ret.push(arg);\n        }\n\n        // input arguments may contain passwords.\n        redactNext = arg === '-i';\n    }\n\n    console.log(ret.join(' '));\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport { FragmentedHandshake } from \"../../record/message/fragment\";\nimport type { Handshake } from \"../../typings/domain\";\nimport { ASN11Cert } from \"../binary\";\nimport { HandshakeType } from \"../const\";\n\n// 7.4.2.  Server Certificate\n// 7.4.6.  Client Certificate\n\nexport class Certificate implements Handshake {\n  msgType = HandshakeType.certificate_11;\n  messageSeq?: number;\n  static readonly spec = {\n    certificateList: types.array(ASN11Cert, types.uint24be, \"bytes\"),\n  };\n\n  constructor(public certificateList: Buffer[]) {}\n\n  static createEmpty() {\n    return new Certificate(undefined as any);\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new Certificate(\n      //@ts-ignore\n      ...Object.values(decode(buf, Certificate.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, Certificate.spec).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","'use strict'\n\nvar nextTick = nextTickArgs\nprocess.nextTick(upgrade, 42) // pass 42 and see if upgrade is called with it\n\nmodule.exports = thunky\n\nfunction thunky (fn) {\n  var state = run\n  return thunk\n\n  function thunk (callback) {\n    state(callback || noop)\n  }\n\n  function run (callback) {\n    var stack = [callback]\n    state = wait\n    fn(done)\n\n    function wait (callback) {\n      stack.push(callback)\n    }\n\n    function done (err) {\n      var args = arguments\n      state = isError(err) ? run : finished\n      while (stack.length) finished(stack.shift())\n\n      function finished (callback) {\n        nextTick(apply, callback, args)\n      }\n    }\n  }\n}\n\nfunction isError (err) { // inlined from util so this works in the browser\n  return Object.prototype.toString.call(err) === '[object Error]'\n}\n\nfunction noop () {}\n\nfunction apply (callback, args) {\n  callback.apply(null, args)\n}\n\nfunction upgrade (val) {\n  if (val === 42) nextTick = process.nextTick\n}\n\nfunction nextTickArgs (fn, a, b) {\n  process.nextTick(function () {\n    fn(a, b)\n  })\n}\n","import { debug } from \"../../imports/common\";\nimport type { RtcpHeader } from \"../header\";\nimport { RtcpTransportLayerFeedbackType } from \"./const\";\nimport { GenericNack } from \"./nack\";\nimport { TransportWideCC } from \"./twcc\";\n\nconst log = debug(\"werift-rtp:packages/rtp/rtcp/rtpfb/index\");\n\n// 0                   1                   2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |V=2|P|   FMT   |       PT      |          length               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                  SSRC of packet sender                        |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                  SSRC of media source                         |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// :            Feedback Control Information (FCI)                 :\n// :                                                               :\n\ntype Feedback = GenericNack | TransportWideCC;\n\nexport class RtcpTransportLayerFeedback {\n  static readonly type = RtcpTransportLayerFeedbackType;\n  readonly type = RtcpTransportLayerFeedback.type;\n  feedback!: Feedback;\n  header!: RtcpHeader;\n\n  constructor(props: Partial<RtcpTransportLayerFeedback> = {}) {\n    Object.assign(this, props);\n  }\n\n  serialize() {\n    const payload = this.feedback.serialize();\n    return payload;\n  }\n\n  static deSerialize(data: Buffer, header: RtcpHeader) {\n    let feedback: Feedback | undefined;\n\n    switch (header.count) {\n      case GenericNack.count:\n        feedback = GenericNack.deSerialize(data, header);\n        break;\n      case TransportWideCC.count:\n        feedback = TransportWideCC.deSerialize(data, header);\n        break;\n      default:\n        log(\"unknown rtpfb packet\", header.count);\n        break;\n    }\n\n    return new RtcpTransportLayerFeedback({ feedback, header });\n  }\n}\n","import { Event } from \"../../imports/common\";\n\nimport { Int, type TransportWideCC } from \"../../imports/rtp\";\n\nimport { milliTime } from \"../../utils\";\nimport { CumulativeResult } from \"./cumulativeResult\";\n\nconst COUNTER_MAX = 20;\nconst SCORE_MAX = 10;\n\nexport class SenderBandwidthEstimator {\n  congestion = false;\n\n  readonly onAvailableBitrate = new Event<[number]>();\n  /**congestion occur or not */\n  readonly onCongestion = new Event<[boolean]>();\n  readonly onCongestionScore = new Event<[number]>();\n\n  private congestionCounter = 0;\n  private cumulativeResult = new CumulativeResult();\n  private sentInfos: { [key: number]: SentInfo } = {};\n  private _congestionScore = 1;\n  /**1~10 big is worth*/\n  get congestionScore() {\n    return this._congestionScore;\n  }\n  set congestionScore(v: number) {\n    this._congestionScore = v;\n    this.onCongestionScore.execute(v);\n  }\n  private _availableBitrate: number = 0;\n  get availableBitrate() {\n    return this._availableBitrate;\n  }\n  set availableBitrate(v: number) {\n    this._availableBitrate = v;\n    this.onAvailableBitrate.execute(v);\n  }\n\n  constructor() {}\n\n  receiveTWCC(feedback: TransportWideCC) {\n    const nowMs = milliTime();\n    const elapsedMs = nowMs - this.cumulativeResult.firstPacketSentAtMs;\n    if (elapsedMs > 1000) {\n      this.cumulativeResult.reset();\n\n      // Congestion may be occurring.\n\n      if (this.congestionCounter < COUNTER_MAX) {\n        this.congestionCounter++;\n      } else if (this.congestionScore < SCORE_MAX) {\n        this.congestionScore++;\n      }\n\n      if (this.congestionCounter >= COUNTER_MAX && !this.congestion) {\n        this.congestion = true;\n        this.onCongestion.execute(this.congestion);\n      }\n    }\n\n    for (const result of feedback.packetResults) {\n      if (!result.received) continue;\n\n      const wideSeq = result.sequenceNumber;\n      const info = this.sentInfos[wideSeq];\n      if (!info) continue;\n      if (!result.receivedAtMs) continue;\n\n      this.cumulativeResult.addPacket(\n        info.size,\n        info.sendingAtMs,\n        result.receivedAtMs,\n      );\n    }\n\n    if (elapsedMs >= 100 && this.cumulativeResult.numPackets >= 20) {\n      this.availableBitrate = Math.min(\n        this.cumulativeResult.sendBitrate,\n        this.cumulativeResult.receiveBitrate,\n      );\n      this.cumulativeResult.reset();\n\n      if (this.congestionCounter > -COUNTER_MAX) {\n        const maxBonus = Int(COUNTER_MAX / 2) + 1;\n        const minBonus = Int(COUNTER_MAX / 4) + 1;\n        const bonus =\n          maxBonus - ((maxBonus - minBonus) / 10) * this.congestionScore;\n\n        this.congestionCounter = this.congestionCounter - bonus;\n      }\n\n      if (this.congestionCounter <= -COUNTER_MAX) {\n        if (this.congestionScore > 1) {\n          this.congestionScore--;\n          this.onCongestion.execute(false);\n        }\n        this.congestionCounter = 0;\n      }\n\n      if (this.congestionCounter <= 0 && this.congestion) {\n        this.congestion = false;\n        this.onCongestion.execute(this.congestion);\n      }\n    }\n  }\n\n  rtpPacketSent(sentInfo: SentInfo) {\n    Object.keys(sentInfo)\n      .map((v) => Number(v))\n      .sort()\n      .filter((seq) => seq < sentInfo.wideSeq)\n      .forEach((seq) => {\n        delete this.sentInfos[seq];\n      });\n    this.sentInfos[sentInfo.wideSeq] = sentInfo;\n  }\n}\n\nexport interface SentInfo {\n  wideSeq: number;\n  /**\n   * byte\n   */\n  size: number;\n  isProbation?: boolean;\n  sendingAtMs: number;\n  sentAtMs: number;\n}\n","const ip = exports;\nconst { Buffer } = require('buffer');\nconst os = require('os');\n\nip.toBuffer = function (ip, buff, offset) {\n  offset = ~~offset;\n\n  let result;\n\n  if (this.isV4Format(ip)) {\n    result = buff || Buffer.alloc(offset + 4);\n    ip.split(/\\./g).map((byte) => {\n      result[offset++] = parseInt(byte, 10) & 0xff;\n    });\n  } else if (this.isV6Format(ip)) {\n    const sections = ip.split(':', 8);\n\n    let i;\n    for (i = 0; i < sections.length; i++) {\n      const isv4 = this.isV4Format(sections[i]);\n      let v4Buffer;\n\n      if (isv4) {\n        v4Buffer = this.toBuffer(sections[i]);\n        sections[i] = v4Buffer.slice(0, 2).toString('hex');\n      }\n\n      if (v4Buffer && ++i < 8) {\n        sections.splice(i, 0, v4Buffer.slice(2, 4).toString('hex'));\n      }\n    }\n\n    if (sections[0] === '') {\n      while (sections.length < 8) sections.unshift('0');\n    } else if (sections[sections.length - 1] === '') {\n      while (sections.length < 8) sections.push('0');\n    } else if (sections.length < 8) {\n      for (i = 0; i < sections.length && sections[i] !== ''; i++);\n      const argv = [i, 1];\n      for (i = 9 - sections.length; i > 0; i--) {\n        argv.push('0');\n      }\n      sections.splice(...argv);\n    }\n\n    result = buff || Buffer.alloc(offset + 16);\n    for (i = 0; i < sections.length; i++) {\n      const word = parseInt(sections[i], 16);\n      result[offset++] = (word >> 8) & 0xff;\n      result[offset++] = word & 0xff;\n    }\n  }\n\n  if (!result) {\n    throw Error(`Invalid ip address: ${ip}`);\n  }\n\n  return result;\n};\n\nip.toString = function (buff, offset, length) {\n  offset = ~~offset;\n  length = length || (buff.length - offset);\n\n  let result = [];\n  if (length === 4) {\n    // IPv4\n    for (let i = 0; i < length; i++) {\n      result.push(buff[offset + i]);\n    }\n    result = result.join('.');\n  } else if (length === 16) {\n    // IPv6\n    for (let i = 0; i < length; i += 2) {\n      result.push(buff.readUInt16BE(offset + i).toString(16));\n    }\n    result = result.join(':');\n    result = result.replace(/(^|:)0(:0)*:0(:|$)/, '$1::$3');\n    result = result.replace(/:{3,4}/, '::');\n  }\n\n  return result;\n};\n\nconst ipv4Regex = /^(\\d{1,3}\\.){3,3}\\d{1,3}$/;\nconst ipv6Regex = /^(::)?(((\\d{1,3}\\.){3}(\\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;\n\nip.isV4Format = function (ip) {\n  return ipv4Regex.test(ip);\n};\n\nip.isV6Format = function (ip) {\n  return ipv6Regex.test(ip);\n};\n\nfunction _normalizeFamily(family) {\n  if (family === 4) {\n    return 'ipv4';\n  }\n  if (family === 6) {\n    return 'ipv6';\n  }\n  return family ? family.toLowerCase() : 'ipv4';\n}\n\nip.fromPrefixLen = function (prefixlen, family) {\n  if (prefixlen > 32) {\n    family = 'ipv6';\n  } else {\n    family = _normalizeFamily(family);\n  }\n\n  let len = 4;\n  if (family === 'ipv6') {\n    len = 16;\n  }\n  const buff = Buffer.alloc(len);\n\n  for (let i = 0, n = buff.length; i < n; ++i) {\n    let bits = 8;\n    if (prefixlen < 8) {\n      bits = prefixlen;\n    }\n    prefixlen -= bits;\n\n    buff[i] = ~(0xff >> bits) & 0xff;\n  }\n\n  return ip.toString(buff);\n};\n\nip.mask = function (addr, mask) {\n  addr = ip.toBuffer(addr);\n  mask = ip.toBuffer(mask);\n\n  const result = Buffer.alloc(Math.max(addr.length, mask.length));\n\n  // Same protocol - do bitwise and\n  let i;\n  if (addr.length === mask.length) {\n    for (i = 0; i < addr.length; i++) {\n      result[i] = addr[i] & mask[i];\n    }\n  } else if (mask.length === 4) {\n    // IPv6 address and IPv4 mask\n    // (Mask low bits)\n    for (i = 0; i < mask.length; i++) {\n      result[i] = addr[addr.length - 4 + i] & mask[i];\n    }\n  } else {\n    // IPv6 mask and IPv4 addr\n    for (i = 0; i < result.length - 6; i++) {\n      result[i] = 0;\n    }\n\n    // ::ffff:ipv4\n    result[10] = 0xff;\n    result[11] = 0xff;\n    for (i = 0; i < addr.length; i++) {\n      result[i + 12] = addr[i] & mask[i + 12];\n    }\n    i += 12;\n  }\n  for (; i < result.length; i++) {\n    result[i] = 0;\n  }\n\n  return ip.toString(result);\n};\n\nip.cidr = function (cidrString) {\n  const cidrParts = cidrString.split('/');\n\n  const addr = cidrParts[0];\n  if (cidrParts.length !== 2) {\n    throw new Error(`invalid CIDR subnet: ${addr}`);\n  }\n\n  const mask = ip.fromPrefixLen(parseInt(cidrParts[1], 10));\n\n  return ip.mask(addr, mask);\n};\n\nip.subnet = function (addr, mask) {\n  const networkAddress = ip.toLong(ip.mask(addr, mask));\n\n  // Calculate the mask's length.\n  const maskBuffer = ip.toBuffer(mask);\n  let maskLength = 0;\n\n  for (let i = 0; i < maskBuffer.length; i++) {\n    if (maskBuffer[i] === 0xff) {\n      maskLength += 8;\n    } else {\n      let octet = maskBuffer[i] & 0xff;\n      while (octet) {\n        octet = (octet << 1) & 0xff;\n        maskLength++;\n      }\n    }\n  }\n\n  const numberOfAddresses = 2 ** (32 - maskLength);\n\n  return {\n    networkAddress: ip.fromLong(networkAddress),\n    firstAddress: numberOfAddresses <= 2\n      ? ip.fromLong(networkAddress)\n      : ip.fromLong(networkAddress + 1),\n    lastAddress: numberOfAddresses <= 2\n      ? ip.fromLong(networkAddress + numberOfAddresses - 1)\n      : ip.fromLong(networkAddress + numberOfAddresses - 2),\n    broadcastAddress: ip.fromLong(networkAddress + numberOfAddresses - 1),\n    subnetMask: mask,\n    subnetMaskLength: maskLength,\n    numHosts: numberOfAddresses <= 2\n      ? numberOfAddresses : numberOfAddresses - 2,\n    length: numberOfAddresses,\n    contains(other) {\n      return networkAddress === ip.toLong(ip.mask(other, mask));\n    },\n  };\n};\n\nip.cidrSubnet = function (cidrString) {\n  const cidrParts = cidrString.split('/');\n\n  const addr = cidrParts[0];\n  if (cidrParts.length !== 2) {\n    throw new Error(`invalid CIDR subnet: ${addr}`);\n  }\n\n  const mask = ip.fromPrefixLen(parseInt(cidrParts[1], 10));\n\n  return ip.subnet(addr, mask);\n};\n\nip.not = function (addr) {\n  const buff = ip.toBuffer(addr);\n  for (let i = 0; i < buff.length; i++) {\n    buff[i] = 0xff ^ buff[i];\n  }\n  return ip.toString(buff);\n};\n\nip.or = function (a, b) {\n  a = ip.toBuffer(a);\n  b = ip.toBuffer(b);\n\n  // same protocol\n  if (a.length === b.length) {\n    for (let i = 0; i < a.length; ++i) {\n      a[i] |= b[i];\n    }\n    return ip.toString(a);\n\n  // mixed protocols\n  }\n  let buff = a;\n  let other = b;\n  if (b.length > a.length) {\n    buff = b;\n    other = a;\n  }\n\n  const offset = buff.length - other.length;\n  for (let i = offset; i < buff.length; ++i) {\n    buff[i] |= other[i - offset];\n  }\n\n  return ip.toString(buff);\n};\n\nip.isEqual = function (a, b) {\n  a = ip.toBuffer(a);\n  b = ip.toBuffer(b);\n\n  // Same protocol\n  if (a.length === b.length) {\n    for (let i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n\n  // Swap\n  if (b.length === 4) {\n    const t = b;\n    b = a;\n    a = t;\n  }\n\n  // a - IPv4, b - IPv6\n  for (let i = 0; i < 10; i++) {\n    if (b[i] !== 0) return false;\n  }\n\n  const word = b.readUInt16BE(10);\n  if (word !== 0 && word !== 0xffff) return false;\n\n  for (let i = 0; i < 4; i++) {\n    if (a[i] !== b[i + 12]) return false;\n  }\n\n  return true;\n};\n\nip.isPrivate = function (addr) {\n  // check loopback addresses first\n  if (ip.isLoopback(addr)) {\n    return true;\n  }\n\n  // ensure the ipv4 address is valid\n  if (!ip.isV6Format(addr)) {\n    const ipl = ip.normalizeToLong(addr);\n    if (ipl < 0) {\n      throw new Error('invalid ipv4 address');\n    }\n    // normalize the address for the private range checks that follow\n    addr = ip.fromLong(ipl);\n  }\n\n  // check private ranges\n  return /^(::f{4}:)?10\\.([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})$/i.test(addr)\n    || /^(::f{4}:)?192\\.168\\.([0-9]{1,3})\\.([0-9]{1,3})$/i.test(addr)\n    || /^(::f{4}:)?172\\.(1[6-9]|2\\d|30|31)\\.([0-9]{1,3})\\.([0-9]{1,3})$/i\n      .test(addr)\n    || /^(::f{4}:)?169\\.254\\.([0-9]{1,3})\\.([0-9]{1,3})$/i.test(addr)\n    || /^f[cd][0-9a-f]{2}:/i.test(addr)\n    || /^fe80:/i.test(addr)\n    || /^::1$/.test(addr)\n    || /^::$/.test(addr);\n};\n\nip.isPublic = function (addr) {\n  return !ip.isPrivate(addr);\n};\n\nip.isLoopback = function (addr) {\n  // If addr is an IPv4 address in long integer form (no dots and no colons), convert it\n  if (!/\\./.test(addr) && !/:/.test(addr)) {\n    addr = ip.fromLong(Number(addr));\n  }\n\n  return /^(::f{4}:)?127\\.([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})/\n    .test(addr)\n    || /^0177\\./.test(addr)\n    || /^0x7f\\./i.test(addr)\n    || /^fe80::1$/i.test(addr)\n    || /^::1$/.test(addr)\n    || /^::$/.test(addr);\n};\n\nip.loopback = function (family) {\n  //\n  // Default to `ipv4`\n  //\n  family = _normalizeFamily(family);\n\n  if (family !== 'ipv4' && family !== 'ipv6') {\n    throw new Error('family must be ipv4 or ipv6');\n  }\n\n  return family === 'ipv4' ? '127.0.0.1' : 'fe80::1';\n};\n\n//\n// ### function address (name, family)\n// #### @name {string|'public'|'private'} **Optional** Name or security\n//      of the network interface.\n// #### @family {ipv4|ipv6} **Optional** IP family of the address (defaults\n//      to ipv4).\n//\n// Returns the address for the network interface on the current system with\n// the specified `name`:\n//   * String: First `family` address of the interface.\n//             If not found see `undefined`.\n//   * 'public': the first public ip address of family.\n//   * 'private': the first private ip address of family.\n//   * undefined: First address with `ipv4` or loopback address `127.0.0.1`.\n//\nip.address = function (name, family) {\n  const interfaces = os.networkInterfaces();\n\n  //\n  // Default to `ipv4`\n  //\n  family = _normalizeFamily(family);\n\n  //\n  // If a specific network interface has been named,\n  // return the address.\n  //\n  if (name && name !== 'private' && name !== 'public') {\n    const res = interfaces[name].filter((details) => {\n      const itemFamily = _normalizeFamily(details.family);\n      return itemFamily === family;\n    });\n    if (res.length === 0) {\n      return undefined;\n    }\n    return res[0].address;\n  }\n\n  const all = Object.keys(interfaces).map((nic) => {\n    //\n    // Note: name will only be `public` or `private`\n    // when this is called.\n    //\n    const addresses = interfaces[nic].filter((details) => {\n      details.family = _normalizeFamily(details.family);\n      if (details.family !== family || ip.isLoopback(details.address)) {\n        return false;\n      } if (!name) {\n        return true;\n      }\n\n      return name === 'public' ? ip.isPrivate(details.address)\n        : ip.isPublic(details.address);\n    });\n\n    return addresses.length ? addresses[0].address : undefined;\n  }).filter(Boolean);\n\n  return !all.length ? ip.loopback(family) : all[0];\n};\n\nip.toLong = function (ip) {\n  let ipl = 0;\n  ip.split('.').forEach((octet) => {\n    ipl <<= 8;\n    ipl += parseInt(octet);\n  });\n  return (ipl >>> 0);\n};\n\nip.fromLong = function (ipl) {\n  return (`${ipl >>> 24}.${\n    ipl >> 16 & 255}.${\n    ipl >> 8 & 255}.${\n    ipl & 255}`);\n};\n\nip.normalizeToLong = function (addr) {\n  const parts = addr.split('.').map(part => {\n    // Handle hexadecimal format\n    if (part.startsWith('0x') || part.startsWith('0X')) {\n      return parseInt(part, 16);\n    }\n    // Handle octal format (strictly digits 0-7 after a leading zero)\n    else if (part.startsWith('0') && part !== '0' && /^[0-7]+$/.test(part)) {\n      return parseInt(part, 8);\n    }\n    // Handle decimal format, reject invalid leading zeros\n    else if (/^[1-9]\\d*$/.test(part) || part === '0') {\n      return parseInt(part, 10);\n    }\n    // Return NaN for invalid formats to indicate parsing failure\n    else {\n      return NaN;\n    }\n  });\n\n  if (parts.some(isNaN)) return -1; // Indicate error with -1\n\n  let val = 0;\n  const n = parts.length;\n\n  switch (n) {\n  case 1:\n    val = parts[0];\n    break;\n  case 2:\n    if (parts[0] > 0xff || parts[1] > 0xffffff) return -1;\n    val = (parts[0] << 24) | (parts[1] & 0xffffff);\n    break;\n  case 3:\n    if (parts[0] > 0xff || parts[1] > 0xff || parts[2] > 0xffff) return -1;\n    val = (parts[0] << 24) | (parts[1] << 16) | (parts[2] & 0xffff);\n    break;\n  case 4:\n    if (parts.some(part => part > 0xff)) return -1;\n    val = (parts[0] << 24) | (parts[1] << 16) | (parts[2] << 8) | parts[3];\n    break;\n  default:\n    return -1; // Error case\n  }\n\n  return val >>> 0;\n};\n","/* eslint-env browser */\n\n/**\n * This is the web browser implementation of `debug()`.\n */\n\nexports.formatArgs = formatArgs;\nexports.save = save;\nexports.load = load;\nexports.useColors = useColors;\nexports.storage = localstorage();\nexports.destroy = (() => {\n\tlet warned = false;\n\n\treturn () => {\n\t\tif (!warned) {\n\t\t\twarned = true;\n\t\t\tconsole.warn('Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.');\n\t\t}\n\t};\n})();\n\n/**\n * Colors.\n */\n\nexports.colors = [\n\t'#0000CC',\n\t'#0000FF',\n\t'#0033CC',\n\t'#0033FF',\n\t'#0066CC',\n\t'#0066FF',\n\t'#0099CC',\n\t'#0099FF',\n\t'#00CC00',\n\t'#00CC33',\n\t'#00CC66',\n\t'#00CC99',\n\t'#00CCCC',\n\t'#00CCFF',\n\t'#3300CC',\n\t'#3300FF',\n\t'#3333CC',\n\t'#3333FF',\n\t'#3366CC',\n\t'#3366FF',\n\t'#3399CC',\n\t'#3399FF',\n\t'#33CC00',\n\t'#33CC33',\n\t'#33CC66',\n\t'#33CC99',\n\t'#33CCCC',\n\t'#33CCFF',\n\t'#6600CC',\n\t'#6600FF',\n\t'#6633CC',\n\t'#6633FF',\n\t'#66CC00',\n\t'#66CC33',\n\t'#9900CC',\n\t'#9900FF',\n\t'#9933CC',\n\t'#9933FF',\n\t'#99CC00',\n\t'#99CC33',\n\t'#CC0000',\n\t'#CC0033',\n\t'#CC0066',\n\t'#CC0099',\n\t'#CC00CC',\n\t'#CC00FF',\n\t'#CC3300',\n\t'#CC3333',\n\t'#CC3366',\n\t'#CC3399',\n\t'#CC33CC',\n\t'#CC33FF',\n\t'#CC6600',\n\t'#CC6633',\n\t'#CC9900',\n\t'#CC9933',\n\t'#CCCC00',\n\t'#CCCC33',\n\t'#FF0000',\n\t'#FF0033',\n\t'#FF0066',\n\t'#FF0099',\n\t'#FF00CC',\n\t'#FF00FF',\n\t'#FF3300',\n\t'#FF3333',\n\t'#FF3366',\n\t'#FF3399',\n\t'#FF33CC',\n\t'#FF33FF',\n\t'#FF6600',\n\t'#FF6633',\n\t'#FF9900',\n\t'#FF9933',\n\t'#FFCC00',\n\t'#FFCC33'\n];\n\n/**\n * Currently only WebKit-based Web Inspectors, Firefox >= v31,\n * and the Firebug extension (any Firefox version) are known\n * to support \"%c\" CSS customizations.\n *\n * TODO: add a `localStorage` variable to explicitly enable/disable colors\n */\n\n// eslint-disable-next-line complexity\nfunction useColors() {\n\t// NB: In an Electron preload script, document will be defined but not fully\n\t// initialized. Since we know we're in Chrome, we'll just detect this case\n\t// explicitly\n\tif (typeof window !== 'undefined' && window.process && (window.process.type === 'renderer' || window.process.__nwjs)) {\n\t\treturn true;\n\t}\n\n\t// Internet Explorer and Edge do not support colors.\n\tif (typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/(edge|trident)\\/(\\d+)/)) {\n\t\treturn false;\n\t}\n\n\tlet m;\n\n\t// Is webkit? http://stackoverflow.com/a/16459606/376773\n\t// document is undefined in react-native: https://github.com/facebook/react-native/pull/1632\n\t// eslint-disable-next-line no-return-assign\n\treturn (typeof document !== 'undefined' && document.documentElement && document.documentElement.style && document.documentElement.style.WebkitAppearance) ||\n\t\t// Is firebug? http://stackoverflow.com/a/398120/376773\n\t\t(typeof window !== 'undefined' && window.console && (window.console.firebug || (window.console.exception && window.console.table))) ||\n\t\t// Is firefox >= v31?\n\t\t// https://developer.mozilla.org/en-US/docs/Tools/Web_Console#Styling_messages\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && (m = navigator.userAgent.toLowerCase().match(/firefox\\/(\\d+)/)) && parseInt(m[1], 10) >= 31) ||\n\t\t// Double check webkit in userAgent just in case we are in a worker\n\t\t(typeof navigator !== 'undefined' && navigator.userAgent && navigator.userAgent.toLowerCase().match(/applewebkit\\/(\\d+)/));\n}\n\n/**\n * Colorize log arguments if enabled.\n *\n * @api public\n */\n\nfunction formatArgs(args) {\n\targs[0] = (this.useColors ? '%c' : '') +\n\t\tthis.namespace +\n\t\t(this.useColors ? ' %c' : ' ') +\n\t\targs[0] +\n\t\t(this.useColors ? '%c ' : ' ') +\n\t\t'+' + module.exports.humanize(this.diff);\n\n\tif (!this.useColors) {\n\t\treturn;\n\t}\n\n\tconst c = 'color: ' + this.color;\n\targs.splice(1, 0, c, 'color: inherit');\n\n\t// The final \"%c\" is somewhat tricky, because there could be other\n\t// arguments passed either before or after the %c, so we need to\n\t// figure out the correct index to insert the CSS into\n\tlet index = 0;\n\tlet lastC = 0;\n\targs[0].replace(/%[a-zA-Z%]/g, match => {\n\t\tif (match === '%%') {\n\t\t\treturn;\n\t\t}\n\t\tindex++;\n\t\tif (match === '%c') {\n\t\t\t// We only are interested in the *last* %c\n\t\t\t// (the user may have provided their own)\n\t\t\tlastC = index;\n\t\t}\n\t});\n\n\targs.splice(lastC, 0, c);\n}\n\n/**\n * Invokes `console.debug()` when available.\n * No-op when `console.debug` is not a \"function\".\n * If `console.debug` is not available, falls back\n * to `console.log`.\n *\n * @api public\n */\nexports.log = console.debug || console.log || (() => {});\n\n/**\n * Save `namespaces`.\n *\n * @param {String} namespaces\n * @api private\n */\nfunction save(namespaces) {\n\ttry {\n\t\tif (namespaces) {\n\t\t\texports.storage.setItem('debug', namespaces);\n\t\t} else {\n\t\t\texports.storage.removeItem('debug');\n\t\t}\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\n/**\n * Load `namespaces`.\n *\n * @return {String} returns the previously persisted debug modes\n * @api private\n */\nfunction load() {\n\tlet r;\n\ttry {\n\t\tr = exports.storage.getItem('debug');\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n\n\t// If debug isn't set in LS, and we're in Electron, try to load $DEBUG\n\tif (!r && typeof process !== 'undefined' && 'env' in process) {\n\t\tr = process.env.DEBUG;\n\t}\n\n\treturn r;\n}\n\n/**\n * Localstorage attempts to return the localstorage.\n *\n * This is necessary because safari throws\n * when a user disables cookies/localstorage\n * and you attempt to access it.\n *\n * @return {LocalStorage}\n * @api private\n */\n\nfunction localstorage() {\n\ttry {\n\t\t// TVMLKit (Apple TV JS Runtime) does not have a window object, just localStorage in the global context\n\t\t// The Browser also has localStorage in the global context.\n\t\treturn localStorage;\n\t} catch (error) {\n\t\t// Swallow\n\t\t// XXX (@Qix-) should we be logging these?\n\t}\n}\n\nmodule.exports = require('./common')(exports);\n\nconst {formatters} = module.exports;\n\n/**\n * Map %j to `JSON.stringify()`, since no Web Inspectors do that by default.\n */\n\nformatters.j = function (v) {\n\ttry {\n\t\treturn JSON.stringify(v);\n\t} catch (error) {\n\t\treturn '[UnexpectedJSONParseError]: ' + error.message;\n\t}\n};\n","import { isNextSequenceNumber, JitterBuffer, RtpPacket } from \"./jitter-buffer\";\n\n// https://yumichan.net/video-processing/video-compression/introduction-to-h264-nal-unit/\nexport const NAL_TYPE_STAP_A = 24;\nexport const NAL_TYPE_FU_A = 28;\nexport const NAL_TYPE_NON_IDR = 1;\nexport const NAL_TYPE_IDR = 5;\nexport const NAL_TYPE_SEI = 6;\nexport const NAL_TYPE_SPS = 7;\nexport const NAL_TYPE_PPS = 8;\nexport const NAL_TYPE_DELIMITER = 9;\n\nconst NAL_HEADER_SIZE = 1;\nconst FU_A_HEADER_SIZE = 2;\nconst LENGTH_FIELD_SIZE = 2;\nconst STAP_A_HEADER_SIZE = NAL_HEADER_SIZE + LENGTH_FIELD_SIZE;\n\n\n// a stap a packet is a packet that aggregates multiple nals\nexport function depacketizeStapA(data: Buffer) {\n    const ret: Buffer[] = [];\n    let lastPos: number;\n    let pos = NAL_HEADER_SIZE;\n    while (pos < data.length) {\n        if (lastPos !== undefined)\n            ret.push(data.subarray(lastPos, pos));\n        const naluSize = data.readUInt16BE(pos);\n        pos += LENGTH_FIELD_SIZE;\n        lastPos = pos;\n        pos += naluSize;\n    }\n    ret.push(data.subarray(lastPos));\n    return ret;\n}\n\nexport function splitH264NaluStartCode(data: Buffer) {\n    const ret: Buffer[] = [];\n    let previous = 0;\n    let offset = 0;\n    const maybeAddSlice = () => {\n        const slice = data.subarray(previous, offset);\n        if (slice.length)\n            ret.push(slice);\n        offset += 4;\n        previous = offset;\n    }\n\n    while (offset < data.length - 4) {\n        const startCode = data.readUInt32BE(offset);\n        if (startCode === 1) {\n            maybeAddSlice();\n        }\n        else {\n            offset++;\n        }\n    }\n    offset = data.length;\n    maybeAddSlice();\n\n    return ret;\n}\n\nexport interface H264CodecInfo {\n    sps: Buffer;\n    pps: Buffer;\n    // Per ChatGPT excerpt below, resending the SEI may not the correct behavior when resending codec info,\n    // as SEI payloads MAY only apply to a number or time range of frames.\n    // I suspect that any encoders that send SEI messages that apply to a time range will send them regularly with SPS/PPS anyways.\n    // The Supplemental Enhancement Information (SEI) payload in H.264 video compression typically applies to all following frames within a specific context. The SEI information is not frame-specific but rather context-specific. Here's how it works:\n    //     1. **Context-Specific Information**: The SEI payload data often provides information that is valid for a range of frames or a portion of the video stream. For example, SEI messages may contain information about display orientation, buffering instructions, timing cues, or other metadata that applies to the video content as a whole or a specific segment of it.\n    //     2. **Duration of Applicability**: SEI messages often include information about the \"duration of applicability\" or the time period for which the conveyed information is relevant. This duration information helps video decoders understand how long the SEI data should be applied to the frames.\n    //     3. **Multiple SEI Messages**: The video stream can include multiple SEI messages, each with its own payload data and duration of applicability. As SEI messages are parsed, the decoder processes and applies the information according to the specified time range.\n    //     4. **Continuous Application**: SEI information, once applied, typically remains in effect until a subsequent SEI message with different or canceling information is received. The decoder continues to use the information conveyed by the SEI message within its defined duration of applicability.\n    //     5. **Dynamic Changes**: SEI messages can convey information about dynamic changes in the video stream, such as a change in display orientation or closed caption content. The decoder adjusts the display or handling of frames accordingly based on the SEI information received.\n    //     In summary, SEI payload data is context-specific and often applies to multiple frames within a specified time range. It is not frame-specific but provides supplemental information that helps maintain synchronization, enhance accessibility, or optimize video playback over a period of time within the video stream. The specific behavior may vary depending on the type of SEI message and the video codec being used.\n    sei?: Buffer;\n}\n\nexport class H264Repacketizer {\n    extraPackets = 0;\n    fuaMax: number;\n    pendingFuA: RtpPacket[];\n    // the stapa packet that will be sent before an idr frame.\n    stapa: RtpPacket;\n    fuaMin: number;\n\n    constructor(public console: Console, private maxPacketSize: number, public codecInfo?: H264CodecInfo, public jitterBuffer = new JitterBuffer(console, 4)) {\n        this.setMaxPacketSize(maxPacketSize);\n    }\n\n    setMaxPacketSize(maxPacketSize: number) {\n        this.maxPacketSize = maxPacketSize;\n        // 12 is the rtp/srtp header size.\n        this.fuaMax = maxPacketSize - FU_A_HEADER_SIZE;\n        this.fuaMin = Math.round(maxPacketSize * .8);\n    }\n\n    ensureCodecInfo() {\n        if (!this.codecInfo) {\n            this.codecInfo = {\n                sps: undefined,\n                pps: undefined,\n            };\n        }\n    }\n\n    updateSps(sps: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.sps = sps;\n    }\n\n    updatePps(pps: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.pps = pps;\n    }\n\n    updateSei(sei: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.sei = sei;\n    }\n\n    shouldFilter(nalType: number) {\n        // currently nothing is filtered, but it seems that some SEI packets cause issues\n        // and should be ignored, while others show up in the stap-a sps/pps packet\n        // and work just fine. unclear what these packets contain, but handling them properly\n        // is one of the last necessary steps to make the rtp sender reliable.\n        return false;\n        return nalType === NAL_TYPE_SEI;\n    }\n\n    // a fragmentation unit (fua) is a NAL unit broken into multiple fragments.\n    // https://datatracker.ietf.org/doc/html/rfc6184#section-5.8\n    packetizeFuA(data: Buffer, noStart?: boolean, noEnd?: boolean): Buffer[] {\n        // handle both normal packets and fua packets.\n        // a fua packet can be fragmented easily into smaller packets, as\n        // it is already a fragment, and splitting segments is\n        // trivial.\n\n        const initialNalType = data[0] & 0x1f;\n\n        if (initialNalType === NAL_TYPE_FU_A) {\n            const fnri = data[0] & (0x80 | 0x60);\n            const originalNalType = data[1] & 0x1f;\n            const isFuStart = !!(data[1] & 0x80);\n            const isFuEnd = !!(data[1] & 0x40);\n            const isFuMiddle = !isFuStart && !isFuEnd;\n\n            const originalNalHeader = Buffer.from([fnri | originalNalType]);\n            data = Buffer.concat([originalNalHeader, data.subarray(FU_A_HEADER_SIZE)]);\n\n            if (isFuStart) {\n                noEnd = true;\n            }\n            else if (isFuEnd) {\n                noStart = true;\n            }\n            else if (isFuMiddle) {\n                noStart = true;\n                noEnd = true;\n            }\n        }\n\n        const fnri = data[0] & (0x80 | 0x60);\n        const nalType = data[0] & 0x1F;\n\n        const fuIndicator = fnri | NAL_TYPE_FU_A;\n\n        const fuHeaderMiddle = Buffer.from([fuIndicator, nalType]);\n        const fuHeaderStart = noStart ? fuHeaderMiddle : Buffer.from([fuIndicator, nalType | 0x80]);\n        const fuHeaderEnd = noEnd ? fuHeaderMiddle : Buffer.from([fuIndicator, nalType | 0x40]);\n        let fuHeader = fuHeaderStart;\n\n        const packages: Buffer[] = [];\n        let offset = NAL_HEADER_SIZE;\n\n        while (offset < data.length) {\n            let payload: Buffer;\n            const packageSize = Math.min(this.fuaMax, data.length - offset);\n            payload = data.subarray(offset, offset + packageSize);\n            offset += packageSize;\n\n            if (offset === data.length) {\n                fuHeader = fuHeaderEnd;\n            }\n\n            packages.push(Buffer.concat([fuHeader, payload]));\n\n            fuHeader = fuHeaderMiddle;\n        }\n\n        return packages;\n    }\n\n    // https://datatracker.ietf.org/doc/html/rfc6184#section-5.7.1\n    packetizeOneStapA(datas: Buffer[]): Buffer {\n        const payload: Buffer[] = [];\n\n        if (!datas.length)\n            throw new Error('packetizeOneStapA requires at least one NAL');\n\n        let counter = 0;\n        let availableSize = this.maxPacketSize - STAP_A_HEADER_SIZE;\n\n        // h264/rtp spec: https://datatracker.ietf.org/doc/html/rfc6184#section-5.6\n        // The value of NRI MUST be the maximum of all the NAL units carried\n        // in the aggregation packet.\n\n        // homekit does not want NRI aggregation in the sps/pps stap-a for some reason?\n        const stapHeader = NAL_TYPE_STAP_A;\n\n        while (datas.length && datas[0].length + LENGTH_FIELD_SIZE <= availableSize && counter < 9) {\n            const nalu = datas.shift();\n            availableSize -= LENGTH_FIELD_SIZE + nalu.length;\n            counter += 1;\n            const packed = Buffer.alloc(2);\n            packed.writeUInt16BE(nalu.length, 0);\n            payload.push(packed, nalu);\n        }\n\n        // when a stapa packet has a p frame inside it, it may exceed the max packet size.\n        // it needs to be returned as is to be turned into a fua packet.\n        if (counter === 0)\n            return datas.shift();\n\n        // a single nalu stapa is unnecessary, return the nalu itself.\n        // this can happen when trying to packetize multiple nalus into a stapa\n        // and the last nalu does not fit into the first stapa, and ends up in\n        // a new stapa.\n        if (counter === 1) {\n            return payload[1];\n        }\n\n        payload.unshift(Buffer.from([stapHeader]));\n        return Buffer.concat(payload);\n    }\n\n    packetizeStapA(datas: Buffer[]) {\n        const ret: Buffer[] = [];\n        while (datas.length) {\n            const nalu = this.packetizeOneStapA(datas);\n            if (nalu.length < this.maxPacketSize) {\n                ret.push(nalu);\n                continue;\n            }\n            const fuas = this.packetizeFuA(nalu);\n            ret.push(...fuas);\n        }\n        return ret;\n    }\n\n    createPacket(rtp: RtpPacket, data: Buffer, marker: boolean) {\n        const ret = rtp.clone();\n        ret.header.sequenceNumber = (rtp.header.sequenceNumber + this.extraPackets + 0x10000) % 0x10000;\n        ret.header.marker = marker;\n        ret.header.padding = false;\n        ret.payload = data;\n        if (data.length > this.maxPacketSize)\n            this.console.warn('packet exceeded max packet size. this may a bug.');\n        return ret;\n    }\n\n    flushPendingFuA(ret: RtpPacket[]) {\n        if (!this.pendingFuA)\n            return;\n\n        // defragmenting assumes packets are sorted by sequence number,\n        // and are all available, which is guaranteed over rtsp/tcp, but not over rtp/udp.\n        const first = this.pendingFuA[0];\n        const last = this.pendingFuA[this.pendingFuA.length - 1];\n        const originalNalType = first.payload[1] & 0x1f;\n        const hasFuStart = !!(first.payload[1] & 0x80);\n        const hasFuEnd = !!(last.payload[1] & 0x40);\n\n        const fnri = first.payload[0] & (0x80 | 0x60);\n        const originalNalHeader = Buffer.from([fnri | originalNalType]);\n\n        const getDefragmentedPendingFua = () => {\n            const originalFragments = this.pendingFuA.map(packet => packet.payload.subarray(FU_A_HEADER_SIZE));\n            originalFragments.unshift(originalNalHeader);\n            const defragmented = Buffer.concat(originalFragments);\n            return defragmented;\n        }\n\n        // have seen cameras that toss sps/pps/idr into a fua, delimited by start codes?\n        // this probably is not compliant...\n        // so the fua packet looks like:\n        // sps | start code | pps | start code | idr\n        if (originalNalType === NAL_TYPE_SPS) {\n            const defragmented = getDefragmentedPendingFua();\n\n            const splits = splitH264NaluStartCode(defragmented);\n            while (splits.length) {\n                const split = splits.shift();\n                const splitNaluType = split[0] & 0x1f;\n                if (splitNaluType === NAL_TYPE_SPS) {\n                    this.updateSps(split);\n                }\n                else if (splitNaluType === NAL_TYPE_PPS) {\n                    this.updatePps(split);\n                }\n                else {\n                    if (splitNaluType === NAL_TYPE_IDR)\n                        this.maybeSendStapACodecInfo(first, ret);\n\n                    this.fragment(first, ret, {\n                        payload: split,\n                        noStart: !hasFuStart,\n                        noEnd: !hasFuEnd,\n                        marker: last.header.marker,\n                    });\n                }\n            }\n        }\n        else {\n            while (this.pendingFuA.length) {\n                const fua = this.pendingFuA[0];\n                if (fua.payload.length > this.maxPacketSize || fua.payload.length < this.fuaMin)\n                    break;\n                this.pendingFuA.shift();\n                ret.push(this.createPacket(fua, fua.payload, fua.header.marker));\n            }\n\n            if (!this.pendingFuA.length) {\n                this.pendingFuA = undefined;\n                return;\n            }\n\n            const first = this.pendingFuA[0];\n            const last = this.pendingFuA[this.pendingFuA.length - 1];\n            const hasFuStart = !!(first.payload[1] & 0x80);\n            const hasFuEnd = !!(last.payload[1] & 0x40);\n\n            const defragmented = getDefragmentedPendingFua();\n\n            this.fragment(first, ret, {\n                payload: defragmented,\n                noStart: !hasFuStart,\n                noEnd: !hasFuEnd,\n                marker: last.header.marker\n            });\n        }\n\n        this.extraPackets -= this.pendingFuA.length - 1;\n        this.pendingFuA = undefined;\n    }\n\n    createRtpPackets(packet: RtpPacket, nalus: Buffer[], ret: RtpPacket[], hadMarker = packet.header.marker) {\n        nalus.forEach((packetized, index) => {\n            if (index !== 0)\n                this.extraPackets++;\n            const marker = hadMarker && index === nalus.length - 1;\n            ret.push(this.createPacket(packet, packetized, marker));\n        });\n    }\n\n    maybeSendStapACodecInfo(packet: RtpPacket, ret: RtpPacket[]) {\n        if (this.stapa) {\n            // stapa with codec information was sent recently, no need to send codec info.\n            this.stapa = undefined;\n            return;\n        }\n\n        if (!this.codecInfo?.sps || !this.codecInfo?.pps)\n            return;\n\n        const agg = [this.codecInfo.sps, this.codecInfo.pps];\n        if (this.codecInfo?.sei)\n            agg.push(this.codecInfo.sei);\n        const aggregates = this.packetizeStapA(agg);\n        if (aggregates.length !== 1) {\n            this.console.error('expected only 1 packet for sps/pps stapa');\n            return;\n        }\n        // this stapa only contains sps and pps (and no frame data), thus the marker bit should not be set.\n        this.createRtpPackets(packet, aggregates, ret, false);\n        this.extraPackets++;\n    }\n\n    // given the packet, fragment it into multiple packets as needed.\n    // a fragment of a payload may be provided via fuaOptions.\n    fragment(packet: RtpPacket, ret: RtpPacket[], fuaOptions: {\n        payload: Buffer;\n        noStart: boolean;\n        noEnd: boolean;\n        marker: boolean;\n    } = {\n            payload: packet.payload,\n            noStart: false,\n            noEnd: false,\n            marker: packet.header.marker\n        }) {\n        const { payload, noStart, noEnd, marker } = fuaOptions;\n        if (payload.length > this.maxPacketSize || noStart || noEnd) {\n            const fragments = this.packetizeFuA(payload, noStart, noEnd);\n            this.createRtpPackets(packet, fragments, ret, marker);\n        }\n        else {\n            // can send this packet as is!\n            ret.push(this.createPacket(packet, payload, marker));\n        }\n    }\n\n    repacketize<T extends RtpPacket>(packet: T): T[] {\n        const ret: T[] = [];\n        for (const dejittered of this.jitterBuffer.queue(packet)) {\n            this.repacketizeOne(dejittered, ret);\n        }\n        return ret;\n    }\n\n    repacketizeOne(packet: RtpPacket, ret: RtpPacket[]) {\n\n        // empty packets are apparently valid from webrtc. filter those out.\n        if (!packet.payload.length) {\n            this.flushPendingFuA(ret);\n            this.extraPackets--;\n            return;\n        }\n\n        const nalType = packet.payload[0] & 0x1F;\n\n        // fragmented packets must share a timestamp\n        if (this.pendingFuA && this.pendingFuA[0].header.timestamp !== packet.header.timestamp) {\n            this.flushPendingFuA(ret);\n        }\n\n        if (nalType === NAL_TYPE_FU_A) {\n            // ideally send the packets through as is from the upstream source.\n            // refragment only if the incoming fua packet is larger than\n            // the max packet size.\n\n            const data = packet.payload;\n            const originalNalType = data[1] & 0x1f;\n\n            if (this.shouldFilter(originalNalType)) {\n                this.extraPackets--;\n                return;\n            }\n\n            const isFuStart = !!(data[1] & 0x80);\n            const isFuEnd = !!(packet.payload[1] & 0x40);\n\n            if (isFuStart) {\n                if (this.pendingFuA)\n                    this.console.error('fua restarted. skipping refragmentation of previous fua.', originalNalType);\n\n                this.pendingFuA = undefined;\n\n                // if this is an idr frame, but no sps has been sent via a stapa, dummy one up.\n                // the stream may not contain codec information in stapa or may be sending it\n                // in separate sps/pps packets which is not supported by homekit.\n                if (originalNalType === NAL_TYPE_IDR) {\n                    this.maybeSendStapACodecInfo(packet, ret);\n                }\n\n            }\n            else {\n                if (this.pendingFuA) {\n                    // check if packet were missing earlier from the previously queued fua packets.\n                    // if so, don't queue the current packet.\n                    // all further fua packets will continue to be dropped until a later fua start\n                    // is received. the fua series up to the point of validity will then be flushed,\n                    // although it will be incomplete, it is valid.\n                    const last = this.pendingFuA[this.pendingFuA.length - 1];\n                    if (!isNextSequenceNumber(last.header.sequenceNumber, packet.header.sequenceNumber)) {\n                        this.console.error('fua packet missing. skipping refragmentation.', originalNalType);\n                        return;\n                    }\n                }\n            }\n\n            if (!this.pendingFuA)\n                this.pendingFuA = [];\n\n            this.pendingFuA.push(packet);\n\n            if (isFuEnd) {\n                this.flushPendingFuA(ret);\n            }\n            else if (this.pendingFuA.reduce((p, c) => p + c.payload.length - FU_A_HEADER_SIZE, NAL_HEADER_SIZE) > this.maxPacketSize) {\n                // refragment fua packets as they are received, saving the last undersized packet for\n                // the next fua packet.\n                const last = this.pendingFuA[this.pendingFuA.length - 1].clone();\n                const partial: RtpPacket[] = [];\n                this.flushPendingFuA(partial);\n                // retain a fua packet to validate subsequent fua packets.\n                const retain = partial.pop();\n                last.payload = retain.payload;\n                this.pendingFuA = [last];\n                ret.push(...partial);\n            }\n        }\n        else if (nalType === NAL_TYPE_STAP_A) {\n            this.flushPendingFuA(ret);\n\n            let hasSps = false;\n            let hasPps = false;\n\n            // break the aggregated packet up to update codec information.\n            const depacketized = depacketizeStapA(packet.payload);\n            depacketized.forEach(payload => {\n                    const nalType = payload[0] & 0x1F;\n                    if (nalType === NAL_TYPE_SPS) {\n                        hasSps = true;\n                        this.updateSps(payload);\n                    }\n                    else if (nalType === NAL_TYPE_PPS) {\n                        hasPps = true;\n                        this.updatePps(payload);\n                    }\n                    else if (nalType === NAL_TYPE_SEI) {\n                        this.updateSei(payload);\n                    }\n                    else if (nalType === NAL_TYPE_DELIMITER) {\n                        // this is uncommon but has been seen. seems to be a no-op nalu.\n                    }\n                    else if (nalType === NAL_TYPE_NON_IDR) {\n                        // this is uncommon but has been seen. oddly, on reolink this non-idr was sent\n                        // after the codec information. so codec information can be changed between\n                        // idr and non-idr? maybe it is not applied until next idr?\n                    }\n                    else if (nalType === NAL_TYPE_IDR) {\n                        // this is uncommon but has been seen on tapo.\n                        // i have no clue how they can fit an idr frame into a single packet stapa.\n                    }\n                    else if (nalType === 0) {\n                        // nal delimiter or something. usually empty.\n                    }\n                    else {\n                        this.console.warn('Skipped a stapa type.', nalType)\n                    }\n                });\n\n            // log that a stapa with codec info was sent\n            if (hasSps && hasPps)\n                this.stapa = packet;\n\n            const stapa = this.packetizeStapA(depacketized);\n            this.createRtpPackets(packet, stapa, ret);\n        }\n        else if (nalType >= 1 && nalType < 24) {\n            this.flushPendingFuA(ret);\n\n            if (this.shouldFilter(nalType)) {\n                this.extraPackets--;\n                return;\n            }\n\n            // codec information should be aggregated into a stapa. usually around 50 bytes total.\n            if (nalType === NAL_TYPE_SPS) {\n                this.extraPackets--;\n                this.updateSps(packet.payload);\n                return;\n            }\n            else if (nalType === NAL_TYPE_PPS) {\n                this.extraPackets--;\n                this.updatePps(packet.payload);\n                return;\n            }\n            else if (nalType === NAL_TYPE_SEI) {\n                this.extraPackets--;\n                this.updateSei(packet.payload);\n                return;\n            }\n\n            if (this.shouldFilter(nalType)) {\n                this.extraPackets--;\n                return;\n            }\n\n            if (nalType === NAL_TYPE_IDR) {\n                // if this is an idr frame, but no sps has been sent, dummy one up.\n                // the stream may not contain sps.\n                this.maybeSendStapACodecInfo(packet, ret);\n            }\n\n            this.fragment(packet, ret);\n        }\n        else {\n            this.console.error('unknown nal unit type ' + nalType);\n            this.extraPackets--;\n        }\n\n        return;\n    }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.expand_message_xmd = expand_message_xmd;\nexports.expand_message_xof = expand_message_xof;\nexports.hash_to_field = hash_to_field;\nexports.isogenyMap = isogenyMap;\nexports.createHasher = createHasher;\nconst modular_js_1 = require(\"./modular.js\");\nconst utils_js_1 = require(\"./utils.js\");\n// Octet Stream to Integer. \"spec\" implementation of os2ip is 2.5x slower vs bytesToNumberBE.\nconst os2ip = utils_js_1.bytesToNumberBE;\n// Integer to Octet Stream (numberToBytesBE)\nfunction i2osp(value, length) {\n    anum(value);\n    anum(length);\n    if (value < 0 || value >= 1 << (8 * length))\n        throw new Error('invalid I2OSP input: ' + value);\n    const res = Array.from({ length }).fill(0);\n    for (let i = length - 1; i >= 0; i--) {\n        res[i] = value & 0xff;\n        value >>>= 8;\n    }\n    return new Uint8Array(res);\n}\nfunction strxor(a, b) {\n    const arr = new Uint8Array(a.length);\n    for (let i = 0; i < a.length; i++) {\n        arr[i] = a[i] ^ b[i];\n    }\n    return arr;\n}\nfunction anum(item) {\n    if (!Number.isSafeInteger(item))\n        throw new Error('number expected');\n}\n/**\n * Produces a uniformly random byte string using a cryptographic hash function H that outputs b bits.\n * [RFC 9380 5.3.1](https://www.rfc-editor.org/rfc/rfc9380#section-5.3.1).\n */\nfunction expand_message_xmd(msg, DST, lenInBytes, H) {\n    (0, utils_js_1.abytes)(msg);\n    (0, utils_js_1.abytes)(DST);\n    anum(lenInBytes);\n    // https://www.rfc-editor.org/rfc/rfc9380#section-5.3.3\n    if (DST.length > 255)\n        DST = H((0, utils_js_1.concatBytes)((0, utils_js_1.utf8ToBytes)('H2C-OVERSIZE-DST-'), DST));\n    const { outputLen: b_in_bytes, blockLen: r_in_bytes } = H;\n    const ell = Math.ceil(lenInBytes / b_in_bytes);\n    if (lenInBytes > 65535 || ell > 255)\n        throw new Error('expand_message_xmd: invalid lenInBytes');\n    const DST_prime = (0, utils_js_1.concatBytes)(DST, i2osp(DST.length, 1));\n    const Z_pad = i2osp(0, r_in_bytes);\n    const l_i_b_str = i2osp(lenInBytes, 2); // len_in_bytes_str\n    const b = new Array(ell);\n    const b_0 = H((0, utils_js_1.concatBytes)(Z_pad, msg, l_i_b_str, i2osp(0, 1), DST_prime));\n    b[0] = H((0, utils_js_1.concatBytes)(b_0, i2osp(1, 1), DST_prime));\n    for (let i = 1; i <= ell; i++) {\n        const args = [strxor(b_0, b[i - 1]), i2osp(i + 1, 1), DST_prime];\n        b[i] = H((0, utils_js_1.concatBytes)(...args));\n    }\n    const pseudo_random_bytes = (0, utils_js_1.concatBytes)(...b);\n    return pseudo_random_bytes.slice(0, lenInBytes);\n}\n/**\n * Produces a uniformly random byte string using an extendable-output function (XOF) H.\n * 1. The collision resistance of H MUST be at least k bits.\n * 2. H MUST be an XOF that has been proved indifferentiable from\n *    a random oracle under a reasonable cryptographic assumption.\n * [RFC 9380 5.3.2](https://www.rfc-editor.org/rfc/rfc9380#section-5.3.2).\n */\nfunction expand_message_xof(msg, DST, lenInBytes, k, H) {\n    (0, utils_js_1.abytes)(msg);\n    (0, utils_js_1.abytes)(DST);\n    anum(lenInBytes);\n    // https://www.rfc-editor.org/rfc/rfc9380#section-5.3.3\n    // DST = H('H2C-OVERSIZE-DST-' || a_very_long_DST, Math.ceil((lenInBytes * k) / 8));\n    if (DST.length > 255) {\n        const dkLen = Math.ceil((2 * k) / 8);\n        DST = H.create({ dkLen }).update((0, utils_js_1.utf8ToBytes)('H2C-OVERSIZE-DST-')).update(DST).digest();\n    }\n    if (lenInBytes > 65535 || DST.length > 255)\n        throw new Error('expand_message_xof: invalid lenInBytes');\n    return (H.create({ dkLen: lenInBytes })\n        .update(msg)\n        .update(i2osp(lenInBytes, 2))\n        // 2. DST_prime = DST || I2OSP(len(DST), 1)\n        .update(DST)\n        .update(i2osp(DST.length, 1))\n        .digest());\n}\n/**\n * Hashes arbitrary-length byte strings to a list of one or more elements of a finite field F.\n * [RFC 9380 5.2](https://www.rfc-editor.org/rfc/rfc9380#section-5.2).\n * @param msg a byte string containing the message to hash\n * @param count the number of elements of F to output\n * @param options `{DST: string, p: bigint, m: number, k: number, expand: 'xmd' | 'xof', hash: H}`, see above\n * @returns [u_0, ..., u_(count - 1)], a list of field elements.\n */\nfunction hash_to_field(msg, count, options) {\n    (0, utils_js_1.validateObject)(options, {\n        DST: 'stringOrUint8Array',\n        p: 'bigint',\n        m: 'isSafeInteger',\n        k: 'isSafeInteger',\n        hash: 'hash',\n    });\n    const { p, k, m, hash, expand, DST: _DST } = options;\n    (0, utils_js_1.abytes)(msg);\n    anum(count);\n    const DST = typeof _DST === 'string' ? (0, utils_js_1.utf8ToBytes)(_DST) : _DST;\n    const log2p = p.toString(2).length;\n    const L = Math.ceil((log2p + k) / 8); // section 5.1 of ietf draft link above\n    const len_in_bytes = count * m * L;\n    let prb; // pseudo_random_bytes\n    if (expand === 'xmd') {\n        prb = expand_message_xmd(msg, DST, len_in_bytes, hash);\n    }\n    else if (expand === 'xof') {\n        prb = expand_message_xof(msg, DST, len_in_bytes, k, hash);\n    }\n    else if (expand === '_internal_pass') {\n        // for internal tests only\n        prb = msg;\n    }\n    else {\n        throw new Error('expand must be \"xmd\" or \"xof\"');\n    }\n    const u = new Array(count);\n    for (let i = 0; i < count; i++) {\n        const e = new Array(m);\n        for (let j = 0; j < m; j++) {\n            const elm_offset = L * (j + i * m);\n            const tv = prb.subarray(elm_offset, elm_offset + L);\n            e[j] = (0, modular_js_1.mod)(os2ip(tv), p);\n        }\n        u[i] = e;\n    }\n    return u;\n}\nfunction isogenyMap(field, map) {\n    // Make same order as in spec\n    const COEFF = map.map((i) => Array.from(i).reverse());\n    return (x, y) => {\n        const [xNum, xDen, yNum, yDen] = COEFF.map((val) => val.reduce((acc, i) => field.add(field.mul(acc, x), i)));\n        x = field.div(xNum, xDen); // xNum / xDen\n        y = field.mul(y, field.div(yNum, yDen)); // y * (yNum / yDev)\n        return { x: x, y: y };\n    };\n}\n/** Creates hash-to-curve methods from EC Point and mapToCurve function. */\nfunction createHasher(Point, mapToCurve, def) {\n    if (typeof mapToCurve !== 'function')\n        throw new Error('mapToCurve() must be defined');\n    return {\n        // Encodes byte string to elliptic curve.\n        // hash_to_curve from https://www.rfc-editor.org/rfc/rfc9380#section-3\n        hashToCurve(msg, options) {\n            const u = hash_to_field(msg, 2, { ...def, DST: def.DST, ...options });\n            const u0 = Point.fromAffine(mapToCurve(u[0]));\n            const u1 = Point.fromAffine(mapToCurve(u[1]));\n            const P = u0.add(u1).clearCofactor();\n            P.assertValidity();\n            return P;\n        },\n        // Encodes byte string to elliptic curve.\n        // encode_to_curve from https://www.rfc-editor.org/rfc/rfc9380#section-3\n        encodeToCurve(msg, options) {\n            const u = hash_to_field(msg, 1, { ...def, DST: def.encodeDST, ...options });\n            const P = Point.fromAffine(mapToCurve(u[0])).clearCofactor();\n            P.assertValidity();\n            return P;\n        },\n        // Same as encodeToCurve, but without hash\n        mapToCurve(scalars) {\n            if (!Array.isArray(scalars))\n                throw new Error('mapToCurve: expected array of bigints');\n            for (const i of scalars)\n                if (typeof i !== 'bigint')\n                    throw new Error('mapToCurve: expected array of bigints');\n            const P = Point.fromAffine(mapToCurve(scalars)).clearCofactor();\n            P.assertValidity();\n            return P;\n        },\n    };\n}\n//# sourceMappingURL=hash-to-curve.js.map","import { CurveType, certificateTypes, signatures } from \"../../cipher/const\";\nimport type { CipherContext } from \"../../context/cipher\";\nimport type { DtlsContext } from \"../../context/dtls\";\nimport type { SrtpContext } from \"../../context/srtp\";\nimport type { TransportContext } from \"../../context/transport\";\nimport { ExtendedMasterSecret } from \"../../handshake/extensions/extendedMasterSecret\";\nimport { RenegotiationIndication } from \"../../handshake/extensions/renegotiationIndication\";\nimport { UseSRTP } from \"../../handshake/extensions/useSrtp\";\nimport { Certificate } from \"../../handshake/message/certificate\";\nimport { ServerCertificateRequest } from \"../../handshake/message/server/certificateRequest\";\nimport { ServerHello } from \"../../handshake/message/server/hello\";\nimport { ServerHelloDone } from \"../../handshake/message/server/helloDone\";\nimport { ServerKeyExchange } from \"../../handshake/message/server/keyExchange\";\nimport { debug } from \"../../imports/common\";\nimport type { FragmentedHandshake } from \"../../record/message/fragment\";\nimport type { Extension } from \"../../typings/domain\";\nimport { Flight } from \"../flight\";\n\nconst log = debug(\"werift-dtls : packages/dtls/flight/server/flight4.ts : log\");\n\nexport class Flight4 extends Flight {\n  constructor(\n    udp: TransportContext,\n    dtls: DtlsContext,\n    private cipher: CipherContext,\n    private srtp: SrtpContext,\n  ) {\n    super(udp, dtls, 4, 6);\n  }\n\n  async exec(\n    clientHello: FragmentedHandshake,\n    certificateRequest: boolean = false,\n  ) {\n    if (this.dtls.flight === 4) {\n      log(this.dtls.sessionId, \"flight4 twice\");\n      this.send(this.dtls.lastMessage);\n      return;\n    }\n    this.dtls.flight = 4;\n    this.dtls.sequenceNumber = 1;\n    this.dtls.bufferHandshakeCache([clientHello], false, 4);\n\n    const messages = [\n      this.sendServerHello(),\n      this.sendCertificate(),\n      this.sendServerKeyExchange(),\n      certificateRequest && this.sendCertificateRequest(),\n      this.sendServerHelloDone(),\n    ].filter((v) => v) as Buffer[];\n\n    this.dtls.lastMessage = messages;\n    await this.transmit(messages);\n  }\n\n  private sendServerHello() {\n    // todo fix; should use socket.extensions\n    const extensions: Extension[] = [];\n    if (this.srtp.srtpProfile) {\n      extensions.push(\n        UseSRTP.create([this.srtp.srtpProfile], Buffer.from([0x00])).extension,\n      );\n    }\n    if (this.dtls.options.extendedMasterSecret) {\n      extensions.push({\n        type: ExtendedMasterSecret.type,\n        data: Buffer.alloc(0),\n      });\n    }\n    const renegotiationIndication = RenegotiationIndication.createEmpty();\n    extensions.push(renegotiationIndication.extension);\n\n    const serverHello = new ServerHello(\n      this.dtls.version,\n      this.cipher.localRandom,\n      Buffer.from([0x00]),\n      this.cipher.cipherSuite,\n      0, // do not compression\n      extensions,\n    );\n    const packets = this.createPacket([serverHello]);\n    return Buffer.concat(packets.map((v) => v.serialize()));\n  }\n\n  // 7.4.2 Server Certificate\n  private sendCertificate() {\n    const certificate = new Certificate([Buffer.from(this.cipher.localCert)]);\n\n    const packets = this.createPacket([certificate]);\n    return Buffer.concat(packets.map((v) => v.serialize()));\n  }\n\n  private sendServerKeyExchange() {\n    const signature = this.cipher.generateKeySignature(\"sha256\");\n    if (!this.cipher.signatureHashAlgorithm) throw new Error(\"not exist\");\n\n    const keyExchange = new ServerKeyExchange(\n      CurveType.named_curve_3,\n      this.cipher.namedCurve,\n      this.cipher.localKeyPair.publicKey.length,\n      this.cipher.localKeyPair.publicKey,\n      this.cipher.signatureHashAlgorithm.hash,\n      this.cipher.signatureHashAlgorithm.signature,\n      signature.length,\n      signature,\n    );\n\n    const packets = this.createPacket([keyExchange]);\n    return Buffer.concat(packets.map((v) => v.serialize()));\n  }\n\n  // 7.4.4.  Certificate Request\n  private sendCertificateRequest() {\n    const handshake = new ServerCertificateRequest(\n      certificateTypes,\n      signatures,\n      [],\n    );\n    log(this.dtls.sessionId, \"sendCertificateRequest\", handshake);\n    const packets = this.createPacket([handshake]);\n    return Buffer.concat(packets.map((v) => v.serialize()));\n  }\n\n  private sendServerHelloDone() {\n    const handshake = new ServerHelloDone();\n\n    const packets = this.createPacket([handshake]);\n    return Buffer.concat(packets.map((v) => v.serialize()));\n  }\n}\n","export * from \"../../../rtp/src\";\n","import { setTimeout } from \"timers/promises\";\n\nimport type { DtlsContext } from \"../context/dtls\";\nimport type { TransportContext } from \"../context/transport\";\nimport { debug } from \"../imports/common\";\nimport { createFragments, createPlaintext } from \"../record/builder\";\nimport { ContentType } from \"../record/const\";\nimport type { Handshake } from \"../typings/domain\";\n\nconst warn = debug(\"werift-dtls : packages/dtls/src/flight/flight.ts : warn\");\nconst err = debug(\"werift-dtls : packages/dtls/src/flight/flight.ts : err\");\n\nconst flightTypes = [\"PREPARING\", \"SENDING\", \"WAITING\", \"FINISHED\"] as const;\n\ntype FlightType = (typeof flightTypes)[number];\n\nexport abstract class Flight {\n  state: FlightType = \"PREPARING\";\n  static RetransmitCount = 10;\n\n  constructor(\n    private transport: TransportContext,\n    public dtls: DtlsContext,\n    private flight: number,\n    private nextFlight?: number,\n  ) {}\n\n  protected createPacket(handshakes: Handshake[]) {\n    const fragments = createFragments(this.dtls)(handshakes);\n    this.dtls.bufferHandshakeCache(fragments, true, this.flight);\n    const packets = createPlaintext(this.dtls)(\n      fragments.map((fragment) => ({\n        type: ContentType.handshake,\n        fragment: fragment.serialize(),\n      })),\n      ++this.dtls.recordSequenceNumber,\n    );\n    return packets;\n  }\n\n  protected async transmit(buffers: Buffer[]) {\n    let retransmitCount = 0;\n    for (; retransmitCount <= Flight.RetransmitCount; retransmitCount++) {\n      this.setState(\"SENDING\");\n      this.send(buffers).catch((e) => {\n        err(\"fail to send\", err);\n      });\n      this.setState(\"WAITING\");\n\n      if (this.nextFlight === undefined) {\n        this.setState(\"FINISHED\");\n        break;\n      }\n\n      await setTimeout(1000 * ((retransmitCount + 1) / 2));\n\n      if (this.dtls.flight >= this.nextFlight) {\n        this.setState(\"FINISHED\");\n        break;\n      } else {\n        warn(\n          this.dtls.sessionId,\n          \"retransmit\",\n          retransmitCount,\n          this.dtls.flight,\n        );\n      }\n    }\n\n    if (retransmitCount > Flight.RetransmitCount) {\n      err(this.dtls.sessionId, \"retransmit failed\", retransmitCount);\n      throw new Error(\n        `over retransmitCount : ${this.flight} ${this.nextFlight}`,\n      );\n    }\n  }\n\n  protected send = (buf: Buffer[]) =>\n    Promise.all(buf.map((v) => this.transport.send(v)));\n\n  private setState(state: FlightType) {\n    this.state = state;\n  }\n}\n","import { types } from \"@shinyoshiaki/binary-data\";\nconst { uint16be, uint24be, buffer, array, uint8, string } = types;\n\n// export const Random = {\n//   gmt_unix_time: uint32be,\n//   random_bytes: buffer(28),\n// };\n\nconst Extension = {\n  type: uint16be,\n  data: buffer(uint16be),\n};\n\nexport const ExtensionList = array(Extension, uint16be, \"bytes\");\n\nexport const ASN11Cert = buffer(uint24be);\n\nexport const ClientCertificateType = uint8;\nexport const DistinguishedName = string(uint16be);\n\nexport const SignatureHashAlgorithm = { hash: uint8, signature: uint8 };\n\nexport const ProtocolVersion = { major: uint8, minor: uint8 };\n","export class Deferred<T> {\n    finished = false;\n    resolve!: (value: T) => this;\n    reject!: (error: Error) => this;\n\n    [Symbol.dispose]() {\n        if (!this.finished)\n            this.reject(new Error('deferred disposed without being resolved'));\n    }\n\n    async resolvePromise(p: Promise<T>) {\n        try {\n            this.resolve(await p);\n        }\n        catch (e) {\n            this.reject(e as Error);\n        }\n    }\n    promise = new Promise<T>((resolve, reject) => {\n        this.resolve = v => {\n            this.finished = true;\n            resolve(v);\n            return this;\n        };\n        this.reject = e => {\n            this.finished = true;\n            reject(e);\n            return this;\n        };\n    });\n}\n","import type { RTCAVSignalingSetup, RTCSignalingOptions, RTCSignalingSendIceCandidate, RTCSignalingSession } from \"../../sdk/types/src/types.input\";\nimport { Deferred } from \"./deferred\";\n\nfunction getUserAgent() {\n    try {\n        return navigator.userAgent;\n    }\n    catch (e) {\n    }\n}\n\n// connectionState is not implemented in firefox? so watch iceConnectionState instead...\nexport function waitPeerConnectionIceConnected(pc: RTCPeerConnection) {\n    return new Promise((resolve, reject) => {\n        if (pc.iceConnectionState === 'connected') {\n            resolve(undefined);\n            return;\n        }\n        pc.addEventListener('iceconnectionstatechange', () => {\n            if (pc.iceConnectionState === 'connected')\n                resolve(undefined);\n        });\n\n        waitPeerIceConnectionClosed(pc).then(reason => reject(new Error(reason)));\n    });\n}\n\nexport function waitPeerIceConnectionClosed(pc: RTCPeerConnection): Promise<string> {\n    return new Promise(resolve => {\n        pc.addEventListener('iceconnectionstatechange', () => {\n            if (isPeerConnectionClosed(pc)) {\n                resolve(pc.iceConnectionState);\n            }\n        });\n    });\n}\n\nexport function isPeerConnectionClosed(pc: RTCPeerConnection) {\n    return pc.iceConnectionState === 'disconnected'\n        || pc.iceConnectionState === 'failed'\n        || pc.iceConnectionState === 'closed';\n}\n\n// function silence() {\n//     let ctx = new AudioContext(), oscillator = ctx.createOscillator();\n//     const dest = ctx.createMediaStreamDestination();\n//     oscillator.connect(dest);\n//     oscillator.start();\n//     const ret = dest.stream.getAudioTracks()[0];\n//     ret.enabled = false;\n//     return ret;\n// }\n\nfunction createOptions() {\n    const options: RTCSignalingOptions = {\n        userAgent: getUserAgent(),\n        capabilities: {\n            audio: RTCRtpReceiver.getCapabilities?.('audio') || {\n                codecs: undefined,\n                headerExtensions: undefined,\n            },\n            video: RTCRtpReceiver.getCapabilities?.('video') || {\n                codecs: undefined,\n                headerExtensions: undefined,\n            },\n        },\n        screen: {\n            devicePixelRatio: window.devicePixelRatio,\n            width: screen.width,\n            height: screen.height,\n        },\n    };\n    return options;\n}\n\n// can be called on anything with getStats, ie for receiver specific reports or connection reports.\nexport async function getPacketsLost(t: { getStats(): Promise<RTCStatsReport> }) {\n    const stats = await t.getStats();\n    const packetsLost = ([...stats.values()] as { packetsLost: number }[]).filter(stat => 'packetsLost' in stat).map(stat => stat.packetsLost);\n    const total = packetsLost.reduce((p, c) => p + c, 0);\n    return total;\n}\n\nexport class BrowserSignalingSession implements RTCSignalingSession {\n    private pc: RTCPeerConnection;\n    pcDeferred = new Deferred<RTCPeerConnection>();\n    dcDeferred = new Deferred<RTCDataChannel>();\n    microphone: RTCRtpSender;\n    micEnabled = false;\n    onPeerConnection: (pc: RTCPeerConnection) => Promise<void>;\n    __proxy_props = { options: createOptions() };\n    options = createOptions();\n\n    constructor() {\n    }\n\n    async getOptions(): Promise<RTCSignalingOptions> {\n        return this.options;\n    }\n\n    async getPacketsLost() {\n        return getPacketsLost(this.pc);\n    }\n\n    async setMicrophone(enabled: boolean) {\n        if (this.microphone && enabled && !this.micEnabled) {\n            this.micEnabled = true;\n            // doing sendrecv on safari requires a mic be attached, or it fails to connect.\n            const mic = await navigator.mediaDevices.getUserMedia({ video: false, audio: true });\n            await this.microphone.replaceTrack(mic.getTracks()[0]);\n        }\n\n        if (this.microphone?.track) {\n            this.microphone.track.enabled = enabled;\n        }\n    }\n\n    close() {\n        this.pcDeferred.promise.then(pc => {\n            for (const t of pc.getTransceivers() || []) {\n                try {\n                    t.sender?.track?.stop?.();\n                }\n                catch (e) {\n                }\n            }\n            pc.close();\n        })\n            .catch(() => { });\n        this.pcDeferred.reject(new Error('iceConnectionState ' + this.pc?.iceConnectionState));\n    }\n\n    async createPeerConnection(setup: RTCAVSignalingSetup) {\n        if (this.pc)\n            return;\n\n        const checkConn = () => {\n            console.log('iceConnectionState', pc.iceConnectionState);\n            console.log('connectionState', pc.connectionState);\n            if (isPeerConnectionClosed(pc))\n                this.close();\n        }\n\n        const pc = this.pc = new RTCPeerConnection(setup.configuration);\n        this.pcDeferred.resolve(pc);\n        await this.onPeerConnection?.(pc)\n\n        // pc.addEventListener('connectionstatechange', checkConn);\n        pc.addEventListener('iceconnectionstatechange', checkConn);\n        // pc.addEventListener('icegatheringstatechange', ev => console.log('iceGatheringState', pc.iceGatheringState))\n        // pc.addEventListener('signalingstatechange', ev => console.log('signalingState', pc.signalingState))\n        // pc.addEventListener('icecandidateerror', ev => console.log('icecandidateerror'))\n\n        if (setup.datachannel) {\n            const dc = pc.createDataChannel(setup.datachannel.label, setup.datachannel.dict);\n            dc.binaryType = 'arraybuffer';\n            this.dcDeferred.resolve(dc);\n        }\n\n        if (setup.audio) {\n            let audio: RTCRtpTransceiver;\n            if (setup.getUserMediaSafariHack && navigator.userAgent.includes('Safari') && !navigator.userAgent.includes('Chrome')) {\n                // offering a sendrecv on safari requires a mic be attached for ring webrtc, or it fails to stream?\n                // even if a silent track is used...\n                audio = pc.addTransceiver('audio', {\n                    ...setup.audio,\n                    streams: [\n                        await navigator.mediaDevices.getUserMedia({ audio: true })\n                    ],\n                });\n            }\n            else {\n                audio = pc.addTransceiver('audio', setup.audio);\n            }\n\n            if (setup.audio.direction === 'sendrecv' || setup.audio.direction === 'sendonly') {\n                this.microphone = audio.sender;\n            }\n        }\n\n        if (setup.video) {\n            if (setup.video.direction === 'sendrecv' || setup.video.direction === 'sendonly') {\n                try {\n                    const camera = await navigator.mediaDevices.getUserMedia({ video: true })\n                    for (const track of camera.getTracks()) {\n                        pc.addTrack(track);\n                    }\n                }\n                catch (e) {\n                    // what now\n                }\n            }\n            else {\n                pc.addTransceiver('video', setup.video);\n            }\n        }\n    }\n\n    async createLocalDescription(type: \"offer\" | \"answer\", setup: RTCAVSignalingSetup, sendIceCandidate: RTCSignalingSendIceCandidate) {\n        await this.createPeerConnection(setup);\n\n        const gatheringPromise = new Promise(resolve => {\n            this.pc.onicecandidate = ev => {\n                if (ev.candidate) {\n                    // console.log(\"local candidate\", ev.candidate);\n                    sendIceCandidate?.(JSON.parse(JSON.stringify(ev.candidate)));\n                }\n                else {\n                    resolve(undefined);\n                }\n            }\n\n            this.pc.onicegatheringstatechange = () => {\n                if (this.pc.iceGatheringState === 'complete')\n                    resolve(undefined);\n            }\n        });\n\n        const toDescription = (init: RTCSessionDescriptionInit) => {\n            // console.log('local description', init.sdp);\n            return {\n                type: init.type,\n                sdp: init.sdp,\n            }\n        }\n\n        if (type === 'offer') {\n            let offer: RTCSessionDescriptionInit = this.pc.localDescription;\n            if (offer) {\n                // fast path for duplicate calls to createLocalDescription\n                return toDescription(this.pc.localDescription);\n            }\n            offer = await this.pc.createOffer({\n                offerToReceiveAudio: !!setup.audio,\n                offerToReceiveVideo: !!setup.video,\n            });\n            const set = this.pc.setLocalDescription(offer);\n            if (sendIceCandidate)\n                return toDescription(offer);\n            await set;\n            await gatheringPromise;\n            offer = this.pc.localDescription || await this.pc.createOffer({\n                offerToReceiveAudio: !!setup.audio,\n                offerToReceiveVideo: !!setup.video,\n            });\n            return toDescription(offer);\n        }\n        else {\n            let answer = await this.pc.createAnswer();\n            const set = this.pc.setLocalDescription(answer);\n            if (sendIceCandidate)\n                return toDescription(answer);\n            await set;\n            await gatheringPromise;\n            answer = this.pc.currentLocalDescription || answer;\n            return toDescription(answer);\n        }\n    }\n\n    async setRemoteDescription(description: RTCSessionDescriptionInit, setup: RTCAVSignalingSetup) {\n        await this.createPeerConnection(setup);\n        await this.pc.setRemoteDescription(description);\n        // console.log('remote description', description.sdp);\n    }\n\n    async addIceCandidate(candidate: RTCIceCandidateInit) {\n        await this.pc.addIceCandidate(candidate);\n        // console.log(\"remote candidate\", candidate);\n    }\n\n    async endSession() {\n    }\n}\n\nfunction logSendCandidate(console: Console, type: string, session: RTCSignalingSession): RTCSignalingSendIceCandidate {\n    return async (candidate) => {\n        try {\n            if (localStorage.getItem('debugLog') === 'true')\n                console.log(`${type} trickled candidate:`, candidate.sdpMLineIndex, candidate.candidate);\n            await session.addIceCandidate(candidate);\n        }\n        catch (e) {\n            console.error('addIceCandidate error', e);\n            throw e;\n        }\n    }\n}\n\nfunction createCandidateQueue(console: Console, type: string, session: RTCSignalingSession) {\n    let ready = false;\n    let candidateQueue: RTCIceCandidateInit[] = [];\n    const ls = logSendCandidate(console, type, session);\n    const queueSendCandidate: RTCSignalingSendIceCandidate = async (candidate: RTCIceCandidateInit) => {\n        if (!ready)\n            candidateQueue.push(candidate)\n        else\n            ls(candidate);\n    }\n\n    return {\n        flush() {\n            ready = true;\n            for (const candidate of candidateQueue) {\n                ls(candidate);\n            }\n            candidateQueue = [];\n        },\n        queueSendCandidate,\n    }\n}\n\nexport async function legacyGetSignalingSessionOptions(session: RTCSignalingSession) {\n    return typeof session.options === 'object' ? session.options : await session.getOptions();\n}\n\nexport async function connectRTCSignalingClients(\n    console: Console,\n    offerClient: RTCSignalingSession,\n    offerSetup: Partial<RTCAVSignalingSetup>,\n    answerClient: RTCSignalingSession,\n    answerSetup: Partial<RTCAVSignalingSetup>\n) {\n    const offerOptions = await legacyGetSignalingSessionOptions(offerClient);\n    const answerOptions = await legacyGetSignalingSessionOptions(answerClient);\n    const disableTrickle = offerOptions?.disableTrickle || answerOptions?.disableTrickle;\n\n    if (offerOptions?.offer && answerOptions?.offer)\n        throw new Error('Both RTC clients have offers and can not negotiate. Consider implementing this in @scrypted/webrtc.');\n\n    if (offerOptions?.requiresOffer && answerOptions?.requiresOffer)\n        throw new Error('Both RTC clients require offers and can not negotiate.');\n\n    offerSetup.type = 'offer';\n    answerSetup.type = 'answer';\n\n    const answerQueue = createCandidateQueue(console, 'offer', answerClient);\n    const offerQueue = createCandidateQueue(console, 'answer', offerClient);\n\n    const offer = await offerClient.createLocalDescription('offer', offerSetup as RTCAVSignalingSetup,\n        disableTrickle ? undefined : answerQueue.queueSendCandidate);\n    if (localStorage.getItem('debugLog') === 'true')\n        console.log('offer sdp', offer.sdp);\n    await answerClient.setRemoteDescription(offer, answerSetup as RTCAVSignalingSetup);\n    const answer = await answerClient.createLocalDescription('answer', answerSetup as RTCAVSignalingSetup,\n        disableTrickle ? undefined : offerQueue.queueSendCandidate);\n    if (localStorage.getItem('debugLog') === 'true')\n        console.log('answer sdp', answer.sdp);\n    await offerClient.setRemoteDescription(answer, offerSetup as RTCAVSignalingSetup);\n    offerQueue.flush();\n    answerQueue.flush();\n}\n","module.exports = require(\"module\");","export * from '../../../external/werift/packages/webrtc/src/index';\n// export * from '@koush/werift';\n","import type { RtcpHeader } from \"../../rtcp/header\";\nimport type { SrtpProfile } from \"../const\";\nimport { Context } from \"./context\";\n\nexport class SrtcpContext extends Context {\n  constructor(masterKey: Buffer, masterSalt: Buffer, profile: SrtpProfile) {\n    super(masterKey, masterSalt, profile);\n  }\n\n  encryptRTCP(rawRtcp: Buffer) {\n    const ssrc = rawRtcp.readUInt32BE(4);\n    const s = this.getSrtcpSsrcState(ssrc);\n    s.srtcpIndex++;\n    if (s.srtcpIndex >> maxSRTCPIndex) {\n      s.srtcpIndex = 0;\n    }\n    const enc = this.cipher.encryptRTCP(rawRtcp, s.srtcpIndex);\n    return enc;\n  }\n\n  decryptRTCP(encrypted: Buffer): [Buffer, RtcpHeader] {\n    const dec = this.cipher.decryptRTCP(encrypted);\n    return dec;\n  }\n}\n\nconst maxSRTCPIndex = 0x7fffffff;\n","/**\n * This is a subset of Werift's RtpPacket.\n */\nexport interface RtpPacket {\n    payload: Buffer;\n    header: {\n        padding: boolean;\n        marker: boolean;\n        timestamp: number;\n        sequenceNumber: number;\n    };\n    clone(): RtpPacket;\n    serialize(): Buffer;\n}\n\nexport function sequenceNumberDistance(s1: number, s2: number): number {\n    if (s2 === s1)\n        return 0;\n    const distance = s2 - s1;\n    let rolloverDistance: number;\n    if (s2 > s1)\n        rolloverDistance = s1 + 0x10000 - s2;\n    else\n        rolloverDistance = s2 + 0x10000 - s1;\n\n    if (Math.abs(distance) < Math.abs(rolloverDistance))\n        return distance;\n    return rolloverDistance;\n}\n\nexport function nextSequenceNumber(current: number, increment = 1) {\n    return (current + increment + 0x10000) % 0x10000;\n}\n\nconst maxRtpTimestamp = BigInt(0xFFFFFFFF);\nexport function addRtpTimestamp(current: number, adjust: number) {\n    return Number(maxRtpTimestamp & (BigInt(current) + BigInt(adjust)));\n}\n\nexport function isNextSequenceNumber(current: number, next: number) {\n    return nextSequenceNumber(current) === next;\n}\n\nexport class JitterBuffer {\n    lastSequenceNumber: number;\n    pending: RtpPacket[] = [];\n\n    constructor(public console: Console, public jitterSize: number,) {\n    }\n\n    flushPending(afterSequenceNumber: number, ret: RtpPacket[]): RtpPacket[] {\n        if (!this.pending)\n            return ret;\n\n        const start = nextSequenceNumber(afterSequenceNumber);\n\n        for (let i = 0; i < this.jitterSize; i++) {\n            const index = (start + i) % this.jitterSize;\n            const packet = this.pending[index];\n            if (!packet)\n                continue;\n            const { sequenceNumber } = packet.header;\n            const sd = sequenceNumberDistance(this.lastSequenceNumber, sequenceNumber);\n            // packet needs to be purged from the the buffer for being too old.\n            if (sd <= 0) {\n                this.console.log('jitter buffer purged packet:', sequenceNumber);\n                this.pending[index] = undefined;\n                ret.push(packet);\n            }\n            else if (sd === 1) {\n                this.pending[index] = undefined;\n                this.lastSequenceNumber = sequenceNumber;\n                ret.push(packet);\n            }\n            else {\n                // can't do anything with this packet yet.\n            }\n        }\n        return ret;\n    }\n\n    queue(packet: RtpPacket): RtpPacket[] {\n        if (this.lastSequenceNumber === undefined || isNextSequenceNumber(this.lastSequenceNumber, packet.header.sequenceNumber)) {\n            this.lastSequenceNumber = packet.header.sequenceNumber;\n            return this.flushPending(this.lastSequenceNumber, [packet]);\n        }\n\n        const { sequenceNumber } = packet.header;\n        const packetDistance = sequenceNumberDistance(this.lastSequenceNumber, sequenceNumber);\n        // late/duplicate packet\n        if (packetDistance <= 0)\n            return [];\n\n        const ret: RtpPacket[] = [];\n\n        // missed/late bunch of packets\n        if (packetDistance > this.jitterSize) {\n            // this.console.log('jitter buffer skipped packets:', packetDistance);\n            const { lastSequenceNumber } = this;\n            this.lastSequenceNumber = sequenceNumber - this.jitterSize;\n            // use the previous sequence number to flush any packets that are too old compared\n            // to the new sequence number.\n            this.flushPending(lastSequenceNumber, ret);\n        }\n\n        this.pending[packet.header.sequenceNumber % this.jitterSize] = packet;\n        return this.flushPending(this.lastSequenceNumber, ret);\n    }\n}\n","import { Event } from \"./imports/common\";\n\nexport function enumerate<T>(arr: T[]): [number, T][] {\n  return arr.map((v, i) => [i, v]);\n}\n\nexport type Unpacked<T> = T extends { [K in keyof T]: infer U } ? U : never;\n\nexport function createEventsFromList<T>(list: readonly T[]) {\n  return list.reduce((acc: any, cur: T) => {\n    acc[cur] = new Event();\n    return acc;\n  }, {});\n}\n","import dgram, { SocketType } from 'dgram';\nimport { once } from 'events';\nimport net from 'net';\n\nexport async function closeQuiet(socket: dgram.Socket | net.Server) {\n    if (!socket)\n        return;\n    try {\n        await new Promise((r, f) => {\n            try {\n                socket.close(r);\n            }\n            catch (e) {\n                f(e);\n            }\n        });\n    }\n    catch (e) {\n    }\n}\n\nexport async function bindUdp(server: dgram.Socket, usePort: number, address?: string) {\n    server.bind(usePort, address);\n    await once(server, 'listening');\n    const port = server.address().port;\n    return {\n        port,\n        url: `udp://127.0.0.1:${port}`,\n    }\n}\n\nexport async function bindZero(server: dgram.Socket) {\n    return bindUdp(server, 0);\n}\n\nexport async function createBindZero(socketType?: SocketType) {\n    return createBindUdp(0, socketType);\n}\n\nexport async function createSquentialBindZero(socketType?: SocketType) {\n    let attempts = 0;\n    while (true) {\n        const rtpServer = await createBindZero(socketType);\n        try {\n            const rtcpServer = await createBindUdp(rtpServer.port + 1, socketType);\n            return [rtpServer, rtcpServer];\n        }\n        catch (e) {\n            attempts++;\n            closeQuiet(rtpServer.server);\n        }\n        if (attempts === 10)\n            throw new Error('unable to reserve sequential udp ports')\n    }\n}\n\nexport async function reserveUdpPort() {\n    const udp = await createBindZero();\n    await new Promise(resolve => udp.server.close(() => resolve(undefined)));\n    return udp.port;\n}\n\nexport async function createBindUdp(usePort: number, socketType?: SocketType) {\n    const server = dgram.createSocket(socketType || 'udp4');\n    const { port, url } = await bindUdp(server, usePort);\n    return {\n        server,\n        port,\n        url,\n    };\n}\n\nexport async function bind(server: dgram.Socket, port: number) {\n    server.bind(port);\n    await once(server, 'listening');\n    return {\n        port,\n        url: `udp://127.0.0.1:${port}`,\n    }\n}\n\nexport { ListenZeroSingleClientTimeoutError, listenZero, listenZeroSingleClient } from \"../../server/src/listen-zero\";\n","import { randomUUID } from \"crypto\";\nimport { Event } from \"../imports/common\";\n\nimport { EventTarget } from \"../helper\";\nimport {\n  type Extensions,\n  type RtcpPacket,\n  type RtpHeader,\n  RtpPacket,\n} from \"../imports/rtp\";\nimport type { Kind } from \"../types/domain\";\nimport type { RTCRtpCodecParameters } from \"./parameters\";\n\nexport class MediaStreamTrack extends EventTarget {\n  readonly uuid = randomUUID().toString();\n  /**MediaStream ID*/\n  streamId?: string;\n  remote = false;\n  label: string;\n  kind!: Kind;\n  id?: string;\n  /**mediaSsrc */\n  ssrc?: number;\n  rid?: string;\n  header?: RtpHeader;\n  codec?: RTCRtpCodecParameters;\n  /**todo impl */\n  enabled = true;\n\n  readonly onReceiveRtp = new Event<[RtpPacket, Extensions?]>();\n  readonly onReceiveRtcp = new Event<[RtcpPacket]>();\n  readonly onSourceChanged = new Event<\n    [Pick<RtpHeader, \"sequenceNumber\" | \"timestamp\">]\n  >();\n\n  stopped = false;\n  muted = true;\n\n  constructor(\n    props: Partial<MediaStreamTrack> & Pick<MediaStreamTrack, \"kind\">,\n  ) {\n    super();\n    Object.assign(this, props);\n\n    this.onReceiveRtp.subscribe((rtp) => {\n      this.muted = false;\n      this.header = rtp.header;\n    });\n\n    this.label = `${this.remote ? \"remote\" : \"local\"} ${this.kind}`;\n  }\n\n  stop = () => {\n    this.stopped = true;\n    this.muted = true;\n    this.onReceiveRtp.complete();\n    this.emit(\"ended\");\n  };\n\n  writeRtp = (rtp: RtpPacket | Buffer) => {\n    if (this.remote) {\n      throw new Error(\"this is remoteTrack\");\n    }\n    if (this.stopped) {\n      return;\n    }\n\n    const packet = Buffer.isBuffer(rtp) ? RtpPacket.deSerialize(rtp) : rtp;\n    packet.header.payloadType =\n      this.codec?.payloadType ?? packet.header.payloadType;\n    this.onReceiveRtp.execute(packet);\n  };\n}\n\nexport class MediaStream {\n  id!: string;\n  tracks: MediaStreamTrack[] = [];\n\n  constructor(props: Partial<MediaStream> | MediaStreamTrack[]) {\n    if (Array.isArray(props)) {\n      this.tracks = props;\n    } else {\n      Object.assign(this, props);\n    }\n    this.id ??= randomUUID().toString();\n  }\n\n  addTrack(track: MediaStreamTrack) {\n    track.streamId = this.id;\n    this.tracks.push(track);\n  }\n\n  getTracks() {\n    return this.tracks;\n  }\n\n  getAudioTracks() {\n    return this.tracks.filter((track) => track.kind === \"audio\");\n  }\n\n  getVideoTracks() {\n    return this.tracks.filter((track) => track.kind === \"video\");\n  }\n}\n","/*! *****************************************************************************\nCopyright (C) Microsoft. All rights reserved.\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\nthis file except in compliance with the License. You may obtain a copy of the\nLicense at http://www.apache.org/licenses/LICENSE-2.0\n\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\nMERCHANTABLITY OR NON-INFRINGEMENT.\n\nSee the Apache Version 2.0 License for specific language governing permissions\nand limitations under the License.\n***************************************************************************** */\nvar Reflect;\n(function (Reflect) {\n    // Metadata Proposal\n    // https://rbuckton.github.io/reflect-metadata/\n    (function (factory) {\n        var root = typeof globalThis === \"object\" ? globalThis :\n            typeof global === \"object\" ? global :\n                typeof self === \"object\" ? self :\n                    typeof this === \"object\" ? this :\n                        sloppyModeThis();\n        var exporter = makeExporter(Reflect);\n        if (typeof root.Reflect !== \"undefined\") {\n            exporter = makeExporter(root.Reflect, exporter);\n        }\n        factory(exporter, root);\n        if (typeof root.Reflect === \"undefined\") {\n            root.Reflect = Reflect;\n        }\n        function makeExporter(target, previous) {\n            return function (key, value) {\n                Object.defineProperty(target, key, { configurable: true, writable: true, value: value });\n                if (previous)\n                    previous(key, value);\n            };\n        }\n        function functionThis() {\n            try {\n                return Function(\"return this;\")();\n            }\n            catch (_) { }\n        }\n        function indirectEvalThis() {\n            try {\n                return (void 0, eval)(\"(function() { return this; })()\");\n            }\n            catch (_) { }\n        }\n        function sloppyModeThis() {\n            return functionThis() || indirectEvalThis();\n        }\n    })(function (exporter, root) {\n        var hasOwn = Object.prototype.hasOwnProperty;\n        // feature test for Symbol support\n        var supportsSymbol = typeof Symbol === \"function\";\n        var toPrimitiveSymbol = supportsSymbol && typeof Symbol.toPrimitive !== \"undefined\" ? Symbol.toPrimitive : \"@@toPrimitive\";\n        var iteratorSymbol = supportsSymbol && typeof Symbol.iterator !== \"undefined\" ? Symbol.iterator : \"@@iterator\";\n        var supportsCreate = typeof Object.create === \"function\"; // feature test for Object.create support\n        var supportsProto = { __proto__: [] } instanceof Array; // feature test for __proto__ support\n        var downLevel = !supportsCreate && !supportsProto;\n        var HashMap = {\n            // create an object in dictionary mode (a.k.a. \"slow\" mode in v8)\n            create: supportsCreate\n                ? function () { return MakeDictionary(Object.create(null)); }\n                : supportsProto\n                    ? function () { return MakeDictionary({ __proto__: null }); }\n                    : function () { return MakeDictionary({}); },\n            has: downLevel\n                ? function (map, key) { return hasOwn.call(map, key); }\n                : function (map, key) { return key in map; },\n            get: downLevel\n                ? function (map, key) { return hasOwn.call(map, key) ? map[key] : undefined; }\n                : function (map, key) { return map[key]; },\n        };\n        // Load global or shim versions of Map, Set, and WeakMap\n        var functionPrototype = Object.getPrototypeOf(Function);\n        var _Map = typeof Map === \"function\" && typeof Map.prototype.entries === \"function\" ? Map : CreateMapPolyfill();\n        var _Set = typeof Set === \"function\" && typeof Set.prototype.entries === \"function\" ? Set : CreateSetPolyfill();\n        var _WeakMap = typeof WeakMap === \"function\" ? WeakMap : CreateWeakMapPolyfill();\n        var registrySymbol = supportsSymbol ? Symbol.for(\"@reflect-metadata:registry\") : undefined;\n        var metadataRegistry = GetOrCreateMetadataRegistry();\n        var metadataProvider = CreateMetadataProvider(metadataRegistry);\n        /**\n         * Applies a set of decorators to a property of a target object.\n         * @param decorators An array of decorators.\n         * @param target The target object.\n         * @param propertyKey (Optional) The property key to decorate.\n         * @param attributes (Optional) The property descriptor for the target key.\n         * @remarks Decorators are applied in reverse order.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Example = Reflect.decorate(decoratorsArray, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.decorate(decoratorsArray, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.decorate(decoratorsArray, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Object.defineProperty(Example, \"staticMethod\",\n         *         Reflect.decorate(decoratorsArray, Example, \"staticMethod\",\n         *             Object.getOwnPropertyDescriptor(Example, \"staticMethod\")));\n         *\n         *     // method (on prototype)\n         *     Object.defineProperty(Example.prototype, \"method\",\n         *         Reflect.decorate(decoratorsArray, Example.prototype, \"method\",\n         *             Object.getOwnPropertyDescriptor(Example.prototype, \"method\")));\n         *\n         */\n        function decorate(decorators, target, propertyKey, attributes) {\n            if (!IsUndefined(propertyKey)) {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsObject(attributes) && !IsUndefined(attributes) && !IsNull(attributes))\n                    throw new TypeError();\n                if (IsNull(attributes))\n                    attributes = undefined;\n                propertyKey = ToPropertyKey(propertyKey);\n                return DecorateProperty(decorators, target, propertyKey, attributes);\n            }\n            else {\n                if (!IsArray(decorators))\n                    throw new TypeError();\n                if (!IsConstructor(target))\n                    throw new TypeError();\n                return DecorateConstructor(decorators, target);\n            }\n        }\n        exporter(\"decorate\", decorate);\n        // 4.1.2 Reflect.metadata(metadataKey, metadataValue)\n        // https://rbuckton.github.io/reflect-metadata/#reflect.metadata\n        /**\n         * A default metadata decorator factory that can be used on a class, class member, or parameter.\n         * @param metadataKey The key for the metadata entry.\n         * @param metadataValue The value for the metadata entry.\n         * @returns A decorator function.\n         * @remarks\n         * If `metadataKey` is already defined for the target and target key, the\n         * metadataValue for that key will be overwritten.\n         * @example\n         *\n         *     // constructor\n         *     @Reflect.metadata(key, value)\n         *     class Example {\n         *     }\n         *\n         *     // property (on constructor, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticProperty;\n         *     }\n         *\n         *     // property (on prototype, TypeScript only)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         property;\n         *     }\n         *\n         *     // method (on constructor)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         static staticMethod() { }\n         *     }\n         *\n         *     // method (on prototype)\n         *     class Example {\n         *         @Reflect.metadata(key, value)\n         *         method() { }\n         *     }\n         *\n         */\n        function metadata(metadataKey, metadataValue) {\n            function decorator(target, propertyKey) {\n                if (!IsObject(target))\n                    throw new TypeError();\n                if (!IsUndefined(propertyKey) && !IsPropertyKey(propertyKey))\n                    throw new TypeError();\n                OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n            }\n            return decorator;\n        }\n        exporter(\"metadata\", metadata);\n        /**\n         * Define a unique metadata entry on the target.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param metadataValue A value that contains attached metadata.\n         * @param target The target object on which to define metadata.\n         * @param propertyKey (Optional) The property key for the target.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example);\n         *\n         *     // property (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     Reflect.defineMetadata(\"custom:annotation\", options, Example.prototype, \"method\");\n         *\n         *     // decorator factory as metadata-producing annotation.\n         *     function MyAnnotation(options): Decorator {\n         *         return (target, key?) => Reflect.defineMetadata(\"custom:annotation\", options, target, key);\n         *     }\n         *\n         */\n        function defineMetadata(metadataKey, metadataValue, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryDefineOwnMetadata(metadataKey, metadataValue, target, propertyKey);\n        }\n        exporter(\"defineMetadata\", defineMetadata);\n        /**\n         * Gets a value indicating whether the target object or its prototype chain has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object or its prototype chain; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasMetadata\", hasMetadata);\n        /**\n         * Gets a value indicating whether the target object has the provided metadata key defined.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata key was defined on the target object; otherwise, `false`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.hasOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function hasOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryHasOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"hasOwnMetadata\", hasOwnMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object or its prototype chain.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getMetadata\", getMetadata);\n        /**\n         * Gets the metadata value for the provided metadata key on the target object.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns The metadata value for the metadata key if found; otherwise, `undefined`.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryGetOwnMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"getOwnMetadata\", getOwnMetadata);\n        /**\n         * Gets the metadata keys defined on the target object or its prototype chain.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getMetadataKeys\", getMetadataKeys);\n        /**\n         * Gets the unique metadata keys defined on the target object.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns An array of unique metadata keys.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.getOwnMetadataKeys(Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.getOwnMetadataKeys(Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.getOwnMetadataKeys(Example.prototype, \"method\");\n         *\n         */\n        function getOwnMetadataKeys(target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            return OrdinaryOwnMetadataKeys(target, propertyKey);\n        }\n        exporter(\"getOwnMetadataKeys\", getOwnMetadataKeys);\n        /**\n         * Deletes the metadata entry from the target object with the provided key.\n         * @param metadataKey A key used to store and retrieve metadata.\n         * @param target The target object on which the metadata is defined.\n         * @param propertyKey (Optional) The property key for the target.\n         * @returns `true` if the metadata entry was found and deleted; otherwise, false.\n         * @example\n         *\n         *     class Example {\n         *         // property declarations are not part of ES6, though they are valid in TypeScript:\n         *         // static staticProperty;\n         *         // property;\n         *\n         *         constructor(p) { }\n         *         static staticMethod(p) { }\n         *         method(p) { }\n         *     }\n         *\n         *     // constructor\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example);\n         *\n         *     // property (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticProperty\");\n         *\n         *     // property (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"property\");\n         *\n         *     // method (on constructor)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example, \"staticMethod\");\n         *\n         *     // method (on prototype)\n         *     result = Reflect.deleteMetadata(\"custom:annotation\", Example.prototype, \"method\");\n         *\n         */\n        function deleteMetadata(metadataKey, target, propertyKey) {\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            if (!IsObject(target))\n                throw new TypeError();\n            if (!IsUndefined(propertyKey))\n                propertyKey = ToPropertyKey(propertyKey);\n            var provider = GetMetadataProvider(target, propertyKey, /*Create*/ false);\n            if (IsUndefined(provider))\n                return false;\n            return provider.OrdinaryDeleteMetadata(metadataKey, target, propertyKey);\n        }\n        exporter(\"deleteMetadata\", deleteMetadata);\n        function DecorateConstructor(decorators, target) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsConstructor(decorated))\n                        throw new TypeError();\n                    target = decorated;\n                }\n            }\n            return target;\n        }\n        function DecorateProperty(decorators, target, propertyKey, descriptor) {\n            for (var i = decorators.length - 1; i >= 0; --i) {\n                var decorator = decorators[i];\n                var decorated = decorator(target, propertyKey, descriptor);\n                if (!IsUndefined(decorated) && !IsNull(decorated)) {\n                    if (!IsObject(decorated))\n                        throw new TypeError();\n                    descriptor = decorated;\n                }\n            }\n            return descriptor;\n        }\n        // 3.1.1.1 OrdinaryHasMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasmetadata\n        function OrdinaryHasMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return true;\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryHasMetadata(MetadataKey, parent, P);\n            return false;\n        }\n        // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n        function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ false);\n            if (IsUndefined(provider))\n                return false;\n            return ToBoolean(provider.OrdinaryHasOwnMetadata(MetadataKey, O, P));\n        }\n        // 3.1.3.1 OrdinaryGetMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetmetadata\n        function OrdinaryGetMetadata(MetadataKey, O, P) {\n            var hasOwn = OrdinaryHasOwnMetadata(MetadataKey, O, P);\n            if (hasOwn)\n                return OrdinaryGetOwnMetadata(MetadataKey, O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (!IsNull(parent))\n                return OrdinaryGetMetadata(MetadataKey, parent, P);\n            return undefined;\n        }\n        // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n        function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ false);\n            if (IsUndefined(provider))\n                return;\n            return provider.OrdinaryGetOwnMetadata(MetadataKey, O, P);\n        }\n        // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n        function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n            var provider = GetMetadataProvider(O, P, /*Create*/ true);\n            provider.OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P);\n        }\n        // 3.1.6.1 OrdinaryMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinarymetadatakeys\n        function OrdinaryMetadataKeys(O, P) {\n            var ownKeys = OrdinaryOwnMetadataKeys(O, P);\n            var parent = OrdinaryGetPrototypeOf(O);\n            if (parent === null)\n                return ownKeys;\n            var parentKeys = OrdinaryMetadataKeys(parent, P);\n            if (parentKeys.length <= 0)\n                return ownKeys;\n            if (ownKeys.length <= 0)\n                return parentKeys;\n            var set = new _Set();\n            var keys = [];\n            for (var _i = 0, ownKeys_1 = ownKeys; _i < ownKeys_1.length; _i++) {\n                var key = ownKeys_1[_i];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            for (var _a = 0, parentKeys_1 = parentKeys; _a < parentKeys_1.length; _a++) {\n                var key = parentKeys_1[_a];\n                var hasKey = set.has(key);\n                if (!hasKey) {\n                    set.add(key);\n                    keys.push(key);\n                }\n            }\n            return keys;\n        }\n        // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n        // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n        function OrdinaryOwnMetadataKeys(O, P) {\n            var provider = GetMetadataProvider(O, P, /*create*/ false);\n            if (!provider) {\n                return [];\n            }\n            return provider.OrdinaryOwnMetadataKeys(O, P);\n        }\n        // 6 ECMAScript Data Types and Values\n        // https://tc39.github.io/ecma262/#sec-ecmascript-data-types-and-values\n        function Type(x) {\n            if (x === null)\n                return 1 /* Null */;\n            switch (typeof x) {\n                case \"undefined\": return 0 /* Undefined */;\n                case \"boolean\": return 2 /* Boolean */;\n                case \"string\": return 3 /* String */;\n                case \"symbol\": return 4 /* Symbol */;\n                case \"number\": return 5 /* Number */;\n                case \"object\": return x === null ? 1 /* Null */ : 6 /* Object */;\n                default: return 6 /* Object */;\n            }\n        }\n        // 6.1.1 The Undefined Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-undefined-type\n        function IsUndefined(x) {\n            return x === undefined;\n        }\n        // 6.1.2 The Null Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-null-type\n        function IsNull(x) {\n            return x === null;\n        }\n        // 6.1.5 The Symbol Type\n        // https://tc39.github.io/ecma262/#sec-ecmascript-language-types-symbol-type\n        function IsSymbol(x) {\n            return typeof x === \"symbol\";\n        }\n        // 6.1.7 The Object Type\n        // https://tc39.github.io/ecma262/#sec-object-type\n        function IsObject(x) {\n            return typeof x === \"object\" ? x !== null : typeof x === \"function\";\n        }\n        // 7.1 Type Conversion\n        // https://tc39.github.io/ecma262/#sec-type-conversion\n        // 7.1.1 ToPrimitive(input [, PreferredType])\n        // https://tc39.github.io/ecma262/#sec-toprimitive\n        function ToPrimitive(input, PreferredType) {\n            switch (Type(input)) {\n                case 0 /* Undefined */: return input;\n                case 1 /* Null */: return input;\n                case 2 /* Boolean */: return input;\n                case 3 /* String */: return input;\n                case 4 /* Symbol */: return input;\n                case 5 /* Number */: return input;\n            }\n            var hint = PreferredType === 3 /* String */ ? \"string\" : PreferredType === 5 /* Number */ ? \"number\" : \"default\";\n            var exoticToPrim = GetMethod(input, toPrimitiveSymbol);\n            if (exoticToPrim !== undefined) {\n                var result = exoticToPrim.call(input, hint);\n                if (IsObject(result))\n                    throw new TypeError();\n                return result;\n            }\n            return OrdinaryToPrimitive(input, hint === \"default\" ? \"number\" : hint);\n        }\n        // 7.1.1.1 OrdinaryToPrimitive(O, hint)\n        // https://tc39.github.io/ecma262/#sec-ordinarytoprimitive\n        function OrdinaryToPrimitive(O, hint) {\n            if (hint === \"string\") {\n                var toString_1 = O.toString;\n                if (IsCallable(toString_1)) {\n                    var result = toString_1.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            else {\n                var valueOf = O.valueOf;\n                if (IsCallable(valueOf)) {\n                    var result = valueOf.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n                var toString_2 = O.toString;\n                if (IsCallable(toString_2)) {\n                    var result = toString_2.call(O);\n                    if (!IsObject(result))\n                        return result;\n                }\n            }\n            throw new TypeError();\n        }\n        // 7.1.2 ToBoolean(argument)\n        // https://tc39.github.io/ecma262/2016/#sec-toboolean\n        function ToBoolean(argument) {\n            return !!argument;\n        }\n        // 7.1.12 ToString(argument)\n        // https://tc39.github.io/ecma262/#sec-tostring\n        function ToString(argument) {\n            return \"\" + argument;\n        }\n        // 7.1.14 ToPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-topropertykey\n        function ToPropertyKey(argument) {\n            var key = ToPrimitive(argument, 3 /* String */);\n            if (IsSymbol(key))\n                return key;\n            return ToString(key);\n        }\n        // 7.2 Testing and Comparison Operations\n        // https://tc39.github.io/ecma262/#sec-testing-and-comparison-operations\n        // 7.2.2 IsArray(argument)\n        // https://tc39.github.io/ecma262/#sec-isarray\n        function IsArray(argument) {\n            return Array.isArray\n                ? Array.isArray(argument)\n                : argument instanceof Object\n                    ? argument instanceof Array\n                    : Object.prototype.toString.call(argument) === \"[object Array]\";\n        }\n        // 7.2.3 IsCallable(argument)\n        // https://tc39.github.io/ecma262/#sec-iscallable\n        function IsCallable(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Call]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.4 IsConstructor(argument)\n        // https://tc39.github.io/ecma262/#sec-isconstructor\n        function IsConstructor(argument) {\n            // NOTE: This is an approximation as we cannot check for [[Construct]] internal method.\n            return typeof argument === \"function\";\n        }\n        // 7.2.7 IsPropertyKey(argument)\n        // https://tc39.github.io/ecma262/#sec-ispropertykey\n        function IsPropertyKey(argument) {\n            switch (Type(argument)) {\n                case 3 /* String */: return true;\n                case 4 /* Symbol */: return true;\n                default: return false;\n            }\n        }\n        function SameValueZero(x, y) {\n            return x === y || x !== x && y !== y;\n        }\n        // 7.3 Operations on Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-objects\n        // 7.3.9 GetMethod(V, P)\n        // https://tc39.github.io/ecma262/#sec-getmethod\n        function GetMethod(V, P) {\n            var func = V[P];\n            if (func === undefined || func === null)\n                return undefined;\n            if (!IsCallable(func))\n                throw new TypeError();\n            return func;\n        }\n        // 7.4 Operations on Iterator Objects\n        // https://tc39.github.io/ecma262/#sec-operations-on-iterator-objects\n        function GetIterator(obj) {\n            var method = GetMethod(obj, iteratorSymbol);\n            if (!IsCallable(method))\n                throw new TypeError(); // from Call\n            var iterator = method.call(obj);\n            if (!IsObject(iterator))\n                throw new TypeError();\n            return iterator;\n        }\n        // 7.4.4 IteratorValue(iterResult)\n        // https://tc39.github.io/ecma262/2016/#sec-iteratorvalue\n        function IteratorValue(iterResult) {\n            return iterResult.value;\n        }\n        // 7.4.5 IteratorStep(iterator)\n        // https://tc39.github.io/ecma262/#sec-iteratorstep\n        function IteratorStep(iterator) {\n            var result = iterator.next();\n            return result.done ? false : result;\n        }\n        // 7.4.6 IteratorClose(iterator, completion)\n        // https://tc39.github.io/ecma262/#sec-iteratorclose\n        function IteratorClose(iterator) {\n            var f = iterator[\"return\"];\n            if (f)\n                f.call(iterator);\n        }\n        // 9.1 Ordinary Object Internal Methods and Internal Slots\n        // https://tc39.github.io/ecma262/#sec-ordinary-object-internal-methods-and-internal-slots\n        // 9.1.1.1 OrdinaryGetPrototypeOf(O)\n        // https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof\n        function OrdinaryGetPrototypeOf(O) {\n            var proto = Object.getPrototypeOf(O);\n            if (typeof O !== \"function\" || O === functionPrototype)\n                return proto;\n            // TypeScript doesn't set __proto__ in ES5, as it's non-standard.\n            // Try to determine the superclass constructor. Compatible implementations\n            // must either set __proto__ on a subclass constructor to the superclass constructor,\n            // or ensure each class has a valid `constructor` property on its prototype that\n            // points back to the constructor.\n            // If this is not the same as Function.[[Prototype]], then this is definately inherited.\n            // This is the case when in ES6 or when using __proto__ in a compatible browser.\n            if (proto !== functionPrototype)\n                return proto;\n            // If the super prototype is Object.prototype, null, or undefined, then we cannot determine the heritage.\n            var prototype = O.prototype;\n            var prototypeProto = prototype && Object.getPrototypeOf(prototype);\n            if (prototypeProto == null || prototypeProto === Object.prototype)\n                return proto;\n            // If the constructor was not a function, then we cannot determine the heritage.\n            var constructor = prototypeProto.constructor;\n            if (typeof constructor !== \"function\")\n                return proto;\n            // If we have some kind of self-reference, then we cannot determine the heritage.\n            if (constructor === O)\n                return proto;\n            // we have a pretty good guess at the heritage.\n            return constructor;\n        }\n        // Global metadata registry\n        // - Allows `import \"reflect-metadata\"` and `import \"reflect-metadata/no-conflict\"` to interoperate.\n        // - Uses isolated metadata if `Reflect` is frozen before the registry can be installed.\n        /**\n         * Creates a registry used to allow multiple `reflect-metadata` providers.\n         */\n        function CreateMetadataRegistry() {\n            var fallback;\n            if (!IsUndefined(registrySymbol) &&\n                typeof root.Reflect !== \"undefined\" &&\n                !(registrySymbol in root.Reflect) &&\n                typeof root.Reflect.defineMetadata === \"function\") {\n                // interoperate with older version of `reflect-metadata` that did not support a registry.\n                fallback = CreateFallbackProvider(root.Reflect);\n            }\n            var first;\n            var second;\n            var rest;\n            var targetProviderMap = new _WeakMap();\n            var registry = {\n                registerProvider: registerProvider,\n                getProvider: getProvider,\n                setProvider: setProvider,\n            };\n            return registry;\n            function registerProvider(provider) {\n                if (!Object.isExtensible(registry)) {\n                    throw new Error(\"Cannot add provider to a frozen registry.\");\n                }\n                switch (true) {\n                    case fallback === provider: break;\n                    case IsUndefined(first):\n                        first = provider;\n                        break;\n                    case first === provider: break;\n                    case IsUndefined(second):\n                        second = provider;\n                        break;\n                    case second === provider: break;\n                    default:\n                        if (rest === undefined)\n                            rest = new _Set();\n                        rest.add(provider);\n                        break;\n                }\n            }\n            function getProviderNoCache(O, P) {\n                if (!IsUndefined(first)) {\n                    if (first.isProviderFor(O, P))\n                        return first;\n                    if (!IsUndefined(second)) {\n                        if (second.isProviderFor(O, P))\n                            return first;\n                        if (!IsUndefined(rest)) {\n                            var iterator = GetIterator(rest);\n                            while (true) {\n                                var next = IteratorStep(iterator);\n                                if (!next) {\n                                    return undefined;\n                                }\n                                var provider = IteratorValue(next);\n                                if (provider.isProviderFor(O, P)) {\n                                    IteratorClose(iterator);\n                                    return provider;\n                                }\n                            }\n                        }\n                    }\n                }\n                if (!IsUndefined(fallback) && fallback.isProviderFor(O, P)) {\n                    return fallback;\n                }\n                return undefined;\n            }\n            function getProvider(O, P) {\n                var providerMap = targetProviderMap.get(O);\n                var provider;\n                if (!IsUndefined(providerMap)) {\n                    provider = providerMap.get(P);\n                }\n                if (!IsUndefined(provider)) {\n                    return provider;\n                }\n                provider = getProviderNoCache(O, P);\n                if (!IsUndefined(provider)) {\n                    if (IsUndefined(providerMap)) {\n                        providerMap = new _Map();\n                        targetProviderMap.set(O, providerMap);\n                    }\n                    providerMap.set(P, provider);\n                }\n                return provider;\n            }\n            function hasProvider(provider) {\n                if (IsUndefined(provider))\n                    throw new TypeError();\n                return first === provider || second === provider || !IsUndefined(rest) && rest.has(provider);\n            }\n            function setProvider(O, P, provider) {\n                if (!hasProvider(provider)) {\n                    throw new Error(\"Metadata provider not registered.\");\n                }\n                var existingProvider = getProvider(O, P);\n                if (existingProvider !== provider) {\n                    if (!IsUndefined(existingProvider)) {\n                        return false;\n                    }\n                    var providerMap = targetProviderMap.get(O);\n                    if (IsUndefined(providerMap)) {\n                        providerMap = new _Map();\n                        targetProviderMap.set(O, providerMap);\n                    }\n                    providerMap.set(P, provider);\n                }\n                return true;\n            }\n        }\n        /**\n         * Gets or creates the shared registry of metadata providers.\n         */\n        function GetOrCreateMetadataRegistry() {\n            var metadataRegistry;\n            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {\n                metadataRegistry = root.Reflect[registrySymbol];\n            }\n            if (IsUndefined(metadataRegistry)) {\n                metadataRegistry = CreateMetadataRegistry();\n            }\n            if (!IsUndefined(registrySymbol) && IsObject(root.Reflect) && Object.isExtensible(root.Reflect)) {\n                Object.defineProperty(root.Reflect, registrySymbol, {\n                    enumerable: false,\n                    configurable: false,\n                    writable: false,\n                    value: metadataRegistry\n                });\n            }\n            return metadataRegistry;\n        }\n        function CreateMetadataProvider(registry) {\n            // [[Metadata]] internal slot\n            // https://rbuckton.github.io/reflect-metadata/#ordinary-object-internal-methods-and-internal-slots\n            var metadata = new _WeakMap();\n            var provider = {\n                isProviderFor: function (O, P) {\n                    var targetMetadata = metadata.get(O);\n                    if (IsUndefined(targetMetadata))\n                        return false;\n                    return targetMetadata.has(P);\n                },\n                OrdinaryDefineOwnMetadata: OrdinaryDefineOwnMetadata,\n                OrdinaryHasOwnMetadata: OrdinaryHasOwnMetadata,\n                OrdinaryGetOwnMetadata: OrdinaryGetOwnMetadata,\n                OrdinaryOwnMetadataKeys: OrdinaryOwnMetadataKeys,\n                OrdinaryDeleteMetadata: OrdinaryDeleteMetadata,\n            };\n            metadataRegistry.registerProvider(provider);\n            return provider;\n            function GetOrCreateMetadataMap(O, P, Create) {\n                var targetMetadata = metadata.get(O);\n                var createdTargetMetadata = false;\n                if (IsUndefined(targetMetadata)) {\n                    if (!Create)\n                        return undefined;\n                    targetMetadata = new _Map();\n                    metadata.set(O, targetMetadata);\n                    createdTargetMetadata = true;\n                }\n                var metadataMap = targetMetadata.get(P);\n                if (IsUndefined(metadataMap)) {\n                    if (!Create)\n                        return undefined;\n                    metadataMap = new _Map();\n                    targetMetadata.set(P, metadataMap);\n                    if (!registry.setProvider(O, P, provider)) {\n                        targetMetadata.delete(P);\n                        if (createdTargetMetadata) {\n                            metadata.delete(O);\n                        }\n                        throw new Error(\"Wrong provider for target.\");\n                    }\n                }\n                return metadataMap;\n            }\n            // 3.1.2.1 OrdinaryHasOwnMetadata(MetadataKey, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinaryhasownmetadata\n            function OrdinaryHasOwnMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return false;\n                return ToBoolean(metadataMap.has(MetadataKey));\n            }\n            // 3.1.4.1 OrdinaryGetOwnMetadata(MetadataKey, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinarygetownmetadata\n            function OrdinaryGetOwnMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return undefined;\n                return metadataMap.get(MetadataKey);\n            }\n            // 3.1.5.1 OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinarydefineownmetadata\n            function OrdinaryDefineOwnMetadata(MetadataKey, MetadataValue, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ true);\n                metadataMap.set(MetadataKey, MetadataValue);\n            }\n            // 3.1.7.1 OrdinaryOwnMetadataKeys(O, P)\n            // https://rbuckton.github.io/reflect-metadata/#ordinaryownmetadatakeys\n            function OrdinaryOwnMetadataKeys(O, P) {\n                var keys = [];\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return keys;\n                var keysObj = metadataMap.keys();\n                var iterator = GetIterator(keysObj);\n                var k = 0;\n                while (true) {\n                    var next = IteratorStep(iterator);\n                    if (!next) {\n                        keys.length = k;\n                        return keys;\n                    }\n                    var nextValue = IteratorValue(next);\n                    try {\n                        keys[k] = nextValue;\n                    }\n                    catch (e) {\n                        try {\n                            IteratorClose(iterator);\n                        }\n                        finally {\n                            throw e;\n                        }\n                    }\n                    k++;\n                }\n            }\n            function OrdinaryDeleteMetadata(MetadataKey, O, P) {\n                var metadataMap = GetOrCreateMetadataMap(O, P, /*Create*/ false);\n                if (IsUndefined(metadataMap))\n                    return false;\n                if (!metadataMap.delete(MetadataKey))\n                    return false;\n                if (metadataMap.size === 0) {\n                    var targetMetadata = metadata.get(O);\n                    if (!IsUndefined(targetMetadata)) {\n                        targetMetadata.delete(P);\n                        if (targetMetadata.size === 0) {\n                            metadata.delete(targetMetadata);\n                        }\n                    }\n                }\n                return true;\n            }\n        }\n        function CreateFallbackProvider(reflect) {\n            var defineMetadata = reflect.defineMetadata, hasOwnMetadata = reflect.hasOwnMetadata, getOwnMetadata = reflect.getOwnMetadata, getOwnMetadataKeys = reflect.getOwnMetadataKeys, deleteMetadata = reflect.deleteMetadata;\n            var metadataOwner = new _WeakMap();\n            var provider = {\n                isProviderFor: function (O, P) {\n                    var metadataPropertySet = metadataOwner.get(O);\n                    if (!IsUndefined(metadataPropertySet) && metadataPropertySet.has(P)) {\n                        return true;\n                    }\n                    if (getOwnMetadataKeys(O, P).length) {\n                        if (IsUndefined(metadataPropertySet)) {\n                            metadataPropertySet = new _Set();\n                            metadataOwner.set(O, metadataPropertySet);\n                        }\n                        metadataPropertySet.add(P);\n                        return true;\n                    }\n                    return false;\n                },\n                OrdinaryDefineOwnMetadata: defineMetadata,\n                OrdinaryHasOwnMetadata: hasOwnMetadata,\n                OrdinaryGetOwnMetadata: getOwnMetadata,\n                OrdinaryOwnMetadataKeys: getOwnMetadataKeys,\n                OrdinaryDeleteMetadata: deleteMetadata,\n            };\n            return provider;\n        }\n        /**\n         * Gets the metadata provider for an object. If the object has no metadata provider and this is for a create operation,\n         * then this module's metadata provider is assigned to the object.\n         */\n        function GetMetadataProvider(O, P, Create) {\n            var registeredProvider = metadataRegistry.getProvider(O, P);\n            if (!IsUndefined(registeredProvider)) {\n                return registeredProvider;\n            }\n            if (Create) {\n                if (metadataRegistry.setProvider(O, P, metadataProvider)) {\n                    return metadataProvider;\n                }\n                throw new Error(\"Illegal state.\");\n            }\n            return undefined;\n        }\n        // naive Map shim\n        function CreateMapPolyfill() {\n            var cacheSentinel = {};\n            var arraySentinel = [];\n            var MapIterator = /** @class */ (function () {\n                function MapIterator(keys, values, selector) {\n                    this._index = 0;\n                    this._keys = keys;\n                    this._values = values;\n                    this._selector = selector;\n                }\n                MapIterator.prototype[\"@@iterator\"] = function () { return this; };\n                MapIterator.prototype[iteratorSymbol] = function () { return this; };\n                MapIterator.prototype.next = function () {\n                    var index = this._index;\n                    if (index >= 0 && index < this._keys.length) {\n                        var result = this._selector(this._keys[index], this._values[index]);\n                        if (index + 1 >= this._keys.length) {\n                            this._index = -1;\n                            this._keys = arraySentinel;\n                            this._values = arraySentinel;\n                        }\n                        else {\n                            this._index++;\n                        }\n                        return { value: result, done: false };\n                    }\n                    return { value: undefined, done: true };\n                };\n                MapIterator.prototype.throw = function (error) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    throw error;\n                };\n                MapIterator.prototype.return = function (value) {\n                    if (this._index >= 0) {\n                        this._index = -1;\n                        this._keys = arraySentinel;\n                        this._values = arraySentinel;\n                    }\n                    return { value: value, done: true };\n                };\n                return MapIterator;\n            }());\n            var Map = /** @class */ (function () {\n                function Map() {\n                    this._keys = [];\n                    this._values = [];\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                }\n                Object.defineProperty(Map.prototype, \"size\", {\n                    get: function () { return this._keys.length; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Map.prototype.has = function (key) { return this._find(key, /*insert*/ false) >= 0; };\n                Map.prototype.get = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    return index >= 0 ? this._values[index] : undefined;\n                };\n                Map.prototype.set = function (key, value) {\n                    var index = this._find(key, /*insert*/ true);\n                    this._values[index] = value;\n                    return this;\n                };\n                Map.prototype.delete = function (key) {\n                    var index = this._find(key, /*insert*/ false);\n                    if (index >= 0) {\n                        var size = this._keys.length;\n                        for (var i = index + 1; i < size; i++) {\n                            this._keys[i - 1] = this._keys[i];\n                            this._values[i - 1] = this._values[i];\n                        }\n                        this._keys.length--;\n                        this._values.length--;\n                        if (SameValueZero(key, this._cacheKey)) {\n                            this._cacheKey = cacheSentinel;\n                            this._cacheIndex = -2;\n                        }\n                        return true;\n                    }\n                    return false;\n                };\n                Map.prototype.clear = function () {\n                    this._keys.length = 0;\n                    this._values.length = 0;\n                    this._cacheKey = cacheSentinel;\n                    this._cacheIndex = -2;\n                };\n                Map.prototype.keys = function () { return new MapIterator(this._keys, this._values, getKey); };\n                Map.prototype.values = function () { return new MapIterator(this._keys, this._values, getValue); };\n                Map.prototype.entries = function () { return new MapIterator(this._keys, this._values, getEntry); };\n                Map.prototype[\"@@iterator\"] = function () { return this.entries(); };\n                Map.prototype[iteratorSymbol] = function () { return this.entries(); };\n                Map.prototype._find = function (key, insert) {\n                    if (!SameValueZero(this._cacheKey, key)) {\n                        this._cacheIndex = -1;\n                        for (var i = 0; i < this._keys.length; i++) {\n                            if (SameValueZero(this._keys[i], key)) {\n                                this._cacheIndex = i;\n                                break;\n                            }\n                        }\n                    }\n                    if (this._cacheIndex < 0 && insert) {\n                        this._cacheIndex = this._keys.length;\n                        this._keys.push(key);\n                        this._values.push(undefined);\n                    }\n                    return this._cacheIndex;\n                };\n                return Map;\n            }());\n            return Map;\n            function getKey(key, _) {\n                return key;\n            }\n            function getValue(_, value) {\n                return value;\n            }\n            function getEntry(key, value) {\n                return [key, value];\n            }\n        }\n        // naive Set shim\n        function CreateSetPolyfill() {\n            var Set = /** @class */ (function () {\n                function Set() {\n                    this._map = new _Map();\n                }\n                Object.defineProperty(Set.prototype, \"size\", {\n                    get: function () { return this._map.size; },\n                    enumerable: true,\n                    configurable: true\n                });\n                Set.prototype.has = function (value) { return this._map.has(value); };\n                Set.prototype.add = function (value) { return this._map.set(value, value), this; };\n                Set.prototype.delete = function (value) { return this._map.delete(value); };\n                Set.prototype.clear = function () { this._map.clear(); };\n                Set.prototype.keys = function () { return this._map.keys(); };\n                Set.prototype.values = function () { return this._map.keys(); };\n                Set.prototype.entries = function () { return this._map.entries(); };\n                Set.prototype[\"@@iterator\"] = function () { return this.keys(); };\n                Set.prototype[iteratorSymbol] = function () { return this.keys(); };\n                return Set;\n            }());\n            return Set;\n        }\n        // naive WeakMap shim\n        function CreateWeakMapPolyfill() {\n            var UUID_SIZE = 16;\n            var keys = HashMap.create();\n            var rootKey = CreateUniqueKey();\n            return /** @class */ (function () {\n                function WeakMap() {\n                    this._key = CreateUniqueKey();\n                }\n                WeakMap.prototype.has = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.has(table, this._key) : false;\n                };\n                WeakMap.prototype.get = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? HashMap.get(table, this._key) : undefined;\n                };\n                WeakMap.prototype.set = function (target, value) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ true);\n                    table[this._key] = value;\n                    return this;\n                };\n                WeakMap.prototype.delete = function (target) {\n                    var table = GetOrCreateWeakMapTable(target, /*create*/ false);\n                    return table !== undefined ? delete table[this._key] : false;\n                };\n                WeakMap.prototype.clear = function () {\n                    // NOTE: not a real clear, just makes the previous data unreachable\n                    this._key = CreateUniqueKey();\n                };\n                return WeakMap;\n            }());\n            function CreateUniqueKey() {\n                var key;\n                do\n                    key = \"@@WeakMap@@\" + CreateUUID();\n                while (HashMap.has(keys, key));\n                keys[key] = true;\n                return key;\n            }\n            function GetOrCreateWeakMapTable(target, create) {\n                if (!hasOwn.call(target, rootKey)) {\n                    if (!create)\n                        return undefined;\n                    Object.defineProperty(target, rootKey, { value: HashMap.create() });\n                }\n                return target[rootKey];\n            }\n            function FillRandomBytes(buffer, size) {\n                for (var i = 0; i < size; ++i)\n                    buffer[i] = Math.random() * 0xff | 0;\n                return buffer;\n            }\n            function GenRandomBytes(size) {\n                if (typeof Uint8Array === \"function\") {\n                    var array = new Uint8Array(size);\n                    if (typeof crypto !== \"undefined\") {\n                        crypto.getRandomValues(array);\n                    }\n                    else if (typeof msCrypto !== \"undefined\") {\n                        msCrypto.getRandomValues(array);\n                    }\n                    else {\n                        FillRandomBytes(array, size);\n                    }\n                    return array;\n                }\n                return FillRandomBytes(new Array(size), size);\n            }\n            function CreateUUID() {\n                var data = GenRandomBytes(UUID_SIZE);\n                // mark as random - RFC 4122  4.4\n                data[6] = data[6] & 0x4f | 0x40;\n                data[8] = data[8] & 0xbf | 0x80;\n                var result = \"\";\n                for (var offset = 0; offset < UUID_SIZE; ++offset) {\n                    var byte = data[offset];\n                    if (offset === 4 || offset === 6 || offset === 8)\n                        result += \"-\";\n                    if (byte < 16)\n                        result += \"0\";\n                    result += byte.toString(16).toLowerCase();\n                }\n                return result;\n            }\n        }\n        // uses a heuristic used by v8 and chakra to force an object into dictionary mode.\n        function MakeDictionary(obj) {\n            obj.__ = undefined;\n            delete obj.__;\n            return obj;\n        }\n    });\n})(Reflect || (Reflect = {}));\n","export { safeKillFFmpeg, ffmpegLogInitialOutput, safePrintFFmpegArguments } from '../../server/src/media-helpers';\n","// RFC 6184 - RTP Payload Format for H.264 Video\n// pion/rtp\n\nimport { BitStream, getBit } from \"../../../common/src\";\nimport type { RtpHeader } from \"../rtp/rtp\";\nimport type { DePacketizerBase } from \"./base\";\n\n// FU indicator octet\n// +---------------+\n// |0|1|2|3|4|5|6|7|\n// +-+-+-+-+-+-+-+-+\n// |F|NRI|  Type   |\n// +---------------+\n\n// FU header\n// +---------------+\n// |0|1|2|3|4|5|6|7|\n// +-+-+-+-+-+-+-+-+\n// |S|E|R|  Type   |\n// +---------------+\n\n// NAL Unit Type     Content of NAL Unit              NRI (binary)\n// ----------------------------------------------------------------\n//  1              non-IDR coded slice                         10\n//  2              Coded slice data partition A                10\n//  3              Coded slice data partition B                01\n//  4              Coded slice data partition C                01\n\n// Payload Packet    Single NAL    Non-Interleaved    Interleaved\n// Type    Type      Unit Mode           Mode             Mode\n// -------------------------------------------------------------\n// 0      reserved      ig               ig               ig\n// 1-23   NAL unit     yes              yes               no\n// 24     STAP-A        no              yes               no\n// 25     STAP-B        no               no              yes\n// 26     MTAP16        no               no              yes\n// 27     MTAP24        no               no              yes\n// 28     FU-A          no              yes              yes\n// 29     FU-B          no               no              yes\n// 30-31  reserved      ig               ig               ig\n\nexport class H264RtpPayload implements DePacketizerBase {\n  /**forbidden_zero_bit */\n  f!: number;\n  /**nal_ref_idc */\n  nri!: number;\n  /**nal_unit_types */\n  nalUnitType!: number;\n  /**start of a fragmented NAL unit */\n  s!: number;\n  /**end of a fragmented NAL unit */\n  e!: number;\n  r!: number;\n  nalUnitPayloadType!: number;\n  payload!: Buffer;\n  fragment?: Buffer;\n\n  static deSerialize(buf: Buffer, fragment?: Buffer) {\n    const h264 = new H264RtpPayload();\n\n    let offset = 0;\n\n    const naluHeader = buf[offset];\n    h264.f = getBit(naluHeader, 0);\n    h264.nri = getBit(naluHeader, 1, 2);\n    h264.nalUnitType = getBit(naluHeader, 3, 5);\n    offset++;\n\n    h264.s = getBit(buf[offset], 0);\n    h264.e = getBit(buf[offset], 1);\n    h264.r = getBit(buf[offset], 2);\n    h264.nalUnitPayloadType = getBit(buf[offset], 3, 5);\n    offset++;\n\n    //  packetization-mode=0\n    // packetization-mode=0Single NAL Unit Packet\n    // https://datatracker.ietf.org/doc/html/rfc6184#section-6.2\n\n    // Single NAL Unit Packet\n    if (0 < h264.nalUnitType && h264.nalUnitType < NalUnitType.stap_a) {\n      h264.payload = this.packaging(buf);\n    }\n    // Single-time aggregation packet\n    else if (h264.nalUnitType === NalUnitType.stap_a) {\n      let offset = stap_aHeaderSize;\n      let result: Buffer = Buffer.alloc(0);\n      while (offset < buf.length) {\n        const naluSize = buf.readUInt16BE(offset);\n        offset += stap_aNALULengthSize;\n\n        result = Buffer.concat([\n          result,\n          this.packaging(buf.subarray(offset, offset + naluSize)),\n        ]);\n        offset += naluSize;\n      }\n      h264.payload = result;\n    }\n    // Fragmentation Units\n    else if (h264.nalUnitType === NalUnitType.fu_a) {\n      if (!fragment) {\n        fragment = Buffer.alloc(0);\n      }\n      const fu = buf.subarray(offset);\n      h264.fragment = Buffer.concat([fragment, fu]);\n\n      if (h264.e) {\n        const bitStream = new BitStream(Buffer.alloc(1))\n          .writeBits(1, 0)\n          .writeBits(2, h264.nri)\n          .writeBits(5, h264.nalUnitPayloadType);\n        const nalu = Buffer.concat([bitStream.uint8Array, h264.fragment]);\n        h264.fragment = undefined;\n        h264.payload = this.packaging(nalu);\n      }\n    }\n\n    return h264;\n  }\n\n  private static packaging(buf: Buffer) {\n    return Buffer.concat([annex_bNALUStartCode, buf]);\n  }\n\n  static isDetectedFinalPacketInSequence(header: RtpHeader) {\n    return header.marker;\n  }\n\n  get isKeyframe() {\n    return (\n      this.nalUnitType === NalUnitType.idrSlice ||\n      this.nalUnitPayloadType === NalUnitType.idrSlice\n    );\n  }\n\n  get isPartitionHead() {\n    if (\n      this.nalUnitType === NalUnitType.fu_a ||\n      this.nalUnitType === NalUnitType.fu_b\n    ) {\n      return this.s !== 0;\n    }\n\n    return true;\n  }\n}\n\nexport const NalUnitType = {\n  idrSlice: 5,\n  stap_a: 24,\n  stap_b: 25,\n  mtap16: 26,\n  mtap24: 27,\n  fu_a: 28,\n  fu_b: 29,\n} as const;\n\nconst annex_bNALUStartCode = Buffer.from([0x00, 0x00, 0x00, 0x01]);\n\nconst stap_aHeaderSize = 1;\nconst stap_aNALULengthSize = 2;\n","import { debug } from \"../../imports/common\";\nimport { RtcpHeader } from \"../header\";\nimport { FullIntraRequest } from \"./fullIntraRequest\";\nimport { PictureLossIndication } from \"./pictureLossIndication\";\nimport { ReceiverEstimatedMaxBitrate } from \"./remb\";\n\nconst log = debug(\"werift-rtp: /rtcp/psfb/index\");\n\ntype Feedback =\n  | FullIntraRequest\n  | PictureLossIndication\n  | ReceiverEstimatedMaxBitrate;\n\nexport class RtcpPayloadSpecificFeedback {\n  static readonly type = 206;\n  readonly type = RtcpPayloadSpecificFeedback.type;\n\n  feedback!: Feedback;\n\n  constructor(props: Partial<RtcpPayloadSpecificFeedback> = {}) {\n    Object.assign(this, props);\n  }\n\n  serialize() {\n    const payload = this.feedback.serialize();\n    return RtcpHeader.serialize(\n      this.type,\n      this.feedback.count,\n      payload,\n      this.feedback.length,\n    );\n  }\n\n  static deSerialize(data: Buffer, header: RtcpHeader) {\n    let feedback: Feedback | undefined;\n\n    switch (header.count) {\n      case FullIntraRequest.count:\n        feedback = FullIntraRequest.deSerialize(data);\n        break;\n      case PictureLossIndication.count:\n        feedback = PictureLossIndication.deSerialize(data);\n        break;\n      case ReceiverEstimatedMaxBitrate.count:\n        feedback = ReceiverEstimatedMaxBitrate.deSerialize(data);\n        break;\n      default:\n        log(\"unknown psfb packet\", header.count);\n        break;\n    }\n\n    return new RtcpPayloadSpecificFeedback({ feedback });\n  }\n}\n","import { isNextSequenceNumber, JitterBuffer, RtpPacket } from \"../../homekit/src/types/camera/jitter-buffer\";\n\n// H.265 NAL unit types\n// https://github.com/FFmpeg/FFmpeg/blob/master/libavcodec/hevc/hevc.h\nconst NAL_TYPE_TRAIL_N = 0;\nconst NAL_TYPE_TRAIL_R = 1;\nconst NAL_TYPE_TSA_N = 2;\nconst NAL_TYPE_TSA_R = 3;\nconst NAL_TYPE_STSA_N = 4;\nconst NAL_TYPE_STSA_R = 5;\nconst NAL_TYPE_RADL_N = 6;\nconst NAL_TYPE_RADL_R = 7;\nconst NAL_TYPE_RASL_N = 8;\nconst NAL_TYPE_RASL_R = 9;\nconst NAL_TYPE_VCL_N10 = 10;\nconst NAL_TYPE_VCL_R11 = 11;\nconst NAL_TYPE_VCL_N12 = 12;\nconst NAL_TYPE_VCL_R13 = 13;\nconst NAL_TYPE_VCL_N14 = 14;\nconst NAL_TYPE_VCL_R15 = 15;\nconst NAL_TYPE_BLA_W_LP = 16;\nconst NAL_TYPE_BLA_W_RADL = 17;\nconst NAL_TYPE_BLA_N_LP = 18;\nconst NAL_TYPE_IDR_W_RADL = 19;\nconst NAL_TYPE_IDR_N_LP = 20;\nconst NAL_TYPE_CRA_NUT = 21;\nconst NAL_TYPE_RSV_IRAP_VCL22 = 22;\nconst NAL_TYPE_RSV_IRAP_VCL23 = 23;\nconst NAL_TYPE_RSV_VCL24 = 24;\nconst NAL_TYPE_RSV_VCL25 = 25;\nconst NAL_TYPE_RSV_VCL26 = 26;\nconst NAL_TYPE_RSV_VCL27 = 27;\nconst NAL_TYPE_RSV_VCL28 = 28;\nconst NAL_TYPE_RSV_VCL29 = 29;\nconst NAL_TYPE_RSV_VCL30 = 30;\nconst NAL_TYPE_RSV_VCL31 = 31;\nconst NAL_TYPE_VPS = 32;\nconst NAL_TYPE_SPS = 33;\nconst NAL_TYPE_PPS = 34;\nconst NAL_TYPE_AUD = 35;\nconst NAL_TYPE_EOS_NUT = 36;\nconst NAL_TYPE_EOB_NUT = 37;\nconst NAL_TYPE_FD_NUT = 38;\nconst NAL_TYPE_SEI_PREFIX = 39;\nconst NAL_TYPE_SEI_SUFFIX = 40;\nconst NAL_TYPE_RSV_NVCL41 = 41;\nconst NAL_TYPE_RSV_NVCL42 = 42;\nconst NAL_TYPE_RSV_NVCL43 = 43;\nconst NAL_TYPE_RSV_NVCL44 = 44;\nconst NAL_TYPE_RSV_NVCL45 = 45;\nconst NAL_TYPE_RSV_NVCL46 = 46;\nconst NAL_TYPE_RSV_NVCL47 = 47;\n// RTP payload format for H.265 defines these special types\nconst NAL_TYPE_AP = 48;  // Aggregation Packet\nconst NAL_TYPE_FU = 49;  // Fragmentation Unit\nconst NAL_TYPE_UNSPEC50 = 50;\nconst NAL_TYPE_UNSPEC51 = 51;\nconst NAL_TYPE_UNSPEC52 = 52;\nconst NAL_TYPE_UNSPEC53 = 53;\nconst NAL_TYPE_UNSPEC54 = 54;\nconst NAL_TYPE_UNSPEC55 = 55;\nconst NAL_TYPE_UNSPEC56 = 56;\nconst NAL_TYPE_UNSPEC57 = 57;\nconst NAL_TYPE_UNSPEC58 = 58;\nconst NAL_TYPE_UNSPEC59 = 59;\nconst NAL_TYPE_UNSPEC60 = 60;\nconst NAL_TYPE_UNSPEC61 = 61;\nconst NAL_TYPE_UNSPEC62 = 62;\nconst NAL_TYPE_UNSPEC63 = 63;\n\n\nconst NAL_HEADER_SIZE = 2;  // H265 has 2-byte NAL header\nconst FU_HEADER_SIZE = 3;   // 2-byte NAL header + 1-byte FU header\nconst LENGTH_FIELD_SIZE = 2;\nconst AP_HEADER_SIZE = NAL_HEADER_SIZE + LENGTH_FIELD_SIZE;\n\n// Function to extract NAL unit type from H.265 NAL header\nfunction getNalType(data: Buffer): number {\n    return (data[0] & 0x7E) >> 1;  // 6 bits starting from bit 1\n}\n\nfunction isKeyFrame(nalType: number): boolean {\n    // For IDR frames, send codec info first\n    if (nalType === NAL_TYPE_IDR_W_RADL || nalType === NAL_TYPE_IDR_N_LP ||\n        nalType === NAL_TYPE_BLA_W_LP || nalType === NAL_TYPE_BLA_W_RADL ||\n        nalType === NAL_TYPE_BLA_N_LP || nalType === NAL_TYPE_CRA_NUT) {\n     return true;\n    }\n    return false;\n}\n\n// Function to depacketize Aggregation Packets (similar to STAP-A in H.264)\nexport function depacketizeAP(data: Buffer) {\n    const ret: Buffer[] = [];\n    let lastPos: number;\n    let pos = NAL_HEADER_SIZE;\n    while (pos < data.length) {\n        if (lastPos !== undefined)\n            ret.push(data.subarray(lastPos, pos));\n        const naluSize = data.readUInt16BE(pos);\n        pos += LENGTH_FIELD_SIZE;\n        lastPos = pos;\n        pos += naluSize;\n    }\n    ret.push(data.subarray(lastPos));\n    return ret;\n}\n\nexport function splitH265NaluStartCode(data: Buffer) {\n    const ret: Buffer[] = [];\n    let previous = 0;\n    let offset = 0;\n    const maybeAddSlice = () => {\n        const slice = data.subarray(previous, offset);\n        if (slice.length)\n            ret.push(slice);\n        offset += 4;\n        previous = offset;\n    }\n\n    while (offset < data.length - 4) {\n        const startCode = data.readUInt32BE(offset);\n        if (startCode === 1) {\n            maybeAddSlice();\n        }\n        else {\n            offset++;\n        }\n    }\n    offset = data.length;\n    maybeAddSlice();\n\n    return ret;\n}\n\nexport interface H265CodecInfo {\n    vps: Buffer;\n    sps: Buffer;\n    pps: Buffer;\n    seiPrefix?: Buffer;\n    seiSuffix?: Buffer;\n}\n\nexport class H265Repacketizer {\n    extraPackets = 0;\n    fuMax: number;\n    pendingFU: RtpPacket[];\n    // the AP packet that will be sent before an IDR frame.\n    ap: RtpPacket;\n    fuMin: number;\n    // h265 can send multiple IDR and TRAIL_R frames per RTP timestamp.\n    // the repurposed h264-packetizer code sends codec information before every\n    // IDR frame.\n    // the IDR burst frames are interleaved with codec information which causes decode failure.\n    // The interleaved codec issues does not cause issues with Safari, but does cause\n    // Chrome to send repeated Picture Loss Indication (PLI) requests.\n    // the fix is to send the codec information before the first IDR frame,\n    // then wait for the marker bit, which denotes the last packet for a given rtp\n    // timestamp, to reset the flag.\n    // expected result:\n    // AP codec info -> IDR frame 1 -> IDR frame 2 -> ... -> IDR frame N with marker bit set\n    sentMarker = true;\n\n    constructor(public console: Console, private maxPacketSize: number, public codecInfo?: H265CodecInfo, public jitterBuffer = new JitterBuffer(console, 4)) {\n        this.setMaxPacketSize(maxPacketSize);\n    }\n\n    setMaxPacketSize(maxPacketSize: number) {\n        this.maxPacketSize = maxPacketSize;\n        // 12 is the rtp/srtp header size.\n        this.fuMax = maxPacketSize - FU_HEADER_SIZE;\n        this.fuMin = Math.round(maxPacketSize * .8);\n    }\n\n    ensureCodecInfo() {\n        if (!this.codecInfo) {\n            this.codecInfo = {\n                vps: undefined,\n                sps: undefined,\n                pps: undefined,\n            };\n        }\n    }\n\n    updateVps(vps: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.vps = vps;\n    }\n\n    updateSps(sps: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.sps = sps;\n    }\n\n    updatePps(pps: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.pps = pps;\n    }\n\n    updateSeiPrefix(sei: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.seiPrefix = sei;\n    }\n\n    updateSeiSuffix(sei: Buffer) {\n        this.ensureCodecInfo();\n        this.codecInfo.seiSuffix = sei;\n    }\n\n    shouldFilter(nalType: number) {\n        // Currently nothing is filtered, but this could be customized\n        return false;\n    }\n\n    // Fragmentation Unit (FU) for H.265\n    // https://datatracker.ietf.org/doc/html/rfc7798#section-4.4.3\n    packetizeFU(data: Buffer, noStart?: boolean, noEnd?: boolean): Buffer[] {\n        // Handle both normal packets and FU packets.\n        const initialNalType = getNalType(data);\n\n        // Check if the data is already a fragmentation unit\n        if (initialNalType === NAL_TYPE_FU) {\n            // Extract original NAL header information\n            const originalNalType = data[2] & 0x3F;  // 6 bits\n            const isFuStart = !!(data[2] & 0x80);\n            const isFuEnd = !!(data[2] & 0x40);\n            const isFuMiddle = !isFuStart && !isFuEnd;\n\n            // Reconstruct the original NAL header\n            const layerId = ((data[0] & 0x01) << 5) | ((data[1] & 0xF8) >> 3);\n            const tid = data[1] & 0x07;\n\n            const originalNalHeader = Buffer.alloc(2);\n            originalNalHeader[0] = (originalNalType << 1) | (layerId >> 5);\n            originalNalHeader[1] = ((layerId & 0x1F) << 3) | tid;\n\n            data = Buffer.concat([originalNalHeader, data.subarray(FU_HEADER_SIZE)]);\n\n            if (isFuStart) {\n                noEnd = true;\n            }\n            else if (isFuEnd) {\n                noStart = true;\n            }\n            else if (isFuMiddle) {\n                noStart = true;\n                noEnd = true;\n            }\n        }\n\n        // Extract information from the NAL header\n        const nalType = getNalType(data);\n        const layerId = ((data[0] & 0x01) << 5) | ((data[1] & 0xF8) >> 3);\n        const tid = data[1] & 0x07;\n\n        // Construct the FU NAL header\n        const fuNalHeader = Buffer.alloc(2);\n        fuNalHeader[0] = (NAL_TYPE_FU << 1) | (layerId >> 5);\n        fuNalHeader[1] = ((layerId & 0x1F) << 3) | tid;\n\n        // Construct FU headers for different positions\n        const fuHeaderMiddle = Buffer.from([...fuNalHeader, nalType]);\n        const fuHeaderStart = noStart ? fuHeaderMiddle : Buffer.from([...fuNalHeader, nalType | 0x80]);\n        const fuHeaderEnd = noEnd ? fuHeaderMiddle : Buffer.from([...fuNalHeader, nalType | 0x40]);\n        let fuHeader = fuHeaderStart;\n\n        const packages: Buffer[] = [];\n        let offset = NAL_HEADER_SIZE;\n\n        while (offset < data.length) {\n            let payload: Buffer;\n            const packageSize = Math.min(this.fuMax, data.length - offset);\n            payload = data.subarray(offset, offset + packageSize);\n            offset += packageSize;\n\n            if (offset === data.length) {\n                fuHeader = fuHeaderEnd;\n            }\n\n            packages.push(Buffer.concat([fuHeader, payload]));\n\n            fuHeader = fuHeaderMiddle;\n        }\n\n        return packages;\n    }\n\n    // Aggregation Packet (AP) for H.265 (similar to STAP-A in H.264)\n    // https://datatracker.ietf.org/doc/html/rfc7798#section-4.4.2\n    packetizeOneAP(datas: Buffer[]): Buffer {\n        if (!datas.length)\n            throw new Error('packetizeOneAP requires at least one NAL');\n\n        let counter = 0;\n        let availableSize = this.maxPacketSize - AP_HEADER_SIZE;\n\n        // In H.265, AP uses a fixed header with NAL type 48\n        const apHeader = Buffer.alloc(2);\n        apHeader[0] = NAL_TYPE_AP << 1;  // Type 48, no layer ID in first byte\n        apHeader[1] = 0x01;  // Default temporal ID = 1, no layer ID\n\n        const payload: Buffer[] = [apHeader];\n\n        while (datas.length && datas[0].length + LENGTH_FIELD_SIZE <= availableSize && counter < 9) {\n            const nalu = datas.shift();\n            availableSize -= LENGTH_FIELD_SIZE + nalu.length;\n            counter += 1;\n            const lengthField = Buffer.alloc(2);\n            lengthField.writeUInt16BE(nalu.length, 0);\n            payload.push(lengthField, nalu);\n        }\n\n        // If no NALUs fit, return the first one for FU packetization\n        if (counter === 0)\n            return datas.shift();\n\n        // A single NALU AP is unnecessary, return the NALU itself\n        if (counter === 1) {\n            return payload[2]; // Skip header and length field\n        }\n\n        return Buffer.concat(payload);\n    }\n\n    packetizeAP(datas: Buffer[]) {\n        const ret: Buffer[] = [];\n        while (datas.length) {\n            const nalu = this.packetizeOneAP(datas);\n            if (nalu.length < this.maxPacketSize) {\n                ret.push(nalu);\n                continue;\n            }\n            const fus = this.packetizeFU(nalu);\n            ret.push(...fus);\n        }\n        return ret;\n    }\n\n    createPacket(rtp: RtpPacket, data: Buffer, marker: boolean) {\n        const ret = rtp.clone();\n        ret.header.sequenceNumber = (rtp.header.sequenceNumber + this.extraPackets + 0x10000) % 0x10000;\n        ret.header.marker = marker;\n        ret.header.padding = false;\n        ret.payload = data;\n        if (data.length > this.maxPacketSize)\n            this.console.warn('packet exceeded max packet size. this may be a bug.');\n        this.sentMarker = ret.header.marker;\n        return ret;\n    }\n\n    flushPendingFU(ret: RtpPacket[]) {\n        if (!this.pendingFU)\n            return;\n\n        // Defragmenting assumes packets are sorted by sequence number,\n        // and are all available, which is guaranteed over rtsp/tcp, but not over rtp/udp.\n        const first = this.pendingFU[0];\n        const last = this.pendingFU[this.pendingFU.length - 1];\n        const originalNalType = first.payload[2] & 0x3F;\n        const hasFuStart = !!(first.payload[2] & 0x80);\n        const hasFuEnd = !!(last.payload[2] & 0x40);\n\n        // Extract layerId and tid from FU header\n        const layerId = ((first.payload[0] & 0x01) << 5) | ((first.payload[1] & 0xF8) >> 3);\n        const tid = first.payload[1] & 0x07;\n\n        // Reconstruct original NAL header\n        const originalNalHeader = Buffer.alloc(2);\n        originalNalHeader[0] = (originalNalType << 1) | (layerId >> 5);\n        originalNalHeader[1] = ((layerId & 0x1F) << 3) | tid;\n\n        const getDefragmentedPendingFu = () => {\n            const originalFragments = this.pendingFU.map(packet => packet.payload.subarray(FU_HEADER_SIZE));\n            originalFragments.unshift(originalNalHeader);\n            return Buffer.concat(originalFragments);\n        }\n\n        // Handle special case for VPS/SPS/PPS in FU (not standard but seen in some implementations)\n        if (originalNalType === NAL_TYPE_VPS || originalNalType === NAL_TYPE_SPS) {\n            const defragmented = getDefragmentedPendingFu();\n            const splits = splitH265NaluStartCode(defragmented);\n\n            while (splits.length) {\n                const split = splits.shift();\n                const splitNaluType = getNalType(split);\n\n                if (splitNaluType === NAL_TYPE_VPS) {\n                    this.updateVps(split);\n                }\n                else if (splitNaluType === NAL_TYPE_SPS) {\n                    this.updateSps(split);\n                }\n                else if (splitNaluType === NAL_TYPE_PPS) {\n                    this.updatePps(split);\n                }\n                else {\n                    // For IDR frames, send codec info first\n                    if (isKeyFrame(splitNaluType)) {\n                        this.maybeSendAPCodecInfo(first, ret);\n                    }\n\n                    this.fragment(first, ret, {\n                        payload: split,\n                        noStart: !hasFuStart,\n                        noEnd: !hasFuEnd,\n                        marker: last.header.marker,\n                    });\n                }\n            }\n        }\n        else {\n            // Process regular fragmentation units\n            while (this.pendingFU.length) {\n                const fu = this.pendingFU[0];\n                if (fu.payload.length > this.maxPacketSize || fu.payload.length < this.fuMin)\n                    break;\n                this.pendingFU.shift();\n                ret.push(this.createPacket(fu, fu.payload, fu.header.marker));\n            }\n\n            if (!this.pendingFU.length) {\n                this.pendingFU = undefined;\n                return;\n            }\n\n            // Re-fragment remaining FU packets\n            const first = this.pendingFU[0];\n            const last = this.pendingFU[this.pendingFU.length - 1];\n            const hasFuStart = !!(first.payload[2] & 0x80);\n            const hasFuEnd = !!(last.payload[2] & 0x40);\n\n            const defragmented = getDefragmentedPendingFu();\n\n            this.fragment(first, ret, {\n                payload: defragmented,\n                noStart: !hasFuStart,\n                noEnd: !hasFuEnd,\n                marker: last.header.marker\n            });\n        }\n\n        this.extraPackets -= this.pendingFU.length - 1;\n        this.pendingFU = undefined;\n    }\n\n    createRtpPackets(packet: RtpPacket, nalus: Buffer[], ret: RtpPacket[], hadMarker = packet.header.marker) {\n        nalus.forEach((packetized, index) => {\n            if (index !== 0)\n                this.extraPackets++;\n            const marker = hadMarker && index === nalus.length - 1;\n            ret.push(this.createPacket(packet, packetized, marker));\n        });\n    }\n\n    maybeSendAPCodecInfo(packet: RtpPacket, ret: RtpPacket[]) {\n        if (this.ap) {\n            // AP with codec information was sent recently, no need to send codec info.\n            this.ap = undefined;\n            return;\n        }\n\n        // can not send codec info if in the middle of sending packets for a specific rtp timestamp.\n        if (!this.sentMarker)\n            return;\n\n        // vps is not required.\n        if (!this.codecInfo?.sps || !this.codecInfo?.pps)\n            return;\n\n        const agg = [this.codecInfo.sps, this.codecInfo.pps];\n        if (this.codecInfo.vps)\n            agg.unshift(this.codecInfo.vps);\n        if (this.codecInfo?.seiPrefix)\n            agg.push(this.codecInfo.seiPrefix);\n        if (this.codecInfo?.seiSuffix)\n            agg.push(this.codecInfo.seiSuffix);\n\n        const aggregates = this.packetizeAP(agg);\n        if (aggregates.length !== 1) {\n            this.console.error('expected only 1 packet for vps/sps/pps AP');\n            return;\n        }\n        // This AP only contains codec info (and no frame data), thus the marker bit should not be set.\n        this.createRtpPackets(packet, aggregates, ret, false);\n        this.extraPackets++;\n    }\n\n    // Fragment payload into multiple packets as needed\n    fragment(packet: RtpPacket, ret: RtpPacket[], fuOptions: {\n        payload: Buffer;\n        noStart: boolean;\n        noEnd: boolean;\n        marker: boolean;\n    } = {\n            payload: packet.payload,\n            noStart: false,\n            noEnd: false,\n            marker: packet.header.marker\n        }) {\n        const { payload, noStart, noEnd, marker } = fuOptions;\n        if (payload.length > this.maxPacketSize || noStart || noEnd) {\n            const fragments = this.packetizeFU(payload, noStart, noEnd);\n            this.createRtpPackets(packet, fragments, ret, marker);\n        }\n        else {\n            // Can send this packet as is\n            ret.push(this.createPacket(packet, payload, marker));\n        }\n    }\n\n    repacketize<T extends RtpPacket>(packet: T): T[] {\n        const ret: T[] = [];\n        for (const dejittered of this.jitterBuffer.queue(packet)) {\n            this.repacketizeOne(dejittered, ret);\n        }\n        return ret;\n    }\n\n    repacketizeOne(packet: RtpPacket, ret: RtpPacket[]) {\n        // Filter empty packets\n        if (!packet.payload.length) {\n            this.flushPendingFU(ret);\n            this.extraPackets--;\n            return;\n        }\n\n        const nalType = getNalType(packet.payload);\n\n        // Fragmented packets must share a timestamp\n        if (this.pendingFU && this.pendingFU[0].header.timestamp !== packet.header.timestamp) {\n            this.flushPendingFU(ret);\n        }\n\n        if (nalType === NAL_TYPE_FU) {\n            // Handle Fragmentation Units\n            const data = packet.payload;\n            const originalNalType = data[2] & 0x3F;\n\n            if (this.shouldFilter(originalNalType)) {\n                this.extraPackets--;\n                return;\n            }\n\n            const isFuStart = !!(data[2] & 0x80);\n            const isFuEnd = !!(data[2] & 0x40);\n\n            if (isFuStart) {\n                if (this.pendingFU)\n                    this.console.error('FU restarted. skipping refragmentation of previous FU.', originalNalType);\n\n                this.pendingFU = undefined;\n\n                // If this is an IDR frame, but no codec info has been sent via an AP, send it\n                if (originalNalType === NAL_TYPE_IDR_W_RADL || originalNalType === NAL_TYPE_IDR_N_LP) {\n                    this.maybeSendAPCodecInfo(packet, ret);\n                }\n            }\n            else {\n                if (this.pendingFU) {\n                    // Check if packets were missing from the previously queued FU packets\n                    const last = this.pendingFU[this.pendingFU.length - 1];\n                    if (!isNextSequenceNumber(last.header.sequenceNumber, packet.header.sequenceNumber)) {\n                        this.console.error('FU packet missing. skipping refragmentation.', originalNalType);\n                        return;\n                    }\n                }\n            }\n\n            if (!this.pendingFU)\n                this.pendingFU = [];\n\n            this.pendingFU.push(packet);\n\n            if (isFuEnd) {\n                this.flushPendingFU(ret);\n            }\n            else if (this.pendingFU.reduce((p, c) => p + c.payload.length - FU_HEADER_SIZE, NAL_HEADER_SIZE) > this.maxPacketSize) {\n                // Refragment FU packets as they are received\n                const last = this.pendingFU[this.pendingFU.length - 1].clone();\n                const partial: RtpPacket[] = [];\n                this.flushPendingFU(partial);\n                // Retain a FU packet to validate subsequent FU packets\n                const retain = partial.pop();\n                last.payload = retain.payload;\n                this.pendingFU = [last];\n                ret.push(...partial);\n                this.sentMarker = false;\n            }\n        }\n        else if (nalType === NAL_TYPE_AP) {\n            this.flushPendingFU(ret);\n\n            let hasVps = false;\n            let hasSps = false;\n            let hasPps = false;\n\n            // Process Aggregation Packets\n            const depacketized = depacketizeAP(packet.payload);\n            depacketized.forEach(payload => {\n                const nalType = getNalType(payload);\n                if (nalType === NAL_TYPE_VPS) {\n                    hasVps = true;\n                    this.updateVps(payload);\n                }\n                else if (nalType === NAL_TYPE_SPS) {\n                    hasSps = true;\n                    this.updateSps(payload);\n                }\n                else if (nalType === NAL_TYPE_PPS) {\n                    hasPps = true;\n                    this.updatePps(payload);\n                }\n                else if (nalType === NAL_TYPE_SEI_PREFIX) {\n                    this.updateSeiPrefix(payload);\n                }\n                else if (nalType === NAL_TYPE_SEI_SUFFIX) {\n                    this.updateSeiSuffix(payload);\n                }\n                else if (nalType === NAL_TYPE_AUD) {\n                    // Access Unit Delimiter - typically a no-op\n                }\n                else if (nalType >= NAL_TYPE_TRAIL_N && nalType <= NAL_TYPE_RASL_R) {\n                    // Various slice types - typically VCL NAL units\n                }\n                else if (nalType === NAL_TYPE_IDR_W_RADL) {\n                    // IDR\n                }\n                else if (nalType === 0) {\n                    // NAL delimiter or something. usually empty.\n                }\n                else {\n                    this.console.warn('Skipped an AP type.', nalType);\n                }\n            });\n\n            // Log that an AP with codec info was sent\n            if (hasVps && hasSps && hasPps && packet.payload.length <= this.maxPacketSize) {\n                this.ap = packet;\n\n                const ap = this.packetizeAP(depacketized);\n                this.createRtpPackets(packet, ap, ret);\n            }\n            else {\n                // h265 can send multiple IDR or TRAIL_R per rtp timestamp\n                // so this can result in a large aggregation packet\n                // if the MTU is large (like 64k on localhost udp).\n                // the aggregation packet must be depacketized and potentially\n                // fragmented.\n                const fus: Buffer[] = [];\n                while (depacketized.length) {\n                    const next = depacketized.shift();\n                    if (next.length <= this.maxPacketSize) {\n                        fus.push(next);\n                        continue;\n                    }\n                    fus.push(...this.packetizeFU(next));\n                }\n                this.createRtpPackets(packet, fus, ret);\n            }\n        }\n        else if (nalType <= NAL_TYPE_RSV_IRAP_VCL23 || (nalType >= NAL_TYPE_VPS && nalType <= NAL_TYPE_SEI_SUFFIX)) {\n            this.flushPendingFU(ret);\n\n            if (this.shouldFilter(nalType)) {\n                this.extraPackets--;\n                return;\n            }\n\n            // Handle codec information\n            if (nalType === NAL_TYPE_VPS) {\n                this.extraPackets--;\n                this.updateVps(packet.payload);\n                return;\n            }\n            else if (nalType === NAL_TYPE_SPS) {\n                this.extraPackets--;\n                this.updateSps(packet.payload);\n                return;\n            }\n            else if (nalType === NAL_TYPE_PPS) {\n                this.extraPackets--;\n                this.updatePps(packet.payload);\n                return;\n            }\n            else if (nalType === NAL_TYPE_SEI_PREFIX) {\n                this.extraPackets--;\n                this.updateSeiPrefix(packet.payload);\n                return;\n            }\n            else if (nalType === NAL_TYPE_SEI_SUFFIX) {\n                this.extraPackets--;\n                this.updateSeiSuffix(packet.payload);\n                return;\n            }\n\n            if (this.shouldFilter(nalType)) {\n                this.extraPackets--;\n                return;\n            }\n\n            // For IDR frames, send codec info first\n            if (isKeyFrame(nalType)) {\n                this.maybeSendAPCodecInfo(packet, ret);\n            }\n\n            this.fragment(packet, ret);\n        }\n        else {\n            this.console.error('unknown NAL unit type ' + nalType);\n            this.extraPackets--;\n        }\n\n        return;\n    }\n}","import { randomUUID } from \"crypto\";\nimport { Event } from \"../imports/common\";\n\nimport type { RTCDtlsTransport } from \"..\";\nimport { SenderDirections } from \"../const\";\nimport type { Kind } from \"../types/domain\";\nimport type {\n  RTCRtpCodecParameters,\n  RTCRtpHeaderExtensionParameters,\n} from \"./parameters\";\nimport type { RTCRtpReceiver } from \"./rtpReceiver\";\nimport type { RTCRtpSender } from \"./rtpSender\";\nimport {\n  type RTCCodecStats,\n  type RTCStats,\n  generateStatsId,\n  getStatsTimestamp,\n} from \"./stats\";\nimport type { MediaStream, MediaStreamTrack } from \"./track\";\n\nexport class RTCRtpTransceiver {\n  readonly id = randomUUID().toString();\n  readonly onTrack = new Event<[MediaStreamTrack, RTCRtpTransceiver]>();\n  mid?: string;\n  mLineIndex?: number;\n  /**should not be reused because it has been used for sending before. */\n  usedForSender = false;\n  private _currentDirection?: MediaDirection;\n  offerDirection!: MediaDirection;\n  _codecs: RTCRtpCodecParameters[] = [];\n  set codecs(codecs: RTCRtpCodecParameters[]) {\n    this._codecs = codecs;\n  }\n  get codecs() {\n    return this._codecs;\n  }\n  headerExtensions: RTCRtpHeaderExtensionParameters[] = [];\n  options: Partial<TransceiverOptions> = {};\n  stopping = false;\n  stopped = false;\n\n  constructor(\n    public readonly kind: Kind,\n    dtlsTransport: RTCDtlsTransport | undefined,\n    public receiver: RTCRtpReceiver,\n    public sender: RTCRtpSender,\n    /**RFC 8829 4.2.4.  direction the transceiver was initialized with */\n    private _direction: MediaDirection,\n  ) {\n    if (dtlsTransport) {\n      this.setDtlsTransport(dtlsTransport);\n    }\n  }\n\n  get dtlsTransport() {\n    return this.receiver.dtlsTransport;\n  }\n\n  /**RFC 8829 4.2.4. setDirection */\n  get direction() {\n    return this._direction;\n  }\n\n  setDirection(direction: MediaDirection) {\n    this._direction = direction;\n    if (SenderDirections.includes(this._currentDirection ?? \"\")) {\n      this.usedForSender = true;\n    }\n  }\n\n  /**RFC 8829 4.2.5. last negotiated direction */\n  get currentDirection(): MediaDirection | undefined {\n    return this._currentDirection;\n  }\n\n  setCurrentDirection(direction: MediaDirection | undefined) {\n    this._currentDirection = direction;\n  }\n\n  setDtlsTransport(dtls: RTCDtlsTransport) {\n    this.receiver.setDtlsTransport(dtls);\n    this.sender.setDtlsTransport(dtls);\n  }\n\n  get msid() {\n    return `${this.sender.streamId} ${this.sender.trackId}`;\n  }\n\n  addTrack(track: MediaStreamTrack) {\n    const res = this.receiver.addTrack(track);\n    if (res) {\n      this.onTrack.execute(track, this);\n    }\n  }\n\n  // todo impl\n  // https://www.w3.org/TR/webrtc/#methods-8\n  stop() {\n    if (this.stopping) {\n      return;\n    }\n\n    // todo Stop sending and receiving with transceiver.\n\n    this.stopping = true;\n  }\n\n  getPayloadType(mimeType: string) {\n    return this.codecs.find((codec) =>\n      codec.mimeType.toLowerCase().includes(mimeType.toLowerCase()),\n    )?.payloadType;\n  }\n\n  getCodecStats(): RTCStats[] {\n    const timestamp = getStatsTimestamp();\n    const stats: RTCStats[] = [];\n\n    if (!this.dtlsTransport) {\n      return stats;\n    }\n\n    const transportId = generateStatsId(\"transport\", this.dtlsTransport.id);\n\n    // Add codec stats for each codec\n    for (const codec of this.codecs) {\n      const codecStats: RTCCodecStats = {\n        type: \"codec\",\n        id: generateStatsId(\"codec\", codec.payloadType, transportId),\n        timestamp,\n        payloadType: codec.payloadType,\n        transportId,\n        mimeType: codec.mimeType,\n        clockRate: codec.clockRate,\n        channels: codec.channels,\n        sdpFmtpLine: codec.parameters,\n      };\n      stats.push(codecStats);\n    }\n\n    return stats;\n  }\n}\n\nexport const Inactive = \"inactive\";\nexport const Sendonly = \"sendonly\";\nexport const Recvonly = \"recvonly\";\nexport const Sendrecv = \"sendrecv\";\n\nexport const Directions = [Inactive, Sendonly, Recvonly, Sendrecv] as const;\n\nexport type MediaDirection = (typeof Directions)[number];\n\ntype SimulcastDirection = \"send\" | \"recv\";\n\nexport interface TransceiverOptions {\n  direction: MediaDirection;\n  simulcast: { direction: SimulcastDirection; rid: string }[];\n  streams: MediaStream[];\n}\n","export class PromiseQueue {\n  queue: {\n    promise: () => Promise<unknown>;\n    done: (...args: any[]) => void;\n    failed: (...args: any[]) => void;\n  }[] = [];\n  running = false;\n\n  push = <T>(promise: () => Promise<T>) =>\n    new Promise<T>((r, f) => {\n      this.queue.push({ promise, done: r, failed: f });\n      if (!this.running) {\n        this.run();\n      }\n    });\n\n  private async run() {\n    const task = this.queue.shift();\n    if (task) {\n      this.running = true;\n\n      try {\n        const res = await task.promise();\n        task.done(res);\n      } catch (error) {\n        task.failed(error);\n      }\n\n      this.run();\n    } else {\n      this.running = false;\n    }\n  }\n\n  cancel() {\n    this.queue = [];\n  }\n}\n","import { randomUUID } from \"crypto\";\nimport { Event, debug } from \"../imports/common\";\n\nimport {\n  Candidate,\n  Connection,\n  type IceConnection,\n  type IceOptions,\n} from \"../../../ice/src\";\nimport {\n  type RTCIceCandidatePairStats,\n  type RTCIceCandidateStats,\n  type RTCStats,\n  generateStatsId,\n  getStatsTimestamp,\n} from \"../media/stats\";\nimport { candidateFromSdp, candidateToSdp } from \"../sdp\";\n\nconst log = debug(\"werift:packages/webrtc/src/transport/ice.ts\");\n\n/**\n *                                          +------------+\n                                            |            |\n                                            |disconnected|\n                                            |            |\n                                            +------------+\n                                            ^           ^\n                                            |           |\n+------+      +----------+      +-----------+      +----------+\n|      |      |          |      |           |      |          |\n| new  | ---> | checking | ---> | connected | ---> | completed|\n|      |      |          |      |           |      |          |\n+------+      +----+-----+      +-----------+      +----------+\n                    |           \n                    |           \n                    v           \n                +-------+       \n                |       |      \n                | failed|      \n                |       |      \n                +-------+      \n */\n\nexport class RTCIceTransport {\n  readonly id = randomUUID().toString();\n  connection: IceConnection;\n  state: RTCIceConnectionState = \"new\";\n  private waitStart?: Event<[]>;\n  private renominating = false;\n\n  readonly onStateChange = new Event<[RTCIceConnectionState]>();\n  readonly onIceCandidate = new Event<[IceCandidate | undefined]>();\n  readonly onNegotiationNeeded = new Event<[]>();\n\n  constructor(private iceGather: RTCIceGatherer) {\n    this.connection = this.iceGather.connection;\n    this.connection.stateChanged.subscribe((state) => {\n      this.setState(state);\n    });\n    this.iceGather.onIceCandidate = (candidate) => {\n      this.onIceCandidate.execute(candidate);\n    };\n  }\n\n  get role() {\n    if (this.connection.iceControlling) return \"controlling\";\n    else return \"controlled\";\n  }\n\n  get gatheringState() {\n    return this.iceGather.gatheringState;\n  }\n\n  get localCandidates() {\n    return this.iceGather.localCandidates;\n  }\n\n  get localParameters() {\n    return this.iceGather.localParameters;\n  }\n\n  private setState(state: RTCIceConnectionState) {\n    if (state !== this.state) {\n      this.state = state;\n\n      this.onStateChange.execute(state);\n    }\n  }\n\n  gather() {\n    return this.iceGather.gather();\n  }\n\n  addRemoteCandidate = (candidate?: IceCandidate) => {\n    if (!this.connection.remoteCandidatesEnd) {\n      if (!candidate) {\n        return this.connection.addRemoteCandidate(undefined);\n      } else {\n        return this.connection.addRemoteCandidate(candidateToIce(candidate));\n      }\n    }\n  };\n\n  setRemoteParams(remoteParameters: RTCIceParameters, renomination = false) {\n    if (renomination) {\n      this.renominating = true;\n    }\n    if (\n      this.connection.remoteUsername &&\n      this.connection.remotePassword &&\n      (this.connection.remoteUsername !== remoteParameters.usernameFragment ||\n        this.connection.remotePassword !== remoteParameters.password)\n    ) {\n      if (this.renominating) {\n        log(\"renomination\", remoteParameters);\n        this.connection.resetNominatedPair();\n        this.renominating = false;\n      } else {\n        log(\"restart\", remoteParameters);\n        this.restart();\n      }\n    }\n    this.connection.setRemoteParams(remoteParameters);\n  }\n\n  restart() {\n    this.connection.restart();\n    this.setState(\"new\");\n    this.iceGather.gatheringState = \"new\";\n    this.waitStart = undefined;\n    this.onNegotiationNeeded.execute();\n  }\n\n  async start() {\n    if (this.state === \"closed\") {\n      throw new Error(\"RTCIceTransport is closed\");\n    }\n    if (!this.connection.remotePassword || !this.connection.remoteUsername) {\n      throw new Error(\"remoteParams missing\");\n    }\n\n    if (this.waitStart) {\n      await this.waitStart.asPromise();\n    }\n    this.waitStart = new Event();\n\n    this.setState(\"checking\");\n\n    try {\n      await this.connection.connect();\n    } catch (error) {\n      this.setState(\"failed\");\n      throw error;\n    }\n\n    this.waitStart.execute();\n    this.waitStart.complete();\n    this.waitStart = undefined;\n  }\n\n  async stop() {\n    if (this.state !== \"closed\") {\n      this.setState(\"closed\");\n      await this.connection.close();\n    }\n    this.onStateChange.complete();\n    this.onIceCandidate.complete();\n    this.onNegotiationNeeded.complete();\n  }\n\n  async getStats(): Promise<RTCStats[]> {\n    const timestamp = getStatsTimestamp();\n    const stats: RTCStats[] = [];\n\n    // Local candidates\n    for (const candidate of this.localCandidates) {\n      const candidateStats: RTCIceCandidateStats = {\n        type: \"local-candidate\",\n        id: generateStatsId(\"local-candidate\", candidate.foundation),\n        timestamp,\n        transportId: generateStatsId(\"transport\", this.id),\n        address: candidate.ip,\n        port: candidate.port,\n        protocol: candidate.protocol,\n        candidateType: candidate.type as any,\n        priority: candidate.priority,\n        foundation: candidate.foundation,\n      };\n      stats.push(candidateStats);\n    }\n\n    // Remote candidates\n    for (const candidate of this.connection.remoteCandidates) {\n      const ice = candidateFromIce(candidate);\n      const candidateStats: RTCIceCandidateStats = {\n        type: \"remote-candidate\",\n        id: generateStatsId(\"remote-candidate\", ice.foundation),\n        timestamp,\n        transportId: generateStatsId(\"transport\", this.id),\n        address: ice.ip,\n        port: ice.port,\n        protocol: ice.protocol,\n        candidateType: ice.type as any,\n        priority: ice.priority,\n        foundation: ice.foundation,\n      };\n      stats.push(candidateStats);\n    }\n\n    // Candidate pairs\n    const pairs = this.connection?.candidatePairs\n      ? [\n          ...this.connection.candidatePairs.filter((p) => p.nominated),\n          ...this.connection.candidatePairs.filter((p) => !p.nominated),\n        ]\n      : [];\n    for (const pair of pairs) {\n      const pairStats: RTCIceCandidatePairStats = {\n        type: \"candidate-pair\",\n        id: generateStatsId(\"candidate-pair\", pair.foundation),\n        timestamp,\n        transportId: generateStatsId(\"transport\", this.id),\n        localCandidateId: generateStatsId(\n          \"local-candidate\",\n          pair.localCandidate.foundation,\n        ),\n        remoteCandidateId: generateStatsId(\n          \"remote-candidate\",\n          pair.remoteCandidate.foundation,\n        ),\n        state: pair.state as any,\n        nominated: pair.nominated,\n        packetsSent: pair.packetsSent,\n        packetsReceived: pair.packetsReceived,\n        bytesSent: pair.bytesSent,\n        bytesReceived: pair.bytesReceived,\n        currentRoundTripTime: pair.rtt,\n      };\n      stats.push(pairStats);\n    }\n\n    return stats;\n  }\n}\n\nexport const IceTransportStates = [\n  \"new\",\n  \"checking\",\n  \"connected\",\n  \"completed\",\n  \"disconnected\",\n  \"failed\",\n  \"closed\",\n] as const;\nexport type RTCIceConnectionState = (typeof IceTransportStates)[number];\n\nexport const IceGathererStates = [\"new\", \"gathering\", \"complete\"] as const;\nexport type IceGathererState = (typeof IceGathererStates)[number];\n\nexport class RTCIceGatherer {\n  onIceCandidate: (candidate: IceCandidate | undefined) => void = () => {};\n  gatheringState: IceGathererState = \"new\";\n  readonly connection: IceConnection;\n\n  readonly onGatheringStateChange = new Event<[IceGathererState]>();\n\n  constructor(private options: Partial<IceOptions> = {}) {\n    this.connection = new Connection(false, this.options);\n    this.connection.onIceCandidate.subscribe((candidate) => {\n      this.onIceCandidate(candidateFromIce(candidate));\n    });\n  }\n\n  async gather() {\n    if (this.gatheringState === \"new\") {\n      this.setState(\"gathering\");\n      await this.connection.gatherCandidates();\n      this.onIceCandidate(undefined);\n      this.setState(\"complete\");\n    }\n  }\n\n  get localCandidates() {\n    return this.connection.localCandidates.map(candidateFromIce);\n  }\n\n  get localParameters() {\n    const params = new RTCIceParameters({\n      usernameFragment: this.connection.localUsername,\n      password: this.connection.localPassword,\n    });\n\n    return params;\n  }\n\n  private setState(state: IceGathererState) {\n    if (state !== this.gatheringState) {\n      this.gatheringState = state;\n      this.onGatheringStateChange.execute(state);\n    }\n  }\n}\n\nexport function candidateFromIce(c: Candidate) {\n  const candidate = new IceCandidate(\n    c.component,\n    c.foundation,\n    c.host,\n    c.port,\n    c.priority,\n    c.transport,\n    c.type,\n    c.generation,\n    c.ufrag,\n  );\n  candidate.relatedAddress = c.relatedAddress;\n  candidate.relatedPort = c.relatedPort;\n  candidate.tcpType = c.tcptype;\n  return candidate;\n}\n\nexport function candidateToIce(x: IceCandidate) {\n  return new Candidate(\n    x.foundation,\n    x.component,\n    x.protocol,\n    x.priority,\n    x.ip,\n    x.port,\n    x.type,\n    x.relatedAddress,\n    x.relatedPort,\n    x.tcpType,\n    x.generation,\n    x.ufrag,\n  );\n}\n\nexport interface RTCIceCandidateInit {\n  candidate?: string;\n  sdpMLineIndex?: number | null;\n  sdpMid?: string | null;\n  usernameFragment?: string | null;\n}\n\nexport class RTCIceCandidate {\n  candidate!: string;\n  sdpMid?: string;\n  sdpMLineIndex?: number;\n  usernameFragment?: string;\n\n  constructor(props: Partial<RTCIceCandidate>) {\n    Object.assign(this, props);\n  }\n\n  static fromSdp(sdp: string): RTCIceCandidate {\n    const ice = Candidate.fromSdp(sdp);\n    const candidate = candidateFromIce(ice);\n    return candidate.toJSON();\n  }\n\n  static isThis(o: any) {\n    if (typeof o?.candidate === \"string\") return true;\n  }\n\n  toJSON() {\n    return {\n      candidate: this.candidate,\n      sdpMid: this.sdpMid,\n      sdpMLineIndex: this.sdpMLineIndex,\n      usernameFragment: this.usernameFragment,\n    };\n  }\n}\n\nexport class IceCandidate {\n  // \"\"\"\n  // The :class:`RTCIceCandidate` interface represents a candidate Interactive\n  // Connectivity Establishment (ICE) configuration which may be used to\n  // establish an RTCPeerConnection.\n  // \"\"\"\n  public relatedAddress?: string;\n  public relatedPort?: number;\n  public sdpMid?: string;\n  public sdpMLineIndex?: number;\n  public tcpType?: string;\n\n  constructor(\n    public component: number,\n    public foundation: string,\n    public ip: string,\n    public port: number,\n    public priority: number,\n    public protocol: string,\n    public type: string,\n    public generation?: number,\n    public ufrag?: string,\n  ) {}\n\n  toJSON(): RTCIceCandidate {\n    return new RTCIceCandidate({\n      candidate: candidateToSdp(this),\n      sdpMLineIndex: this.sdpMLineIndex,\n      sdpMid: this.sdpMid,\n      usernameFragment: this.ufrag,\n    });\n  }\n\n  static fromJSON(data: RTCIceCandidate | RTCIceCandidateInit) {\n    try {\n      if (!data.candidate) {\n        throw new Error(\"candidate is required\");\n      }\n      const candidate = candidateFromSdp(data.candidate);\n      candidate.sdpMLineIndex = data.sdpMLineIndex ?? undefined;\n      candidate.sdpMid = data.sdpMid ?? undefined;\n      return candidate;\n    } catch (error) {}\n  }\n}\n\nexport class RTCIceParameters {\n  iceLite = false;\n  usernameFragment!: string;\n  password!: string;\n\n  constructor(props: Partial<RTCIceParameters> = {}) {\n    Object.assign(this, props);\n  }\n}\n","\"use strict\";\n/**\n * Hex, bytes and number utilities.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.notImplemented = exports.bitMask = void 0;\nexports.isBytes = isBytes;\nexports.abytes = abytes;\nexports.abool = abool;\nexports.bytesToHex = bytesToHex;\nexports.numberToHexUnpadded = numberToHexUnpadded;\nexports.hexToNumber = hexToNumber;\nexports.hexToBytes = hexToBytes;\nexports.bytesToNumberBE = bytesToNumberBE;\nexports.bytesToNumberLE = bytesToNumberLE;\nexports.numberToBytesBE = numberToBytesBE;\nexports.numberToBytesLE = numberToBytesLE;\nexports.numberToVarBytesBE = numberToVarBytesBE;\nexports.ensureBytes = ensureBytes;\nexports.concatBytes = concatBytes;\nexports.equalBytes = equalBytes;\nexports.utf8ToBytes = utf8ToBytes;\nexports.inRange = inRange;\nexports.aInRange = aInRange;\nexports.bitLen = bitLen;\nexports.bitGet = bitGet;\nexports.bitSet = bitSet;\nexports.createHmacDrbg = createHmacDrbg;\nexports.validateObject = validateObject;\nexports.memoized = memoized;\n// 100 lines of code in the file are duplicated from noble-hashes (utils).\n// This is OK: `abstract` directory does not use noble-hashes.\n// User may opt-in into using different hashing library. This way, noble-hashes\n// won't be included into their bundle.\nconst _0n = /* @__PURE__ */ BigInt(0);\nconst _1n = /* @__PURE__ */ BigInt(1);\nconst _2n = /* @__PURE__ */ BigInt(2);\nfunction isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\nfunction abytes(item) {\n    if (!isBytes(item))\n        throw new Error('Uint8Array expected');\n}\nfunction abool(title, value) {\n    if (typeof value !== 'boolean')\n        throw new Error(title + ' boolean expected, got ' + value);\n}\n// Array where index 0xf0 (240) is mapped to string 'f0'\nconst hexes = /* @__PURE__ */ Array.from({ length: 256 }, (_, i) => i.toString(16).padStart(2, '0'));\n/**\n * @example bytesToHex(Uint8Array.from([0xca, 0xfe, 0x01, 0x23])) // 'cafe0123'\n */\nfunction bytesToHex(bytes) {\n    abytes(bytes);\n    // pre-caching improves the speed 6x\n    let hex = '';\n    for (let i = 0; i < bytes.length; i++) {\n        hex += hexes[bytes[i]];\n    }\n    return hex;\n}\nfunction numberToHexUnpadded(num) {\n    const hex = num.toString(16);\n    return hex.length & 1 ? '0' + hex : hex;\n}\nfunction hexToNumber(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    return hex === '' ? _0n : BigInt('0x' + hex); // Big Endian\n}\n// We use optimized technique to convert hex string to byte array\nconst asciis = { _0: 48, _9: 57, A: 65, F: 70, a: 97, f: 102 };\nfunction asciiToBase16(ch) {\n    if (ch >= asciis._0 && ch <= asciis._9)\n        return ch - asciis._0; // '2' => 50-48\n    if (ch >= asciis.A && ch <= asciis.F)\n        return ch - (asciis.A - 10); // 'B' => 66-(65-10)\n    if (ch >= asciis.a && ch <= asciis.f)\n        return ch - (asciis.a - 10); // 'b' => 98-(97-10)\n    return;\n}\n/**\n * @example hexToBytes('cafe0123') // Uint8Array.from([0xca, 0xfe, 0x01, 0x23])\n */\nfunction hexToBytes(hex) {\n    if (typeof hex !== 'string')\n        throw new Error('hex string expected, got ' + typeof hex);\n    const hl = hex.length;\n    const al = hl / 2;\n    if (hl % 2)\n        throw new Error('hex string expected, got unpadded hex of length ' + hl);\n    const array = new Uint8Array(al);\n    for (let ai = 0, hi = 0; ai < al; ai++, hi += 2) {\n        const n1 = asciiToBase16(hex.charCodeAt(hi));\n        const n2 = asciiToBase16(hex.charCodeAt(hi + 1));\n        if (n1 === undefined || n2 === undefined) {\n            const char = hex[hi] + hex[hi + 1];\n            throw new Error('hex string expected, got non-hex character \"' + char + '\" at index ' + hi);\n        }\n        array[ai] = n1 * 16 + n2; // multiply first octet, e.g. 'a3' => 10*16+3 => 160 + 3 => 163\n    }\n    return array;\n}\n// BE: Big Endian, LE: Little Endian\nfunction bytesToNumberBE(bytes) {\n    return hexToNumber(bytesToHex(bytes));\n}\nfunction bytesToNumberLE(bytes) {\n    abytes(bytes);\n    return hexToNumber(bytesToHex(Uint8Array.from(bytes).reverse()));\n}\nfunction numberToBytesBE(n, len) {\n    return hexToBytes(n.toString(16).padStart(len * 2, '0'));\n}\nfunction numberToBytesLE(n, len) {\n    return numberToBytesBE(n, len).reverse();\n}\n// Unpadded, rarely used\nfunction numberToVarBytesBE(n) {\n    return hexToBytes(numberToHexUnpadded(n));\n}\n/**\n * Takes hex string or Uint8Array, converts to Uint8Array.\n * Validates output length.\n * Will throw error for other types.\n * @param title descriptive title for an error e.g. 'private key'\n * @param hex hex string or Uint8Array\n * @param expectedLength optional, will compare to result array's length\n * @returns\n */\nfunction ensureBytes(title, hex, expectedLength) {\n    let res;\n    if (typeof hex === 'string') {\n        try {\n            res = hexToBytes(hex);\n        }\n        catch (e) {\n            throw new Error(title + ' must be hex string or Uint8Array, cause: ' + e);\n        }\n    }\n    else if (isBytes(hex)) {\n        // Uint8Array.from() instead of hash.slice() because node.js Buffer\n        // is instance of Uint8Array, and its slice() creates **mutable** copy\n        res = Uint8Array.from(hex);\n    }\n    else {\n        throw new Error(title + ' must be hex string or Uint8Array');\n    }\n    const len = res.length;\n    if (typeof expectedLength === 'number' && len !== expectedLength)\n        throw new Error(title + ' of length ' + expectedLength + ' expected, got ' + len);\n    return res;\n}\n/**\n * Copies several Uint8Arrays into one.\n */\nfunction concatBytes(...arrays) {\n    let sum = 0;\n    for (let i = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        abytes(a);\n        sum += a.length;\n    }\n    const res = new Uint8Array(sum);\n    for (let i = 0, pad = 0; i < arrays.length; i++) {\n        const a = arrays[i];\n        res.set(a, pad);\n        pad += a.length;\n    }\n    return res;\n}\n// Compares 2 u8a-s in kinda constant time\nfunction equalBytes(a, b) {\n    if (a.length !== b.length)\n        return false;\n    let diff = 0;\n    for (let i = 0; i < a.length; i++)\n        diff |= a[i] ^ b[i];\n    return diff === 0;\n}\n/**\n * @example utf8ToBytes('abc') // new Uint8Array([97, 98, 99])\n */\nfunction utf8ToBytes(str) {\n    if (typeof str !== 'string')\n        throw new Error('string expected');\n    return new Uint8Array(new TextEncoder().encode(str)); // https://bugzil.la/1681809\n}\n// Is positive bigint\nconst isPosBig = (n) => typeof n === 'bigint' && _0n <= n;\nfunction inRange(n, min, max) {\n    return isPosBig(n) && isPosBig(min) && isPosBig(max) && min <= n && n < max;\n}\n/**\n * Asserts min <= n < max. NOTE: It's < max and not <= max.\n * @example\n * aInRange('x', x, 1n, 256n); // would assume x is in (1n..255n)\n */\nfunction aInRange(title, n, min, max) {\n    // Why min <= n < max and not a (min < n < max) OR b (min <= n <= max)?\n    // consider P=256n, min=0n, max=P\n    // - a for min=0 would require -1:          `inRange('x', x, -1n, P)`\n    // - b would commonly require subtraction:  `inRange('x', x, 0n, P - 1n)`\n    // - our way is the cleanest:               `inRange('x', x, 0n, P)\n    if (!inRange(n, min, max))\n        throw new Error('expected valid ' + title + ': ' + min + ' <= n < ' + max + ', got ' + n);\n}\n// Bit operations\n/**\n * Calculates amount of bits in a bigint.\n * Same as `n.toString(2).length`\n */\nfunction bitLen(n) {\n    let len;\n    for (len = 0; n > _0n; n >>= _1n, len += 1)\n        ;\n    return len;\n}\n/**\n * Gets single bit at position.\n * NOTE: first bit position is 0 (same as arrays)\n * Same as `!!+Array.from(n.toString(2)).reverse()[pos]`\n */\nfunction bitGet(n, pos) {\n    return (n >> BigInt(pos)) & _1n;\n}\n/**\n * Sets single bit at position.\n */\nfunction bitSet(n, pos, value) {\n    return n | ((value ? _1n : _0n) << BigInt(pos));\n}\n/**\n * Calculate mask for N bits. Not using ** operator with bigints because of old engines.\n * Same as BigInt(`0b${Array(i).fill('1').join('')}`)\n */\nconst bitMask = (n) => (_2n << BigInt(n - 1)) - _1n;\nexports.bitMask = bitMask;\n// DRBG\nconst u8n = (data) => new Uint8Array(data); // creates Uint8Array\nconst u8fr = (arr) => Uint8Array.from(arr); // another shortcut\n/**\n * Minimal HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n * @returns function that will call DRBG until 2nd arg returns something meaningful\n * @example\n *   const drbg = createHmacDRBG<Key>(32, 32, hmac);\n *   drbg(seed, bytesToKey); // bytesToKey must return Key or undefined\n */\nfunction createHmacDrbg(hashLen, qByteLen, hmacFn) {\n    if (typeof hashLen !== 'number' || hashLen < 2)\n        throw new Error('hashLen must be a number');\n    if (typeof qByteLen !== 'number' || qByteLen < 2)\n        throw new Error('qByteLen must be a number');\n    if (typeof hmacFn !== 'function')\n        throw new Error('hmacFn must be a function');\n    // Step B, Step C: set hashLen to 8*ceil(hlen/8)\n    let v = u8n(hashLen); // Minimal non-full-spec HMAC-DRBG from NIST 800-90 for RFC6979 sigs.\n    let k = u8n(hashLen); // Steps B and C of RFC6979 3.2: set hashLen, in our case always same\n    let i = 0; // Iterations counter, will throw when over 1000\n    const reset = () => {\n        v.fill(1);\n        k.fill(0);\n        i = 0;\n    };\n    const h = (...b) => hmacFn(k, v, ...b); // hmac(k)(v, ...values)\n    const reseed = (seed = u8n()) => {\n        // HMAC-DRBG reseed() function. Steps D-G\n        k = h(u8fr([0x00]), seed); // k = hmac(k || v || 0x00 || seed)\n        v = h(); // v = hmac(k || v)\n        if (seed.length === 0)\n            return;\n        k = h(u8fr([0x01]), seed); // k = hmac(k || v || 0x01 || seed)\n        v = h(); // v = hmac(k || v)\n    };\n    const gen = () => {\n        // HMAC-DRBG generate() function\n        if (i++ >= 1000)\n            throw new Error('drbg: tried 1000 values');\n        let len = 0;\n        const out = [];\n        while (len < qByteLen) {\n            v = h();\n            const sl = v.slice();\n            out.push(sl);\n            len += v.length;\n        }\n        return concatBytes(...out);\n    };\n    const genUntil = (seed, pred) => {\n        reset();\n        reseed(seed); // Steps D-G\n        let res = undefined; // Step H: grind until k is in [1..n-1]\n        while (!(res = pred(gen())))\n            reseed();\n        reset();\n        return res;\n    };\n    return genUntil;\n}\n// Validating curves and fields\nconst validatorFns = {\n    bigint: (val) => typeof val === 'bigint',\n    function: (val) => typeof val === 'function',\n    boolean: (val) => typeof val === 'boolean',\n    string: (val) => typeof val === 'string',\n    stringOrUint8Array: (val) => typeof val === 'string' || isBytes(val),\n    isSafeInteger: (val) => Number.isSafeInteger(val),\n    array: (val) => Array.isArray(val),\n    field: (val, object) => object.Fp.isValid(val),\n    hash: (val) => typeof val === 'function' && Number.isSafeInteger(val.outputLen),\n};\n// type Record<K extends string | number | symbol, T> = { [P in K]: T; }\nfunction validateObject(object, validators, optValidators = {}) {\n    const checkField = (fieldName, type, isOptional) => {\n        const checkVal = validatorFns[type];\n        if (typeof checkVal !== 'function')\n            throw new Error('invalid validator function');\n        const val = object[fieldName];\n        if (isOptional && val === undefined)\n            return;\n        if (!checkVal(val, object)) {\n            throw new Error('param ' + String(fieldName) + ' is invalid. Expected ' + type + ', got ' + val);\n        }\n    };\n    for (const [fieldName, type] of Object.entries(validators))\n        checkField(fieldName, type, false);\n    for (const [fieldName, type] of Object.entries(optValidators))\n        checkField(fieldName, type, true);\n    return object;\n}\n// validate type tests\n// const o: { a: number; b: number; c: number } = { a: 1, b: 5, c: 6 };\n// const z0 = validateObject(o, { a: 'isSafeInteger' }, { c: 'bigint' }); // Ok!\n// // Should fail type-check\n// const z1 = validateObject(o, { a: 'tmp' }, { c: 'zz' });\n// const z2 = validateObject(o, { a: 'isSafeInteger' }, { c: 'zz' });\n// const z3 = validateObject(o, { test: 'boolean', z: 'bug' });\n// const z4 = validateObject(o, { a: 'boolean', z: 'bug' });\n/**\n * throws not implemented error\n */\nconst notImplemented = () => {\n    throw new Error('not implemented');\n};\nexports.notImplemented = notImplemented;\n/**\n * Memoizes (caches) computation result.\n * Uses WeakMap: the value is going auto-cleaned by GC after last reference is removed.\n */\nfunction memoized(fn) {\n    const map = new WeakMap();\n    return (arg, ...args) => {\n        const val = map.get(arg);\n        if (val !== undefined)\n            return val;\n        const computed = fn(arg, ...args);\n        map.set(arg, computed);\n        return computed;\n    };\n}\n//# sourceMappingURL=utils.js.map","'use strict';\n\nconst symbols = require('internal/symbols');\nconst { decodeCommon } = require('lib/decode');\nconst Metadata = require('internal/meta');\n\nmodule.exports = select;\n\n/**\n * Type for multiple conditions.\n * Works almost like `switch` operator.\n * @param {...any} whenTypes The `when` type.\n * @returns {Object}\n */\nfunction select(...whenTypes) {\n  if (whenTypes.length === 0) {\n    throw new TypeError('You should set at least one condition type.');\n  }\n\n  const result = {\n    decode,\n    encode: () => {},\n    [symbols.skip]: true,\n  };\n\n  return result;\n\n  /* eslint-disable consistent-return */\n  /**\n   * Decode data using a first success contifion.\n   * @param {DecodeStream} rstream\n   * @returns {any}\n   */\n  function decode(rstream) {\n    decode.bytes = 0;\n    const context = Metadata.clone(this); // eslint-disable-line no-invalid-this\n\n    for (const when of whenTypes) {\n      // eslint-disable-next-line no-invalid-this\n      const probalyValue = decodeCommon(rstream, when, context);\n\n      if (when[symbols.skip] === true) {\n        continue; // eslint-disable-line no-continue\n      }\n\n      decode.bytes = context.bytes;\n      Metadata.clean(context);\n\n      result[symbols.skip] = false;\n      return probalyValue;\n    }\n\n    result[symbols.skip] = true;\n  }\n  /* eslint-enable consistent-return */\n}\n","const ip = exports;\nconst { Buffer } = require('buffer');\nconst os = require('os');\n\nip.toBuffer = function (ip, buff, offset) {\n  offset = ~~offset;\n\n  let result;\n\n  if (this.isV4Format(ip)) {\n    result = buff || Buffer.alloc(offset + 4);\n    ip.split(/\\./g).map((byte) => {\n      result[offset++] = parseInt(byte, 10) & 0xff;\n    });\n  } else if (this.isV6Format(ip)) {\n    const sections = ip.split(':', 8);\n\n    let i;\n    for (i = 0; i < sections.length; i++) {\n      const isv4 = this.isV4Format(sections[i]);\n      let v4Buffer;\n\n      if (isv4) {\n        v4Buffer = this.toBuffer(sections[i]);\n        sections[i] = v4Buffer.slice(0, 2).toString('hex');\n      }\n\n      if (v4Buffer && ++i < 8) {\n        sections.splice(i, 0, v4Buffer.slice(2, 4).toString('hex'));\n      }\n    }\n\n    if (sections[0] === '') {\n      while (sections.length < 8) sections.unshift('0');\n    } else if (sections[sections.length - 1] === '') {\n      while (sections.length < 8) sections.push('0');\n    } else if (sections.length < 8) {\n      for (i = 0; i < sections.length && sections[i] !== ''; i++);\n      const argv = [i, 1];\n      for (i = 9 - sections.length; i > 0; i--) {\n        argv.push('0');\n      }\n      sections.splice(...argv);\n    }\n\n    result = buff || Buffer.alloc(offset + 16);\n    for (i = 0; i < sections.length; i++) {\n      const word = parseInt(sections[i], 16);\n      result[offset++] = (word >> 8) & 0xff;\n      result[offset++] = word & 0xff;\n    }\n  }\n\n  if (!result) {\n    throw Error(`Invalid ip address: ${ip}`);\n  }\n\n  return result;\n};\n\nip.toString = function (buff, offset, length) {\n  offset = ~~offset;\n  length = length || (buff.length - offset);\n\n  let result = [];\n  if (length === 4) {\n    // IPv4\n    for (let i = 0; i < length; i++) {\n      result.push(buff[offset + i]);\n    }\n    result = result.join('.');\n  } else if (length === 16) {\n    // IPv6\n    for (let i = 0; i < length; i += 2) {\n      result.push(buff.readUInt16BE(offset + i).toString(16));\n    }\n    result = result.join(':');\n    result = result.replace(/(^|:)0(:0)*:0(:|$)/, '$1::$3');\n    result = result.replace(/:{3,4}/, '::');\n  }\n\n  return result;\n};\n\nconst ipv4Regex = /^(\\d{1,3}\\.){3,3}\\d{1,3}$/;\nconst ipv6Regex = /^(::)?(((\\d{1,3}\\.){3}(\\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;\n\nip.isV4Format = function (ip) {\n  return ipv4Regex.test(ip);\n};\n\nip.isV6Format = function (ip) {\n  return ipv6Regex.test(ip);\n};\n\nfunction _normalizeFamily(family) {\n  if (family === 4) {\n    return 'ipv4';\n  }\n  if (family === 6) {\n    return 'ipv6';\n  }\n  return family ? family.toLowerCase() : 'ipv4';\n}\n\nip.fromPrefixLen = function (prefixlen, family) {\n  if (prefixlen > 32) {\n    family = 'ipv6';\n  } else {\n    family = _normalizeFamily(family);\n  }\n\n  let len = 4;\n  if (family === 'ipv6') {\n    len = 16;\n  }\n  const buff = Buffer.alloc(len);\n\n  for (let i = 0, n = buff.length; i < n; ++i) {\n    let bits = 8;\n    if (prefixlen < 8) {\n      bits = prefixlen;\n    }\n    prefixlen -= bits;\n\n    buff[i] = ~(0xff >> bits) & 0xff;\n  }\n\n  return ip.toString(buff);\n};\n\nip.mask = function (addr, mask) {\n  addr = ip.toBuffer(addr);\n  mask = ip.toBuffer(mask);\n\n  const result = Buffer.alloc(Math.max(addr.length, mask.length));\n\n  // Same protocol - do bitwise and\n  let i;\n  if (addr.length === mask.length) {\n    for (i = 0; i < addr.length; i++) {\n      result[i] = addr[i] & mask[i];\n    }\n  } else if (mask.length === 4) {\n    // IPv6 address and IPv4 mask\n    // (Mask low bits)\n    for (i = 0; i < mask.length; i++) {\n      result[i] = addr[addr.length - 4 + i] & mask[i];\n    }\n  } else {\n    // IPv6 mask and IPv4 addr\n    for (i = 0; i < result.length - 6; i++) {\n      result[i] = 0;\n    }\n\n    // ::ffff:ipv4\n    result[10] = 0xff;\n    result[11] = 0xff;\n    for (i = 0; i < addr.length; i++) {\n      result[i + 12] = addr[i] & mask[i + 12];\n    }\n    i += 12;\n  }\n  for (; i < result.length; i++) {\n    result[i] = 0;\n  }\n\n  return ip.toString(result);\n};\n\nip.cidr = function (cidrString) {\n  const cidrParts = cidrString.split('/');\n\n  const addr = cidrParts[0];\n  if (cidrParts.length !== 2) {\n    throw new Error(`invalid CIDR subnet: ${addr}`);\n  }\n\n  const mask = ip.fromPrefixLen(parseInt(cidrParts[1], 10));\n\n  return ip.mask(addr, mask);\n};\n\nip.subnet = function (addr, mask) {\n  const networkAddress = ip.toLong(ip.mask(addr, mask));\n\n  // Calculate the mask's length.\n  const maskBuffer = ip.toBuffer(mask);\n  let maskLength = 0;\n\n  for (let i = 0; i < maskBuffer.length; i++) {\n    if (maskBuffer[i] === 0xff) {\n      maskLength += 8;\n    } else {\n      let octet = maskBuffer[i] & 0xff;\n      while (octet) {\n        octet = (octet << 1) & 0xff;\n        maskLength++;\n      }\n    }\n  }\n\n  const numberOfAddresses = 2 ** (32 - maskLength);\n\n  return {\n    networkAddress: ip.fromLong(networkAddress),\n    firstAddress: numberOfAddresses <= 2\n      ? ip.fromLong(networkAddress)\n      : ip.fromLong(networkAddress + 1),\n    lastAddress: numberOfAddresses <= 2\n      ? ip.fromLong(networkAddress + numberOfAddresses - 1)\n      : ip.fromLong(networkAddress + numberOfAddresses - 2),\n    broadcastAddress: ip.fromLong(networkAddress + numberOfAddresses - 1),\n    subnetMask: mask,\n    subnetMaskLength: maskLength,\n    numHosts: numberOfAddresses <= 2\n      ? numberOfAddresses : numberOfAddresses - 2,\n    length: numberOfAddresses,\n    contains(other) {\n      return networkAddress === ip.toLong(ip.mask(other, mask));\n    },\n  };\n};\n\nip.cidrSubnet = function (cidrString) {\n  const cidrParts = cidrString.split('/');\n\n  const addr = cidrParts[0];\n  if (cidrParts.length !== 2) {\n    throw new Error(`invalid CIDR subnet: ${addr}`);\n  }\n\n  const mask = ip.fromPrefixLen(parseInt(cidrParts[1], 10));\n\n  return ip.subnet(addr, mask);\n};\n\nip.not = function (addr) {\n  const buff = ip.toBuffer(addr);\n  for (let i = 0; i < buff.length; i++) {\n    buff[i] = 0xff ^ buff[i];\n  }\n  return ip.toString(buff);\n};\n\nip.or = function (a, b) {\n  a = ip.toBuffer(a);\n  b = ip.toBuffer(b);\n\n  // same protocol\n  if (a.length === b.length) {\n    for (let i = 0; i < a.length; ++i) {\n      a[i] |= b[i];\n    }\n    return ip.toString(a);\n\n  // mixed protocols\n  }\n  let buff = a;\n  let other = b;\n  if (b.length > a.length) {\n    buff = b;\n    other = a;\n  }\n\n  const offset = buff.length - other.length;\n  for (let i = offset; i < buff.length; ++i) {\n    buff[i] |= other[i - offset];\n  }\n\n  return ip.toString(buff);\n};\n\nip.isEqual = function (a, b) {\n  a = ip.toBuffer(a);\n  b = ip.toBuffer(b);\n\n  // Same protocol\n  if (a.length === b.length) {\n    for (let i = 0; i < a.length; i++) {\n      if (a[i] !== b[i]) return false;\n    }\n    return true;\n  }\n\n  // Swap\n  if (b.length === 4) {\n    const t = b;\n    b = a;\n    a = t;\n  }\n\n  // a - IPv4, b - IPv6\n  for (let i = 0; i < 10; i++) {\n    if (b[i] !== 0) return false;\n  }\n\n  const word = b.readUInt16BE(10);\n  if (word !== 0 && word !== 0xffff) return false;\n\n  for (let i = 0; i < 4; i++) {\n    if (a[i] !== b[i + 12]) return false;\n  }\n\n  return true;\n};\n\nip.isPrivate = function (addr) {\n  // check loopback addresses first\n  if (ip.isLoopback(addr)) {\n    return true;\n  }\n\n  // ensure the ipv4 address is valid\n  if (!ip.isV6Format(addr)) {\n    const ipl = ip.normalizeToLong(addr);\n    if (ipl < 0) {\n      throw new Error('invalid ipv4 address');\n    }\n    // normalize the address for the private range checks that follow\n    addr = ip.fromLong(ipl);\n  }\n\n  // check private ranges\n  return /^(::f{4}:)?10\\.([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})$/i.test(addr)\n    || /^(::f{4}:)?192\\.168\\.([0-9]{1,3})\\.([0-9]{1,3})$/i.test(addr)\n    || /^(::f{4}:)?172\\.(1[6-9]|2\\d|30|31)\\.([0-9]{1,3})\\.([0-9]{1,3})$/i\n      .test(addr)\n    || /^(::f{4}:)?169\\.254\\.([0-9]{1,3})\\.([0-9]{1,3})$/i.test(addr)\n    || /^f[cd][0-9a-f]{2}:/i.test(addr)\n    || /^fe80:/i.test(addr)\n    || /^::1$/.test(addr)\n    || /^::$/.test(addr);\n};\n\nip.isPublic = function (addr) {\n  return !ip.isPrivate(addr);\n};\n\nip.isLoopback = function (addr) {\n  // If addr is an IPv4 address in long integer form (no dots and no colons), convert it\n  if (!/\\./.test(addr) && !/:/.test(addr)) {\n    addr = ip.fromLong(Number(addr));\n  }\n\n  return /^(::f{4}:)?127\\.([0-9]{1,3})\\.([0-9]{1,3})\\.([0-9]{1,3})/\n    .test(addr)\n    || /^0177\\./.test(addr)\n    || /^0x7f\\./i.test(addr)\n    || /^fe80::1$/i.test(addr)\n    || /^::1$/.test(addr)\n    || /^::$/.test(addr);\n};\n\nip.loopback = function (family) {\n  //\n  // Default to `ipv4`\n  //\n  family = _normalizeFamily(family);\n\n  if (family !== 'ipv4' && family !== 'ipv6') {\n    throw new Error('family must be ipv4 or ipv6');\n  }\n\n  return family === 'ipv4' ? '127.0.0.1' : 'fe80::1';\n};\n\n//\n// ### function address (name, family)\n// #### @name {string|'public'|'private'} **Optional** Name or security\n//      of the network interface.\n// #### @family {ipv4|ipv6} **Optional** IP family of the address (defaults\n//      to ipv4).\n//\n// Returns the address for the network interface on the current system with\n// the specified `name`:\n//   * String: First `family` address of the interface.\n//             If not found see `undefined`.\n//   * 'public': the first public ip address of family.\n//   * 'private': the first private ip address of family.\n//   * undefined: First address with `ipv4` or loopback address `127.0.0.1`.\n//\nip.address = function (name, family) {\n  const interfaces = os.networkInterfaces();\n\n  //\n  // Default to `ipv4`\n  //\n  family = _normalizeFamily(family);\n\n  //\n  // If a specific network interface has been named,\n  // return the address.\n  //\n  if (name && name !== 'private' && name !== 'public') {\n    const res = interfaces[name].filter((details) => {\n      const itemFamily = _normalizeFamily(details.family);\n      return itemFamily === family;\n    });\n    if (res.length === 0) {\n      return undefined;\n    }\n    return res[0].address;\n  }\n\n  const all = Object.keys(interfaces).map((nic) => {\n    //\n    // Note: name will only be `public` or `private`\n    // when this is called.\n    //\n    const addresses = interfaces[nic].filter((details) => {\n      details.family = _normalizeFamily(details.family);\n      if (details.family !== family || ip.isLoopback(details.address)) {\n        return false;\n      } if (!name) {\n        return true;\n      }\n\n      return name === 'public' ? ip.isPrivate(details.address)\n        : ip.isPublic(details.address);\n    });\n\n    return addresses.length ? addresses[0].address : undefined;\n  }).filter(Boolean);\n\n  return !all.length ? ip.loopback(family) : all[0];\n};\n\nip.toLong = function (ip) {\n  let ipl = 0;\n  ip.split('.').forEach((octet) => {\n    ipl <<= 8;\n    ipl += parseInt(octet);\n  });\n  return (ipl >>> 0);\n};\n\nip.fromLong = function (ipl) {\n  return (`${ipl >>> 24}.${\n    ipl >> 16 & 255}.${\n    ipl >> 8 & 255}.${\n    ipl & 255}`);\n};\n\nip.normalizeToLong = function (addr) {\n  const parts = addr.split('.').map(part => {\n    // Handle hexadecimal format\n    if (part.startsWith('0x') || part.startsWith('0X')) {\n      return parseInt(part, 16);\n    }\n    // Handle octal format (strictly digits 0-7 after a leading zero)\n    else if (part.startsWith('0') && part !== '0' && /^[0-7]+$/.test(part)) {\n      return parseInt(part, 8);\n    }\n    // Handle decimal format, reject invalid leading zeros\n    else if (/^[1-9]\\d*$/.test(part) || part === '0') {\n      return parseInt(part, 10);\n    }\n    // Return NaN for invalid formats to indicate parsing failure\n    else {\n      return NaN;\n    }\n  });\n\n  if (parts.some(isNaN)) return -1; // Indicate error with -1\n\n  let val = 0;\n  const n = parts.length;\n\n  switch (n) {\n  case 1:\n    val = parts[0];\n    break;\n  case 2:\n    if (parts[0] > 0xff || parts[1] > 0xffffff) return -1;\n    val = (parts[0] << 24) | (parts[1] & 0xffffff);\n    break;\n  case 3:\n    if (parts[0] > 0xff || parts[1] > 0xff || parts[2] > 0xffff) return -1;\n    val = (parts[0] << 24) | (parts[1] << 16) | (parts[2] & 0xffff);\n    break;\n  case 4:\n    if (parts.some(part => part > 0xff)) return -1;\n    val = (parts[0] << 24) | (parts[1] << 16) | (parts[2] << 8) | parts[3];\n    break;\n  default:\n    return -1; // Error case\n  }\n\n  return val >>> 0;\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.encodeToCurve = exports.hashToCurve = exports.secp256r1 = exports.p256 = void 0;\n/**\n * NIST secp256r1 aka p256.\n * https://www.secg.org/sec2-v2.pdf, https://neuromancer.sk/std/nist/P-256\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nconst sha256_1 = require(\"@noble/hashes/sha256\");\nconst _shortw_utils_js_1 = require(\"./_shortw_utils.js\");\nconst hash_to_curve_js_1 = require(\"./abstract/hash-to-curve.js\");\nconst modular_js_1 = require(\"./abstract/modular.js\");\nconst weierstrass_js_1 = require(\"./abstract/weierstrass.js\");\nconst Fp256 = (0, modular_js_1.Field)(BigInt('0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff'));\nconst CURVE_A = Fp256.create(BigInt('-3'));\nconst CURVE_B = BigInt('0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b');\n/** secp256r1 curve, ECDSA and ECDH methods. */\n// prettier-ignore\nexports.p256 = (0, _shortw_utils_js_1.createCurve)({\n    a: CURVE_A, // Equation params: a, b\n    b: CURVE_B,\n    Fp: Fp256, // Field: 2n**224n * (2n**32n-1n) + 2n**192n + 2n**96n-1n\n    // Curve order, total count of valid points in the field\n    n: BigInt('0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551'),\n    // Base (generator) point (x, y)\n    Gx: BigInt('0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296'),\n    Gy: BigInt('0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5'),\n    h: BigInt(1),\n    lowS: false,\n}, sha256_1.sha256);\n/** Alias to p256. */\nexports.secp256r1 = exports.p256;\nconst mapSWU = /* @__PURE__ */ (() => (0, weierstrass_js_1.mapToCurveSimpleSWU)(Fp256, {\n    A: CURVE_A,\n    B: CURVE_B,\n    Z: Fp256.create(BigInt('-10')),\n}))();\nconst htf = /* @__PURE__ */ (() => (0, hash_to_curve_js_1.createHasher)(exports.secp256r1.ProjectivePoint, (scalars) => mapSWU(scalars[0]), {\n    DST: 'P256_XMD:SHA-256_SSWU_RO_',\n    encodeDST: 'P256_XMD:SHA-256_SSWU_NU_',\n    p: Fp256.ORDER,\n    m: 1,\n    k: 128,\n    expand: 'xmd',\n    hash: sha256_1.sha256,\n}))();\n/** secp256r1 hash-to-curve from [RFC 9380](https://www.rfc-editor.org/rfc/rfc9380). */\nexports.hashToCurve = (() => htf.hashToCurve)();\n/** secp256r1 encode-to-curve from [RFC 9380](https://www.rfc-editor.org/rfc/rfc9380). */\nexports.encodeToCurve = (() => htf.encodeToCurve)();\n//# sourceMappingURL=p256.js.map","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nexport class Alert {\n  static readonly spec = {\n    level: types.uint8,\n    description: types.uint8,\n  };\n\n  constructor(\n    public level: number,\n    public description: number,\n  ) {}\n\n  static deSerialize(buf: Buffer) {\n    return new Alert(\n      //@ts-ignore\n      ...Object.values(decode(buf, Alert.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, Alert.spec).slice();\n    return Buffer.from(res);\n  }\n}\n","export function enumerate<T>(arr: T[]): [number, T][] {\n  return arr.map((v, i) => [i, v]);\n}\n\nexport function divide(from: string, split: string): [string, string] {\n  const arr = from.split(split);\n  return [arr[0], arr.slice(1).join(split)];\n}\n\nexport const dumpBuffer = (data: Buffer) =>\n  \"0x\" +\n  data\n    .toString(\"hex\")\n    .replace(/(.)(.)/g, \"$1$2 \")\n    .split(\" \")\n    .filter((s) => s != undefined && s.length > 0)\n    .join(\",0x\");\n\nexport const getObjectSummary = (obj: any) =>\n  Object.entries({ ...obj }).reduce((acc: any, [key, value]) => {\n    if (typeof value === \"number\" || typeof value === \"string\") {\n      acc[key] = value;\n    }\n    if (Buffer.isBuffer(value)) {\n      acc[key] = dumpBuffer(value);\n    }\n    return acc;\n  }, {});\n","/**\n   [10 Nov 1995 11:33:25.125 UTC]       [10 Nov 1995 11:33:36.5 UTC]\n   n                 SR(n)              A=b710:8000 (46864.500 s)\n   ---------------------------------------------------------------->\n                      v                 ^\n   ntp_sec =0xb44db705 v               ^ dlsr=0x0005:4000 (    5.250s)\n   ntp_frac=0x20000000  v             ^  lsr =0xb705:2000 (46853.125s)\n     (3024992005.125 s)  v           ^\n   r                      v         ^ RR(n)\n   ---------------------------------------------------------------->\n                          |<-DLSR->|\n                           (5.250 s)\n        \n   A     0xb710:8000 (46864.500 s)\n   DLSR -0x0005:4000 (    5.250 s)\n   LSR  -0xb705:2000 (46853.125 s)\n   -------------------------------\n   delay 0x0006:2000 (    6.125 s)\n        \nFigure 2: Example for round-trip time computation\n */\n\nimport { randomBytes } from \"crypto\";\nimport { jspack } from \"@shinyoshiaki/jspack\";\n\nimport { randomUUID } from \"crypto\";\nimport { setTimeout } from \"timers/promises\";\nimport { Event, random16, uint16Add, uint32Add } from \"../imports/common\";\n\nimport { codecParametersFromString } from \"..\";\nimport {\n  type Extension,\n  GenericNack,\n  PictureLossIndication,\n  RTP_EXTENSION_URI,\n  ReceiverEstimatedMaxBitrate,\n  RedEncoder,\n  type RtcpPacket,\n  RtcpPayloadSpecificFeedback,\n  RtcpRrPacket,\n  RtcpSenderInfo,\n  RtcpSourceDescriptionPacket,\n  RtcpSrPacket,\n  RtcpTransportLayerFeedback,\n  type RtpHeader,\n  RtpPacket,\n  SourceDescriptionChunk,\n  SourceDescriptionItem,\n  TransportWideCC,\n  debug,\n  serializeAbsSendTime,\n  serializeRepairedRtpStreamId,\n  serializeSdesMid,\n  serializeSdesRTPStreamID,\n  serializeTransportWideCC,\n  wrapRtx,\n} from \"../imports/rtp\";\nimport type { RTCDtlsTransport } from \"../transport/dtls\";\nimport type { Kind } from \"../types/domain\";\nimport { compactNtp, milliTime, ntpTime, timestampSeconds } from \"../utils\";\nimport type {\n  RTCRtpCodecParameters,\n  RTCRtpHeaderExtensionParameters,\n  RTCRtpSendParameters,\n} from \"./parameters\";\nimport { SenderBandwidthEstimator, type SentInfo } from \"./sender/senderBWE\";\nimport {\n  type RTCMediaSourceStats,\n  type RTCOutboundRtpStreamStats,\n  type RTCRemoteInboundRtpStreamStats,\n  type RTCStats,\n  generateStatsId,\n  getStatsTimestamp,\n} from \"./stats\";\nimport type { MediaStreamTrack } from \"./track\";\n\nconst log = debug(\"werift:packages/webrtc/src/media/rtpSender.ts\");\n\nconst RTP_HISTORY_SIZE = 128;\nconst RTT_ALPHA = 0.85;\n\nexport class RTCRtpSender {\n  readonly type = \"sender\";\n  readonly kind: Kind;\n  readonly ssrc = jspack.Unpack(\"!L\", randomBytes(4))[0];\n  readonly rtxSsrc = jspack.Unpack(\"!L\", randomBytes(4))[0];\n  streamId = randomUUID().toString();\n  readonly trackId = randomUUID().toString();\n  readonly onReady = new Event();\n  readonly onRtcp = new Event<[RtcpPacket]>();\n  readonly onPictureLossIndication = new Event<[]>();\n  readonly onGenericNack = new Event<[GenericNack]>();\n  readonly senderBWE = new SenderBandwidthEstimator();\n\n  private cname?: string;\n  private mid?: string;\n  private rtpStreamId?: string;\n  private repairedRtpStreamId?: string;\n  private rtxPayloadType?: number;\n  private rtxSequenceNumber = random16();\n  redRedundantPayloadType?: number;\n  private _redDistance = 2;\n  redEncoder = new RedEncoder(this._redDistance);\n  private headerExtensions: RTCRtpHeaderExtensionParameters[] = [];\n  private disposeTrack?: () => void;\n\n  // # stats\n  private lastSRtimestamp?: number;\n  private lastSentSRTimestamp?: number;\n  private ntpTimestamp = 0n;\n  private rtpTimestamp = 0;\n  private octetCount = 0;\n  private packetCount = 0;\n  private rtt?: number;\n  receiverEstimatedMaxBitrate = 0n;\n\n  // rtp\n  private sequenceNumber?: number;\n  private timestamp?: number;\n  private timestampOffset = 0;\n  private seqOffset = 0;\n  private rtpCache: RtpPacket[] = [];\n  codec?: RTCRtpCodecParameters;\n  public dtlsTransport!: RTCDtlsTransport;\n  private dtlsDisposer: (() => void)[] = [];\n\n  track?: MediaStreamTrack;\n  stopped = false;\n  rtcpRunning = false;\n  private rtcpCancel = new AbortController();\n\n  constructor(public trackOrKind: Kind | MediaStreamTrack) {\n    this.kind =\n      typeof this.trackOrKind === \"string\"\n        ? this.trackOrKind\n        : this.trackOrKind.kind;\n    if (typeof trackOrKind !== \"string\") {\n      if (trackOrKind.streamId) {\n        this.streamId = trackOrKind.streamId;\n      }\n      this.registerTrack(trackOrKind);\n    }\n  }\n\n  setDtlsTransport(dtlsTransport: RTCDtlsTransport) {\n    if (this.dtlsTransport) {\n      this.dtlsDisposer.forEach((dispose) => dispose());\n    }\n\n    this.dtlsTransport = dtlsTransport;\n    this.dtlsDisposer = [\n      this.dtlsTransport.onStateChange.subscribe((state) => {\n        if (state === \"connected\") {\n          this.onReady.execute();\n        }\n      }).unSubscribe,\n    ];\n  }\n\n  get redDistance() {\n    return this._redDistance;\n  }\n  set redDistance(n: number) {\n    this._redDistance = n;\n    this.redEncoder.distance = n;\n  }\n\n  prepareSend(params: RTCRtpSendParameters) {\n    this.cname = params.rtcp?.cname;\n    this.mid = params.muxId;\n    this.headerExtensions = params.headerExtensions;\n    this.rtpStreamId = params.rtpStreamId;\n    this.repairedRtpStreamId = params.repairedRtpStreamId;\n\n    this.codec = params.codecs[0];\n    if (this.track) {\n      this.track.codec = this.codec;\n    }\n\n    params.codecs.forEach((codec) => {\n      const codecParams = codecParametersFromString(codec.parameters ?? \"\");\n      if (\n        codec.name.toLowerCase() === \"rtx\" &&\n        codecParams[\"apt\"] === this.codec?.payloadType\n      ) {\n        this.rtxPayloadType = codec.payloadType;\n      }\n      if (codec.name.toLowerCase() === \"red\") {\n        this.redRedundantPayloadType = Number(\n          (codec.parameters ?? \"\").split(\"/\")[0],\n        );\n      }\n    });\n  }\n\n  registerTrack(track: MediaStreamTrack) {\n    if (track.stopped) throw new Error(\"track is ended\");\n\n    if (this.disposeTrack) {\n      this.disposeTrack();\n    }\n\n    track.id = this.trackId;\n\n    const { unSubscribe } = track.onReceiveRtp.subscribe(async (rtp) => {\n      await this.sendRtp(rtp);\n    });\n    this.track = track;\n    this.disposeTrack = unSubscribe;\n\n    if (this.codec) {\n      track.codec = this.codec;\n    }\n\n    track.onSourceChanged.subscribe((header) => {\n      this.replaceRTP(header);\n    });\n  }\n\n  async replaceTrack(track: MediaStreamTrack | null) {\n    if (track === null) {\n      // todo impl\n      return;\n    }\n\n    if (track.stopped) throw new Error(\"track is ended\");\n\n    if (this.sequenceNumber != undefined) {\n      const header =\n        track.header || (await track.onReceiveRtp.asPromise())[0].header;\n\n      this.replaceRTP(header);\n    }\n\n    this.registerTrack(track);\n    log(\"replaceTrack\", \"ssrc\", track.ssrc, \"rid\", track.rid);\n  }\n\n  stop() {\n    this.stopped = true;\n    this.rtcpRunning = false;\n    this.rtcpCancel.abort();\n    if (this.disposeTrack) {\n      this.disposeTrack();\n    }\n    this.track = undefined;\n  }\n\n  async runRtcp() {\n    if (this.rtcpRunning || this.stopped) return;\n    this.rtcpRunning = true;\n\n    try {\n      while (this.rtcpRunning) {\n        await setTimeout(500 + Math.random() * 1000, undefined, {\n          signal: this.rtcpCancel.signal,\n        });\n\n        const packets: RtcpPacket[] = [\n          new RtcpSrPacket({\n            ssrc: this.ssrc,\n            senderInfo: new RtcpSenderInfo({\n              ntpTimestamp: this.ntpTimestamp,\n              rtpTimestamp: this.rtpTimestamp,\n              packetCount: this.packetCount,\n              octetCount: this.octetCount,\n            }),\n          }),\n        ];\n        this.lastSRtimestamp = compactNtp(this.ntpTimestamp);\n        this.lastSentSRTimestamp = timestampSeconds();\n\n        if (this.cname) {\n          packets.push(\n            new RtcpSourceDescriptionPacket({\n              chunks: [\n                new SourceDescriptionChunk({\n                  source: this.ssrc,\n                  items: [\n                    new SourceDescriptionItem({ type: 1, text: this.cname }),\n                  ],\n                }),\n              ],\n            }),\n          );\n        }\n\n        try {\n          await this.dtlsTransport.sendRtcp(packets);\n        } catch (error) {\n          log(\"sendRtcp failed\", error);\n          await setTimeout(500 + Math.random() * 1000);\n        }\n      }\n    } catch (error) {}\n  }\n\n  replaceRTP(\n    {\n      sequenceNumber,\n      timestamp,\n    }: Pick<RtpHeader, \"sequenceNumber\" | \"timestamp\">,\n    discontinuity = false,\n  ) {\n    if (this.sequenceNumber != undefined) {\n      this.seqOffset = uint16Add(this.sequenceNumber, -sequenceNumber);\n      if (discontinuity) {\n        this.seqOffset = uint16Add(this.seqOffset, 2);\n      }\n    }\n    if (this.timestamp != undefined) {\n      this.timestampOffset = uint32Add(this.timestamp, -timestamp);\n      if (discontinuity) {\n        this.timestampOffset = uint16Add(this.timestampOffset, 1);\n      }\n    }\n    this.rtpCache = [];\n    log(\"replaceRTP\", this.sequenceNumber, sequenceNumber, this.seqOffset);\n  }\n\n  async sendRtp(rtp: Buffer | RtpPacket) {\n    if (this.dtlsTransport.state !== \"connected\" || !this.codec) {\n      return;\n    }\n\n    rtp = Buffer.isBuffer(rtp) ? RtpPacket.deSerialize(rtp) : rtp;\n\n    const { header, payload } = rtp;\n    header.ssrc = this.ssrc;\n    header.payloadType = this.codec.payloadType;\n    header.timestamp = uint32Add(header.timestamp, this.timestampOffset);\n    header.sequenceNumber = uint16Add(header.sequenceNumber, this.seqOffset);\n    this.timestamp = header.timestamp;\n    this.sequenceNumber = header.sequenceNumber;\n\n    const ntpTimestamp = ntpTime();\n\n    const originalHeaderExtensions = [...header.extensions];\n    header.extensions = this.headerExtensions\n      .map((extension) => {\n        const payload = (() => {\n          switch (extension.uri) {\n            case RTP_EXTENSION_URI.sdesMid:\n              if (this.mid) {\n                return serializeSdesMid(this.mid);\n              }\n              return;\n            // todo : sender simulcast unsupported now\n            case RTP_EXTENSION_URI.sdesRTPStreamID:\n              if (this.rtpStreamId) {\n                return serializeSdesRTPStreamID(this.rtpStreamId);\n              }\n              return;\n            // todo : sender simulcast unsupported now\n            case RTP_EXTENSION_URI.repairedRtpStreamId:\n              if (this.repairedRtpStreamId) {\n                return serializeRepairedRtpStreamId(this.repairedRtpStreamId);\n              }\n              return;\n            case RTP_EXTENSION_URI.transportWideCC:\n              this.dtlsTransport.transportSequenceNumber = uint16Add(\n                this.dtlsTransport.transportSequenceNumber,\n                1,\n              );\n              return serializeTransportWideCC(\n                this.dtlsTransport.transportSequenceNumber,\n              );\n            case RTP_EXTENSION_URI.absSendTime:\n              return serializeAbsSendTime(ntpTimestamp);\n          }\n        })();\n\n        if (payload) return { id: extension.id, payload };\n      })\n      .filter((v) => v) as Extension[];\n    for (const ext of originalHeaderExtensions) {\n      const exist = header.extensions.find((v) => v.id === ext.id);\n      if (exist) {\n        exist.payload = ext.payload;\n      } else {\n        header.extensions.push(ext);\n      }\n    }\n    header.extensions = header.extensions.sort((a, b) => a.id - b.id);\n\n    this.ntpTimestamp = ntpTimestamp;\n    this.rtpTimestamp = header.timestamp;\n    this.octetCount += payload.length;\n    this.packetCount = uint32Add(this.packetCount, 1);\n\n    this.rtpCache[header.sequenceNumber % RTP_HISTORY_SIZE] = rtp;\n\n    let rtpPayload = payload;\n\n    if (this.redRedundantPayloadType) {\n      this.redEncoder.push({\n        block: rtpPayload,\n        timestamp: header.timestamp,\n        blockPT: this.redRedundantPayloadType,\n      });\n      const red = this.redEncoder.build();\n      rtpPayload = red.serialize();\n    }\n\n    const size = await this.dtlsTransport.sendRtp(rtpPayload, header);\n\n    this.runRtcp();\n    const millitime = milliTime();\n    const sentInfo: SentInfo = {\n      wideSeq: this.dtlsTransport.transportSequenceNumber,\n      size,\n      sendingAtMs: millitime,\n      sentAtMs: millitime,\n    };\n    this.senderBWE.rtpPacketSent(sentInfo);\n  }\n\n  handleRtcpPacket(rtcpPacket: RtcpPacket) {\n    switch (rtcpPacket.type) {\n      case RtcpSrPacket.type:\n      case RtcpRrPacket.type:\n        {\n          const packet = rtcpPacket as RtcpSrPacket | RtcpRrPacket;\n          packet.reports\n            .filter((report) => report.ssrc === this.ssrc)\n            .forEach((report) => {\n              if (this.lastSRtimestamp === report.lsr && report.dlsr) {\n                if (this.lastSentSRTimestamp) {\n                  const rtt =\n                    timestampSeconds() -\n                    this.lastSentSRTimestamp -\n                    report.dlsr / 65536;\n                  if (this.rtt === undefined) {\n                    this.rtt = rtt;\n                  } else {\n                    this.rtt = RTT_ALPHA * this.rtt + (1 - RTT_ALPHA) * rtt;\n                  }\n                }\n              }\n            });\n        }\n        break;\n      case RtcpTransportLayerFeedback.type:\n        {\n          const packet = rtcpPacket as RtcpTransportLayerFeedback;\n          switch (packet.feedback.count) {\n            case TransportWideCC.count:\n              {\n                const feedback = packet.feedback as TransportWideCC;\n                this.senderBWE.receiveTWCC(feedback);\n              }\n              break;\n            case GenericNack.count:\n              {\n                const feedback = packet.feedback as GenericNack;\n                feedback.lost.forEach(async (seqNum) => {\n                  let packet: RtpPacket | undefined =\n                    this.rtpCache[seqNum % RTP_HISTORY_SIZE];\n                  if (packet && packet.header.sequenceNumber !== seqNum) {\n                    packet = undefined;\n                  }\n                  if (packet) {\n                    if (this.rtxPayloadType != undefined) {\n                      packet = wrapRtx(\n                        packet,\n                        this.rtxPayloadType,\n                        this.rtxSequenceNumber,\n                        this.rtxSsrc,\n                      );\n                      this.rtxSequenceNumber = uint16Add(\n                        this.rtxSequenceNumber,\n                        1,\n                      );\n                    }\n                    await this.dtlsTransport.sendRtp(\n                      packet.payload,\n                      packet.header,\n                    );\n                  }\n                });\n                this.onGenericNack.execute(feedback);\n              }\n              break;\n          }\n        }\n        break;\n      case RtcpPayloadSpecificFeedback.type:\n        {\n          const packet = rtcpPacket as RtcpPayloadSpecificFeedback;\n          switch (packet.feedback.count) {\n            case ReceiverEstimatedMaxBitrate.count:\n              {\n                const feedback = packet.feedback as ReceiverEstimatedMaxBitrate;\n                this.receiverEstimatedMaxBitrate = feedback.bitrate;\n              }\n              break;\n            case PictureLossIndication.count:\n              {\n                this.onPictureLossIndication.execute();\n              }\n              break;\n          }\n        }\n        break;\n    }\n    this.onRtcp.execute(rtcpPacket);\n  }\n\n  // todo impl\n  getParameters() {\n    return {\n      encodings: [],\n    };\n  }\n\n  // todo impl\n  setParameters(params: any) {}\n\n  async getStats(): Promise<RTCStats[]> {\n    const timestamp = getStatsTimestamp();\n    const stats: RTCStats[] = [];\n\n    if (!this.dtlsTransport) {\n      return stats;\n    }\n\n    const transportId = generateStatsId(\"transport\", this.dtlsTransport.id);\n\n    // Outbound RTP stats\n    const outboundRtpStats: RTCOutboundRtpStreamStats = {\n      type: \"outbound-rtp\",\n      id: generateStatsId(\"outbound-rtp\", this.ssrc),\n      timestamp,\n      ssrc: this.ssrc,\n      kind: this.kind,\n      transportId,\n      codecId: this.codec\n        ? generateStatsId(\"codec\", this.codec.payloadType, transportId)\n        : undefined,\n      mid: this.mid,\n      packetsSent: this.packetCount,\n      bytesSent: this.octetCount,\n      rtxSsrc: this.rtxPayloadType ? this.rtxSsrc : undefined,\n    };\n    stats.push(outboundRtpStats);\n\n    // Media source stats\n    if (this.track) {\n      const mediaSourceStats: RTCMediaSourceStats = {\n        type: \"media-source\",\n        id: generateStatsId(\"media-source\", this.trackId),\n        timestamp,\n        trackIdentifier: this.trackId,\n        kind: this.kind,\n      };\n      stats.push(mediaSourceStats);\n    }\n\n    // Remote inbound RTP stats (if we have RTT)\n    if (this.rtt !== undefined) {\n      const remoteInboundStats: RTCRemoteInboundRtpStreamStats = {\n        type: \"remote-inbound-rtp\",\n        id: generateStatsId(\"remote-inbound-rtp\", this.ssrc),\n        timestamp,\n        ssrc: this.ssrc,\n        kind: this.kind,\n        transportId,\n        codecId: outboundRtpStats.codecId,\n        localId: outboundRtpStats.id,\n        roundTripTime: this.rtt,\n      };\n      stats.push(remoteInboundStats);\n    }\n\n    return stats;\n  }\n}\n","export const SignatureAlgorithm = {\n  rsa_1: 1,\n  ecdsa_3: 3,\n} as const;\nexport type SignatureAlgorithms =\n  (typeof SignatureAlgorithm)[keyof typeof SignatureAlgorithm];\n\nexport const HashAlgorithm = {\n  sha256_4: 4,\n} as const;\nexport type HashAlgorithms = (typeof HashAlgorithm)[keyof typeof HashAlgorithm];\n\nexport type SignatureHash = {\n  hash: HashAlgorithms;\n  signature: SignatureAlgorithms;\n};\n\nexport const CipherSuite = {\n  TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_49195: 0xc02b, //49195,\n  TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_49199: 0xc02f, //49199\n} as const;\nexport type CipherSuites = (typeof CipherSuite)[keyof typeof CipherSuite];\nexport const CipherSuiteList: CipherSuites[] = Object.values(CipherSuite);\n\nexport const NamedCurveAlgorithm = {\n  x25519_29: 29,\n  secp256r1_23: 23,\n} as const;\nexport type NamedCurveAlgorithms =\n  (typeof NamedCurveAlgorithm)[keyof typeof NamedCurveAlgorithm];\nexport const NamedCurveAlgorithmList: NamedCurveAlgorithms[] =\n  Object.values(NamedCurveAlgorithm);\n\nexport const CurveType = { named_curve_3: 3 } as const;\nexport type CurveTypes = (typeof CurveType)[keyof typeof CurveType];\n\nexport const SignatureScheme = {\n  rsa_pkcs1_sha256: 0x0401,\n  ecdsa_secp256r1_sha256: 0x0403,\n} as const;\nexport type SignatureSchemes =\n  (typeof SignatureScheme)[keyof typeof SignatureScheme];\n\nexport const certificateTypes = [\n  1, // clientCertificateTypeRSASign\n  64, // clientCertificateTypeECDSASign\n];\n\nexport const signatures = [\n  { hash: HashAlgorithm.sha256_4, signature: SignatureAlgorithm.rsa_1 },\n  { hash: HashAlgorithm.sha256_4, signature: SignatureAlgorithm.ecdsa_3 },\n];\n","import {\n  BitWriter,\n  bufferReader,\n  bufferWriter,\n  getBit,\n} from \"../../../common/src\";\n\nexport const RTCP_HEADER_SIZE = 4;\n\n/*\n *  0                   1                   2                   3\n *  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n * |V=2|P|    RC   |      PT       |             length            |\n * +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n */\n\nexport class RtcpHeader {\n  version = 2;\n  padding = false;\n  count = 0;\n  type = 0;\n  /**32 1 */\n  length = 0;\n\n  constructor(props: Partial<RtcpHeader> = {}) {\n    Object.assign(this, props);\n  }\n\n  static serialize(\n    type: number,\n    count: number,\n    payload: Buffer,\n    length: number,\n  ) {\n    const header = new RtcpHeader({\n      type,\n      count,\n      version: 2,\n      length,\n    });\n    const buf = header.serialize();\n    return Buffer.concat([buf, payload]);\n  }\n\n  serialize() {\n    const v_p_rc = new BitWriter(8);\n    v_p_rc.set(2, 0, this.version);\n    if (this.padding) v_p_rc.set(1, 2, 1);\n    v_p_rc.set(5, 3, this.count);\n    const buf = bufferWriter([1, 1, 2], [v_p_rc.value, this.type, this.length]);\n    return buf;\n  }\n\n  static deSerialize(buf: Buffer) {\n    const [v_p_rc, type, length] = bufferReader(buf, [1, 1, 2]);\n    const version = getBit(v_p_rc, 0, 2);\n    const padding = getBit(v_p_rc, 2, 1) > 0;\n    const count = getBit(v_p_rc, 3, 5);\n    return new RtcpHeader({ version, padding, count, type, length });\n  }\n}\n","import * as Int64 from \"int64-buffer\";\nimport nodeIp from \"ip\";\n\nimport type { Address } from \"../imports/common\";\nimport {\n  type AttributeKeys,\n  COOKIE,\n  IPV4_PROTOCOL,\n  IPV6_PROTOCOL,\n} from \"./const\";\n\nfunction packAddress(value: Address) {\n  const [address] = value;\n\n  const protocol = nodeIp.isV4Format(address) ? IPV4_PROTOCOL : IPV6_PROTOCOL;\n\n  const buffer = Buffer.alloc(4);\n  buffer.writeUInt8(0, 0);\n  buffer.writeUInt8(protocol, 1);\n  buffer.writeUInt16BE(value[1], 2);\n\n  return Buffer.concat([buffer, nodeIp.toBuffer(address)]);\n}\n\nexport function unpackErrorCode(data: Buffer): [number, string] {\n  if (data.length < 4) throw new Error(\"STUN error code is less than 4 bytes\");\n  const codeHigh = data.readUInt8(2);\n  const codeLow = data.readUInt8(3);\n  const reason = data.slice(4).toString(\"utf8\");\n  return [codeHigh * 100 + codeLow, reason];\n}\n\nfunction unpackAddress(data: Buffer): Address {\n  if (data.length < 4)\n    throw new Error(\"STUN address length is less than 4 bytes\");\n  const protocol = data.readUInt8(1);\n  const port = data.readUInt16BE(2);\n  const address = data.slice(4);\n  switch (protocol) {\n    case IPV4_PROTOCOL:\n      if (address.length != 4)\n        throw new Error(`STUN address has invalid length for IPv4`);\n      return [nodeIp.toString(address), port];\n    case IPV6_PROTOCOL:\n      if (address.length != 16)\n        throw new Error(\"STUN address has invalid length for IPv6\");\n      return [nodeIp.toString(address), port];\n    default:\n      throw new Error(\"STUN address has unknown protocol\");\n  }\n}\n\nconst cookieBuffer = Buffer.alloc(6);\ncookieBuffer.writeUInt16BE(COOKIE >> 16, 0);\ncookieBuffer.writeUInt32BE(COOKIE, 2);\n\nfunction xorAddress(data: Buffer, transactionId: Buffer) {\n  const xPad = [...cookieBuffer, ...transactionId];\n  let xData = data.slice(0, 2);\n\n  for (let i = 2; i < data.length; i++) {\n    const num = data[i] ^ xPad[i - 2];\n    const buf = Buffer.alloc(1);\n    buf.writeUIntBE(num, 0, 1);\n    xData = Buffer.concat([xData, buf]);\n  }\n  return xData;\n}\n\nexport function unpackXorAddress(data: Buffer, transactionId: Buffer): Address {\n  return unpackAddress(xorAddress(data, transactionId));\n}\n\nexport function packErrorCode(value: [number, string]) {\n  const buffer = Buffer.alloc(4);\n  buffer.writeUInt16BE(0, 0);\n  buffer.writeUInt8(Math.floor(value[0] / 100), 2);\n  buffer.writeUInt8(value[0] % 100, 3);\n  const encode = Buffer.from(value[1], \"utf8\");\n  return Buffer.concat([buffer, encode]);\n}\n\nexport function packXorAddress(value: Address, transactionId: Buffer) {\n  return xorAddress(packAddress(value), transactionId);\n}\n\nconst packUnsigned = (value: number) => {\n  const buffer = Buffer.alloc(4);\n  buffer.writeUInt32BE(value, 0);\n  return buffer;\n};\n\nconst unpackUnsigned = (data: Buffer) => data.readUInt32BE(0);\n\nconst packUnsignedShort = (value: number) => {\n  const buffer = Buffer.alloc(4);\n  buffer.writeUInt16BE(value, 0);\n  return buffer;\n};\n\nconst unpackUnsignedShort = (data: Buffer) => data.readUInt16BE(0);\n\nconst packUnsigned64 = (value: bigint) => {\n  return new Int64.Int64BE(value.toString()).toBuffer();\n};\nconst unpackUnsigned64 = (data: Buffer) => {\n  const int = new Int64.Int64BE(data);\n  return BigInt(int.toString());\n};\n\nconst packString = (value: string) => Buffer.from(value, \"utf8\");\nconst unpackString = (data: Buffer) => data.toString(\"utf8\");\n\nconst packBytes = (value: Buffer) => value;\nconst unpackBytes = (data: Buffer) => data;\n\nconst packNone = (value: Buffer) => Buffer.from([]);\nconst unpackNone = (data: Buffer) => null;\n\nexport type ATTRIBUTE = [\n  number,\n  AttributeKey,\n  (...args: any) => Buffer,\n  (...args: any) => any,\n];\n\nconst ATTRIBUTES: ATTRIBUTE[] = [\n  [0x0001, \"MAPPED-ADDRESS\", packAddress, unpackAddress],\n  [0x0003, \"CHANGE-REQUEST\", packUnsigned, unpackUnsigned],\n  [0x0004, \"SOURCE-ADDRESS\", packAddress, unpackAddress],\n  [0x0005, \"CHANGED-ADDRESS\", packAddress, unpackAddress],\n  [0x0006, \"USERNAME\", packString, unpackString],\n  [0x0008, \"MESSAGE-INTEGRITY\", packBytes, unpackBytes],\n  [0x0009, \"ERROR-CODE\", packErrorCode, unpackErrorCode],\n  [0x000c, \"CHANNEL-NUMBER\", packUnsignedShort, unpackUnsignedShort],\n  [0x000d, \"LIFETIME\", packUnsigned, unpackUnsigned],\n  [0x0012, \"XOR-PEER-ADDRESS\", packXorAddress, unpackXorAddress],\n  [0x0013, \"DATA\", packBytes, unpackBytes],\n  [0x0014, \"REALM\", packString, unpackString],\n  [0x0015, \"NONCE\", packBytes, unpackBytes],\n  [0x0016, \"XOR-RELAYED-ADDRESS\", packXorAddress, unpackXorAddress],\n  [0x0019, \"REQUESTED-TRANSPORT\", packUnsigned, unpackUnsigned],\n  [0x0020, \"XOR-MAPPED-ADDRESS\", packXorAddress, unpackXorAddress],\n  [0x0024, \"PRIORITY\", packUnsigned, unpackUnsigned],\n  [0x0025, \"USE-CANDIDATE\", packNone, unpackNone],\n  [0x8022, \"SOFTWARE\", packString, unpackString],\n  [0x8028, \"FINGERPRINT\", packUnsigned, unpackUnsigned],\n  [0x8029, \"ICE-CONTROLLED\", packUnsigned64, unpackUnsigned64],\n  [0x802a, \"ICE-CONTROLLING\", packUnsigned64, unpackUnsigned64],\n  [0x802b, \"RESPONSE-ORIGIN\", packAddress, unpackAddress],\n  [0x802c, \"OTHER-ADDRESS\", packAddress, unpackAddress],\n];\n\nexport class AttributeRepository {\n  constructor(protected attributes: AttributePair[] = []) {}\n\n  getAttributes() {\n    return this.attributes;\n  }\n\n  setAttribute(key: (typeof AttributeKeys)[number], value: any) {\n    const exist = this.attributes.find((a) => a[0] === key);\n    if (exist) {\n      exist[1] = value;\n    } else {\n      this.attributes.push([key, value]);\n    }\n    return this;\n  }\n\n  getAttributeValue(key: AttributeKey) {\n    const attribute = this.attributes.find((a) => a[0] === key);\n    if (!attribute) {\n      return undefined;\n    }\n    return attribute[1];\n  }\n\n  get attributesKeys(): (typeof AttributeKeys)[number][] {\n    return this.attributes.map((a) => a[0]);\n  }\n\n  clear() {\n    this.attributes = [];\n  }\n}\n\nexport type AttributeKey = (typeof AttributeKeys)[number];\n\nexport type AttributePair = [AttributeKey, any];\n\nexport const ATTRIBUTES_BY_TYPE = ATTRIBUTES.reduce(\n  (acc, cur) => {\n    acc[cur[0]] = cur;\n    return acc;\n  },\n  {} as { [key: string]: ATTRIBUTE },\n);\n\nexport const ATTRIBUTES_BY_NAME = ATTRIBUTES.reduce(\n  (acc, cur) => {\n    acc[cur[1]] = cur;\n    return acc;\n  },\n  {} as { [key: string]: ATTRIBUTE },\n);\n","import { randomBytes } from \"crypto\";\nimport { isIPv4 } from \"net\";\nimport * as Int64 from \"int64-buffer\";\n\nimport {\n  DTLS_ROLE_SETUP,\n  DTLS_SETUP_ROLE,\n  FMTP_INT_PARAMETERS,\n  SSRC_INFO_ATTRS,\n} from \"./const\";\nimport { divide } from \"./helper\";\nimport { Candidate } from \"./imports/ice\";\nimport {\n  RTCRtcpFeedback,\n  RTCRtpCodecParameters,\n  RTCRtpHeaderExtensionParameters,\n  type RTCRtpParameters,\n  RTCRtpSimulcastParameters,\n} from \"./media/parameters\";\nimport type { MediaDirection } from \"./media/rtpTransceiver\";\nimport {\n  type DtlsRole,\n  RTCDtlsFingerprint,\n  RTCDtlsParameters,\n} from \"./transport/dtls\";\nimport {\n  type IceCandidate,\n  RTCIceParameters,\n  candidateFromIce,\n} from \"./transport/ice\";\nimport { RTCSctpCapabilities } from \"./transport/sctp\";\nimport type { Kind } from \"./types/domain\";\n\nexport class SessionDescription {\n  version = 0;\n  origin?: string;\n  name = \"-\";\n  time = \"0 0\";\n  host?: string;\n  group: GroupDescription[] = [];\n  extMapAllowMixed = true;\n  msidSemantic: GroupDescription[] = [];\n  media: MediaDescription[] = [];\n  type!: \"offer\" | \"answer\";\n  dtlsRole!: DtlsRole;\n  iceOptions!: string;\n  iceLite!: boolean;\n  icePassword!: string;\n  iceUsernameFragment!: string;\n  dtlsFingerprints: RTCDtlsFingerprint[] = [];\n\n  static parse(sdp: string) {\n    const [sessionLines, mediaGroups] = groupLines(sdp);\n\n    const session = new SessionDescription();\n    sessionLines.forEach((line) => {\n      if (line.startsWith(\"v=\")) {\n        session.version = Number.parseInt(line.slice(2), 10);\n      } else if (line.startsWith(\"o=\")) {\n        session.origin = line.slice(2);\n      } else if (line.startsWith(\"s=\")) {\n        session.name = line.slice(2);\n      } else if (line.startsWith(\"c=\")) {\n        session.host = ipAddressFromSdp(line.slice(2));\n      } else if (line.startsWith(\"t=\")) {\n        session.time = line.slice(2);\n      } else if (line.startsWith(\"a=\")) {\n        const [attr, value] = parseAttr(line);\n        switch (attr) {\n          case \"fingerprint\":\n            {\n              const [algorithm, fingerprint] = value?.split(\" \") || [];\n              session.dtlsFingerprints.push(\n                new RTCDtlsFingerprint(algorithm, fingerprint),\n              );\n            }\n            break;\n          case \"ice-lite\":\n            session.iceLite = true;\n            break;\n          case \"ice-options\":\n            session.iceOptions = value;\n            break;\n          case \"ice-pwd\":\n            session.icePassword = value;\n            break;\n          case \"ice-ufrag\":\n            session.iceUsernameFragment = value;\n            break;\n          case \"group\":\n            parseGroup(session.group, value);\n            break;\n          case \"msid-semantic\":\n            parseGroup(session.msidSemantic, value);\n            break;\n          case \"setup\":\n            session.dtlsRole = DTLS_SETUP_ROLE[value];\n            break;\n          case \"extmap-allow-mixed\":\n            session.extMapAllowMixed = true;\n            break;\n        }\n      }\n    });\n\n    const bundle = session.group.find((g) => g.semantic === \"BUNDLE\");\n\n    mediaGroups.forEach((mediaLines) => {\n      const target = mediaLines[0];\n      const m = target.match(/^m=([^ ]+) ([0-9]+) ([A-Z/]+) (.+)/);\n      if (!m) {\n        throw new Error(\"m line not found\");\n      }\n\n      const kind = m[1] as Kind;\n      const fmt = m[4].split(\" \");\n      // todo fix\n      const fmtInt = [\"audio\", \"video\"].includes(kind)\n        ? fmt.map((v) => Number(v))\n        : undefined;\n\n      const currentMedia = new MediaDescription(\n        kind,\n        Number.parseInt(m[2]),\n        m[3],\n        fmtInt || fmt,\n      );\n      currentMedia.dtlsParams = new RTCDtlsParameters(\n        [...session.dtlsFingerprints],\n        session.dtlsRole,\n      );\n\n      currentMedia.iceParams = new RTCIceParameters({\n        iceLite: session.iceLite,\n        usernameFragment: session.iceUsernameFragment,\n        password: session.icePassword,\n      });\n\n      currentMedia.iceOptions = session.iceOptions;\n      session.media.push(currentMedia);\n\n      mediaLines.slice(1).forEach((line) => {\n        if (line.startsWith(\"c=\")) {\n          currentMedia.host = ipAddressFromSdp(line.slice(2));\n        } else if (line.startsWith(\"a=\")) {\n          const [attr, value] = parseAttr(line);\n\n          switch (attr) {\n            case \"candidate\":\n              if (!value) throw new Error();\n              currentMedia.iceCandidates.push(candidateFromSdp(value));\n              break;\n            case \"end-of-candidates\":\n              currentMedia.iceCandidatesComplete = true;\n              break;\n            case \"extmap\":\n              {\n                // eslint-disable-next-line prefer-const\n                let [extId, extUri] = value.split(\" \");\n                if (extId.includes(\"/\")) {\n                  [extId] = extId.split(\"/\");\n                }\n                currentMedia.rtp.headerExtensions.push(\n                  new RTCRtpHeaderExtensionParameters({\n                    id: Number.parseInt(extId),\n                    uri: extUri,\n                  }),\n                );\n              }\n              break;\n            case \"fingerprint\":\n              {\n                if (!value) throw new Error();\n                const [algorithm, fingerprint] = value.split(\" \");\n                currentMedia.dtlsParams?.fingerprints.push(\n                  new RTCDtlsFingerprint(algorithm, fingerprint),\n                );\n              }\n              break;\n            case \"ice-options\":\n              currentMedia.iceOptions = value;\n              break;\n            case \"ice-pwd\":\n              currentMedia.iceParams!.password = value;\n              break;\n            case \"ice-ufrag\":\n              currentMedia.iceParams!.usernameFragment = value;\n              break;\n            case \"ice-lite\":\n              currentMedia.iceParams!.iceLite = true;\n              break;\n            case \"max-message-size\":\n              currentMedia.sctpCapabilities = new RTCSctpCapabilities(\n                Number.parseInt(value, 10),\n              );\n              break;\n            case \"mid\":\n              currentMedia.rtp.muxId = value;\n              break;\n            case \"msid\":\n              currentMedia.msid = value;\n              break;\n            case \"rtcp\":\n              {\n                const [port, rest] = divide(value, \" \");\n                currentMedia.rtcpPort = Number.parseInt(port);\n                currentMedia.rtcpHost = ipAddressFromSdp(rest);\n              }\n              break;\n            case \"rtcp-mux\":\n              currentMedia.rtcpMux = true;\n              break;\n            case \"setup\":\n              currentMedia.dtlsParams!.role = DTLS_SETUP_ROLE[value];\n              break;\n            case \"recvonly\":\n            case \"sendonly\":\n            case \"sendrecv\":\n            case \"inactive\":\n              currentMedia.direction = attr;\n              break;\n            case \"rtpmap\":\n              {\n                const [formatId, formatDesc] = divide(value, \" \");\n                const [type, clock, channel] = formatDesc.split(\"/\");\n                let channels: number | undefined;\n                if (currentMedia.kind === \"audio\") {\n                  channels = channel ? Number.parseInt(channel) : 1;\n                }\n                const codec = new RTCRtpCodecParameters({\n                  mimeType: currentMedia.kind + \"/\" + type,\n                  channels,\n                  clockRate: Number.parseInt(clock),\n                  payloadType: Number.parseInt(formatId),\n                });\n                currentMedia.rtp.codecs.push(codec);\n              }\n              break;\n            case \"sctpmap\":\n              {\n                if (!value) throw new Error();\n                const [formatId, formatDesc] = divide(value, \" \");\n                currentMedia.sctpMap[Number.parseInt(formatId)] = formatDesc;\n                currentMedia.sctpPort = Number.parseInt(formatId);\n              }\n              break;\n            case \"sctp-port\":\n              if (!value) throw new Error();\n              currentMedia.sctpPort = Number.parseInt(value);\n              break;\n            case \"ssrc\":\n              {\n                const [ssrcStr, ssrcDesc] = divide(value, \" \");\n                const ssrc = Number.parseInt(ssrcStr);\n                const [ssrcAttr, ssrcValue] = divide(ssrcDesc, \":\");\n                let ssrcInfo = currentMedia.ssrc.find((v) => v.ssrc === ssrc);\n                if (!ssrcInfo) {\n                  ssrcInfo = new SsrcDescription({ ssrc });\n                  currentMedia.ssrc.push(ssrcInfo);\n                }\n                if (SSRC_INFO_ATTRS.includes(ssrcAttr)) {\n                  ssrcInfo[ssrcAttr] = ssrcValue;\n                }\n              }\n              break;\n            case \"ssrc-group\":\n              parseGroup(currentMedia.ssrcGroup, value);\n              break;\n            case \"rid\":\n              {\n                const [rid, direction] = divide(value, \" \");\n\n                currentMedia.simulcastParameters.push(\n                  new RTCRtpSimulcastParameters({\n                    rid,\n                    direction: direction as any,\n                  }),\n                );\n              }\n              break;\n          }\n        }\n      });\n\n      if (\n        !currentMedia.iceParams.usernameFragment ||\n        !currentMedia.iceParams.password\n      ) {\n        if (\n          currentMedia.rtp.muxId &&\n          bundle &&\n          bundle.items.includes(currentMedia.rtp.muxId)\n        ) {\n          for (let i = 0; i < bundle.items.length; i++) {\n            if (!bundle.items.includes(i.toString())) continue;\n            const check = session.media[i];\n            if (check.iceParams?.usernameFragment && check.iceParams.password) {\n              currentMedia.iceParams = {\n                ...check.iceParams,\n              };\n              break;\n            }\n          }\n        }\n      }\n\n      if (!currentMedia.dtlsParams.role) {\n        currentMedia.dtlsParams = undefined;\n      }\n\n      const findCodec = (pt: number) =>\n        currentMedia.rtp.codecs.find((v) => v.payloadType === pt);\n\n      mediaLines.slice(1).forEach((line) => {\n        if (line.startsWith(\"a=\")) {\n          const [attr, value] = parseAttr(line);\n          if (attr === \"fmtp\") {\n            const [formatId, formatDesc] = divide(value, \" \");\n            const codec = findCodec(Number(formatId))!;\n            codec.parameters = formatDesc;\n          } else if (attr === \"rtcp-fb\") {\n            const [payloadType, feedbackType, feedbackParam] = value.split(\" \");\n            currentMedia.rtp.codecs.forEach((codec) => {\n              if ([\"*\", codec.payloadType!.toString()].includes(payloadType)) {\n                codec.rtcpFeedback.push(\n                  new RTCRtcpFeedback({\n                    type: feedbackType,\n                    parameter: feedbackParam,\n                  }),\n                );\n              }\n            });\n          }\n        }\n      });\n    });\n\n    return session;\n  }\n\n  webrtcTrackId(media: MediaDescription) {\n    if (media.msid?.includes(\" \")) {\n      const bits = media.msid.split(\" \");\n      for (const group of this.msidSemantic) {\n        if (\n          group.semantic === \"WMS\" &&\n          (group.items.includes(bits[0]) || group.items.includes(\"*\"))\n        ) {\n          return bits[1];\n        }\n      }\n    }\n    return;\n  }\n\n  get string() {\n    const lines = [`v=${this.version}`, `o=${this.origin}`, `s=${this.name}`];\n    if (this.host) {\n      lines.push(`c=${ipAddressToSdp(this.host)}`);\n    }\n    lines.push(`t=${this.time}`);\n    this.group.forEach((group) => lines.push(`a=group:${group.str}`));\n    if (this.extMapAllowMixed) {\n      lines.push(`a=extmap-allow-mixed`);\n    }\n    this.msidSemantic.forEach((group) =>\n      lines.push(`a=msid-semantic:${group.str}`),\n    );\n    const media = this.media.map((m) => m.toString()).join(\"\");\n    const sdp = lines.join(\"\\r\\n\") + \"\\r\\n\" + media;\n    return sdp;\n  }\n\n  toJSON() {\n    return new RTCSessionDescription(this.string, this.type);\n  }\n\n  toSdp() {\n    return {\n      type: this.type,\n      sdp: this.string,\n    };\n  }\n}\n\nexport class MediaDescription {\n  // rtp\n  host?: string;\n  direction?: MediaDirection;\n  msid?: string;\n\n  // rtcp\n  rtcpPort?: number;\n  rtcpHost?: string;\n  rtcpMux = false;\n\n  // ssrc\n  ssrc: SsrcDescription[] = [];\n  ssrcGroup: GroupDescription[] = [];\n\n  // formats\n  rtp: RTCRtpParameters = { codecs: [], headerExtensions: [] };\n\n  // sctp\n  sctpCapabilities?: RTCSctpCapabilities;\n  sctpMap: { [key: number]: string } = {};\n  sctpPort?: number;\n\n  // DTLS\n  dtlsParams?: RTCDtlsParameters;\n\n  // ICE\n  iceParams?: RTCIceParameters;\n  iceCandidates: IceCandidate[] = [];\n  iceCandidatesComplete = false;\n  iceOptions?: string;\n\n  // Simulcast\n  simulcastParameters: RTCRtpSimulcastParameters[] = [];\n\n  constructor(\n    public kind: Kind,\n    public port: number,\n    public profile: string,\n    public fmt: string[] | number[],\n  ) {}\n\n  toString() {\n    const lines: string[] = [];\n    lines.push(\n      `m=${this.kind} ${this.port} ${this.profile} ${(this.fmt as number[])\n        .map((v) => v.toString())\n        .join(\" \")}`,\n    );\n    if (this.host) {\n      lines.push(`c=${ipAddressToSdp(this.host)}`);\n    }\n    // ice\n    this.iceCandidates.forEach((candidate) => {\n      lines.push(`a=candidate:${candidateToSdp(candidate)}`);\n    });\n    if (this.iceCandidatesComplete) {\n      lines.push(\"a=end-of-candidates\");\n    }\n    if (this.iceParams?.usernameFragment) {\n      lines.push(`a=ice-ufrag:${this.iceParams.usernameFragment}`);\n    }\n    if (this.iceParams?.password) {\n      lines.push(`a=ice-pwd:${this.iceParams.password}`);\n    }\n    if (this.iceParams?.iceLite) {\n      lines.push(`a=ice-lite`);\n    }\n    if (this.iceOptions) {\n      lines.push(`a=ice-options:${this.iceOptions}`);\n    }\n\n    // dtls\n    if (this.dtlsParams) {\n      this.dtlsParams.fingerprints.forEach((fingerprint) => {\n        lines.push(\n          `a=fingerprint:${fingerprint.algorithm} ${fingerprint.value}`,\n        );\n      });\n      lines.push(`a=setup:${DTLS_ROLE_SETUP[this.dtlsParams.role]}`);\n    }\n\n    if (this.direction) {\n      lines.push(`a=${this.direction}`);\n    }\n    if (this.rtp.muxId) {\n      lines.push(`a=mid:${this.rtp.muxId}`);\n    }\n    if (this.msid) {\n      lines.push(`a=msid:${this.msid}`);\n    }\n\n    if (this.rtcpPort && this.rtcpHost) {\n      lines.push(`a=rtcp:${this.rtcpPort} ${ipAddressToSdp(this.rtcpHost)}`);\n      if (this.rtcpMux) {\n        lines.push(\"a=rtcp-mux\");\n      }\n    }\n\n    this.ssrcGroup.forEach((group) => {\n      lines.push(`a=ssrc-group:${group.str}`);\n    });\n    this.ssrc.forEach((ssrcInfo) => {\n      SSRC_INFO_ATTRS.forEach((ssrcAttr) => {\n        const ssrcValue = ssrcInfo[ssrcAttr];\n        if (ssrcValue !== undefined) {\n          lines.push(`a=ssrc:${ssrcInfo.ssrc} ${ssrcAttr}:${ssrcValue}`);\n        }\n      });\n    });\n\n    this.rtp.codecs.forEach((codec) => {\n      lines.push(`a=rtpmap:${codec.payloadType} ${codec.str}`);\n\n      codec.rtcpFeedback.forEach((feedback) => {\n        let value = feedback.type;\n        if (feedback.parameter) value += ` ${feedback.parameter}`;\n        lines.push(`a=rtcp-fb:${codec.payloadType} ${value}`);\n      });\n\n      if (codec.parameters) {\n        lines.push(`a=fmtp:${codec.payloadType} ${codec.parameters}`);\n      }\n    });\n\n    Object.keys(this.sctpMap).forEach((k) => {\n      const v = this.sctpMap[Number(k)];\n      lines.push(`a=sctpmap:${k} ${v}`);\n    });\n    if (this.sctpPort) {\n      lines.push(`a=sctp-port:${this.sctpPort}`);\n    }\n    if (this.sctpCapabilities) {\n      lines.push(`a=max-message-size:${this.sctpCapabilities.maxMessageSize}`);\n    }\n\n    // rtp extension\n    this.rtp.headerExtensions.forEach((extension) =>\n      lines.push(`a=extmap:${extension.id} ${extension.uri}`),\n    );\n\n    // simulcast\n    if (this.simulcastParameters.length) {\n      this.simulcastParameters.forEach((param) => {\n        lines.push(`a=rid:${param.rid} ${param.direction}`);\n      });\n      let line = `a=simulcast:`;\n      const recv = this.simulcastParameters.filter(\n        (v) => v.direction === \"recv\",\n      );\n      if (recv.length) {\n        line += `recv ${recv.map((v) => v.rid).join(\";\")} `;\n      }\n      const send = this.simulcastParameters.filter(\n        (v) => v.direction === \"send\",\n      );\n      if (send.length) {\n        line += `send ${send.map((v) => v.rid).join(\";\")}`;\n      }\n\n      lines.push(line);\n    }\n\n    return lines.join(\"\\r\\n\") + \"\\r\\n\";\n  }\n}\n\nexport class GroupDescription {\n  constructor(\n    public semantic: string,\n    public items: string[],\n  ) {}\n\n  get str() {\n    return `${this.semantic} ${this.items.join(\" \")}`;\n  }\n}\n\nfunction ipAddressFromSdp(sdp: string) {\n  const m = sdp.match(/^IN (IP4|IP6) ([^ ]+)$/);\n  if (!m) throw new Error(\"exception\");\n  return m[2];\n}\n\nfunction ipAddressToSdp(addr: string) {\n  const version = isIPv4(addr) ? 4 : 6;\n  return `IN IP${version} ${addr}`;\n}\n\nexport function candidateToSdp(c: IceCandidate) {\n  let sdp = `${c.foundation} ${c.component} ${c.protocol} ${c.priority} ${c.ip} ${c.port} typ ${c.type}`;\n  if (c.relatedAddress != undefined) {\n    sdp += ` raddr ${c.relatedAddress}`;\n  }\n  if (c.relatedPort != undefined) {\n    sdp += ` rport ${c.relatedPort}`;\n  }\n  if (c.tcpType != undefined) {\n    sdp += ` tcptype ${c.tcpType}`;\n  }\n  if (c.generation != undefined) {\n    sdp += ` generation ${c.generation}`;\n  }\n  if (c.ufrag != undefined) {\n    sdp += ` ufrag ${c.ufrag}`;\n  }\n\n  return sdp;\n}\n\nfunction groupLines(sdp: string): [string[], string[][]] {\n  const session: string[] = [];\n  const media: string[][] = [];\n\n  let lines = sdp.split(\"\\r\\n\");\n  if (lines.length === 1) {\n    lines = sdp.split(\"\\n\");\n  }\n\n  lines.forEach((line) => {\n    if (line.startsWith(\"m=\")) {\n      media.push([line]);\n    } else if (media.length > 0) {\n      media[media.length - 1].push(line);\n    } else {\n      session.push(line);\n    }\n  });\n\n  return [session, media];\n}\n\nfunction parseAttr(line: string): [string, string] {\n  if (line.includes(\":\")) {\n    const bits = divide(line.slice(2), \":\");\n    return [bits[0], bits[1]];\n  } else {\n    return [line.slice(2), undefined as any];\n  }\n}\n\nexport function parseGroup(\n  dest: GroupDescription[],\n  value: string,\n  type: (v: string) => any = (v) => v.toString(),\n) {\n  const bits = value.split(\" \");\n  if (bits.length > 0) {\n    dest.push(new GroupDescription(bits[0], bits.slice(1).map(type)));\n  }\n}\n\nexport function candidateFromSdp(sdp: string) {\n  const ice = Candidate.fromSdp(sdp);\n  const candidate = candidateFromIce(ice);\n  return candidate;\n}\n\nexport class RTCSessionDescription {\n  constructor(\n    public sdp: string,\n    public type: \"offer\" | \"answer\",\n  ) {}\n\n  static isThis(o: any) {\n    if (typeof o?.sdp === \"string\") return true;\n  }\n\n  toSdp() {\n    return {\n      sdp: this.sdp,\n      type: this.type,\n    };\n  }\n}\n\nexport function addSDPHeader(\n  type: \"offer\" | \"answer\",\n  description: SessionDescription,\n) {\n  const username = \"-\";\n  const sessionId = new Int64.Uint64BE(randomBytes(64)).toString().slice(0, 8);\n  const sessionVersion = 0;\n\n  description.origin = `${username} ${sessionId} ${sessionVersion} IN IP4 0.0.0.0`;\n  description.msidSemantic.push(new GroupDescription(\"WMS\", [\"*\"]));\n  description.type = type;\n}\n\nexport function codecParametersFromString(str: string) {\n  const parameters: any = {};\n  str.split(\";\").forEach((param) => {\n    if (param.includes(\"=\")) {\n      const [k, v] = divide(param, \"=\");\n      if (FMTP_INT_PARAMETERS.includes(k)) {\n        parameters[k] = Number(v);\n      } else {\n        parameters[k] = v;\n      }\n    } else if (param.includes(\":\")) {\n      const [k, v] = param.split(\":\");\n      parameters[k] = Number.isNaN(Number(v)) ? v : Number(v);\n    } else {\n      parameters[param] = undefined;\n    }\n  });\n  return parameters;\n}\n\nexport function codecParametersToString(\n  parameters: {\n    [key: string]: string | number;\n  },\n  joint: string = \"=\",\n) {\n  const params = Object.entries(parameters).map(([k, v]) => {\n    if (v) return `${k}${joint}${v}`;\n    else return k;\n  });\n  if (params.length > 0) {\n    return params.join(\";\");\n  }\n  return undefined;\n}\n\nexport class SsrcDescription {\n  ssrc!: number;\n  cname?: string;\n  msid?: string;\n  msLabel?: string;\n  label?: string;\n\n  constructor(props: Partial<SsrcDescription>) {\n    Object.assign(this, props);\n  }\n}\n\nexport type BundlePolicy = \"max-compat\" | \"max-bundle\" | \"disable\";\n","'use strict';\n\nconst { decodeCommon } = require('lib/decode');\nconst { encodeCommon } = require('lib/encode');\nconst { encodingLengthCommon } = require('lib/encoding-length');\nconst { isType, isUserType, isFunction } = require('lib/util');\nconst Metadata = require('internal/meta');\n\nmodule.exports = array;\n\n/**\n * Array type.\n * @param {Object} type Any builtin type or schema.\n * @param {Object|number} length Number type or number.\n * @param {string} lengthType Method of calculate the length of array.\n * @returns {Object}\n */\nfunction array(type, length, lengthType = 'count') {\n  if (!isType(type) && !isUserType(type)) {\n    throw new TypeError('Argument #1 should be a valid type.');\n  }\n\n  const isLengthInBytes = lengthType === 'bytes';\n  const isnum = typeof length === 'number';\n  const istype = isType(length);\n  const isfunc = isFunction(length);\n\n  if (!isnum && !istype && !isfunc) {\n    throw new TypeError('Unknown type of argument #1.');\n  }\n\n  return {\n    encode,\n    decode,\n    encodingLength,\n  };\n\n  /**\n   * Encode array's items.\n   * @param {any[]} items Array of items to encode.\n   * @param {EncodeStream} wstream\n   */\n  function encode(items, wstream) {\n    checkArray(items);\n\n    // eslint-disable-next-line no-invalid-this\n    const context = Metadata.clone(this);\n\n    encode.bytes = 0;\n    let expectedSize = 0;\n\n    if (istype) {\n      expectedSize = items.length;\n    } else if (isnum) {\n      expectedSize = length;\n    } else if (isfunc) {\n      expectedSize = length(context);\n\n      checkArraySizeType(expectedSize);\n    }\n\n    if (!isLengthInBytes) {\n      checkArraySize(expectedSize, items.length);\n    }\n\n    if (isLengthInBytes) {\n      const lengthContext = Metadata.clone(context);\n\n      for (const item of items) {\n        encodingLengthCommon(item, type, lengthContext);\n      }\n\n      if (istype) {\n        expectedSize = lengthContext.bytes;\n      }\n\n      checkArraySize(lengthContext.bytes, expectedSize);\n      Metadata.clean(lengthContext);\n    }\n\n    if (istype) {\n      length.encode.call(context, expectedSize, wstream);\n      encode.bytes += length.encode.bytes;\n    }\n\n    items.forEach(item => {\n      encodeCommon(item, wstream, type, context);\n    });\n\n    encode.bytes += context.bytes;\n    Metadata.clean(context);\n  }\n\n  /**\n   * Decode array from stream.\n   * @param {DecodeStream} rstream\n   * @returns {any[]}\n   */\n  function decode(rstream) {\n    let expectedSize = 0;\n    decode.bytes = 0;\n\n    // eslint-disable-next-line no-invalid-this\n    const context = Metadata.clone(this);\n\n    if (isnum) {\n      expectedSize = length;\n    } else if (istype) {\n      expectedSize = length.decode.call(context, rstream);\n      decode.bytes += length.decode.bytes;\n    } else if (isfunc) {\n      expectedSize = length(context);\n    }\n\n    checkArraySizeType(expectedSize);\n\n    let values;\n\n    if (isLengthInBytes) {\n      values = decodeBytes(type, expectedSize, rstream, context);\n    } else {\n      values = decodeCount(type, expectedSize, rstream, context);\n    }\n\n    decode.bytes += context.bytes;\n    Metadata.clean(context);\n    return values;\n  }\n\n  /**\n   * Returns the number of bytes of an encoded items.\n   * @param {any[]} items\n   * @returns {number}\n   */\n  function encodingLength(items) {\n    checkArray(items);\n\n    // eslint-disable-next-line no-invalid-this\n    const context = Metadata.clone(this);\n\n    let size = 0;\n\n    if (isnum && isLengthInBytes) {\n      return length;\n    }\n\n    if (istype && !isLengthInBytes) {\n      size = length.encodingLength(items.length);\n    }\n\n    for (const item of items) {\n      encodingLengthCommon(item, type, context);\n    }\n\n    Metadata.clean(context);\n    size += context.bytes;\n\n    if (istype && isLengthInBytes) {\n      size += length.encodingLength(size);\n    }\n\n    return size;\n  }\n}\n\n/**\n * Check if argument is an Array.\n * @param {*} items\n * @private\n */\nfunction checkArray(items) {\n  if (!Array.isArray(items)) {\n    throw new TypeError('Argument #1 should be an Array.');\n  }\n}\n\n/**\n * Check if argument is a number.\n * @param {*} length\n * @private\n */\nfunction checkArraySizeType(length) {\n  if (typeof length !== 'number') {\n    throw new TypeError('Length of an array should be a number.');\n  }\n}\n\n/**\n * Check the number of items in an Array.\n * @param {number} requiredSize\n * @param {number} havingSize\n * @private\n */\nfunction checkArraySize(requiredSize, havingSize) {\n  if (requiredSize !== havingSize) {\n    throw new Error(\n      `Argument #1 required length ${requiredSize} instead of ${havingSize}`\n    );\n  }\n}\n\n/**\n * Decode items of an array when length is the number of bytes.\n * @param {Object} type Type of each array's item - user schema builtin type.\n * @param {number} lengthBytes\n * @param {DecodeStream} rstream\n * @param {Metadata} context\n * @returns {any[]}\n * @private\n */\nfunction decodeBytes(type, lengthBytes, rstream, context) {\n  const items = [];\n  const before = context.bytes;\n  let bytes = 0;\n\n  while (bytes < lengthBytes) {\n    items.push(decodeCommon(rstream, type, context));\n    bytes = context.bytes - before;\n  }\n\n  if (bytes > lengthBytes) {\n    throw new Error('Incorrect length of an array.');\n  }\n\n  return items;\n}\n\n/**\n * Decode items of an array when length is the number of items.\n * @param {Object} type Type of each array's item - user schema builtin type.\n * @param {number} length\n * @param {DecodeStream} rstream\n * @param {Metadata} context\n * @returns {any[]}\n * @private\n */\nfunction decodeCount(type, length, rstream, context) {\n  const items = new Array(length);\n\n  for (let i = 0; i < length; i += 1) {\n    items[i] = decodeCommon(rstream, type, context);\n  }\n\n  return items;\n}\n","import type { RtpHeader } from \"../rtp/rtp\";\n\nexport abstract class DePacketizerBase {\n  payload!: Buffer;\n  fragment?: Buffer;\n\n  static deSerialize(buf: Buffer, fragment?: Buffer) {\n    return {} as unknown as DePacketizerBase;\n  }\n\n  static isDetectedFinalPacketInSequence(header: RtpHeader) {\n    return true as boolean;\n  }\n\n  get isKeyframe() {\n    return true as boolean;\n  }\n}\n","export * from \"../../../common/src\";\n","module.exports = require(\"events\");","import { bufferWriter, bufferWriterLE } from \"../../../common/src\";\nimport type { RtpHeader } from \"../rtp/rtp\";\nimport type { DePacketizerBase } from \"./base\";\n\nexport class OpusRtpPayload implements DePacketizerBase {\n  payload!: Buffer;\n\n  static deSerialize(buf: Buffer) {\n    const opus = new OpusRtpPayload();\n    opus.payload = buf;\n    return opus;\n  }\n\n  static isDetectedFinalPacketInSequence(header: RtpHeader) {\n    return true;\n  }\n\n  get isKeyframe() {\n    return true;\n  }\n\n  static createCodecPrivate(samplingFrequency = 48000) {\n    return Buffer.concat([\n      Buffer.from(\"OpusHead\"),\n      bufferWriter([1, 1], [1, 2]),\n      bufferWriterLE([2, 4, 2, 1], [312, samplingFrequency, 0, 0]),\n    ]);\n  }\n}\n","(function(nacl) {\n'use strict';\n\n// Ported in 2014 by Dmitry Chestnykh and Devi Mandiri.\n// Public domain.\n//\n// Implementation derived from TweetNaCl version 20140427.\n// See for details: http://tweetnacl.cr.yp.to/\n\nvar gf = function(init) {\n  var i, r = new Float64Array(16);\n  if (init) for (i = 0; i < init.length; i++) r[i] = init[i];\n  return r;\n};\n\n//  Pluggable, initialized in high-level API below.\nvar randombytes = function(/* x, n */) { throw new Error('no PRNG'); };\n\nvar _0 = new Uint8Array(16);\nvar _9 = new Uint8Array(32); _9[0] = 9;\n\nvar gf0 = gf(),\n    gf1 = gf([1]),\n    _121665 = gf([0xdb41, 1]),\n    D = gf([0x78a3, 0x1359, 0x4dca, 0x75eb, 0xd8ab, 0x4141, 0x0a4d, 0x0070, 0xe898, 0x7779, 0x4079, 0x8cc7, 0xfe73, 0x2b6f, 0x6cee, 0x5203]),\n    D2 = gf([0xf159, 0x26b2, 0x9b94, 0xebd6, 0xb156, 0x8283, 0x149a, 0x00e0, 0xd130, 0xeef3, 0x80f2, 0x198e, 0xfce7, 0x56df, 0xd9dc, 0x2406]),\n    X = gf([0xd51a, 0x8f25, 0x2d60, 0xc956, 0xa7b2, 0x9525, 0xc760, 0x692c, 0xdc5c, 0xfdd6, 0xe231, 0xc0a4, 0x53fe, 0xcd6e, 0x36d3, 0x2169]),\n    Y = gf([0x6658, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666, 0x6666]),\n    I = gf([0xa0b0, 0x4a0e, 0x1b27, 0xc4ee, 0xe478, 0xad2f, 0x1806, 0x2f43, 0xd7a7, 0x3dfb, 0x0099, 0x2b4d, 0xdf0b, 0x4fc1, 0x2480, 0x2b83]);\n\nfunction ts64(x, i, h, l) {\n  x[i]   = (h >> 24) & 0xff;\n  x[i+1] = (h >> 16) & 0xff;\n  x[i+2] = (h >>  8) & 0xff;\n  x[i+3] = h & 0xff;\n  x[i+4] = (l >> 24)  & 0xff;\n  x[i+5] = (l >> 16)  & 0xff;\n  x[i+6] = (l >>  8)  & 0xff;\n  x[i+7] = l & 0xff;\n}\n\nfunction vn(x, xi, y, yi, n) {\n  var i,d = 0;\n  for (i = 0; i < n; i++) d |= x[xi+i]^y[yi+i];\n  return (1 & ((d - 1) >>> 8)) - 1;\n}\n\nfunction crypto_verify_16(x, xi, y, yi) {\n  return vn(x,xi,y,yi,16);\n}\n\nfunction crypto_verify_32(x, xi, y, yi) {\n  return vn(x,xi,y,yi,32);\n}\n\nfunction core_salsa20(o, p, k, c) {\n  var j0  = c[ 0] & 0xff | (c[ 1] & 0xff)<<8 | (c[ 2] & 0xff)<<16 | (c[ 3] & 0xff)<<24,\n      j1  = k[ 0] & 0xff | (k[ 1] & 0xff)<<8 | (k[ 2] & 0xff)<<16 | (k[ 3] & 0xff)<<24,\n      j2  = k[ 4] & 0xff | (k[ 5] & 0xff)<<8 | (k[ 6] & 0xff)<<16 | (k[ 7] & 0xff)<<24,\n      j3  = k[ 8] & 0xff | (k[ 9] & 0xff)<<8 | (k[10] & 0xff)<<16 | (k[11] & 0xff)<<24,\n      j4  = k[12] & 0xff | (k[13] & 0xff)<<8 | (k[14] & 0xff)<<16 | (k[15] & 0xff)<<24,\n      j5  = c[ 4] & 0xff | (c[ 5] & 0xff)<<8 | (c[ 6] & 0xff)<<16 | (c[ 7] & 0xff)<<24,\n      j6  = p[ 0] & 0xff | (p[ 1] & 0xff)<<8 | (p[ 2] & 0xff)<<16 | (p[ 3] & 0xff)<<24,\n      j7  = p[ 4] & 0xff | (p[ 5] & 0xff)<<8 | (p[ 6] & 0xff)<<16 | (p[ 7] & 0xff)<<24,\n      j8  = p[ 8] & 0xff | (p[ 9] & 0xff)<<8 | (p[10] & 0xff)<<16 | (p[11] & 0xff)<<24,\n      j9  = p[12] & 0xff | (p[13] & 0xff)<<8 | (p[14] & 0xff)<<16 | (p[15] & 0xff)<<24,\n      j10 = c[ 8] & 0xff | (c[ 9] & 0xff)<<8 | (c[10] & 0xff)<<16 | (c[11] & 0xff)<<24,\n      j11 = k[16] & 0xff | (k[17] & 0xff)<<8 | (k[18] & 0xff)<<16 | (k[19] & 0xff)<<24,\n      j12 = k[20] & 0xff | (k[21] & 0xff)<<8 | (k[22] & 0xff)<<16 | (k[23] & 0xff)<<24,\n      j13 = k[24] & 0xff | (k[25] & 0xff)<<8 | (k[26] & 0xff)<<16 | (k[27] & 0xff)<<24,\n      j14 = k[28] & 0xff | (k[29] & 0xff)<<8 | (k[30] & 0xff)<<16 | (k[31] & 0xff)<<24,\n      j15 = c[12] & 0xff | (c[13] & 0xff)<<8 | (c[14] & 0xff)<<16 | (c[15] & 0xff)<<24;\n\n  var x0 = j0, x1 = j1, x2 = j2, x3 = j3, x4 = j4, x5 = j5, x6 = j6, x7 = j7,\n      x8 = j8, x9 = j9, x10 = j10, x11 = j11, x12 = j12, x13 = j13, x14 = j14,\n      x15 = j15, u;\n\n  for (var i = 0; i < 20; i += 2) {\n    u = x0 + x12 | 0;\n    x4 ^= u<<7 | u>>>(32-7);\n    u = x4 + x0 | 0;\n    x8 ^= u<<9 | u>>>(32-9);\n    u = x8 + x4 | 0;\n    x12 ^= u<<13 | u>>>(32-13);\n    u = x12 + x8 | 0;\n    x0 ^= u<<18 | u>>>(32-18);\n\n    u = x5 + x1 | 0;\n    x9 ^= u<<7 | u>>>(32-7);\n    u = x9 + x5 | 0;\n    x13 ^= u<<9 | u>>>(32-9);\n    u = x13 + x9 | 0;\n    x1 ^= u<<13 | u>>>(32-13);\n    u = x1 + x13 | 0;\n    x5 ^= u<<18 | u>>>(32-18);\n\n    u = x10 + x6 | 0;\n    x14 ^= u<<7 | u>>>(32-7);\n    u = x14 + x10 | 0;\n    x2 ^= u<<9 | u>>>(32-9);\n    u = x2 + x14 | 0;\n    x6 ^= u<<13 | u>>>(32-13);\n    u = x6 + x2 | 0;\n    x10 ^= u<<18 | u>>>(32-18);\n\n    u = x15 + x11 | 0;\n    x3 ^= u<<7 | u>>>(32-7);\n    u = x3 + x15 | 0;\n    x7 ^= u<<9 | u>>>(32-9);\n    u = x7 + x3 | 0;\n    x11 ^= u<<13 | u>>>(32-13);\n    u = x11 + x7 | 0;\n    x15 ^= u<<18 | u>>>(32-18);\n\n    u = x0 + x3 | 0;\n    x1 ^= u<<7 | u>>>(32-7);\n    u = x1 + x0 | 0;\n    x2 ^= u<<9 | u>>>(32-9);\n    u = x2 + x1 | 0;\n    x3 ^= u<<13 | u>>>(32-13);\n    u = x3 + x2 | 0;\n    x0 ^= u<<18 | u>>>(32-18);\n\n    u = x5 + x4 | 0;\n    x6 ^= u<<7 | u>>>(32-7);\n    u = x6 + x5 | 0;\n    x7 ^= u<<9 | u>>>(32-9);\n    u = x7 + x6 | 0;\n    x4 ^= u<<13 | u>>>(32-13);\n    u = x4 + x7 | 0;\n    x5 ^= u<<18 | u>>>(32-18);\n\n    u = x10 + x9 | 0;\n    x11 ^= u<<7 | u>>>(32-7);\n    u = x11 + x10 | 0;\n    x8 ^= u<<9 | u>>>(32-9);\n    u = x8 + x11 | 0;\n    x9 ^= u<<13 | u>>>(32-13);\n    u = x9 + x8 | 0;\n    x10 ^= u<<18 | u>>>(32-18);\n\n    u = x15 + x14 | 0;\n    x12 ^= u<<7 | u>>>(32-7);\n    u = x12 + x15 | 0;\n    x13 ^= u<<9 | u>>>(32-9);\n    u = x13 + x12 | 0;\n    x14 ^= u<<13 | u>>>(32-13);\n    u = x14 + x13 | 0;\n    x15 ^= u<<18 | u>>>(32-18);\n  }\n   x0 =  x0 +  j0 | 0;\n   x1 =  x1 +  j1 | 0;\n   x2 =  x2 +  j2 | 0;\n   x3 =  x3 +  j3 | 0;\n   x4 =  x4 +  j4 | 0;\n   x5 =  x5 +  j5 | 0;\n   x6 =  x6 +  j6 | 0;\n   x7 =  x7 +  j7 | 0;\n   x8 =  x8 +  j8 | 0;\n   x9 =  x9 +  j9 | 0;\n  x10 = x10 + j10 | 0;\n  x11 = x11 + j11 | 0;\n  x12 = x12 + j12 | 0;\n  x13 = x13 + j13 | 0;\n  x14 = x14 + j14 | 0;\n  x15 = x15 + j15 | 0;\n\n  o[ 0] = x0 >>>  0 & 0xff;\n  o[ 1] = x0 >>>  8 & 0xff;\n  o[ 2] = x0 >>> 16 & 0xff;\n  o[ 3] = x0 >>> 24 & 0xff;\n\n  o[ 4] = x1 >>>  0 & 0xff;\n  o[ 5] = x1 >>>  8 & 0xff;\n  o[ 6] = x1 >>> 16 & 0xff;\n  o[ 7] = x1 >>> 24 & 0xff;\n\n  o[ 8] = x2 >>>  0 & 0xff;\n  o[ 9] = x2 >>>  8 & 0xff;\n  o[10] = x2 >>> 16 & 0xff;\n  o[11] = x2 >>> 24 & 0xff;\n\n  o[12] = x3 >>>  0 & 0xff;\n  o[13] = x3 >>>  8 & 0xff;\n  o[14] = x3 >>> 16 & 0xff;\n  o[15] = x3 >>> 24 & 0xff;\n\n  o[16] = x4 >>>  0 & 0xff;\n  o[17] = x4 >>>  8 & 0xff;\n  o[18] = x4 >>> 16 & 0xff;\n  o[19] = x4 >>> 24 & 0xff;\n\n  o[20] = x5 >>>  0 & 0xff;\n  o[21] = x5 >>>  8 & 0xff;\n  o[22] = x5 >>> 16 & 0xff;\n  o[23] = x5 >>> 24 & 0xff;\n\n  o[24] = x6 >>>  0 & 0xff;\n  o[25] = x6 >>>  8 & 0xff;\n  o[26] = x6 >>> 16 & 0xff;\n  o[27] = x6 >>> 24 & 0xff;\n\n  o[28] = x7 >>>  0 & 0xff;\n  o[29] = x7 >>>  8 & 0xff;\n  o[30] = x7 >>> 16 & 0xff;\n  o[31] = x7 >>> 24 & 0xff;\n\n  o[32] = x8 >>>  0 & 0xff;\n  o[33] = x8 >>>  8 & 0xff;\n  o[34] = x8 >>> 16 & 0xff;\n  o[35] = x8 >>> 24 & 0xff;\n\n  o[36] = x9 >>>  0 & 0xff;\n  o[37] = x9 >>>  8 & 0xff;\n  o[38] = x9 >>> 16 & 0xff;\n  o[39] = x9 >>> 24 & 0xff;\n\n  o[40] = x10 >>>  0 & 0xff;\n  o[41] = x10 >>>  8 & 0xff;\n  o[42] = x10 >>> 16 & 0xff;\n  o[43] = x10 >>> 24 & 0xff;\n\n  o[44] = x11 >>>  0 & 0xff;\n  o[45] = x11 >>>  8 & 0xff;\n  o[46] = x11 >>> 16 & 0xff;\n  o[47] = x11 >>> 24 & 0xff;\n\n  o[48] = x12 >>>  0 & 0xff;\n  o[49] = x12 >>>  8 & 0xff;\n  o[50] = x12 >>> 16 & 0xff;\n  o[51] = x12 >>> 24 & 0xff;\n\n  o[52] = x13 >>>  0 & 0xff;\n  o[53] = x13 >>>  8 & 0xff;\n  o[54] = x13 >>> 16 & 0xff;\n  o[55] = x13 >>> 24 & 0xff;\n\n  o[56] = x14 >>>  0 & 0xff;\n  o[57] = x14 >>>  8 & 0xff;\n  o[58] = x14 >>> 16 & 0xff;\n  o[59] = x14 >>> 24 & 0xff;\n\n  o[60] = x15 >>>  0 & 0xff;\n  o[61] = x15 >>>  8 & 0xff;\n  o[62] = x15 >>> 16 & 0xff;\n  o[63] = x15 >>> 24 & 0xff;\n}\n\nfunction core_hsalsa20(o,p,k,c) {\n  var j0  = c[ 0] & 0xff | (c[ 1] & 0xff)<<8 | (c[ 2] & 0xff)<<16 | (c[ 3] & 0xff)<<24,\n      j1  = k[ 0] & 0xff | (k[ 1] & 0xff)<<8 | (k[ 2] & 0xff)<<16 | (k[ 3] & 0xff)<<24,\n      j2  = k[ 4] & 0xff | (k[ 5] & 0xff)<<8 | (k[ 6] & 0xff)<<16 | (k[ 7] & 0xff)<<24,\n      j3  = k[ 8] & 0xff | (k[ 9] & 0xff)<<8 | (k[10] & 0xff)<<16 | (k[11] & 0xff)<<24,\n      j4  = k[12] & 0xff | (k[13] & 0xff)<<8 | (k[14] & 0xff)<<16 | (k[15] & 0xff)<<24,\n      j5  = c[ 4] & 0xff | (c[ 5] & 0xff)<<8 | (c[ 6] & 0xff)<<16 | (c[ 7] & 0xff)<<24,\n      j6  = p[ 0] & 0xff | (p[ 1] & 0xff)<<8 | (p[ 2] & 0xff)<<16 | (p[ 3] & 0xff)<<24,\n      j7  = p[ 4] & 0xff | (p[ 5] & 0xff)<<8 | (p[ 6] & 0xff)<<16 | (p[ 7] & 0xff)<<24,\n      j8  = p[ 8] & 0xff | (p[ 9] & 0xff)<<8 | (p[10] & 0xff)<<16 | (p[11] & 0xff)<<24,\n      j9  = p[12] & 0xff | (p[13] & 0xff)<<8 | (p[14] & 0xff)<<16 | (p[15] & 0xff)<<24,\n      j10 = c[ 8] & 0xff | (c[ 9] & 0xff)<<8 | (c[10] & 0xff)<<16 | (c[11] & 0xff)<<24,\n      j11 = k[16] & 0xff | (k[17] & 0xff)<<8 | (k[18] & 0xff)<<16 | (k[19] & 0xff)<<24,\n      j12 = k[20] & 0xff | (k[21] & 0xff)<<8 | (k[22] & 0xff)<<16 | (k[23] & 0xff)<<24,\n      j13 = k[24] & 0xff | (k[25] & 0xff)<<8 | (k[26] & 0xff)<<16 | (k[27] & 0xff)<<24,\n      j14 = k[28] & 0xff | (k[29] & 0xff)<<8 | (k[30] & 0xff)<<16 | (k[31] & 0xff)<<24,\n      j15 = c[12] & 0xff | (c[13] & 0xff)<<8 | (c[14] & 0xff)<<16 | (c[15] & 0xff)<<24;\n\n  var x0 = j0, x1 = j1, x2 = j2, x3 = j3, x4 = j4, x5 = j5, x6 = j6, x7 = j7,\n      x8 = j8, x9 = j9, x10 = j10, x11 = j11, x12 = j12, x13 = j13, x14 = j14,\n      x15 = j15, u;\n\n  for (var i = 0; i < 20; i += 2) {\n    u = x0 + x12 | 0;\n    x4 ^= u<<7 | u>>>(32-7);\n    u = x4 + x0 | 0;\n    x8 ^= u<<9 | u>>>(32-9);\n    u = x8 + x4 | 0;\n    x12 ^= u<<13 | u>>>(32-13);\n    u = x12 + x8 | 0;\n    x0 ^= u<<18 | u>>>(32-18);\n\n    u = x5 + x1 | 0;\n    x9 ^= u<<7 | u>>>(32-7);\n    u = x9 + x5 | 0;\n    x13 ^= u<<9 | u>>>(32-9);\n    u = x13 + x9 | 0;\n    x1 ^= u<<13 | u>>>(32-13);\n    u = x1 + x13 | 0;\n    x5 ^= u<<18 | u>>>(32-18);\n\n    u = x10 + x6 | 0;\n    x14 ^= u<<7 | u>>>(32-7);\n    u = x14 + x10 | 0;\n    x2 ^= u<<9 | u>>>(32-9);\n    u = x2 + x14 | 0;\n    x6 ^= u<<13 | u>>>(32-13);\n    u = x6 + x2 | 0;\n    x10 ^= u<<18 | u>>>(32-18);\n\n    u = x15 + x11 | 0;\n    x3 ^= u<<7 | u>>>(32-7);\n    u = x3 + x15 | 0;\n    x7 ^= u<<9 | u>>>(32-9);\n    u = x7 + x3 | 0;\n    x11 ^= u<<13 | u>>>(32-13);\n    u = x11 + x7 | 0;\n    x15 ^= u<<18 | u>>>(32-18);\n\n    u = x0 + x3 | 0;\n    x1 ^= u<<7 | u>>>(32-7);\n    u = x1 + x0 | 0;\n    x2 ^= u<<9 | u>>>(32-9);\n    u = x2 + x1 | 0;\n    x3 ^= u<<13 | u>>>(32-13);\n    u = x3 + x2 | 0;\n    x0 ^= u<<18 | u>>>(32-18);\n\n    u = x5 + x4 | 0;\n    x6 ^= u<<7 | u>>>(32-7);\n    u = x6 + x5 | 0;\n    x7 ^= u<<9 | u>>>(32-9);\n    u = x7 + x6 | 0;\n    x4 ^= u<<13 | u>>>(32-13);\n    u = x4 + x7 | 0;\n    x5 ^= u<<18 | u>>>(32-18);\n\n    u = x10 + x9 | 0;\n    x11 ^= u<<7 | u>>>(32-7);\n    u = x11 + x10 | 0;\n    x8 ^= u<<9 | u>>>(32-9);\n    u = x8 + x11 | 0;\n    x9 ^= u<<13 | u>>>(32-13);\n    u = x9 + x8 | 0;\n    x10 ^= u<<18 | u>>>(32-18);\n\n    u = x15 + x14 | 0;\n    x12 ^= u<<7 | u>>>(32-7);\n    u = x12 + x15 | 0;\n    x13 ^= u<<9 | u>>>(32-9);\n    u = x13 + x12 | 0;\n    x14 ^= u<<13 | u>>>(32-13);\n    u = x14 + x13 | 0;\n    x15 ^= u<<18 | u>>>(32-18);\n  }\n\n  o[ 0] = x0 >>>  0 & 0xff;\n  o[ 1] = x0 >>>  8 & 0xff;\n  o[ 2] = x0 >>> 16 & 0xff;\n  o[ 3] = x0 >>> 24 & 0xff;\n\n  o[ 4] = x5 >>>  0 & 0xff;\n  o[ 5] = x5 >>>  8 & 0xff;\n  o[ 6] = x5 >>> 16 & 0xff;\n  o[ 7] = x5 >>> 24 & 0xff;\n\n  o[ 8] = x10 >>>  0 & 0xff;\n  o[ 9] = x10 >>>  8 & 0xff;\n  o[10] = x10 >>> 16 & 0xff;\n  o[11] = x10 >>> 24 & 0xff;\n\n  o[12] = x15 >>>  0 & 0xff;\n  o[13] = x15 >>>  8 & 0xff;\n  o[14] = x15 >>> 16 & 0xff;\n  o[15] = x15 >>> 24 & 0xff;\n\n  o[16] = x6 >>>  0 & 0xff;\n  o[17] = x6 >>>  8 & 0xff;\n  o[18] = x6 >>> 16 & 0xff;\n  o[19] = x6 >>> 24 & 0xff;\n\n  o[20] = x7 >>>  0 & 0xff;\n  o[21] = x7 >>>  8 & 0xff;\n  o[22] = x7 >>> 16 & 0xff;\n  o[23] = x7 >>> 24 & 0xff;\n\n  o[24] = x8 >>>  0 & 0xff;\n  o[25] = x8 >>>  8 & 0xff;\n  o[26] = x8 >>> 16 & 0xff;\n  o[27] = x8 >>> 24 & 0xff;\n\n  o[28] = x9 >>>  0 & 0xff;\n  o[29] = x9 >>>  8 & 0xff;\n  o[30] = x9 >>> 16 & 0xff;\n  o[31] = x9 >>> 24 & 0xff;\n}\n\nfunction crypto_core_salsa20(out,inp,k,c) {\n  core_salsa20(out,inp,k,c);\n}\n\nfunction crypto_core_hsalsa20(out,inp,k,c) {\n  core_hsalsa20(out,inp,k,c);\n}\n\nvar sigma = new Uint8Array([101, 120, 112, 97, 110, 100, 32, 51, 50, 45, 98, 121, 116, 101, 32, 107]);\n            // \"expand 32-byte k\"\n\nfunction crypto_stream_salsa20_xor(c,cpos,m,mpos,b,n,k) {\n  var z = new Uint8Array(16), x = new Uint8Array(64);\n  var u, i;\n  for (i = 0; i < 16; i++) z[i] = 0;\n  for (i = 0; i < 8; i++) z[i] = n[i];\n  while (b >= 64) {\n    crypto_core_salsa20(x,z,k,sigma);\n    for (i = 0; i < 64; i++) c[cpos+i] = m[mpos+i] ^ x[i];\n    u = 1;\n    for (i = 8; i < 16; i++) {\n      u = u + (z[i] & 0xff) | 0;\n      z[i] = u & 0xff;\n      u >>>= 8;\n    }\n    b -= 64;\n    cpos += 64;\n    mpos += 64;\n  }\n  if (b > 0) {\n    crypto_core_salsa20(x,z,k,sigma);\n    for (i = 0; i < b; i++) c[cpos+i] = m[mpos+i] ^ x[i];\n  }\n  return 0;\n}\n\nfunction crypto_stream_salsa20(c,cpos,b,n,k) {\n  var z = new Uint8Array(16), x = new Uint8Array(64);\n  var u, i;\n  for (i = 0; i < 16; i++) z[i] = 0;\n  for (i = 0; i < 8; i++) z[i] = n[i];\n  while (b >= 64) {\n    crypto_core_salsa20(x,z,k,sigma);\n    for (i = 0; i < 64; i++) c[cpos+i] = x[i];\n    u = 1;\n    for (i = 8; i < 16; i++) {\n      u = u + (z[i] & 0xff) | 0;\n      z[i] = u & 0xff;\n      u >>>= 8;\n    }\n    b -= 64;\n    cpos += 64;\n  }\n  if (b > 0) {\n    crypto_core_salsa20(x,z,k,sigma);\n    for (i = 0; i < b; i++) c[cpos+i] = x[i];\n  }\n  return 0;\n}\n\nfunction crypto_stream(c,cpos,d,n,k) {\n  var s = new Uint8Array(32);\n  crypto_core_hsalsa20(s,n,k,sigma);\n  var sn = new Uint8Array(8);\n  for (var i = 0; i < 8; i++) sn[i] = n[i+16];\n  return crypto_stream_salsa20(c,cpos,d,sn,s);\n}\n\nfunction crypto_stream_xor(c,cpos,m,mpos,d,n,k) {\n  var s = new Uint8Array(32);\n  crypto_core_hsalsa20(s,n,k,sigma);\n  var sn = new Uint8Array(8);\n  for (var i = 0; i < 8; i++) sn[i] = n[i+16];\n  return crypto_stream_salsa20_xor(c,cpos,m,mpos,d,sn,s);\n}\n\n/*\n* Port of Andrew Moon's Poly1305-donna-16. Public domain.\n* https://github.com/floodyberry/poly1305-donna\n*/\n\nvar poly1305 = function(key) {\n  this.buffer = new Uint8Array(16);\n  this.r = new Uint16Array(10);\n  this.h = new Uint16Array(10);\n  this.pad = new Uint16Array(8);\n  this.leftover = 0;\n  this.fin = 0;\n\n  var t0, t1, t2, t3, t4, t5, t6, t7;\n\n  t0 = key[ 0] & 0xff | (key[ 1] & 0xff) << 8; this.r[0] = ( t0                     ) & 0x1fff;\n  t1 = key[ 2] & 0xff | (key[ 3] & 0xff) << 8; this.r[1] = ((t0 >>> 13) | (t1 <<  3)) & 0x1fff;\n  t2 = key[ 4] & 0xff | (key[ 5] & 0xff) << 8; this.r[2] = ((t1 >>> 10) | (t2 <<  6)) & 0x1f03;\n  t3 = key[ 6] & 0xff | (key[ 7] & 0xff) << 8; this.r[3] = ((t2 >>>  7) | (t3 <<  9)) & 0x1fff;\n  t4 = key[ 8] & 0xff | (key[ 9] & 0xff) << 8; this.r[4] = ((t3 >>>  4) | (t4 << 12)) & 0x00ff;\n  this.r[5] = ((t4 >>>  1)) & 0x1ffe;\n  t5 = key[10] & 0xff | (key[11] & 0xff) << 8; this.r[6] = ((t4 >>> 14) | (t5 <<  2)) & 0x1fff;\n  t6 = key[12] & 0xff | (key[13] & 0xff) << 8; this.r[7] = ((t5 >>> 11) | (t6 <<  5)) & 0x1f81;\n  t7 = key[14] & 0xff | (key[15] & 0xff) << 8; this.r[8] = ((t6 >>>  8) | (t7 <<  8)) & 0x1fff;\n  this.r[9] = ((t7 >>>  5)) & 0x007f;\n\n  this.pad[0] = key[16] & 0xff | (key[17] & 0xff) << 8;\n  this.pad[1] = key[18] & 0xff | (key[19] & 0xff) << 8;\n  this.pad[2] = key[20] & 0xff | (key[21] & 0xff) << 8;\n  this.pad[3] = key[22] & 0xff | (key[23] & 0xff) << 8;\n  this.pad[4] = key[24] & 0xff | (key[25] & 0xff) << 8;\n  this.pad[5] = key[26] & 0xff | (key[27] & 0xff) << 8;\n  this.pad[6] = key[28] & 0xff | (key[29] & 0xff) << 8;\n  this.pad[7] = key[30] & 0xff | (key[31] & 0xff) << 8;\n};\n\npoly1305.prototype.blocks = function(m, mpos, bytes) {\n  var hibit = this.fin ? 0 : (1 << 11);\n  var t0, t1, t2, t3, t4, t5, t6, t7, c;\n  var d0, d1, d2, d3, d4, d5, d6, d7, d8, d9;\n\n  var h0 = this.h[0],\n      h1 = this.h[1],\n      h2 = this.h[2],\n      h3 = this.h[3],\n      h4 = this.h[4],\n      h5 = this.h[5],\n      h6 = this.h[6],\n      h7 = this.h[7],\n      h8 = this.h[8],\n      h9 = this.h[9];\n\n  var r0 = this.r[0],\n      r1 = this.r[1],\n      r2 = this.r[2],\n      r3 = this.r[3],\n      r4 = this.r[4],\n      r5 = this.r[5],\n      r6 = this.r[6],\n      r7 = this.r[7],\n      r8 = this.r[8],\n      r9 = this.r[9];\n\n  while (bytes >= 16) {\n    t0 = m[mpos+ 0] & 0xff | (m[mpos+ 1] & 0xff) << 8; h0 += ( t0                     ) & 0x1fff;\n    t1 = m[mpos+ 2] & 0xff | (m[mpos+ 3] & 0xff) << 8; h1 += ((t0 >>> 13) | (t1 <<  3)) & 0x1fff;\n    t2 = m[mpos+ 4] & 0xff | (m[mpos+ 5] & 0xff) << 8; h2 += ((t1 >>> 10) | (t2 <<  6)) & 0x1fff;\n    t3 = m[mpos+ 6] & 0xff | (m[mpos+ 7] & 0xff) << 8; h3 += ((t2 >>>  7) | (t3 <<  9)) & 0x1fff;\n    t4 = m[mpos+ 8] & 0xff | (m[mpos+ 9] & 0xff) << 8; h4 += ((t3 >>>  4) | (t4 << 12)) & 0x1fff;\n    h5 += ((t4 >>>  1)) & 0x1fff;\n    t5 = m[mpos+10] & 0xff | (m[mpos+11] & 0xff) << 8; h6 += ((t4 >>> 14) | (t5 <<  2)) & 0x1fff;\n    t6 = m[mpos+12] & 0xff | (m[mpos+13] & 0xff) << 8; h7 += ((t5 >>> 11) | (t6 <<  5)) & 0x1fff;\n    t7 = m[mpos+14] & 0xff | (m[mpos+15] & 0xff) << 8; h8 += ((t6 >>>  8) | (t7 <<  8)) & 0x1fff;\n    h9 += ((t7 >>> 5)) | hibit;\n\n    c = 0;\n\n    d0 = c;\n    d0 += h0 * r0;\n    d0 += h1 * (5 * r9);\n    d0 += h2 * (5 * r8);\n    d0 += h3 * (5 * r7);\n    d0 += h4 * (5 * r6);\n    c = (d0 >>> 13); d0 &= 0x1fff;\n    d0 += h5 * (5 * r5);\n    d0 += h6 * (5 * r4);\n    d0 += h7 * (5 * r3);\n    d0 += h8 * (5 * r2);\n    d0 += h9 * (5 * r1);\n    c += (d0 >>> 13); d0 &= 0x1fff;\n\n    d1 = c;\n    d1 += h0 * r1;\n    d1 += h1 * r0;\n    d1 += h2 * (5 * r9);\n    d1 += h3 * (5 * r8);\n    d1 += h4 * (5 * r7);\n    c = (d1 >>> 13); d1 &= 0x1fff;\n    d1 += h5 * (5 * r6);\n    d1 += h6 * (5 * r5);\n    d1 += h7 * (5 * r4);\n    d1 += h8 * (5 * r3);\n    d1 += h9 * (5 * r2);\n    c += (d1 >>> 13); d1 &= 0x1fff;\n\n    d2 = c;\n    d2 += h0 * r2;\n    d2 += h1 * r1;\n    d2 += h2 * r0;\n    d2 += h3 * (5 * r9);\n    d2 += h4 * (5 * r8);\n    c = (d2 >>> 13); d2 &= 0x1fff;\n    d2 += h5 * (5 * r7);\n    d2 += h6 * (5 * r6);\n    d2 += h7 * (5 * r5);\n    d2 += h8 * (5 * r4);\n    d2 += h9 * (5 * r3);\n    c += (d2 >>> 13); d2 &= 0x1fff;\n\n    d3 = c;\n    d3 += h0 * r3;\n    d3 += h1 * r2;\n    d3 += h2 * r1;\n    d3 += h3 * r0;\n    d3 += h4 * (5 * r9);\n    c = (d3 >>> 13); d3 &= 0x1fff;\n    d3 += h5 * (5 * r8);\n    d3 += h6 * (5 * r7);\n    d3 += h7 * (5 * r6);\n    d3 += h8 * (5 * r5);\n    d3 += h9 * (5 * r4);\n    c += (d3 >>> 13); d3 &= 0x1fff;\n\n    d4 = c;\n    d4 += h0 * r4;\n    d4 += h1 * r3;\n    d4 += h2 * r2;\n    d4 += h3 * r1;\n    d4 += h4 * r0;\n    c = (d4 >>> 13); d4 &= 0x1fff;\n    d4 += h5 * (5 * r9);\n    d4 += h6 * (5 * r8);\n    d4 += h7 * (5 * r7);\n    d4 += h8 * (5 * r6);\n    d4 += h9 * (5 * r5);\n    c += (d4 >>> 13); d4 &= 0x1fff;\n\n    d5 = c;\n    d5 += h0 * r5;\n    d5 += h1 * r4;\n    d5 += h2 * r3;\n    d5 += h3 * r2;\n    d5 += h4 * r1;\n    c = (d5 >>> 13); d5 &= 0x1fff;\n    d5 += h5 * r0;\n    d5 += h6 * (5 * r9);\n    d5 += h7 * (5 * r8);\n    d5 += h8 * (5 * r7);\n    d5 += h9 * (5 * r6);\n    c += (d5 >>> 13); d5 &= 0x1fff;\n\n    d6 = c;\n    d6 += h0 * r6;\n    d6 += h1 * r5;\n    d6 += h2 * r4;\n    d6 += h3 * r3;\n    d6 += h4 * r2;\n    c = (d6 >>> 13); d6 &= 0x1fff;\n    d6 += h5 * r1;\n    d6 += h6 * r0;\n    d6 += h7 * (5 * r9);\n    d6 += h8 * (5 * r8);\n    d6 += h9 * (5 * r7);\n    c += (d6 >>> 13); d6 &= 0x1fff;\n\n    d7 = c;\n    d7 += h0 * r7;\n    d7 += h1 * r6;\n    d7 += h2 * r5;\n    d7 += h3 * r4;\n    d7 += h4 * r3;\n    c = (d7 >>> 13); d7 &= 0x1fff;\n    d7 += h5 * r2;\n    d7 += h6 * r1;\n    d7 += h7 * r0;\n    d7 += h8 * (5 * r9);\n    d7 += h9 * (5 * r8);\n    c += (d7 >>> 13); d7 &= 0x1fff;\n\n    d8 = c;\n    d8 += h0 * r8;\n    d8 += h1 * r7;\n    d8 += h2 * r6;\n    d8 += h3 * r5;\n    d8 += h4 * r4;\n    c = (d8 >>> 13); d8 &= 0x1fff;\n    d8 += h5 * r3;\n    d8 += h6 * r2;\n    d8 += h7 * r1;\n    d8 += h8 * r0;\n    d8 += h9 * (5 * r9);\n    c += (d8 >>> 13); d8 &= 0x1fff;\n\n    d9 = c;\n    d9 += h0 * r9;\n    d9 += h1 * r8;\n    d9 += h2 * r7;\n    d9 += h3 * r6;\n    d9 += h4 * r5;\n    c = (d9 >>> 13); d9 &= 0x1fff;\n    d9 += h5 * r4;\n    d9 += h6 * r3;\n    d9 += h7 * r2;\n    d9 += h8 * r1;\n    d9 += h9 * r0;\n    c += (d9 >>> 13); d9 &= 0x1fff;\n\n    c = (((c << 2) + c)) | 0;\n    c = (c + d0) | 0;\n    d0 = c & 0x1fff;\n    c = (c >>> 13);\n    d1 += c;\n\n    h0 = d0;\n    h1 = d1;\n    h2 = d2;\n    h3 = d3;\n    h4 = d4;\n    h5 = d5;\n    h6 = d6;\n    h7 = d7;\n    h8 = d8;\n    h9 = d9;\n\n    mpos += 16;\n    bytes -= 16;\n  }\n  this.h[0] = h0;\n  this.h[1] = h1;\n  this.h[2] = h2;\n  this.h[3] = h3;\n  this.h[4] = h4;\n  this.h[5] = h5;\n  this.h[6] = h6;\n  this.h[7] = h7;\n  this.h[8] = h8;\n  this.h[9] = h9;\n};\n\npoly1305.prototype.finish = function(mac, macpos) {\n  var g = new Uint16Array(10);\n  var c, mask, f, i;\n\n  if (this.leftover) {\n    i = this.leftover;\n    this.buffer[i++] = 1;\n    for (; i < 16; i++) this.buffer[i] = 0;\n    this.fin = 1;\n    this.blocks(this.buffer, 0, 16);\n  }\n\n  c = this.h[1] >>> 13;\n  this.h[1] &= 0x1fff;\n  for (i = 2; i < 10; i++) {\n    this.h[i] += c;\n    c = this.h[i] >>> 13;\n    this.h[i] &= 0x1fff;\n  }\n  this.h[0] += (c * 5);\n  c = this.h[0] >>> 13;\n  this.h[0] &= 0x1fff;\n  this.h[1] += c;\n  c = this.h[1] >>> 13;\n  this.h[1] &= 0x1fff;\n  this.h[2] += c;\n\n  g[0] = this.h[0] + 5;\n  c = g[0] >>> 13;\n  g[0] &= 0x1fff;\n  for (i = 1; i < 10; i++) {\n    g[i] = this.h[i] + c;\n    c = g[i] >>> 13;\n    g[i] &= 0x1fff;\n  }\n  g[9] -= (1 << 13);\n\n  mask = (c ^ 1) - 1;\n  for (i = 0; i < 10; i++) g[i] &= mask;\n  mask = ~mask;\n  for (i = 0; i < 10; i++) this.h[i] = (this.h[i] & mask) | g[i];\n\n  this.h[0] = ((this.h[0]       ) | (this.h[1] << 13)                    ) & 0xffff;\n  this.h[1] = ((this.h[1] >>>  3) | (this.h[2] << 10)                    ) & 0xffff;\n  this.h[2] = ((this.h[2] >>>  6) | (this.h[3] <<  7)                    ) & 0xffff;\n  this.h[3] = ((this.h[3] >>>  9) | (this.h[4] <<  4)                    ) & 0xffff;\n  this.h[4] = ((this.h[4] >>> 12) | (this.h[5] <<  1) | (this.h[6] << 14)) & 0xffff;\n  this.h[5] = ((this.h[6] >>>  2) | (this.h[7] << 11)                    ) & 0xffff;\n  this.h[6] = ((this.h[7] >>>  5) | (this.h[8] <<  8)                    ) & 0xffff;\n  this.h[7] = ((this.h[8] >>>  8) | (this.h[9] <<  5)                    ) & 0xffff;\n\n  f = this.h[0] + this.pad[0];\n  this.h[0] = f & 0xffff;\n  for (i = 1; i < 8; i++) {\n    f = (((this.h[i] + this.pad[i]) | 0) + (f >>> 16)) | 0;\n    this.h[i] = f & 0xffff;\n  }\n\n  mac[macpos+ 0] = (this.h[0] >>> 0) & 0xff;\n  mac[macpos+ 1] = (this.h[0] >>> 8) & 0xff;\n  mac[macpos+ 2] = (this.h[1] >>> 0) & 0xff;\n  mac[macpos+ 3] = (this.h[1] >>> 8) & 0xff;\n  mac[macpos+ 4] = (this.h[2] >>> 0) & 0xff;\n  mac[macpos+ 5] = (this.h[2] >>> 8) & 0xff;\n  mac[macpos+ 6] = (this.h[3] >>> 0) & 0xff;\n  mac[macpos+ 7] = (this.h[3] >>> 8) & 0xff;\n  mac[macpos+ 8] = (this.h[4] >>> 0) & 0xff;\n  mac[macpos+ 9] = (this.h[4] >>> 8) & 0xff;\n  mac[macpos+10] = (this.h[5] >>> 0) & 0xff;\n  mac[macpos+11] = (this.h[5] >>> 8) & 0xff;\n  mac[macpos+12] = (this.h[6] >>> 0) & 0xff;\n  mac[macpos+13] = (this.h[6] >>> 8) & 0xff;\n  mac[macpos+14] = (this.h[7] >>> 0) & 0xff;\n  mac[macpos+15] = (this.h[7] >>> 8) & 0xff;\n};\n\npoly1305.prototype.update = function(m, mpos, bytes) {\n  var i, want;\n\n  if (this.leftover) {\n    want = (16 - this.leftover);\n    if (want > bytes)\n      want = bytes;\n    for (i = 0; i < want; i++)\n      this.buffer[this.leftover + i] = m[mpos+i];\n    bytes -= want;\n    mpos += want;\n    this.leftover += want;\n    if (this.leftover < 16)\n      return;\n    this.blocks(this.buffer, 0, 16);\n    this.leftover = 0;\n  }\n\n  if (bytes >= 16) {\n    want = bytes - (bytes % 16);\n    this.blocks(m, mpos, want);\n    mpos += want;\n    bytes -= want;\n  }\n\n  if (bytes) {\n    for (i = 0; i < bytes; i++)\n      this.buffer[this.leftover + i] = m[mpos+i];\n    this.leftover += bytes;\n  }\n};\n\nfunction crypto_onetimeauth(out, outpos, m, mpos, n, k) {\n  var s = new poly1305(k);\n  s.update(m, mpos, n);\n  s.finish(out, outpos);\n  return 0;\n}\n\nfunction crypto_onetimeauth_verify(h, hpos, m, mpos, n, k) {\n  var x = new Uint8Array(16);\n  crypto_onetimeauth(x,0,m,mpos,n,k);\n  return crypto_verify_16(h,hpos,x,0);\n}\n\nfunction crypto_secretbox(c,m,d,n,k) {\n  var i;\n  if (d < 32) return -1;\n  crypto_stream_xor(c,0,m,0,d,n,k);\n  crypto_onetimeauth(c, 16, c, 32, d - 32, c);\n  for (i = 0; i < 16; i++) c[i] = 0;\n  return 0;\n}\n\nfunction crypto_secretbox_open(m,c,d,n,k) {\n  var i;\n  var x = new Uint8Array(32);\n  if (d < 32) return -1;\n  crypto_stream(x,0,32,n,k);\n  if (crypto_onetimeauth_verify(c, 16,c, 32,d - 32,x) !== 0) return -1;\n  crypto_stream_xor(m,0,c,0,d,n,k);\n  for (i = 0; i < 32; i++) m[i] = 0;\n  return 0;\n}\n\nfunction set25519(r, a) {\n  var i;\n  for (i = 0; i < 16; i++) r[i] = a[i]|0;\n}\n\nfunction car25519(o) {\n  var i, v, c = 1;\n  for (i = 0; i < 16; i++) {\n    v = o[i] + c + 65535;\n    c = Math.floor(v / 65536);\n    o[i] = v - c * 65536;\n  }\n  o[0] += c-1 + 37 * (c-1);\n}\n\nfunction sel25519(p, q, b) {\n  var t, c = ~(b-1);\n  for (var i = 0; i < 16; i++) {\n    t = c & (p[i] ^ q[i]);\n    p[i] ^= t;\n    q[i] ^= t;\n  }\n}\n\nfunction pack25519(o, n) {\n  var i, j, b;\n  var m = gf(), t = gf();\n  for (i = 0; i < 16; i++) t[i] = n[i];\n  car25519(t);\n  car25519(t);\n  car25519(t);\n  for (j = 0; j < 2; j++) {\n    m[0] = t[0] - 0xffed;\n    for (i = 1; i < 15; i++) {\n      m[i] = t[i] - 0xffff - ((m[i-1]>>16) & 1);\n      m[i-1] &= 0xffff;\n    }\n    m[15] = t[15] - 0x7fff - ((m[14]>>16) & 1);\n    b = (m[15]>>16) & 1;\n    m[14] &= 0xffff;\n    sel25519(t, m, 1-b);\n  }\n  for (i = 0; i < 16; i++) {\n    o[2*i] = t[i] & 0xff;\n    o[2*i+1] = t[i]>>8;\n  }\n}\n\nfunction neq25519(a, b) {\n  var c = new Uint8Array(32), d = new Uint8Array(32);\n  pack25519(c, a);\n  pack25519(d, b);\n  return crypto_verify_32(c, 0, d, 0);\n}\n\nfunction par25519(a) {\n  var d = new Uint8Array(32);\n  pack25519(d, a);\n  return d[0] & 1;\n}\n\nfunction unpack25519(o, n) {\n  var i;\n  for (i = 0; i < 16; i++) o[i] = n[2*i] + (n[2*i+1] << 8);\n  o[15] &= 0x7fff;\n}\n\nfunction A(o, a, b) {\n  for (var i = 0; i < 16; i++) o[i] = a[i] + b[i];\n}\n\nfunction Z(o, a, b) {\n  for (var i = 0; i < 16; i++) o[i] = a[i] - b[i];\n}\n\nfunction M(o, a, b) {\n  var v, c,\n     t0 = 0,  t1 = 0,  t2 = 0,  t3 = 0,  t4 = 0,  t5 = 0,  t6 = 0,  t7 = 0,\n     t8 = 0,  t9 = 0, t10 = 0, t11 = 0, t12 = 0, t13 = 0, t14 = 0, t15 = 0,\n    t16 = 0, t17 = 0, t18 = 0, t19 = 0, t20 = 0, t21 = 0, t22 = 0, t23 = 0,\n    t24 = 0, t25 = 0, t26 = 0, t27 = 0, t28 = 0, t29 = 0, t30 = 0,\n    b0 = b[0],\n    b1 = b[1],\n    b2 = b[2],\n    b3 = b[3],\n    b4 = b[4],\n    b5 = b[5],\n    b6 = b[6],\n    b7 = b[7],\n    b8 = b[8],\n    b9 = b[9],\n    b10 = b[10],\n    b11 = b[11],\n    b12 = b[12],\n    b13 = b[13],\n    b14 = b[14],\n    b15 = b[15];\n\n  v = a[0];\n  t0 += v * b0;\n  t1 += v * b1;\n  t2 += v * b2;\n  t3 += v * b3;\n  t4 += v * b4;\n  t5 += v * b5;\n  t6 += v * b6;\n  t7 += v * b7;\n  t8 += v * b8;\n  t9 += v * b9;\n  t10 += v * b10;\n  t11 += v * b11;\n  t12 += v * b12;\n  t13 += v * b13;\n  t14 += v * b14;\n  t15 += v * b15;\n  v = a[1];\n  t1 += v * b0;\n  t2 += v * b1;\n  t3 += v * b2;\n  t4 += v * b3;\n  t5 += v * b4;\n  t6 += v * b5;\n  t7 += v * b6;\n  t8 += v * b7;\n  t9 += v * b8;\n  t10 += v * b9;\n  t11 += v * b10;\n  t12 += v * b11;\n  t13 += v * b12;\n  t14 += v * b13;\n  t15 += v * b14;\n  t16 += v * b15;\n  v = a[2];\n  t2 += v * b0;\n  t3 += v * b1;\n  t4 += v * b2;\n  t5 += v * b3;\n  t6 += v * b4;\n  t7 += v * b5;\n  t8 += v * b6;\n  t9 += v * b7;\n  t10 += v * b8;\n  t11 += v * b9;\n  t12 += v * b10;\n  t13 += v * b11;\n  t14 += v * b12;\n  t15 += v * b13;\n  t16 += v * b14;\n  t17 += v * b15;\n  v = a[3];\n  t3 += v * b0;\n  t4 += v * b1;\n  t5 += v * b2;\n  t6 += v * b3;\n  t7 += v * b4;\n  t8 += v * b5;\n  t9 += v * b6;\n  t10 += v * b7;\n  t11 += v * b8;\n  t12 += v * b9;\n  t13 += v * b10;\n  t14 += v * b11;\n  t15 += v * b12;\n  t16 += v * b13;\n  t17 += v * b14;\n  t18 += v * b15;\n  v = a[4];\n  t4 += v * b0;\n  t5 += v * b1;\n  t6 += v * b2;\n  t7 += v * b3;\n  t8 += v * b4;\n  t9 += v * b5;\n  t10 += v * b6;\n  t11 += v * b7;\n  t12 += v * b8;\n  t13 += v * b9;\n  t14 += v * b10;\n  t15 += v * b11;\n  t16 += v * b12;\n  t17 += v * b13;\n  t18 += v * b14;\n  t19 += v * b15;\n  v = a[5];\n  t5 += v * b0;\n  t6 += v * b1;\n  t7 += v * b2;\n  t8 += v * b3;\n  t9 += v * b4;\n  t10 += v * b5;\n  t11 += v * b6;\n  t12 += v * b7;\n  t13 += v * b8;\n  t14 += v * b9;\n  t15 += v * b10;\n  t16 += v * b11;\n  t17 += v * b12;\n  t18 += v * b13;\n  t19 += v * b14;\n  t20 += v * b15;\n  v = a[6];\n  t6 += v * b0;\n  t7 += v * b1;\n  t8 += v * b2;\n  t9 += v * b3;\n  t10 += v * b4;\n  t11 += v * b5;\n  t12 += v * b6;\n  t13 += v * b7;\n  t14 += v * b8;\n  t15 += v * b9;\n  t16 += v * b10;\n  t17 += v * b11;\n  t18 += v * b12;\n  t19 += v * b13;\n  t20 += v * b14;\n  t21 += v * b15;\n  v = a[7];\n  t7 += v * b0;\n  t8 += v * b1;\n  t9 += v * b2;\n  t10 += v * b3;\n  t11 += v * b4;\n  t12 += v * b5;\n  t13 += v * b6;\n  t14 += v * b7;\n  t15 += v * b8;\n  t16 += v * b9;\n  t17 += v * b10;\n  t18 += v * b11;\n  t19 += v * b12;\n  t20 += v * b13;\n  t21 += v * b14;\n  t22 += v * b15;\n  v = a[8];\n  t8 += v * b0;\n  t9 += v * b1;\n  t10 += v * b2;\n  t11 += v * b3;\n  t12 += v * b4;\n  t13 += v * b5;\n  t14 += v * b6;\n  t15 += v * b7;\n  t16 += v * b8;\n  t17 += v * b9;\n  t18 += v * b10;\n  t19 += v * b11;\n  t20 += v * b12;\n  t21 += v * b13;\n  t22 += v * b14;\n  t23 += v * b15;\n  v = a[9];\n  t9 += v * b0;\n  t10 += v * b1;\n  t11 += v * b2;\n  t12 += v * b3;\n  t13 += v * b4;\n  t14 += v * b5;\n  t15 += v * b6;\n  t16 += v * b7;\n  t17 += v * b8;\n  t18 += v * b9;\n  t19 += v * b10;\n  t20 += v * b11;\n  t21 += v * b12;\n  t22 += v * b13;\n  t23 += v * b14;\n  t24 += v * b15;\n  v = a[10];\n  t10 += v * b0;\n  t11 += v * b1;\n  t12 += v * b2;\n  t13 += v * b3;\n  t14 += v * b4;\n  t15 += v * b5;\n  t16 += v * b6;\n  t17 += v * b7;\n  t18 += v * b8;\n  t19 += v * b9;\n  t20 += v * b10;\n  t21 += v * b11;\n  t22 += v * b12;\n  t23 += v * b13;\n  t24 += v * b14;\n  t25 += v * b15;\n  v = a[11];\n  t11 += v * b0;\n  t12 += v * b1;\n  t13 += v * b2;\n  t14 += v * b3;\n  t15 += v * b4;\n  t16 += v * b5;\n  t17 += v * b6;\n  t18 += v * b7;\n  t19 += v * b8;\n  t20 += v * b9;\n  t21 += v * b10;\n  t22 += v * b11;\n  t23 += v * b12;\n  t24 += v * b13;\n  t25 += v * b14;\n  t26 += v * b15;\n  v = a[12];\n  t12 += v * b0;\n  t13 += v * b1;\n  t14 += v * b2;\n  t15 += v * b3;\n  t16 += v * b4;\n  t17 += v * b5;\n  t18 += v * b6;\n  t19 += v * b7;\n  t20 += v * b8;\n  t21 += v * b9;\n  t22 += v * b10;\n  t23 += v * b11;\n  t24 += v * b12;\n  t25 += v * b13;\n  t26 += v * b14;\n  t27 += v * b15;\n  v = a[13];\n  t13 += v * b0;\n  t14 += v * b1;\n  t15 += v * b2;\n  t16 += v * b3;\n  t17 += v * b4;\n  t18 += v * b5;\n  t19 += v * b6;\n  t20 += v * b7;\n  t21 += v * b8;\n  t22 += v * b9;\n  t23 += v * b10;\n  t24 += v * b11;\n  t25 += v * b12;\n  t26 += v * b13;\n  t27 += v * b14;\n  t28 += v * b15;\n  v = a[14];\n  t14 += v * b0;\n  t15 += v * b1;\n  t16 += v * b2;\n  t17 += v * b3;\n  t18 += v * b4;\n  t19 += v * b5;\n  t20 += v * b6;\n  t21 += v * b7;\n  t22 += v * b8;\n  t23 += v * b9;\n  t24 += v * b10;\n  t25 += v * b11;\n  t26 += v * b12;\n  t27 += v * b13;\n  t28 += v * b14;\n  t29 += v * b15;\n  v = a[15];\n  t15 += v * b0;\n  t16 += v * b1;\n  t17 += v * b2;\n  t18 += v * b3;\n  t19 += v * b4;\n  t20 += v * b5;\n  t21 += v * b6;\n  t22 += v * b7;\n  t23 += v * b8;\n  t24 += v * b9;\n  t25 += v * b10;\n  t26 += v * b11;\n  t27 += v * b12;\n  t28 += v * b13;\n  t29 += v * b14;\n  t30 += v * b15;\n\n  t0  += 38 * t16;\n  t1  += 38 * t17;\n  t2  += 38 * t18;\n  t3  += 38 * t19;\n  t4  += 38 * t20;\n  t5  += 38 * t21;\n  t6  += 38 * t22;\n  t7  += 38 * t23;\n  t8  += 38 * t24;\n  t9  += 38 * t25;\n  t10 += 38 * t26;\n  t11 += 38 * t27;\n  t12 += 38 * t28;\n  t13 += 38 * t29;\n  t14 += 38 * t30;\n  // t15 left as is\n\n  // first car\n  c = 1;\n  v =  t0 + c + 65535; c = Math.floor(v / 65536);  t0 = v - c * 65536;\n  v =  t1 + c + 65535; c = Math.floor(v / 65536);  t1 = v - c * 65536;\n  v =  t2 + c + 65535; c = Math.floor(v / 65536);  t2 = v - c * 65536;\n  v =  t3 + c + 65535; c = Math.floor(v / 65536);  t3 = v - c * 65536;\n  v =  t4 + c + 65535; c = Math.floor(v / 65536);  t4 = v - c * 65536;\n  v =  t5 + c + 65535; c = Math.floor(v / 65536);  t5 = v - c * 65536;\n  v =  t6 + c + 65535; c = Math.floor(v / 65536);  t6 = v - c * 65536;\n  v =  t7 + c + 65535; c = Math.floor(v / 65536);  t7 = v - c * 65536;\n  v =  t8 + c + 65535; c = Math.floor(v / 65536);  t8 = v - c * 65536;\n  v =  t9 + c + 65535; c = Math.floor(v / 65536);  t9 = v - c * 65536;\n  v = t10 + c + 65535; c = Math.floor(v / 65536); t10 = v - c * 65536;\n  v = t11 + c + 65535; c = Math.floor(v / 65536); t11 = v - c * 65536;\n  v = t12 + c + 65535; c = Math.floor(v / 65536); t12 = v - c * 65536;\n  v = t13 + c + 65535; c = Math.floor(v / 65536); t13 = v - c * 65536;\n  v = t14 + c + 65535; c = Math.floor(v / 65536); t14 = v - c * 65536;\n  v = t15 + c + 65535; c = Math.floor(v / 65536); t15 = v - c * 65536;\n  t0 += c-1 + 37 * (c-1);\n\n  // second car\n  c = 1;\n  v =  t0 + c + 65535; c = Math.floor(v / 65536);  t0 = v - c * 65536;\n  v =  t1 + c + 65535; c = Math.floor(v / 65536);  t1 = v - c * 65536;\n  v =  t2 + c + 65535; c = Math.floor(v / 65536);  t2 = v - c * 65536;\n  v =  t3 + c + 65535; c = Math.floor(v / 65536);  t3 = v - c * 65536;\n  v =  t4 + c + 65535; c = Math.floor(v / 65536);  t4 = v - c * 65536;\n  v =  t5 + c + 65535; c = Math.floor(v / 65536);  t5 = v - c * 65536;\n  v =  t6 + c + 65535; c = Math.floor(v / 65536);  t6 = v - c * 65536;\n  v =  t7 + c + 65535; c = Math.floor(v / 65536);  t7 = v - c * 65536;\n  v =  t8 + c + 65535; c = Math.floor(v / 65536);  t8 = v - c * 65536;\n  v =  t9 + c + 65535; c = Math.floor(v / 65536);  t9 = v - c * 65536;\n  v = t10 + c + 65535; c = Math.floor(v / 65536); t10 = v - c * 65536;\n  v = t11 + c + 65535; c = Math.floor(v / 65536); t11 = v - c * 65536;\n  v = t12 + c + 65535; c = Math.floor(v / 65536); t12 = v - c * 65536;\n  v = t13 + c + 65535; c = Math.floor(v / 65536); t13 = v - c * 65536;\n  v = t14 + c + 65535; c = Math.floor(v / 65536); t14 = v - c * 65536;\n  v = t15 + c + 65535; c = Math.floor(v / 65536); t15 = v - c * 65536;\n  t0 += c-1 + 37 * (c-1);\n\n  o[ 0] = t0;\n  o[ 1] = t1;\n  o[ 2] = t2;\n  o[ 3] = t3;\n  o[ 4] = t4;\n  o[ 5] = t5;\n  o[ 6] = t6;\n  o[ 7] = t7;\n  o[ 8] = t8;\n  o[ 9] = t9;\n  o[10] = t10;\n  o[11] = t11;\n  o[12] = t12;\n  o[13] = t13;\n  o[14] = t14;\n  o[15] = t15;\n}\n\nfunction S(o, a) {\n  M(o, a, a);\n}\n\nfunction inv25519(o, i) {\n  var c = gf();\n  var a;\n  for (a = 0; a < 16; a++) c[a] = i[a];\n  for (a = 253; a >= 0; a--) {\n    S(c, c);\n    if(a !== 2 && a !== 4) M(c, c, i);\n  }\n  for (a = 0; a < 16; a++) o[a] = c[a];\n}\n\nfunction pow2523(o, i) {\n  var c = gf();\n  var a;\n  for (a = 0; a < 16; a++) c[a] = i[a];\n  for (a = 250; a >= 0; a--) {\n      S(c, c);\n      if(a !== 1) M(c, c, i);\n  }\n  for (a = 0; a < 16; a++) o[a] = c[a];\n}\n\nfunction crypto_scalarmult(q, n, p) {\n  var z = new Uint8Array(32);\n  var x = new Float64Array(80), r, i;\n  var a = gf(), b = gf(), c = gf(),\n      d = gf(), e = gf(), f = gf();\n  for (i = 0; i < 31; i++) z[i] = n[i];\n  z[31]=(n[31]&127)|64;\n  z[0]&=248;\n  unpack25519(x,p);\n  for (i = 0; i < 16; i++) {\n    b[i]=x[i];\n    d[i]=a[i]=c[i]=0;\n  }\n  a[0]=d[0]=1;\n  for (i=254; i>=0; --i) {\n    r=(z[i>>>3]>>>(i&7))&1;\n    sel25519(a,b,r);\n    sel25519(c,d,r);\n    A(e,a,c);\n    Z(a,a,c);\n    A(c,b,d);\n    Z(b,b,d);\n    S(d,e);\n    S(f,a);\n    M(a,c,a);\n    M(c,b,e);\n    A(e,a,c);\n    Z(a,a,c);\n    S(b,a);\n    Z(c,d,f);\n    M(a,c,_121665);\n    A(a,a,d);\n    M(c,c,a);\n    M(a,d,f);\n    M(d,b,x);\n    S(b,e);\n    sel25519(a,b,r);\n    sel25519(c,d,r);\n  }\n  for (i = 0; i < 16; i++) {\n    x[i+16]=a[i];\n    x[i+32]=c[i];\n    x[i+48]=b[i];\n    x[i+64]=d[i];\n  }\n  var x32 = x.subarray(32);\n  var x16 = x.subarray(16);\n  inv25519(x32,x32);\n  M(x16,x16,x32);\n  pack25519(q,x16);\n  return 0;\n}\n\nfunction crypto_scalarmult_base(q, n) {\n  return crypto_scalarmult(q, n, _9);\n}\n\nfunction crypto_box_keypair(y, x) {\n  randombytes(x, 32);\n  return crypto_scalarmult_base(y, x);\n}\n\nfunction crypto_box_beforenm(k, y, x) {\n  var s = new Uint8Array(32);\n  crypto_scalarmult(s, x, y);\n  return crypto_core_hsalsa20(k, _0, s, sigma);\n}\n\nvar crypto_box_afternm = crypto_secretbox;\nvar crypto_box_open_afternm = crypto_secretbox_open;\n\nfunction crypto_box(c, m, d, n, y, x) {\n  var k = new Uint8Array(32);\n  crypto_box_beforenm(k, y, x);\n  return crypto_box_afternm(c, m, d, n, k);\n}\n\nfunction crypto_box_open(m, c, d, n, y, x) {\n  var k = new Uint8Array(32);\n  crypto_box_beforenm(k, y, x);\n  return crypto_box_open_afternm(m, c, d, n, k);\n}\n\nvar K = [\n  0x428a2f98, 0xd728ae22, 0x71374491, 0x23ef65cd,\n  0xb5c0fbcf, 0xec4d3b2f, 0xe9b5dba5, 0x8189dbbc,\n  0x3956c25b, 0xf348b538, 0x59f111f1, 0xb605d019,\n  0x923f82a4, 0xaf194f9b, 0xab1c5ed5, 0xda6d8118,\n  0xd807aa98, 0xa3030242, 0x12835b01, 0x45706fbe,\n  0x243185be, 0x4ee4b28c, 0x550c7dc3, 0xd5ffb4e2,\n  0x72be5d74, 0xf27b896f, 0x80deb1fe, 0x3b1696b1,\n  0x9bdc06a7, 0x25c71235, 0xc19bf174, 0xcf692694,\n  0xe49b69c1, 0x9ef14ad2, 0xefbe4786, 0x384f25e3,\n  0x0fc19dc6, 0x8b8cd5b5, 0x240ca1cc, 0x77ac9c65,\n  0x2de92c6f, 0x592b0275, 0x4a7484aa, 0x6ea6e483,\n  0x5cb0a9dc, 0xbd41fbd4, 0x76f988da, 0x831153b5,\n  0x983e5152, 0xee66dfab, 0xa831c66d, 0x2db43210,\n  0xb00327c8, 0x98fb213f, 0xbf597fc7, 0xbeef0ee4,\n  0xc6e00bf3, 0x3da88fc2, 0xd5a79147, 0x930aa725,\n  0x06ca6351, 0xe003826f, 0x14292967, 0x0a0e6e70,\n  0x27b70a85, 0x46d22ffc, 0x2e1b2138, 0x5c26c926,\n  0x4d2c6dfc, 0x5ac42aed, 0x53380d13, 0x9d95b3df,\n  0x650a7354, 0x8baf63de, 0x766a0abb, 0x3c77b2a8,\n  0x81c2c92e, 0x47edaee6, 0x92722c85, 0x1482353b,\n  0xa2bfe8a1, 0x4cf10364, 0xa81a664b, 0xbc423001,\n  0xc24b8b70, 0xd0f89791, 0xc76c51a3, 0x0654be30,\n  0xd192e819, 0xd6ef5218, 0xd6990624, 0x5565a910,\n  0xf40e3585, 0x5771202a, 0x106aa070, 0x32bbd1b8,\n  0x19a4c116, 0xb8d2d0c8, 0x1e376c08, 0x5141ab53,\n  0x2748774c, 0xdf8eeb99, 0x34b0bcb5, 0xe19b48a8,\n  0x391c0cb3, 0xc5c95a63, 0x4ed8aa4a, 0xe3418acb,\n  0x5b9cca4f, 0x7763e373, 0x682e6ff3, 0xd6b2b8a3,\n  0x748f82ee, 0x5defb2fc, 0x78a5636f, 0x43172f60,\n  0x84c87814, 0xa1f0ab72, 0x8cc70208, 0x1a6439ec,\n  0x90befffa, 0x23631e28, 0xa4506ceb, 0xde82bde9,\n  0xbef9a3f7, 0xb2c67915, 0xc67178f2, 0xe372532b,\n  0xca273ece, 0xea26619c, 0xd186b8c7, 0x21c0c207,\n  0xeada7dd6, 0xcde0eb1e, 0xf57d4f7f, 0xee6ed178,\n  0x06f067aa, 0x72176fba, 0x0a637dc5, 0xa2c898a6,\n  0x113f9804, 0xbef90dae, 0x1b710b35, 0x131c471b,\n  0x28db77f5, 0x23047d84, 0x32caab7b, 0x40c72493,\n  0x3c9ebe0a, 0x15c9bebc, 0x431d67c4, 0x9c100d4c,\n  0x4cc5d4be, 0xcb3e42b6, 0x597f299c, 0xfc657e2a,\n  0x5fcb6fab, 0x3ad6faec, 0x6c44198c, 0x4a475817\n];\n\nfunction crypto_hashblocks_hl(hh, hl, m, n) {\n  var wh = new Int32Array(16), wl = new Int32Array(16),\n      bh0, bh1, bh2, bh3, bh4, bh5, bh6, bh7,\n      bl0, bl1, bl2, bl3, bl4, bl5, bl6, bl7,\n      th, tl, i, j, h, l, a, b, c, d;\n\n  var ah0 = hh[0],\n      ah1 = hh[1],\n      ah2 = hh[2],\n      ah3 = hh[3],\n      ah4 = hh[4],\n      ah5 = hh[5],\n      ah6 = hh[6],\n      ah7 = hh[7],\n\n      al0 = hl[0],\n      al1 = hl[1],\n      al2 = hl[2],\n      al3 = hl[3],\n      al4 = hl[4],\n      al5 = hl[5],\n      al6 = hl[6],\n      al7 = hl[7];\n\n  var pos = 0;\n  while (n >= 128) {\n    for (i = 0; i < 16; i++) {\n      j = 8 * i + pos;\n      wh[i] = (m[j+0] << 24) | (m[j+1] << 16) | (m[j+2] << 8) | m[j+3];\n      wl[i] = (m[j+4] << 24) | (m[j+5] << 16) | (m[j+6] << 8) | m[j+7];\n    }\n    for (i = 0; i < 80; i++) {\n      bh0 = ah0;\n      bh1 = ah1;\n      bh2 = ah2;\n      bh3 = ah3;\n      bh4 = ah4;\n      bh5 = ah5;\n      bh6 = ah6;\n      bh7 = ah7;\n\n      bl0 = al0;\n      bl1 = al1;\n      bl2 = al2;\n      bl3 = al3;\n      bl4 = al4;\n      bl5 = al5;\n      bl6 = al6;\n      bl7 = al7;\n\n      // add\n      h = ah7;\n      l = al7;\n\n      a = l & 0xffff; b = l >>> 16;\n      c = h & 0xffff; d = h >>> 16;\n\n      // Sigma1\n      h = ((ah4 >>> 14) | (al4 << (32-14))) ^ ((ah4 >>> 18) | (al4 << (32-18))) ^ ((al4 >>> (41-32)) | (ah4 << (32-(41-32))));\n      l = ((al4 >>> 14) | (ah4 << (32-14))) ^ ((al4 >>> 18) | (ah4 << (32-18))) ^ ((ah4 >>> (41-32)) | (al4 << (32-(41-32))));\n\n      a += l & 0xffff; b += l >>> 16;\n      c += h & 0xffff; d += h >>> 16;\n\n      // Ch\n      h = (ah4 & ah5) ^ (~ah4 & ah6);\n      l = (al4 & al5) ^ (~al4 & al6);\n\n      a += l & 0xffff; b += l >>> 16;\n      c += h & 0xffff; d += h >>> 16;\n\n      // K\n      h = K[i*2];\n      l = K[i*2+1];\n\n      a += l & 0xffff; b += l >>> 16;\n      c += h & 0xffff; d += h >>> 16;\n\n      // w\n      h = wh[i%16];\n      l = wl[i%16];\n\n      a += l & 0xffff; b += l >>> 16;\n      c += h & 0xffff; d += h >>> 16;\n\n      b += a >>> 16;\n      c += b >>> 16;\n      d += c >>> 16;\n\n      th = c & 0xffff | d << 16;\n      tl = a & 0xffff | b << 16;\n\n      // add\n      h = th;\n      l = tl;\n\n      a = l & 0xffff; b = l >>> 16;\n      c = h & 0xffff; d = h >>> 16;\n\n      // Sigma0\n      h = ((ah0 >>> 28) | (al0 << (32-28))) ^ ((al0 >>> (34-32)) | (ah0 << (32-(34-32)))) ^ ((al0 >>> (39-32)) | (ah0 << (32-(39-32))));\n      l = ((al0 >>> 28) | (ah0 << (32-28))) ^ ((ah0 >>> (34-32)) | (al0 << (32-(34-32)))) ^ ((ah0 >>> (39-32)) | (al0 << (32-(39-32))));\n\n      a += l & 0xffff; b += l >>> 16;\n      c += h & 0xffff; d += h >>> 16;\n\n      // Maj\n      h = (ah0 & ah1) ^ (ah0 & ah2) ^ (ah1 & ah2);\n      l = (al0 & al1) ^ (al0 & al2) ^ (al1 & al2);\n\n      a += l & 0xffff; b += l >>> 16;\n      c += h & 0xffff; d += h >>> 16;\n\n      b += a >>> 16;\n      c += b >>> 16;\n      d += c >>> 16;\n\n      bh7 = (c & 0xffff) | (d << 16);\n      bl7 = (a & 0xffff) | (b << 16);\n\n      // add\n      h = bh3;\n      l = bl3;\n\n      a = l & 0xffff; b = l >>> 16;\n      c = h & 0xffff; d = h >>> 16;\n\n      h = th;\n      l = tl;\n\n      a += l & 0xffff; b += l >>> 16;\n      c += h & 0xffff; d += h >>> 16;\n\n      b += a >>> 16;\n      c += b >>> 16;\n      d += c >>> 16;\n\n      bh3 = (c & 0xffff) | (d << 16);\n      bl3 = (a & 0xffff) | (b << 16);\n\n      ah1 = bh0;\n      ah2 = bh1;\n      ah3 = bh2;\n      ah4 = bh3;\n      ah5 = bh4;\n      ah6 = bh5;\n      ah7 = bh6;\n      ah0 = bh7;\n\n      al1 = bl0;\n      al2 = bl1;\n      al3 = bl2;\n      al4 = bl3;\n      al5 = bl4;\n      al6 = bl5;\n      al7 = bl6;\n      al0 = bl7;\n\n      if (i%16 === 15) {\n        for (j = 0; j < 16; j++) {\n          // add\n          h = wh[j];\n          l = wl[j];\n\n          a = l & 0xffff; b = l >>> 16;\n          c = h & 0xffff; d = h >>> 16;\n\n          h = wh[(j+9)%16];\n          l = wl[(j+9)%16];\n\n          a += l & 0xffff; b += l >>> 16;\n          c += h & 0xffff; d += h >>> 16;\n\n          // sigma0\n          th = wh[(j+1)%16];\n          tl = wl[(j+1)%16];\n          h = ((th >>> 1) | (tl << (32-1))) ^ ((th >>> 8) | (tl << (32-8))) ^ (th >>> 7);\n          l = ((tl >>> 1) | (th << (32-1))) ^ ((tl >>> 8) | (th << (32-8))) ^ ((tl >>> 7) | (th << (32-7)));\n\n          a += l & 0xffff; b += l >>> 16;\n          c += h & 0xffff; d += h >>> 16;\n\n          // sigma1\n          th = wh[(j+14)%16];\n          tl = wl[(j+14)%16];\n          h = ((th >>> 19) | (tl << (32-19))) ^ ((tl >>> (61-32)) | (th << (32-(61-32)))) ^ (th >>> 6);\n          l = ((tl >>> 19) | (th << (32-19))) ^ ((th >>> (61-32)) | (tl << (32-(61-32)))) ^ ((tl >>> 6) | (th << (32-6)));\n\n          a += l & 0xffff; b += l >>> 16;\n          c += h & 0xffff; d += h >>> 16;\n\n          b += a >>> 16;\n          c += b >>> 16;\n          d += c >>> 16;\n\n          wh[j] = (c & 0xffff) | (d << 16);\n          wl[j] = (a & 0xffff) | (b << 16);\n        }\n      }\n    }\n\n    // add\n    h = ah0;\n    l = al0;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[0];\n    l = hl[0];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[0] = ah0 = (c & 0xffff) | (d << 16);\n    hl[0] = al0 = (a & 0xffff) | (b << 16);\n\n    h = ah1;\n    l = al1;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[1];\n    l = hl[1];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[1] = ah1 = (c & 0xffff) | (d << 16);\n    hl[1] = al1 = (a & 0xffff) | (b << 16);\n\n    h = ah2;\n    l = al2;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[2];\n    l = hl[2];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[2] = ah2 = (c & 0xffff) | (d << 16);\n    hl[2] = al2 = (a & 0xffff) | (b << 16);\n\n    h = ah3;\n    l = al3;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[3];\n    l = hl[3];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[3] = ah3 = (c & 0xffff) | (d << 16);\n    hl[3] = al3 = (a & 0xffff) | (b << 16);\n\n    h = ah4;\n    l = al4;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[4];\n    l = hl[4];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[4] = ah4 = (c & 0xffff) | (d << 16);\n    hl[4] = al4 = (a & 0xffff) | (b << 16);\n\n    h = ah5;\n    l = al5;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[5];\n    l = hl[5];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[5] = ah5 = (c & 0xffff) | (d << 16);\n    hl[5] = al5 = (a & 0xffff) | (b << 16);\n\n    h = ah6;\n    l = al6;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[6];\n    l = hl[6];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[6] = ah6 = (c & 0xffff) | (d << 16);\n    hl[6] = al6 = (a & 0xffff) | (b << 16);\n\n    h = ah7;\n    l = al7;\n\n    a = l & 0xffff; b = l >>> 16;\n    c = h & 0xffff; d = h >>> 16;\n\n    h = hh[7];\n    l = hl[7];\n\n    a += l & 0xffff; b += l >>> 16;\n    c += h & 0xffff; d += h >>> 16;\n\n    b += a >>> 16;\n    c += b >>> 16;\n    d += c >>> 16;\n\n    hh[7] = ah7 = (c & 0xffff) | (d << 16);\n    hl[7] = al7 = (a & 0xffff) | (b << 16);\n\n    pos += 128;\n    n -= 128;\n  }\n\n  return n;\n}\n\nfunction crypto_hash(out, m, n) {\n  var hh = new Int32Array(8),\n      hl = new Int32Array(8),\n      x = new Uint8Array(256),\n      i, b = n;\n\n  hh[0] = 0x6a09e667;\n  hh[1] = 0xbb67ae85;\n  hh[2] = 0x3c6ef372;\n  hh[3] = 0xa54ff53a;\n  hh[4] = 0x510e527f;\n  hh[5] = 0x9b05688c;\n  hh[6] = 0x1f83d9ab;\n  hh[7] = 0x5be0cd19;\n\n  hl[0] = 0xf3bcc908;\n  hl[1] = 0x84caa73b;\n  hl[2] = 0xfe94f82b;\n  hl[3] = 0x5f1d36f1;\n  hl[4] = 0xade682d1;\n  hl[5] = 0x2b3e6c1f;\n  hl[6] = 0xfb41bd6b;\n  hl[7] = 0x137e2179;\n\n  crypto_hashblocks_hl(hh, hl, m, n);\n  n %= 128;\n\n  for (i = 0; i < n; i++) x[i] = m[b-n+i];\n  x[n] = 128;\n\n  n = 256-128*(n<112?1:0);\n  x[n-9] = 0;\n  ts64(x, n-8,  (b / 0x20000000) | 0, b << 3);\n  crypto_hashblocks_hl(hh, hl, x, n);\n\n  for (i = 0; i < 8; i++) ts64(out, 8*i, hh[i], hl[i]);\n\n  return 0;\n}\n\nfunction add(p, q) {\n  var a = gf(), b = gf(), c = gf(),\n      d = gf(), e = gf(), f = gf(),\n      g = gf(), h = gf(), t = gf();\n\n  Z(a, p[1], p[0]);\n  Z(t, q[1], q[0]);\n  M(a, a, t);\n  A(b, p[0], p[1]);\n  A(t, q[0], q[1]);\n  M(b, b, t);\n  M(c, p[3], q[3]);\n  M(c, c, D2);\n  M(d, p[2], q[2]);\n  A(d, d, d);\n  Z(e, b, a);\n  Z(f, d, c);\n  A(g, d, c);\n  A(h, b, a);\n\n  M(p[0], e, f);\n  M(p[1], h, g);\n  M(p[2], g, f);\n  M(p[3], e, h);\n}\n\nfunction cswap(p, q, b) {\n  var i;\n  for (i = 0; i < 4; i++) {\n    sel25519(p[i], q[i], b);\n  }\n}\n\nfunction pack(r, p) {\n  var tx = gf(), ty = gf(), zi = gf();\n  inv25519(zi, p[2]);\n  M(tx, p[0], zi);\n  M(ty, p[1], zi);\n  pack25519(r, ty);\n  r[31] ^= par25519(tx) << 7;\n}\n\nfunction scalarmult(p, q, s) {\n  var b, i;\n  set25519(p[0], gf0);\n  set25519(p[1], gf1);\n  set25519(p[2], gf1);\n  set25519(p[3], gf0);\n  for (i = 255; i >= 0; --i) {\n    b = (s[(i/8)|0] >> (i&7)) & 1;\n    cswap(p, q, b);\n    add(q, p);\n    add(p, p);\n    cswap(p, q, b);\n  }\n}\n\nfunction scalarbase(p, s) {\n  var q = [gf(), gf(), gf(), gf()];\n  set25519(q[0], X);\n  set25519(q[1], Y);\n  set25519(q[2], gf1);\n  M(q[3], X, Y);\n  scalarmult(p, q, s);\n}\n\nfunction crypto_sign_keypair(pk, sk, seeded) {\n  var d = new Uint8Array(64);\n  var p = [gf(), gf(), gf(), gf()];\n  var i;\n\n  if (!seeded) randombytes(sk, 32);\n  crypto_hash(d, sk, 32);\n  d[0] &= 248;\n  d[31] &= 127;\n  d[31] |= 64;\n\n  scalarbase(p, d);\n  pack(pk, p);\n\n  for (i = 0; i < 32; i++) sk[i+32] = pk[i];\n  return 0;\n}\n\nvar L = new Float64Array([0xed, 0xd3, 0xf5, 0x5c, 0x1a, 0x63, 0x12, 0x58, 0xd6, 0x9c, 0xf7, 0xa2, 0xde, 0xf9, 0xde, 0x14, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0x10]);\n\nfunction modL(r, x) {\n  var carry, i, j, k;\n  for (i = 63; i >= 32; --i) {\n    carry = 0;\n    for (j = i - 32, k = i - 12; j < k; ++j) {\n      x[j] += carry - 16 * x[i] * L[j - (i - 32)];\n      carry = Math.floor((x[j] + 128) / 256);\n      x[j] -= carry * 256;\n    }\n    x[j] += carry;\n    x[i] = 0;\n  }\n  carry = 0;\n  for (j = 0; j < 32; j++) {\n    x[j] += carry - (x[31] >> 4) * L[j];\n    carry = x[j] >> 8;\n    x[j] &= 255;\n  }\n  for (j = 0; j < 32; j++) x[j] -= carry * L[j];\n  for (i = 0; i < 32; i++) {\n    x[i+1] += x[i] >> 8;\n    r[i] = x[i] & 255;\n  }\n}\n\nfunction reduce(r) {\n  var x = new Float64Array(64), i;\n  for (i = 0; i < 64; i++) x[i] = r[i];\n  for (i = 0; i < 64; i++) r[i] = 0;\n  modL(r, x);\n}\n\n// Note: difference from C - smlen returned, not passed as argument.\nfunction crypto_sign(sm, m, n, sk) {\n  var d = new Uint8Array(64), h = new Uint8Array(64), r = new Uint8Array(64);\n  var i, j, x = new Float64Array(64);\n  var p = [gf(), gf(), gf(), gf()];\n\n  crypto_hash(d, sk, 32);\n  d[0] &= 248;\n  d[31] &= 127;\n  d[31] |= 64;\n\n  var smlen = n + 64;\n  for (i = 0; i < n; i++) sm[64 + i] = m[i];\n  for (i = 0; i < 32; i++) sm[32 + i] = d[32 + i];\n\n  crypto_hash(r, sm.subarray(32), n+32);\n  reduce(r);\n  scalarbase(p, r);\n  pack(sm, p);\n\n  for (i = 32; i < 64; i++) sm[i] = sk[i];\n  crypto_hash(h, sm, n + 64);\n  reduce(h);\n\n  for (i = 0; i < 64; i++) x[i] = 0;\n  for (i = 0; i < 32; i++) x[i] = r[i];\n  for (i = 0; i < 32; i++) {\n    for (j = 0; j < 32; j++) {\n      x[i+j] += h[i] * d[j];\n    }\n  }\n\n  modL(sm.subarray(32), x);\n  return smlen;\n}\n\nfunction unpackneg(r, p) {\n  var t = gf(), chk = gf(), num = gf(),\n      den = gf(), den2 = gf(), den4 = gf(),\n      den6 = gf();\n\n  set25519(r[2], gf1);\n  unpack25519(r[1], p);\n  S(num, r[1]);\n  M(den, num, D);\n  Z(num, num, r[2]);\n  A(den, r[2], den);\n\n  S(den2, den);\n  S(den4, den2);\n  M(den6, den4, den2);\n  M(t, den6, num);\n  M(t, t, den);\n\n  pow2523(t, t);\n  M(t, t, num);\n  M(t, t, den);\n  M(t, t, den);\n  M(r[0], t, den);\n\n  S(chk, r[0]);\n  M(chk, chk, den);\n  if (neq25519(chk, num)) M(r[0], r[0], I);\n\n  S(chk, r[0]);\n  M(chk, chk, den);\n  if (neq25519(chk, num)) return -1;\n\n  if (par25519(r[0]) === (p[31]>>7)) Z(r[0], gf0, r[0]);\n\n  M(r[3], r[0], r[1]);\n  return 0;\n}\n\nfunction crypto_sign_open(m, sm, n, pk) {\n  var i;\n  var t = new Uint8Array(32), h = new Uint8Array(64);\n  var p = [gf(), gf(), gf(), gf()],\n      q = [gf(), gf(), gf(), gf()];\n\n  if (n < 64) return -1;\n\n  if (unpackneg(q, pk)) return -1;\n\n  for (i = 0; i < n; i++) m[i] = sm[i];\n  for (i = 0; i < 32; i++) m[i+32] = pk[i];\n  crypto_hash(h, m, n);\n  reduce(h);\n  scalarmult(p, q, h);\n\n  scalarbase(q, sm.subarray(32));\n  add(p, q);\n  pack(t, p);\n\n  n -= 64;\n  if (crypto_verify_32(sm, 0, t, 0)) {\n    for (i = 0; i < n; i++) m[i] = 0;\n    return -1;\n  }\n\n  for (i = 0; i < n; i++) m[i] = sm[i + 64];\n  return n;\n}\n\nvar crypto_secretbox_KEYBYTES = 32,\n    crypto_secretbox_NONCEBYTES = 24,\n    crypto_secretbox_ZEROBYTES = 32,\n    crypto_secretbox_BOXZEROBYTES = 16,\n    crypto_scalarmult_BYTES = 32,\n    crypto_scalarmult_SCALARBYTES = 32,\n    crypto_box_PUBLICKEYBYTES = 32,\n    crypto_box_SECRETKEYBYTES = 32,\n    crypto_box_BEFORENMBYTES = 32,\n    crypto_box_NONCEBYTES = crypto_secretbox_NONCEBYTES,\n    crypto_box_ZEROBYTES = crypto_secretbox_ZEROBYTES,\n    crypto_box_BOXZEROBYTES = crypto_secretbox_BOXZEROBYTES,\n    crypto_sign_BYTES = 64,\n    crypto_sign_PUBLICKEYBYTES = 32,\n    crypto_sign_SECRETKEYBYTES = 64,\n    crypto_sign_SEEDBYTES = 32,\n    crypto_hash_BYTES = 64;\n\nnacl.lowlevel = {\n  crypto_core_hsalsa20: crypto_core_hsalsa20,\n  crypto_stream_xor: crypto_stream_xor,\n  crypto_stream: crypto_stream,\n  crypto_stream_salsa20_xor: crypto_stream_salsa20_xor,\n  crypto_stream_salsa20: crypto_stream_salsa20,\n  crypto_onetimeauth: crypto_onetimeauth,\n  crypto_onetimeauth_verify: crypto_onetimeauth_verify,\n  crypto_verify_16: crypto_verify_16,\n  crypto_verify_32: crypto_verify_32,\n  crypto_secretbox: crypto_secretbox,\n  crypto_secretbox_open: crypto_secretbox_open,\n  crypto_scalarmult: crypto_scalarmult,\n  crypto_scalarmult_base: crypto_scalarmult_base,\n  crypto_box_beforenm: crypto_box_beforenm,\n  crypto_box_afternm: crypto_box_afternm,\n  crypto_box: crypto_box,\n  crypto_box_open: crypto_box_open,\n  crypto_box_keypair: crypto_box_keypair,\n  crypto_hash: crypto_hash,\n  crypto_sign: crypto_sign,\n  crypto_sign_keypair: crypto_sign_keypair,\n  crypto_sign_open: crypto_sign_open,\n\n  crypto_secretbox_KEYBYTES: crypto_secretbox_KEYBYTES,\n  crypto_secretbox_NONCEBYTES: crypto_secretbox_NONCEBYTES,\n  crypto_secretbox_ZEROBYTES: crypto_secretbox_ZEROBYTES,\n  crypto_secretbox_BOXZEROBYTES: crypto_secretbox_BOXZEROBYTES,\n  crypto_scalarmult_BYTES: crypto_scalarmult_BYTES,\n  crypto_scalarmult_SCALARBYTES: crypto_scalarmult_SCALARBYTES,\n  crypto_box_PUBLICKEYBYTES: crypto_box_PUBLICKEYBYTES,\n  crypto_box_SECRETKEYBYTES: crypto_box_SECRETKEYBYTES,\n  crypto_box_BEFORENMBYTES: crypto_box_BEFORENMBYTES,\n  crypto_box_NONCEBYTES: crypto_box_NONCEBYTES,\n  crypto_box_ZEROBYTES: crypto_box_ZEROBYTES,\n  crypto_box_BOXZEROBYTES: crypto_box_BOXZEROBYTES,\n  crypto_sign_BYTES: crypto_sign_BYTES,\n  crypto_sign_PUBLICKEYBYTES: crypto_sign_PUBLICKEYBYTES,\n  crypto_sign_SECRETKEYBYTES: crypto_sign_SECRETKEYBYTES,\n  crypto_sign_SEEDBYTES: crypto_sign_SEEDBYTES,\n  crypto_hash_BYTES: crypto_hash_BYTES,\n\n  gf: gf,\n  D: D,\n  L: L,\n  pack25519: pack25519,\n  unpack25519: unpack25519,\n  M: M,\n  A: A,\n  S: S,\n  Z: Z,\n  pow2523: pow2523,\n  add: add,\n  set25519: set25519,\n  modL: modL,\n  scalarmult: scalarmult,\n  scalarbase: scalarbase,\n};\n\n/* High-level API */\n\nfunction checkLengths(k, n) {\n  if (k.length !== crypto_secretbox_KEYBYTES) throw new Error('bad key size');\n  if (n.length !== crypto_secretbox_NONCEBYTES) throw new Error('bad nonce size');\n}\n\nfunction checkBoxLengths(pk, sk) {\n  if (pk.length !== crypto_box_PUBLICKEYBYTES) throw new Error('bad public key size');\n  if (sk.length !== crypto_box_SECRETKEYBYTES) throw new Error('bad secret key size');\n}\n\nfunction checkArrayTypes() {\n  for (var i = 0; i < arguments.length; i++) {\n    if (!(arguments[i] instanceof Uint8Array))\n      throw new TypeError('unexpected type, use Uint8Array');\n  }\n}\n\nfunction cleanup(arr) {\n  for (var i = 0; i < arr.length; i++) arr[i] = 0;\n}\n\nnacl.randomBytes = function(n) {\n  var b = new Uint8Array(n);\n  randombytes(b, n);\n  return b;\n};\n\nnacl.secretbox = function(msg, nonce, key) {\n  checkArrayTypes(msg, nonce, key);\n  checkLengths(key, nonce);\n  var m = new Uint8Array(crypto_secretbox_ZEROBYTES + msg.length);\n  var c = new Uint8Array(m.length);\n  for (var i = 0; i < msg.length; i++) m[i+crypto_secretbox_ZEROBYTES] = msg[i];\n  crypto_secretbox(c, m, m.length, nonce, key);\n  return c.subarray(crypto_secretbox_BOXZEROBYTES);\n};\n\nnacl.secretbox.open = function(box, nonce, key) {\n  checkArrayTypes(box, nonce, key);\n  checkLengths(key, nonce);\n  var c = new Uint8Array(crypto_secretbox_BOXZEROBYTES + box.length);\n  var m = new Uint8Array(c.length);\n  for (var i = 0; i < box.length; i++) c[i+crypto_secretbox_BOXZEROBYTES] = box[i];\n  if (c.length < 32) return null;\n  if (crypto_secretbox_open(m, c, c.length, nonce, key) !== 0) return null;\n  return m.subarray(crypto_secretbox_ZEROBYTES);\n};\n\nnacl.secretbox.keyLength = crypto_secretbox_KEYBYTES;\nnacl.secretbox.nonceLength = crypto_secretbox_NONCEBYTES;\nnacl.secretbox.overheadLength = crypto_secretbox_BOXZEROBYTES;\n\nnacl.scalarMult = function(n, p) {\n  checkArrayTypes(n, p);\n  if (n.length !== crypto_scalarmult_SCALARBYTES) throw new Error('bad n size');\n  if (p.length !== crypto_scalarmult_BYTES) throw new Error('bad p size');\n  var q = new Uint8Array(crypto_scalarmult_BYTES);\n  crypto_scalarmult(q, n, p);\n  return q;\n};\n\nnacl.scalarMult.base = function(n) {\n  checkArrayTypes(n);\n  if (n.length !== crypto_scalarmult_SCALARBYTES) throw new Error('bad n size');\n  var q = new Uint8Array(crypto_scalarmult_BYTES);\n  crypto_scalarmult_base(q, n);\n  return q;\n};\n\nnacl.scalarMult.scalarLength = crypto_scalarmult_SCALARBYTES;\nnacl.scalarMult.groupElementLength = crypto_scalarmult_BYTES;\n\nnacl.box = function(msg, nonce, publicKey, secretKey) {\n  var k = nacl.box.before(publicKey, secretKey);\n  return nacl.secretbox(msg, nonce, k);\n};\n\nnacl.box.before = function(publicKey, secretKey) {\n  checkArrayTypes(publicKey, secretKey);\n  checkBoxLengths(publicKey, secretKey);\n  var k = new Uint8Array(crypto_box_BEFORENMBYTES);\n  crypto_box_beforenm(k, publicKey, secretKey);\n  return k;\n};\n\nnacl.box.after = nacl.secretbox;\n\nnacl.box.open = function(msg, nonce, publicKey, secretKey) {\n  var k = nacl.box.before(publicKey, secretKey);\n  return nacl.secretbox.open(msg, nonce, k);\n};\n\nnacl.box.open.after = nacl.secretbox.open;\n\nnacl.box.keyPair = function() {\n  var pk = new Uint8Array(crypto_box_PUBLICKEYBYTES);\n  var sk = new Uint8Array(crypto_box_SECRETKEYBYTES);\n  crypto_box_keypair(pk, sk);\n  return {publicKey: pk, secretKey: sk};\n};\n\nnacl.box.keyPair.fromSecretKey = function(secretKey) {\n  checkArrayTypes(secretKey);\n  if (secretKey.length !== crypto_box_SECRETKEYBYTES)\n    throw new Error('bad secret key size');\n  var pk = new Uint8Array(crypto_box_PUBLICKEYBYTES);\n  crypto_scalarmult_base(pk, secretKey);\n  return {publicKey: pk, secretKey: new Uint8Array(secretKey)};\n};\n\nnacl.box.publicKeyLength = crypto_box_PUBLICKEYBYTES;\nnacl.box.secretKeyLength = crypto_box_SECRETKEYBYTES;\nnacl.box.sharedKeyLength = crypto_box_BEFORENMBYTES;\nnacl.box.nonceLength = crypto_box_NONCEBYTES;\nnacl.box.overheadLength = nacl.secretbox.overheadLength;\n\nnacl.sign = function(msg, secretKey) {\n  checkArrayTypes(msg, secretKey);\n  if (secretKey.length !== crypto_sign_SECRETKEYBYTES)\n    throw new Error('bad secret key size');\n  var signedMsg = new Uint8Array(crypto_sign_BYTES+msg.length);\n  crypto_sign(signedMsg, msg, msg.length, secretKey);\n  return signedMsg;\n};\n\nnacl.sign.open = function(signedMsg, publicKey) {\n  checkArrayTypes(signedMsg, publicKey);\n  if (publicKey.length !== crypto_sign_PUBLICKEYBYTES)\n    throw new Error('bad public key size');\n  var tmp = new Uint8Array(signedMsg.length);\n  var mlen = crypto_sign_open(tmp, signedMsg, signedMsg.length, publicKey);\n  if (mlen < 0) return null;\n  var m = new Uint8Array(mlen);\n  for (var i = 0; i < m.length; i++) m[i] = tmp[i];\n  return m;\n};\n\nnacl.sign.detached = function(msg, secretKey) {\n  var signedMsg = nacl.sign(msg, secretKey);\n  var sig = new Uint8Array(crypto_sign_BYTES);\n  for (var i = 0; i < sig.length; i++) sig[i] = signedMsg[i];\n  return sig;\n};\n\nnacl.sign.detached.verify = function(msg, sig, publicKey) {\n  checkArrayTypes(msg, sig, publicKey);\n  if (sig.length !== crypto_sign_BYTES)\n    throw new Error('bad signature size');\n  if (publicKey.length !== crypto_sign_PUBLICKEYBYTES)\n    throw new Error('bad public key size');\n  var sm = new Uint8Array(crypto_sign_BYTES + msg.length);\n  var m = new Uint8Array(crypto_sign_BYTES + msg.length);\n  var i;\n  for (i = 0; i < crypto_sign_BYTES; i++) sm[i] = sig[i];\n  for (i = 0; i < msg.length; i++) sm[i+crypto_sign_BYTES] = msg[i];\n  return (crypto_sign_open(m, sm, sm.length, publicKey) >= 0);\n};\n\nnacl.sign.keyPair = function() {\n  var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n  var sk = new Uint8Array(crypto_sign_SECRETKEYBYTES);\n  crypto_sign_keypair(pk, sk);\n  return {publicKey: pk, secretKey: sk};\n};\n\nnacl.sign.keyPair.fromSecretKey = function(secretKey) {\n  checkArrayTypes(secretKey);\n  if (secretKey.length !== crypto_sign_SECRETKEYBYTES)\n    throw new Error('bad secret key size');\n  var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n  for (var i = 0; i < pk.length; i++) pk[i] = secretKey[32+i];\n  return {publicKey: pk, secretKey: new Uint8Array(secretKey)};\n};\n\nnacl.sign.keyPair.fromSeed = function(seed) {\n  checkArrayTypes(seed);\n  if (seed.length !== crypto_sign_SEEDBYTES)\n    throw new Error('bad seed size');\n  var pk = new Uint8Array(crypto_sign_PUBLICKEYBYTES);\n  var sk = new Uint8Array(crypto_sign_SECRETKEYBYTES);\n  for (var i = 0; i < 32; i++) sk[i] = seed[i];\n  crypto_sign_keypair(pk, sk, true);\n  return {publicKey: pk, secretKey: sk};\n};\n\nnacl.sign.publicKeyLength = crypto_sign_PUBLICKEYBYTES;\nnacl.sign.secretKeyLength = crypto_sign_SECRETKEYBYTES;\nnacl.sign.seedLength = crypto_sign_SEEDBYTES;\nnacl.sign.signatureLength = crypto_sign_BYTES;\n\nnacl.hash = function(msg) {\n  checkArrayTypes(msg);\n  var h = new Uint8Array(crypto_hash_BYTES);\n  crypto_hash(h, msg, msg.length);\n  return h;\n};\n\nnacl.hash.hashLength = crypto_hash_BYTES;\n\nnacl.verify = function(x, y) {\n  checkArrayTypes(x, y);\n  // Zero length arguments are considered not equal.\n  if (x.length === 0 || y.length === 0) return false;\n  if (x.length !== y.length) return false;\n  return (vn(x, 0, y, 0, x.length) === 0) ? true : false;\n};\n\nnacl.setPRNG = function(fn) {\n  randombytes = fn;\n};\n\n(function() {\n  // Initialize PRNG if environment provides CSPRNG.\n  // If not, methods calling randombytes will throw.\n  var crypto = typeof self !== 'undefined' ? (self.crypto || self.msCrypto) : null;\n  if (crypto && crypto.getRandomValues) {\n    // Browsers.\n    var QUOTA = 65536;\n    nacl.setPRNG(function(x, n) {\n      var i, v = new Uint8Array(n);\n      for (i = 0; i < n; i += QUOTA) {\n        crypto.getRandomValues(v.subarray(i, i + Math.min(n - i, QUOTA)));\n      }\n      for (i = 0; i < n; i++) x[i] = v[i];\n      cleanup(v);\n    });\n  } else if (typeof require !== 'undefined') {\n    // Node.js.\n    crypto = require('crypto');\n    if (crypto && crypto.randomBytes) {\n      nacl.setPRNG(function(x, n) {\n        var i, v = crypto.randomBytes(n);\n        for (i = 0; i < n; i++) x[i] = v[i];\n        cleanup(v);\n      });\n    }\n  }\n})();\n\n})(typeof module !== 'undefined' && module.exports ? module.exports : (self.nacl = self.nacl || {}));\n","/**\n * WebRTC Statistics API implementation\n * Based on: https://www.w3.org/TR/webrtc-stats/\n */\n\nexport type RTCStatsType =\n  | \"codec\"\n  | \"inbound-rtp\"\n  | \"outbound-rtp\"\n  | \"remote-inbound-rtp\"\n  | \"remote-outbound-rtp\"\n  | \"media-source\"\n  | \"peer-connection\"\n  | \"data-channel\"\n  | \"transport\"\n  | \"candidate-pair\"\n  | \"local-candidate\"\n  | \"remote-candidate\"\n  | \"certificate\";\n\nexport interface RTCStats {\n  timestamp: number;\n  type: RTCStatsType;\n  id: string;\n}\n\nexport interface RTCRtpStreamStats extends RTCStats {\n  ssrc: number;\n  kind: string;\n  transportId?: string;\n  codecId?: string;\n}\n\nexport interface RTCReceivedRtpStreamStats extends RTCRtpStreamStats {\n  packetsReceived?: number;\n  packetsLost?: number;\n  jitter?: number;\n  packetsDiscarded?: number;\n  packetsRepaired?: number;\n  burstPacketsLost?: number;\n  burstPacketsDiscarded?: number;\n  burstLossCount?: number;\n  burstDiscardCount?: number;\n  burstLossRate?: number;\n  burstDiscardRate?: number;\n  gapLossRate?: number;\n  gapDiscardRate?: number;\n  framesDropped?: number;\n  partialFramesLost?: number;\n  fullFramesLost?: number;\n}\n\nexport interface RTCInboundRtpStreamStats extends RTCReceivedRtpStreamStats {\n  type: \"inbound-rtp\";\n  trackIdentifier?: string;\n  mid?: string;\n  remoteId?: string;\n  framesDecoded?: number;\n  keyFramesDecoded?: number;\n  frameWidth?: number;\n  frameHeight?: number;\n  frameBitDepth?: number;\n  framesPerSecond?: number;\n  qpSum?: number;\n  totalDecodeTime?: number;\n  totalInterFrameDelay?: number;\n  totalSquaredInterFrameDelay?: number;\n  lastPacketReceivedTimestamp?: number;\n  headerBytesReceived?: number;\n  packetsFailedDecryption?: number;\n  packetsDuplicated?: number;\n  perDscpPacketsReceived?: Record<string, number>;\n  nackCount?: number;\n  firCount?: number;\n  pliCount?: number;\n  totalProcessingDelay?: number;\n  estimatedPlayoutTimestamp?: number;\n  jitterBufferDelay?: number;\n  jitterBufferTargetDelay?: number;\n  jitterBufferEmittedCount?: number;\n  jitterBufferMinimumDelay?: number;\n  totalSamplesReceived?: number;\n  concealedSamples?: number;\n  silentConcealedSamples?: number;\n  concealmentEvents?: number;\n  insertedSamplesForDeceleration?: number;\n  removedSamplesForAcceleration?: number;\n  audioLevel?: number;\n  totalAudioEnergy?: number;\n  totalSamplesDuration?: number;\n  framesReceived?: number;\n  decoderImplementation?: string;\n  playoutId?: string;\n  powerEfficientDecoder?: boolean;\n  framesAssembledFromMultiplePackets?: number;\n  totalAssemblyTime?: number;\n  retransmittedPacketsReceived?: number;\n  retransmittedBytesReceived?: number;\n  rtxSsrc?: number;\n  fecSsrc?: number;\n}\n\nexport interface RTCSentRtpStreamStats extends RTCRtpStreamStats {\n  packetsSent?: number;\n  bytesSent?: number;\n}\n\nexport interface RTCOutboundRtpStreamStats extends RTCSentRtpStreamStats {\n  type: \"outbound-rtp\";\n  mid?: string;\n  mediaSourceId?: string;\n  remoteId?: string;\n  rid?: string;\n  headerBytesSent?: number;\n  retransmittedPacketsSent?: number;\n  retransmittedBytesSent?: number;\n  rtxSsrc?: number;\n  targetBitrate?: number;\n  totalEncodedBytesTarget?: number;\n  frameWidth?: number;\n  frameHeight?: number;\n  frameBitDepth?: number;\n  framesPerSecond?: number;\n  framesSent?: number;\n  hugeFramesSent?: number;\n  framesEncoded?: number;\n  keyFramesEncoded?: number;\n  qpSum?: number;\n  totalEncodeTime?: number;\n  totalPacketSendDelay?: number;\n  qualityLimitationReason?: string;\n  qualityLimitationDurations?: Record<string, number>;\n  qualityLimitationResolutionChanges?: number;\n  perDscpPacketsSent?: Record<string, number>;\n  nackCount?: number;\n  firCount?: number;\n  pliCount?: number;\n  encoderImplementation?: string;\n  powerEfficientEncoder?: boolean;\n  active?: boolean;\n  scalabilityMode?: string;\n}\n\nexport interface RTCRemoteInboundRtpStreamStats\n  extends RTCReceivedRtpStreamStats {\n  type: \"remote-inbound-rtp\";\n  localId?: string;\n  roundTripTime?: number;\n  totalRoundTripTime?: number;\n  fractionLost?: number;\n  roundTripTimeMeasurements?: number;\n}\n\nexport interface RTCRemoteOutboundRtpStreamStats extends RTCSentRtpStreamStats {\n  type: \"remote-outbound-rtp\";\n  localId?: string;\n  remoteTimestamp?: number;\n  reportsSent?: number;\n  roundTripTime?: number;\n  totalRoundTripTime?: number;\n  roundTripTimeMeasurements?: number;\n}\n\nexport interface RTCMediaSourceStats extends RTCStats {\n  type: \"media-source\";\n  trackIdentifier: string;\n  kind: string;\n}\n\nexport interface RTCVideoSourceStats extends RTCMediaSourceStats {\n  width?: number;\n  height?: number;\n  frames?: number;\n  framesPerSecond?: number;\n}\n\nexport interface RTCAudioSourceStats extends RTCMediaSourceStats {\n  audioLevel?: number;\n  totalAudioEnergy?: number;\n  totalSamplesDuration?: number;\n  echoReturnLoss?: number;\n  echoReturnLossEnhancement?: number;\n  droppedSamplesDuration?: number;\n  droppedSamplesEvents?: number;\n  totalCaptureDelay?: number;\n  totalSamplesCaptured?: number;\n}\n\nexport interface RTCPeerConnectionStats extends RTCStats {\n  type: \"peer-connection\";\n  dataChannelsOpened?: number;\n  dataChannelsClosed?: number;\n}\n\nexport interface RTCDataChannelStats extends RTCStats {\n  type: \"data-channel\";\n  label?: string;\n  protocol?: string;\n  dataChannelIdentifier?: number;\n  state: RTCDataChannelState;\n  messagesSent?: number;\n  bytesSent?: number;\n  messagesReceived?: number;\n  bytesReceived?: number;\n}\n\nexport interface RTCTransportStats extends RTCStats {\n  type: \"transport\";\n  bytesSent?: number;\n  packetsSent?: number;\n  bytesReceived?: number;\n  packetsReceived?: number;\n  rtcpTransportStatsId?: string;\n  iceRole?: RTCIceRole;\n  iceLocalUsernameFragment?: string;\n  dtlsState: RTCDtlsTransportState;\n  iceState?: RTCIceTransportState;\n  selectedCandidatePairId?: string;\n  localCertificateId?: string;\n  remoteCertificateId?: string;\n  tlsVersion?: string;\n  dtlsCipher?: string;\n  dtlsRole?: RTCDtlsRole;\n  srtpCipher?: string;\n  selectedCandidatePairChanges?: number;\n  iceRestarts?: number;\n}\n\nexport interface RTCIceCandidateStats extends RTCStats {\n  transportId?: string;\n  address?: string;\n  port?: number;\n  protocol?: string;\n  candidateType: RTCIceCandidateType;\n  priority?: number;\n  url?: string;\n  relayProtocol?: string;\n  foundation?: string;\n  relatedAddress?: string;\n  relatedPort?: number;\n  usernameFragment?: string;\n  tcpType?: RTCIceTcpCandidateType;\n}\n\nexport interface RTCIceCandidatePairStats extends RTCStats {\n  type: \"candidate-pair\";\n  transportId?: string;\n  localCandidateId: string;\n  remoteCandidateId: string;\n  state: RTCStatsIceCandidatePairState;\n  nominated?: boolean;\n  packetsSent?: number;\n  packetsReceived?: number;\n  bytesSent?: number;\n  bytesReceived?: number;\n  lastPacketSentTimestamp?: number;\n  lastPacketReceivedTimestamp?: number;\n  totalRoundTripTime?: number;\n  currentRoundTripTime?: number;\n  availableOutgoingBitrate?: number;\n  availableIncomingBitrate?: number;\n  requestsReceived?: number;\n  requestsSent?: number;\n  responsesReceived?: number;\n  responsesSent?: number;\n  retransmissionsReceived?: number;\n  retransmissionsSent?: number;\n  consentRequestsSent?: number;\n  consentExpiredTimestamp?: number;\n  packetsDiscardedOnSend?: number;\n  bytesDiscardedOnSend?: number;\n}\n\nexport interface RTCCertificateStats extends RTCStats {\n  type: \"certificate\";\n  fingerprint: string;\n  fingerprintAlgorithm: string;\n  base64Certificate: string;\n  issuerCertificateId?: string;\n}\n\nexport interface RTCCodecStats extends RTCStats {\n  type: \"codec\";\n  payloadType: number;\n  transportId: string;\n  mimeType: string;\n  clockRate?: number;\n  channels?: number;\n  sdpFmtpLine?: string;\n}\n\n// Type definitions\nexport type RTCDataChannelState = \"connecting\" | \"open\" | \"closing\" | \"closed\";\nexport type RTCDtlsTransportState =\n  | \"new\"\n  | \"connecting\"\n  | \"connected\"\n  | \"closed\"\n  | \"failed\";\nexport type RTCIceTransportState =\n  | \"new\"\n  | \"checking\"\n  | \"connected\"\n  | \"completed\"\n  | \"disconnected\"\n  | \"failed\"\n  | \"closed\";\nexport type RTCIceRole = \"controlling\" | \"controlled\";\nexport type RTCDtlsRole = \"client\" | \"server\";\nexport type RTCIceCandidateType = \"host\" | \"srflx\" | \"prflx\" | \"relay\";\nexport type RTCIceTcpCandidateType = \"active\" | \"passive\" | \"so\";\nexport type RTCStatsIceCandidatePairState =\n  | \"frozen\"\n  | \"waiting\"\n  | \"in-progress\"\n  | \"failed\"\n  | \"succeeded\";\n\n/**\n * RTCStatsReport is a Map-like object that holds WebRTC statistics\n */\nexport class RTCStatsReport extends Map<string, RTCStats> {\n  constructor(stats?: Array<RTCStats>) {\n    super();\n    if (stats) {\n      for (const stat of stats) {\n        this.set(stat.id, stat);\n      }\n    }\n  }\n}\n\n/**\n * Generate a unique ID for a statistics object\n */\nexport function generateStatsId(\n  type: string,\n  ...parts: (string | number | undefined)[]\n): string {\n  const validParts = parts.filter((p) => p !== undefined);\n  return `${type}_${validParts.join(\"_\")}`;\n}\n\n/**\n * Get current timestamp in milliseconds (DOMHighResTimeStamp)\n */\nexport function getStatsTimestamp(): number {\n  return performance.now();\n}\n","import type { MediaDirection } from \"./rtpTransceiver\";\n\nexport interface RTCRtpParameters {\n  codecs: RTCRtpCodecParameters[];\n  headerExtensions: RTCRtpHeaderExtensionParameters[];\n  muxId?: string;\n  rtpStreamId?: string;\n  repairedRtpStreamId?: string;\n  rtcp?: RTCRtcpParameters;\n}\n\nexport type RTCPFB = { type: string; parameter?: string };\n\nexport class RTCRtpCodecParameters {\n  /**\n   * When specifying a codec with a fixed payloadType such as PCMU,\n   * it is necessary to set the correct PayloadType in RTCRtpCodecParameters in advance.\n   */\n  payloadType!: number;\n  mimeType!: string;\n  clockRate!: number;\n  channels?: number;\n  rtcpFeedback: RTCPFB[] = [];\n  parameters?: string;\n  direction: MediaDirection | \"all\" = \"all\";\n\n  constructor(\n    props: Pick<RTCRtpCodecParameters, \"mimeType\" | \"clockRate\"> &\n      Partial<RTCRtpCodecParameters>,\n  ) {\n    Object.assign(this, props);\n  }\n\n  get name() {\n    return this.mimeType.split(\"/\")[1];\n  }\n\n  get contentType() {\n    return this.mimeType.split(\"/\")[0];\n  }\n\n  get str() {\n    let s = `${this.name}/${this.clockRate}`;\n    if (this.channels === 2) s += \"/2\";\n    return s;\n  }\n}\n\nexport class RTCRtpHeaderExtensionParameters {\n  id!: number;\n  uri!: string;\n\n  constructor(\n    props: Partial<RTCRtpHeaderExtensionParameters> &\n      Pick<RTCRtpHeaderExtensionParameters, \"uri\">,\n  ) {\n    Object.assign(this, props);\n  }\n}\n\nexport class RTCRtcpParameters {\n  cname?: string;\n  mux = false;\n  ssrc?: number;\n\n  constructor(props: Partial<RTCRtcpParameters> = {}) {\n    Object.assign(this, props);\n  }\n}\n\nexport class RTCRtcpFeedback {\n  type!: string;\n  parameter?: string;\n\n  constructor(props: Partial<RTCRtcpFeedback> = {}) {\n    Object.assign(this, props);\n  }\n}\nexport class RTCRtpRtxParameters {\n  ssrc!: number;\n\n  constructor(props: Partial<RTCRtpRtxParameters> = {}) {\n    Object.assign(this, props);\n  }\n}\n\nexport class RTCRtpCodingParameters {\n  ssrc!: number;\n  payloadType!: number;\n  rtx?: RTCRtpRtxParameters;\n\n  constructor(\n    props: Partial<RTCRtpCodingParameters> &\n      Pick<RTCRtpCodingParameters, \"ssrc\" | \"payloadType\">,\n  ) {\n    Object.assign(this, props);\n  }\n}\n\nexport interface RTCRtpReceiveParameters extends RTCRtpParameters {\n  encodings: RTCRtpCodingParameters[];\n}\n\nexport type RTCRtpSendParameters = RTCRtpParameters;\n\nexport class RTCRtpSimulcastParameters {\n  rid!: string;\n  direction!: \"send\" | \"recv\";\n  constructor(props: RTCRtpSimulcastParameters) {\n    Object.assign(this, props);\n  }\n}\n","export async function sleep(ms: number) {\n    await new Promise(resolve => setTimeout(resolve, ms));\n}\n","/**\n * Detect Electron renderer / nwjs process, which is node, but we should\n * treat as a browser.\n */\n\nif (typeof process === 'undefined' || process.type === 'renderer' || process.browser === true || process.__nwjs) {\n\tmodule.exports = require('./browser.js');\n} else {\n\tmodule.exports = require('./node.js');\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.crypto = void 0;\n/**\n * Internal webcrypto alias.\n * We prefer WebCrypto aka globalThis.crypto, which exists in node.js 16+.\n * Falls back to Node.js built-in crypto for Node.js <=v14.\n * See utils.ts for details.\n * @module\n */\n// @ts-ignore\nconst nc = require(\"node:crypto\");\nexports.crypto = nc && typeof nc === 'object' && 'webcrypto' in nc\n    ? nc.webcrypto\n    : nc && typeof nc === 'object' && 'randomBytes' in nc\n        ? nc\n        : undefined;\n//# sourceMappingURL=cryptoNode.js.map","export const COOKIE = 0x2112a442;\nexport const FINGERPRINT_LENGTH = 8;\nexport const FINGERPRINT_XOR = 0x5354554e;\nexport const HEADER_LENGTH = 20;\nexport const INTEGRITY_LENGTH = 24;\nexport const IPV4_PROTOCOL = 1;\nexport const IPV6_PROTOCOL = 2;\n\nexport const RETRY_MAX = 6;\nexport const RETRY_RTO = 50;\n\nexport const AttributeKeys = [\n  \"FINGERPRINT\",\n  \"MESSAGE-INTEGRITY\",\n  \"CHANGE-REQUEST\",\n  \"PRIORITY\",\n  \"USERNAME\",\n  \"ICE-CONTROLLING\",\n  \"SOURCE-ADDRESS\",\n  \"USE-CANDIDATE\",\n  \"ICE-CONTROLLED\",\n  \"ERROR-CODE\",\n  \"XOR-MAPPED-ADDRESS\",\n  \"CHANGED-ADDRESS\",\n  \"LIFETIME\",\n  \"REQUESTED-TRANSPORT\",\n  \"NONCE\",\n  \"REALM\",\n  \"XOR-RELAYED-ADDRESS\",\n  \"CHANNEL-NUMBER\",\n  \"XOR-PEER-ADDRESS\",\n  \"DATA\",\n  \"SOFTWARE\",\n  \"MAPPED-ADDRESS\",\n  \"RESPONSE-ORIGIN\",\n  \"OTHER-ADDRESS\",\n] as const;\n\nexport enum classes {\n  REQUEST = 0x000,\n  INDICATION = 0x010,\n  RESPONSE = 0x100, // 256\n  ERROR = 0x110, // 272\n}\n\nexport enum methods {\n  BINDING = 0x1,\n  SHARED_SECRET = 0x2,\n  ALLOCATE = 0x3,\n  REFRESH = 0x4,\n  SEND = 0x6,\n  DATA = 0x7,\n  CREATE_PERMISSION = 0x8,\n  CHANNEL_BIND = 0x9,\n}\n","/* !\n *  Copyright  2008 Fair Oaks Labs, Inc.\n *  All rights reserved.\n */\n\n// Utility object:  Encode / Decode C-style binary primitives to / from octet arrays\nfunction JSPack() {\n  // Module-level (private) variables\n  var el;\n  var bBE = false;\n  var m = this;\n\n  // Raw byte arrays\n  m._DeArray = function (a, p, l) {\n    return [a.slice(p, p + l)];\n  };\n\n  m._EnArray = function (a, p, l, v) {\n    for (var i = 0; i < l; a[p + i] = v[i] ? v[i] : 0, i++) { }\n  };\n\n  // ASCII characters\n  m._DeChar = function (a, p) {\n    return String.fromCharCode(a[p]);\n  };\n\n  m._EnChar = function (a, p, v) {\n    a[p] = v.charCodeAt(0);\n  };\n\n  // Little-endian (un)signed N-byte integers\n  m._DeInt = function (a, p) {\n    var lsb = bBE ? (el.len - 1) : 0;\n    var nsb = bBE ? -1 : 1;\n    var stop = lsb + nsb * el.len;\n    var rv, i, f;\n    for (rv = 0, i = lsb, f = 1; i != stop; rv += (a[p + i] * f), i += nsb, f *= 256) { }\n    if (el.bSigned && (rv & Math.pow(2, el.len * 8 - 1))) { rv -= Math.pow(2, el.len * 8); }\n    return rv;\n  };\n\n  m._EnInt = function (a, p, v) {\n    var lsb = bBE ? (el.len - 1) : 0;\n    var nsb = bBE ? -1 : 1;\n    var stop = lsb + nsb * el.len;\n    var i;\n    v = (v < el.min) ? el.min : (v > el.max) ? el.max : v;\n    for (i = lsb; i != stop; a[p + i] = v & 0xff, i += nsb, v >>= 8) { }\n  };\n\n  // ASCII character strings\n  m._DeString = function (a, p, l) {\n    for (var rv = new Array(l), i = 0; i < l; rv[i] = String.fromCharCode(a[p + i]), i++) { }\n    return rv.join('');\n  };\n  m._EnString = function (a, p, l, v) {\n\n    for (var t, i = 0; i < l; a[p + i] = (t = v.charCodeAt(i)) ? t : 0, i++) { }\n  };\n\n  // Little-endian N-bit IEEE 754 floating point\n  m._De754 = function (a, p) {\n    var s, e, m, i, d, nBits, mLen, eLen, eBias, eMax;\n    mLen = el.mLen, eLen = el.len * 8 - el.mLen - 1, eMax = (1 << eLen) - 1, eBias = eMax >> 1;\n\n    i = bBE ? 0 : (el.len - 1); d = bBE ? 1 : -1; s = a[p + i]; i += d; nBits = -7;\n    for (e = s & ((1 << (-nBits)) - 1), s >>= (-nBits), nBits += eLen;\n     nBits > 0; e = e * 256 + a[p + i], i += d, nBits -= 8) { }\n    for (m = e & ((1 << (-nBits)) - 1), e >>= (-nBits), nBits += mLen; nBits > 0;\n      m = m * 256 + a[p + i], i += d, nBits -= 8) { }\n\n    switch (e) {\n\n      case 0:\n        // Zero, or denormalized number\n        e = 1 - eBias;\n        break;\n      case eMax:\n        // NaN, or +/-Infinity\n        return m ? NaN : ((s ? -1 : 1) * Infinity);\n      default:\n        // Normalized number\n        m = m + Math.pow(2, mLen);\n        e = e - eBias;\n        break;\n    }\n    return (s ? -1 : 1) * m * Math.pow(2, e - mLen);\n  };\n  m._En754 = function (a, p, v) {\n\n    var s, e, m, i, d, c, mLen, eLen, eBias, eMax;\n    mLen = el.mLen, eLen = el.len * 8 - el.mLen - 1, eMax = (1 << eLen) - 1, eBias = eMax >> 1;\n\n    s = v < 0 ? 1 : 0;\n    v = Math.abs(v);\n    if (isNaN(v) ||  (v  ==  Infinity)) {\n\n      m = isNaN(v) ? 1 : 0;\n      e = eMax;\n    }\n    else {\n      e = Math.floor(Math.log(v) / Math.LN2);     // Calculate log2 of the value\n      if (v * (c = Math.pow(2, -e)) < 1) { e--; c *= 2; }   // Math.log() isn't 100% reliable\n\n      // Round by adding 1 / 2 the significand's LSD\n      if (e + eBias >= 1) {\n        // Normalized:  mLen significand digits\n        v += el.rt / c;\n      }\n      else {\n        // Denormalized:  <= mLen significand digits\n        v += el.rt * Math.pow(2, 1 - eBias);\n      }\n      if (v * c >= 2) {\n        // Rounding can increment the exponent\n        e++; c /= 2;\n      }\n\n      if (e + eBias >= eMax) {\n        // Overflow\n        m = 0;\n        e = eMax;\n      }\n      else if (e + eBias >= 1) {\n\n        // Normalized - term order matters, as Math.pow(2, 52 - e) and v * Math.pow(2, 52) can overflow\n        m = (v * c - 1) * Math.pow(2, mLen);\n        e = e + eBias;\n      }\n      else {\n\n        // Denormalized - also catches the '0' case, somewhat by chance\n        m = v * Math.pow(2, eBias - 1) * Math.pow(2, mLen);\n        e = 0;\n      }\n    }\n\n    for (i = bBE ? (el.len - 1) : 0, d = bBE ? -1 : 1; mLen >= 8; a[p + i] = m & 0xff, i += d, m /= 256, mLen -= 8) { }\n    for (e = (e << mLen) | m, eLen += mLen; eLen > 0; a[p + i] = e & 0xff, i += d, e /= 256, eLen -= 8) { }\n    a[p + i - d] |= s * 128;\n  };\n\n  // Convert int64 to array with 3 elements: [lowBits, highBits, unsignedFlag]\n  // '>>>' trick to convert signed 32bit int to unsigned int (because << always results in a signed 32bit int)\n  m._DeInt64 = function (a, p) {\n    var start = bBE ? 0 : 7;\n    var nsb = bBE ? 1 : -1;\n    var stop = start + nsb * 8;\n    var rv = [0, 0, !el.bSigned];\n    var i, f, rvi;\n    for (i = start, rvi = 1, f = 0;\n      i != stop;\n      rv[rvi] = (((rv[rvi] << 8) >>> 0) + a[p + i]), i += nsb, f++, rvi = (f < 4 ? 1 : 0)) {}\n    return rv;\n  };\n\n  m._EnInt64 = function (a, p, v) {\n    var start = bBE ? 0 : 7;\n    var nsb = bBE ? 1 : -1;\n    var stop = start + nsb * 8;\n    var i, f, rvi, s;\n    for (i = start, rvi = 1, f = 0, s = 24;\n      i != stop;\n      a[p + i] = v[rvi] >> s & 0xff, i += nsb, f++, rvi = (f < 4 ? 1 : 0), s = 24 - (8 * (f % 4))) { }\n  };\n\n  // Class data\n  m._sPattern = '(\\\\d + )?([AxcbBhHsfdiIlLqQ])';\n  m._lenLut = {'A': 1, 'x': 1, 'c': 1, 'b': 1, 'B': 1, 'h': 2, 'H': 2, 's': 1,\n    'f': 4, 'd': 8, 'i': 4, 'I': 4, 'l': 4, 'L': 4, 'q': 8, 'Q': 8\n  };\n  m._elLut  = {'A': {en: m._EnArray, de: m._DeArray},\n        's': {en: m._EnString, de: m._DeString},\n        'c': {en: m._EnChar, de: m._DeChar},\n        'b': {en: m._EnInt, de: m._DeInt, len: 1, bSigned: true, min: -Math.pow(2, 7), max: Math.pow(2, 7) - 1},\n        'B': {en: m._EnInt, de: m._DeInt, len: 1, bSigned: false, min: 0, max: Math.pow(2, 8) - 1},\n        'h': {en: m._EnInt, de: m._DeInt, len: 2, bSigned: true, min: -Math.pow(2, 15), max: Math.pow(2, 15) - 1},\n        'H': {en: m._EnInt, de: m._DeInt, len: 2, bSigned: false, min: 0, max: Math.pow(2, 16) - 1},\n        'i': {en: m._EnInt, de: m._DeInt, len: 4, bSigned: true, min: -Math.pow(2, 31), max: Math.pow(2, 31) - 1},\n        'I': {en: m._EnInt, de: m._DeInt, len: 4, bSigned: false, min: 0, max: Math.pow(2, 32) - 1},\n        'l': {en: m._EnInt, de: m._DeInt, len: 4, bSigned: true, min: -Math.pow(2, 31), max: Math.pow(2, 31) - 1},\n        'L': {en: m._EnInt, de: m._DeInt, len: 4, bSigned: false, min: 0, max: Math.pow(2, 32) - 1},\n        'f': {en: m._En754, de: m._De754, len: 4, mLen: 23, rt: Math.pow(2, -24) - Math.pow(2, -77)},\n        'd': {en: m._En754, de: m._De754, len: 8, mLen: 52, rt: 0},\n        'q': {en: m._EnInt64, de: m._DeInt64, bSigned: true},\n        'Q': {en: m._EnInt64, de: m._DeInt64, bSigned: false}};\n\n  // Unpack a series of n elements of size s from array a at offset p with fxn\n  m._UnpackSeries = function (n, s, a, p) {\n    for (var fxn = el.de, rv = [], i = 0; i < n; rv.push(fxn(a, p + i * s)), i++) { }\n    return rv;\n  };\n\n  // Pack a series of n elements of size s from array v at offset i to array a at offset p with fxn\n  m._PackSeries = function (n, s, a, p, v, i) {\n    for (var fxn = el.en, o = 0; o < n; fxn(a, p + o * s, v[i + o]), o++) { }\n  };\n\n  // Unpack the octet array a, beginning at offset p, according to the fmt string\n  m.Unpack = function (fmt, a, p) {\n    // Set the private bBE flag based on the format string - assume big-endianness\n    bBE = (fmt.charAt(0) != '<');\n\n    p = p ? p : 0;\n    var re = new RegExp(this._sPattern, 'g');\n    var m, n, s;\n    var rv = [];\n    while (m = re.exec(fmt)) {\n\n      n = ((m[1]  == undefined) || (m[1] == '')) ? 1 : parseInt(m[1]);\n      s = this._lenLut[m[2]];\n      if ((p + n * s) > a.length) {\n\n        return undefined;\n      }\n      switch (m[2]) {\n\n        case 'A': case 's':\n          rv.push(this._elLut[m[2]].de(a, p, n));\n          break;\n        case 'c': case 'b': case 'B': case 'h': case 'H':\n        case 'i': case 'I': case 'l': case 'L': case 'f': case 'd': case 'q': case 'Q':\n          el = this._elLut[m[2]];\n          rv.push(this._UnpackSeries(n, s, a, p));\n          break;\n      }\n      p += n * s;\n    }\n    return Array.prototype.concat.apply([], rv);\n  };\n\n  // Pack the supplied values into the octet array a, beginning at offset p, according to the fmt string\n  m.PackTo = function (fmt, a, p, values) {\n    // Set the private bBE flag based on the format string - assume big-endianness\n    bBE = (fmt.charAt(0) != '<');\n\n    var re = new RegExp(this._sPattern, 'g');\n    var m, n, s, j;\n    var i = 0;\n    while (m = re.exec(fmt)) {\n      n = ((m[1] == undefined) || (m[1] == '')) ? 1 : parseInt(m[1]);\n      s = this._lenLut[m[2]];\n      if ((p + n * s) > a.length) {\n        return false;\n      }\n      switch (m[2]) {\n        case 'A': case 's':\n          if ((i + 1) > values.length) { return false; }\n          this._elLut[m[2]].en(a, p, n, values[i]);\n          i += 1;\n          break;\n        case 'c': case 'b': case 'B': case 'h': case 'H':\n        case 'i': case 'I': case 'l': case 'L': case 'f': case 'd': case 'q': case 'Q':\n          el = this._elLut[m[2]];\n          if ((i + n) > values.length) { return false; }\n          this._PackSeries(n, s, a, p, values, i);\n          i += n;\n          break;\n        case 'x':\n          for (j = 0; j < n; j++) { a[p + j] = 0; }\n          break;\n      }\n      p += n * s;\n    }\n    return a;\n  };\n\n  // Pack the supplied values into a new octet array, according to the fmt string\n  m.Pack = function (fmt, values) {\n    return this.PackTo(fmt, new Array(this.CalcLength(fmt)), 0, values);\n  };\n\n  // Determine the number of bytes represented by the format string\n  m.CalcLength = function (fmt) {\n    var re = new RegExp(this._sPattern, 'g');\n    var sum = 0;\n    var m;\n    while (m = re.exec(fmt)) {\n      sum += (((m[1]  ==  undefined) ||  (m[1]  ==  '')) ? 1 : parseInt(m[1])) * this._lenLut[m[2]];\n    }\n    return sum;\n  };\n}\n\nexports.jspack = new JSPack();\n","module.exports = require(\"tls\");","import \"buffer\";\nexport * from \"./srtp/const\";\nexport * from \"../../common/src\";\nexport * from \"./codec\";\nexport * from \"./helper\";\nexport * from \"./rtcp/header\";\nexport * from \"./rtcp/psfb\";\nexport * from \"./rtcp/psfb/pictureLossIndication\";\nexport * from \"./rtcp/psfb/remb\";\nexport * from \"./rtcp/rr\";\nexport * from \"./rtcp/rtcp\";\nexport * from \"./rtcp/rtpfb\";\nexport * from \"./rtcp/rtpfb/nack\";\nexport * from \"./rtcp/rtpfb/twcc\";\nexport * from \"./rtcp/sdes\";\nexport * from \"./rtcp/sr\";\nexport * from \"./rtp/headerExtension\";\nexport * from \"./rtp/red/encoder\";\nexport * from \"./rtp/red/handler\";\nexport * from \"./rtp/red/packet\";\nexport * from \"./rtp/rtp\";\nexport * from \"./rtp/rtx\";\nexport * from \"./srtp/srtcp\";\nexport * from \"./srtp/srtp\";\nexport * from \"./util\";\n","import { RTCPeerConnection } from \"./werift\";\n\ninterface Event {\n    subscribe: (execute: () => void) => {\n        unSubscribe: () => void;\n    };\n}\n\nasync function statePromise(e: Event, check: () => boolean): Promise<void> {\n    if (check())\n        return;\n\n    return new Promise((r, f) => {\n        const u = e.subscribe(() => {\n            try {\n                if (check()) {\n                    u.unSubscribe();\n                    r(undefined);\n                }\n            }\n            catch (e) {\n                u.unSubscribe();\n                f(e);\n            }\n        });\n    })\n}\n\nfunction isPeerConnectionClosed(pc: RTCPeerConnection) {\n    return (pc.connectionState === 'closed'\n        || pc.connectionState === 'disconnected'\n        || pc.connectionState === 'failed')\n}\n\nexport function waitConnected(pc: RTCPeerConnection) {\n    return statePromise(pc.connectionStateChange, () => {\n        if (isPeerConnectionClosed(pc))\n            throw new Error('peer connection closed');\n        return pc.connectionState === 'connected';\n    })\n}\n\nfunction isPeerIceConnectionClosed(pc: RTCPeerConnection) {\n    return (pc.iceConnectionState === 'disconnected'\n        || pc.iceConnectionState === 'failed'\n        || pc.iceConnectionState === 'closed')\n}\n\nexport function waitIceConnected(pc: RTCPeerConnection) {\n    return statePromise(pc.iceConnectionStateChange, () => {\n        if (isPeerIceConnectionClosed(pc))\n            throw new Error('peer ice connection closed');\n        return pc.iceConnectionState === 'connected' || pc.iceConnectionState === 'completed';\n    })\n}\n\nexport async function waitClosed(pc: RTCPeerConnection) {\n    const connectPromise = statePromise(pc.connectionStateChange, () => {\n        return isPeerConnectionClosed(pc);\n    });\n    const iceConnectPromise = statePromise(pc.iceConnectionStateChange, () => {\n        return isPeerIceConnectionClosed(pc);\n    });\n    await Promise.any([connectPromise, iceConnectPromise]);\n    await pc.close();\n}\n\nexport function logConnectionState(console: Console, pc: RTCPeerConnection) {\n    pc.iceConnectionStateChange.subscribe(() => console.log('iceConnectionState', pc.iceConnectionState));\n    pc.iceGatheringStateChange.subscribe(() => console.log('iceGatheringState', pc.iceGatheringState));\n    pc.signalingStateChange.subscribe(() => console.log('signalingState', pc.signalingState));\n    pc.connectionStateChange.subscribe(() => console.log('connectionState', pc.connectionState));\n}\n","import { RTCIceServer, RTCPeerConnection, RTCSessionDescription } from \"./werift\";\nimport ip from 'ip';\nimport os from 'os';\n\nexport function createRawResponse(response: RTCSessionDescription): RTCSessionDescriptionInit {\n    return {\n        type: response.type,\n        sdp: response.sdp,\n    };\n}\n\nexport function isPeerConnectionAlive(pc: RTCPeerConnection) {\n    if (pc.iceConnectionState === 'disconnected'\n        || pc.iceConnectionState === 'failed'\n        || pc.iceConnectionState === 'closed')\n        return false;\n    if (pc.connectionState === 'closed'\n        || pc.connectionState === 'disconnected'\n        || pc.connectionState === 'failed')\n        return false;\n    return true;\n}\n\nexport function getWeriftIceServers(configuration: RTCConfiguration): RTCIceServer[] {\n    if (!configuration?.iceServers)\n        return;\n    const ret: RTCIceServer[] = [];\n    for (const ice of configuration.iceServers) {\n        if (typeof ice.urls === 'string') {\n            ret.push({\n                ...ice as RTCIceServer,\n            });\n        }\n        else {\n            for (const url of ice.urls) {\n                ret.push(Object.assign({}, ice, {\n                    urls: url,\n                }));\n            }\n        }\n    }\n\n    return ret;\n}\n\n// node-ip is missing this range.\n// https://en.wikipedia.org/wiki/Reserved_IP_addresses\nconst additionalPrivate = ip.cidrSubnet('198.18.0.0/15');\nfunction isPrivate(address: string) {\n    return ip.isPrivate(address) || additionalPrivate.contains(address);\n}\n\nexport function isLocalIceTransport(pc: RTCPeerConnection) {\n    let isLocalNetwork = true;\n    let destinationId: string;\n    let type: string;\n    for (const ice of pc.iceTransports) {\n        const { remoteAddr, localCandidate, remoteCandidate } = (ice.connection as any).nominated;\n        const [address, port] = remoteAddr;\n        type = remoteCandidate.type;\n        if (!destinationId)\n            destinationId = address;\n\n        let sameNetwork = false;\n        try {\n            const localAddress = Object.values(os.networkInterfaces()).flat().find(nif => nif.address === localCandidate.host);\n            sameNetwork = ip.cidrSubnet(localAddress.cidr).contains(address);\n        }\n        catch (e) {\n        }\n\n        isLocalNetwork = isLocalNetwork && (isPrivate(address) || sameNetwork);\n    }\n    const ipv4 = ip.isV4Format(destinationId);\n    return {\n        ipv4,\n        type,\n        isLocalNetwork,\n        destinationId,\n    };\n}\n\nexport function logIsLocalIceTransport(console: Console, pc: RTCPeerConnection) {\n    const ret = isLocalIceTransport(pc);\n    console.log('Connection is local network:', ret.isLocalNetwork, ret.destinationId, ret);\n    return ret;\n}\n","export function enumerate<T>(arr: T[]): [number, T][] {\n  return arr.map((v, i) => [i, v]);\n}\n\nexport function growBufferSize(buf: Buffer, size: number) {\n  const glow = Buffer.alloc(size);\n  buf.copy(glow);\n  return glow;\n}\n\nexport function Int(v: number) {\n  return Number.parseInt(v.toString(), 10);\n}\n\nexport const timer = {\n  setTimeout: (...args: Parameters<typeof setTimeout>) => {\n    const id = setTimeout(...args);\n    return () => clearTimeout(id);\n  },\n  setInterval: (...args: Parameters<typeof setInterval>) => {\n    const id = setInterval(\n      () => {\n        args[0]();\n      },\n      //@ts-ignore\n      ...args.slice(1),\n    );\n    return () => clearInterval(id);\n  },\n};\nexport function isMedia(buf: Buffer) {\n  const firstByte = buf[0];\n  return firstByte > 127 && firstByte < 192;\n}\n","// todo: move this to ring.\nexport function replacePorts(sdp: string, audioPort: number, videoPort: number) {\n    let outputSdp = sdp\n        .replace(/c=IN .*/, `c=IN IP4 127.0.0.1`)\n        .replace(/m=audio \\d+/, `m=audio ${audioPort}`)\n        .replace(/m=video \\d+/, `m=video ${videoPort}`);\n    return outputSdp;\n}\n\nexport function replaceSectionPort(sdp: string, section: string, port: number) {\n    const regex = new RegExp(`m=${section} \\\\d+`)\n    let outputSdp = sdp\n        .replace(/c=IN .*/, `c=IN IP4 127.0.0.1`)\n        .replace(regex, `m=${section} ${port}`);\n    return outputSdp;\n}\n\nexport function addTrackControls(sdp: string) {\n    let lines = sdp.split('\\n').map(line => line.trim());\n    lines = lines.filter(line => !line.includes('a=control:'));\n    let trackCount = 0;\n    for (let i = 0; i < lines.length; i++) {\n        const line = lines[i];\n        if (!line.startsWith('m='))\n            continue;\n        lines.splice(i + 1, 0, 'a=control:trackID=' + trackCount);\n        trackCount++;\n    }\n    return lines.join('\\r\\n')\n}\n\n// todo: move this to webrtc\n// this is an sdp corresponding to what is requested from webrtc.\n// h264 baseline and opus are required codecs that all webrtc implementations must provide.\nexport function createSdpInput(audioPort: number, videoPort: number, sdp: string) {\n    // replace all IPs\n    let outputSdp = sdp\n        .replace(/c=IN .*/, `c=IN IP4 127.0.0.1`)\n        .replace(/m=audio \\d+/, `m=audio ${audioPort}`)\n        .replace(/m=video \\d+/, `m=video ${videoPort}`);\n\n    // filter all ice and rtcp mux info\n    let lines = outputSdp.split('\\n').map(line => line.trim());\n    lines = lines\n        .filter(line => !line.includes('a=rtcp-mux'))\n        .filter(line => !line.includes('a=candidate'))\n        .filter(line => !line.includes('a=ice'));\n\n    outputSdp = lines.join('\\r\\n');\n\n    outputSdp = addTrackControls(outputSdp);\n\n    // only include the m sections.\n    outputSdp = outputSdp.split('m=')\n        .slice(1)\n        .map(line => 'm=' + line)\n        .join('');\n    return outputSdp;\n}\n\n// todo: move this to webrtc\nexport function findFmtp(sdp: string, codec: string) {\n    let lines = sdp.split('\\n').map(line => line.trim());\n\n    const re = new RegExp(`a=rtpmap:(\\\\d+) ${codec}`);\n    const rtpmaps = lines.map(line => line.match(re)).filter(match => !!match);\n    return rtpmaps.map(match => {\n        const payloadType = parseInt(match[1]);\n        const fmtpPrefix = `a=fmtp:${payloadType} `;\n        const fmtp = lines.find(line => line.startsWith(fmtpPrefix))?.substring(fmtpPrefix.length);\n        return {\n            payloadType,\n            fmtp,\n        }\n    })\n}\n\nfunction getSections(sdp: string) {\n    const sections = ('\\n' + sdp).split('\\nm=');\n    return sections;\n}\n\nexport function findTrackByType(sdp: string, type: string, directions: TrackDirection[] = ['recvonly', 'sendrecv']) {\n    const sections = getSections(sdp).filter(track => track.startsWith(type));\n\n    for (const section of sections) {\n        const returnTrack = () => {\n            const lines = section.split('\\n').map(line => line.trim());\n            const controlString = 'a=control:';\n            const control = lines.find(line => line.startsWith(controlString));\n            return {\n                section: 'm=' + section,\n                trackId: control.substring(controlString.length),\n            };\n        }\n\n        for (const dir of directions) {\n            if (section.includes(`a=${dir}`)) {\n                return returnTrack();\n            }\n        }\n\n        // some sdp do not advertise a media flow direction. i think recvonly is the default?\n        if ((directions.includes('recvonly'))\n            && !section.includes('sendonly')\n            && !section.includes('inactive')) {\n            return returnTrack();\n        }\n    }\n}\n\ntype TrackDirection = 'sendonly' | 'sendrecv' | 'recvonly' | 'inactive';\n\nexport function findTracksByType(sdp: string, directions: TrackDirection[] = ['recvonly', 'sendrecv']) {\n    return {\n        audio: findTrackByType(sdp, 'audio', directions)?.trackId,\n        video: findTrackByType(sdp, 'video', directions)?.trackId,\n    };\n}\n\nexport function parseMLinePayloadTypes(mline: string) {\n    const payloadTypes: number[] = [];\n    for (const pt of mline.split(' ').slice(3) || []) {\n        payloadTypes.push(parseInt(pt));\n    }\n    return payloadTypes;\n}\n\nexport function parseMLine(mline: string) {\n    // 'm=audio 0 RTP/AVP 96'\n    const split = mline.split(' ');\n    const type = split[0].substring(2);\n    return {\n        type,\n        port: parseInt(split[1]),\n        protocol: split[2],\n        payloadTypes: parseMLinePayloadTypes(mline),\n    }\n}\n\nconst afmtp = 'a=fmtp';\nexport function parseFmtp(msection: string[]) {\n    return msection.filter(line => line.startsWith(afmtp))\n        .map(fmtpLine => {\n            const firstSpace = fmtpLine.indexOf(' ');\n            if (firstSpace === -1)\n                return;\n            const fmtp = fmtpLine.substring(0, firstSpace);\n            const paramLine = fmtpLine.substring(firstSpace + 1);\n            const payloadType = parseInt(fmtp.split(':')[1]);\n\n            if (!fmtp || !paramLine || Number.isNaN(payloadType)) {\n                return;\n            }\n\n            const parameters: {\n                [key: string]: string;\n            } = {};\n\n            paramLine.split(';').map(param => param.trim()).forEach(param => {\n                const [key, ...value] = param.split('=');\n                parameters[key] = value.join('=');\n            });\n            return {\n                payloadType,\n                parameters,\n            }\n        })\n        .filter(fmtp => !!fmtp);\n}\n\nexport type MSection = ReturnType<typeof parseMSection>;\nexport type RTPMap = ReturnType<typeof parseRtpMap>;\n\nexport function parseRtpMap(mline: ReturnType<typeof parseMLine>, rtpmap: string) {\n    const mlineType = mline.type;\n    const match = rtpmap?.match(/a=rtpmap:([\\d]+) (.*?)\\/([\\d]+)(\\/([\\d]+))?/);\n    let channels = parseInt(match?.[5]) || undefined;\n    let payloadType = parseInt(match?.[1]);\n\n    rtpmap = rtpmap?.toLowerCase();\n\n    let codec: string;\n    let ffmpegEncoder: string;\n    if (rtpmap?.includes('mpeg4')) {\n        codec = 'aac';\n        ffmpegEncoder = 'aac';\n    }\n    else if (rtpmap?.includes('opus')) {\n        codec = 'opus';\n        ffmpegEncoder = 'libopus';\n    }\n    else if (rtpmap?.includes('pcma')) {\n        codec = 'pcm_alaw';\n        ffmpegEncoder = 'pcm_alaw';\n    }\n    else if (rtpmap?.includes('pcmu')) {\n        codec = 'pcm_mulaw';\n        ffmpegEncoder = 'pcm_mulaw';\n    }\n    else if (rtpmap?.includes('g726')) {\n        codec = 'g726';\n        // disabled since it 48000 is non compliant in ffmpeg and fails.\n        // ffmpegEncoder = 'g726';\n    }\n    else if (rtpmap?.includes('pcm')) {\n        codec = 'pcm';\n    }\n    else if (rtpmap?.includes('l16')) {\n        codec = 'pcm_s16be';\n        ffmpegEncoder = 'pcm_s16be';\n    }\n    else if (rtpmap?.includes('speex')) {\n        codec = 'speex';\n        ffmpegEncoder = 'libspeex';\n    }\n    else if (rtpmap?.includes('h264')) {\n        codec = 'h264';\n    }\n    else if (rtpmap?.includes('h265')) {\n        codec = 'h265';\n    }\n    else if (!rtpmap && mlineType === 'audio') {\n        if (mline.payloadTypes?.includes(0)) {\n            codec = 'pcm_mulaw';\n            ffmpegEncoder = 'pcm_mulaw';\n            payloadType = 0;\n            channels = 1;\n        }\n        else if (mline.payloadTypes?.includes(8)) {\n            codec = 'pcm_alaw';\n            ffmpegEncoder = 'pcm_alaw';\n            payloadType = 8;\n            channels = 1;\n        }\n        else if (mline.payloadTypes?.includes(14)) {\n            codec = 'mp3';\n            ffmpegEncoder = 'mp3';\n            payloadType = 14;\n            channels = 2;\n        }\n        else {\n            // ffmpeg seems to omit the rtpmap type for pcm alaw when creating sdp?\n            // is this the default?\n            // 2/21/2024: the paylaod types are included in the mline, and this is legacy code\n            // that maybe should be updated to use the mline payload types when no rtpmap(s) are available.\n            // https://en.wikipedia.org/wiki/RTP_payload_formats\n            codec = 'pcm_alaw';\n            ffmpegEncoder = 'pcm_alaw';\n            payloadType = 8;\n            channels = 1;\n        }\n    }\n\n    // assigned payload types do not need to provide a clock, there is a default.\n    let clock = parseInt(match?.[3]);\n    if (!clock) {\n        clock = undefined;\n        if (codec === 'pcm_mulaw' || codec === 'pcm_alaw')\n            clock = 8000;\n        else if (codec === 'pcm_s16be')\n            clock = 16000;\n    }\n\n    return {\n        line: rtpmap,\n        codec,\n        ffmpegEncoder,\n        rawCodec: match?.[2],\n        clock,\n        channels,\n        payloadType,\n    }\n}\n\nconst acontrol = 'a=control:';\nconst artpmap = 'a=rtpmap:';\nexport function parseMSection(msection: string[]) {\n    const control = msection.find(line => line.startsWith(acontrol))?.substring(acontrol.length);\n    const mline = parseMLine(msection[0]);\n    const rawRtpmaps = msection.filter(line => line.startsWith(artpmap));\n    const rtpmaps = rawRtpmaps.map(line => parseRtpMap(mline, line));\n    // if no rtp map is specified, pcm_alaw is used. parsing a null rtpmap is valid.\n    const rtpmap = parseRtpMap(mline, rawRtpmaps[0]);\n    const { codec } = rtpmap;\n    let direction: string;\n\n    for (const checkDirection of ['sendonly', 'sendrecv', 'recvonly', 'inactive']) {\n        const found = msection.find(line => line === 'a=' + checkDirection);\n        if (found) {\n            direction = checkDirection;\n            break;\n        }\n    }\n\n    const ret = {\n        ...mline,\n        fmtp: parseFmtp(msection),\n        lines: msection,\n        rtpmaps,\n        contents: msection.join('\\r\\n'),\n        control,\n        codec,\n        rtpmap,\n        direction,\n        toSdp: () => {\n            return ret.lines.join('\\r\\n');\n        }\n    }\n\n    return ret;\n}\n\nexport type ParsedSdp = ReturnType<typeof parseSdp>;\n\nexport function parseSdp(sdp: string) {\n    const lines = sdp.split('\\n').map(line => line.trim());\n    const header: string[] = [];\n    const msections: string[][] = [];\n    let msection: string[];\n\n    for (const line of lines) {\n        if (line.startsWith('m=')) {\n            if (msection) {\n                msections.push(msection);\n            }\n            msection = [];\n        }\n\n        if (msection) {\n            msection.push(line);\n        }\n        else {\n            header.push(line);\n        }\n    }\n\n    if (msection)\n        msections.push(msection);\n\n    const ret = {\n        header: {\n            lines: header,\n            contents: header.join('\\r\\n'),\n        },\n        msections: msections.map(parseMSection),\n        toSdp: () => {\n            return [...ret.header.lines, ...ret.msections.map(msection => msection.lines).flat()].join('\\r\\n');\n        }\n    }\n\n    return ret;\n}\n\nexport function getSpsPps(\n    section: {\n        fmtp: {\n            payloadType: number;\n            parameters: {\n                [key: string]: string;\n            };\n        }[]\n    }\n) {\n    const spspps = section?.fmtp?.[0]?.parameters?.['sprop-parameter-sets']?.split(',');\n    // empty sprop-parameter-sets is apparently a thing:\n    //     a=fmtp:96 profile-level-id=420029; packetization-mode=1; sprop-parameter-sets=\n    if (spspps?.length !== 2) {\n        return {\n            sps: undefined,\n            pps: undefined,\n        };\n    }\n\n    const [sps, pps] = spspps;\n\n    return {\n        sps: Buffer.from(sps, 'base64'),\n        pps: Buffer.from(pps, 'base64'),\n    }\n}\n\nexport function getSpsPpsVps(\n    section: {\n        fmtp: {\n            payloadType: number;\n            parameters: {\n                [key: string]: string;\n            };\n        }[]\n    }\n) {\n    const parameters = section?.fmtp?.[0]?.parameters;\n    if (!parameters) {\n        return {\n            sps: undefined,\n            pps: undefined,\n            vps: undefined,\n        };\n    }\n\n    const sps = parameters['sprop-sps'];\n    const pps = parameters['sprop-pps'];\n    const vps = parameters['sprop-vps'];\n\n    return {\n        sps: sps ? Buffer.from(sps, 'base64') : undefined,\n        pps: pps ? Buffer.from(pps, 'base64') : undefined,\n        vps: vps ? Buffer.from(vps, 'base64') : undefined,\n    }\n}","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/asn1\n//\n// **License:** MIT\nconst util_1 = require(\"util\");\nconst pemLineLength = 64;\nconst pemStart = '-----BEGIN ';\nconst pemEnd = '-----END ';\nconst pemEndOfLine = '-----';\nconst procType = 'Proc-Type';\n/**\n * Implements the PEM data encoding, which originated in Privacy\n * Enhanced Mail. The most common use of PEM encoding today is in TLS keys and\n * certificates. See RFC 1421.\n *\n * A PEM represents a PEM encoded structure.\n *\n * The encoded form is:\n * ```\n * -----BEGIN Type-----\n * Headers\n * base64-encoded Bytes\n * -----END Type-----\n * ```\n *\n * Headers like:\n * ```\n * Proc-Type: 4,ENCRYPTED\n * DEK-Info: DES-EDE3-CBC,29DE8F99F382D122\n * ```\n */\nclass PEM {\n    /**\n     * Parse PEM formatted buffer, returns one or more PEM object.\n     * If there is no PEM object, it will throw error.\n     * @param data buffer to parse.\n     */\n    static parse(data) {\n        const res = [];\n        const lines = data.toString('utf8').split('\\n')\n            .map((s) => s.trim())\n            .filter((s) => s !== '' && !s.startsWith('#'));\n        while (lines.length > 0) {\n            res.push(parse(lines));\n        }\n        if (res.length === 0) {\n            throw new Error('PEM: no block');\n        }\n        return res;\n    }\n    constructor(type, body) {\n        this.type = type;\n        this.body = body;\n        this.headers = Object.create(null);\n    }\n    /**\n     * Return exists Proc-Type header or empty string\n     */\n    get procType() {\n        return this.getHeader(procType);\n    }\n    /**\n     * Return a header or empty string with given key.\n     */\n    getHeader(key) {\n        const val = this.headers[key];\n        return val == null ? '' : val;\n    }\n    /**\n     * Set a header with given key/value.\n     */\n    setHeader(key, val) {\n        if (key.includes(':')) {\n            throw new Error('pem: cannot encode a header key that contains a colon');\n        }\n        if (key === '' || val === '') {\n            throw new Error('pem: invalid header key or value');\n        }\n        this.headers[key] = val;\n    }\n    /**\n     * Encode to PEM formatted string.\n     */\n    toString() {\n        let rVal = pemStart + this.type + pemEndOfLine + '\\n';\n        const headers = Object.keys(this.headers);\n        if (headers.length > 0) {\n            // The Proc-Type header must be written first. See RFC 1421, section 4.6.1.1\n            const type = this.procType;\n            if (type !== '') {\n                rVal += `${procType}: ${type}\\n`;\n            }\n            // For consistency of output, write other headers sorted by key.\n            headers.sort();\n            for (const key of headers) {\n                if (key !== procType) {\n                    rVal += `${key}: ${this.headers[key]}\\n`;\n                }\n            }\n            rVal += '\\n';\n        }\n        const body = this.body.toString('base64');\n        let offset = 0;\n        while (offset < body.length) {\n            rVal += body.slice(offset, offset + pemLineLength) + '\\n';\n            offset += pemLineLength;\n        }\n        rVal += pemEnd + this.type + pemEndOfLine + '\\n';\n        return rVal;\n    }\n    /**\n     * Encode to PEM formatted buffer.\n     */\n    toBuffer() {\n        return Buffer.from(this.toString(), 'utf8');\n    }\n    /**\n     * Returns the body.\n     */\n    valueOf() {\n        return this.body;\n    }\n    /**\n     * Return a friendly JSON object for debuging.\n     */\n    toJSON() {\n        return {\n            type: this.type,\n            body: this.body,\n            headers: this.headers,\n        };\n    }\n    [util_1.inspect.custom](_depth, options) {\n        return `<${this.constructor.name} ${util_1.inspect(this.toJSON(), options)}>`;\n    }\n}\nexports.PEM = PEM;\nfunction parse(lines) {\n    let line = lines.shift();\n    if (line == null || !line.startsWith(pemStart) || !line.endsWith(pemEndOfLine)) {\n        throw new Error('pem: invalid BEGIN line');\n    }\n    const type = line.slice(pemStart.length, line.length - pemEndOfLine.length);\n    if (type === '') {\n        throw new Error('pem: invalid type');\n    }\n    const headers = [];\n    line = lines.shift();\n    while (line != null && line.includes(': ')) {\n        const header = line.split(': ');\n        if (header.length !== 2 || header[0] === '' || header[1] === '') {\n            throw new Error('pem: invalid Header line');\n        }\n        headers.push(header);\n        line = lines.shift();\n    }\n    let body = '';\n    while (line != null && !line.startsWith(pemEnd)) {\n        body += line;\n        line = lines.shift();\n    }\n    if (line == null || line !== `${pemEnd}${type}${pemEndOfLine}`) {\n        throw new Error('pem: invalid END line');\n    }\n    const pem = new PEM(type, Buffer.from(body, 'base64'));\n    if (body === '' || pem.body.toString('base64') !== body) {\n        throw new Error('pem: invalid base64 body');\n    }\n    for (const header of headers) {\n        pem.setHeader(header[0], header[1]);\n    }\n    return pem;\n}\n//# sourceMappingURL=pem.js.map","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type { Extension } from \"../../../typings/domain\";\nimport { ExtensionList } from \"../../binary\";\nimport { HandshakeType } from \"../../const\";\nimport { DtlsRandom } from \"../../random\";\n\n// 7.4.1.2.  Client Hello\n\nexport class ClientHello {\n  msgType = HandshakeType.client_hello_1;\n  messageSeq: number = 0;\n  static readonly spec = {\n    clientVersion: { major: types.uint8, minor: types.uint8 },\n    random: DtlsRandom.spec,\n    sessionId: types.buffer(types.uint8),\n    cookie: types.buffer(types.uint8),\n    cipherSuites: types.array(types.uint16be, types.uint16be, \"bytes\"),\n    compressionMethods: types.array(types.uint8, types.uint8, \"bytes\"),\n    extensions: ExtensionList,\n  };\n\n  constructor(\n    public clientVersion: { major: number; minor: number },\n    public random: { gmt_unix_time: number; random_bytes: Buffer },\n    public sessionId: Buffer,\n    public cookie: Buffer,\n    public cipherSuites: number[],\n    public compressionMethods: number[],\n    public extensions: Extension[],\n  ) {}\n\n  static createEmpty() {\n    return new ClientHello(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new ClientHello(\n      //@ts-ignore\n      ...Object.values(decode(buf, ClientHello.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, ClientHello.spec).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","import type { Readable, Writable } from \"stream\";\nimport { SidebandBufferSerializer } from \"./rpc-buffer-serializer\";\nimport { RpcPeer } from \"./rpc\";\n\nexport function createDuplexRpcPeer(selfName: string, peerName: string, readable: Readable, writable: Writable) {\n    const serializer = createRpcDuplexSerializer(writable);\n\n    const rpcPeer = new RpcPeer(selfName, peerName, (message, reject, serializationContext) => {\n        try {\n            serializer.sendMessage(message, reject, serializationContext);\n        }\n        catch (e) {\n            reject?.(e as Error);\n            readable.destroy();\n        }\n    });\n\n    serializer.setupRpcPeer(rpcPeer);\n    readable.on('data', data => serializer.onData(data));\n    readable.on('close', serializer.onDisconnected);\n    readable.on('error', serializer.onDisconnected);\n    return rpcPeer;\n}\n\nexport function createRpcSerializer(options: {\n    sendMessageBuffer: (buffer: Buffer) => void,\n    sendMessageFinish: (message: any) => void,\n}) {\n    let rpcPeer: RpcPeer;\n\n    const { sendMessageBuffer, sendMessageFinish } = options;\n    let connected = true;\n    const onDisconnected = () => {\n        connected = false;\n        rpcPeer.kill('connection closed.');\n    }\n\n    const sendMessage = (message: any, reject?: (e: Error) => void, serializationContext?: any) => {\n        if (!connected) {\n            reject?.(new Error('peer disconnected'));\n            return;\n        }\n\n        const buffers = serializationContext?.buffers;\n        if (buffers) {\n            for (const buffer of buffers) {\n                sendMessageBuffer(buffer);\n            }\n        }\n        sendMessageFinish(message);\n    }\n\n    let pendingSerializationContext: any = undefined;\n    const setupRpcPeer = (peer: RpcPeer) => {\n        rpcPeer = peer;\n        rpcPeer.addSerializer(Buffer, 'Buffer', new SidebandBufferSerializer());\n        rpcPeer.constructorSerializerMap.set(Uint8Array, 'Buffer');\n    }\n\n    const onMessageBuffer = (buffer: Buffer) => {\n        pendingSerializationContext = pendingSerializationContext || {};\n        pendingSerializationContext.buffers ||= [];\n        const buffers: Buffer[] = pendingSerializationContext.buffers;\n        buffers.push(buffer);\n    };\n\n    const onMessageFinish = (message: any) => {\n        const messageSerializationContext = pendingSerializationContext;\n        pendingSerializationContext = undefined;\n        rpcPeer.handleMessage(message, messageSerializationContext);\n    };\n\n    const kill = (message: string) => {\n        rpcPeer.kill(message);\n    };\n\n    return {\n        kill,\n        sendMessage,\n        setupRpcPeer,\n        onMessageBuffer,\n        onMessageFinish,\n        onDisconnected,\n    };\n}\n\nexport function createRpcDuplexSerializer(writable: {\n    write: (data: Buffer) => void;\n}) {\n    const socketSend = (type: number, data: Buffer) => {\n        const header = Buffer.alloc(5);\n        header.writeUInt32BE(data.length + 1, 0);\n        header.writeUInt8(type, 4);\n\n        writable.write(Buffer.concat([header, data]));\n    }\n\n    const createSocketSend = (type: number) => {\n        return (data: Buffer) => {\n            return socketSend(type, data);\n        }\n    }\n\n    const sendMessageBuffer = createSocketSend(1);\n    const sendMessageFinish = createSocketSend(0);\n\n    const serializer = createRpcSerializer({\n        sendMessageBuffer,\n        sendMessageFinish: (message) => sendMessageFinish(Buffer.from(JSON.stringify(message))),\n    });\n\n    let header: Buffer;\n    let pending: Buffer;\n    let offset: number;\n    let type: number;\n\n    const onData = (data: Buffer) => {\n        while (data.length) {\n            if (!pending) {\n                if (!header)\n                    header = data;\n                else\n                    header = Buffer.concat([header, data]);\n                if (header.length < 5)\n                    return;\n\n                // slice is used below because in web environment,\n                // babel seems to return a Uint8Arrray when subarray is called.\n                data = header.slice(5);\n                // length includes type field.\n                const length = header.readUInt32BE(0) - 1;\n                type = header.readUInt8(4);\n                if (data.length >= length && type === 0) {\n                    // no need to alloc a buffer for this, since it can be immediately parsed\n                    // as json.\n                    pending = data.length === length ? data : data.slice(0, length);\n                    offset = length;\n                    data = data.slice(length);\n                }\n                else {\n                    pending = Buffer.alloc(length);\n                    offset = 0;\n                }\n                header = undefined;\n            }\n\n            const need = pending.length - offset;\n            if (need) {\n                const sub = data.slice(0, need);\n                data = data.slice(need);\n                pending.set(sub, offset);\n                offset += sub.length;\n            }\n\n            if (offset !== pending.length)\n                return;\n\n            const payload = pending;\n            pending = undefined;\n\n            if (type === 0) {\n                try {\n                    const message = JSON.parse(payload.toString());\n                    serializer.onMessageFinish(message);\n                }\n                catch (e) {\n                    serializer.kill('message parse failure ' + (e as Error).message);\n                }\n            }\n            else {\n                serializer.onMessageBuffer(payload);\n            }\n        }\n    }\n\n    return {\n        onData,\n        setupRpcPeer: serializer.setupRpcPeer,\n        sendMessage: serializer.sendMessage,\n        onDisconnected: serializer.onDisconnected,\n    };\n}\n\nexport function createDataChannelSerializer(dc: { send: (data: Buffer) => void }) {\n    // Chunking and debouncing state\n    let pending: Buffer[];\n    \n    // Max packet size for data channels is 16KB\n    const MAX_PACKET_SIZE = 16384;\n\n    // Flush pending chunks with proper chunking\n    function flushPending() {\n        if (!pending || pending.length === 0)\n            return;\n            \n        const chunks = pending;\n        pending = undefined;\n        \n        // Process all pending chunks\n        for (const data of chunks) {\n            let offset = 0;\n            \n            // Split data into chunks that fit within MAX_PACKET_SIZE\n            while (offset < data.length) {\n                const remaining = data.length - offset;\n                const chunkSize = Math.min(remaining, MAX_PACKET_SIZE);\n                const chunkData = data.subarray(offset, offset + chunkSize);\n                \n                dc.send(chunkData);\n                offset += chunkSize;\n            }\n        }\n    }\n\n    // Queue data for sending with next-tick debouncing\n    function queuePending(data: Buffer) {\n        const hadPending = !!pending;\n        if (!pending)\n            pending = [];\n        pending.push(data);\n        \n        // Schedule flush for next tick if not already scheduled\n        if (!hadPending) {\n            setTimeout(() => flushPending(), 0);\n        }\n    }\n\n    // Create a wrapper around the data channel send method for chunking\n    const chunkingDataChannel = {\n        write: (data: Buffer) => {\n            queuePending(data);\n        }\n    };\n\n    // Create the duplex serializer which handles all RPC serialization\n    const duplexSerializer = createRpcDuplexSerializer(chunkingDataChannel);\n\n    return duplexSerializer;\n}\n","import { RtpHeader } from \"../../rtp/rtp\";\nimport type { SrtpProfile } from \"../const\";\nimport { Context } from \"./context\";\n\nexport class SrtpContext extends Context {\n  constructor(masterKey: Buffer, masterSalt: Buffer, profile: SrtpProfile) {\n    super(masterKey, masterSalt, profile);\n  }\n\n  encryptRtp(payload: Buffer, header: RtpHeader) {\n    const s = this.getSrtpSsrcState(header.ssrc);\n    this.updateRolloverCount(header.sequenceNumber, s);\n\n    const enc = this.cipher.encryptRtp(header, payload, s.rolloverCounter);\n    return enc;\n  }\n\n  decryptRtp(cipherText: Buffer): [Buffer, RtpHeader] {\n    const header = RtpHeader.deSerialize(cipherText);\n\n    const s = this.getSrtpSsrcState(header.ssrc);\n    this.updateRolloverCount(header.sequenceNumber, s);\n\n    const dec = this.cipher.decryptRtp(cipherText, s.rolloverCounter);\n    return dec;\n  }\n}\n","export * from \"../../../common/src\";\n","'use strict'\n\nexports.toString = function (klass) {\n  switch (klass) {\n    case 1: return 'IN'\n    case 2: return 'CS'\n    case 3: return 'CH'\n    case 4: return 'HS'\n    case 255: return 'ANY'\n  }\n  return 'UNKNOWN_' + klass\n}\n\nexports.toClass = function (name) {\n  switch (name.toUpperCase()) {\n    case 'IN': return 1\n    case 'CS': return 2\n    case 'CH': return 3\n    case 'HS': return 4\n    case 'ANY': return 255\n  }\n  return 0\n}\n","module.exports = require(\"child_process\");","'use strict';\n\nconst { isType } = require('lib/util');\nconst NotEnoughDataError = require('lib/not-enough-data-error');\n\nmodule.exports = string;\n\n/**\n * Type for strings.\n * @param {Object|number|null} length The number of bytes or type for size-prefixed strings.\n * @param {string} encoding\n * @returns {Object}\n */\nfunction string(length, encoding = 'ascii') {\n  if (!Buffer.isEncoding(encoding)) {\n    throw new Error('Argument #2 should be an encoding name.');\n  }\n\n  if (typeof length === 'number') {\n    return {\n      encode: encodeFixedString(length, encoding),\n      decode: decodeFixedString(length, encoding),\n      encodingLength: () => length,\n    };\n  }\n\n  if (isType(length)) {\n    return {\n      encode: encodeSizePrefixedString(length, encoding),\n      decode: decodeSizePrefixedString(length, encoding),\n      encodingLength: encodingLengthSizePrefixedString(length, encoding),\n    };\n  }\n\n  if (length === null) {\n    return {\n      encode: encodeNullString(encoding),\n      decode: decodeNullString(encoding),\n\n      /**\n       * Get the number bytes to encode provided string.\n       * @param {string} value\n       * @returns {number}\n       */\n      encodingLength(value) {\n        return Buffer.byteLength(value, encoding) + 1;\n      },\n    };\n  }\n\n  if (typeof length === 'function') {\n    return {\n      encode: encodeCallback(length, encoding),\n      decode: decodeCallback(length, encoding),\n\n      /**\n       * Get the number bytes to encode provided string.\n       * @param {string} value\n       * @returns {number}\n       */\n      encodingLength(value) {\n        return Buffer.byteLength(value, encoding);\n      },\n    };\n  }\n\n  throw new TypeError('Unknown type of argument #1.');\n}\n\n/**\n * Encode null-terminated string.\n * @param {string} encoding\n * @returns {Function}\n */\nfunction encodeNullString(encoding) {\n  return function encode(value, wstream) {\n    const buf = Buffer.from(value.toString(), encoding);\n\n    wstream.writeBuffer(buf);\n    wstream.writeInt8(0);\n\n    encode.bytes = buf.length + 1;\n  };\n}\n\n/**\n * Decode null-terminated string.\n * @param {string} encoding\n * @returns {Function}\n */\nfunction decodeNullString(encoding) {\n  return function decode(rstream) {\n    const bytes = rstream.indexOf(0);\n\n    if (bytes === -1) {\n      throw new NotEnoughDataError(rstream.length + 1, rstream.length);\n    }\n\n    const bytesWithNull = bytes + 1;\n    const buf = rstream.readBuffer(bytesWithNull);\n    decode.bytes = bytesWithNull;\n\n    return buf.toString(encoding, 0, bytes);\n  };\n}\n\n/**\n * Encode fixed-length string.\n * @param {number} size The length of the string.\n * @param {string} encoding\n * @returns {Function}\n */\nfunction encodeFixedString(size, encoding) {\n  return function encode(value, wstream) {\n    value = value.toString(); // eslint-disable-line no-param-reassign\n\n    if (Buffer.byteLength(value, encoding) !== size) {\n      throw new Error(`Size of string should be ${size} in bytes.`);\n    }\n\n    const buf = Buffer.from(value, encoding);\n\n    wstream.writeBuffer(buf);\n    encode.bytes = buf.length;\n  };\n}\n\n/**\n * Decode fixed-length string.\n * @param {number} size The length of the string.\n * @param {string} encoding\n * @returns {Function}\n */\nfunction decodeFixedString(size, encoding) {\n  return function decode(rstream) {\n    const buf = rstream.readBuffer(size);\n    decode.bytes = size;\n\n    return buf.toString(encoding);\n  };\n}\n\n/**\n * Encode size-prefixed string.\n * @param {Object} type Number type.\n * @param {string} encoding\n * @returns {number}\n */\nfunction encodeSizePrefixedString(type, encoding) {\n  return function encode(value, wstream) {\n    value = value.toString(); // eslint-disable-line no-param-reassign\n\n    const context = this;\n\n    type.encode.call(context, Buffer.byteLength(value, encoding), wstream);\n    encode.bytes = type.encode.bytes;\n\n    const buf = Buffer.from(value, encoding);\n\n    wstream.writeBuffer(buf);\n    encode.bytes += buf.length;\n  };\n}\n\n/**\n * Decode size-prefixed string.\n * @param {Object} type Number type.\n * @param {string} encoding\n * @returns {number}\n */\nfunction decodeSizePrefixedString(type, encoding) {\n  return function decode(rstream) {\n    const size = type.decode.call(this, rstream);\n\n    if (typeof size !== 'number') {\n      throw new TypeError('Size of a string should be a number.');\n    }\n\n    const buf = rstream.readBuffer(size);\n    decode.bytes = type.decode.bytes + buf.length;\n\n    return buf.toString(encoding);\n  };\n}\n\n/**\n * Get the number of bytes of size-prefixed string.\n * @param {Object} type Number type.\n * @param {string} encoding\n * @returns {number}\n */\nfunction encodingLengthSizePrefixedString(type, encoding) {\n  return function encodingLength(value) {\n    const size = Buffer.byteLength(value, encoding);\n\n    return type.encodingLength(size) + size;\n  };\n}\n\n/**\n * Encode the string with dynamic evaluated size.\n * @param {Function} callback Function that returns a number.\n * @param {string} encoding\n * @returns {number}\n */\nfunction encodeCallback(callback, encoding) {\n  return function encode(value, wstream) {\n    encode.bytes = 0;\n\n    const context = this;\n\n    const expectedLength = callback(context);\n    const buf = Buffer.from(value.toString(), encoding);\n\n    checkLengthType(expectedLength);\n    checkLength(expectedLength, buf.length);\n\n    wstream.writeBuffer(buf);\n    encode.bytes += buf.length;\n  };\n}\n\n/**\n * Decode the string with dynamic evaluated size.\n * @param {Function} callback Function that returns a number.\n * @param {string} encoding\n * @returns {number}\n */\nfunction decodeCallback(callback, encoding) {\n  return function decode(rstream) {\n    const size = callback(this);\n    checkLengthType(size);\n\n    const buf = rstream.readBuffer(size);\n    decode.bytes = size;\n\n    return buf.toString(encoding);\n  };\n}\n\n/**\n * @param {any} length\n */\nfunction checkLengthType(length) {\n  if (typeof length !== 'number') {\n    throw new TypeError('Length of a buffer should be a number.');\n  }\n}\n\n/**\n * @param {number} requiredSize\n * @param {number} havingSize\n */\nfunction checkLength(requiredSize, havingSize) {\n  if (requiredSize !== havingSize) {\n    throw new Error(\n      `Buffer required length ${requiredSize} instead of ${havingSize}`\n    );\n  }\n}\n","import { bufferReader, bufferWriter } from \"../../../../common/src\";\n\ntype firEntry = { ssrc: number; sequenceNumber: number };\n\nexport class FullIntraRequest {\n  static count = 4;\n  count = FullIntraRequest.count;\n\n  senderSsrc!: number;\n  mediaSsrc!: number;\n  fir: firEntry[] = [];\n\n  constructor(props: Partial<FullIntraRequest> = {}) {\n    Object.assign(this, props);\n  }\n\n  get length() {\n    return Math.floor(this.serialize().length / 4 - 1);\n  }\n\n  static deSerialize(data: Buffer) {\n    const [senderSsrc, mediaSsrc] = bufferReader(data, [4, 4]);\n    const fir: firEntry[] = [];\n    for (let i = 8; i < data.length; i += 8) {\n      fir.push({ ssrc: data.readUInt32BE(i), sequenceNumber: data[i + 4] });\n    }\n\n    return new FullIntraRequest({ senderSsrc, mediaSsrc, fir });\n  }\n\n  serialize() {\n    const ssrcs = bufferWriter([4, 4], [this.senderSsrc, this.mediaSsrc]);\n\n    const fir = Buffer.alloc(this.fir.length * 8);\n    this.fir.forEach(({ ssrc, sequenceNumber }, i) => {\n      fir.writeUInt32BE(ssrc, i * 8);\n      fir[i * 8 + 4] = sequenceNumber;\n    });\n\n    return Buffer.concat([ssrcs, fir]);\n  }\n}\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/x509\n//\n// **License:** MIT\nvar common_1 = require(\"./common\");\nexports.bytesFromIP = common_1.bytesFromIP;\nexports.bytesToIP = common_1.bytesToIP;\nexports.getOID = common_1.getOID;\nexports.getOIDName = common_1.getOIDName;\nvar pki_1 = require(\"./pki\");\nexports.PublicKey = pki_1.PublicKey;\nexports.PrivateKey = pki_1.PrivateKey;\nexports.RSAPublicKey = pki_1.RSAPublicKey;\nexports.RSAPrivateKey = pki_1.RSAPrivateKey;\nvar x509_1 = require(\"./x509\");\nexports.Certificate = x509_1.Certificate;\nexports.DistinguishedName = x509_1.DistinguishedName;\n//# sourceMappingURL=index.js.map","export const RtcpTransportLayerFeedbackType = 205;\n","export * from \"../../../common/src\";\n","import { Deferred } from \"./deferred\";\n\nclass EndError extends Error {\n}\n\nexport function createAsyncQueue<T>() {\n    let ended: Error | undefined;\n    const endDeferred = new Deferred<void>();\n    const waiting: Deferred<T>[] = [];\n    const queued: { item: T, dequeued?: Deferred<void> }[] = [];\n\n    const wait = async (index: number) => {\n        const q = queued[index];\n        if (!q)\n            return;\n        if (!q.dequeued) {\n            q.dequeued = new Deferred<void>();\n        }\n        return q.dequeued.promise;\n    }\n\n    const dequeue = async () => {\n        if (queued.length) {\n            const { item, dequeued: enqueue } = queued.shift()!;\n            enqueue?.resolve();\n            return item;\n        }\n\n        if (ended)\n            throw ended;\n\n        const deferred = new Deferred<T>();\n        waiting.push(deferred);\n        return deferred.promise;\n    }\n\n    const take = () => {\n        if (queued.length) {\n            const { item, dequeued: enqueue } = queued.shift()!;\n            enqueue?.resolve();\n            return item;\n        }\n\n        if (ended)\n            throw ended;\n    }\n\n    const submit = (item: T, dequeued?: Deferred<void>, signal?: AbortSignal) => {\n        if (ended)\n            return false;\n\n        if (waiting.length) {\n            const deferred = waiting.shift()!;\n            dequeued?.resolve();\n            deferred.resolve(item);\n            return true;\n        }\n\n        if (signal)\n            dequeued ||= new Deferred();\n\n        const qi = {\n            item,\n            dequeued,\n        };\n        queued!.push(qi);\n\n        if (!signal)\n            return true;\n\n        const h = () => {\n            const index = queued.indexOf(qi);\n            if (index === -1)\n                return;\n            queued.splice(index, 1);\n            dequeued?.reject(new Error('abort'));\n        };\n\n        dequeued?.promise.catch(() => { }).finally(() => signal.removeEventListener('abort', h));\n        signal.addEventListener('abort', h);\n\n        return true;\n    }\n\n    function end(e?: Error) {\n        if (ended)\n            return false;\n        // catch to prevent unhandled rejection.\n        ended = e || new EndError();\n        endDeferred.resolve();\n        while (waiting.length) {\n            waiting.shift()!.reject(ended);\n        }\n        return true;\n    }\n\n    function queue() {\n        return (async function* () {\n            try {\n                while (true) {\n                    try {\n                        const item = await dequeue();\n                        yield item;\n                    }\n                    catch (e) {\n                        // the yield above may raise an error, and the queue should be ended.\n                        end(e as Error);\n                        if (e instanceof EndError)\n                            return;\n                        throw e;\n                    }\n                }\n            }\n            finally {\n                // the yield above may cause an iterator return, and the queue should be ended.\n                end();\n            }\n        })();\n    }\n\n    function clear(error?: Error) {\n        const ret: T[] = [];\n        const items = queued.splice(0, queued.length);\n        for (const item of items) {\n            if (error)\n                item.dequeued?.reject(error)\n            else\n                item.dequeued?.resolve(undefined);\n            ret.push(item.item);\n        }\n\n        return ret;\n    }\n\n    return {\n        [Symbol.dispose]() {\n            end(new Error('async queue disposed'));\n        },\n        get ended() {\n            return ended;\n        },\n        endPromise: endDeferred.promise,\n        take,\n        clear() {\n            return clear();\n        },\n        queued,\n        async pipe(callback: (i: T) => void) {\n            for await (const i of queue()) {\n                callback(i as any);\n            }\n        },\n        submit(item: T, signal?: AbortSignal) {\n            return submit(item, undefined, signal);\n        },\n        end,\n        async enqueue(item: T, signal?: AbortSignal) {\n            const dequeued = new Deferred<void>();\n            if (!submit(item, dequeued, signal))\n                return false;\n            await dequeued.promise;\n            return true;\n        },\n        dequeue,\n        get queue() {\n            return queue();\n        },\n        wait,\n    }\n}\n\nexport function createAsyncQueueFromGenerator<T>(generator: AsyncGenerator<T>) {\n    const q = createAsyncQueue<T>();\n    (async () => {\n        try {\n            for await (const i of generator) {\n                await q.enqueue(i);\n            }\n        }\n        catch (e) {\n            q.end(e as Error);\n        }\n        q.end();\n    })();\n\n    return q;\n}\n\n// async function testSlowEnqueue() {\n//     const asyncQueue = createAsyncQueue<number>();\n\n//     asyncQueue.submit(-1);\n//     asyncQueue.submit(-1);\n//     asyncQueue.submit(-1);\n//     asyncQueue.submit(-1);\n\n//     (async () => {\n//         console.log('go');\n//         for (let i = 0; i < 10; i++) {\n//             asyncQueue.submit(i);\n//             await sleep(100);\n//         }\n//         asyncQueue.end(new Error('fail'));\n//     })();\n\n\n//     const runQueue = async (str?: string) => {\n//         for await (const n of asyncQueue.queue) {\n//             console.log(str, n);\n//         }\n//     }\n\n//     runQueue('start');\n\n//     setTimeout(runQueue, 400);\n// }\n\n\n\n// async function testSlowDequeue() {\n//     const asyncQueue = createAsyncQueue<number>();\n\n//     const runQueue = async (str?: string) => {\n//         for await (const n of asyncQueue.queue) {\n//             await sleep(100);\n//         }\n//     }\n\n//     runQueue()\n//     .catch(e => console.error('queue threw', e));\n\n//     console.log('go');\n//     for (let i = 0; i < 10; i++) {\n//         console.log(await asyncQueue.enqueue(i));\n//         console.log(i);\n//     }\n//     asyncQueue.end(new Error('fail'));\n//     console.log(await asyncQueue.enqueue(555));\n// }\n\n// testSlowDequeue();\n","import { Certificate, PrivateKey } from \"@fidm/x509\";\n\nimport { randomUUID } from \"crypto\";\nimport { setTimeout } from \"timers/promises\";\nimport { Event, type Transport } from \"../imports/common\";\n\nimport type { AddressInfo } from \"net\";\nimport {\n  CipherContext,\n  DtlsClient,\n  DtlsServer,\n  type DtlsSocket,\n  HashAlgorithm,\n  NamedCurveAlgorithm,\n  SignatureAlgorithm,\n  type SignatureHash,\n} from \"../imports/dtls\";\nimport type { IceConnection } from \"../imports/ice\";\nimport {\n  type RtcpPacket,\n  RtcpPacketConverter,\n  type RtpHeader,\n  RtpPacket,\n  SrtcpSession,\n  type SrtpProfile,\n  SrtpSession,\n  debug,\n  isMedia,\n  isRtcp,\n  keyLength,\n  saltLength,\n} from \"../imports/rtp\";\nimport {\n  type RTCCertificateStats,\n  type RTCIceCandidatePairStats,\n  type RTCIceCandidateStats,\n  type RTCStats,\n  type RTCTransportStats,\n  generateStatsId,\n  getStatsTimestamp,\n} from \"../media/stats\";\nimport type { PeerConfig } from \"../peerConnection\";\nimport { fingerprint, isDtls } from \"../utils\";\nimport type { RTCIceTransport } from \"./ice\";\n\nconst log = debug(\"werift:packages/webrtc/src/transport/dtls.ts\");\n\nexport interface DtlsTransportStats {\n  bytesSent: number;\n  bytesReceived: number;\n  packetsSent: number;\n  packetsReceived: number;\n}\n\nexport class RTCDtlsTransport implements DtlsTransportStats {\n  id = randomUUID().toString();\n  state: DtlsState = \"new\";\n  role: DtlsRole = \"auto\";\n  srtpStarted = false;\n  transportSequenceNumber = 0;\n\n  // Statistics tracking\n  public bytesSent = 0;\n  public bytesReceived = 0;\n  public packetsSent = 0;\n  public packetsReceived = 0;\n\n  dataReceiver: (buf: Buffer) => void = () => {};\n  dtls?: DtlsSocket;\n  srtp!: SrtpSession;\n  srtcp!: SrtcpSession;\n\n  readonly onStateChange = new Event<[DtlsState]>();\n  readonly onRtcp = new Event<[RtcpPacket]>();\n  readonly onRtp = new Event<[RtpPacket]>();\n\n  static localCertificate?: RTCCertificate;\n  static localCertificatePromise?: Promise<RTCCertificate>;\n  private remoteParameters?: RTCDtlsParameters;\n\n  constructor(\n    readonly config: PeerConfig,\n    readonly iceTransport: RTCIceTransport,\n    public localCertificate?: RTCCertificate,\n    private readonly srtpProfiles: SrtpProfile[] = [],\n  ) {\n    this.localCertificate ??= RTCDtlsTransport.localCertificate;\n  }\n\n  get localParameters() {\n    return new RTCDtlsParameters(\n      this.localCertificate ? this.localCertificate.getFingerprints() : [],\n      this.role,\n    );\n  }\n\n  static async SetupCertificate() {\n    if (this.localCertificate) {\n      return this.localCertificate;\n    }\n\n    if (this.localCertificatePromise) {\n      return this.localCertificatePromise;\n    }\n\n    this.localCertificatePromise = (async () => {\n      const { certPem, keyPem, signatureHash } =\n        await CipherContext.createSelfSignedCertificateWithKey(\n          {\n            signature: SignatureAlgorithm.ecdsa_3,\n            hash: HashAlgorithm.sha256_4,\n          },\n          NamedCurveAlgorithm.secp256r1_23,\n        );\n      this.localCertificate = new RTCCertificate(\n        keyPem,\n        certPem,\n        signatureHash,\n      );\n      return this.localCertificate;\n    })();\n\n    return this.localCertificatePromise;\n  }\n\n  setRemoteParams(remoteParameters: RTCDtlsParameters) {\n    this.remoteParameters = remoteParameters;\n  }\n\n  async start() {\n    if (this.state !== \"new\") {\n      throw new Error(\"state must be new\");\n    }\n    if (this.remoteParameters?.fingerprints.length === 0) {\n      throw new Error(\"remote fingerprint not exist\");\n    }\n\n    if (this.role === \"auto\") {\n      if (this.iceTransport.role === \"controlling\") {\n        this.role = \"server\";\n      } else {\n        this.role = \"client\";\n      }\n    }\n\n    this.setState(\"connecting\");\n\n    await new Promise<void>(async (r, f) => {\n      if (this.role === \"server\") {\n        this.dtls = new DtlsServer({\n          cert: this.localCertificate?.certPem,\n          key: this.localCertificate?.privateKey,\n          signatureHash: this.localCertificate?.signatureHash,\n          transport: createIceTransport(this.iceTransport.connection),\n          srtpProfiles: this.srtpProfiles,\n          extendedMasterSecret: true,\n          // certificateRequest: true,\n        });\n      } else {\n        this.dtls = new DtlsClient({\n          cert: this.localCertificate?.certPem,\n          key: this.localCertificate?.privateKey,\n          signatureHash: this.localCertificate?.signatureHash,\n          transport: createIceTransport(this.iceTransport.connection),\n          srtpProfiles: this.srtpProfiles,\n          extendedMasterSecret: true,\n        });\n      }\n      this.dtls.onData.subscribe((buf) => {\n        if (\n          this.config.debug.inboundPacketLoss &&\n          this.config.debug.inboundPacketLoss / 100 < Math.random()\n        ) {\n          return;\n        }\n        this.dataReceiver(buf);\n      });\n      this.dtls.onClose.subscribe(() => {\n        this.setState(\"closed\");\n      });\n      this.dtls.onConnect.once(r);\n      this.dtls.onError.once((error) => {\n        this.setState(\"failed\");\n        log(\"dtls failed\", error);\n        f(error);\n      });\n\n      if (this.dtls instanceof DtlsClient) {\n        await setTimeout(100);\n        this.dtls.connect().catch((error) => {\n          this.setState(\"failed\");\n          log(\"dtls connect failed\", error);\n          f(error);\n        });\n      }\n    });\n\n    if (this.srtpProfiles.length > 0) {\n      this.startSrtp();\n    }\n    this.dtls!.onConnect.subscribe(() => {\n      this.updateSrtpSession();\n      this.setState(\"connected\");\n    });\n    this.setState(\"connected\");\n\n    log(\"dtls connected\");\n  }\n\n  updateSrtpSession() {\n    if (!this.dtls) throw new Error();\n\n    const profile = this.dtls.srtp.srtpProfile;\n    if (!profile) {\n      throw new Error(\"need srtpProfile\");\n    }\n    log(\"selected SRTP Profile\", profile);\n\n    const { localKey, localSalt, remoteKey, remoteSalt } =\n      this.dtls.extractSessionKeys(keyLength(profile), saltLength(profile));\n\n    const config = {\n      keys: {\n        localMasterKey: localKey,\n        localMasterSalt: localSalt,\n        remoteMasterKey: remoteKey,\n        remoteMasterSalt: remoteSalt,\n      },\n      profile,\n    };\n    this.srtp = new SrtpSession(config);\n    this.srtcp = new SrtcpSession(config);\n  }\n\n  startSrtp() {\n    if (this.srtpStarted) return;\n    this.srtpStarted = true;\n\n    this.updateSrtpSession();\n\n    this.iceTransport.connection.onData.subscribe((data) => {\n      if (\n        this.config.debug.inboundPacketLoss &&\n        this.config.debug.inboundPacketLoss / 100 < Math.random()\n      ) {\n        return;\n      }\n\n      if (!isMedia(data)) return;\n\n      // Track received data statistics\n      this.bytesReceived += data.length;\n      this.packetsReceived++;\n\n      if (isRtcp(data)) {\n        const dec = this.srtcp.decrypt(data);\n        const rtcpPackets = RtcpPacketConverter.deSerialize(dec);\n        for (const rtcp of rtcpPackets) {\n          try {\n            this.onRtcp.execute(rtcp);\n          } catch (error) {\n            log(\"RTCP error\", error);\n          }\n        }\n      } else {\n        const dec = this.srtp.decrypt(data);\n        const rtp = RtpPacket.deSerialize(dec);\n        try {\n          this.onRtp.execute(rtp);\n        } catch (error) {\n          log(\"RTP error\", error);\n        }\n      }\n    });\n  }\n\n  readonly sendData = async (data: Buffer) => {\n    if (\n      this.config.debug.outboundPacketLoss &&\n      this.config.debug.outboundPacketLoss / 100 < Math.random()\n    ) {\n      return;\n    }\n\n    if (!this.dtls) {\n      throw new Error(\"dtls not established\");\n    }\n    await this.dtls.send(data);\n  };\n\n  async sendRtp(payload: Buffer, header: RtpHeader): Promise<number> {\n    try {\n      const enc = this.srtp.encrypt(payload, header);\n\n      if (\n        this.config.debug.outboundPacketLoss &&\n        this.config.debug.outboundPacketLoss / 100 < Math.random()\n      ) {\n        return enc.length;\n      }\n\n      // Track statistics\n      this.bytesSent += enc.length;\n      this.packetsSent++;\n\n      await this.iceTransport.connection.send(enc).catch(() => {});\n      return enc.length;\n    } catch (error) {\n      log(\"failed to send\", error);\n      return 0;\n    }\n  }\n\n  async sendRtcp(packets: RtcpPacket[]) {\n    const payload = Buffer.concat(packets.map((packet) => packet.serialize()));\n    const enc = this.srtcp.encrypt(payload);\n\n    if (\n      this.config.debug.outboundPacketLoss &&\n      this.config.debug.outboundPacketLoss / 100 < Math.random()\n    ) {\n      return enc.length;\n    }\n\n    // Track statistics\n    this.bytesSent += enc.length;\n    this.packetsSent++;\n\n    await this.iceTransport.connection.send(enc).catch(() => {});\n  }\n\n  private setState(state: DtlsState) {\n    if (state != this.state) {\n      this.state = state;\n      this.onStateChange.execute(state);\n    }\n  }\n\n  async stop() {\n    this.setState(\"closed\");\n    // todo impl send alert\n    await this.iceTransport.stop();\n  }\n\n  async getStats(): Promise<RTCStats[]> {\n    const timestamp = getStatsTimestamp();\n    const stats: RTCStats[] = [];\n\n    const transportId = generateStatsId(\"transport\", this.id);\n\n    // Transport stats\n    const transportStats: RTCTransportStats = {\n      type: \"transport\",\n      id: transportId,\n      timestamp,\n      bytesSent: this.bytesSent,\n      bytesReceived: this.bytesReceived,\n      packetsSent: this.packetsSent,\n      packetsReceived: this.packetsReceived,\n      dtlsState: this.state,\n      iceState: this.iceTransport.state,\n      selectedCandidatePairId: this.iceTransport.connection.nominated\n        ? generateStatsId(\n            \"candidate-pair\",\n            this.iceTransport.connection.nominated.localCandidate.foundation,\n            this.iceTransport.connection.nominated.remoteCandidate.foundation,\n          )\n        : undefined,\n      localCertificateId: this.localCertificate\n        ? generateStatsId(\"certificate\", \"local\")\n        : undefined,\n      remoteCertificateId: this.remoteParameters\n        ? generateStatsId(\"certificate\", \"remote\")\n        : undefined,\n      dtlsRole: this.role === \"auto\" ? undefined : this.role,\n    };\n    stats.push(transportStats);\n\n    // Certificate stats\n    if (this.localCertificate) {\n      const fingerprints = this.localCertificate.getFingerprints();\n      if (fingerprints.length > 0) {\n        const certStats: RTCCertificateStats = {\n          type: \"certificate\",\n          id: generateStatsId(\"certificate\", \"local\"),\n          timestamp,\n          fingerprint: fingerprints[0].value,\n          fingerprintAlgorithm: fingerprints[0].algorithm,\n          base64Certificate: Buffer.from(\n            this.localCertificate.certPem,\n          ).toString(\"base64\"),\n        };\n        stats.push(certStats);\n      }\n    }\n\n    if (\n      this.remoteParameters &&\n      this.remoteParameters.fingerprints.length > 0\n    ) {\n      const certStats: RTCCertificateStats = {\n        type: \"certificate\",\n        id: generateStatsId(\"certificate\", \"remote\"),\n        timestamp,\n        fingerprint: this.remoteParameters.fingerprints[0].value,\n        fingerprintAlgorithm: this.remoteParameters.fingerprints[0].algorithm,\n        base64Certificate: \"\", // Remote certificate content not available\n      };\n      stats.push(certStats);\n    }\n\n    // Get ICE stats\n    const iceStats = await this.iceTransport.getStats();\n    stats.push(...iceStats);\n\n    return stats;\n  }\n}\n\nexport const DtlsStates = [\n  \"new\",\n  \"connecting\",\n  \"connected\",\n  \"closed\",\n  \"failed\",\n] as const;\nexport type DtlsState = (typeof DtlsStates)[number];\n\nexport type DtlsRole = \"auto\" | \"server\" | \"client\";\n\nexport class RTCCertificate {\n  publicKey: string;\n  privateKey: string;\n\n  constructor(\n    privateKeyPem: string,\n    public certPem: string,\n    public signatureHash: SignatureHash,\n  ) {\n    const cert = Certificate.fromPEM(Buffer.from(certPem));\n    this.publicKey = cert.publicKey.toPEM();\n    this.privateKey = PrivateKey.fromPEM(Buffer.from(privateKeyPem)).toPEM();\n  }\n\n  getFingerprints(): RTCDtlsFingerprint[] {\n    return [\n      new RTCDtlsFingerprint(\n        \"sha-256\",\n        fingerprint(\n          Certificate.fromPEM(Buffer.from(this.certPem)).raw,\n          \"sha256\",\n        ),\n      ),\n    ];\n  }\n}\n\nexport type DtlsKeys = {\n  certPem: string;\n  keyPem: string;\n  signatureHash: SignatureHash;\n};\n\nexport class RTCDtlsFingerprint {\n  constructor(\n    public algorithm: string,\n    public value: string,\n  ) {}\n}\n\nexport class RTCDtlsParameters {\n  constructor(\n    public fingerprints: RTCDtlsFingerprint[] = [],\n    public role: \"auto\" | \"client\" | \"server\",\n  ) {}\n}\n\nclass IceTransport implements Transport {\n  closed: boolean = false;\n  constructor(private ice: IceConnection) {\n    ice.onData.subscribe((buf) => {\n      if (isDtls(buf)) {\n        if (this.onData) {\n          this.onData(buf);\n        }\n      }\n    });\n  }\n  onData: (buf: Buffer) => void = () => {};\n\n  get address() {\n    return {} as AddressInfo;\n  }\n\n  type: string = \"ice\";\n\n  readonly send = (data: Buffer) => {\n    return this.ice.send(data);\n  };\n\n  async close() {\n    this.closed = true;\n    this.ice.close();\n  }\n}\n\nconst createIceTransport = (ice: IceConnection) => new IceTransport(ice);\n","import { Event } from \"../../imports/common\";\n\nimport { uint16Add } from \"../../imports/common\";\nimport {\n  GenericNack,\n  RtcpTransportLayerFeedback,\n  type RtpPacket,\n  debug,\n} from \"../../imports/rtp\";\nimport type { RTCRtpReceiver } from \"../rtpReceiver\";\n\nconst log = debug(\"werift:packages/webrtc/src/media/receiver/nack.ts\");\n\nconst LOST_SIZE = 30 * 5;\n\nexport class NackHandler {\n  private newEstSeqNum = 0;\n  private _lost: { [seqNum: number]: number } = {};\n  private nackLoop: any;\n\n  readonly onPacketLost = new Event<[GenericNack]>();\n  mediaSourceSsrc?: number;\n  retryCount = 10;\n  closed = false;\n\n  constructor(private receiver: RTCRtpReceiver) {}\n\n  get lostSeqNumbers() {\n    return Object.keys(this._lost).map(Number).sort();\n  }\n\n  private getLost(seq: number) {\n    return this._lost[seq];\n  }\n\n  private setLost(seq: number, count: number) {\n    this._lost[seq] = count;\n\n    if (this.nackLoop || this.closed) {\n      return;\n    }\n    this.nackLoop = setInterval(async () => {\n      try {\n        await this.sendNack();\n        if (!Object.keys(this._lost).length) {\n          clearInterval(this.nackLoop);\n          this.nackLoop = undefined;\n        }\n      } catch (error) {\n        log(\"failed to send nack\", error);\n      }\n    }, 5);\n  }\n\n  private removeLost(sequenceNumber: number) {\n    delete this._lost[sequenceNumber];\n  }\n\n  addPacket(packet: RtpPacket) {\n    const { sequenceNumber, ssrc } = packet.header;\n    this.mediaSourceSsrc = ssrc;\n\n    if (this.newEstSeqNum === 0) {\n      this.newEstSeqNum = sequenceNumber;\n      return;\n    }\n\n    if (this.getLost(sequenceNumber)) {\n      // log(\"packetLoss resolved\", { sequenceNumber });\n      this.removeLost(sequenceNumber);\n      return;\n    }\n\n    if (sequenceNumber === uint16Add(this.newEstSeqNum, 1)) {\n      this.newEstSeqNum = sequenceNumber;\n    } else if (sequenceNumber > uint16Add(this.newEstSeqNum, 1)) {\n      // packet lost detected\n      for (\n        let i = uint16Add(this.newEstSeqNum, 1);\n        i < sequenceNumber;\n        i = uint16Add(i, 1)\n      ) {\n        this.setLost(i, 1);\n      }\n      // this.receiver.sendRtcpPLI(this.mediaSourceSsrc);\n\n      this.newEstSeqNum = sequenceNumber;\n      this.pruneLost();\n    }\n  }\n\n  private pruneLost() {\n    if (this.lostSeqNumbers.length > LOST_SIZE) {\n      this._lost = Object.entries(this._lost)\n        .slice(-LOST_SIZE)\n        .reduce(\n          (acc, [key, v]) => {\n            acc[key] = v;\n            return acc;\n          },\n          {} as { [seqNum: number]: number },\n        );\n    }\n  }\n\n  close() {\n    this.closed = true;\n    clearInterval(this.nackLoop);\n    this._lost = {};\n  }\n\n  private updateRetryCount() {\n    this.lostSeqNumbers.forEach((seq) => {\n      const count = this._lost[seq]++;\n      if (count > this.retryCount) {\n        this.removeLost(seq);\n        return seq;\n      }\n    });\n  }\n\n  private sendNack = () =>\n    new Promise((r, f) => {\n      if (this.lostSeqNumbers.length > 0 && this.mediaSourceSsrc) {\n        const nack = new GenericNack({\n          senderSsrc: this.receiver.rtcpSsrc,\n          mediaSourceSsrc: this.mediaSourceSsrc,\n          lost: this.lostSeqNumbers,\n        });\n\n        const rtcp = new RtcpTransportLayerFeedback({\n          feedback: nack,\n        });\n        this.receiver.dtlsTransport.sendRtcp([rtcp]).then(r).catch(f);\n\n        this.updateRetryCount();\n        this.onPacketLost.execute(nack);\n      }\n    });\n}\n","// int64-buffer.js\n\n/*jshint -W018 */ // Confusing use of '!'.\n/*jshint -W030 */ // Expected an assignment or function call and instead saw an expression.\n/*jshint -W093 */ // Did you mean to return a conditional instead of an assignment?\n\nvar Uint64BE, Int64BE, Uint64LE, Int64LE;\n\n!function(exports) {\n  // constants\n\n  var UNDEFINED = \"undefined\";\n  var BUFFER = (UNDEFINED !== typeof Buffer) && Buffer;\n  var UINT8ARRAY = (UNDEFINED !== typeof Uint8Array) && Uint8Array;\n  var ARRAYBUFFER = (UNDEFINED !== typeof ArrayBuffer) && ArrayBuffer;\n  var ZERO = [0, 0, 0, 0, 0, 0, 0, 0];\n  var isArray = Array.isArray || _isArray;\n  var BIT32 = 4294967296;\n  var BIT24 = 16777216;\n\n  // storage class\n\n  var storage; // Array;\n\n  // generate classes\n\n  Uint64BE = factory(\"Uint64BE\", true, true);\n  Int64BE = factory(\"Int64BE\", true, false);\n  Uint64LE = factory(\"Uint64LE\", false, true);\n  Int64LE = factory(\"Int64LE\", false, false);\n\n  // class factory\n\n  function factory(name, bigendian, unsigned) {\n    var posH = bigendian ? 0 : 4;\n    var posL = bigendian ? 4 : 0;\n    var pos0 = bigendian ? 0 : 3;\n    var pos1 = bigendian ? 1 : 2;\n    var pos2 = bigendian ? 2 : 1;\n    var pos3 = bigendian ? 3 : 0;\n    var fromPositive = bigendian ? fromPositiveBE : fromPositiveLE;\n    var fromNegative = bigendian ? fromNegativeBE : fromNegativeLE;\n    var proto = Int64.prototype;\n    var isName = \"is\" + name;\n    var _isInt64 = \"_\" + isName;\n\n    // properties\n    proto.buffer = void 0;\n    proto.offset = 0;\n    proto[_isInt64] = true;\n\n    // methods\n    proto.toNumber = toNumber;\n    proto.toString = toString;\n    proto.toJSON = toNumber;\n    proto.toArray = toArray;\n\n    // add .toBuffer() method only when Buffer available\n    if (BUFFER) proto.toBuffer = toBuffer;\n\n    // add .toArrayBuffer() method only when Uint8Array available\n    if (UINT8ARRAY) proto.toArrayBuffer = toArrayBuffer;\n\n    // isUint64BE, isInt64BE\n    Int64[isName] = isInt64;\n\n    // CommonJS\n    exports[name] = Int64;\n\n    return Int64;\n\n    // constructor\n    function Int64(buffer, offset, value, raddix) {\n      if (!(this instanceof Int64)) return new Int64(buffer, offset, value, raddix);\n      return init(this, buffer, offset, value, raddix);\n    }\n\n    // isUint64BE, isInt64BE\n    function isInt64(b) {\n      return !!(b && b[_isInt64]);\n    }\n\n    // initializer\n    function init(that, buffer, offset, value, raddix) {\n      if (UINT8ARRAY && ARRAYBUFFER) {\n        if (buffer instanceof ARRAYBUFFER) buffer = new UINT8ARRAY(buffer);\n        if (value instanceof ARRAYBUFFER) value = new UINT8ARRAY(value);\n      }\n\n      // Int64BE() style\n      if (!buffer && !offset && !value && !storage) {\n        // shortcut to initialize with zero\n        that.buffer = newArray(ZERO, 0);\n        return;\n      }\n\n      // Int64BE(value, raddix) style\n      if (!isValidBuffer(buffer, offset)) {\n        var _storage = storage || Array;\n        raddix = offset;\n        value = buffer;\n        offset = 0;\n        buffer = (storage === BUFFER) ? BUFFER.alloc(8) : new _storage(8);\n      }\n\n      that.buffer = buffer;\n      that.offset = offset |= 0;\n\n      // Int64BE(buffer, offset) style\n      if (UNDEFINED === typeof value) return;\n\n      // Int64BE(buffer, offset, value, raddix) style\n      if (\"string\" === typeof value) {\n        fromString(buffer, offset, value, raddix || 10);\n      } else if (isValidBuffer(value, raddix)) {\n        fromArray(buffer, offset, value, raddix);\n      } else if (\"number\" === typeof raddix) {\n        writeInt32(buffer, offset + posH, value); // high\n        writeInt32(buffer, offset + posL, raddix); // low\n      } else if (value > 0) {\n        fromPositive(buffer, offset, value); // positive\n      } else if (value < 0) {\n        fromNegative(buffer, offset, value); // negative\n      } else {\n        fromArray(buffer, offset, ZERO, 0); // zero, NaN and others\n      }\n    }\n\n    function fromString(buffer, offset, str, raddix) {\n      var pos = 0;\n      var len = str.length;\n      var high = 0;\n      var low = 0;\n      if (str[0] === \"-\") pos++;\n      var sign = pos;\n      while (pos < len) {\n        var chr = parseInt(str[pos++], raddix);\n        if (!(chr >= 0)) break; // NaN\n        low = low * raddix + chr;\n        high = high * raddix + Math.floor(low / BIT32);\n        low %= BIT32;\n      }\n      if (sign) {\n        high = ~high;\n        if (low) {\n          low = BIT32 - low;\n        } else {\n          high++;\n        }\n      }\n      writeInt32(buffer, offset + posH, high);\n      writeInt32(buffer, offset + posL, low);\n    }\n\n    function toNumber() {\n      var buffer = this.buffer;\n      var offset = this.offset;\n      var high = readInt32(buffer, offset + posH);\n      var low = readInt32(buffer, offset + posL);\n      if (!unsigned) high |= 0; // a trick to get signed\n      return high ? (high * BIT32 + low) : low;\n    }\n\n    function toString(radix) {\n      var buffer = this.buffer;\n      var offset = this.offset;\n      var high = readInt32(buffer, offset + posH);\n      var low = readInt32(buffer, offset + posL);\n      var str = \"\";\n      var sign = !unsigned && (high & 0x80000000);\n      if (sign) {\n        high = ~high;\n        low = BIT32 - low;\n      }\n      radix = radix || 10;\n      while (1) {\n        var mod = (high % radix) * BIT32 + low;\n        high = Math.floor(high / radix);\n        low = Math.floor(mod / radix);\n        str = (mod % radix).toString(radix) + str;\n        if (!high && !low) break;\n      }\n      if (sign) {\n        str = \"-\" + str;\n      }\n      return str;\n    }\n\n    function writeInt32(buffer, offset, value) {\n      buffer[offset + pos3] = value & 255;\n      value = value >> 8;\n      buffer[offset + pos2] = value & 255;\n      value = value >> 8;\n      buffer[offset + pos1] = value & 255;\n      value = value >> 8;\n      buffer[offset + pos0] = value & 255;\n    }\n\n    function readInt32(buffer, offset) {\n      return (buffer[offset + pos0] * BIT24) +\n        (buffer[offset + pos1] << 16) +\n        (buffer[offset + pos2] << 8) +\n        buffer[offset + pos3];\n    }\n  }\n\n  function toArray(raw) {\n    var buffer = this.buffer;\n    var offset = this.offset;\n    storage = null; // Array\n\n    if (raw !== false && isArray(buffer)) {\n      return (buffer.length === 8) ? buffer : buffer.slice(offset, offset + 8);\n    }\n\n    return newArray(buffer, offset);\n  }\n\n  function toBuffer(raw) {\n    var buffer = this.buffer;\n    var offset = this.offset;\n    storage = BUFFER;\n\n    if (raw !== false && BUFFER.isBuffer(buffer)) {\n      return (buffer.length === 8) ? buffer : buffer.slice(offset, offset + 8);\n    }\n\n    // Buffer.from(arraybuffer) available since Node v4.5.0\n    // https://nodejs.org/en/blog/release/v4.5.0/\n    return BUFFER.from(toArrayBuffer.call(this, raw));\n  }\n\n  function toArrayBuffer(raw) {\n    var buffer = this.buffer;\n    var offset = this.offset;\n    var arrbuf = buffer.buffer;\n    storage = UINT8ARRAY;\n\n    // arrbuf.slice() ignores buffer.offset until Node v8.0.0\n    if (raw !== false && !buffer.offset && (arrbuf instanceof ARRAYBUFFER)) {\n      return (arrbuf.byteLength === 8) ? arrbuf : arrbuf.slice(offset, offset + 8);\n    }\n\n    var dest = new UINT8ARRAY(8);\n    fromArray(dest, 0, buffer, offset);\n    return dest.buffer;\n  }\n\n  function isValidBuffer(buffer, offset) {\n    var len = buffer && buffer.length;\n    offset |= 0;\n    return len && (offset + 8 <= len) && (\"string\" !== typeof buffer[offset]);\n  }\n\n  function fromArray(destbuf, destoff, srcbuf, srcoff) {\n    destoff |= 0;\n    srcoff |= 0;\n    for (var i = 0; i < 8; i++) {\n      destbuf[destoff++] = srcbuf[srcoff++] & 255;\n    }\n  }\n\n  function newArray(buffer, offset) {\n    return Array.prototype.slice.call(buffer, offset, offset + 8);\n  }\n\n  function fromPositiveBE(buffer, offset, value) {\n    var pos = offset + 8;\n    while (pos > offset) {\n      buffer[--pos] = value & 255;\n      value /= 256;\n    }\n  }\n\n  function fromNegativeBE(buffer, offset, value) {\n    var pos = offset + 8;\n    value++;\n    while (pos > offset) {\n      buffer[--pos] = ((-value) & 255) ^ 255;\n      value /= 256;\n    }\n  }\n\n  function fromPositiveLE(buffer, offset, value) {\n    var end = offset + 8;\n    while (offset < end) {\n      buffer[offset++] = value & 255;\n      value /= 256;\n    }\n  }\n\n  function fromNegativeLE(buffer, offset, value) {\n    var end = offset + 8;\n    value++;\n    while (offset < end) {\n      buffer[offset++] = ((-value) & 255) ^ 255;\n      value /= 256;\n    }\n  }\n\n  // https://github.com/retrofox/is-array\n  function _isArray(val) {\n    return !!val && \"[object Array]\" == Object.prototype.toString.call(val);\n  }\n\n}(typeof exports === 'object' && typeof exports.nodeName !== 'string' ? exports : (this || {}));\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isNegativeLE = void 0;\nexports.mod = mod;\nexports.pow = pow;\nexports.pow2 = pow2;\nexports.invert = invert;\nexports.tonelliShanks = tonelliShanks;\nexports.FpSqrt = FpSqrt;\nexports.validateField = validateField;\nexports.FpPow = FpPow;\nexports.FpInvertBatch = FpInvertBatch;\nexports.FpDiv = FpDiv;\nexports.FpLegendre = FpLegendre;\nexports.FpIsSquare = FpIsSquare;\nexports.nLength = nLength;\nexports.Field = Field;\nexports.FpSqrtOdd = FpSqrtOdd;\nexports.FpSqrtEven = FpSqrtEven;\nexports.hashToPrivateScalar = hashToPrivateScalar;\nexports.getFieldBytesLength = getFieldBytesLength;\nexports.getMinHashLength = getMinHashLength;\nexports.mapHashToField = mapHashToField;\n/**\n * Utils for modular division and finite fields.\n * A finite field over 11 is integer number operations `mod 11`.\n * There is no division: it is replaced by modular multiplicative inverse.\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nconst utils_js_1 = require(\"./utils.js\");\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = /* @__PURE__ */ BigInt(2), _3n = /* @__PURE__ */ BigInt(3);\n// prettier-ignore\nconst _4n = /* @__PURE__ */ BigInt(4), _5n = /* @__PURE__ */ BigInt(5), _8n = /* @__PURE__ */ BigInt(8);\n// prettier-ignore\nconst _9n = /* @__PURE__ */ BigInt(9), _16n = /* @__PURE__ */ BigInt(16);\n// Calculates a modulo b\nfunction mod(a, b) {\n    const result = a % b;\n    return result >= _0n ? result : b + result;\n}\n/**\n * Efficiently raise num to power and do modular division.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n * @todo use field version && remove\n * @example\n * pow(2n, 6n, 11n) // 64n % 11n == 9n\n */\nfunction pow(num, power, modulo) {\n    if (power < _0n)\n        throw new Error('invalid exponent, negatives unsupported');\n    if (modulo <= _0n)\n        throw new Error('invalid modulus');\n    if (modulo === _1n)\n        return _0n;\n    let res = _1n;\n    while (power > _0n) {\n        if (power & _1n)\n            res = (res * num) % modulo;\n        num = (num * num) % modulo;\n        power >>= _1n;\n    }\n    return res;\n}\n/** Does `x^(2^power)` mod p. `pow2(30, 4)` == `30^(2^4)` */\nfunction pow2(x, power, modulo) {\n    let res = x;\n    while (power-- > _0n) {\n        res *= res;\n        res %= modulo;\n    }\n    return res;\n}\n/**\n * Inverses number over modulo.\n * Implemented using [Euclidean GCD](https://brilliant.org/wiki/extended-euclidean-algorithm/).\n */\nfunction invert(number, modulo) {\n    if (number === _0n)\n        throw new Error('invert: expected non-zero number');\n    if (modulo <= _0n)\n        throw new Error('invert: expected positive modulus, got ' + modulo);\n    // Fermat's little theorem \"CT-like\" version inv(n) = n^(m-2) mod m is 30x slower.\n    let a = mod(number, modulo);\n    let b = modulo;\n    // prettier-ignore\n    let x = _0n, y = _1n, u = _1n, v = _0n;\n    while (a !== _0n) {\n        // JIT applies optimization if those two lines follow each other\n        const q = b / a;\n        const r = b % a;\n        const m = x - u * q;\n        const n = y - v * q;\n        // prettier-ignore\n        b = a, a = r, x = u, y = v, u = m, v = n;\n    }\n    const gcd = b;\n    if (gcd !== _1n)\n        throw new Error('invert: does not exist');\n    return mod(x, modulo);\n}\n/**\n * Tonelli-Shanks square root search algorithm.\n * 1. https://eprint.iacr.org/2012/685.pdf (page 12)\n * 2. Square Roots from 1; 24, 51, 10 to Dan Shanks\n * Will start an infinite loop if field order P is not prime.\n * @param P field order\n * @returns function that takes field Fp (created from P) and number n\n */\nfunction tonelliShanks(P) {\n    // Legendre constant: used to calculate Legendre symbol (a | p),\n    // which denotes the value of a^((p-1)/2) (mod p).\n    // (a | p)  1    if a is a square (mod p)\n    // (a | p)  -1   if a is not a square (mod p)\n    // (a | p)  0    if a  0 (mod p)\n    const legendreC = (P - _1n) / _2n;\n    let Q, S, Z;\n    // Step 1: By factoring out powers of 2 from p - 1,\n    // find q and s such that p - 1 = q*(2^s) with q odd\n    for (Q = P - _1n, S = 0; Q % _2n === _0n; Q /= _2n, S++)\n        ;\n    // Step 2: Select a non-square z such that (z | p)  -1 and set c  zq\n    for (Z = _2n; Z < P && pow(Z, legendreC, P) !== P - _1n; Z++) {\n        // Crash instead of infinity loop, we cannot reasonable count until P.\n        if (Z > 1000)\n            throw new Error('Cannot find square root: likely non-prime P');\n    }\n    // Fast-path\n    if (S === 1) {\n        const p1div4 = (P + _1n) / _4n;\n        return function tonelliFast(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Slow-path\n    const Q1div2 = (Q + _1n) / _2n;\n    return function tonelliSlow(Fp, n) {\n        // Step 0: Check that n is indeed a square: (n | p) should not be  -1\n        if (Fp.pow(n, legendreC) === Fp.neg(Fp.ONE))\n            throw new Error('Cannot find square root');\n        let r = S;\n        // TODO: will fail at Fp2/etc\n        let g = Fp.pow(Fp.mul(Fp.ONE, Z), Q); // will update both x and b\n        let x = Fp.pow(n, Q1div2); // first guess at the square root\n        let b = Fp.pow(n, Q); // first guess at the fudge factor\n        while (!Fp.eql(b, Fp.ONE)) {\n            if (Fp.eql(b, Fp.ZERO))\n                return Fp.ZERO; // https://en.wikipedia.org/wiki/Tonelli%E2%80%93Shanks_algorithm (4. If t = 0, return r = 0)\n            // Find m such b^(2^m)==1\n            let m = 1;\n            for (let t2 = Fp.sqr(b); m < r; m++) {\n                if (Fp.eql(t2, Fp.ONE))\n                    break;\n                t2 = Fp.sqr(t2); // t2 *= t2\n            }\n            // NOTE: r-m-1 can be bigger than 32, need to convert to bigint before shift, otherwise there will be overflow\n            const ge = Fp.pow(g, _1n << BigInt(r - m - 1)); // ge = 2^(r-m-1)\n            g = Fp.sqr(ge); // g = ge * ge\n            x = Fp.mul(x, ge); // x *= ge\n            b = Fp.mul(b, g); // b *= g\n            r = m;\n        }\n        return x;\n    };\n}\n/**\n * Square root for a finite field. It will try to check if optimizations are applicable and fall back to 4:\n *\n * 1. P  3 (mod 4)\n * 2. P  5 (mod 8)\n * 3. P  9 (mod 16)\n * 4. Tonelli-Shanks algorithm\n *\n * Different algorithms can give different roots, it is up to user to decide which one they want.\n * For example there is FpSqrtOdd/FpSqrtEven to choice root based on oddness (used for hash-to-curve).\n */\nfunction FpSqrt(P) {\n    // P  3 (mod 4)\n    // n = n^((P+1)/4)\n    if (P % _4n === _3n) {\n        // Not all roots possible!\n        // const ORDER =\n        //   0x1a0111ea397fe69a4b1ba7b6434bacd764774b84f38512bf6730d2a0f6b0f6241eabfffeb153ffffb9feffffffffaaabn;\n        // const NUM = 72057594037927816n;\n        const p1div4 = (P + _1n) / _4n;\n        return function sqrt3mod4(Fp, n) {\n            const root = Fp.pow(n, p1div4);\n            // Throw if root**2 != n\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // Atkin algorithm for q  5 (mod 8), https://eprint.iacr.org/2012/685.pdf (page 10)\n    if (P % _8n === _5n) {\n        const c1 = (P - _5n) / _8n;\n        return function sqrt5mod8(Fp, n) {\n            const n2 = Fp.mul(n, _2n);\n            const v = Fp.pow(n2, c1);\n            const nv = Fp.mul(n, v);\n            const i = Fp.mul(Fp.mul(nv, _2n), v);\n            const root = Fp.mul(nv, Fp.sub(i, Fp.ONE));\n            if (!Fp.eql(Fp.sqr(root), n))\n                throw new Error('Cannot find square root');\n            return root;\n        };\n    }\n    // P  9 (mod 16)\n    if (P % _16n === _9n) {\n        // NOTE: tonelli is too slow for bls-Fp2 calculations even on start\n        // Means we cannot use sqrt for constants at all!\n        //\n        // const c1 = Fp.sqrt(Fp.negate(Fp.ONE)); //  1. c1 = sqrt(-1) in F, i.e., (c1^2) == -1 in F\n        // const c2 = Fp.sqrt(c1);                //  2. c2 = sqrt(c1) in F, i.e., (c2^2) == c1 in F\n        // const c3 = Fp.sqrt(Fp.negate(c1));     //  3. c3 = sqrt(-c1) in F, i.e., (c3^2) == -c1 in F\n        // const c4 = (P + _7n) / _16n;           //  4. c4 = (q + 7) / 16        # Integer arithmetic\n        // sqrt = (x) => {\n        //   let tv1 = Fp.pow(x, c4);             //  1. tv1 = x^c4\n        //   let tv2 = Fp.mul(c1, tv1);           //  2. tv2 = c1 * tv1\n        //   const tv3 = Fp.mul(c2, tv1);         //  3. tv3 = c2 * tv1\n        //   let tv4 = Fp.mul(c3, tv1);           //  4. tv4 = c3 * tv1\n        //   const e1 = Fp.equals(Fp.square(tv2), x); //  5.  e1 = (tv2^2) == x\n        //   const e2 = Fp.equals(Fp.square(tv3), x); //  6.  e2 = (tv3^2) == x\n        //   tv1 = Fp.cmov(tv1, tv2, e1); //  7. tv1 = CMOV(tv1, tv2, e1)  # Select tv2 if (tv2^2) == x\n        //   tv2 = Fp.cmov(tv4, tv3, e2); //  8. tv2 = CMOV(tv4, tv3, e2)  # Select tv3 if (tv3^2) == x\n        //   const e3 = Fp.equals(Fp.square(tv2), x); //  9.  e3 = (tv2^2) == x\n        //   return Fp.cmov(tv1, tv2, e3); //  10.  z = CMOV(tv1, tv2, e3)  # Select the sqrt from tv1 and tv2\n        // }\n    }\n    // Other cases: Tonelli-Shanks algorithm\n    return tonelliShanks(P);\n}\n// Little-endian check for first LE bit (last BE bit);\nconst isNegativeLE = (num, modulo) => (mod(num, modulo) & _1n) === _1n;\nexports.isNegativeLE = isNegativeLE;\n// prettier-ignore\nconst FIELD_FIELDS = [\n    'create', 'isValid', 'is0', 'neg', 'inv', 'sqrt', 'sqr',\n    'eql', 'add', 'sub', 'mul', 'pow', 'div',\n    'addN', 'subN', 'mulN', 'sqrN'\n];\nfunction validateField(field) {\n    const initial = {\n        ORDER: 'bigint',\n        MASK: 'bigint',\n        BYTES: 'isSafeInteger',\n        BITS: 'isSafeInteger',\n    };\n    const opts = FIELD_FIELDS.reduce((map, val) => {\n        map[val] = 'function';\n        return map;\n    }, initial);\n    return (0, utils_js_1.validateObject)(field, opts);\n}\n// Generic field functions\n/**\n * Same as `pow` but for Fp: non-constant-time.\n * Unsafe in some contexts: uses ladder, so can expose bigint bits.\n */\nfunction FpPow(f, num, power) {\n    // Should have same speed as pow for bigints\n    // TODO: benchmark!\n    if (power < _0n)\n        throw new Error('invalid exponent, negatives unsupported');\n    if (power === _0n)\n        return f.ONE;\n    if (power === _1n)\n        return num;\n    let p = f.ONE;\n    let d = num;\n    while (power > _0n) {\n        if (power & _1n)\n            p = f.mul(p, d);\n        d = f.sqr(d);\n        power >>= _1n;\n    }\n    return p;\n}\n/**\n * Efficiently invert an array of Field elements.\n * `inv(0)` will return `undefined` here: make sure to throw an error.\n */\nfunction FpInvertBatch(f, nums) {\n    const tmp = new Array(nums.length);\n    // Walk from first to last, multiply them by each other MOD p\n    const lastMultiplied = nums.reduce((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = acc;\n        return f.mul(acc, num);\n    }, f.ONE);\n    // Invert last element\n    const inverted = f.inv(lastMultiplied);\n    // Walk from last to first, multiply them by inverted each other MOD p\n    nums.reduceRight((acc, num, i) => {\n        if (f.is0(num))\n            return acc;\n        tmp[i] = f.mul(acc, tmp[i]);\n        return f.mul(acc, num);\n    }, inverted);\n    return tmp;\n}\nfunction FpDiv(f, lhs, rhs) {\n    return f.mul(lhs, typeof rhs === 'bigint' ? invert(rhs, f.ORDER) : f.inv(rhs));\n}\n/**\n * Legendre symbol.\n * * (a | p)  1    if a is a square (mod p), quadratic residue\n * * (a | p)  -1   if a is not a square (mod p), quadratic non residue\n * * (a | p)  0    if a  0 (mod p)\n */\nfunction FpLegendre(order) {\n    const legendreConst = (order - _1n) / _2n; // Integer arithmetic\n    return (f, x) => f.pow(x, legendreConst);\n}\n// This function returns True whenever the value x is a square in the field F.\nfunction FpIsSquare(f) {\n    const legendre = FpLegendre(f.ORDER);\n    return (x) => {\n        const p = legendre(f, x);\n        return f.eql(p, f.ZERO) || f.eql(p, f.ONE);\n    };\n}\n// CURVE.n lengths\nfunction nLength(n, nBitLength) {\n    // Bit size, byte size of CURVE.n\n    const _nBitLength = nBitLength !== undefined ? nBitLength : n.toString(2).length;\n    const nByteLength = Math.ceil(_nBitLength / 8);\n    return { nBitLength: _nBitLength, nByteLength };\n}\n/**\n * Initializes a finite field over prime.\n * Major performance optimizations:\n * * a) denormalized operations like mulN instead of mul\n * * b) same object shape: never add or remove keys\n * * c) Object.freeze\n * Fragile: always run a benchmark on a change.\n * Security note: operations don't check 'isValid' for all elements for performance reasons,\n * it is caller responsibility to check this.\n * This is low-level code, please make sure you know what you're doing.\n * @param ORDER prime positive bigint\n * @param bitLen how many bits the field consumes\n * @param isLE (def: false) if encoding / decoding should be in little-endian\n * @param redef optional faster redefinitions of sqrt and other methods\n */\nfunction Field(ORDER, bitLen, isLE = false, redef = {}) {\n    if (ORDER <= _0n)\n        throw new Error('invalid field: expected ORDER > 0, got ' + ORDER);\n    const { nBitLength: BITS, nByteLength: BYTES } = nLength(ORDER, bitLen);\n    if (BYTES > 2048)\n        throw new Error('invalid field: expected ORDER of <= 2048 bytes');\n    let sqrtP; // cached sqrtP\n    const f = Object.freeze({\n        ORDER,\n        isLE,\n        BITS,\n        BYTES,\n        MASK: (0, utils_js_1.bitMask)(BITS),\n        ZERO: _0n,\n        ONE: _1n,\n        create: (num) => mod(num, ORDER),\n        isValid: (num) => {\n            if (typeof num !== 'bigint')\n                throw new Error('invalid field element: expected bigint, got ' + typeof num);\n            return _0n <= num && num < ORDER; // 0 is valid element, but it's not invertible\n        },\n        is0: (num) => num === _0n,\n        isOdd: (num) => (num & _1n) === _1n,\n        neg: (num) => mod(-num, ORDER),\n        eql: (lhs, rhs) => lhs === rhs,\n        sqr: (num) => mod(num * num, ORDER),\n        add: (lhs, rhs) => mod(lhs + rhs, ORDER),\n        sub: (lhs, rhs) => mod(lhs - rhs, ORDER),\n        mul: (lhs, rhs) => mod(lhs * rhs, ORDER),\n        pow: (num, power) => FpPow(f, num, power),\n        div: (lhs, rhs) => mod(lhs * invert(rhs, ORDER), ORDER),\n        // Same as above, but doesn't normalize\n        sqrN: (num) => num * num,\n        addN: (lhs, rhs) => lhs + rhs,\n        subN: (lhs, rhs) => lhs - rhs,\n        mulN: (lhs, rhs) => lhs * rhs,\n        inv: (num) => invert(num, ORDER),\n        sqrt: redef.sqrt ||\n            ((n) => {\n                if (!sqrtP)\n                    sqrtP = FpSqrt(ORDER);\n                return sqrtP(f, n);\n            }),\n        invertBatch: (lst) => FpInvertBatch(f, lst),\n        // TODO: do we really need constant cmov?\n        // We don't have const-time bigints anyway, so probably will be not very useful\n        cmov: (a, b, c) => (c ? b : a),\n        toBytes: (num) => (isLE ? (0, utils_js_1.numberToBytesLE)(num, BYTES) : (0, utils_js_1.numberToBytesBE)(num, BYTES)),\n        fromBytes: (bytes) => {\n            if (bytes.length !== BYTES)\n                throw new Error('Field.fromBytes: expected ' + BYTES + ' bytes, got ' + bytes.length);\n            return isLE ? (0, utils_js_1.bytesToNumberLE)(bytes) : (0, utils_js_1.bytesToNumberBE)(bytes);\n        },\n    });\n    return Object.freeze(f);\n}\nfunction FpSqrtOdd(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(\"Field doesn't have isOdd\");\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? root : Fp.neg(root);\n}\nfunction FpSqrtEven(Fp, elm) {\n    if (!Fp.isOdd)\n        throw new Error(\"Field doesn't have isOdd\");\n    const root = Fp.sqrt(elm);\n    return Fp.isOdd(root) ? Fp.neg(root) : root;\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Same as mapKeyToField, but accepts less bytes (40 instead of 48 for 32-byte field).\n * Which makes it slightly more biased, less secure.\n * @deprecated use `mapKeyToField` instead\n */\nfunction hashToPrivateScalar(hash, groupOrder, isLE = false) {\n    hash = (0, utils_js_1.ensureBytes)('privateHash', hash);\n    const hashLen = hash.length;\n    const minLen = nLength(groupOrder).nByteLength + 8;\n    if (minLen < 24 || hashLen < minLen || hashLen > 1024)\n        throw new Error('hashToPrivateScalar: expected ' + minLen + '-1024 bytes of input, got ' + hashLen);\n    const num = isLE ? (0, utils_js_1.bytesToNumberLE)(hash) : (0, utils_js_1.bytesToNumberBE)(hash);\n    return mod(num, groupOrder - _1n) + _1n;\n}\n/**\n * Returns total number of bytes consumed by the field element.\n * For example, 32 bytes for usual 256-bit weierstrass curve.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of field\n */\nfunction getFieldBytesLength(fieldOrder) {\n    if (typeof fieldOrder !== 'bigint')\n        throw new Error('field order must be bigint');\n    const bitLength = fieldOrder.toString(2).length;\n    return Math.ceil(bitLength / 8);\n}\n/**\n * Returns minimal amount of bytes that can be safely reduced\n * by field order.\n * Should be 2^-128 for 128-bit curve such as P256.\n * @param fieldOrder number of field elements, usually CURVE.n\n * @returns byte length of target hash\n */\nfunction getMinHashLength(fieldOrder) {\n    const length = getFieldBytesLength(fieldOrder);\n    return length + Math.ceil(length / 2);\n}\n/**\n * \"Constant-time\" private key generation utility.\n * Can take (n + n/2) or more bytes of uniform input e.g. from CSPRNG or KDF\n * and convert them into private scalar, with the modulo bias being negligible.\n * Needs at least 48 bytes of input for 32-byte private key.\n * https://research.kudelskisecurity.com/2020/07/28/the-definitive-guide-to-modulo-bias-and-how-to-avoid-it/\n * FIPS 186-5, A.2 https://csrc.nist.gov/publications/detail/fips/186/5/final\n * RFC 9380, https://www.rfc-editor.org/rfc/rfc9380#section-5\n * @param hash hash output from SHA3 or a similar function\n * @param groupOrder size of subgroup - (e.g. secp256k1.CURVE.n)\n * @param isLE interpret hash bytes as LE num\n * @returns valid private scalar\n */\nfunction mapHashToField(key, fieldOrder, isLE = false) {\n    const len = key.length;\n    const fieldLen = getFieldBytesLength(fieldOrder);\n    const minLen = getMinHashLength(fieldOrder);\n    // No small numbers: need to understand bias story. No huge numbers: easier to detect JS timings.\n    if (len < 16 || len < minLen || len > 1024)\n        throw new Error('expected ' + minLen + '-1024 bytes of input, got ' + len);\n    const num = isLE ? (0, utils_js_1.bytesToNumberLE)(key) : (0, utils_js_1.bytesToNumberBE)(key);\n    // `mod(x, 11)` can sometimes produce 0. `mod(x, 10) + 1` is the same, but no 0\n    const reduced = mod(num, fieldOrder - _1n) + _1n;\n    return isLE ? (0, utils_js_1.numberToBytesLE)(reduced, fieldLen) : (0, utils_js_1.numberToBytesBE)(reduced, fieldLen);\n}\n//# sourceMappingURL=modular.js.map","\"use strict\";\n/**\n * Internal assertion helpers.\n * @module\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.anumber = anumber;\nexports.abytes = abytes;\nexports.ahash = ahash;\nexports.aexists = aexists;\nexports.aoutput = aoutput;\n/** Asserts something is positive integer. */\nfunction anumber(n) {\n    if (!Number.isSafeInteger(n) || n < 0)\n        throw new Error('positive integer expected, got ' + n);\n}\n/** Is number an Uint8Array? Copied from utils for perf. */\nfunction isBytes(a) {\n    return a instanceof Uint8Array || (ArrayBuffer.isView(a) && a.constructor.name === 'Uint8Array');\n}\n/** Asserts something is Uint8Array. */\nfunction abytes(b, ...lengths) {\n    if (!isBytes(b))\n        throw new Error('Uint8Array expected');\n    if (lengths.length > 0 && !lengths.includes(b.length))\n        throw new Error('Uint8Array expected of length ' + lengths + ', got length=' + b.length);\n}\n/** Asserts something is hash */\nfunction ahash(h) {\n    if (typeof h !== 'function' || typeof h.create !== 'function')\n        throw new Error('Hash should be wrapped by utils.wrapConstructor');\n    anumber(h.outputLen);\n    anumber(h.blockLen);\n}\n/** Asserts a hash instance has not been destroyed / finished */\nfunction aexists(instance, checkFinished = true) {\n    if (instance.destroyed)\n        throw new Error('Hash instance has been destroyed');\n    if (checkFinished && instance.finished)\n        throw new Error('Hash#digest() has already been called');\n}\n/** Asserts output is properly-sized byte array */\nfunction aoutput(out, instance) {\n    abytes(out);\n    const min = instance.outputLen;\n    if (out.length < min) {\n        throw new Error('digestInto() expects output buffer of length at least ' + min);\n    }\n}\n//# sourceMappingURL=_assert.js.map","import { bufferReader, bufferWriter } from \"../../../common/src\";\nimport { RtcpHeader } from \"./header\";\n\nexport class RtcpRrPacket {\n  ssrc = 0;\n  reports: RtcpReceiverInfo[] = [];\n  static readonly type = 201;\n  readonly type = RtcpRrPacket.type;\n\n  constructor(props: Partial<RtcpRrPacket> = {}) {\n    Object.assign(this, props);\n  }\n\n  serialize() {\n    let payload = bufferWriter([4], [this.ssrc]);\n    payload = Buffer.concat([\n      payload,\n      ...this.reports.map((report) => report.serialize()),\n    ]);\n    return RtcpHeader.serialize(\n      RtcpRrPacket.type,\n      this.reports.length,\n      payload,\n      Math.floor(payload.length / 4),\n    );\n  }\n\n  static deSerialize(data: Buffer, count: number) {\n    const [ssrc] = bufferReader(data, [4]);\n    let pos = 4;\n    const reports: RtcpReceiverInfo[] = [];\n    for (let _ = 0; _ < count; _++) {\n      reports.push(RtcpReceiverInfo.deSerialize(data.slice(pos, pos + 24)));\n      pos += 24;\n    }\n    return new RtcpRrPacket({ ssrc, reports });\n  }\n}\n\nexport class RtcpReceiverInfo {\n  ssrc!: number;\n  fractionLost!: number;\n  packetsLost!: number;\n  highestSequence!: number;\n  jitter!: number;\n  /**last SR */\n  lsr!: number;\n  /**delay since last SR */\n  dlsr!: number;\n\n  constructor(props: Partial<RtcpReceiverInfo> = {}) {\n    Object.assign(this, props);\n  }\n\n  toJSON() {\n    return {\n      ssrc: this.ssrc,\n      fractionLost: this.fractionLost,\n      packetsLost: this.packetsLost,\n      highestSequence: this.highestSequence,\n      jitter: this.jitter,\n      lsr: this.lsr,\n      dlsr: this.dlsr,\n    };\n  }\n\n  serialize() {\n    return bufferWriter(\n      [4, 1, 3, 4, 4, 4, 4],\n      [\n        this.ssrc,\n        this.fractionLost,\n        this.packetsLost,\n        this.highestSequence,\n        this.jitter,\n        this.lsr,\n        this.dlsr,\n      ],\n    );\n  }\n\n  static deSerialize(data: Buffer) {\n    const [\n      ssrc,\n      fractionLost,\n      packetsLost,\n      highestSequence,\n      jitter,\n      lsr,\n      dlsr,\n    ] = bufferReader(data, [4, 1, 3, 4, 4, 4, 4]);\n\n    return new RtcpReceiverInfo({\n      ssrc,\n      fractionLost,\n      packetsLost,\n      highestSequence,\n      jitter,\n      lsr,\n      dlsr,\n    });\n  }\n}\n","export type Kind = \"audio\" | \"video\" | \"application\" | \"unknown\";\n\nexport const SignalingStates = [\n  \"stable\",\n  \"have-local-offer\",\n  \"have-remote-offer\",\n  \"have-local-pranswer\",\n  \"have-remote-pranswer\",\n  \"closed\",\n] as const;\n\nexport type RTCSignalingState = (typeof SignalingStates)[number];\n\nexport const ConnectionStates = [\n  \"closed\",\n  \"failed\",\n  \"disconnected\",\n  \"new\",\n  \"connecting\",\n  \"connected\",\n] as const;\n\nexport type ConnectionState = (typeof ConnectionStates)[number];\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/x509\n//\n// **License:** MIT\n/**\n * BufferVisitor is a visit tool to manipulate buffer.\n */\nclass BufferVisitor {\n    constructor(buf, start = 0, end = 0) {\n        this.start = start;\n        this.end = end > start ? end : start;\n        this.buf = buf;\n    }\n    /**\n     * return the underlying buffer length\n     */\n    get length() {\n        return this.buf.length;\n    }\n    /**\n     * Reset visitor' start and end value.\n     * @param start\n     * @param end\n     */\n    reset(start = 0, end = 0) {\n        this.start = start;\n        if (end >= this.start) {\n            this.end = end;\n        }\n        else if (this.end < this.start) {\n            this.end = this.start;\n        }\n        return this;\n    }\n    /**\n     * consume some bytes.\n     * @param steps steps to walk\n     */\n    walk(steps) {\n        this.start = this.end;\n        this.end += steps;\n        return this;\n    }\n    /**\n     * The buffer should have remaining the \"steps\" of bytes to consume,\n     * otherwise it will throw an error with given message.\n     * @param steps steps to consume.\n     * @param message message to throw.\n     */\n    mustHas(steps, message = 'Too few bytes to parse.') {\n        const requested = this.end + steps;\n        if (requested > this.buf.length) {\n            const error = new Error(message);\n            error.available = this.buf.length;\n            error.requested = requested;\n            throw error;\n        }\n        this.walk(0);\n        return this;\n    }\n    /**\n     * Check the remaining bytes with bufferVisitor.mustHas method and then walk.\n     * @param steps steps to consume.\n     * @param message message to throw.\n     */\n    mustWalk(steps, message) {\n        this.mustHas(steps, message);\n        this.walk(steps);\n        return this;\n    }\n}\nexports.BufferVisitor = BufferVisitor;\n//# sourceMappingURL=common.js.map","'use strict';\n\nconst { isType, isFunction } = require('lib/util');\nconst NotEnoughDataError = require('lib/not-enough-data-error');\nconst BinaryStream = require('lib/binary-stream');\n\nmodule.exports = buffer;\n\n/**\n * Buffer type.\n * @param {number|Object} length The number of bytes or type for size-prefixed buffers.\n * @returns {Object}\n */\nfunction buffer(length) {\n  const isnum = typeof length === 'number';\n  const istype = isType(length);\n  const isfunc = isFunction(length);\n  const isNull = length === null;\n\n  if (!isnum && !istype && !isfunc && !isNull) {\n    throw new TypeError('Unknown type of argument #1.');\n  }\n\n  return {\n    encode,\n    decode,\n    encodingLength,\n  };\n\n  /**\n   * Encode buffer.\n   * @param {Buffer} buf\n   * @param {EncodeStream} wstream\n   */\n  function encode(buf, wstream) {\n    checkBuffer(buf);\n    encode.bytes = 0;\n\n    // eslint-disable-next-line no-invalid-this\n    const context = this;\n\n    if (isnum) {\n      checkLength(length, buf.length);\n    }\n\n    if (istype) {\n      length.encode.call(context, buf.length, wstream);\n      encode.bytes += length.encode.bytes;\n    }\n\n    if (isfunc) {\n      const expectedLength = length(context);\n\n      checkLengthType(expectedLength);\n      checkLength(expectedLength, buf.length);\n    }\n\n    wstream.writeBuffer(Buffer.isBuffer(buf) ? buf : buf.buffer);\n    encode.bytes += buf.length;\n\n    if (isNull) {\n      wstream.writeUInt8(0);\n      encode.bytes += 1;\n    }\n  }\n\n  /**\n   * Read the buffer from the stream.\n   * @param {DecodeStream} rstream\n   * @returns {Buffer}\n   */\n  function decode(rstream) {\n    let size = 0;\n    decode.bytes = 0;\n\n    // eslint-disable-next-line no-invalid-this\n    const context = this;\n\n    if (isnum) {\n      size = length;\n    } else if (istype) {\n      size = length.decode.call(context, rstream);\n      decode.bytes += length.decode.bytes;\n      checkLengthType(size);\n    } else if (isfunc) {\n      size = length(context);\n\n      checkLengthType(size);\n    } else if (isNull) {\n      size = rstream.indexOf(0);\n\n      if (size === -1) {\n        throw new NotEnoughDataError(rstream.length + 1, rstream.length);\n      }\n    }\n\n    const buf = rstream.readBuffer(size);\n    decode.bytes += size;\n\n    if (isNull) {\n      decode.bytes += 1;\n      rstream.consume(1);\n    }\n\n    return buf;\n  }\n\n  /**\n   * Get the number bytes of an encoded buffer.\n   * @param {Buffer} buf\n   * @returns {number}\n   */\n  function encodingLength(buf) {\n    checkBuffer(buf);\n    let size = 0;\n\n    if (isnum) {\n      return length;\n    }\n\n    if (isNull) {\n      size = 1;\n    } else if (istype) {\n      size = length.encodingLength(buf.length);\n    }\n\n    return size + buf.length;\n  }\n}\n\n/**\n * Check if item is a Buffer.\n * @param {any} buf\n * @private\n */\nfunction checkBuffer(buf) {\n  if (!Buffer.isBuffer(buf) && !(buf instanceof BinaryStream)) {\n    throw new TypeError('Argument 1 should be a Buffer or a BinaryStream.');\n  }\n}\n\n/**\n * Check the length of a Buffer to encode.\n * @param {number} requiredSize\n * @param {number} havingSize\n */\nfunction checkLength(requiredSize, havingSize) {\n  if (requiredSize !== havingSize) {\n    throw new Error(\n      `Buffer required length ${requiredSize} instead of ${havingSize}`\n    );\n  }\n}\n\n/**\n * Check if the length type is a number.\n * @param {any} length\n */\nfunction checkLengthType(length) {\n  if (typeof length !== 'number') {\n    throw new TypeError('Length of a buffer should be a number.');\n  }\n}\n","type EventExecute<T extends any[]> = (...args: T) => void;\ntype PromiseEventExecute<T extends any[]> = (...args: T) => Promise<void>;\ntype EventComplete = () => void;\ntype EventError = (e: any) => void;\ninterface Stack<T extends any[]> {\n  execute: EventExecute<T>;\n  complete?: EventComplete;\n  error?: EventError;\n  id: number;\n}\ninterface IEvent<T extends any[]> {\n  stack: Stack<T>[];\n  promiseStack: {\n    execute: PromiseEventExecute<T>;\n    complete?: EventComplete;\n    error?: EventError;\n    id: number;\n  }[];\n  eventId: number;\n}\n\nexport class Event<T extends any[]> {\n  private event: IEvent<T> = {\n    stack: [],\n    promiseStack: [],\n    eventId: 0,\n  };\n  ended = false;\n  onended?: () => void;\n  onerror = (e: any) => {};\n\n  execute = (...args: T) => {\n    if (this.ended) {\n      return;\n    }\n\n    for (const item of this.event.stack) {\n      item.execute(...args);\n    }\n\n    (async () => {\n      for (const item of this.event.promiseStack) {\n        await item.execute(...args);\n      }\n    })().catch((e) => {\n      this.onerror(e);\n    });\n  };\n\n  complete = () => {\n    if (this.ended) {\n      return;\n    }\n\n    for (const item of this.event.stack) {\n      if (item.complete) {\n        item.complete();\n      }\n    }\n    this.allUnsubscribe();\n    this.ended = true;\n    if (this.onended) {\n      this.onended();\n      this.onended = undefined;\n    }\n  };\n\n  error = (e: any) => {\n    if (this.ended) {\n      return;\n    }\n\n    for (const item of this.event.stack) {\n      if (item.error) {\n        item.error(e);\n      }\n    }\n    this.allUnsubscribe();\n  };\n\n  allUnsubscribe = () => {\n    if (this.ended) {\n      throw new Error(\"event completed\");\n    }\n\n    this.event = {\n      stack: [],\n      promiseStack: [],\n      eventId: 0,\n    };\n  };\n\n  subscribe = (\n    execute: EventExecute<T>,\n    complete?: EventComplete,\n    error?: EventError,\n  ) => {\n    const id = this.event.eventId;\n    this.event.stack.push({ execute, id, complete, error });\n    this.event.eventId++;\n\n    const unSubscribe = () => {\n      this.event.stack = this.event.stack.filter(\n        (item) => item.id !== id && item,\n      );\n    };\n\n    const disposer = (disposer: EventDisposer) => {\n      disposer.push(unSubscribe);\n    };\n\n    return { unSubscribe, disposer };\n  };\n\n  pipe(e: Event<T>) {\n    this.subscribe((...args) => {\n      e.execute(...args);\n    });\n  }\n\n  queuingSubscribe = (\n    execute: PromiseEventExecute<T>,\n    complete?: EventComplete,\n    error?: EventError,\n  ) => {\n    if (this.ended) throw new Error(\"event completed\");\n\n    const id = this.event.eventId;\n    this.event.promiseStack.push({ execute, id, complete, error });\n    this.event.eventId++;\n\n    const unSubscribe = () => {\n      this.event.stack = this.event.stack.filter(\n        (item) => item.id !== id && item,\n      );\n    };\n\n    const disposer = (disposer: EventDisposer) => {\n      disposer.push(unSubscribe);\n    };\n\n    return { unSubscribe, disposer };\n  };\n\n  once = (\n    execute: EventExecute<T>,\n    complete?: EventComplete,\n    error?: EventError,\n  ) => {\n    const off = this.subscribe(\n      (...args) => {\n        off.unSubscribe();\n        execute(...args);\n      },\n      complete,\n      error,\n    );\n  };\n\n  watch = (cb: (...args: T) => boolean, timeLimit?: number) =>\n    new Promise<T>((resolve, reject) => {\n      const timeout =\n        timeLimit &&\n        setTimeout(() => {\n          reject(\"Event watch timeout\");\n        }, timeLimit);\n\n      const { unSubscribe } = this.subscribe((...args) => {\n        const done = cb(...args);\n        if (done) {\n          if (timeout) clearTimeout(timeout);\n          unSubscribe();\n          resolve(args);\n        }\n      });\n    });\n\n  asPromise = (timeLimit?: number) =>\n    new Promise<T>((resolve, reject) => {\n      const timeout =\n        timeLimit &&\n        setTimeout(() => {\n          reject(\"Event asPromise timeout\");\n        }, timeLimit);\n\n      this.once(\n        (...args) => {\n          if (timeout) clearTimeout(timeout);\n          resolve(args);\n        },\n        () => {\n          if (timeout) clearTimeout(timeout);\n          resolve([] as any);\n        },\n        (err) => {\n          if (timeout) clearTimeout(timeout);\n          reject(err);\n        },\n      );\n    });\n\n  get returnTrigger() {\n    const { execute, error, complete } = this;\n    return { execute, error, complete };\n  }\n\n  get returnListener() {\n    const { subscribe, once, asPromise } = this;\n    return { subscribe, once, asPromise };\n  }\n\n  get length() {\n    return this.event.stack.length;\n  }\n}\n\nexport class EventDisposer {\n  private _disposer: (() => void)[] = [];\n\n  push(disposer: () => void) {\n    this._disposer.push(disposer);\n  }\n\n  dispose() {\n    this._disposer.forEach((d) => d());\n    this._disposer = [];\n  }\n}\n","export enum ContentType {\n  changeCipherSpec = 20,\n  alert = 21,\n  handshake = 22,\n  applicationData = 23,\n}\n\nexport enum AlertDesc {\n  CloseNotify = 0,\n  UnexpectedMessage = 10,\n  BadRecordMac = 20,\n  DecryptionFailed = 21,\n  RecordOverflow = 22,\n  DecompressionFailure = 30,\n  HandshakeFailure = 40,\n  NoCertificate = 41,\n  BadCertificate = 42,\n  UnsupportedCertificate = 43,\n  CertificateRevoked = 44,\n  CertificateExpired = 45,\n  CertificateUnknown = 46,\n  IllegalParameter = 47,\n  UnknownCa = 48,\n  AccessDenied = 49,\n  DecodeError = 50,\n  DecryptError = 51,\n  ExportRestriction = 60,\n  ProtocolVersion = 70,\n  InsufficientSecurity = 71,\n  InternalError = 80,\n  UserCanceled = 90,\n  NoRenegotiation = 100,\n  UnsupportedExtension = 110,\n}\n","export class ExtendedMasterSecret {\n  static type = 23;\n}\n","import { createCipheriv, createDecipheriv } from \"crypto\";\n\nimport { dumpBuffer, getObjectSummary } from \"../../helper\";\nimport { debug } from \"../../imports/common\";\nimport { prfEncryptionKeys } from \"../prf\";\nimport Cipher, {\n  type CipherHeader,\n  SessionType,\n  type SessionTypes,\n} from \"./abstract\";\n\nconst err = debug(\n  \"werift-dtls : packages/dtls/src/cipher/suites/aead.ts : err\",\n);\n\n/**\n * This class implements AEAD cipher family.\n */\nexport default class AEADCipher extends Cipher {\n  keyLength = 0;\n  nonceLength = 0;\n  ivLength = 0;\n  authTagLength = 0;\n\n  nonceImplicitLength = 0;\n  nonceExplicitLength = 0;\n\n  clientWriteKey?: Buffer;\n  serverWriteKey?: Buffer;\n\n  clientNonce?: Buffer;\n  serverNonce?: Buffer;\n\n  constructor() {\n    super();\n  }\n\n  get summary() {\n    return getObjectSummary(this);\n  }\n\n  init(masterSecret: Buffer, serverRandom: Buffer, clientRandom: Buffer) {\n    const keys = prfEncryptionKeys(\n      masterSecret,\n      clientRandom,\n      serverRandom,\n      this.keyLength,\n      this.ivLength,\n      this.nonceLength,\n      this.hashAlgorithm,\n    );\n\n    this.clientWriteKey = keys.clientWriteKey;\n    this.serverWriteKey = keys.serverWriteKey;\n    this.clientNonce = keys.clientNonce;\n    this.serverNonce = keys.serverNonce;\n  }\n\n  /**\n   * Encrypt message.\n   */\n  encrypt(type: SessionTypes, data: Buffer, header: CipherHeader) {\n    const isClient = type === SessionType.CLIENT;\n    const iv = isClient ? this.clientNonce : this.serverNonce;\n    const writeKey = isClient ? this.clientWriteKey : this.serverWriteKey;\n    if (!iv || !writeKey) throw new Error();\n\n    iv.writeUInt16BE(header.epoch, this.nonceImplicitLength);\n    iv.writeUIntBE(header.sequenceNumber, this.nonceImplicitLength + 2, 6);\n\n    const explicitNonce = iv.slice(this.nonceImplicitLength);\n\n    const additionalBuffer = this.encodeAdditionalBuffer(header, data.length);\n\n    const cipher = createCipheriv(this.blockAlgorithm!, writeKey, iv, {\n      authTagLength: this.authTagLength,\n    });\n\n    cipher.setAAD(additionalBuffer, {\n      plaintextLength: data.length,\n    });\n\n    const headPart = cipher.update(data);\n    const finalPart = cipher.final();\n    const authTag = cipher.getAuthTag();\n\n    return Buffer.concat([explicitNonce, headPart, finalPart, authTag]);\n  }\n\n  encodeAdditionalBuffer(header: CipherHeader, dataLength: number) {\n    const additionalBuffer = Buffer.alloc(13);\n\n    additionalBuffer.writeUInt16BE(header.epoch, 0);\n    additionalBuffer.writeUintBE(header.sequenceNumber, 2, 6);\n    additionalBuffer.writeUInt8(header.type, 8);\n    additionalBuffer.writeUInt16BE(header.version, 9);\n    additionalBuffer.writeUInt16BE(dataLength, 11);\n\n    return additionalBuffer;\n  }\n\n  /**\n   * Decrypt message.\n   */\n  decrypt(type: SessionTypes, data: Buffer, header: CipherHeader) {\n    const isClient = type === SessionType.CLIENT;\n    const iv = isClient ? this.serverNonce : this.clientNonce;\n    const writeKey = isClient ? this.serverWriteKey : this.clientWriteKey;\n    if (!iv || !writeKey) throw new Error();\n\n    const explicitNonce = data.subarray(0, this.nonceExplicitLength);\n\n    explicitNonce.copy(iv, this.nonceImplicitLength);\n\n    const encrypted = data.subarray(\n      this.nonceExplicitLength,\n      data.length - this.authTagLength,\n    );\n    const authTag = data.subarray(data.length - this.authTagLength);\n\n    const additionalBuffer = this.encodeAdditionalBuffer(\n      header,\n      encrypted.length,\n    );\n\n    const decipher = createDecipheriv(this.blockAlgorithm!, writeKey, iv, {\n      authTagLength: this.authTagLength,\n    });\n\n    decipher.setAuthTag(authTag);\n    decipher.setAAD(additionalBuffer, {\n      plaintextLength: encrypted.length,\n    });\n\n    const headPart = decipher.update(encrypted);\n    try {\n      const finalPart = decipher.final();\n      return finalPart.length > 0\n        ? Buffer.concat([headPart, finalPart])\n        : headPart;\n    } catch (error) {\n      err(\n        \"decrypt failed\",\n        error,\n        type,\n        dumpBuffer(data),\n        header,\n        this.summary,\n      );\n      throw error;\n    }\n  }\n}\n","'use strict';\n\n// Helps to \"skip\" field in result.\nconst skip = Symbol('skip');\n\n// Private field `bytes` in Metadata.\nconst bytes = Symbol('bytes');\n\nmodule.exports = {\n  skip,\n  bytes,\n};\n","export const ProtectionProfileAes128CmHmacSha1_80 = 0x0001 as const;\nexport const ProtectionProfileAeadAes128Gcm = 0x0007 as const;\n\nexport const Profiles = [\n  ProtectionProfileAes128CmHmacSha1_80,\n  ProtectionProfileAeadAes128Gcm,\n] as const;\n\nexport type SrtpProfile = (typeof Profiles)[number];\n\nexport const keyLength = (profile: SrtpProfile) => {\n  switch (profile) {\n    case ProtectionProfileAes128CmHmacSha1_80:\n    case ProtectionProfileAeadAes128Gcm:\n      return 16;\n  }\n};\n\nexport const saltLength = (profile: SrtpProfile) => {\n  switch (profile) {\n    case ProtectionProfileAes128CmHmacSha1_80:\n      return 14;\n    case ProtectionProfileAeadAes128Gcm:\n      return 12;\n  }\n};\n","import type { CipherGCMTypes } from \"crypto\";\nimport {\n  type KeyExchange,\n  createECDHEECDSAKeyExchange,\n  createECDHEPSKKeyExchange,\n  createECDHERSAKeyExchange,\n  createPSKKeyExchange,\n  createRSAKeyExchange,\n} from \"./key-exchange\";\nimport AEADCipher from \"./suites/aead\";\n\nconst cipherSuites = {\n  TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256: 0xc02b,\n  TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384: 0xc02c,\n  TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256: 0xc02f,\n  TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384: 0xc030,\n  TLS_RSA_WITH_AES_128_GCM_SHA256: 0x009c,\n  TLS_RSA_WITH_AES_256_GCM_SHA384: 0x009d,\n  TLS_PSK_WITH_AES_128_GCM_SHA256: 0x00a8,\n  TLS_PSK_WITH_AES_256_GCM_SHA384: 0x00a9,\n  TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256: 0xd001,\n  TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384: 0xd002,\n  TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256: 0xccac,\n  TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256: 0xcca9,\n  TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256: 0xcca8,\n  TLS_PSK_WITH_CHACHA20_POLY1305_SHA256: 0xccab,\n};\n\nconst AEAD_AES_128_GCM = {\n  K_LEN: 16, // Length of a key.\n  N_MIN: 12, // Min nonce length.\n  N_MAX: 12, // Max nonce length.\n  P_MAX: 2 ** 36 - 31, // Max length of a plaintext.\n\n  // Max safe int in js is 2 ** 53. So, use this value\n  // instead of 2 ** 61 as described in rfc5116.\n  A_MAX: 2 ** 53 - 1, // Max length of an additional data.\n  C_MAX: 2 ** 36 - 15, // Cipher text length.\n};\n\nconst AEAD_AES_256_GCM = {\n  K_LEN: 32, // Length of a key.\n  N_MIN: 12, // Min nonce length.\n  N_MAX: 12, // Max nonce length.\n  P_MAX: 2 ** 36 - 31, // Max length of a plaintext.\n\n  // Note: see above.\n  A_MAX: 2 ** 53 - 1, // Max length of an additional data.\n  C_MAX: 2 ** 36 - 15, // Cipher text length.\n};\n\nconst RSA_KEY_EXCHANGE = createRSAKeyExchange();\nconst ECDHE_RSA_KEY_EXCHANGE = createECDHERSAKeyExchange();\nconst ECDHE_ECDSA_KEY_EXCHANGE = createECDHEECDSAKeyExchange();\nconst PSK_KEY_EXCHANGE = createPSKKeyExchange();\nconst ECDHE_PSK_KEY_EXCHANGE = createECDHEPSKKeyExchange();\n\n/**\n * Convert cipher value to cipher instance.\n * @param {number} cipher\n */\nexport function createCipher(cipher: number) {\n  switch (cipher) {\n    case cipherSuites.TLS_RSA_WITH_AES_128_GCM_SHA256:\n      return createAEADCipher(\n        cipherSuites.TLS_RSA_WITH_AES_128_GCM_SHA256,\n        \"TLS_RSA_WITH_AES_128_GCM_SHA256\",\n        \"aes-128-gcm\",\n        RSA_KEY_EXCHANGE,\n        AEAD_AES_128_GCM,\n      );\n    case cipherSuites.TLS_RSA_WITH_AES_256_GCM_SHA384:\n      return createAEADCipher(\n        cipherSuites.TLS_RSA_WITH_AES_256_GCM_SHA384,\n        \"TLS_RSA_WITH_AES_256_GCM_SHA384\",\n        \"aes-256-gcm\",\n        RSA_KEY_EXCHANGE,\n        AEAD_AES_256_GCM,\n        \"sha384\",\n      );\n    case cipherSuites.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256:\n      return createAEADCipher(\n        cipherSuites.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,\n        \"TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256\",\n        \"aes-128-gcm\",\n        ECDHE_RSA_KEY_EXCHANGE,\n        AEAD_AES_128_GCM,\n      );\n    case cipherSuites.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384:\n      return createAEADCipher(\n        cipherSuites.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,\n        \"TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\",\n        \"aes-256-gcm\",\n        ECDHE_RSA_KEY_EXCHANGE,\n        AEAD_AES_256_GCM,\n        \"sha384\",\n      );\n    case cipherSuites.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256:\n      return createAEADCipher(\n        cipherSuites.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,\n        \"TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256\",\n        \"aes-128-gcm\",\n        ECDHE_ECDSA_KEY_EXCHANGE,\n        AEAD_AES_128_GCM,\n      );\n    case cipherSuites.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384:\n      return createAEADCipher(\n        cipherSuites.TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384,\n        \"TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384\",\n        \"aes-256-gcm\",\n        ECDHE_ECDSA_KEY_EXCHANGE,\n        AEAD_AES_256_GCM,\n        \"sha384\",\n      );\n    case cipherSuites.TLS_PSK_WITH_AES_128_GCM_SHA256:\n      return createAEADCipher(\n        cipherSuites.TLS_PSK_WITH_AES_128_GCM_SHA256,\n        \"TLS_PSK_WITH_AES_128_GCM_SHA256\",\n        \"aes-128-gcm\",\n        PSK_KEY_EXCHANGE,\n        AEAD_AES_128_GCM,\n        \"sha256\",\n      );\n    case cipherSuites.TLS_PSK_WITH_AES_256_GCM_SHA384:\n      return createAEADCipher(\n        cipherSuites.TLS_PSK_WITH_AES_256_GCM_SHA384,\n        \"TLS_PSK_WITH_AES_256_GCM_SHA384\",\n        \"aes-256-gcm\",\n        PSK_KEY_EXCHANGE,\n        AEAD_AES_256_GCM,\n        \"sha384\",\n      );\n    case cipherSuites.TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256:\n      return createAEADCipher(\n        cipherSuites.TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256,\n        \"TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256\",\n        \"aes-128-gcm\",\n        ECDHE_PSK_KEY_EXCHANGE,\n        AEAD_AES_128_GCM,\n        \"sha256\",\n      );\n    case cipherSuites.TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384:\n      return createAEADCipher(\n        cipherSuites.TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384,\n        \"TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384\",\n        \"aes-256-gcm\",\n        ECDHE_PSK_KEY_EXCHANGE,\n        AEAD_AES_256_GCM,\n        \"sha384\",\n      );\n    default:\n      break;\n  }\n\n  return null as any as AEADCipher;\n}\n\n/**\n * @param {number} id An internal id of cipher suite.\n * @param {string} name A valid cipher suite name.\n * @param {string} block A valid nodejs cipher name.\n * @param {KeyExchange} kx Key exchange type.\n * @param {Object} constants Cipher specific constants.\n * @param {string} hash\n * @returns {AEADCipher}\n */\nexport function createAEADCipher(\n  id: number,\n  name: string,\n  block: CipherGCMTypes,\n  kx: KeyExchange,\n  constants: { K_LEN: number; N_MAX: number },\n  hash = \"sha256\",\n) {\n  const cipher = new AEADCipher();\n\n  cipher.id = id;\n  cipher.name = name;\n  cipher.blockAlgorithm = block;\n  cipher.kx = kx;\n  cipher.hashAlgorithm = hash;\n\n  cipher.keyLength = constants.K_LEN;\n  cipher.nonceLength = constants.N_MAX;\n\n  // RFC5288, sec. 3\n  cipher.nonceImplicitLength = 4;\n  cipher.nonceExplicitLength = 8;\n\n  cipher.ivLength = cipher.nonceImplicitLength;\n\n  cipher.authTagLength = 16;\n\n  return cipher;\n}\n","import { Deferred } from \"@scrypted/common/src/deferred\";\nimport { listenZeroSingleClient } from \"@scrypted/common/src/listen-cluster\";\nimport { getNaluTypesInNalu, RtspServer } from \"@scrypted/common/src/rtsp-server\";\nimport { createSdpInput, parseSdp } from '@scrypted/common/src/sdp-utils';\nimport sdk, { FFmpegInput, Intercom, MediaObject, MediaStreamUrl, ResponseMediaStreamOptions, RTCAVSignalingSetup, RTCSessionControl, RTCSignalingChannel, RTCSignalingOptions, RTCSignalingSendIceCandidate, RTCSignalingSession, ScryptedMimeTypes, ScryptedNativeId } from \"@scrypted/sdk\";\nimport { FullIntraRequest } from \"../../../external/werift/packages/rtp/src/rtcp/psfb/fullIntraRequest\";\nimport { logConnectionState, waitClosed, waitConnected, waitIceConnected } from \"./peerconnection-util\";\nimport { startRtpForwarderProcess } from \"./rtp-forwarders\";\nimport { getFFmpegRtpAudioOutputArguments, requiredAudioCodecs, requiredVideoCodec } from \"./webrtc-required-codecs\";\nimport { BundlePolicy, RTCIceCandidate, RTCPeerConnection, RtcpPayloadSpecificFeedback, RTCRtpTransceiver, RtpPacket } from \"./werift\";\nimport { createRawResponse, getWeriftIceServers, isPeerConnectionAlive, logIsLocalIceTransport } from \"./werift-util\";\n\nconst { mediaManager } = sdk;\n\nexport interface RTCPeerConnectionPipe {\n    __json_copy_serialize_children: true,\n    mediaObject: MediaObject;\n    getIntercom(): Promise<Intercom>;\n    pcClose(): Promise<unknown>;\n}\n\nfunction ignoreDeferred(...d: Deferred<any>[]) {\n    d.forEach(d => d.promise.catch(() => { }));\n}\n\nfunction ignorePromise(...p: Promise<any>[]) {\n    p.forEach(p => p.catch(() => { }));\n}\n\nexport async function createRTCPeerConnectionSource(options: {\n    mixinId: string,\n    nativeId: ScryptedNativeId,\n    mediaStreamOptions: ResponseMediaStreamOptions,\n    startRTCSignalingSession: (session: RTCSignalingSession) => Promise<RTCSessionControl | undefined>,\n    maximumCompatibilityMode: boolean,\n}): Promise<RTCPeerConnectionPipe> {\n    const { mediaStreamOptions, startRTCSignalingSession, mixinId, nativeId, maximumCompatibilityMode } = options;\n    const console = mixinId ? sdk.deviceManager.getMixinConsole(mixinId, nativeId) : sdk.deviceManager.getDeviceConsole(nativeId);\n\n    const { clientPromise, port } = await listenZeroSingleClient('127.0.0.1');\n\n    const timeStart = Date.now();\n\n    const sessionControl = new Deferred<RTCSessionControl>();\n    const peerConnection = new Deferred<RTCPeerConnection>();\n    const intercom = new Deferred<Intercom>();\n    ignoreDeferred(sessionControl, intercom);\n\n    const cleanup = () => {\n        console.log('webrtc/rtsp cleaning up');\n        clientPromise.then(client => client.destroy()).catch(() => { });\n        sessionControl.promise.then(sc => sc.endSession()).catch(() => { });\n        peerConnection.promise.then(pc => pc.close()).catch(() => { });\n        ignorePromise(intercom.promise.then(intercom => intercom.stopIntercom()));\n    };\n\n    clientPromise.then(socket => socket.on('close', cleanup));\n\n    const start = (async () => {\n        const client = await clientPromise;\n        const rtspServer = new RtspServer(client, undefined, true);\n        // rtspServer.console = console;\n\n        const ensurePeerConnection = (setup: RTCAVSignalingSetup) => {\n            if (peerConnection.finished)\n                return;\n            const ret = new RTCPeerConnection({\n                bundlePolicy: setup.configuration?.bundlePolicy as BundlePolicy,\n                codecs: {\n                    audio: [\n                        ...requiredAudioCodecs,\n                    ],\n                    video: [\n                        requiredVideoCodec,\n                    ],\n                },\n                iceServers: getWeriftIceServers(setup.configuration),\n            });\n\n            waitClosed(ret).then(() => cleanup());\n\n            logConnectionState(console, ret);\n            peerConnection.resolve(ret);\n\n            (async () => {\n                try {\n                    if (ret.remoteIsBundled)\n                        await waitConnected(ret);\n                    else\n                        await waitIceConnected(ret);\n                    logIsLocalIceTransport(console, ret);\n                }\n                catch (e) {\n                }\n            })();\n        }\n\n        let audioTrack: string;\n        let videoTrack: string;\n        let audioTransceiver: RTCRtpTransceiver;\n\n        const doSetup = async (setup: RTCAVSignalingSetup) => {\n            ensurePeerConnection(setup);\n\n            let gotAudio = false;\n            let gotVideo = false;\n\n            const pc = await peerConnection.promise;\n            const timeout = setTimeout(() => cleanup(), 2 * 60 * 1000);\n            waitClosed(pc).then(() => clearTimeout(timeout));\n\n            const setupAudioTranscevier = (transciever: RTCRtpTransceiver) => {\n                audioTransceiver = transciever;\n                audioTransceiver.setDirection('sendrecv');\n                audioTransceiver.mid = '0';\n                audioTransceiver.onTrack.subscribe((track) => {\n                    track.onReceiveRtp.subscribe(rtp => {\n                        if (!gotAudio) {\n                            gotAudio = true;\n                            console.log('first audio packet', Date.now() - timeStart);\n                        }\n                        rtspServer.sendTrack(audioTrack, rtp.serialize(), false);\n                    });\n                    track.onReceiveRtcp.subscribe(rtp => rtspServer.sendTrack(audioTrack, rtp.serialize(), true));\n                });\n            };\n\n            const setupVideoTransceiver = (transceiver: RTCRtpTransceiver) => {\n                const videoTransceiver = transceiver;\n                videoTransceiver.mid = '1';\n                videoTransceiver.onTrack.subscribe((track) => {\n                    console.log('received video track');\n                    track.onReceiveRtp.subscribe(rtp => {\n                        if (!gotVideo) {\n                            gotVideo = true;\n                            console.log('first video packet', Date.now() - timeStart);\n                            const naluTypes = getNaluTypesInNalu(rtp.payload);\n                            console.log('video packet types', ...[...naluTypes]);\n                        }\n                        rtspServer.sendTrack(videoTrack, rtp.serialize(), false);\n                    });\n                    track.onReceiveRtcp.subscribe(rtp => rtspServer.sendTrack(videoTrack, rtp.serialize(), true));\n\n                    track.onReceiveRtp.once(() => {\n                        clearTimeout(timeout);\n                        let firSequenceNumber = 0;\n                        const pictureLossInterval = setInterval(() => {\n                            // i think this is necessary for older clients like ring\n                            // which is really a sip gateway?\n                            const fir = new FullIntraRequest({\n                                senderSsrc: videoTransceiver.receiver.rtcpSsrc,\n                                mediaSsrc: track.ssrc,\n                                fir: [\n                                    {\n                                        sequenceNumber: firSequenceNumber++,\n                                        ssrc: track.ssrc,\n                                    }\n                                ]\n                            });\n                            const packet = new RtcpPayloadSpecificFeedback({\n                                feedback: fir,\n                            });\n                            videoTransceiver.receiver.dtlsTransport.sendRtcp([packet]);\n\n                            // from my testing with browser clients, the pli is what\n                            // triggers a i-frame to be sent, and not the prior FIR request.\n                            videoTransceiver.receiver.sendRtcpPLI(track.ssrc!);\n                        }, 4000);\n                        waitClosed(pc).then(() => clearInterval(pictureLossInterval));\n                    });\n                });\n            };\n\n            if (setup.type === 'answer') {\n                pc.onTransceiverAdded.subscribe(transceiver => {\n                    if (transceiver.kind === 'audio') {\n                        setupAudioTranscevier(transceiver);\n                    }\n                    else if (transceiver.kind === 'video') {\n                        setupVideoTransceiver(transceiver);\n                    }\n                });\n                return;\n            }\n\n            setupAudioTranscevier(pc.addTransceiver(\"audio\", setup.audio as any));\n            setupVideoTransceiver(pc.addTransceiver(\"video\", setup.video as any));\n        }\n\n        const handleRtspSetup = async (description: RTCSessionDescriptionInit) => {\n            if (description.type !== 'answer')\n                throw new Error('rtsp setup needs answer sdp');\n\n            rtspServer.sdp = createSdpInput(0, 0, description.sdp);\n            const parsedSdp = parseSdp(rtspServer.sdp);\n            audioTrack = parsedSdp.msections.find(msection => msection.type === 'audio').control;\n            videoTrack = parsedSdp.msections.find(msection => msection.type === 'video').control;\n            // console.log('sdp sent', rtspServer.sdp);\n\n            await rtspServer.handlePlayback();\n            console.log('rtsp server playback started');\n        }\n\n        class SignalingSession implements RTCSignalingSession {\n            __proxy_props = { options: {} };\n            options: RTCSignalingOptions = {};\n\n            async getOptions(): Promise<RTCSignalingOptions> {\n                return {};\n            }\n\n            async createLocalDescription(type: \"offer\" | \"answer\", setup: RTCAVSignalingSetup, sendIceCandidate: RTCSignalingSendIceCandidate): Promise<RTCSessionDescriptionInit> {\n                if (type === 'offer')\n                    await doSetup(setup);\n                const pc = await peerConnection.promise;\n                if (setup.datachannel) {\n                    pc.createDataChannel(setup.datachannel.label, setup.datachannel.dict);\n                    // pc.sctpTransport.mid = '2';\n                }\n\n                const gatheringPromise = pc.iceGatheringState === 'complete' ? Promise.resolve(undefined) : new Promise(resolve => pc.iceGatheringStateChange.subscribe(state => {\n                    if (state === 'complete')\n                        resolve(undefined);\n                }));\n\n                if (sendIceCandidate) {\n                    pc.onicecandidate = ev => {\n                        console.log('sendIceCandidate', ev.candidate.sdpMLineIndex, ev.candidate.candidate);\n                        sendIceCandidate({\n                            ...ev.candidate,\n                        });\n                    };\n                }\n\n                if (type === 'answer') {\n                    let answer = await pc.createAnswer();\n                    console.log('createLocalDescription', answer.sdp)\n                    const ret = createRawResponse(answer);\n                    await handleRtspSetup(ret);\n                    const set = pc.setLocalDescription(answer);\n                    if (sendIceCandidate)\n                        return ret;\n                    await set;\n                    await gatheringPromise;\n                    answer = pc.localDescription || answer;\n                    return createRawResponse(answer);\n                }\n                else {\n                    let offer = await pc.createOffer();\n                    console.log('createLocalDescription', offer.sdp)\n                    const set = pc.setLocalDescription(offer);\n                    if (sendIceCandidate)\n                        return createRawResponse(offer);\n                    await set;\n                    await gatheringPromise;\n                    offer = await pc.createOffer();\n                    return createRawResponse(offer);\n                }\n            }\n            async setRemoteDescription(description: RTCSessionDescriptionInit, setup: RTCAVSignalingSetup): Promise<void> {\n                console.log('setRemoteDescription', description.sdp)\n                if (description.type === 'offer')\n                    await doSetup(setup);\n                else\n                    await handleRtspSetup(description);\n                const pc = await peerConnection.promise;\n                await pc.setRemoteDescription(description as any);\n            }\n            async addIceCandidate(candidate: RTCIceCandidateInit): Promise<void> {\n                console.log('addIceCandidate', candidate.sdpMLineIndex, candidate.candidate)\n                const pc = await peerConnection.promise;\n                await pc.addIceCandidate(candidate as RTCIceCandidate);\n            }\n        }\n\n        const session = new SignalingSession();\n        const sc = await startRTCSignalingSession(session);\n        sessionControl.resolve(sc);\n        console.log('waiting for peer connection');\n        const pc = await peerConnection.promise;\n        console.log('waiting for ice connected');\n        await waitIceConnected(pc);\n\n        let destroyProcess: () => void;\n\n        const ic: Intercom & { __json_copy_serialize_children: true } = {\n            __json_copy_serialize_children: true,\n            async startIntercom(media: MediaObject) {\n                if (!isPeerConnectionAlive(pc))\n                    throw new Error('peer connection is closed');\n\n                const audioCodec = audioTransceiver?.sender?.codec;\n                if (!audioTransceiver?.sender?.sendRtp || !audioCodec)\n                    throw new Error('peer connection does not support two way audio');\n\n\n                const ffmpegInput = await mediaManager.convertMediaObjectToJSON<FFmpegInput>(media, ScryptedMimeTypes.FFmpegInput);\n\n                let lastPacketTs: number = 0;\n                const { kill: destroy } = await startRtpForwarderProcess(console, ffmpegInput, {\n                    audio: {\n                        codecCopy: audioCodec.name,\n                        encoderArguments: getFFmpegRtpAudioOutputArguments(ffmpegInput.mediaStreamOptions?.audio, audioTransceiver.sender.codec, maximumCompatibilityMode),\n                        onRtp: (rtp) => {\n                            const packet = RtpPacket.deSerialize(rtp);\n                            const now = Date.now();\n                            packet.header.payloadType = audioCodec.payloadType;\n                            packet.header.marker = now - lastPacketTs > 1000; // set the marker if it's been more than 1s since the last packet\n                            audioTransceiver.sender.sendRtp(packet.serialize());\n                            lastPacketTs = now;\n                        },\n                    },\n                });\n\n                ic.stopIntercom();\n\n                destroyProcess = destroy;\n\n                const sc = await sessionControl.promise;\n                sc.setPlayback({\n                    audio: true,\n                    video: false,\n                });\n            },\n            async stopIntercom() {\n                destroyProcess?.();\n\n                sc.setPlayback({\n                    audio: false,\n                    video: false,\n                });\n            },\n        };\n\n        intercom.resolve(ic);\n    })();\n\n    start.catch(e => {\n        console.error('session start failed', e);\n        sessionControl.reject(e);\n        peerConnection.reject(e);\n        intercom.reject(e);\n\n        cleanup();\n    });\n\n    const pcClose = peerConnection.promise.then(pc => waitClosed(pc));\n    pcClose.finally(cleanup);\n\n    peerConnection.promise.catch(e => {\n        console.error('failed to create webrtc signaling session', e);\n        cleanup();\n    });\n\n    const url = `rtsp://127.0.0.1:${port}`;\n    const mediaStreamUrl: MediaStreamUrl = {\n        url,\n        container: 'rtsp',\n        mediaStreamOptions,\n    };\n\n    return {\n        __json_copy_serialize_children: true,\n        mediaObject: await mediaManager.createMediaObject(mediaStreamUrl, ScryptedMimeTypes.MediaStreamUrl),\n        getIntercom: () => intercom.promise,\n        pcClose: () => pcClose,\n    };\n}\n\nexport function getRTCMediaStreamOptions(id: string, name: string): ResponseMediaStreamOptions {\n    return {\n        // set by consumer\n        id,\n        name,\n        // not compatible with scrypted parser currently due to jitter issues\n        tool: 'scrypted',\n        container: 'rtsp',\n        video: {\n            codec: 'h264',\n        },\n        audio: {\n        },\n    };\n}\n","export * from \"../../../rtp/src\";\n","import { SRTP_PROFILE } from \"./const\";\nimport { Event, debug } from \"./imports/common\";\nimport type { RTCRtpTransceiver, TransceiverManager } from \"./media\";\nimport type { RTCStats } from \"./media/stats\";\nimport type { PeerConfig } from \"./peerConnection\";\nimport type { SctpTransportManager } from \"./sctpManager\";\nimport type { BundlePolicy, MediaDescription, SessionDescription } from \"./sdp\";\nimport {\n  type DtlsKeys,\n  RTCCertificate,\n  RTCDtlsTransport,\n} from \"./transport/dtls\";\nimport { IceCandidate, RTCIceGatherer, RTCIceTransport } from \"./transport/ice\";\nimport type {\n  IceGathererState,\n  RTCIceCandidate,\n  RTCIceCandidateInit,\n  RTCIceConnectionState,\n} from \"./transport/ice\";\nimport type { RTCSctpTransport } from \"./transport/sctp\";\nimport type { ConnectionState } from \"./types/domain\";\nimport { parseIceServers } from \"./utils\";\n\nconst log = debug(\n  \"werift:packages/webrtc/src/transport/secureTransportManager.ts\",\n);\nexport class SecureTransportManager {\n  connectionState: ConnectionState = \"new\";\n  iceConnectionState: RTCIceConnectionState = \"new\";\n  iceGatheringState: IceGathererState = \"new\";\n  certificate?: RTCCertificate;\n\n  readonly iceGatheringStateChange = new Event<[IceGathererState]>();\n  readonly iceConnectionStateChange = new Event<[RTCIceConnectionState]>();\n  readonly onIceCandidate = new Event<[IceCandidate | undefined]>();\n  readonly connectionStateChange = new Event<[ConnectionState]>();\n\n  private config: PeerConfig;\n  private transceiverManager: TransceiverManager;\n  private sctpManager: SctpTransportManager;\n\n  constructor({\n    config,\n    transceiverManager,\n    sctpManager,\n  }: {\n    config: PeerConfig;\n    transceiverManager: TransceiverManager;\n    sctpManager: SctpTransportManager;\n  }) {\n    this.config = config;\n    this.transceiverManager = transceiverManager;\n    this.sctpManager = sctpManager;\n\n    if (this.config.dtls) {\n      const { keys } = this.config.dtls;\n\n      if (keys) {\n        this.setupCertificate(keys);\n      }\n    }\n  }\n\n  get dtlsTransports() {\n    const transports = [\n      ...this.transceiverManager.getTransceivers().map((t) => t.dtlsTransport),\n      this.sctpManager.sctpTransport?.dtlsTransport,\n    ].filter((t) => t != undefined);\n\n    return transports.reduce((acc: RTCDtlsTransport[], cur) => {\n      if (!acc.map((d) => d.id).includes(cur.id)) {\n        acc.push(cur);\n      }\n      return acc;\n    }, []);\n  }\n\n  get iceTransports() {\n    return this.dtlsTransports.map((d) => d.iceTransport);\n  }\n\n  setupCertificate(keys: DtlsKeys) {\n    this.certificate = new RTCCertificate(\n      keys.keyPem,\n      keys.certPem,\n      keys.signatureHash,\n    );\n  }\n\n  createTransport() {\n    const [existing] = this.iceTransports;\n\n    const iceGatherer = new RTCIceGatherer({\n      ...parseIceServers(this.config.iceServers),\n      forceTurn: this.config.iceTransportPolicy === \"relay\",\n      portRange: this.config.icePortRange,\n      interfaceAddresses: this.config.iceInterfaceAddresses,\n      additionalHostAddresses: this.config.iceAdditionalHostAddresses,\n      filterStunResponse: this.config.iceFilterStunResponse,\n      filterCandidatePair: this.config.iceFilterCandidatePair,\n      localPasswordPrefix: this.config.icePasswordPrefix,\n      useIpv4: this.config.iceUseIpv4,\n      useIpv6: this.config.iceUseIpv6,\n      turnTransport: this.config.forceTurnTCP === true ? \"tcp\" : \"udp\",\n      useLinkLocalAddress: this.config.iceUseLinkLocalAddress,\n    });\n\n    if (existing) {\n      iceGatherer.connection.localUsername = existing.connection.localUsername;\n      iceGatherer.connection.localPassword = existing.connection.localPassword;\n    }\n\n    iceGatherer.onGatheringStateChange.subscribe(() => {\n      this.updateIceGatheringState();\n    });\n    this.updateIceGatheringState();\n\n    const iceTransport = new RTCIceTransport(iceGatherer);\n    iceTransport.onStateChange.subscribe(() => {\n      this.updateIceConnectionState();\n    });\n\n    const dtlsTransport = new RTCDtlsTransport(\n      this.config,\n      iceTransport,\n      this.certificate,\n      srtpProfiles,\n    );\n\n    return dtlsTransport;\n  }\n\n  handleNewIceCandidate({\n    candidate,\n    media,\n    remoteIsBundled,\n    transceiver,\n    sctpTransport,\n    bundlePolicy,\n  }: {\n    candidate: IceCandidate;\n    media?: MediaDescription;\n    remoteIsBundled: boolean;\n    transceiver?: RTCRtpTransceiver;\n    sctpTransport?: RTCSctpTransport;\n    bundlePolicy?: BundlePolicy;\n  }) {\n    // Assign sdpMid and sdpMLineIndex\n    if (bundlePolicy === \"max-bundle\" || remoteIsBundled) {\n      candidate.sdpMLineIndex = 0;\n      if (media) {\n        candidate.sdpMid = media.rtp.muxId;\n      }\n    } else {\n      if (transceiver) {\n        candidate.sdpMLineIndex = transceiver.mLineIndex;\n        candidate.sdpMid = transceiver.mid;\n      }\n      if (sctpTransport) {\n        candidate.sdpMLineIndex = sctpTransport.mLineIndex;\n        candidate.sdpMid = sctpTransport.mid;\n      }\n    }\n\n    if (\n      candidate.foundation &&\n      !candidate.foundation.startsWith(\"candidate:\")\n    ) {\n      candidate.foundation = \"candidate:\" + candidate.foundation;\n    }\n\n    this.onIceCandidate.execute(candidate);\n\n    return candidate;\n  }\n\n  async addIceCandidate(\n    sdp: SessionDescription,\n    candidateMessage: RTCIceCandidate | RTCIceCandidateInit,\n  ) {\n    const candidate = IceCandidate.fromJSON(candidateMessage);\n    if (!candidate) {\n      return;\n    }\n\n    let iceTransport: RTCIceTransport | undefined;\n\n    if (typeof candidate.sdpMid === \"number\") {\n      iceTransport = this.getTransportByMid(candidate.sdpMid);\n    }\n\n    if (!iceTransport && typeof candidate.sdpMLineIndex === \"number\") {\n      iceTransport = this.getTransportByMLineIndex(\n        sdp,\n        candidate.sdpMLineIndex,\n      );\n    }\n\n    if (!iceTransport) {\n      iceTransport = this.iceTransports[0];\n    }\n\n    if (iceTransport) {\n      await iceTransport.addRemoteCandidate(candidate);\n    } else {\n      log(\"iceTransport not found for candidate\", candidate);\n    }\n  }\n\n  private getTransportByMid(mid: string) {\n    let iceTransport: RTCIceTransport | undefined;\n\n    const transceiver = this.transceiverManager\n      .getTransceivers()\n      .find((t) => t.mid === mid);\n    if (transceiver) {\n      iceTransport = transceiver.dtlsTransport.iceTransport;\n    } else if (!iceTransport && this.sctpManager.sctpTransport?.mid === mid) {\n      iceTransport = this.sctpManager.sctpTransport.dtlsTransport.iceTransport;\n    }\n\n    return iceTransport;\n  }\n\n  private getTransportByMLineIndex(sdp: SessionDescription, index: number) {\n    const media = sdp.media[index];\n    if (!media) {\n      return;\n    }\n    const transport = this.getTransportByMid(media.rtp.muxId!);\n\n    return transport;\n  }\n\n  restartIce() {\n    for (const transport of this.iceTransports) {\n      transport.restart();\n    }\n  }\n\n  setLocalRole({\n    type,\n    role,\n  }: {\n    type: \"offer\" | \"answer\";\n    role: \"auto\" | \"client\" | \"server\" | undefined;\n  }) {\n    for (const dtlsTransport of this.dtlsTransports) {\n      const iceTransport = dtlsTransport.iceTransport;\n      if (type === \"offer\") {\n        iceTransport.connection.iceControlling = true;\n      } else {\n        iceTransport.connection.iceControlling = false;\n      }\n      // RFC 8445 S6.1.1\n      if (iceTransport.connection.remoteIsLite) {\n        iceTransport.connection.iceControlling = true;\n      }\n\n      // # set DTLS role for mediasoup\n      if (type === \"answer\") {\n        if (role) {\n          dtlsTransport.role = role;\n        }\n      }\n    }\n  }\n\n  // https://w3c.github.io/webrtc-pc/#dom-rtcicegatheringstate\n  private updateIceGatheringState() {\n    const all = this.iceTransports;\n\n    function allMatch(...state: IceGathererState[]) {\n      return (\n        all.filter((check) => state.includes(check.gatheringState)).length ===\n        all.length\n      );\n    }\n\n    let newState: IceGathererState;\n\n    if (all.length && allMatch(\"complete\")) {\n      newState = \"complete\";\n    } else if (!all.length || allMatch(\"new\", \"complete\")) {\n      newState = \"new\";\n    } else if (all.map((check) => check.gatheringState).includes(\"gathering\")) {\n      newState = \"gathering\";\n    } else {\n      newState = \"new\";\n    }\n\n    if (this.iceGatheringState === newState) {\n      return;\n    }\n\n    this.iceGatheringState = newState;\n    this.iceGatheringStateChange.execute(newState);\n  }\n\n  // https://w3c.github.io/webrtc-pc/#dom-rtciceconnectionstate\n  updateIceConnectionState() {\n    const all = this.iceTransports;\n    let newState: RTCIceConnectionState;\n\n    function allMatch(...state: RTCIceConnectionState[]) {\n      return (\n        all.filter((check) => state.includes(check.state)).length === all.length\n      );\n    }\n\n    function anyMatch(...state: RTCIceConnectionState[]) {\n      return all.some((check) => state.includes(check.state));\n    }\n\n    if (this.connectionState === \"closed\") {\n      newState = \"closed\";\n    } else if (anyMatch(\"failed\")) {\n      newState = \"failed\";\n    } else if (anyMatch(\"disconnected\")) {\n      newState = \"disconnected\";\n    } else if (allMatch(\"new\", \"closed\")) {\n      newState = \"new\";\n    } else if (anyMatch(\"new\", \"checking\")) {\n      newState = \"checking\";\n    } else if (allMatch(\"completed\", \"closed\")) {\n      newState = \"completed\";\n    } else if (allMatch(\"connected\", \"completed\", \"closed\")) {\n      newState = \"connected\";\n    } else {\n      // unreachable?\n      newState = \"new\";\n    }\n\n    if (this.iceConnectionState === newState) {\n      return;\n    }\n\n    log(\"iceConnectionStateChange\", newState);\n    this.iceConnectionState = newState;\n    this.iceConnectionStateChange.execute(newState);\n  }\n\n  async gatherCandidates(remoteIsBundled: boolean) {\n    const connected = this.iceTransports.find(\n      (transport) =>\n        transport.state === \"connected\" || transport.state === \"completed\",\n    );\n    if (remoteIsBundled && connected) {\n      // no need to gather ice candidates on an existing bundled connection\n      log(\"skipping ICE gathering for bundled connection\");\n    } else {\n      await Promise.allSettled(\n        this.iceTransports.map((iceTransport) => iceTransport.gather()),\n      ).catch((e) => {\n        //  (: )\n        log(\"gatherCandidates failed\", e);\n      });\n    }\n  }\n\n  setConnectionState(state: ConnectionState) {\n    log(\"connectionStateChange\", state);\n    this.connectionState = state;\n    this.connectionStateChange.execute(state);\n  }\n\n  async getStats(): Promise<RTCStats[]> {\n    const stats: RTCStats[] = [];\n\n    for (const dtlsTransport of this.dtlsTransports) {\n      const transportStats = await dtlsTransport.getStats();\n      if (transportStats) {\n        stats.push(...transportStats);\n      }\n    }\n\n    return stats;\n  }\n\n  async ensureCerts() {\n    if (!this.certificate) {\n      this.certificate = await RTCDtlsTransport.SetupCertificate();\n    }\n\n    for (const dtlsTransport of this.dtlsTransports) {\n      dtlsTransport.localCertificate = this.certificate;\n    }\n  }\n\n  async close() {\n    this.setConnectionState(\"closed\");\n\n    await Promise.allSettled([...this.dtlsTransports.map((t) => t.stop())]);\n\n    this.iceGatheringStateChange.allUnsubscribe();\n    this.iceConnectionStateChange.allUnsubscribe();\n    this.onIceCandidate.allUnsubscribe();\n    this.connectionStateChange.allUnsubscribe();\n  }\n}\n\nconst srtpProfiles = [\n  SRTP_PROFILE.SRTP_AEAD_AES_128_GCM, // prefer\n  SRTP_PROFILE.SRTP_AES128_CM_HMAC_SHA1_80,\n];\n","export * from \"./codec\";\nexport * from \"./extension/rtcpFeedback\";\nexport * from \"./extension/rtpExtension\";\nexport * from \"./parameters\";\nexport * from \"./router\";\nexport * from \"./rtpReceiver\";\nexport * from \"./rtpSender\";\nexport * from \"./rtpTransceiver\";\nexport * from \"./stats\";\nexport * from \"../transceiverManager\";\nexport * from \"./track\";\n","import type { DtlsContext } from \"../context/dtls\";\nimport type { Handshake } from \"../typings/domain\";\nimport { DtlsPlaintext } from \"./message/plaintext\";\n\nexport type Message = { type: number; fragment: Buffer };\n\nexport const createFragments =\n  (dtls: DtlsContext) => (handshakes: Handshake[]) => {\n    dtls.lastFlight = handshakes;\n\n    return handshakes.flatMap((handshake) => {\n      handshake.messageSeq = dtls.sequenceNumber++;\n      const fragment = handshake.toFragment();\n      const fragments = fragment.chunk();\n      return fragments;\n    });\n  };\n\nexport const createPlaintext =\n  (dtls: DtlsContext) =>\n  (fragments: Message[], recordSequenceNumber: number) => {\n    return fragments.map((msg) => {\n      const plaintext = new DtlsPlaintext(\n        {\n          contentType: msg.type,\n          protocolVersion: dtls.version,\n          epoch: dtls.epoch,\n          sequenceNumber: recordSequenceNumber,\n          contentLen: msg.fragment.length,\n        },\n        msg.fragment,\n      );\n      return plaintext;\n    });\n  };\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nexport class RenegotiationIndication {\n  static type = 65281;\n  static readonly spec = {\n    type: types.uint16be,\n    data: types.uint8,\n  };\n\n  public type: number = RenegotiationIndication.type;\n  public data: number = 0;\n\n  constructor(props: Partial<RenegotiationIndication> = {}) {\n    Object.assign(this, props);\n  }\n\n  static createEmpty() {\n    const v = new RenegotiationIndication();\n    return v;\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new RenegotiationIndication(\n      decode(buf, RenegotiationIndication.spec),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, RenegotiationIndication.spec).slice();\n    return Buffer.from(res);\n  }\n\n  get extension() {\n    return {\n      type: this.type,\n      data: this.serialize().slice(2),\n    };\n  }\n}\n","'use strict';\n\nconst { createSlicedTable } = require('./src/create-table');\nconst crc32By8 = require('./src/crc32-by-8');\n\nconst CRC32C_LOOKUP = createSlicedTable(0x82f63b78);\n\nmodule.exports = crc32c;\n\n/**\n * Compute CRC32C using slicing-by-n algorithm.\n * @param {Buffer|string} source\n * @returns {number}\n */\nfunction crc32c(source) {\n  const buf = Buffer.isBuffer(source) ? source : Buffer.from(source);\n\n  return (crc32By8(CRC32C_LOOKUP, buf, 0xffffffff, 0) ^ 0xffffffff) >>> 0;\n}\n","'use strict';\n\nconst BinaryStream = require('lib/binary-stream');\nconst array = require('types/array');\nconst buffer = require('types/buffer');\nconst bool = require('types/bool');\nconst reserved = require('types/reserved');\nconst string = require('types/string');\nconst numbers = require('types/numbers');\nconst when = require('types/when');\nconst select = require('types/select');\nconst { encode } = require('lib/encode');\nconst { decode } = require('lib/decode');\nconst { encodingLength } = require('lib/encoding-length');\nconst Transaction = require('lib/transaction');\nconst NotEnoughDataError = require('lib/not-enough-data-error');\n\nconst types = {\n  array,\n  bool,\n  buffer,\n  reserved,\n  string,\n  when,\n  select,\n};\n\nfor (const type of Object.keys(numbers)) {\n  types[type] = numbers[type]; // eslint-disable-line security/detect-object-injection\n}\n\nconst kschema = Symbol('schema');\n\n/**\n * Create transform stream to encode objects into Buffer.\n * @param {Object} [schema]\n * @returns {EncodeStream}\n */\nfunction createEncodeStream(schema) {\n  const stream = new BinaryStream({\n    readableObjectMode: false,\n    writableObjectMode: true,\n    transform: transformEncode,\n  });\n\n  stream[kschema] = schema;\n  return stream;\n}\n\n/**\n * Create transform stream to decode binary data into object.\n * @param {Buffer|Object} [bufOrSchema]\n * @returns {DecodeStream}\n */\nfunction createDecodeStream(bufOrSchema) {\n  let schema = null;\n  const isBuffer = Buffer.isBuffer(bufOrSchema);\n\n  if (!isBuffer) {\n    schema = bufOrSchema;\n  }\n\n  const stream = new BinaryStream({\n    transform: transformDecode,\n    readableObjectMode: true,\n    writableObjectMode: false,\n  });\n\n  stream[kschema] = schema;\n\n  if (isBuffer) {\n    stream.append(bufOrSchema);\n  }\n\n  return stream;\n}\n\n/**\n * The `transform` function for transform stream.\n * @param {*} chunk Any valid js data type.\n * @param {string} encoding\n * @param {Function} cb\n */\nfunction transformEncode(chunk, encoding, cb) {\n  try {\n    encode(chunk, this[kschema], this);\n\n    const buf = this.slice();\n    this.consume(buf.length);\n\n    cb(null, buf);\n  } catch (error) {\n    cb(error);\n  }\n}\n\n/**\n * The `transform` function for transform stream.\n * @param {*} chunk Any valid js data type.\n * @param {string} encoding\n * @param {Function} cb\n */\nfunction transformDecode(chunk, encoding, cb) {\n  this.append(chunk);\n\n  try {\n    while (this.length > 0) {\n      const transaction = new Transaction(this);\n      const data = decode(transaction, this[kschema]);\n\n      transaction.commit();\n      this.push(data);\n    }\n\n    cb();\n  } catch (error) {\n    if (error instanceof NotEnoughDataError) {\n      cb();\n    } else {\n      cb(error);\n    }\n  }\n}\n\nmodule.exports = {\n  /* Main api */\n  createEncodeStream,\n  createDecodeStream,\n  encode,\n  decode,\n  encodingLength,\n\n  /* aliases */\n  createEncode: createEncodeStream,\n  createDecode: createDecodeStream,\n\n  /* Data types */\n  types,\n\n  /* Re-export utils */\n  BinaryStream,\n  NotEnoughDataError,\n};\n","'use strict';\n\nmodule.exports = crc32;\n\n/**\n * @param {Array<number[]>} table Lookup table.\n * @param {Buffer} buf\n * @param {number} input Source CRC code.\n * @param {number} offset\n * @returns {number}\n */\nfunction crc32(table, buf, input, offset) {\n  let crc = input;\n\n  for (let index = offset; index < buf.length; index += 1) {\n    const byte = buf[index];\n    crc = table[0][(crc ^ byte) & 0xff] ^ (crc >>> 8);\n  }\n\n  return crc;\n}\n","import { type HashAlgorithms, SignatureAlgorithm } from \"./imports/dtls\";\nimport {\n  ProtectionProfileAeadAes128Gcm,\n  ProtectionProfileAes128CmHmacSha1_80,\n} from \"./imports/rtp\";\nimport type { DtlsRole } from \"./transport/dtls\";\n\n// data channel export constants\nexport const DATA_CHANNEL_ACK = 2;\nexport const DATA_CHANNEL_OPEN = 3;\n\n// 5.1.  DATA_CHANNEL_OPEN Message\nexport const DATA_CHANNEL_RELIABLE = 0x00;\nexport const DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT = 0x01;\nexport const DATA_CHANNEL_PARTIAL_RELIABLE_TIMED = 0x02;\nexport const DATA_CHANNEL_RELIABLE_UNORDERED = 0x80;\nexport const DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT_UNORDERED = 0x81;\nexport const DATA_CHANNEL_PARTIAL_RELIABLE_TIMED_UNORDERED = 0x82;\n\nexport const WEBRTC_DCEP = 50;\nexport const WEBRTC_STRING = 51;\nexport const WEBRTC_BINARY = 53;\nexport const WEBRTC_STRING_EMPTY = 56;\nexport const WEBRTC_BINARY_EMPTY = 57;\n\nexport const DISCARD_HOST = \"0.0.0.0\";\nexport const DISCARD_PORT = 9;\nexport const MEDIA_KINDS = [\"audio\", \"video\"];\n\nexport const DIRECTIONS = [\"inactive\", \"sendonly\", \"recvonly\", \"sendrecv\"];\nexport const DTLS_ROLE_SETUP = {\n  auto: \"actpass\",\n  client: \"active\",\n  server: \"passive\",\n};\nexport const DTLS_SETUP_ROLE: { [key: string]: DtlsRole } = Object.keys(\n  DTLS_ROLE_SETUP,\n).reduce((acc, cur) => {\n  const key = (DTLS_ROLE_SETUP as any)[cur];\n  acc[key] = cur;\n  return acc;\n}, {} as any);\nexport const FMTP_INT_PARAMETERS = [\n  \"apt\",\n  \"max-fr\",\n  \"max-fs\",\n  \"maxplaybackrate\",\n  \"minptime\",\n  \"stereo\",\n  \"useinbandfec\",\n];\n\nexport const SSRC_INFO_ATTRS = [\"cname\", \"msid\", \"mslabel\", \"label\"];\n\nexport const SRTP_PROFILE = {\n  SRTP_AES128_CM_HMAC_SHA1_80: ProtectionProfileAes128CmHmacSha1_80,\n  SRTP_AEAD_AES_128_GCM: ProtectionProfileAeadAes128Gcm,\n} as const;\n\nexport const SenderDirections = [\"sendonly\", \"sendrecv\"];\nexport const ReceiverDirection = [\"sendrecv\", \"recvonly\"];\n\nexport { type HashAlgorithms, SignatureAlgorithm };\n","module.exports = require(\"timers/promises\");","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type {\n  HashAlgorithms,\n  SignatureAlgorithms,\n} from \"../../../cipher/const\";\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type { Handshake } from \"../../../typings/domain\";\nimport {\n  ClientCertificateType,\n  DistinguishedName,\n  SignatureHashAlgorithm,\n} from \"../../binary\";\nimport { HandshakeType } from \"../../const\";\n\n// 7.4.4.  Certificate Request\n\nexport class ServerCertificateRequest implements Handshake {\n  msgType = HandshakeType.certificate_request_13;\n  messageSeq?: number;\n  static readonly spec = {\n    certificateTypes: types.array(ClientCertificateType, types.uint8, \"bytes\"),\n    signatures: types.array(SignatureHashAlgorithm, types.uint16be, \"bytes\"),\n    authorities: types.array(DistinguishedName, types.uint16be, \"bytes\"),\n  };\n\n  constructor(\n    public certificateTypes: number[],\n    public signatures: {\n      hash: HashAlgorithms;\n      signature: SignatureAlgorithms;\n    }[],\n    public authorities: number[],\n  ) {}\n\n  static createEmpty() {\n    return new ServerCertificateRequest(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new ServerCertificateRequest(\n      //@ts-ignore\n      ...Object.values(decode(buf, ServerCertificateRequest.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, ServerCertificateRequest.spec).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.DER = exports.DERErr = void 0;\nexports.weierstrassPoints = weierstrassPoints;\nexports.weierstrass = weierstrass;\nexports.SWUFpSqrtRatio = SWUFpSqrtRatio;\nexports.mapToCurveSimpleSWU = mapToCurveSimpleSWU;\n/**\n * Short Weierstrass curve methods. The formula is: y = x + ax + b.\n *\n * ### Design rationale for types\n *\n * * Interaction between classes from different curves should fail:\n *   `k256.Point.BASE.add(p256.Point.BASE)`\n * * For this purpose we want to use `instanceof` operator, which is fast and works during runtime\n * * Different calls of `curve()` would return different classes -\n *   `curve(params) !== curve(params)`: if somebody decided to monkey-patch their curve,\n *   it won't affect others\n *\n * TypeScript can't infer types for classes created inside a function. Classes is one instance\n * of nominative types in TypeScript and interfaces only check for shape, so it's hard to create\n * unique type for every function call.\n *\n * We can use generic types via some param, like curve opts, but that would:\n *     1. Enable interaction between `curve(params)` and `curve(params)` (curves of same params)\n *     which is hard to debug.\n *     2. Params can be generic and we can't enforce them to be constant value:\n *     if somebody creates curve from non-constant params,\n *     it would be allowed to interact with other curves with non-constant params\n *\n * @todo https://www.typescriptlang.org/docs/handbook/release-notes/typescript-2-7.html#unique-symbol\n * @module\n */\n/*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) */\nconst curve_js_1 = require(\"./curve.js\");\nconst modular_js_1 = require(\"./modular.js\");\nconst ut = require(\"./utils.js\");\nconst utils_js_1 = require(\"./utils.js\");\nfunction validateSigVerOpts(opts) {\n    if (opts.lowS !== undefined)\n        (0, utils_js_1.abool)('lowS', opts.lowS);\n    if (opts.prehash !== undefined)\n        (0, utils_js_1.abool)('prehash', opts.prehash);\n}\nfunction validatePointOpts(curve) {\n    const opts = (0, curve_js_1.validateBasic)(curve);\n    ut.validateObject(opts, {\n        a: 'field',\n        b: 'field',\n    }, {\n        allowedPrivateKeyLengths: 'array',\n        wrapPrivateKey: 'boolean',\n        isTorsionFree: 'function',\n        clearCofactor: 'function',\n        allowInfinityPoint: 'boolean',\n        fromBytes: 'function',\n        toBytes: 'function',\n    });\n    const { endo, Fp, a } = opts;\n    if (endo) {\n        if (!Fp.eql(a, Fp.ZERO)) {\n            throw new Error('invalid endomorphism, can only be defined for Koblitz curves that have a=0');\n        }\n        if (typeof endo !== 'object' ||\n            typeof endo.beta !== 'bigint' ||\n            typeof endo.splitScalar !== 'function') {\n            throw new Error('invalid endomorphism, expected beta: bigint and splitScalar: function');\n        }\n    }\n    return Object.freeze({ ...opts });\n}\nconst { bytesToNumberBE: b2n, hexToBytes: h2b } = ut;\nclass DERErr extends Error {\n    constructor(m = '') {\n        super(m);\n    }\n}\nexports.DERErr = DERErr;\n/**\n * ASN.1 DER encoding utilities. ASN is very complex & fragile. Format:\n *\n *     [0x30 (SEQUENCE), bytelength, 0x02 (INTEGER), intLength, R, 0x02 (INTEGER), intLength, S]\n *\n * Docs: https://letsencrypt.org/docs/a-warm-welcome-to-asn1-and-der/, https://luca.ntop.org/Teaching/Appunti/asn1.html\n */\nexports.DER = {\n    // asn.1 DER encoding utils\n    Err: DERErr,\n    // Basic building block is TLV (Tag-Length-Value)\n    _tlv: {\n        encode: (tag, data) => {\n            const { Err: E } = exports.DER;\n            if (tag < 0 || tag > 256)\n                throw new E('tlv.encode: wrong tag');\n            if (data.length & 1)\n                throw new E('tlv.encode: unpadded data');\n            const dataLen = data.length / 2;\n            const len = ut.numberToHexUnpadded(dataLen);\n            if ((len.length / 2) & 128)\n                throw new E('tlv.encode: long form length too big');\n            // length of length with long form flag\n            const lenLen = dataLen > 127 ? ut.numberToHexUnpadded((len.length / 2) | 128) : '';\n            const t = ut.numberToHexUnpadded(tag);\n            return t + lenLen + len + data;\n        },\n        // v - value, l - left bytes (unparsed)\n        decode(tag, data) {\n            const { Err: E } = exports.DER;\n            let pos = 0;\n            if (tag < 0 || tag > 256)\n                throw new E('tlv.encode: wrong tag');\n            if (data.length < 2 || data[pos++] !== tag)\n                throw new E('tlv.decode: wrong tlv');\n            const first = data[pos++];\n            const isLong = !!(first & 128); // First bit of first length byte is flag for short/long form\n            let length = 0;\n            if (!isLong)\n                length = first;\n            else {\n                // Long form: [longFlag(1bit), lengthLength(7bit), length (BE)]\n                const lenLen = first & 127;\n                if (!lenLen)\n                    throw new E('tlv.decode(long): indefinite length not supported');\n                if (lenLen > 4)\n                    throw new E('tlv.decode(long): byte length is too big'); // this will overflow u32 in js\n                const lengthBytes = data.subarray(pos, pos + lenLen);\n                if (lengthBytes.length !== lenLen)\n                    throw new E('tlv.decode: length bytes not complete');\n                if (lengthBytes[0] === 0)\n                    throw new E('tlv.decode(long): zero leftmost byte');\n                for (const b of lengthBytes)\n                    length = (length << 8) | b;\n                pos += lenLen;\n                if (length < 128)\n                    throw new E('tlv.decode(long): not minimal encoding');\n            }\n            const v = data.subarray(pos, pos + length);\n            if (v.length !== length)\n                throw new E('tlv.decode: wrong value length');\n            return { v, l: data.subarray(pos + length) };\n        },\n    },\n    // https://crypto.stackexchange.com/a/57734 Leftmost bit of first byte is 'negative' flag,\n    // since we always use positive integers here. It must always be empty:\n    // - add zero byte if exists\n    // - if next byte doesn't have a flag, leading zero is not allowed (minimal encoding)\n    _int: {\n        encode(num) {\n            const { Err: E } = exports.DER;\n            if (num < _0n)\n                throw new E('integer: negative integers are not allowed');\n            let hex = ut.numberToHexUnpadded(num);\n            // Pad with zero byte if negative flag is present\n            if (Number.parseInt(hex[0], 16) & 0b1000)\n                hex = '00' + hex;\n            if (hex.length & 1)\n                throw new E('unexpected DER parsing assertion: unpadded hex');\n            return hex;\n        },\n        decode(data) {\n            const { Err: E } = exports.DER;\n            if (data[0] & 128)\n                throw new E('invalid signature integer: negative');\n            if (data[0] === 0x00 && !(data[1] & 128))\n                throw new E('invalid signature integer: unnecessary leading zero');\n            return b2n(data);\n        },\n    },\n    toSig(hex) {\n        // parse DER signature\n        const { Err: E, _int: int, _tlv: tlv } = exports.DER;\n        const data = typeof hex === 'string' ? h2b(hex) : hex;\n        ut.abytes(data);\n        const { v: seqBytes, l: seqLeftBytes } = tlv.decode(0x30, data);\n        if (seqLeftBytes.length)\n            throw new E('invalid signature: left bytes after parsing');\n        const { v: rBytes, l: rLeftBytes } = tlv.decode(0x02, seqBytes);\n        const { v: sBytes, l: sLeftBytes } = tlv.decode(0x02, rLeftBytes);\n        if (sLeftBytes.length)\n            throw new E('invalid signature: left bytes after parsing');\n        return { r: int.decode(rBytes), s: int.decode(sBytes) };\n    },\n    hexFromSig(sig) {\n        const { _tlv: tlv, _int: int } = exports.DER;\n        const rs = tlv.encode(0x02, int.encode(sig.r));\n        const ss = tlv.encode(0x02, int.encode(sig.s));\n        const seq = rs + ss;\n        return tlv.encode(0x30, seq);\n    },\n};\n// Be friendly to bad ECMAScript parsers by not using bigint literals\n// prettier-ignore\nconst _0n = BigInt(0), _1n = BigInt(1), _2n = BigInt(2), _3n = BigInt(3), _4n = BigInt(4);\nfunction weierstrassPoints(opts) {\n    const CURVE = validatePointOpts(opts);\n    const { Fp } = CURVE; // All curves has same field / group length as for now, but they can differ\n    const Fn = (0, modular_js_1.Field)(CURVE.n, CURVE.nBitLength);\n    const toBytes = CURVE.toBytes ||\n        ((_c, point, _isCompressed) => {\n            const a = point.toAffine();\n            return ut.concatBytes(Uint8Array.from([0x04]), Fp.toBytes(a.x), Fp.toBytes(a.y));\n        });\n    const fromBytes = CURVE.fromBytes ||\n        ((bytes) => {\n            // const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // if (head !== 0x04) throw new Error('Only non-compressed encoding is supported');\n            const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n            const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n            return { x, y };\n        });\n    /**\n     * y = x + ax + b: Short weierstrass curve formula\n     * @returns y\n     */\n    function weierstrassEquation(x) {\n        const { a, b } = CURVE;\n        const x2 = Fp.sqr(x); // x * x\n        const x3 = Fp.mul(x2, x); // x2 * x\n        return Fp.add(Fp.add(x3, Fp.mul(x, a)), b); // x3 + a * x + b\n    }\n    // Validate whether the passed curve params are valid.\n    // We check if curve equation works for generator point.\n    // `assertValidity()` won't work: `isTorsionFree()` is not available at this point in bls12-381.\n    // ProjectivePoint class has not been initialized yet.\n    if (!Fp.eql(Fp.sqr(CURVE.Gy), weierstrassEquation(CURVE.Gx)))\n        throw new Error('bad generator point: equation left != right');\n    // Valid group elements reside in range 1..n-1\n    function isWithinCurveOrder(num) {\n        return ut.inRange(num, _1n, CURVE.n);\n    }\n    // Validates if priv key is valid and converts it to bigint.\n    // Supports options allowedPrivateKeyLengths and wrapPrivateKey.\n    function normPrivateKeyToScalar(key) {\n        const { allowedPrivateKeyLengths: lengths, nByteLength, wrapPrivateKey, n: N } = CURVE;\n        if (lengths && typeof key !== 'bigint') {\n            if (ut.isBytes(key))\n                key = ut.bytesToHex(key);\n            // Normalize to hex string, pad. E.g. P521 would norm 130-132 char hex to 132-char bytes\n            if (typeof key !== 'string' || !lengths.includes(key.length))\n                throw new Error('invalid private key');\n            key = key.padStart(nByteLength * 2, '0');\n        }\n        let num;\n        try {\n            num =\n                typeof key === 'bigint'\n                    ? key\n                    : ut.bytesToNumberBE((0, utils_js_1.ensureBytes)('private key', key, nByteLength));\n        }\n        catch (error) {\n            throw new Error('invalid private key, expected hex or ' + nByteLength + ' bytes, got ' + typeof key);\n        }\n        if (wrapPrivateKey)\n            num = (0, modular_js_1.mod)(num, N); // disabled by default, enabled for BLS\n        ut.aInRange('private key', num, _1n, N); // num in range [1..N-1]\n        return num;\n    }\n    function assertPrjPoint(other) {\n        if (!(other instanceof Point))\n            throw new Error('ProjectivePoint expected');\n    }\n    // Memoized toAffine / validity check. They are heavy. Points are immutable.\n    // Converts Projective point to affine (x, y) coordinates.\n    // Can accept precomputed Z^-1 - for example, from invertBatch.\n    // (x, y, z)  (x=x/z, y=y/z)\n    const toAffineMemo = (0, utils_js_1.memoized)((p, iz) => {\n        const { px: x, py: y, pz: z } = p;\n        // Fast-path for normalized points\n        if (Fp.eql(z, Fp.ONE))\n            return { x, y };\n        const is0 = p.is0();\n        // If invZ was 0, we return zero point. However we still want to execute\n        // all operations, so we replace invZ with a random number, 1.\n        if (iz == null)\n            iz = is0 ? Fp.ONE : Fp.inv(z);\n        const ax = Fp.mul(x, iz);\n        const ay = Fp.mul(y, iz);\n        const zz = Fp.mul(z, iz);\n        if (is0)\n            return { x: Fp.ZERO, y: Fp.ZERO };\n        if (!Fp.eql(zz, Fp.ONE))\n            throw new Error('invZ was invalid');\n        return { x: ax, y: ay };\n    });\n    // NOTE: on exception this will crash 'cached' and no value will be set.\n    // Otherwise true will be return\n    const assertValidMemo = (0, utils_js_1.memoized)((p) => {\n        if (p.is0()) {\n            // (0, 1, 0) aka ZERO is invalid in most contexts.\n            // In BLS, ZERO can be serialized, so we allow it.\n            // (0, 0, 0) is invalid representation of ZERO.\n            if (CURVE.allowInfinityPoint && !Fp.is0(p.py))\n                return;\n            throw new Error('bad point: ZERO');\n        }\n        // Some 3rd-party test vectors require different wording between here & `fromCompressedHex`\n        const { x, y } = p.toAffine();\n        // Check if x, y are valid field elements\n        if (!Fp.isValid(x) || !Fp.isValid(y))\n            throw new Error('bad point: x or y not FE');\n        const left = Fp.sqr(y); // y\n        const right = weierstrassEquation(x); // x + ax + b\n        if (!Fp.eql(left, right))\n            throw new Error('bad point: equation left != right');\n        if (!p.isTorsionFree())\n            throw new Error('bad point: not in prime-order subgroup');\n        return true;\n    });\n    /**\n     * Projective Point works in 3d / projective (homogeneous) coordinates: (x, y, z)  (x=x/z, y=y/z)\n     * Default Point works in 2d / affine coordinates: (x, y)\n     * We're doing calculations in projective, because its operations don't require costly inversion.\n     */\n    class Point {\n        constructor(px, py, pz) {\n            this.px = px;\n            this.py = py;\n            this.pz = pz;\n            if (px == null || !Fp.isValid(px))\n                throw new Error('x required');\n            if (py == null || !Fp.isValid(py))\n                throw new Error('y required');\n            if (pz == null || !Fp.isValid(pz))\n                throw new Error('z required');\n            Object.freeze(this);\n        }\n        // Does not validate if the point is on-curve.\n        // Use fromHex instead, or call assertValidity() later.\n        static fromAffine(p) {\n            const { x, y } = p || {};\n            if (!p || !Fp.isValid(x) || !Fp.isValid(y))\n                throw new Error('invalid affine point');\n            if (p instanceof Point)\n                throw new Error('projective point not allowed');\n            const is0 = (i) => Fp.eql(i, Fp.ZERO);\n            // fromAffine(x:0, y:0) would produce (x:0, y:0, z:1), but we need (x:0, y:1, z:0)\n            if (is0(x) && is0(y))\n                return Point.ZERO;\n            return new Point(x, y, Fp.ONE);\n        }\n        get x() {\n            return this.toAffine().x;\n        }\n        get y() {\n            return this.toAffine().y;\n        }\n        /**\n         * Takes a bunch of Projective Points but executes only one\n         * inversion on all of them. Inversion is very slow operation,\n         * so this improves performance massively.\n         * Optimization: converts a list of projective points to a list of identical points with Z=1.\n         */\n        static normalizeZ(points) {\n            const toInv = Fp.invertBatch(points.map((p) => p.pz));\n            return points.map((p, i) => p.toAffine(toInv[i])).map(Point.fromAffine);\n        }\n        /**\n         * Converts hash string or Uint8Array to Point.\n         * @param hex short/long ECDSA hex\n         */\n        static fromHex(hex) {\n            const P = Point.fromAffine(fromBytes((0, utils_js_1.ensureBytes)('pointHex', hex)));\n            P.assertValidity();\n            return P;\n        }\n        // Multiplies generator point by privateKey.\n        static fromPrivateKey(privateKey) {\n            return Point.BASE.multiply(normPrivateKeyToScalar(privateKey));\n        }\n        // Multiscalar Multiplication\n        static msm(points, scalars) {\n            return (0, curve_js_1.pippenger)(Point, Fn, points, scalars);\n        }\n        // \"Private method\", don't use it directly\n        _setWindowSize(windowSize) {\n            wnaf.setWindowSize(this, windowSize);\n        }\n        // A point on curve is valid if it conforms to equation.\n        assertValidity() {\n            assertValidMemo(this);\n        }\n        hasEvenY() {\n            const { y } = this.toAffine();\n            if (Fp.isOdd)\n                return !Fp.isOdd(y);\n            throw new Error(\"Field doesn't support isOdd\");\n        }\n        /**\n         * Compare one point to another.\n         */\n        equals(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            const U1 = Fp.eql(Fp.mul(X1, Z2), Fp.mul(X2, Z1));\n            const U2 = Fp.eql(Fp.mul(Y1, Z2), Fp.mul(Y2, Z1));\n            return U1 && U2;\n        }\n        /**\n         * Flips point to one corresponding to (x, -y) in Affine coordinates.\n         */\n        negate() {\n            return new Point(this.px, Fp.neg(this.py), this.pz);\n        }\n        // Renes-Costello-Batina exception-free doubling formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 3\n        // Cost: 8M + 3S + 3*a + 2*b3 + 15add.\n        double() {\n            const { a, b } = CURVE;\n            const b3 = Fp.mul(b, _3n);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            let t0 = Fp.mul(X1, X1); // step 1\n            let t1 = Fp.mul(Y1, Y1);\n            let t2 = Fp.mul(Z1, Z1);\n            let t3 = Fp.mul(X1, Y1);\n            t3 = Fp.add(t3, t3); // step 5\n            Z3 = Fp.mul(X1, Z1);\n            Z3 = Fp.add(Z3, Z3);\n            X3 = Fp.mul(a, Z3);\n            Y3 = Fp.mul(b3, t2);\n            Y3 = Fp.add(X3, Y3); // step 10\n            X3 = Fp.sub(t1, Y3);\n            Y3 = Fp.add(t1, Y3);\n            Y3 = Fp.mul(X3, Y3);\n            X3 = Fp.mul(t3, X3);\n            Z3 = Fp.mul(b3, Z3); // step 15\n            t2 = Fp.mul(a, t2);\n            t3 = Fp.sub(t0, t2);\n            t3 = Fp.mul(a, t3);\n            t3 = Fp.add(t3, Z3);\n            Z3 = Fp.add(t0, t0); // step 20\n            t0 = Fp.add(Z3, t0);\n            t0 = Fp.add(t0, t2);\n            t0 = Fp.mul(t0, t3);\n            Y3 = Fp.add(Y3, t0);\n            t2 = Fp.mul(Y1, Z1); // step 25\n            t2 = Fp.add(t2, t2);\n            t0 = Fp.mul(t2, t3);\n            X3 = Fp.sub(X3, t0);\n            Z3 = Fp.mul(t2, t1);\n            Z3 = Fp.add(Z3, Z3); // step 30\n            Z3 = Fp.add(Z3, Z3);\n            return new Point(X3, Y3, Z3);\n        }\n        // Renes-Costello-Batina exception-free addition formula.\n        // There is 30% faster Jacobian formula, but it is not complete.\n        // https://eprint.iacr.org/2015/1060, algorithm 1\n        // Cost: 12M + 0S + 3*a + 3*b3 + 23add.\n        add(other) {\n            assertPrjPoint(other);\n            const { px: X1, py: Y1, pz: Z1 } = this;\n            const { px: X2, py: Y2, pz: Z2 } = other;\n            let X3 = Fp.ZERO, Y3 = Fp.ZERO, Z3 = Fp.ZERO; // prettier-ignore\n            const a = CURVE.a;\n            const b3 = Fp.mul(CURVE.b, _3n);\n            let t0 = Fp.mul(X1, X2); // step 1\n            let t1 = Fp.mul(Y1, Y2);\n            let t2 = Fp.mul(Z1, Z2);\n            let t3 = Fp.add(X1, Y1);\n            let t4 = Fp.add(X2, Y2); // step 5\n            t3 = Fp.mul(t3, t4);\n            t4 = Fp.add(t0, t1);\n            t3 = Fp.sub(t3, t4);\n            t4 = Fp.add(X1, Z1);\n            let t5 = Fp.add(X2, Z2); // step 10\n            t4 = Fp.mul(t4, t5);\n            t5 = Fp.add(t0, t2);\n            t4 = Fp.sub(t4, t5);\n            t5 = Fp.add(Y1, Z1);\n            X3 = Fp.add(Y2, Z2); // step 15\n            t5 = Fp.mul(t5, X3);\n            X3 = Fp.add(t1, t2);\n            t5 = Fp.sub(t5, X3);\n            Z3 = Fp.mul(a, t4);\n            X3 = Fp.mul(b3, t2); // step 20\n            Z3 = Fp.add(X3, Z3);\n            X3 = Fp.sub(t1, Z3);\n            Z3 = Fp.add(t1, Z3);\n            Y3 = Fp.mul(X3, Z3);\n            t1 = Fp.add(t0, t0); // step 25\n            t1 = Fp.add(t1, t0);\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.mul(b3, t4);\n            t1 = Fp.add(t1, t2);\n            t2 = Fp.sub(t0, t2); // step 30\n            t2 = Fp.mul(a, t2);\n            t4 = Fp.add(t4, t2);\n            t0 = Fp.mul(t1, t4);\n            Y3 = Fp.add(Y3, t0);\n            t0 = Fp.mul(t5, t4); // step 35\n            X3 = Fp.mul(t3, X3);\n            X3 = Fp.sub(X3, t0);\n            t0 = Fp.mul(t3, t1);\n            Z3 = Fp.mul(t5, Z3);\n            Z3 = Fp.add(Z3, t0); // step 40\n            return new Point(X3, Y3, Z3);\n        }\n        subtract(other) {\n            return this.add(other.negate());\n        }\n        is0() {\n            return this.equals(Point.ZERO);\n        }\n        wNAF(n) {\n            return wnaf.wNAFCached(this, n, Point.normalizeZ);\n        }\n        /**\n         * Non-constant-time multiplication. Uses double-and-add algorithm.\n         * It's faster, but should only be used when you don't care about\n         * an exposed private key e.g. sig verification, which works over *public* keys.\n         */\n        multiplyUnsafe(sc) {\n            const { endo, n: N } = CURVE;\n            ut.aInRange('scalar', sc, _0n, N);\n            const I = Point.ZERO;\n            if (sc === _0n)\n                return I;\n            if (this.is0() || sc === _1n)\n                return this;\n            // Case a: no endomorphism. Case b: has precomputes.\n            if (!endo || wnaf.hasPrecomputes(this))\n                return wnaf.wNAFCachedUnsafe(this, sc, Point.normalizeZ);\n            // Case c: endomorphism\n            let { k1neg, k1, k2neg, k2 } = endo.splitScalar(sc);\n            let k1p = I;\n            let k2p = I;\n            let d = this;\n            while (k1 > _0n || k2 > _0n) {\n                if (k1 & _1n)\n                    k1p = k1p.add(d);\n                if (k2 & _1n)\n                    k2p = k2p.add(d);\n                d = d.double();\n                k1 >>= _1n;\n                k2 >>= _1n;\n            }\n            if (k1neg)\n                k1p = k1p.negate();\n            if (k2neg)\n                k2p = k2p.negate();\n            k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n            return k1p.add(k2p);\n        }\n        /**\n         * Constant time multiplication.\n         * Uses wNAF method. Windowed method may be 10% faster,\n         * but takes 2x longer to generate and consumes 2x memory.\n         * Uses precomputes when available.\n         * Uses endomorphism for Koblitz curves.\n         * @param scalar by which the point would be multiplied\n         * @returns New point\n         */\n        multiply(scalar) {\n            const { endo, n: N } = CURVE;\n            ut.aInRange('scalar', scalar, _1n, N);\n            let point, fake; // Fake point is used to const-time mult\n            if (endo) {\n                const { k1neg, k1, k2neg, k2 } = endo.splitScalar(scalar);\n                let { p: k1p, f: f1p } = this.wNAF(k1);\n                let { p: k2p, f: f2p } = this.wNAF(k2);\n                k1p = wnaf.constTimeNegate(k1neg, k1p);\n                k2p = wnaf.constTimeNegate(k2neg, k2p);\n                k2p = new Point(Fp.mul(k2p.px, endo.beta), k2p.py, k2p.pz);\n                point = k1p.add(k2p);\n                fake = f1p.add(f2p);\n            }\n            else {\n                const { p, f } = this.wNAF(scalar);\n                point = p;\n                fake = f;\n            }\n            // Normalize `z` for both points, but return only real one\n            return Point.normalizeZ([point, fake])[0];\n        }\n        /**\n         * Efficiently calculate `aP + bQ`. Unsafe, can expose private key, if used incorrectly.\n         * Not using Strauss-Shamir trick: precomputation tables are faster.\n         * The trick could be useful if both P and Q are not G (not in our case).\n         * @returns non-zero affine point\n         */\n        multiplyAndAddUnsafe(Q, a, b) {\n            const G = Point.BASE; // No Strauss-Shamir trick: we have 10% faster G precomputes\n            const mul = (P, a // Select faster multiply() method\n            ) => (a === _0n || a === _1n || !P.equals(G) ? P.multiplyUnsafe(a) : P.multiply(a));\n            const sum = mul(this, a).add(mul(Q, b));\n            return sum.is0() ? undefined : sum;\n        }\n        // Converts Projective point to affine (x, y) coordinates.\n        // Can accept precomputed Z^-1 - for example, from invertBatch.\n        // (x, y, z)  (x=x/z, y=y/z)\n        toAffine(iz) {\n            return toAffineMemo(this, iz);\n        }\n        isTorsionFree() {\n            const { h: cofactor, isTorsionFree } = CURVE;\n            if (cofactor === _1n)\n                return true; // No subgroups, always torsion-free\n            if (isTorsionFree)\n                return isTorsionFree(Point, this);\n            throw new Error('isTorsionFree() has not been declared for the elliptic curve');\n        }\n        clearCofactor() {\n            const { h: cofactor, clearCofactor } = CURVE;\n            if (cofactor === _1n)\n                return this; // Fast-path\n            if (clearCofactor)\n                return clearCofactor(Point, this);\n            return this.multiplyUnsafe(CURVE.h);\n        }\n        toRawBytes(isCompressed = true) {\n            (0, utils_js_1.abool)('isCompressed', isCompressed);\n            this.assertValidity();\n            return toBytes(Point, this, isCompressed);\n        }\n        toHex(isCompressed = true) {\n            (0, utils_js_1.abool)('isCompressed', isCompressed);\n            return ut.bytesToHex(this.toRawBytes(isCompressed));\n        }\n    }\n    Point.BASE = new Point(CURVE.Gx, CURVE.Gy, Fp.ONE);\n    Point.ZERO = new Point(Fp.ZERO, Fp.ONE, Fp.ZERO);\n    const _bits = CURVE.nBitLength;\n    const wnaf = (0, curve_js_1.wNAF)(Point, CURVE.endo ? Math.ceil(_bits / 2) : _bits);\n    // Validate if generator point is on curve\n    return {\n        CURVE,\n        ProjectivePoint: Point,\n        normPrivateKeyToScalar,\n        weierstrassEquation,\n        isWithinCurveOrder,\n    };\n}\nfunction validateOpts(curve) {\n    const opts = (0, curve_js_1.validateBasic)(curve);\n    ut.validateObject(opts, {\n        hash: 'hash',\n        hmac: 'function',\n        randomBytes: 'function',\n    }, {\n        bits2int: 'function',\n        bits2int_modN: 'function',\n        lowS: 'boolean',\n    });\n    return Object.freeze({ lowS: true, ...opts });\n}\n/**\n * Creates short weierstrass curve and ECDSA signature methods for it.\n * @example\n * import { Field } from '@noble/curves/abstract/modular';\n * // Before that, define BigInt-s: a, b, p, n, Gx, Gy\n * const curve = weierstrass({ a, b, Fp: Field(p), n, Gx, Gy, h: 1n })\n */\nfunction weierstrass(curveDef) {\n    const CURVE = validateOpts(curveDef);\n    const { Fp, n: CURVE_ORDER } = CURVE;\n    const compressedLen = Fp.BYTES + 1; // e.g. 33 for 32\n    const uncompressedLen = 2 * Fp.BYTES + 1; // e.g. 65 for 32\n    function modN(a) {\n        return (0, modular_js_1.mod)(a, CURVE_ORDER);\n    }\n    function invN(a) {\n        return (0, modular_js_1.invert)(a, CURVE_ORDER);\n    }\n    const { ProjectivePoint: Point, normPrivateKeyToScalar, weierstrassEquation, isWithinCurveOrder, } = weierstrassPoints({\n        ...CURVE,\n        toBytes(_c, point, isCompressed) {\n            const a = point.toAffine();\n            const x = Fp.toBytes(a.x);\n            const cat = ut.concatBytes;\n            (0, utils_js_1.abool)('isCompressed', isCompressed);\n            if (isCompressed) {\n                return cat(Uint8Array.from([point.hasEvenY() ? 0x02 : 0x03]), x);\n            }\n            else {\n                return cat(Uint8Array.from([0x04]), x, Fp.toBytes(a.y));\n            }\n        },\n        fromBytes(bytes) {\n            const len = bytes.length;\n            const head = bytes[0];\n            const tail = bytes.subarray(1);\n            // this.assertValidity() is done inside of fromHex\n            if (len === compressedLen && (head === 0x02 || head === 0x03)) {\n                const x = ut.bytesToNumberBE(tail);\n                if (!ut.inRange(x, _1n, Fp.ORDER))\n                    throw new Error('Point is not on curve');\n                const y2 = weierstrassEquation(x); // y = x + ax + b\n                let y;\n                try {\n                    y = Fp.sqrt(y2); // y = y ^ (p+1)/4\n                }\n                catch (sqrtError) {\n                    const suffix = sqrtError instanceof Error ? ': ' + sqrtError.message : '';\n                    throw new Error('Point is not on curve' + suffix);\n                }\n                const isYOdd = (y & _1n) === _1n;\n                // ECDSA\n                const isHeadOdd = (head & 1) === 1;\n                if (isHeadOdd !== isYOdd)\n                    y = Fp.neg(y);\n                return { x, y };\n            }\n            else if (len === uncompressedLen && head === 0x04) {\n                const x = Fp.fromBytes(tail.subarray(0, Fp.BYTES));\n                const y = Fp.fromBytes(tail.subarray(Fp.BYTES, 2 * Fp.BYTES));\n                return { x, y };\n            }\n            else {\n                const cl = compressedLen;\n                const ul = uncompressedLen;\n                throw new Error('invalid Point, expected length of ' + cl + ', or uncompressed ' + ul + ', got ' + len);\n            }\n        },\n    });\n    const numToNByteStr = (num) => ut.bytesToHex(ut.numberToBytesBE(num, CURVE.nByteLength));\n    function isBiggerThanHalfOrder(number) {\n        const HALF = CURVE_ORDER >> _1n;\n        return number > HALF;\n    }\n    function normalizeS(s) {\n        return isBiggerThanHalfOrder(s) ? modN(-s) : s;\n    }\n    // slice bytes num\n    const slcNum = (b, from, to) => ut.bytesToNumberBE(b.slice(from, to));\n    /**\n     * ECDSA signature with its (r, s) properties. Supports DER & compact representations.\n     */\n    class Signature {\n        constructor(r, s, recovery) {\n            this.r = r;\n            this.s = s;\n            this.recovery = recovery;\n            this.assertValidity();\n        }\n        // pair (bytes of r, bytes of s)\n        static fromCompact(hex) {\n            const l = CURVE.nByteLength;\n            hex = (0, utils_js_1.ensureBytes)('compactSignature', hex, l * 2);\n            return new Signature(slcNum(hex, 0, l), slcNum(hex, l, 2 * l));\n        }\n        // DER encoded ECDSA signature\n        // https://bitcoin.stackexchange.com/questions/57644/what-are-the-parts-of-a-bitcoin-transaction-input-script\n        static fromDER(hex) {\n            const { r, s } = exports.DER.toSig((0, utils_js_1.ensureBytes)('DER', hex));\n            return new Signature(r, s);\n        }\n        assertValidity() {\n            ut.aInRange('r', this.r, _1n, CURVE_ORDER); // r in [1..N]\n            ut.aInRange('s', this.s, _1n, CURVE_ORDER); // s in [1..N]\n        }\n        addRecoveryBit(recovery) {\n            return new Signature(this.r, this.s, recovery);\n        }\n        recoverPublicKey(msgHash) {\n            const { r, s, recovery: rec } = this;\n            const h = bits2int_modN((0, utils_js_1.ensureBytes)('msgHash', msgHash)); // Truncate hash\n            if (rec == null || ![0, 1, 2, 3].includes(rec))\n                throw new Error('recovery id invalid');\n            const radj = rec === 2 || rec === 3 ? r + CURVE.n : r;\n            if (radj >= Fp.ORDER)\n                throw new Error('recovery id 2 or 3 invalid');\n            const prefix = (rec & 1) === 0 ? '02' : '03';\n            const R = Point.fromHex(prefix + numToNByteStr(radj));\n            const ir = invN(radj); // r^-1\n            const u1 = modN(-h * ir); // -hr^-1\n            const u2 = modN(s * ir); // sr^-1\n            const Q = Point.BASE.multiplyAndAddUnsafe(R, u1, u2); // (sr^-1)R-(hr^-1)G = -(hr^-1)G + (sr^-1)\n            if (!Q)\n                throw new Error('point at infinify'); // unsafe is fine: no priv data leaked\n            Q.assertValidity();\n            return Q;\n        }\n        // Signatures should be low-s, to prevent malleability.\n        hasHighS() {\n            return isBiggerThanHalfOrder(this.s);\n        }\n        normalizeS() {\n            return this.hasHighS() ? new Signature(this.r, modN(-this.s), this.recovery) : this;\n        }\n        // DER-encoded\n        toDERRawBytes() {\n            return ut.hexToBytes(this.toDERHex());\n        }\n        toDERHex() {\n            return exports.DER.hexFromSig({ r: this.r, s: this.s });\n        }\n        // padded bytes of r, then padded bytes of s\n        toCompactRawBytes() {\n            return ut.hexToBytes(this.toCompactHex());\n        }\n        toCompactHex() {\n            return numToNByteStr(this.r) + numToNByteStr(this.s);\n        }\n    }\n    const utils = {\n        isValidPrivateKey(privateKey) {\n            try {\n                normPrivateKeyToScalar(privateKey);\n                return true;\n            }\n            catch (error) {\n                return false;\n            }\n        },\n        normPrivateKeyToScalar: normPrivateKeyToScalar,\n        /**\n         * Produces cryptographically secure private key from random of size\n         * (groupLen + ceil(groupLen / 2)) with modulo bias being negligible.\n         */\n        randomPrivateKey: () => {\n            const length = (0, modular_js_1.getMinHashLength)(CURVE.n);\n            return (0, modular_js_1.mapHashToField)(CURVE.randomBytes(length), CURVE.n);\n        },\n        /**\n         * Creates precompute table for an arbitrary EC point. Makes point \"cached\".\n         * Allows to massively speed-up `point.multiply(scalar)`.\n         * @returns cached point\n         * @example\n         * const fast = utils.precompute(8, ProjectivePoint.fromHex(someonesPubKey));\n         * fast.multiply(privKey); // much faster ECDH now\n         */\n        precompute(windowSize = 8, point = Point.BASE) {\n            point._setWindowSize(windowSize);\n            point.multiply(BigInt(3)); // 3 is arbitrary, just need any number here\n            return point;\n        },\n    };\n    /**\n     * Computes public key for a private key. Checks for validity of the private key.\n     * @param privateKey private key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns Public key, full when isCompressed=false; short when isCompressed=true\n     */\n    function getPublicKey(privateKey, isCompressed = true) {\n        return Point.fromPrivateKey(privateKey).toRawBytes(isCompressed);\n    }\n    /**\n     * Quick and dirty check for item being public key. Does not validate hex, or being on-curve.\n     */\n    function isProbPub(item) {\n        const arr = ut.isBytes(item);\n        const str = typeof item === 'string';\n        const len = (arr || str) && item.length;\n        if (arr)\n            return len === compressedLen || len === uncompressedLen;\n        if (str)\n            return len === 2 * compressedLen || len === 2 * uncompressedLen;\n        if (item instanceof Point)\n            return true;\n        return false;\n    }\n    /**\n     * ECDH (Elliptic Curve Diffie Hellman).\n     * Computes shared public key from private key and public key.\n     * Checks: 1) private key validity 2) shared key is on-curve.\n     * Does NOT hash the result.\n     * @param privateA private key\n     * @param publicB different public key\n     * @param isCompressed whether to return compact (default), or full key\n     * @returns shared public key\n     */\n    function getSharedSecret(privateA, publicB, isCompressed = true) {\n        if (isProbPub(privateA))\n            throw new Error('first arg must be private key');\n        if (!isProbPub(publicB))\n            throw new Error('second arg must be public key');\n        const b = Point.fromHex(publicB); // check for being on-curve\n        return b.multiply(normPrivateKeyToScalar(privateA)).toRawBytes(isCompressed);\n    }\n    // RFC6979: ensure ECDSA msg is X bytes and < N. RFC suggests optional truncating via bits2octets.\n    // FIPS 186-4 4.6 suggests the leftmost min(nBitLen, outLen) bits, which matches bits2int.\n    // bits2int can produce res>N, we can do mod(res, N) since the bitLen is the same.\n    // int2octets can't be used; pads small msgs with 0: unacceptatble for trunc as per RFC vectors\n    const bits2int = CURVE.bits2int ||\n        function (bytes) {\n            // Our custom check \"just in case\"\n            if (bytes.length > 8192)\n                throw new Error('input is too large');\n            // For curves with nBitLength % 8 !== 0: bits2octets(bits2octets(m)) !== bits2octets(m)\n            // for some cases, since bytes.length * 8 is not actual bitLength.\n            const num = ut.bytesToNumberBE(bytes); // check for == u8 done here\n            const delta = bytes.length * 8 - CURVE.nBitLength; // truncate to nBitLength leftmost bits\n            return delta > 0 ? num >> BigInt(delta) : num;\n        };\n    const bits2int_modN = CURVE.bits2int_modN ||\n        function (bytes) {\n            return modN(bits2int(bytes)); // can't use bytesToNumberBE here\n        };\n    // NOTE: pads output with zero as per spec\n    const ORDER_MASK = ut.bitMask(CURVE.nBitLength);\n    /**\n     * Converts to bytes. Checks if num in `[0..ORDER_MASK-1]` e.g.: `[0..2^256-1]`.\n     */\n    function int2octets(num) {\n        ut.aInRange('num < 2^' + CURVE.nBitLength, num, _0n, ORDER_MASK);\n        // works with order, can have different size than numToField!\n        return ut.numberToBytesBE(num, CURVE.nByteLength);\n    }\n    // Steps A, D of RFC6979 3.2\n    // Creates RFC6979 seed; converts msg/privKey to numbers.\n    // Used only in sign, not in verify.\n    // NOTE: we cannot assume here that msgHash has same amount of bytes as curve order,\n    // this will be invalid at least for P521. Also it can be bigger for P224 + SHA256\n    function prepSig(msgHash, privateKey, opts = defaultSigOpts) {\n        if (['recovered', 'canonical'].some((k) => k in opts))\n            throw new Error('sign() legacy options not supported');\n        const { hash, randomBytes } = CURVE;\n        let { lowS, prehash, extraEntropy: ent } = opts; // generates low-s sigs by default\n        if (lowS == null)\n            lowS = true; // RFC6979 3.2: we skip step A, because we already provide hash\n        msgHash = (0, utils_js_1.ensureBytes)('msgHash', msgHash);\n        validateSigVerOpts(opts);\n        if (prehash)\n            msgHash = (0, utils_js_1.ensureBytes)('prehashed msgHash', hash(msgHash));\n        // We can't later call bits2octets, since nested bits2int is broken for curves\n        // with nBitLength % 8 !== 0. Because of that, we unwrap it here as int2octets call.\n        // const bits2octets = (bits) => int2octets(bits2int_modN(bits))\n        const h1int = bits2int_modN(msgHash);\n        const d = normPrivateKeyToScalar(privateKey); // validate private key, convert to bigint\n        const seedArgs = [int2octets(d), int2octets(h1int)];\n        // extraEntropy. RFC6979 3.6: additional k' (optional).\n        if (ent != null && ent !== false) {\n            // K = HMAC_K(V || 0x00 || int2octets(x) || bits2octets(h1) || k')\n            const e = ent === true ? randomBytes(Fp.BYTES) : ent; // generate random bytes OR pass as-is\n            seedArgs.push((0, utils_js_1.ensureBytes)('extraEntropy', e)); // check for being bytes\n        }\n        const seed = ut.concatBytes(...seedArgs); // Step D of RFC6979 3.2\n        const m = h1int; // NOTE: no need to call bits2int second time here, it is inside truncateHash!\n        // Converts signature params into point w r/s, checks result for validity.\n        function k2sig(kBytes) {\n            // RFC 6979 Section 3.2, step 3: k = bits2int(T)\n            const k = bits2int(kBytes); // Cannot use fields methods, since it is group element\n            if (!isWithinCurveOrder(k))\n                return; // Important: all mod() calls here must be done over N\n            const ik = invN(k); // k^-1 mod n\n            const q = Point.BASE.multiply(k).toAffine(); // q = Gk\n            const r = modN(q.x); // r = q.x mod n\n            if (r === _0n)\n                return;\n            // Can use scalar blinding b^-1(bm + bdr) where b  [1,q1] according to\n            // https://tches.iacr.org/index.php/TCHES/article/view/7337/6509. We've decided against it:\n            // a) dependency on CSPRNG b) 15% slowdown c) doesn't really help since bigints are not CT\n            const s = modN(ik * modN(m + r * d)); // Not using blinding here\n            if (s === _0n)\n                return;\n            let recovery = (q.x === r ? 0 : 2) | Number(q.y & _1n); // recovery bit (2 or 3, when q.x > n)\n            let normS = s;\n            if (lowS && isBiggerThanHalfOrder(s)) {\n                normS = normalizeS(s); // if lowS was passed, ensure s is always\n                recovery ^= 1; // // in the bottom half of N\n            }\n            return new Signature(r, normS, recovery); // use normS, not s\n        }\n        return { seed, k2sig };\n    }\n    const defaultSigOpts = { lowS: CURVE.lowS, prehash: false };\n    const defaultVerOpts = { lowS: CURVE.lowS, prehash: false };\n    /**\n     * Signs message hash with a private key.\n     * ```\n     * sign(m, d, k) where\n     *   (x, y) = G  k\n     *   r = x mod n\n     *   s = (m + dr)/k mod n\n     * ```\n     * @param msgHash NOT message. msg needs to be hashed to `msgHash`, or use `prehash`.\n     * @param privKey private key\n     * @param opts lowS for non-malleable sigs. extraEntropy for mixing randomness into k. prehash will hash first arg.\n     * @returns signature with recovery param\n     */\n    function sign(msgHash, privKey, opts = defaultSigOpts) {\n        const { seed, k2sig } = prepSig(msgHash, privKey, opts); // Steps A, D of RFC6979 3.2.\n        const C = CURVE;\n        const drbg = ut.createHmacDrbg(C.hash.outputLen, C.nByteLength, C.hmac);\n        return drbg(seed, k2sig); // Steps B, C, D, E, F, G\n    }\n    // Enable precomputes. Slows down first publicKey computation by 20ms.\n    Point.BASE._setWindowSize(8);\n    // utils.precompute(8, ProjectivePoint.BASE)\n    /**\n     * Verifies a signature against message hash and public key.\n     * Rejects lowS signatures by default: to override,\n     * specify option `{lowS: false}`. Implements section 4.1.4 from https://www.secg.org/sec1-v2.pdf:\n     *\n     * ```\n     * verify(r, s, h, P) where\n     *   U1 = hs^-1 mod n\n     *   U2 = rs^-1 mod n\n     *   R = U1G - U2P\n     *   mod(R.x, n) == r\n     * ```\n     */\n    function verify(signature, msgHash, publicKey, opts = defaultVerOpts) {\n        const sg = signature;\n        msgHash = (0, utils_js_1.ensureBytes)('msgHash', msgHash);\n        publicKey = (0, utils_js_1.ensureBytes)('publicKey', publicKey);\n        const { lowS, prehash, format } = opts;\n        // Verify opts, deduce signature format\n        validateSigVerOpts(opts);\n        if ('strict' in opts)\n            throw new Error('options.strict was renamed to lowS');\n        if (format !== undefined && format !== 'compact' && format !== 'der')\n            throw new Error('format must be compact or der');\n        const isHex = typeof sg === 'string' || ut.isBytes(sg);\n        const isObj = !isHex &&\n            !format &&\n            typeof sg === 'object' &&\n            sg !== null &&\n            typeof sg.r === 'bigint' &&\n            typeof sg.s === 'bigint';\n        if (!isHex && !isObj)\n            throw new Error('invalid signature, expected Uint8Array, hex string or Signature instance');\n        let _sig = undefined;\n        let P;\n        try {\n            if (isObj)\n                _sig = new Signature(sg.r, sg.s);\n            if (isHex) {\n                // Signature can be represented in 2 ways: compact (2*nByteLength) & DER (variable-length).\n                // Since DER can also be 2*nByteLength bytes, we check for it first.\n                try {\n                    if (format !== 'compact')\n                        _sig = Signature.fromDER(sg);\n                }\n                catch (derError) {\n                    if (!(derError instanceof exports.DER.Err))\n                        throw derError;\n                }\n                if (!_sig && format !== 'der')\n                    _sig = Signature.fromCompact(sg);\n            }\n            P = Point.fromHex(publicKey);\n        }\n        catch (error) {\n            return false;\n        }\n        if (!_sig)\n            return false;\n        if (lowS && _sig.hasHighS())\n            return false;\n        if (prehash)\n            msgHash = CURVE.hash(msgHash);\n        const { r, s } = _sig;\n        const h = bits2int_modN(msgHash); // Cannot use fields methods, since it is group element\n        const is = invN(s); // s^-1\n        const u1 = modN(h * is); // u1 = hs^-1 mod n\n        const u2 = modN(r * is); // u2 = rs^-1 mod n\n        const R = Point.BASE.multiplyAndAddUnsafe(P, u1, u2)?.toAffine(); // R = u1G + u2P\n        if (!R)\n            return false;\n        const v = modN(R.x);\n        return v === r;\n    }\n    return {\n        CURVE,\n        getPublicKey,\n        getSharedSecret,\n        sign,\n        verify,\n        ProjectivePoint: Point,\n        Signature,\n        utils,\n    };\n}\n/**\n * Implementation of the Shallue and van de Woestijne method for any weierstrass curve.\n * TODO: check if there is a way to merge this with uvRatio in Edwards; move to modular.\n * b = True and y = sqrt(u / v) if (u / v) is square in F, and\n * b = False and y = sqrt(Z * (u / v)) otherwise.\n * @param Fp\n * @param Z\n * @returns\n */\nfunction SWUFpSqrtRatio(Fp, Z) {\n    // Generic implementation\n    const q = Fp.ORDER;\n    let l = _0n;\n    for (let o = q - _1n; o % _2n === _0n; o /= _2n)\n        l += _1n;\n    const c1 = l; // 1. c1, the largest integer such that 2^c1 divides q - 1.\n    // We need 2n ** c1 and 2n ** (c1-1). We can't use **; but we can use <<.\n    // 2n ** c1 == 2n << (c1-1)\n    const _2n_pow_c1_1 = _2n << (c1 - _1n - _1n);\n    const _2n_pow_c1 = _2n_pow_c1_1 * _2n;\n    const c2 = (q - _1n) / _2n_pow_c1; // 2. c2 = (q - 1) / (2^c1)  # Integer arithmetic\n    const c3 = (c2 - _1n) / _2n; // 3. c3 = (c2 - 1) / 2            # Integer arithmetic\n    const c4 = _2n_pow_c1 - _1n; // 4. c4 = 2^c1 - 1                # Integer arithmetic\n    const c5 = _2n_pow_c1_1; // 5. c5 = 2^(c1 - 1)                  # Integer arithmetic\n    const c6 = Fp.pow(Z, c2); // 6. c6 = Z^c2\n    const c7 = Fp.pow(Z, (c2 + _1n) / _2n); // 7. c7 = Z^((c2 + 1) / 2)\n    let sqrtRatio = (u, v) => {\n        let tv1 = c6; // 1. tv1 = c6\n        let tv2 = Fp.pow(v, c4); // 2. tv2 = v^c4\n        let tv3 = Fp.sqr(tv2); // 3. tv3 = tv2^2\n        tv3 = Fp.mul(tv3, v); // 4. tv3 = tv3 * v\n        let tv5 = Fp.mul(u, tv3); // 5. tv5 = u * tv3\n        tv5 = Fp.pow(tv5, c3); // 6. tv5 = tv5^c3\n        tv5 = Fp.mul(tv5, tv2); // 7. tv5 = tv5 * tv2\n        tv2 = Fp.mul(tv5, v); // 8. tv2 = tv5 * v\n        tv3 = Fp.mul(tv5, u); // 9. tv3 = tv5 * u\n        let tv4 = Fp.mul(tv3, tv2); // 10. tv4 = tv3 * tv2\n        tv5 = Fp.pow(tv4, c5); // 11. tv5 = tv4^c5\n        let isQR = Fp.eql(tv5, Fp.ONE); // 12. isQR = tv5 == 1\n        tv2 = Fp.mul(tv3, c7); // 13. tv2 = tv3 * c7\n        tv5 = Fp.mul(tv4, tv1); // 14. tv5 = tv4 * tv1\n        tv3 = Fp.cmov(tv2, tv3, isQR); // 15. tv3 = CMOV(tv2, tv3, isQR)\n        tv4 = Fp.cmov(tv5, tv4, isQR); // 16. tv4 = CMOV(tv5, tv4, isQR)\n        // 17. for i in (c1, c1 - 1, ..., 2):\n        for (let i = c1; i > _1n; i--) {\n            let tv5 = i - _2n; // 18.    tv5 = i - 2\n            tv5 = _2n << (tv5 - _1n); // 19.    tv5 = 2^tv5\n            let tvv5 = Fp.pow(tv4, tv5); // 20.    tv5 = tv4^tv5\n            const e1 = Fp.eql(tvv5, Fp.ONE); // 21.    e1 = tv5 == 1\n            tv2 = Fp.mul(tv3, tv1); // 22.    tv2 = tv3 * tv1\n            tv1 = Fp.mul(tv1, tv1); // 23.    tv1 = tv1 * tv1\n            tvv5 = Fp.mul(tv4, tv1); // 24.    tv5 = tv4 * tv1\n            tv3 = Fp.cmov(tv2, tv3, e1); // 25.    tv3 = CMOV(tv2, tv3, e1)\n            tv4 = Fp.cmov(tvv5, tv4, e1); // 26.    tv4 = CMOV(tv5, tv4, e1)\n        }\n        return { isValid: isQR, value: tv3 };\n    };\n    if (Fp.ORDER % _4n === _3n) {\n        // sqrt_ratio_3mod4(u, v)\n        const c1 = (Fp.ORDER - _3n) / _4n; // 1. c1 = (q - 3) / 4     # Integer arithmetic\n        const c2 = Fp.sqrt(Fp.neg(Z)); // 2. c2 = sqrt(-Z)\n        sqrtRatio = (u, v) => {\n            let tv1 = Fp.sqr(v); // 1. tv1 = v^2\n            const tv2 = Fp.mul(u, v); // 2. tv2 = u * v\n            tv1 = Fp.mul(tv1, tv2); // 3. tv1 = tv1 * tv2\n            let y1 = Fp.pow(tv1, c1); // 4. y1 = tv1^c1\n            y1 = Fp.mul(y1, tv2); // 5. y1 = y1 * tv2\n            const y2 = Fp.mul(y1, c2); // 6. y2 = y1 * c2\n            const tv3 = Fp.mul(Fp.sqr(y1), v); // 7. tv3 = y1^2; 8. tv3 = tv3 * v\n            const isQR = Fp.eql(tv3, u); // 9. isQR = tv3 == u\n            let y = Fp.cmov(y2, y1, isQR); // 10. y = CMOV(y2, y1, isQR)\n            return { isValid: isQR, value: y }; // 11. return (isQR, y) isQR ? y : y*c2\n        };\n    }\n    // No curves uses that\n    // if (Fp.ORDER % _8n === _5n) // sqrt_ratio_5mod8\n    return sqrtRatio;\n}\n/**\n * Simplified Shallue-van de Woestijne-Ulas Method\n * https://www.rfc-editor.org/rfc/rfc9380#section-6.6.2\n */\nfunction mapToCurveSimpleSWU(Fp, opts) {\n    (0, modular_js_1.validateField)(Fp);\n    if (!Fp.isValid(opts.A) || !Fp.isValid(opts.B) || !Fp.isValid(opts.Z))\n        throw new Error('mapToCurveSimpleSWU: invalid opts');\n    const sqrtRatio = SWUFpSqrtRatio(Fp, opts.Z);\n    if (!Fp.isOdd)\n        throw new Error('Fp.isOdd is not implemented!');\n    // Input: u, an element of F.\n    // Output: (x, y), a point on E.\n    return (u) => {\n        // prettier-ignore\n        let tv1, tv2, tv3, tv4, tv5, tv6, x, y;\n        tv1 = Fp.sqr(u); // 1.  tv1 = u^2\n        tv1 = Fp.mul(tv1, opts.Z); // 2.  tv1 = Z * tv1\n        tv2 = Fp.sqr(tv1); // 3.  tv2 = tv1^2\n        tv2 = Fp.add(tv2, tv1); // 4.  tv2 = tv2 + tv1\n        tv3 = Fp.add(tv2, Fp.ONE); // 5.  tv3 = tv2 + 1\n        tv3 = Fp.mul(tv3, opts.B); // 6.  tv3 = B * tv3\n        tv4 = Fp.cmov(opts.Z, Fp.neg(tv2), !Fp.eql(tv2, Fp.ZERO)); // 7.  tv4 = CMOV(Z, -tv2, tv2 != 0)\n        tv4 = Fp.mul(tv4, opts.A); // 8.  tv4 = A * tv4\n        tv2 = Fp.sqr(tv3); // 9.  tv2 = tv3^2\n        tv6 = Fp.sqr(tv4); // 10. tv6 = tv4^2\n        tv5 = Fp.mul(tv6, opts.A); // 11. tv5 = A * tv6\n        tv2 = Fp.add(tv2, tv5); // 12. tv2 = tv2 + tv5\n        tv2 = Fp.mul(tv2, tv3); // 13. tv2 = tv2 * tv3\n        tv6 = Fp.mul(tv6, tv4); // 14. tv6 = tv6 * tv4\n        tv5 = Fp.mul(tv6, opts.B); // 15. tv5 = B * tv6\n        tv2 = Fp.add(tv2, tv5); // 16. tv2 = tv2 + tv5\n        x = Fp.mul(tv1, tv3); // 17.   x = tv1 * tv3\n        const { isValid, value } = sqrtRatio(tv2, tv6); // 18. (is_gx1_square, y1) = sqrt_ratio(tv2, tv6)\n        y = Fp.mul(tv1, u); // 19.   y = tv1 * u  -> Z * u^3 * y1\n        y = Fp.mul(y, value); // 20.   y = y * y1\n        x = Fp.cmov(x, tv3, isValid); // 21.   x = CMOV(x, tv3, is_gx1_square)\n        y = Fp.cmov(y, value, isValid); // 22.   y = CMOV(y, y1, is_gx1_square)\n        const e1 = Fp.isOdd(u) === Fp.isOdd(y); // 23.  e1 = sgn0(u) == sgn0(y)\n        y = Fp.cmov(Fp.neg(y), y, e1); // 24.   y = CMOV(-y, y, e1)\n        x = Fp.div(x, tv4); // 25.   x = x / tv4\n        return { x, y };\n    };\n}\n//# sourceMappingURL=weierstrass.js.map","'use strict';\n\n/**\n * A Leaf in a linked list.\n */\nclass Chunk {\n  /**\n   * @class Chunk\n   */\n  constructor() {\n    /** @type {Chunk} */\n    this.next = null;\n    /** @type {Buffer} */\n    this.buffer = null;\n  }\n}\n\n/**\n * Linked list for buffers.\n */\nmodule.exports = class LinkedList {\n  /**\n   * @class LinkedList\n   */\n  constructor() {\n    /** @type {Chunk} */\n    this.head = null;\n    /** @type {Chunk} */\n    this.tail = null;\n\n    this.length = 0;\n    this.count = 0;\n  }\n\n  /**\n   * Add a buffer to the end of the list.\n   * @param {Buffer} buf\n   */\n  push(buf) {\n    const entry = new Chunk();\n    entry.buffer = buf;\n\n    if (this.length > 0) {\n      this.tail.next = entry;\n    } else {\n      this.head = entry;\n    }\n\n    this.tail = entry;\n    this.length += buf.length;\n    this.count += 1;\n  }\n\n  /**\n   * Add a buffer to the start of the list.\n   * @param {Buffer} buf\n   */\n  unshift(buf) {\n    const entry = new Chunk();\n    entry.buffer = buf;\n    entry.next = this.head;\n\n    if (this.isEmpty()) {\n      this.tail = entry;\n    }\n\n    this.head = entry;\n    this.length += buf.length;\n    this.count += 1;\n  }\n\n  /**\n   * Remove and return first element's buffer.\n   * @returns {Buffer|null}\n   */\n  shift() {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    const ret = this.head.buffer;\n\n    if (this.head === this.tail) {\n      this.head = null;\n      this.tail = null;\n    } else {\n      this.head = this.head.next;\n    }\n\n    this.length -= ret.length;\n    this.length = Math.max(this.length, 0);\n    this.count -= 1;\n\n    return ret;\n  }\n\n  /**\n   * Get buffer of first element or null.\n   * @returns {Buffer|null}\n   */\n  get first() {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    return this.head.buffer;\n  }\n\n  /**\n   * Get buffer of last element or null.\n   * @returns {Buffer|null}\n   */\n  get last() {\n    if (this.isEmpty()) {\n      return null;\n    }\n\n    return this.tail.buffer;\n  }\n\n  /**\n   * Check if a list is empty.\n   * @returns {bool}\n   */\n  isEmpty() {\n    return this.length === 0;\n  }\n\n  /**\n   * Remove all elements from a list.\n   */\n  clear() {\n    this.head = null;\n    this.tail = null;\n    this.length = 0;\n    this.count = 0;\n  }\n\n  /**\n   * Return a subset of linked list.\n   * @param {number} start Offset bytes from start.\n   * @param {number} end Bytes count.\n   * @returns {LinkedList}\n   */\n  slice(start, end) {\n    if (start < 0 || start >= this.length) {\n      return new LinkedList();\n    }\n\n    if (end < 0 || end > this.length || end < start) {\n      return new LinkedList();\n    }\n\n    const list = new LinkedList();\n\n    let leaf = this.head;\n    let offsetStart = start;\n    let offsetEnd = end;\n\n    // Find head of slice.\n    while (leaf) {\n      if (leaf.buffer.length > offsetStart) {\n        if (offsetStart === 0 && leaf.buffer.length <= offsetEnd) {\n          list.push(leaf.buffer);\n        } else if (leaf.buffer.length >= offsetEnd) {\n          list.push(leaf.buffer.slice(offsetStart, offsetEnd));\n        } else {\n          list.push(leaf.buffer.slice(offsetStart));\n        }\n\n        break;\n      }\n\n      offsetStart -= leaf.buffer.length;\n      offsetEnd -= leaf.buffer.length;\n      leaf = leaf.next;\n    }\n\n    // Find tail of slice\n    if (leaf.buffer.length < offsetEnd) {\n      while (leaf) {\n        if (leaf.buffer.length === offsetEnd) {\n          list.push(leaf.buffer);\n          break;\n        } else if (leaf.buffer.length > offsetEnd) {\n          list.push(leaf.buffer.slice(0, offsetEnd));\n          break;\n        } else if (offsetStart < 0 && leaf.buffer.length < offsetEnd) {\n          list.push(leaf.buffer);\n        }\n\n        offsetStart -= leaf.buffer.length;\n        offsetEnd -= leaf.buffer.length;\n        leaf = leaf.next;\n      }\n    }\n\n    return list;\n  }\n};\n","import type { Context } from \"./context/context\";\n\nexport type SessionKeys = {\n  localMasterKey: Buffer;\n  localMasterSalt: Buffer;\n  remoteMasterKey: Buffer;\n  remoteMasterSalt: Buffer;\n};\n\nexport type Config = {\n  keys: SessionKeys;\n  profile: number;\n};\n\nexport class Session<T extends Context> {\n  localContext!: T;\n  remoteContext!: T;\n  onData?: (buf: Buffer) => void;\n\n  constructor(private ContextCls: any) {}\n\n  start(\n    localMasterKey: Buffer,\n    localMasterSalt: Buffer,\n    remoteMasterKey: Buffer,\n    remoteMasterSalt: Buffer,\n    profile: number,\n  ) {\n    this.localContext = new this.ContextCls(\n      localMasterKey,\n      localMasterSalt,\n      profile,\n    );\n    this.remoteContext = new this.ContextCls(\n      remoteMasterKey,\n      remoteMasterSalt,\n      profile,\n    );\n  }\n}\n","import type { RtpPacket } from \"../rtp/rtp\";\nimport { AV1RtpPayload } from \"./av1\";\nimport type { DePacketizerBase } from \"./base\";\nimport { H264RtpPayload } from \"./h264\";\nimport { OpusRtpPayload } from \"./opus\";\nimport { Vp8RtpPayload } from \"./vp8\";\nimport { Vp9RtpPayload } from \"./vp9\";\n\nexport * from \"./av1\";\nexport * from \"./base\";\nexport * from \"./h264\";\nexport * from \"./opus\";\nexport * from \"./vp8\";\nexport * from \"./vp9\";\n\nexport function dePacketizeRtpPackets(\n  codec: DepacketizerCodec,\n  packets: RtpPacket[],\n  frameFragmentBuffer?: Buffer,\n): {\n  isKeyframe: boolean;\n  data: Buffer;\n  sequence: number;\n  timestamp: number;\n  frameFragmentBuffer?: Buffer;\n} {\n  const basicCodecParser = (Depacketizer: typeof DePacketizerBase) => {\n    const partitions: DePacketizerBase[] = [];\n    for (const p of packets) {\n      const codec = Depacketizer.deSerialize(p.payload, frameFragmentBuffer);\n      if (codec.fragment) {\n        frameFragmentBuffer ??= Buffer.alloc(0);\n        frameFragmentBuffer = codec.fragment;\n      } else if (codec.payload) {\n        frameFragmentBuffer = undefined;\n      }\n      partitions.push(codec);\n    }\n    const isKeyframe = !!partitions.find((f) => f.isKeyframe);\n    const data = Buffer.concat(\n      partitions.map((f) => f.payload).filter((p) => p),\n    );\n\n    return {\n      isKeyframe,\n      data,\n      sequence: packets.at(-1)?.header.sequenceNumber ?? 0,\n      timestamp: packets.at(-1)?.header.timestamp ?? 0,\n      frameFragmentBuffer,\n    };\n  };\n\n  switch (codec.toUpperCase()) {\n    case \"AV1\": {\n      const chunks = packets.map((p) => AV1RtpPayload.deSerialize(p.payload));\n      const isKeyframe = !!chunks.find((f) => f.isKeyframe);\n      const data = AV1RtpPayload.getFrame(chunks);\n      return {\n        isKeyframe,\n        data,\n        sequence: packets.at(-1)?.header.sequenceNumber ?? 0,\n        timestamp: packets.at(-1)?.header.timestamp ?? 0,\n      };\n    }\n    case \"MPEG4/ISO/AVC\":\n      return basicCodecParser(H264RtpPayload);\n    case \"VP8\":\n      return basicCodecParser(Vp8RtpPayload);\n    case \"VP9\":\n      return basicCodecParser(Vp9RtpPayload);\n    case \"OPUS\":\n      return basicCodecParser(OpusRtpPayload);\n    default:\n      throw new Error();\n  }\n}\n\nexport const depacketizerCodecs = [\n  \"MPEG4/ISO/AVC\",\n  \"VP8\",\n  \"VP9\",\n  \"OPUS\",\n  \"AV1\",\n] as const;\nexport type DepacketizerCodec =\n  | (typeof depacketizerCodecs)[number]\n  | Lowercase<(typeof depacketizerCodecs)[number]>;\n","var util = require('util')\nvar isProperty = require('is-property')\n\nvar INDENT_START = /[\\{\\[]/\nvar INDENT_END = /[\\}\\]]/\n\n// from https://mathiasbynens.be/notes/reserved-keywords\nvar RESERVED = [\n  'do',\n  'if',\n  'in',\n  'for',\n  'let',\n  'new',\n  'try',\n  'var',\n  'case',\n  'else',\n  'enum',\n  'eval',\n  'null',\n  'this',\n  'true',\n  'void',\n  'with',\n  'await',\n  'break',\n  'catch',\n  'class',\n  'const',\n  'false',\n  'super',\n  'throw',\n  'while',\n  'yield',\n  'delete',\n  'export',\n  'import',\n  'public',\n  'return',\n  'static',\n  'switch',\n  'typeof',\n  'default',\n  'extends',\n  'finally',\n  'package',\n  'private',\n  'continue',\n  'debugger',\n  'function',\n  'arguments',\n  'interface',\n  'protected',\n  'implements',\n  'instanceof',\n  'NaN',\n  'undefined'\n]\n\nvar RESERVED_MAP = {}\n\nfor (var i = 0; i < RESERVED.length; i++) {\n  RESERVED_MAP[RESERVED[i]] = true\n}\n\nvar isVariable = function (name) {\n  return isProperty(name) && !RESERVED_MAP.hasOwnProperty(name)\n}\n\nvar formats = {\n  s: function(s) {\n    return '' + s\n  },\n  d: function(d) {\n    return '' + Number(d)\n  },\n  o: function(o) {\n    return JSON.stringify(o)\n  }\n}\n\nvar genfun = function() {\n  var lines = []\n  var indent = 0\n  var vars = {}\n\n  var push = function(str) {\n    var spaces = ''\n    while (spaces.length < indent*2) spaces += '  '\n    lines.push(spaces+str)\n  }\n\n  var pushLine = function(line) {\n    if (INDENT_END.test(line.trim()[0]) && INDENT_START.test(line[line.length-1])) {\n      indent--\n      push(line)\n      indent++\n      return\n    }\n    if (INDENT_START.test(line[line.length-1])) {\n      push(line)\n      indent++\n      return\n    }\n    if (INDENT_END.test(line.trim()[0])) {\n      indent--\n      push(line)\n      return\n    }\n\n    push(line)\n  }\n\n  var line = function(fmt) {\n    if (!fmt) return line\n\n    if (arguments.length === 1 && fmt.indexOf('\\n') > -1) {\n      var lines = fmt.trim().split('\\n')\n      for (var i = 0; i < lines.length; i++) {\n        pushLine(lines[i].trim())\n      }\n    } else {\n      pushLine(util.format.apply(util, arguments))\n    }\n\n    return line\n  }\n\n  line.scope = {}\n  line.formats = formats\n\n  line.sym = function(name) {\n    if (!name || !isVariable(name)) name = 'tmp'\n    if (!vars[name]) vars[name] = 0\n    return name + (vars[name]++ || '')\n  }\n\n  line.property = function(obj, name) {\n    if (arguments.length === 1) {\n      name = obj\n      obj = ''\n    }\n\n    name = name + ''\n\n    if (isProperty(name)) return (obj ? obj + '.' + name : name)\n    return obj ? obj + '[' + JSON.stringify(name) + ']' : JSON.stringify(name)\n  }\n\n  line.toString = function() {\n    return lines.join('\\n')\n  }\n\n  line.toFunction = function(scope) {\n    if (!scope) scope = {}\n\n    var src = 'return ('+line.toString()+')'\n\n    Object.keys(line.scope).forEach(function (key) {\n      if (!scope[key]) scope[key] = line.scope[key]\n    })\n\n    var keys = Object.keys(scope).map(function(key) {\n      return key\n    })\n\n    var vals = keys.map(function(key) {\n      return scope[key]\n    })\n\n    return Function.apply(null, keys.concat(src)).apply(null, vals)\n  }\n\n  if (arguments.length) line.apply(null, arguments)\n\n  return line\n}\n\ngenfun.formats = formats\nmodule.exports = genfun\n","import { randomUUID } from \"crypto\";\nimport { jspack } from \"@shinyoshiaki/jspack\";\n\nimport { Event, debug } from \"../imports/common\";\n\nimport { SCTP, SCTP_STATE, type Transport } from \"../../../sctp/src\";\nimport {\n  DATA_CHANNEL_ACK,\n  DATA_CHANNEL_OPEN,\n  DATA_CHANNEL_RELIABLE,\n  WEBRTC_BINARY,\n  WEBRTC_BINARY_EMPTY,\n  WEBRTC_DCEP,\n  WEBRTC_STRING,\n  WEBRTC_STRING_EMPTY,\n} from \"../const\";\nimport {\n  type DCState,\n  RTCDataChannel,\n  RTCDataChannelParameters,\n} from \"../dataChannel\";\nimport type { RTCDtlsTransport } from \"./dtls\";\n\nconst log = debug(\"werift:packages/webrtc/src/transport/sctp.ts\");\n\nexport class RTCSctpTransport {\n  dtlsTransport!: RTCDtlsTransport;\n  sctp!: SCTP;\n\n  readonly onDataChannel = new Event<[RTCDataChannel]>();\n  readonly id = randomUUID().toString();\n\n  mid?: string;\n  mLineIndex?: number;\n  bundled = false;\n  dataChannels: { [key: number]: RTCDataChannel } = {};\n\n  private dataChannelQueue: [RTCDataChannel, number, Buffer][] = [];\n  private dataChannelId?: number;\n  private eventDisposer: (() => void)[] = [];\n\n  constructor(public port = 5000) {}\n\n  setDtlsTransport(dtlsTransport: RTCDtlsTransport) {\n    if (this.dtlsTransport && this.dtlsTransport.id === dtlsTransport.id) {\n      return;\n    }\n\n    this.eventDisposer.forEach((dispose) => dispose());\n\n    this.dtlsTransport = dtlsTransport;\n    this.sctp = new SCTP(new BridgeDtls(this.dtlsTransport), this.port);\n\n    this.eventDisposer = [\n      ...[\n        this.sctp.onReceive.subscribe(this.datachannelReceive),\n        this.sctp.onReconfigStreams.subscribe((ids: number[]) => {\n          ids.forEach((id) => {\n            const dc = this.dataChannels[id];\n            if (!dc) return;\n            // todo fix\n            dc.setReadyState(\"closing\");\n            dc.setReadyState(\"closed\");\n            delete this.dataChannels[id];\n          });\n        }),\n        this.sctp.stateChanged.connected.subscribe(() => {\n          Object.values(this.dataChannels).forEach((channel) => {\n            if (channel.negotiated && channel.readyState !== \"open\") {\n              channel.setReadyState(\"open\");\n            }\n          });\n          this.dataChannelFlush();\n        }),\n        this.sctp.stateChanged.closed.subscribe(() => {\n          Object.values(this.dataChannels).forEach((dc) => {\n            dc.setReadyState(\"closed\");\n          });\n          this.dataChannels = {};\n        }),\n        this.dtlsTransport.onStateChange.subscribe((state) => {\n          if (state === \"closed\") {\n            this.sctp.setState(SCTP_STATE.CLOSED);\n          }\n        }),\n      ].map((e) => e.unSubscribe),\n      () => (this.sctp.onSackReceived = async () => {}),\n    ];\n\n    this.sctp.onSackReceived = async () => {\n      await this.dataChannelFlush();\n    };\n  }\n\n  private get isServer() {\n    return this.dtlsTransport.iceTransport.role !== \"controlling\";\n  }\n\n  channelByLabel(label: string) {\n    return Object.values(this.dataChannels).find((d) => d.label === label);\n  }\n\n  private datachannelReceive = async (\n    streamId: number,\n    ppId: number,\n    data: Buffer,\n  ) => {\n    if (ppId === WEBRTC_DCEP && data.length > 0) {\n      log(\"DCEP\", streamId, ppId, data);\n      switch (data[0]) {\n        case DATA_CHANNEL_OPEN:\n          {\n            if (data.length < 12) {\n              log(\"DATA_CHANNEL_OPEN data.length not enough\");\n              return;\n            }\n\n            if (!Object.keys(this.dataChannels).includes(streamId.toString())) {\n              const [\n                ,\n                channelType,\n                ,\n                reliability,\n                labelLength,\n                protocolLength,\n              ] = jspack.Unpack(\"!BBHLHH\", data);\n\n              let pos = 12;\n              const label = data.slice(pos, pos + labelLength).toString(\"utf8\");\n              pos += labelLength;\n              const protocol = data\n                .slice(pos, pos + protocolLength)\n                .toString(\"utf8\");\n\n              log(\"DATA_CHANNEL_OPEN\", {\n                channelType,\n                reliability,\n                streamId,\n                label,\n                protocol,\n              });\n\n              const maxRetransmits =\n                (channelType & 0x03) === 1 ? reliability : undefined;\n              const maxPacketLifeTime =\n                (channelType & 0x03) === 2 ? reliability : undefined;\n\n              // # register channel\n              const parameters = new RTCDataChannelParameters({\n                label,\n                ordered: (channelType & 0x80) === 0,\n                maxPacketLifeTime,\n                maxRetransmits,\n                protocol,\n                id: streamId,\n              });\n              const channel = new RTCDataChannel(this, parameters, false);\n              channel.isCreatedByRemote = true;\n              this.dataChannels[streamId] = channel;\n\n              this.onDataChannel.execute(channel);\n              channel.setReadyState(\"open\");\n            } else {\n              log(\"datachannel already opened\", \"retransmit ack\");\n            }\n\n            const channel = this.dataChannels[streamId];\n            this.dataChannelQueue.push([\n              channel,\n              WEBRTC_DCEP,\n              Buffer.from(jspack.Pack(\"!B\", [DATA_CHANNEL_ACK])),\n            ]);\n            await this.dataChannelFlush();\n          }\n          break;\n        case DATA_CHANNEL_ACK:\n          {\n            log(\"DATA_CHANNEL_ACK\", streamId, ppId);\n            const channel = this.dataChannels[streamId];\n            if (!channel) {\n              throw new Error(\"channel not found\");\n            }\n            channel.setReadyState(\"open\");\n          }\n          break;\n      }\n    } else {\n      const channel = this.dataChannels[streamId];\n      if (channel) {\n        const msg = (() => {\n          switch (ppId) {\n            case WEBRTC_STRING:\n              return data.toString(\"utf8\");\n            case WEBRTC_STRING_EMPTY:\n              return \"\";\n            case WEBRTC_BINARY:\n              return data;\n            case WEBRTC_BINARY_EMPTY:\n              return Buffer.from([]);\n            default:\n              throw new Error();\n          }\n        })();\n\n        // Update reception statistics\n        channel.messagesReceived++;\n        channel.bytesReceived += data.length;\n\n        channel.onMessage.execute(msg);\n        channel.emit(\"message\", { data: msg });\n        if (channel.onmessage) {\n          channel.onmessage({ data: msg });\n        }\n      }\n    }\n  };\n\n  dataChannelAddNegotiated(channel: RTCDataChannel) {\n    if (channel.id == undefined) {\n      throw new Error();\n    }\n    if (this.dataChannels[channel.id]) {\n      throw new Error();\n    }\n\n    this.dataChannels[channel.id] = channel;\n\n    if (this.sctp.associationState === SCTP_STATE.ESTABLISHED) {\n      channel.setReadyState(\"open\");\n    }\n  }\n\n  dataChannelOpen(channel: RTCDataChannel) {\n    if (channel.id) {\n      if (this.dataChannels[channel.id])\n        throw new Error(\n          `Data channel with ID ${channel.id} already registered`,\n        );\n      this.dataChannels[channel.id] = channel;\n    }\n\n    let channelType = DATA_CHANNEL_RELIABLE;\n    const priority = 0;\n    let reliability = 0;\n\n    if (!channel.ordered) {\n      channelType = 0x80;\n    }\n    if (channel.maxRetransmits) {\n      channelType = 1;\n      reliability = channel.maxRetransmits;\n    } else if (channel.maxPacketLifeTime) {\n      channelType = 2;\n      reliability = channel.maxPacketLifeTime;\n    }\n\n    // 5.1.  DATA_CHANNEL_OPEN Message\n    const data = jspack.Pack(\"!BBHLHH\", [\n      DATA_CHANNEL_OPEN,\n      channelType,\n      priority,\n      reliability,\n      channel.label.length,\n      channel.protocol.length,\n    ]);\n    const send = Buffer.concat([\n      Buffer.from(data),\n      Buffer.from(channel.label, \"utf8\"),\n      Buffer.from(channel.protocol, \"utf8\"),\n    ]);\n    this.dataChannelQueue.push([channel, WEBRTC_DCEP, send]);\n    this.dataChannelFlush();\n  }\n\n  private async dataChannelFlush() {\n    // \"\"\"\n    // Try to flush buffered data to the SCTP layer.\n\n    // We wait until the association is established, as we need to know\n    // whether we are a client or a server to correctly assign an odd/even ID\n    // to the data channels.\n    // \"\"\"\n\n    if (this.sctp.associationState != SCTP_STATE.ESTABLISHED) return;\n    if (this.sctp.outboundQueue.length > 0) return;\n\n    while (this.dataChannelQueue.length > 0) {\n      const [channel, protocol, userData] = this.dataChannelQueue.shift()!;\n\n      let streamId = channel.id;\n      if (streamId === undefined) {\n        streamId = this.dataChannelId!;\n        while (Object.keys(this.dataChannels).includes(streamId.toString())) {\n          streamId += 2;\n        }\n        this.dataChannels[streamId] = channel;\n        channel.setId(streamId);\n      }\n\n      if (protocol === WEBRTC_DCEP) {\n        await this.sctp.send(streamId, protocol, userData, {\n          ordered: true,\n        });\n      } else {\n        const expiry = channel.maxPacketLifeTime\n          ? Date.now() + channel.maxPacketLifeTime / 1000\n          : undefined;\n\n        await this.sctp.send(streamId, protocol, userData, {\n          expiry,\n          maxRetransmits: channel.maxRetransmits,\n          ordered: channel.ordered,\n        });\n        channel.addBufferedAmount(-userData.length);\n      }\n    }\n    // Resetting the queue to empty array mitigates this.\n    this.dataChannelQueue = [];\n  }\n\n  datachannelSend = (channel: RTCDataChannel, data: Buffer | string) => {\n    channel.addBufferedAmount(data.length);\n\n    this.dataChannelQueue.push(\n      typeof data === \"string\"\n        ? [channel, WEBRTC_STRING, Buffer.from(data)]\n        : [channel, WEBRTC_BINARY, data],\n    );\n\n    if (this.sctp.associationState !== SCTP_STATE.ESTABLISHED) {\n      log(\"sctp not established\", this.sctp.associationState);\n    }\n\n    this.dataChannelFlush();\n  };\n\n  static getCapabilities() {\n    return new RTCSctpCapabilities(65536);\n  }\n\n  setRemotePort(port: number) {\n    this.sctp.setRemotePort(port);\n  }\n\n  async start(remotePort: number) {\n    if (this.isServer) {\n      this.dataChannelId = 0;\n    } else {\n      this.dataChannelId = 1;\n    }\n    this.sctp.isServer = this.isServer;\n\n    await this.sctp.start(remotePort);\n  }\n\n  async stop() {\n    this.dtlsTransport.dataReceiver = () => {};\n    await this.sctp.stop();\n  }\n\n  dataChannelClose(channel: RTCDataChannel) {\n    if (!([\"closing\", \"closed\"] as DCState[]).includes(channel.readyState)) {\n      channel.setReadyState(\"closing\");\n\n      if (this.sctp.associationState === SCTP_STATE.ESTABLISHED) {\n        // Check if channel.id is already in reconfigQueue to prevent duplicates\n        if (!this.sctp.reconfigQueue.includes(channel.id)) {\n          this.sctp.reconfigQueue.push(channel.id);\n        }\n        if (this.sctp.reconfigQueue.length === 1) {\n          this.sctp.transmitReconfigRequest();\n        }\n      } else {\n        this.dataChannelQueue = this.dataChannelQueue.filter(\n          (queueItem) => queueItem[0].id !== channel.id,\n        );\n        // Remove any pending reconfiguration requests for this channel\n        this.sctp.reconfigQueue = this.sctp.reconfigQueue.filter(\n          (streamId) => streamId !== channel.id,\n        );\n        if (channel.id) {\n          delete this.dataChannels[channel.id];\n        }\n        channel.setReadyState(\"closed\");\n      }\n    }\n  }\n}\n\nexport class RTCSctpCapabilities {\n  constructor(public maxMessageSize: number) {}\n}\n\nclass BridgeDtls implements Transport {\n  constructor(private dtls: RTCDtlsTransport) {}\n  set onData(onData: (buf: Buffer) => void) {\n    this.dtls.dataReceiver = onData;\n  }\n  readonly send = (data: Buffer) => {\n    return this.dtls.sendData(data);\n  };\n  close() {}\n}\n","import { bufferWriter } from \"../../../common/src\";\nimport { RtcpHeader } from \"./header\";\n\nexport class RtcpSourceDescriptionPacket {\n  static readonly type = 202;\n  readonly type = RtcpSourceDescriptionPacket.type;\n  chunks: SourceDescriptionChunk[] = [];\n\n  constructor(props: Partial<RtcpSourceDescriptionPacket>) {\n    Object.assign(this, props);\n  }\n\n  get length() {\n    let length = 0;\n    this.chunks.forEach((chunk) => (length += chunk.length));\n    return length;\n  }\n\n  serialize() {\n    let payload = Buffer.concat(this.chunks.map((chunk) => chunk.serialize()));\n    while (payload.length % 4)\n      payload = Buffer.concat([payload, Buffer.from([0])]);\n    return RtcpHeader.serialize(\n      this.type,\n      this.chunks.length,\n      payload,\n      payload.length / 4,\n    );\n  }\n\n  static deSerialize(payload: Buffer, header: RtcpHeader) {\n    const chunks: SourceDescriptionChunk[] = [];\n    for (let i = 0; i < payload.length; ) {\n      const chunk = SourceDescriptionChunk.deSerialize(payload.slice(i));\n      chunks.push(chunk);\n      i += chunk.length;\n    }\n\n    return new RtcpSourceDescriptionPacket({ chunks });\n  }\n}\n\nexport class SourceDescriptionChunk {\n  source!: number;\n  items: SourceDescriptionItem[] = [];\n\n  constructor(props: Partial<SourceDescriptionChunk> = {}) {\n    Object.assign(this, props);\n  }\n\n  get length() {\n    let length = 4;\n    this.items.forEach((item) => (length += item.length));\n    length += 1;\n    length += getPadding(length);\n    return length;\n  }\n\n  serialize() {\n    const data = Buffer.concat([\n      bufferWriter([4], [this.source]),\n      Buffer.concat(this.items.map((item) => item.serialize())),\n    ]);\n\n    const res = Buffer.concat([data, Buffer.alloc(getPadding(data.length))]);\n    return res;\n  }\n\n  static deSerialize(data: Buffer) {\n    const source = data.readUInt32BE();\n    const items: SourceDescriptionItem[] = [];\n    for (let i = 4; i < data.length; ) {\n      const type = data[i];\n      if (type === 0) break;\n\n      const item = SourceDescriptionItem.deSerialize(data.slice(i));\n      items.push(item);\n      i += item.length;\n    }\n\n    return new SourceDescriptionChunk({ source, items });\n  }\n}\n\nexport class SourceDescriptionItem {\n  type!: number;\n  text!: string;\n\n  constructor(props: Partial<SourceDescriptionItem>) {\n    Object.assign(this, props);\n  }\n\n  get length() {\n    return 1 + 1 + Buffer.from(this.text).length;\n  }\n\n  serialize() {\n    const text = Buffer.from(this.text);\n    return Buffer.concat([\n      bufferWriter([1, 1], [this.type, text.length]),\n      text,\n    ]);\n  }\n\n  static deSerialize(data: Buffer) {\n    const type = data[0];\n    const octetCount = data[1];\n    const text = data.slice(2, 2 + octetCount).toString();\n    return new SourceDescriptionItem({ type, text });\n  }\n}\n\nfunction getPadding(len: number) {\n  if (len % 4 == 0) {\n    return 0;\n  }\n  return 4 - (len % 4);\n}\n","module.exports = require(\"crypto\");","import { int, uint16Gt } from \"../../imports/common\";\nimport type { RtpPacket } from \"../../imports/rtp\";\n\n// from aiortc\n\nexport class StreamStatistics {\n  base_seq?: number;\n  max_seq?: number;\n  cycles = 0;\n  packets_received = 0;\n\n  // # jitter\n  private clockRate: number;\n  jitter_q4 = 0;\n  private last_arrival?: number;\n  private last_timestamp?: number;\n\n  // # fraction lost\n  expected_prior = 0;\n  received_prior = 0;\n\n  constructor(clockRate: number) {\n    this.clockRate = clockRate;\n  }\n\n  add(packet: RtpPacket, now: number = Date.now() / 1000) {\n    const inOrder =\n      this.max_seq == undefined ||\n      uint16Gt(packet.header.sequenceNumber, this.max_seq);\n    this.packets_received++;\n\n    if (this.base_seq == undefined) {\n      this.base_seq = packet.header.sequenceNumber;\n    }\n\n    if (inOrder) {\n      const arrival = int(now * this.clockRate);\n\n      if (\n        this.max_seq != undefined &&\n        packet.header.sequenceNumber < this.max_seq\n      ) {\n        this.cycles += 1 << 16;\n      }\n      this.max_seq = packet.header.sequenceNumber;\n\n      if (\n        packet.header.timestamp !== this.last_timestamp &&\n        this.packets_received > 1\n      ) {\n        const diff = Math.abs(\n          arrival -\n            (this.last_arrival ?? 0) -\n            (packet.header.timestamp - (this.last_timestamp ?? 0)),\n        );\n        this.jitter_q4 += diff - ((this.jitter_q4 + 8) >> 4);\n      }\n\n      this.last_arrival = arrival;\n      this.last_timestamp = packet.header.timestamp;\n    }\n  }\n\n  get fraction_lost() {\n    const expected_interval = this.packets_expected - this.expected_prior;\n    this.expected_prior = this.packets_expected;\n    const received_interval = this.packets_received - this.received_prior;\n    this.received_prior = this.packets_received;\n    const lost_interval = expected_interval - received_interval;\n    if (expected_interval == 0 || lost_interval <= 0) {\n      return 0;\n    } else {\n      return Math.floor((lost_interval << 8) / expected_interval);\n    }\n  }\n\n  get jitter() {\n    return this.jitter_q4 >> 4;\n  }\n\n  get packets_expected() {\n    return this.cycles + (this.max_seq ?? 0) - (this.base_seq ?? 0) + 1;\n  }\n\n  get packets_lost() {\n    const lost = this.packets_expected - this.packets_received;\n    return lost < 0 ? 0 : lost;\n  }\n}\n","module.exports = require(\"url\");","/*! MIT License. Copyright 2015-2018 Richard Moore <me@ricmoo.com>. See LICENSE.txt. */\n(function(root) {\n    \"use strict\";\n\n    function checkInt(value) {\n        return (parseInt(value) === value);\n    }\n\n    function checkInts(arrayish) {\n        if (!checkInt(arrayish.length)) { return false; }\n\n        for (var i = 0; i < arrayish.length; i++) {\n            if (!checkInt(arrayish[i]) || arrayish[i] < 0 || arrayish[i] > 255) {\n                return false;\n            }\n        }\n\n        return true;\n    }\n\n    function coerceArray(arg, copy) {\n\n        // ArrayBuffer view\n        if (arg.buffer && arg.name === 'Uint8Array') {\n\n            if (copy) {\n                if (arg.slice) {\n                    arg = arg.slice();\n                } else {\n                    arg = Array.prototype.slice.call(arg);\n                }\n            }\n\n            return arg;\n        }\n\n        // It's an array; check it is a valid representation of a byte\n        if (Array.isArray(arg)) {\n            if (!checkInts(arg)) {\n                throw new Error('Array contains invalid value: ' + arg);\n            }\n\n            return new Uint8Array(arg);\n        }\n\n        // Something else, but behaves like an array (maybe a Buffer? Arguments?)\n        if (checkInt(arg.length) && checkInts(arg)) {\n            return new Uint8Array(arg);\n        }\n\n        throw new Error('unsupported array-like object');\n    }\n\n    function createArray(length) {\n        return new Uint8Array(length);\n    }\n\n    function copyArray(sourceArray, targetArray, targetStart, sourceStart, sourceEnd) {\n        if (sourceStart != null || sourceEnd != null) {\n            if (sourceArray.slice) {\n                sourceArray = sourceArray.slice(sourceStart, sourceEnd);\n            } else {\n                sourceArray = Array.prototype.slice.call(sourceArray, sourceStart, sourceEnd);\n            }\n        }\n        targetArray.set(sourceArray, targetStart);\n    }\n\n\n\n    var convertUtf8 = (function() {\n        function toBytes(text) {\n            var result = [], i = 0;\n            text = encodeURI(text);\n            while (i < text.length) {\n                var c = text.charCodeAt(i++);\n\n                // if it is a % sign, encode the following 2 bytes as a hex value\n                if (c === 37) {\n                    result.push(parseInt(text.substr(i, 2), 16))\n                    i += 2;\n\n                // otherwise, just the actual byte\n                } else {\n                    result.push(c)\n                }\n            }\n\n            return coerceArray(result);\n        }\n\n        function fromBytes(bytes) {\n            var result = [], i = 0;\n\n            while (i < bytes.length) {\n                var c = bytes[i];\n\n                if (c < 128) {\n                    result.push(String.fromCharCode(c));\n                    i++;\n                } else if (c > 191 && c < 224) {\n                    result.push(String.fromCharCode(((c & 0x1f) << 6) | (bytes[i + 1] & 0x3f)));\n                    i += 2;\n                } else {\n                    result.push(String.fromCharCode(((c & 0x0f) << 12) | ((bytes[i + 1] & 0x3f) << 6) | (bytes[i + 2] & 0x3f)));\n                    i += 3;\n                }\n            }\n\n            return result.join('');\n        }\n\n        return {\n            toBytes: toBytes,\n            fromBytes: fromBytes,\n        }\n    })();\n\n    var convertHex = (function() {\n        function toBytes(text) {\n            var result = [];\n            for (var i = 0; i < text.length; i += 2) {\n                result.push(parseInt(text.substr(i, 2), 16));\n            }\n\n            return result;\n        }\n\n        // http://ixti.net/development/javascript/2011/11/11/base64-encodedecode-of-utf8-in-browser-with-js.html\n        var Hex = '0123456789abcdef';\n\n        function fromBytes(bytes) {\n                var result = [];\n                for (var i = 0; i < bytes.length; i++) {\n                    var v = bytes[i];\n                    result.push(Hex[(v & 0xf0) >> 4] + Hex[v & 0x0f]);\n                }\n                return result.join('');\n        }\n\n        return {\n            toBytes: toBytes,\n            fromBytes: fromBytes,\n        }\n    })();\n\n\n    // Number of rounds by keysize\n    var numberOfRounds = {16: 10, 24: 12, 32: 14}\n\n    // Round constant words\n    var rcon = [0x01, 0x02, 0x04, 0x08, 0x10, 0x20, 0x40, 0x80, 0x1b, 0x36, 0x6c, 0xd8, 0xab, 0x4d, 0x9a, 0x2f, 0x5e, 0xbc, 0x63, 0xc6, 0x97, 0x35, 0x6a, 0xd4, 0xb3, 0x7d, 0xfa, 0xef, 0xc5, 0x91];\n\n    // S-box and Inverse S-box (S is for Substitution)\n    var S = [0x63, 0x7c, 0x77, 0x7b, 0xf2, 0x6b, 0x6f, 0xc5, 0x30, 0x01, 0x67, 0x2b, 0xfe, 0xd7, 0xab, 0x76, 0xca, 0x82, 0xc9, 0x7d, 0xfa, 0x59, 0x47, 0xf0, 0xad, 0xd4, 0xa2, 0xaf, 0x9c, 0xa4, 0x72, 0xc0, 0xb7, 0xfd, 0x93, 0x26, 0x36, 0x3f, 0xf7, 0xcc, 0x34, 0xa5, 0xe5, 0xf1, 0x71, 0xd8, 0x31, 0x15, 0x04, 0xc7, 0x23, 0xc3, 0x18, 0x96, 0x05, 0x9a, 0x07, 0x12, 0x80, 0xe2, 0xeb, 0x27, 0xb2, 0x75, 0x09, 0x83, 0x2c, 0x1a, 0x1b, 0x6e, 0x5a, 0xa0, 0x52, 0x3b, 0xd6, 0xb3, 0x29, 0xe3, 0x2f, 0x84, 0x53, 0xd1, 0x00, 0xed, 0x20, 0xfc, 0xb1, 0x5b, 0x6a, 0xcb, 0xbe, 0x39, 0x4a, 0x4c, 0x58, 0xcf, 0xd0, 0xef, 0xaa, 0xfb, 0x43, 0x4d, 0x33, 0x85, 0x45, 0xf9, 0x02, 0x7f, 0x50, 0x3c, 0x9f, 0xa8, 0x51, 0xa3, 0x40, 0x8f, 0x92, 0x9d, 0x38, 0xf5, 0xbc, 0xb6, 0xda, 0x21, 0x10, 0xff, 0xf3, 0xd2, 0xcd, 0x0c, 0x13, 0xec, 0x5f, 0x97, 0x44, 0x17, 0xc4, 0xa7, 0x7e, 0x3d, 0x64, 0x5d, 0x19, 0x73, 0x60, 0x81, 0x4f, 0xdc, 0x22, 0x2a, 0x90, 0x88, 0x46, 0xee, 0xb8, 0x14, 0xde, 0x5e, 0x0b, 0xdb, 0xe0, 0x32, 0x3a, 0x0a, 0x49, 0x06, 0x24, 0x5c, 0xc2, 0xd3, 0xac, 0x62, 0x91, 0x95, 0xe4, 0x79, 0xe7, 0xc8, 0x37, 0x6d, 0x8d, 0xd5, 0x4e, 0xa9, 0x6c, 0x56, 0xf4, 0xea, 0x65, 0x7a, 0xae, 0x08, 0xba, 0x78, 0x25, 0x2e, 0x1c, 0xa6, 0xb4, 0xc6, 0xe8, 0xdd, 0x74, 0x1f, 0x4b, 0xbd, 0x8b, 0x8a, 0x70, 0x3e, 0xb5, 0x66, 0x48, 0x03, 0xf6, 0x0e, 0x61, 0x35, 0x57, 0xb9, 0x86, 0xc1, 0x1d, 0x9e, 0xe1, 0xf8, 0x98, 0x11, 0x69, 0xd9, 0x8e, 0x94, 0x9b, 0x1e, 0x87, 0xe9, 0xce, 0x55, 0x28, 0xdf, 0x8c, 0xa1, 0x89, 0x0d, 0xbf, 0xe6, 0x42, 0x68, 0x41, 0x99, 0x2d, 0x0f, 0xb0, 0x54, 0xbb, 0x16];\n    var Si =[0x52, 0x09, 0x6a, 0xd5, 0x30, 0x36, 0xa5, 0x38, 0xbf, 0x40, 0xa3, 0x9e, 0x81, 0xf3, 0xd7, 0xfb, 0x7c, 0xe3, 0x39, 0x82, 0x9b, 0x2f, 0xff, 0x87, 0x34, 0x8e, 0x43, 0x44, 0xc4, 0xde, 0xe9, 0xcb, 0x54, 0x7b, 0x94, 0x32, 0xa6, 0xc2, 0x23, 0x3d, 0xee, 0x4c, 0x95, 0x0b, 0x42, 0xfa, 0xc3, 0x4e, 0x08, 0x2e, 0xa1, 0x66, 0x28, 0xd9, 0x24, 0xb2, 0x76, 0x5b, 0xa2, 0x49, 0x6d, 0x8b, 0xd1, 0x25, 0x72, 0xf8, 0xf6, 0x64, 0x86, 0x68, 0x98, 0x16, 0xd4, 0xa4, 0x5c, 0xcc, 0x5d, 0x65, 0xb6, 0x92, 0x6c, 0x70, 0x48, 0x50, 0xfd, 0xed, 0xb9, 0xda, 0x5e, 0x15, 0x46, 0x57, 0xa7, 0x8d, 0x9d, 0x84, 0x90, 0xd8, 0xab, 0x00, 0x8c, 0xbc, 0xd3, 0x0a, 0xf7, 0xe4, 0x58, 0x05, 0xb8, 0xb3, 0x45, 0x06, 0xd0, 0x2c, 0x1e, 0x8f, 0xca, 0x3f, 0x0f, 0x02, 0xc1, 0xaf, 0xbd, 0x03, 0x01, 0x13, 0x8a, 0x6b, 0x3a, 0x91, 0x11, 0x41, 0x4f, 0x67, 0xdc, 0xea, 0x97, 0xf2, 0xcf, 0xce, 0xf0, 0xb4, 0xe6, 0x73, 0x96, 0xac, 0x74, 0x22, 0xe7, 0xad, 0x35, 0x85, 0xe2, 0xf9, 0x37, 0xe8, 0x1c, 0x75, 0xdf, 0x6e, 0x47, 0xf1, 0x1a, 0x71, 0x1d, 0x29, 0xc5, 0x89, 0x6f, 0xb7, 0x62, 0x0e, 0xaa, 0x18, 0xbe, 0x1b, 0xfc, 0x56, 0x3e, 0x4b, 0xc6, 0xd2, 0x79, 0x20, 0x9a, 0xdb, 0xc0, 0xfe, 0x78, 0xcd, 0x5a, 0xf4, 0x1f, 0xdd, 0xa8, 0x33, 0x88, 0x07, 0xc7, 0x31, 0xb1, 0x12, 0x10, 0x59, 0x27, 0x80, 0xec, 0x5f, 0x60, 0x51, 0x7f, 0xa9, 0x19, 0xb5, 0x4a, 0x0d, 0x2d, 0xe5, 0x7a, 0x9f, 0x93, 0xc9, 0x9c, 0xef, 0xa0, 0xe0, 0x3b, 0x4d, 0xae, 0x2a, 0xf5, 0xb0, 0xc8, 0xeb, 0xbb, 0x3c, 0x83, 0x53, 0x99, 0x61, 0x17, 0x2b, 0x04, 0x7e, 0xba, 0x77, 0xd6, 0x26, 0xe1, 0x69, 0x14, 0x63, 0x55, 0x21, 0x0c, 0x7d];\n\n    // Transformations for encryption\n    var T1 = [0xc66363a5, 0xf87c7c84, 0xee777799, 0xf67b7b8d, 0xfff2f20d, 0xd66b6bbd, 0xde6f6fb1, 0x91c5c554, 0x60303050, 0x02010103, 0xce6767a9, 0x562b2b7d, 0xe7fefe19, 0xb5d7d762, 0x4dababe6, 0xec76769a, 0x8fcaca45, 0x1f82829d, 0x89c9c940, 0xfa7d7d87, 0xeffafa15, 0xb25959eb, 0x8e4747c9, 0xfbf0f00b, 0x41adadec, 0xb3d4d467, 0x5fa2a2fd, 0x45afafea, 0x239c9cbf, 0x53a4a4f7, 0xe4727296, 0x9bc0c05b, 0x75b7b7c2, 0xe1fdfd1c, 0x3d9393ae, 0x4c26266a, 0x6c36365a, 0x7e3f3f41, 0xf5f7f702, 0x83cccc4f, 0x6834345c, 0x51a5a5f4, 0xd1e5e534, 0xf9f1f108, 0xe2717193, 0xabd8d873, 0x62313153, 0x2a15153f, 0x0804040c, 0x95c7c752, 0x46232365, 0x9dc3c35e, 0x30181828, 0x379696a1, 0x0a05050f, 0x2f9a9ab5, 0x0e070709, 0x24121236, 0x1b80809b, 0xdfe2e23d, 0xcdebeb26, 0x4e272769, 0x7fb2b2cd, 0xea75759f, 0x1209091b, 0x1d83839e, 0x582c2c74, 0x341a1a2e, 0x361b1b2d, 0xdc6e6eb2, 0xb45a5aee, 0x5ba0a0fb, 0xa45252f6, 0x763b3b4d, 0xb7d6d661, 0x7db3b3ce, 0x5229297b, 0xdde3e33e, 0x5e2f2f71, 0x13848497, 0xa65353f5, 0xb9d1d168, 0x00000000, 0xc1eded2c, 0x40202060, 0xe3fcfc1f, 0x79b1b1c8, 0xb65b5bed, 0xd46a6abe, 0x8dcbcb46, 0x67bebed9, 0x7239394b, 0x944a4ade, 0x984c4cd4, 0xb05858e8, 0x85cfcf4a, 0xbbd0d06b, 0xc5efef2a, 0x4faaaae5, 0xedfbfb16, 0x864343c5, 0x9a4d4dd7, 0x66333355, 0x11858594, 0x8a4545cf, 0xe9f9f910, 0x04020206, 0xfe7f7f81, 0xa05050f0, 0x783c3c44, 0x259f9fba, 0x4ba8a8e3, 0xa25151f3, 0x5da3a3fe, 0x804040c0, 0x058f8f8a, 0x3f9292ad, 0x219d9dbc, 0x70383848, 0xf1f5f504, 0x63bcbcdf, 0x77b6b6c1, 0xafdada75, 0x42212163, 0x20101030, 0xe5ffff1a, 0xfdf3f30e, 0xbfd2d26d, 0x81cdcd4c, 0x180c0c14, 0x26131335, 0xc3ecec2f, 0xbe5f5fe1, 0x359797a2, 0x884444cc, 0x2e171739, 0x93c4c457, 0x55a7a7f2, 0xfc7e7e82, 0x7a3d3d47, 0xc86464ac, 0xba5d5de7, 0x3219192b, 0xe6737395, 0xc06060a0, 0x19818198, 0x9e4f4fd1, 0xa3dcdc7f, 0x44222266, 0x542a2a7e, 0x3b9090ab, 0x0b888883, 0x8c4646ca, 0xc7eeee29, 0x6bb8b8d3, 0x2814143c, 0xa7dede79, 0xbc5e5ee2, 0x160b0b1d, 0xaddbdb76, 0xdbe0e03b, 0x64323256, 0x743a3a4e, 0x140a0a1e, 0x924949db, 0x0c06060a, 0x4824246c, 0xb85c5ce4, 0x9fc2c25d, 0xbdd3d36e, 0x43acacef, 0xc46262a6, 0x399191a8, 0x319595a4, 0xd3e4e437, 0xf279798b, 0xd5e7e732, 0x8bc8c843, 0x6e373759, 0xda6d6db7, 0x018d8d8c, 0xb1d5d564, 0x9c4e4ed2, 0x49a9a9e0, 0xd86c6cb4, 0xac5656fa, 0xf3f4f407, 0xcfeaea25, 0xca6565af, 0xf47a7a8e, 0x47aeaee9, 0x10080818, 0x6fbabad5, 0xf0787888, 0x4a25256f, 0x5c2e2e72, 0x381c1c24, 0x57a6a6f1, 0x73b4b4c7, 0x97c6c651, 0xcbe8e823, 0xa1dddd7c, 0xe874749c, 0x3e1f1f21, 0x964b4bdd, 0x61bdbddc, 0x0d8b8b86, 0x0f8a8a85, 0xe0707090, 0x7c3e3e42, 0x71b5b5c4, 0xcc6666aa, 0x904848d8, 0x06030305, 0xf7f6f601, 0x1c0e0e12, 0xc26161a3, 0x6a35355f, 0xae5757f9, 0x69b9b9d0, 0x17868691, 0x99c1c158, 0x3a1d1d27, 0x279e9eb9, 0xd9e1e138, 0xebf8f813, 0x2b9898b3, 0x22111133, 0xd26969bb, 0xa9d9d970, 0x078e8e89, 0x339494a7, 0x2d9b9bb6, 0x3c1e1e22, 0x15878792, 0xc9e9e920, 0x87cece49, 0xaa5555ff, 0x50282878, 0xa5dfdf7a, 0x038c8c8f, 0x59a1a1f8, 0x09898980, 0x1a0d0d17, 0x65bfbfda, 0xd7e6e631, 0x844242c6, 0xd06868b8, 0x824141c3, 0x299999b0, 0x5a2d2d77, 0x1e0f0f11, 0x7bb0b0cb, 0xa85454fc, 0x6dbbbbd6, 0x2c16163a];\n    var T2 = [0xa5c66363, 0x84f87c7c, 0x99ee7777, 0x8df67b7b, 0x0dfff2f2, 0xbdd66b6b, 0xb1de6f6f, 0x5491c5c5, 0x50603030, 0x03020101, 0xa9ce6767, 0x7d562b2b, 0x19e7fefe, 0x62b5d7d7, 0xe64dabab, 0x9aec7676, 0x458fcaca, 0x9d1f8282, 0x4089c9c9, 0x87fa7d7d, 0x15effafa, 0xebb25959, 0xc98e4747, 0x0bfbf0f0, 0xec41adad, 0x67b3d4d4, 0xfd5fa2a2, 0xea45afaf, 0xbf239c9c, 0xf753a4a4, 0x96e47272, 0x5b9bc0c0, 0xc275b7b7, 0x1ce1fdfd, 0xae3d9393, 0x6a4c2626, 0x5a6c3636, 0x417e3f3f, 0x02f5f7f7, 0x4f83cccc, 0x5c683434, 0xf451a5a5, 0x34d1e5e5, 0x08f9f1f1, 0x93e27171, 0x73abd8d8, 0x53623131, 0x3f2a1515, 0x0c080404, 0x5295c7c7, 0x65462323, 0x5e9dc3c3, 0x28301818, 0xa1379696, 0x0f0a0505, 0xb52f9a9a, 0x090e0707, 0x36241212, 0x9b1b8080, 0x3ddfe2e2, 0x26cdebeb, 0x694e2727, 0xcd7fb2b2, 0x9fea7575, 0x1b120909, 0x9e1d8383, 0x74582c2c, 0x2e341a1a, 0x2d361b1b, 0xb2dc6e6e, 0xeeb45a5a, 0xfb5ba0a0, 0xf6a45252, 0x4d763b3b, 0x61b7d6d6, 0xce7db3b3, 0x7b522929, 0x3edde3e3, 0x715e2f2f, 0x97138484, 0xf5a65353, 0x68b9d1d1, 0x00000000, 0x2cc1eded, 0x60402020, 0x1fe3fcfc, 0xc879b1b1, 0xedb65b5b, 0xbed46a6a, 0x468dcbcb, 0xd967bebe, 0x4b723939, 0xde944a4a, 0xd4984c4c, 0xe8b05858, 0x4a85cfcf, 0x6bbbd0d0, 0x2ac5efef, 0xe54faaaa, 0x16edfbfb, 0xc5864343, 0xd79a4d4d, 0x55663333, 0x94118585, 0xcf8a4545, 0x10e9f9f9, 0x06040202, 0x81fe7f7f, 0xf0a05050, 0x44783c3c, 0xba259f9f, 0xe34ba8a8, 0xf3a25151, 0xfe5da3a3, 0xc0804040, 0x8a058f8f, 0xad3f9292, 0xbc219d9d, 0x48703838, 0x04f1f5f5, 0xdf63bcbc, 0xc177b6b6, 0x75afdada, 0x63422121, 0x30201010, 0x1ae5ffff, 0x0efdf3f3, 0x6dbfd2d2, 0x4c81cdcd, 0x14180c0c, 0x35261313, 0x2fc3ecec, 0xe1be5f5f, 0xa2359797, 0xcc884444, 0x392e1717, 0x5793c4c4, 0xf255a7a7, 0x82fc7e7e, 0x477a3d3d, 0xacc86464, 0xe7ba5d5d, 0x2b321919, 0x95e67373, 0xa0c06060, 0x98198181, 0xd19e4f4f, 0x7fa3dcdc, 0x66442222, 0x7e542a2a, 0xab3b9090, 0x830b8888, 0xca8c4646, 0x29c7eeee, 0xd36bb8b8, 0x3c281414, 0x79a7dede, 0xe2bc5e5e, 0x1d160b0b, 0x76addbdb, 0x3bdbe0e0, 0x56643232, 0x4e743a3a, 0x1e140a0a, 0xdb924949, 0x0a0c0606, 0x6c482424, 0xe4b85c5c, 0x5d9fc2c2, 0x6ebdd3d3, 0xef43acac, 0xa6c46262, 0xa8399191, 0xa4319595, 0x37d3e4e4, 0x8bf27979, 0x32d5e7e7, 0x438bc8c8, 0x596e3737, 0xb7da6d6d, 0x8c018d8d, 0x64b1d5d5, 0xd29c4e4e, 0xe049a9a9, 0xb4d86c6c, 0xfaac5656, 0x07f3f4f4, 0x25cfeaea, 0xafca6565, 0x8ef47a7a, 0xe947aeae, 0x18100808, 0xd56fbaba, 0x88f07878, 0x6f4a2525, 0x725c2e2e, 0x24381c1c, 0xf157a6a6, 0xc773b4b4, 0x5197c6c6, 0x23cbe8e8, 0x7ca1dddd, 0x9ce87474, 0x213e1f1f, 0xdd964b4b, 0xdc61bdbd, 0x860d8b8b, 0x850f8a8a, 0x90e07070, 0x427c3e3e, 0xc471b5b5, 0xaacc6666, 0xd8904848, 0x05060303, 0x01f7f6f6, 0x121c0e0e, 0xa3c26161, 0x5f6a3535, 0xf9ae5757, 0xd069b9b9, 0x91178686, 0x5899c1c1, 0x273a1d1d, 0xb9279e9e, 0x38d9e1e1, 0x13ebf8f8, 0xb32b9898, 0x33221111, 0xbbd26969, 0x70a9d9d9, 0x89078e8e, 0xa7339494, 0xb62d9b9b, 0x223c1e1e, 0x92158787, 0x20c9e9e9, 0x4987cece, 0xffaa5555, 0x78502828, 0x7aa5dfdf, 0x8f038c8c, 0xf859a1a1, 0x80098989, 0x171a0d0d, 0xda65bfbf, 0x31d7e6e6, 0xc6844242, 0xb8d06868, 0xc3824141, 0xb0299999, 0x775a2d2d, 0x111e0f0f, 0xcb7bb0b0, 0xfca85454, 0xd66dbbbb, 0x3a2c1616];\n    var T3 = [0x63a5c663, 0x7c84f87c, 0x7799ee77, 0x7b8df67b, 0xf20dfff2, 0x6bbdd66b, 0x6fb1de6f, 0xc55491c5, 0x30506030, 0x01030201, 0x67a9ce67, 0x2b7d562b, 0xfe19e7fe, 0xd762b5d7, 0xabe64dab, 0x769aec76, 0xca458fca, 0x829d1f82, 0xc94089c9, 0x7d87fa7d, 0xfa15effa, 0x59ebb259, 0x47c98e47, 0xf00bfbf0, 0xadec41ad, 0xd467b3d4, 0xa2fd5fa2, 0xafea45af, 0x9cbf239c, 0xa4f753a4, 0x7296e472, 0xc05b9bc0, 0xb7c275b7, 0xfd1ce1fd, 0x93ae3d93, 0x266a4c26, 0x365a6c36, 0x3f417e3f, 0xf702f5f7, 0xcc4f83cc, 0x345c6834, 0xa5f451a5, 0xe534d1e5, 0xf108f9f1, 0x7193e271, 0xd873abd8, 0x31536231, 0x153f2a15, 0x040c0804, 0xc75295c7, 0x23654623, 0xc35e9dc3, 0x18283018, 0x96a13796, 0x050f0a05, 0x9ab52f9a, 0x07090e07, 0x12362412, 0x809b1b80, 0xe23ddfe2, 0xeb26cdeb, 0x27694e27, 0xb2cd7fb2, 0x759fea75, 0x091b1209, 0x839e1d83, 0x2c74582c, 0x1a2e341a, 0x1b2d361b, 0x6eb2dc6e, 0x5aeeb45a, 0xa0fb5ba0, 0x52f6a452, 0x3b4d763b, 0xd661b7d6, 0xb3ce7db3, 0x297b5229, 0xe33edde3, 0x2f715e2f, 0x84971384, 0x53f5a653, 0xd168b9d1, 0x00000000, 0xed2cc1ed, 0x20604020, 0xfc1fe3fc, 0xb1c879b1, 0x5bedb65b, 0x6abed46a, 0xcb468dcb, 0xbed967be, 0x394b7239, 0x4ade944a, 0x4cd4984c, 0x58e8b058, 0xcf4a85cf, 0xd06bbbd0, 0xef2ac5ef, 0xaae54faa, 0xfb16edfb, 0x43c58643, 0x4dd79a4d, 0x33556633, 0x85941185, 0x45cf8a45, 0xf910e9f9, 0x02060402, 0x7f81fe7f, 0x50f0a050, 0x3c44783c, 0x9fba259f, 0xa8e34ba8, 0x51f3a251, 0xa3fe5da3, 0x40c08040, 0x8f8a058f, 0x92ad3f92, 0x9dbc219d, 0x38487038, 0xf504f1f5, 0xbcdf63bc, 0xb6c177b6, 0xda75afda, 0x21634221, 0x10302010, 0xff1ae5ff, 0xf30efdf3, 0xd26dbfd2, 0xcd4c81cd, 0x0c14180c, 0x13352613, 0xec2fc3ec, 0x5fe1be5f, 0x97a23597, 0x44cc8844, 0x17392e17, 0xc45793c4, 0xa7f255a7, 0x7e82fc7e, 0x3d477a3d, 0x64acc864, 0x5de7ba5d, 0x192b3219, 0x7395e673, 0x60a0c060, 0x81981981, 0x4fd19e4f, 0xdc7fa3dc, 0x22664422, 0x2a7e542a, 0x90ab3b90, 0x88830b88, 0x46ca8c46, 0xee29c7ee, 0xb8d36bb8, 0x143c2814, 0xde79a7de, 0x5ee2bc5e, 0x0b1d160b, 0xdb76addb, 0xe03bdbe0, 0x32566432, 0x3a4e743a, 0x0a1e140a, 0x49db9249, 0x060a0c06, 0x246c4824, 0x5ce4b85c, 0xc25d9fc2, 0xd36ebdd3, 0xacef43ac, 0x62a6c462, 0x91a83991, 0x95a43195, 0xe437d3e4, 0x798bf279, 0xe732d5e7, 0xc8438bc8, 0x37596e37, 0x6db7da6d, 0x8d8c018d, 0xd564b1d5, 0x4ed29c4e, 0xa9e049a9, 0x6cb4d86c, 0x56faac56, 0xf407f3f4, 0xea25cfea, 0x65afca65, 0x7a8ef47a, 0xaee947ae, 0x08181008, 0xbad56fba, 0x7888f078, 0x256f4a25, 0x2e725c2e, 0x1c24381c, 0xa6f157a6, 0xb4c773b4, 0xc65197c6, 0xe823cbe8, 0xdd7ca1dd, 0x749ce874, 0x1f213e1f, 0x4bdd964b, 0xbddc61bd, 0x8b860d8b, 0x8a850f8a, 0x7090e070, 0x3e427c3e, 0xb5c471b5, 0x66aacc66, 0x48d89048, 0x03050603, 0xf601f7f6, 0x0e121c0e, 0x61a3c261, 0x355f6a35, 0x57f9ae57, 0xb9d069b9, 0x86911786, 0xc15899c1, 0x1d273a1d, 0x9eb9279e, 0xe138d9e1, 0xf813ebf8, 0x98b32b98, 0x11332211, 0x69bbd269, 0xd970a9d9, 0x8e89078e, 0x94a73394, 0x9bb62d9b, 0x1e223c1e, 0x87921587, 0xe920c9e9, 0xce4987ce, 0x55ffaa55, 0x28785028, 0xdf7aa5df, 0x8c8f038c, 0xa1f859a1, 0x89800989, 0x0d171a0d, 0xbfda65bf, 0xe631d7e6, 0x42c68442, 0x68b8d068, 0x41c38241, 0x99b02999, 0x2d775a2d, 0x0f111e0f, 0xb0cb7bb0, 0x54fca854, 0xbbd66dbb, 0x163a2c16];\n    var T4 = [0x6363a5c6, 0x7c7c84f8, 0x777799ee, 0x7b7b8df6, 0xf2f20dff, 0x6b6bbdd6, 0x6f6fb1de, 0xc5c55491, 0x30305060, 0x01010302, 0x6767a9ce, 0x2b2b7d56, 0xfefe19e7, 0xd7d762b5, 0xababe64d, 0x76769aec, 0xcaca458f, 0x82829d1f, 0xc9c94089, 0x7d7d87fa, 0xfafa15ef, 0x5959ebb2, 0x4747c98e, 0xf0f00bfb, 0xadadec41, 0xd4d467b3, 0xa2a2fd5f, 0xafafea45, 0x9c9cbf23, 0xa4a4f753, 0x727296e4, 0xc0c05b9b, 0xb7b7c275, 0xfdfd1ce1, 0x9393ae3d, 0x26266a4c, 0x36365a6c, 0x3f3f417e, 0xf7f702f5, 0xcccc4f83, 0x34345c68, 0xa5a5f451, 0xe5e534d1, 0xf1f108f9, 0x717193e2, 0xd8d873ab, 0x31315362, 0x15153f2a, 0x04040c08, 0xc7c75295, 0x23236546, 0xc3c35e9d, 0x18182830, 0x9696a137, 0x05050f0a, 0x9a9ab52f, 0x0707090e, 0x12123624, 0x80809b1b, 0xe2e23ddf, 0xebeb26cd, 0x2727694e, 0xb2b2cd7f, 0x75759fea, 0x09091b12, 0x83839e1d, 0x2c2c7458, 0x1a1a2e34, 0x1b1b2d36, 0x6e6eb2dc, 0x5a5aeeb4, 0xa0a0fb5b, 0x5252f6a4, 0x3b3b4d76, 0xd6d661b7, 0xb3b3ce7d, 0x29297b52, 0xe3e33edd, 0x2f2f715e, 0x84849713, 0x5353f5a6, 0xd1d168b9, 0x00000000, 0xeded2cc1, 0x20206040, 0xfcfc1fe3, 0xb1b1c879, 0x5b5bedb6, 0x6a6abed4, 0xcbcb468d, 0xbebed967, 0x39394b72, 0x4a4ade94, 0x4c4cd498, 0x5858e8b0, 0xcfcf4a85, 0xd0d06bbb, 0xefef2ac5, 0xaaaae54f, 0xfbfb16ed, 0x4343c586, 0x4d4dd79a, 0x33335566, 0x85859411, 0x4545cf8a, 0xf9f910e9, 0x02020604, 0x7f7f81fe, 0x5050f0a0, 0x3c3c4478, 0x9f9fba25, 0xa8a8e34b, 0x5151f3a2, 0xa3a3fe5d, 0x4040c080, 0x8f8f8a05, 0x9292ad3f, 0x9d9dbc21, 0x38384870, 0xf5f504f1, 0xbcbcdf63, 0xb6b6c177, 0xdada75af, 0x21216342, 0x10103020, 0xffff1ae5, 0xf3f30efd, 0xd2d26dbf, 0xcdcd4c81, 0x0c0c1418, 0x13133526, 0xecec2fc3, 0x5f5fe1be, 0x9797a235, 0x4444cc88, 0x1717392e, 0xc4c45793, 0xa7a7f255, 0x7e7e82fc, 0x3d3d477a, 0x6464acc8, 0x5d5de7ba, 0x19192b32, 0x737395e6, 0x6060a0c0, 0x81819819, 0x4f4fd19e, 0xdcdc7fa3, 0x22226644, 0x2a2a7e54, 0x9090ab3b, 0x8888830b, 0x4646ca8c, 0xeeee29c7, 0xb8b8d36b, 0x14143c28, 0xdede79a7, 0x5e5ee2bc, 0x0b0b1d16, 0xdbdb76ad, 0xe0e03bdb, 0x32325664, 0x3a3a4e74, 0x0a0a1e14, 0x4949db92, 0x06060a0c, 0x24246c48, 0x5c5ce4b8, 0xc2c25d9f, 0xd3d36ebd, 0xacacef43, 0x6262a6c4, 0x9191a839, 0x9595a431, 0xe4e437d3, 0x79798bf2, 0xe7e732d5, 0xc8c8438b, 0x3737596e, 0x6d6db7da, 0x8d8d8c01, 0xd5d564b1, 0x4e4ed29c, 0xa9a9e049, 0x6c6cb4d8, 0x5656faac, 0xf4f407f3, 0xeaea25cf, 0x6565afca, 0x7a7a8ef4, 0xaeaee947, 0x08081810, 0xbabad56f, 0x787888f0, 0x25256f4a, 0x2e2e725c, 0x1c1c2438, 0xa6a6f157, 0xb4b4c773, 0xc6c65197, 0xe8e823cb, 0xdddd7ca1, 0x74749ce8, 0x1f1f213e, 0x4b4bdd96, 0xbdbddc61, 0x8b8b860d, 0x8a8a850f, 0x707090e0, 0x3e3e427c, 0xb5b5c471, 0x6666aacc, 0x4848d890, 0x03030506, 0xf6f601f7, 0x0e0e121c, 0x6161a3c2, 0x35355f6a, 0x5757f9ae, 0xb9b9d069, 0x86869117, 0xc1c15899, 0x1d1d273a, 0x9e9eb927, 0xe1e138d9, 0xf8f813eb, 0x9898b32b, 0x11113322, 0x6969bbd2, 0xd9d970a9, 0x8e8e8907, 0x9494a733, 0x9b9bb62d, 0x1e1e223c, 0x87879215, 0xe9e920c9, 0xcece4987, 0x5555ffaa, 0x28287850, 0xdfdf7aa5, 0x8c8c8f03, 0xa1a1f859, 0x89898009, 0x0d0d171a, 0xbfbfda65, 0xe6e631d7, 0x4242c684, 0x6868b8d0, 0x4141c382, 0x9999b029, 0x2d2d775a, 0x0f0f111e, 0xb0b0cb7b, 0x5454fca8, 0xbbbbd66d, 0x16163a2c];\n\n    // Transformations for decryption\n    var T5 = [0x51f4a750, 0x7e416553, 0x1a17a4c3, 0x3a275e96, 0x3bab6bcb, 0x1f9d45f1, 0xacfa58ab, 0x4be30393, 0x2030fa55, 0xad766df6, 0x88cc7691, 0xf5024c25, 0x4fe5d7fc, 0xc52acbd7, 0x26354480, 0xb562a38f, 0xdeb15a49, 0x25ba1b67, 0x45ea0e98, 0x5dfec0e1, 0xc32f7502, 0x814cf012, 0x8d4697a3, 0x6bd3f9c6, 0x038f5fe7, 0x15929c95, 0xbf6d7aeb, 0x955259da, 0xd4be832d, 0x587421d3, 0x49e06929, 0x8ec9c844, 0x75c2896a, 0xf48e7978, 0x99583e6b, 0x27b971dd, 0xbee14fb6, 0xf088ad17, 0xc920ac66, 0x7dce3ab4, 0x63df4a18, 0xe51a3182, 0x97513360, 0x62537f45, 0xb16477e0, 0xbb6bae84, 0xfe81a01c, 0xf9082b94, 0x70486858, 0x8f45fd19, 0x94de6c87, 0x527bf8b7, 0xab73d323, 0x724b02e2, 0xe31f8f57, 0x6655ab2a, 0xb2eb2807, 0x2fb5c203, 0x86c57b9a, 0xd33708a5, 0x302887f2, 0x23bfa5b2, 0x02036aba, 0xed16825c, 0x8acf1c2b, 0xa779b492, 0xf307f2f0, 0x4e69e2a1, 0x65daf4cd, 0x0605bed5, 0xd134621f, 0xc4a6fe8a, 0x342e539d, 0xa2f355a0, 0x058ae132, 0xa4f6eb75, 0x0b83ec39, 0x4060efaa, 0x5e719f06, 0xbd6e1051, 0x3e218af9, 0x96dd063d, 0xdd3e05ae, 0x4de6bd46, 0x91548db5, 0x71c45d05, 0x0406d46f, 0x605015ff, 0x1998fb24, 0xd6bde997, 0x894043cc, 0x67d99e77, 0xb0e842bd, 0x07898b88, 0xe7195b38, 0x79c8eedb, 0xa17c0a47, 0x7c420fe9, 0xf8841ec9, 0x00000000, 0x09808683, 0x322bed48, 0x1e1170ac, 0x6c5a724e, 0xfd0efffb, 0x0f853856, 0x3daed51e, 0x362d3927, 0x0a0fd964, 0x685ca621, 0x9b5b54d1, 0x24362e3a, 0x0c0a67b1, 0x9357e70f, 0xb4ee96d2, 0x1b9b919e, 0x80c0c54f, 0x61dc20a2, 0x5a774b69, 0x1c121a16, 0xe293ba0a, 0xc0a02ae5, 0x3c22e043, 0x121b171d, 0x0e090d0b, 0xf28bc7ad, 0x2db6a8b9, 0x141ea9c8, 0x57f11985, 0xaf75074c, 0xee99ddbb, 0xa37f60fd, 0xf701269f, 0x5c72f5bc, 0x44663bc5, 0x5bfb7e34, 0x8b432976, 0xcb23c6dc, 0xb6edfc68, 0xb8e4f163, 0xd731dcca, 0x42638510, 0x13972240, 0x84c61120, 0x854a247d, 0xd2bb3df8, 0xaef93211, 0xc729a16d, 0x1d9e2f4b, 0xdcb230f3, 0x0d8652ec, 0x77c1e3d0, 0x2bb3166c, 0xa970b999, 0x119448fa, 0x47e96422, 0xa8fc8cc4, 0xa0f03f1a, 0x567d2cd8, 0x223390ef, 0x87494ec7, 0xd938d1c1, 0x8ccaa2fe, 0x98d40b36, 0xa6f581cf, 0xa57ade28, 0xdab78e26, 0x3fadbfa4, 0x2c3a9de4, 0x5078920d, 0x6a5fcc9b, 0x547e4662, 0xf68d13c2, 0x90d8b8e8, 0x2e39f75e, 0x82c3aff5, 0x9f5d80be, 0x69d0937c, 0x6fd52da9, 0xcf2512b3, 0xc8ac993b, 0x10187da7, 0xe89c636e, 0xdb3bbb7b, 0xcd267809, 0x6e5918f4, 0xec9ab701, 0x834f9aa8, 0xe6956e65, 0xaaffe67e, 0x21bccf08, 0xef15e8e6, 0xbae79bd9, 0x4a6f36ce, 0xea9f09d4, 0x29b07cd6, 0x31a4b2af, 0x2a3f2331, 0xc6a59430, 0x35a266c0, 0x744ebc37, 0xfc82caa6, 0xe090d0b0, 0x33a7d815, 0xf104984a, 0x41ecdaf7, 0x7fcd500e, 0x1791f62f, 0x764dd68d, 0x43efb04d, 0xccaa4d54, 0xe49604df, 0x9ed1b5e3, 0x4c6a881b, 0xc12c1fb8, 0x4665517f, 0x9d5eea04, 0x018c355d, 0xfa877473, 0xfb0b412e, 0xb3671d5a, 0x92dbd252, 0xe9105633, 0x6dd64713, 0x9ad7618c, 0x37a10c7a, 0x59f8148e, 0xeb133c89, 0xcea927ee, 0xb761c935, 0xe11ce5ed, 0x7a47b13c, 0x9cd2df59, 0x55f2733f, 0x1814ce79, 0x73c737bf, 0x53f7cdea, 0x5ffdaa5b, 0xdf3d6f14, 0x7844db86, 0xcaaff381, 0xb968c43e, 0x3824342c, 0xc2a3405f, 0x161dc372, 0xbce2250c, 0x283c498b, 0xff0d9541, 0x39a80171, 0x080cb3de, 0xd8b4e49c, 0x6456c190, 0x7bcb8461, 0xd532b670, 0x486c5c74, 0xd0b85742];\n    var T6 = [0x5051f4a7, 0x537e4165, 0xc31a17a4, 0x963a275e, 0xcb3bab6b, 0xf11f9d45, 0xabacfa58, 0x934be303, 0x552030fa, 0xf6ad766d, 0x9188cc76, 0x25f5024c, 0xfc4fe5d7, 0xd7c52acb, 0x80263544, 0x8fb562a3, 0x49deb15a, 0x6725ba1b, 0x9845ea0e, 0xe15dfec0, 0x02c32f75, 0x12814cf0, 0xa38d4697, 0xc66bd3f9, 0xe7038f5f, 0x9515929c, 0xebbf6d7a, 0xda955259, 0x2dd4be83, 0xd3587421, 0x2949e069, 0x448ec9c8, 0x6a75c289, 0x78f48e79, 0x6b99583e, 0xdd27b971, 0xb6bee14f, 0x17f088ad, 0x66c920ac, 0xb47dce3a, 0x1863df4a, 0x82e51a31, 0x60975133, 0x4562537f, 0xe0b16477, 0x84bb6bae, 0x1cfe81a0, 0x94f9082b, 0x58704868, 0x198f45fd, 0x8794de6c, 0xb7527bf8, 0x23ab73d3, 0xe2724b02, 0x57e31f8f, 0x2a6655ab, 0x07b2eb28, 0x032fb5c2, 0x9a86c57b, 0xa5d33708, 0xf2302887, 0xb223bfa5, 0xba02036a, 0x5ced1682, 0x2b8acf1c, 0x92a779b4, 0xf0f307f2, 0xa14e69e2, 0xcd65daf4, 0xd50605be, 0x1fd13462, 0x8ac4a6fe, 0x9d342e53, 0xa0a2f355, 0x32058ae1, 0x75a4f6eb, 0x390b83ec, 0xaa4060ef, 0x065e719f, 0x51bd6e10, 0xf93e218a, 0x3d96dd06, 0xaedd3e05, 0x464de6bd, 0xb591548d, 0x0571c45d, 0x6f0406d4, 0xff605015, 0x241998fb, 0x97d6bde9, 0xcc894043, 0x7767d99e, 0xbdb0e842, 0x8807898b, 0x38e7195b, 0xdb79c8ee, 0x47a17c0a, 0xe97c420f, 0xc9f8841e, 0x00000000, 0x83098086, 0x48322bed, 0xac1e1170, 0x4e6c5a72, 0xfbfd0eff, 0x560f8538, 0x1e3daed5, 0x27362d39, 0x640a0fd9, 0x21685ca6, 0xd19b5b54, 0x3a24362e, 0xb10c0a67, 0x0f9357e7, 0xd2b4ee96, 0x9e1b9b91, 0x4f80c0c5, 0xa261dc20, 0x695a774b, 0x161c121a, 0x0ae293ba, 0xe5c0a02a, 0x433c22e0, 0x1d121b17, 0x0b0e090d, 0xadf28bc7, 0xb92db6a8, 0xc8141ea9, 0x8557f119, 0x4caf7507, 0xbbee99dd, 0xfda37f60, 0x9ff70126, 0xbc5c72f5, 0xc544663b, 0x345bfb7e, 0x768b4329, 0xdccb23c6, 0x68b6edfc, 0x63b8e4f1, 0xcad731dc, 0x10426385, 0x40139722, 0x2084c611, 0x7d854a24, 0xf8d2bb3d, 0x11aef932, 0x6dc729a1, 0x4b1d9e2f, 0xf3dcb230, 0xec0d8652, 0xd077c1e3, 0x6c2bb316, 0x99a970b9, 0xfa119448, 0x2247e964, 0xc4a8fc8c, 0x1aa0f03f, 0xd8567d2c, 0xef223390, 0xc787494e, 0xc1d938d1, 0xfe8ccaa2, 0x3698d40b, 0xcfa6f581, 0x28a57ade, 0x26dab78e, 0xa43fadbf, 0xe42c3a9d, 0x0d507892, 0x9b6a5fcc, 0x62547e46, 0xc2f68d13, 0xe890d8b8, 0x5e2e39f7, 0xf582c3af, 0xbe9f5d80, 0x7c69d093, 0xa96fd52d, 0xb3cf2512, 0x3bc8ac99, 0xa710187d, 0x6ee89c63, 0x7bdb3bbb, 0x09cd2678, 0xf46e5918, 0x01ec9ab7, 0xa8834f9a, 0x65e6956e, 0x7eaaffe6, 0x0821bccf, 0xe6ef15e8, 0xd9bae79b, 0xce4a6f36, 0xd4ea9f09, 0xd629b07c, 0xaf31a4b2, 0x312a3f23, 0x30c6a594, 0xc035a266, 0x37744ebc, 0xa6fc82ca, 0xb0e090d0, 0x1533a7d8, 0x4af10498, 0xf741ecda, 0x0e7fcd50, 0x2f1791f6, 0x8d764dd6, 0x4d43efb0, 0x54ccaa4d, 0xdfe49604, 0xe39ed1b5, 0x1b4c6a88, 0xb8c12c1f, 0x7f466551, 0x049d5eea, 0x5d018c35, 0x73fa8774, 0x2efb0b41, 0x5ab3671d, 0x5292dbd2, 0x33e91056, 0x136dd647, 0x8c9ad761, 0x7a37a10c, 0x8e59f814, 0x89eb133c, 0xeecea927, 0x35b761c9, 0xede11ce5, 0x3c7a47b1, 0x599cd2df, 0x3f55f273, 0x791814ce, 0xbf73c737, 0xea53f7cd, 0x5b5ffdaa, 0x14df3d6f, 0x867844db, 0x81caaff3, 0x3eb968c4, 0x2c382434, 0x5fc2a340, 0x72161dc3, 0x0cbce225, 0x8b283c49, 0x41ff0d95, 0x7139a801, 0xde080cb3, 0x9cd8b4e4, 0x906456c1, 0x617bcb84, 0x70d532b6, 0x74486c5c, 0x42d0b857];\n    var T7 = [0xa75051f4, 0x65537e41, 0xa4c31a17, 0x5e963a27, 0x6bcb3bab, 0x45f11f9d, 0x58abacfa, 0x03934be3, 0xfa552030, 0x6df6ad76, 0x769188cc, 0x4c25f502, 0xd7fc4fe5, 0xcbd7c52a, 0x44802635, 0xa38fb562, 0x5a49deb1, 0x1b6725ba, 0x0e9845ea, 0xc0e15dfe, 0x7502c32f, 0xf012814c, 0x97a38d46, 0xf9c66bd3, 0x5fe7038f, 0x9c951592, 0x7aebbf6d, 0x59da9552, 0x832dd4be, 0x21d35874, 0x692949e0, 0xc8448ec9, 0x896a75c2, 0x7978f48e, 0x3e6b9958, 0x71dd27b9, 0x4fb6bee1, 0xad17f088, 0xac66c920, 0x3ab47dce, 0x4a1863df, 0x3182e51a, 0x33609751, 0x7f456253, 0x77e0b164, 0xae84bb6b, 0xa01cfe81, 0x2b94f908, 0x68587048, 0xfd198f45, 0x6c8794de, 0xf8b7527b, 0xd323ab73, 0x02e2724b, 0x8f57e31f, 0xab2a6655, 0x2807b2eb, 0xc2032fb5, 0x7b9a86c5, 0x08a5d337, 0x87f23028, 0xa5b223bf, 0x6aba0203, 0x825ced16, 0x1c2b8acf, 0xb492a779, 0xf2f0f307, 0xe2a14e69, 0xf4cd65da, 0xbed50605, 0x621fd134, 0xfe8ac4a6, 0x539d342e, 0x55a0a2f3, 0xe132058a, 0xeb75a4f6, 0xec390b83, 0xefaa4060, 0x9f065e71, 0x1051bd6e, 0x8af93e21, 0x063d96dd, 0x05aedd3e, 0xbd464de6, 0x8db59154, 0x5d0571c4, 0xd46f0406, 0x15ff6050, 0xfb241998, 0xe997d6bd, 0x43cc8940, 0x9e7767d9, 0x42bdb0e8, 0x8b880789, 0x5b38e719, 0xeedb79c8, 0x0a47a17c, 0x0fe97c42, 0x1ec9f884, 0x00000000, 0x86830980, 0xed48322b, 0x70ac1e11, 0x724e6c5a, 0xfffbfd0e, 0x38560f85, 0xd51e3dae, 0x3927362d, 0xd9640a0f, 0xa621685c, 0x54d19b5b, 0x2e3a2436, 0x67b10c0a, 0xe70f9357, 0x96d2b4ee, 0x919e1b9b, 0xc54f80c0, 0x20a261dc, 0x4b695a77, 0x1a161c12, 0xba0ae293, 0x2ae5c0a0, 0xe0433c22, 0x171d121b, 0x0d0b0e09, 0xc7adf28b, 0xa8b92db6, 0xa9c8141e, 0x198557f1, 0x074caf75, 0xddbbee99, 0x60fda37f, 0x269ff701, 0xf5bc5c72, 0x3bc54466, 0x7e345bfb, 0x29768b43, 0xc6dccb23, 0xfc68b6ed, 0xf163b8e4, 0xdccad731, 0x85104263, 0x22401397, 0x112084c6, 0x247d854a, 0x3df8d2bb, 0x3211aef9, 0xa16dc729, 0x2f4b1d9e, 0x30f3dcb2, 0x52ec0d86, 0xe3d077c1, 0x166c2bb3, 0xb999a970, 0x48fa1194, 0x642247e9, 0x8cc4a8fc, 0x3f1aa0f0, 0x2cd8567d, 0x90ef2233, 0x4ec78749, 0xd1c1d938, 0xa2fe8cca, 0x0b3698d4, 0x81cfa6f5, 0xde28a57a, 0x8e26dab7, 0xbfa43fad, 0x9de42c3a, 0x920d5078, 0xcc9b6a5f, 0x4662547e, 0x13c2f68d, 0xb8e890d8, 0xf75e2e39, 0xaff582c3, 0x80be9f5d, 0x937c69d0, 0x2da96fd5, 0x12b3cf25, 0x993bc8ac, 0x7da71018, 0x636ee89c, 0xbb7bdb3b, 0x7809cd26, 0x18f46e59, 0xb701ec9a, 0x9aa8834f, 0x6e65e695, 0xe67eaaff, 0xcf0821bc, 0xe8e6ef15, 0x9bd9bae7, 0x36ce4a6f, 0x09d4ea9f, 0x7cd629b0, 0xb2af31a4, 0x23312a3f, 0x9430c6a5, 0x66c035a2, 0xbc37744e, 0xcaa6fc82, 0xd0b0e090, 0xd81533a7, 0x984af104, 0xdaf741ec, 0x500e7fcd, 0xf62f1791, 0xd68d764d, 0xb04d43ef, 0x4d54ccaa, 0x04dfe496, 0xb5e39ed1, 0x881b4c6a, 0x1fb8c12c, 0x517f4665, 0xea049d5e, 0x355d018c, 0x7473fa87, 0x412efb0b, 0x1d5ab367, 0xd25292db, 0x5633e910, 0x47136dd6, 0x618c9ad7, 0x0c7a37a1, 0x148e59f8, 0x3c89eb13, 0x27eecea9, 0xc935b761, 0xe5ede11c, 0xb13c7a47, 0xdf599cd2, 0x733f55f2, 0xce791814, 0x37bf73c7, 0xcdea53f7, 0xaa5b5ffd, 0x6f14df3d, 0xdb867844, 0xf381caaf, 0xc43eb968, 0x342c3824, 0x405fc2a3, 0xc372161d, 0x250cbce2, 0x498b283c, 0x9541ff0d, 0x017139a8, 0xb3de080c, 0xe49cd8b4, 0xc1906456, 0x84617bcb, 0xb670d532, 0x5c74486c, 0x5742d0b8];\n    var T8 = [0xf4a75051, 0x4165537e, 0x17a4c31a, 0x275e963a, 0xab6bcb3b, 0x9d45f11f, 0xfa58abac, 0xe303934b, 0x30fa5520, 0x766df6ad, 0xcc769188, 0x024c25f5, 0xe5d7fc4f, 0x2acbd7c5, 0x35448026, 0x62a38fb5, 0xb15a49de, 0xba1b6725, 0xea0e9845, 0xfec0e15d, 0x2f7502c3, 0x4cf01281, 0x4697a38d, 0xd3f9c66b, 0x8f5fe703, 0x929c9515, 0x6d7aebbf, 0x5259da95, 0xbe832dd4, 0x7421d358, 0xe0692949, 0xc9c8448e, 0xc2896a75, 0x8e7978f4, 0x583e6b99, 0xb971dd27, 0xe14fb6be, 0x88ad17f0, 0x20ac66c9, 0xce3ab47d, 0xdf4a1863, 0x1a3182e5, 0x51336097, 0x537f4562, 0x6477e0b1, 0x6bae84bb, 0x81a01cfe, 0x082b94f9, 0x48685870, 0x45fd198f, 0xde6c8794, 0x7bf8b752, 0x73d323ab, 0x4b02e272, 0x1f8f57e3, 0x55ab2a66, 0xeb2807b2, 0xb5c2032f, 0xc57b9a86, 0x3708a5d3, 0x2887f230, 0xbfa5b223, 0x036aba02, 0x16825ced, 0xcf1c2b8a, 0x79b492a7, 0x07f2f0f3, 0x69e2a14e, 0xdaf4cd65, 0x05bed506, 0x34621fd1, 0xa6fe8ac4, 0x2e539d34, 0xf355a0a2, 0x8ae13205, 0xf6eb75a4, 0x83ec390b, 0x60efaa40, 0x719f065e, 0x6e1051bd, 0x218af93e, 0xdd063d96, 0x3e05aedd, 0xe6bd464d, 0x548db591, 0xc45d0571, 0x06d46f04, 0x5015ff60, 0x98fb2419, 0xbde997d6, 0x4043cc89, 0xd99e7767, 0xe842bdb0, 0x898b8807, 0x195b38e7, 0xc8eedb79, 0x7c0a47a1, 0x420fe97c, 0x841ec9f8, 0x00000000, 0x80868309, 0x2bed4832, 0x1170ac1e, 0x5a724e6c, 0x0efffbfd, 0x8538560f, 0xaed51e3d, 0x2d392736, 0x0fd9640a, 0x5ca62168, 0x5b54d19b, 0x362e3a24, 0x0a67b10c, 0x57e70f93, 0xee96d2b4, 0x9b919e1b, 0xc0c54f80, 0xdc20a261, 0x774b695a, 0x121a161c, 0x93ba0ae2, 0xa02ae5c0, 0x22e0433c, 0x1b171d12, 0x090d0b0e, 0x8bc7adf2, 0xb6a8b92d, 0x1ea9c814, 0xf1198557, 0x75074caf, 0x99ddbbee, 0x7f60fda3, 0x01269ff7, 0x72f5bc5c, 0x663bc544, 0xfb7e345b, 0x4329768b, 0x23c6dccb, 0xedfc68b6, 0xe4f163b8, 0x31dccad7, 0x63851042, 0x97224013, 0xc6112084, 0x4a247d85, 0xbb3df8d2, 0xf93211ae, 0x29a16dc7, 0x9e2f4b1d, 0xb230f3dc, 0x8652ec0d, 0xc1e3d077, 0xb3166c2b, 0x70b999a9, 0x9448fa11, 0xe9642247, 0xfc8cc4a8, 0xf03f1aa0, 0x7d2cd856, 0x3390ef22, 0x494ec787, 0x38d1c1d9, 0xcaa2fe8c, 0xd40b3698, 0xf581cfa6, 0x7ade28a5, 0xb78e26da, 0xadbfa43f, 0x3a9de42c, 0x78920d50, 0x5fcc9b6a, 0x7e466254, 0x8d13c2f6, 0xd8b8e890, 0x39f75e2e, 0xc3aff582, 0x5d80be9f, 0xd0937c69, 0xd52da96f, 0x2512b3cf, 0xac993bc8, 0x187da710, 0x9c636ee8, 0x3bbb7bdb, 0x267809cd, 0x5918f46e, 0x9ab701ec, 0x4f9aa883, 0x956e65e6, 0xffe67eaa, 0xbccf0821, 0x15e8e6ef, 0xe79bd9ba, 0x6f36ce4a, 0x9f09d4ea, 0xb07cd629, 0xa4b2af31, 0x3f23312a, 0xa59430c6, 0xa266c035, 0x4ebc3774, 0x82caa6fc, 0x90d0b0e0, 0xa7d81533, 0x04984af1, 0xecdaf741, 0xcd500e7f, 0x91f62f17, 0x4dd68d76, 0xefb04d43, 0xaa4d54cc, 0x9604dfe4, 0xd1b5e39e, 0x6a881b4c, 0x2c1fb8c1, 0x65517f46, 0x5eea049d, 0x8c355d01, 0x877473fa, 0x0b412efb, 0x671d5ab3, 0xdbd25292, 0x105633e9, 0xd647136d, 0xd7618c9a, 0xa10c7a37, 0xf8148e59, 0x133c89eb, 0xa927eece, 0x61c935b7, 0x1ce5ede1, 0x47b13c7a, 0xd2df599c, 0xf2733f55, 0x14ce7918, 0xc737bf73, 0xf7cdea53, 0xfdaa5b5f, 0x3d6f14df, 0x44db8678, 0xaff381ca, 0x68c43eb9, 0x24342c38, 0xa3405fc2, 0x1dc37216, 0xe2250cbc, 0x3c498b28, 0x0d9541ff, 0xa8017139, 0x0cb3de08, 0xb4e49cd8, 0x56c19064, 0xcb84617b, 0x32b670d5, 0x6c5c7448, 0xb85742d0];\n\n    // Transformations for decryption key expansion\n    var U1 = [0x00000000, 0x0e090d0b, 0x1c121a16, 0x121b171d, 0x3824342c, 0x362d3927, 0x24362e3a, 0x2a3f2331, 0x70486858, 0x7e416553, 0x6c5a724e, 0x62537f45, 0x486c5c74, 0x4665517f, 0x547e4662, 0x5a774b69, 0xe090d0b0, 0xee99ddbb, 0xfc82caa6, 0xf28bc7ad, 0xd8b4e49c, 0xd6bde997, 0xc4a6fe8a, 0xcaaff381, 0x90d8b8e8, 0x9ed1b5e3, 0x8ccaa2fe, 0x82c3aff5, 0xa8fc8cc4, 0xa6f581cf, 0xb4ee96d2, 0xbae79bd9, 0xdb3bbb7b, 0xd532b670, 0xc729a16d, 0xc920ac66, 0xe31f8f57, 0xed16825c, 0xff0d9541, 0xf104984a, 0xab73d323, 0xa57ade28, 0xb761c935, 0xb968c43e, 0x9357e70f, 0x9d5eea04, 0x8f45fd19, 0x814cf012, 0x3bab6bcb, 0x35a266c0, 0x27b971dd, 0x29b07cd6, 0x038f5fe7, 0x0d8652ec, 0x1f9d45f1, 0x119448fa, 0x4be30393, 0x45ea0e98, 0x57f11985, 0x59f8148e, 0x73c737bf, 0x7dce3ab4, 0x6fd52da9, 0x61dc20a2, 0xad766df6, 0xa37f60fd, 0xb16477e0, 0xbf6d7aeb, 0x955259da, 0x9b5b54d1, 0x894043cc, 0x87494ec7, 0xdd3e05ae, 0xd33708a5, 0xc12c1fb8, 0xcf2512b3, 0xe51a3182, 0xeb133c89, 0xf9082b94, 0xf701269f, 0x4de6bd46, 0x43efb04d, 0x51f4a750, 0x5ffdaa5b, 0x75c2896a, 0x7bcb8461, 0x69d0937c, 0x67d99e77, 0x3daed51e, 0x33a7d815, 0x21bccf08, 0x2fb5c203, 0x058ae132, 0x0b83ec39, 0x1998fb24, 0x1791f62f, 0x764dd68d, 0x7844db86, 0x6a5fcc9b, 0x6456c190, 0x4e69e2a1, 0x4060efaa, 0x527bf8b7, 0x5c72f5bc, 0x0605bed5, 0x080cb3de, 0x1a17a4c3, 0x141ea9c8, 0x3e218af9, 0x302887f2, 0x223390ef, 0x2c3a9de4, 0x96dd063d, 0x98d40b36, 0x8acf1c2b, 0x84c61120, 0xaef93211, 0xa0f03f1a, 0xb2eb2807, 0xbce2250c, 0xe6956e65, 0xe89c636e, 0xfa877473, 0xf48e7978, 0xdeb15a49, 0xd0b85742, 0xc2a3405f, 0xccaa4d54, 0x41ecdaf7, 0x4fe5d7fc, 0x5dfec0e1, 0x53f7cdea, 0x79c8eedb, 0x77c1e3d0, 0x65daf4cd, 0x6bd3f9c6, 0x31a4b2af, 0x3fadbfa4, 0x2db6a8b9, 0x23bfa5b2, 0x09808683, 0x07898b88, 0x15929c95, 0x1b9b919e, 0xa17c0a47, 0xaf75074c, 0xbd6e1051, 0xb3671d5a, 0x99583e6b, 0x97513360, 0x854a247d, 0x8b432976, 0xd134621f, 0xdf3d6f14, 0xcd267809, 0xc32f7502, 0xe9105633, 0xe7195b38, 0xf5024c25, 0xfb0b412e, 0x9ad7618c, 0x94de6c87, 0x86c57b9a, 0x88cc7691, 0xa2f355a0, 0xacfa58ab, 0xbee14fb6, 0xb0e842bd, 0xea9f09d4, 0xe49604df, 0xf68d13c2, 0xf8841ec9, 0xd2bb3df8, 0xdcb230f3, 0xcea927ee, 0xc0a02ae5, 0x7a47b13c, 0x744ebc37, 0x6655ab2a, 0x685ca621, 0x42638510, 0x4c6a881b, 0x5e719f06, 0x5078920d, 0x0a0fd964, 0x0406d46f, 0x161dc372, 0x1814ce79, 0x322bed48, 0x3c22e043, 0x2e39f75e, 0x2030fa55, 0xec9ab701, 0xe293ba0a, 0xf088ad17, 0xfe81a01c, 0xd4be832d, 0xdab78e26, 0xc8ac993b, 0xc6a59430, 0x9cd2df59, 0x92dbd252, 0x80c0c54f, 0x8ec9c844, 0xa4f6eb75, 0xaaffe67e, 0xb8e4f163, 0xb6edfc68, 0x0c0a67b1, 0x02036aba, 0x10187da7, 0x1e1170ac, 0x342e539d, 0x3a275e96, 0x283c498b, 0x26354480, 0x7c420fe9, 0x724b02e2, 0x605015ff, 0x6e5918f4, 0x44663bc5, 0x4a6f36ce, 0x587421d3, 0x567d2cd8, 0x37a10c7a, 0x39a80171, 0x2bb3166c, 0x25ba1b67, 0x0f853856, 0x018c355d, 0x13972240, 0x1d9e2f4b, 0x47e96422, 0x49e06929, 0x5bfb7e34, 0x55f2733f, 0x7fcd500e, 0x71c45d05, 0x63df4a18, 0x6dd64713, 0xd731dcca, 0xd938d1c1, 0xcb23c6dc, 0xc52acbd7, 0xef15e8e6, 0xe11ce5ed, 0xf307f2f0, 0xfd0efffb, 0xa779b492, 0xa970b999, 0xbb6bae84, 0xb562a38f, 0x9f5d80be, 0x91548db5, 0x834f9aa8, 0x8d4697a3];\n    var U2 = [0x00000000, 0x0b0e090d, 0x161c121a, 0x1d121b17, 0x2c382434, 0x27362d39, 0x3a24362e, 0x312a3f23, 0x58704868, 0x537e4165, 0x4e6c5a72, 0x4562537f, 0x74486c5c, 0x7f466551, 0x62547e46, 0x695a774b, 0xb0e090d0, 0xbbee99dd, 0xa6fc82ca, 0xadf28bc7, 0x9cd8b4e4, 0x97d6bde9, 0x8ac4a6fe, 0x81caaff3, 0xe890d8b8, 0xe39ed1b5, 0xfe8ccaa2, 0xf582c3af, 0xc4a8fc8c, 0xcfa6f581, 0xd2b4ee96, 0xd9bae79b, 0x7bdb3bbb, 0x70d532b6, 0x6dc729a1, 0x66c920ac, 0x57e31f8f, 0x5ced1682, 0x41ff0d95, 0x4af10498, 0x23ab73d3, 0x28a57ade, 0x35b761c9, 0x3eb968c4, 0x0f9357e7, 0x049d5eea, 0x198f45fd, 0x12814cf0, 0xcb3bab6b, 0xc035a266, 0xdd27b971, 0xd629b07c, 0xe7038f5f, 0xec0d8652, 0xf11f9d45, 0xfa119448, 0x934be303, 0x9845ea0e, 0x8557f119, 0x8e59f814, 0xbf73c737, 0xb47dce3a, 0xa96fd52d, 0xa261dc20, 0xf6ad766d, 0xfda37f60, 0xe0b16477, 0xebbf6d7a, 0xda955259, 0xd19b5b54, 0xcc894043, 0xc787494e, 0xaedd3e05, 0xa5d33708, 0xb8c12c1f, 0xb3cf2512, 0x82e51a31, 0x89eb133c, 0x94f9082b, 0x9ff70126, 0x464de6bd, 0x4d43efb0, 0x5051f4a7, 0x5b5ffdaa, 0x6a75c289, 0x617bcb84, 0x7c69d093, 0x7767d99e, 0x1e3daed5, 0x1533a7d8, 0x0821bccf, 0x032fb5c2, 0x32058ae1, 0x390b83ec, 0x241998fb, 0x2f1791f6, 0x8d764dd6, 0x867844db, 0x9b6a5fcc, 0x906456c1, 0xa14e69e2, 0xaa4060ef, 0xb7527bf8, 0xbc5c72f5, 0xd50605be, 0xde080cb3, 0xc31a17a4, 0xc8141ea9, 0xf93e218a, 0xf2302887, 0xef223390, 0xe42c3a9d, 0x3d96dd06, 0x3698d40b, 0x2b8acf1c, 0x2084c611, 0x11aef932, 0x1aa0f03f, 0x07b2eb28, 0x0cbce225, 0x65e6956e, 0x6ee89c63, 0x73fa8774, 0x78f48e79, 0x49deb15a, 0x42d0b857, 0x5fc2a340, 0x54ccaa4d, 0xf741ecda, 0xfc4fe5d7, 0xe15dfec0, 0xea53f7cd, 0xdb79c8ee, 0xd077c1e3, 0xcd65daf4, 0xc66bd3f9, 0xaf31a4b2, 0xa43fadbf, 0xb92db6a8, 0xb223bfa5, 0x83098086, 0x8807898b, 0x9515929c, 0x9e1b9b91, 0x47a17c0a, 0x4caf7507, 0x51bd6e10, 0x5ab3671d, 0x6b99583e, 0x60975133, 0x7d854a24, 0x768b4329, 0x1fd13462, 0x14df3d6f, 0x09cd2678, 0x02c32f75, 0x33e91056, 0x38e7195b, 0x25f5024c, 0x2efb0b41, 0x8c9ad761, 0x8794de6c, 0x9a86c57b, 0x9188cc76, 0xa0a2f355, 0xabacfa58, 0xb6bee14f, 0xbdb0e842, 0xd4ea9f09, 0xdfe49604, 0xc2f68d13, 0xc9f8841e, 0xf8d2bb3d, 0xf3dcb230, 0xeecea927, 0xe5c0a02a, 0x3c7a47b1, 0x37744ebc, 0x2a6655ab, 0x21685ca6, 0x10426385, 0x1b4c6a88, 0x065e719f, 0x0d507892, 0x640a0fd9, 0x6f0406d4, 0x72161dc3, 0x791814ce, 0x48322bed, 0x433c22e0, 0x5e2e39f7, 0x552030fa, 0x01ec9ab7, 0x0ae293ba, 0x17f088ad, 0x1cfe81a0, 0x2dd4be83, 0x26dab78e, 0x3bc8ac99, 0x30c6a594, 0x599cd2df, 0x5292dbd2, 0x4f80c0c5, 0x448ec9c8, 0x75a4f6eb, 0x7eaaffe6, 0x63b8e4f1, 0x68b6edfc, 0xb10c0a67, 0xba02036a, 0xa710187d, 0xac1e1170, 0x9d342e53, 0x963a275e, 0x8b283c49, 0x80263544, 0xe97c420f, 0xe2724b02, 0xff605015, 0xf46e5918, 0xc544663b, 0xce4a6f36, 0xd3587421, 0xd8567d2c, 0x7a37a10c, 0x7139a801, 0x6c2bb316, 0x6725ba1b, 0x560f8538, 0x5d018c35, 0x40139722, 0x4b1d9e2f, 0x2247e964, 0x2949e069, 0x345bfb7e, 0x3f55f273, 0x0e7fcd50, 0x0571c45d, 0x1863df4a, 0x136dd647, 0xcad731dc, 0xc1d938d1, 0xdccb23c6, 0xd7c52acb, 0xe6ef15e8, 0xede11ce5, 0xf0f307f2, 0xfbfd0eff, 0x92a779b4, 0x99a970b9, 0x84bb6bae, 0x8fb562a3, 0xbe9f5d80, 0xb591548d, 0xa8834f9a, 0xa38d4697];\n    var U3 = [0x00000000, 0x0d0b0e09, 0x1a161c12, 0x171d121b, 0x342c3824, 0x3927362d, 0x2e3a2436, 0x23312a3f, 0x68587048, 0x65537e41, 0x724e6c5a, 0x7f456253, 0x5c74486c, 0x517f4665, 0x4662547e, 0x4b695a77, 0xd0b0e090, 0xddbbee99, 0xcaa6fc82, 0xc7adf28b, 0xe49cd8b4, 0xe997d6bd, 0xfe8ac4a6, 0xf381caaf, 0xb8e890d8, 0xb5e39ed1, 0xa2fe8cca, 0xaff582c3, 0x8cc4a8fc, 0x81cfa6f5, 0x96d2b4ee, 0x9bd9bae7, 0xbb7bdb3b, 0xb670d532, 0xa16dc729, 0xac66c920, 0x8f57e31f, 0x825ced16, 0x9541ff0d, 0x984af104, 0xd323ab73, 0xde28a57a, 0xc935b761, 0xc43eb968, 0xe70f9357, 0xea049d5e, 0xfd198f45, 0xf012814c, 0x6bcb3bab, 0x66c035a2, 0x71dd27b9, 0x7cd629b0, 0x5fe7038f, 0x52ec0d86, 0x45f11f9d, 0x48fa1194, 0x03934be3, 0x0e9845ea, 0x198557f1, 0x148e59f8, 0x37bf73c7, 0x3ab47dce, 0x2da96fd5, 0x20a261dc, 0x6df6ad76, 0x60fda37f, 0x77e0b164, 0x7aebbf6d, 0x59da9552, 0x54d19b5b, 0x43cc8940, 0x4ec78749, 0x05aedd3e, 0x08a5d337, 0x1fb8c12c, 0x12b3cf25, 0x3182e51a, 0x3c89eb13, 0x2b94f908, 0x269ff701, 0xbd464de6, 0xb04d43ef, 0xa75051f4, 0xaa5b5ffd, 0x896a75c2, 0x84617bcb, 0x937c69d0, 0x9e7767d9, 0xd51e3dae, 0xd81533a7, 0xcf0821bc, 0xc2032fb5, 0xe132058a, 0xec390b83, 0xfb241998, 0xf62f1791, 0xd68d764d, 0xdb867844, 0xcc9b6a5f, 0xc1906456, 0xe2a14e69, 0xefaa4060, 0xf8b7527b, 0xf5bc5c72, 0xbed50605, 0xb3de080c, 0xa4c31a17, 0xa9c8141e, 0x8af93e21, 0x87f23028, 0x90ef2233, 0x9de42c3a, 0x063d96dd, 0x0b3698d4, 0x1c2b8acf, 0x112084c6, 0x3211aef9, 0x3f1aa0f0, 0x2807b2eb, 0x250cbce2, 0x6e65e695, 0x636ee89c, 0x7473fa87, 0x7978f48e, 0x5a49deb1, 0x5742d0b8, 0x405fc2a3, 0x4d54ccaa, 0xdaf741ec, 0xd7fc4fe5, 0xc0e15dfe, 0xcdea53f7, 0xeedb79c8, 0xe3d077c1, 0xf4cd65da, 0xf9c66bd3, 0xb2af31a4, 0xbfa43fad, 0xa8b92db6, 0xa5b223bf, 0x86830980, 0x8b880789, 0x9c951592, 0x919e1b9b, 0x0a47a17c, 0x074caf75, 0x1051bd6e, 0x1d5ab367, 0x3e6b9958, 0x33609751, 0x247d854a, 0x29768b43, 0x621fd134, 0x6f14df3d, 0x7809cd26, 0x7502c32f, 0x5633e910, 0x5b38e719, 0x4c25f502, 0x412efb0b, 0x618c9ad7, 0x6c8794de, 0x7b9a86c5, 0x769188cc, 0x55a0a2f3, 0x58abacfa, 0x4fb6bee1, 0x42bdb0e8, 0x09d4ea9f, 0x04dfe496, 0x13c2f68d, 0x1ec9f884, 0x3df8d2bb, 0x30f3dcb2, 0x27eecea9, 0x2ae5c0a0, 0xb13c7a47, 0xbc37744e, 0xab2a6655, 0xa621685c, 0x85104263, 0x881b4c6a, 0x9f065e71, 0x920d5078, 0xd9640a0f, 0xd46f0406, 0xc372161d, 0xce791814, 0xed48322b, 0xe0433c22, 0xf75e2e39, 0xfa552030, 0xb701ec9a, 0xba0ae293, 0xad17f088, 0xa01cfe81, 0x832dd4be, 0x8e26dab7, 0x993bc8ac, 0x9430c6a5, 0xdf599cd2, 0xd25292db, 0xc54f80c0, 0xc8448ec9, 0xeb75a4f6, 0xe67eaaff, 0xf163b8e4, 0xfc68b6ed, 0x67b10c0a, 0x6aba0203, 0x7da71018, 0x70ac1e11, 0x539d342e, 0x5e963a27, 0x498b283c, 0x44802635, 0x0fe97c42, 0x02e2724b, 0x15ff6050, 0x18f46e59, 0x3bc54466, 0x36ce4a6f, 0x21d35874, 0x2cd8567d, 0x0c7a37a1, 0x017139a8, 0x166c2bb3, 0x1b6725ba, 0x38560f85, 0x355d018c, 0x22401397, 0x2f4b1d9e, 0x642247e9, 0x692949e0, 0x7e345bfb, 0x733f55f2, 0x500e7fcd, 0x5d0571c4, 0x4a1863df, 0x47136dd6, 0xdccad731, 0xd1c1d938, 0xc6dccb23, 0xcbd7c52a, 0xe8e6ef15, 0xe5ede11c, 0xf2f0f307, 0xfffbfd0e, 0xb492a779, 0xb999a970, 0xae84bb6b, 0xa38fb562, 0x80be9f5d, 0x8db59154, 0x9aa8834f, 0x97a38d46];\n    var U4 = [0x00000000, 0x090d0b0e, 0x121a161c, 0x1b171d12, 0x24342c38, 0x2d392736, 0x362e3a24, 0x3f23312a, 0x48685870, 0x4165537e, 0x5a724e6c, 0x537f4562, 0x6c5c7448, 0x65517f46, 0x7e466254, 0x774b695a, 0x90d0b0e0, 0x99ddbbee, 0x82caa6fc, 0x8bc7adf2, 0xb4e49cd8, 0xbde997d6, 0xa6fe8ac4, 0xaff381ca, 0xd8b8e890, 0xd1b5e39e, 0xcaa2fe8c, 0xc3aff582, 0xfc8cc4a8, 0xf581cfa6, 0xee96d2b4, 0xe79bd9ba, 0x3bbb7bdb, 0x32b670d5, 0x29a16dc7, 0x20ac66c9, 0x1f8f57e3, 0x16825ced, 0x0d9541ff, 0x04984af1, 0x73d323ab, 0x7ade28a5, 0x61c935b7, 0x68c43eb9, 0x57e70f93, 0x5eea049d, 0x45fd198f, 0x4cf01281, 0xab6bcb3b, 0xa266c035, 0xb971dd27, 0xb07cd629, 0x8f5fe703, 0x8652ec0d, 0x9d45f11f, 0x9448fa11, 0xe303934b, 0xea0e9845, 0xf1198557, 0xf8148e59, 0xc737bf73, 0xce3ab47d, 0xd52da96f, 0xdc20a261, 0x766df6ad, 0x7f60fda3, 0x6477e0b1, 0x6d7aebbf, 0x5259da95, 0x5b54d19b, 0x4043cc89, 0x494ec787, 0x3e05aedd, 0x3708a5d3, 0x2c1fb8c1, 0x2512b3cf, 0x1a3182e5, 0x133c89eb, 0x082b94f9, 0x01269ff7, 0xe6bd464d, 0xefb04d43, 0xf4a75051, 0xfdaa5b5f, 0xc2896a75, 0xcb84617b, 0xd0937c69, 0xd99e7767, 0xaed51e3d, 0xa7d81533, 0xbccf0821, 0xb5c2032f, 0x8ae13205, 0x83ec390b, 0x98fb2419, 0x91f62f17, 0x4dd68d76, 0x44db8678, 0x5fcc9b6a, 0x56c19064, 0x69e2a14e, 0x60efaa40, 0x7bf8b752, 0x72f5bc5c, 0x05bed506, 0x0cb3de08, 0x17a4c31a, 0x1ea9c814, 0x218af93e, 0x2887f230, 0x3390ef22, 0x3a9de42c, 0xdd063d96, 0xd40b3698, 0xcf1c2b8a, 0xc6112084, 0xf93211ae, 0xf03f1aa0, 0xeb2807b2, 0xe2250cbc, 0x956e65e6, 0x9c636ee8, 0x877473fa, 0x8e7978f4, 0xb15a49de, 0xb85742d0, 0xa3405fc2, 0xaa4d54cc, 0xecdaf741, 0xe5d7fc4f, 0xfec0e15d, 0xf7cdea53, 0xc8eedb79, 0xc1e3d077, 0xdaf4cd65, 0xd3f9c66b, 0xa4b2af31, 0xadbfa43f, 0xb6a8b92d, 0xbfa5b223, 0x80868309, 0x898b8807, 0x929c9515, 0x9b919e1b, 0x7c0a47a1, 0x75074caf, 0x6e1051bd, 0x671d5ab3, 0x583e6b99, 0x51336097, 0x4a247d85, 0x4329768b, 0x34621fd1, 0x3d6f14df, 0x267809cd, 0x2f7502c3, 0x105633e9, 0x195b38e7, 0x024c25f5, 0x0b412efb, 0xd7618c9a, 0xde6c8794, 0xc57b9a86, 0xcc769188, 0xf355a0a2, 0xfa58abac, 0xe14fb6be, 0xe842bdb0, 0x9f09d4ea, 0x9604dfe4, 0x8d13c2f6, 0x841ec9f8, 0xbb3df8d2, 0xb230f3dc, 0xa927eece, 0xa02ae5c0, 0x47b13c7a, 0x4ebc3774, 0x55ab2a66, 0x5ca62168, 0x63851042, 0x6a881b4c, 0x719f065e, 0x78920d50, 0x0fd9640a, 0x06d46f04, 0x1dc37216, 0x14ce7918, 0x2bed4832, 0x22e0433c, 0x39f75e2e, 0x30fa5520, 0x9ab701ec, 0x93ba0ae2, 0x88ad17f0, 0x81a01cfe, 0xbe832dd4, 0xb78e26da, 0xac993bc8, 0xa59430c6, 0xd2df599c, 0xdbd25292, 0xc0c54f80, 0xc9c8448e, 0xf6eb75a4, 0xffe67eaa, 0xe4f163b8, 0xedfc68b6, 0x0a67b10c, 0x036aba02, 0x187da710, 0x1170ac1e, 0x2e539d34, 0x275e963a, 0x3c498b28, 0x35448026, 0x420fe97c, 0x4b02e272, 0x5015ff60, 0x5918f46e, 0x663bc544, 0x6f36ce4a, 0x7421d358, 0x7d2cd856, 0xa10c7a37, 0xa8017139, 0xb3166c2b, 0xba1b6725, 0x8538560f, 0x8c355d01, 0x97224013, 0x9e2f4b1d, 0xe9642247, 0xe0692949, 0xfb7e345b, 0xf2733f55, 0xcd500e7f, 0xc45d0571, 0xdf4a1863, 0xd647136d, 0x31dccad7, 0x38d1c1d9, 0x23c6dccb, 0x2acbd7c5, 0x15e8e6ef, 0x1ce5ede1, 0x07f2f0f3, 0x0efffbfd, 0x79b492a7, 0x70b999a9, 0x6bae84bb, 0x62a38fb5, 0x5d80be9f, 0x548db591, 0x4f9aa883, 0x4697a38d];\n\n    function convertToInt32(bytes) {\n        var result = [];\n        for (var i = 0; i < bytes.length; i += 4) {\n            result.push(\n                (bytes[i    ] << 24) |\n                (bytes[i + 1] << 16) |\n                (bytes[i + 2] <<  8) |\n                 bytes[i + 3]\n            );\n        }\n        return result;\n    }\n\n    var AES = function(key) {\n        if (!(this instanceof AES)) {\n            throw Error('AES must be instanitated with `new`');\n        }\n\n        Object.defineProperty(this, 'key', {\n            value: coerceArray(key, true)\n        });\n\n        this._prepare();\n    }\n\n\n    AES.prototype._prepare = function() {\n\n        var rounds = numberOfRounds[this.key.length];\n        if (rounds == null) {\n            throw new Error('invalid key size (must be 16, 24 or 32 bytes)');\n        }\n\n        // encryption round keys\n        this._Ke = [];\n\n        // decryption round keys\n        this._Kd = [];\n\n        for (var i = 0; i <= rounds; i++) {\n            this._Ke.push([0, 0, 0, 0]);\n            this._Kd.push([0, 0, 0, 0]);\n        }\n\n        var roundKeyCount = (rounds + 1) * 4;\n        var KC = this.key.length / 4;\n\n        // convert the key into ints\n        var tk = convertToInt32(this.key);\n\n        // copy values into round key arrays\n        var index;\n        for (var i = 0; i < KC; i++) {\n            index = i >> 2;\n            this._Ke[index][i % 4] = tk[i];\n            this._Kd[rounds - index][i % 4] = tk[i];\n        }\n\n        // key expansion (fips-197 section 5.2)\n        var rconpointer = 0;\n        var t = KC, tt;\n        while (t < roundKeyCount) {\n            tt = tk[KC - 1];\n            tk[0] ^= ((S[(tt >> 16) & 0xFF] << 24) ^\n                      (S[(tt >>  8) & 0xFF] << 16) ^\n                      (S[ tt        & 0xFF] <<  8) ^\n                       S[(tt >> 24) & 0xFF]        ^\n                      (rcon[rconpointer] << 24));\n            rconpointer += 1;\n\n            // key expansion (for non-256 bit)\n            if (KC != 8) {\n                for (var i = 1; i < KC; i++) {\n                    tk[i] ^= tk[i - 1];\n                }\n\n            // key expansion for 256-bit keys is \"slightly different\" (fips-197)\n            } else {\n                for (var i = 1; i < (KC / 2); i++) {\n                    tk[i] ^= tk[i - 1];\n                }\n                tt = tk[(KC / 2) - 1];\n\n                tk[KC / 2] ^= (S[ tt        & 0xFF]        ^\n                              (S[(tt >>  8) & 0xFF] <<  8) ^\n                              (S[(tt >> 16) & 0xFF] << 16) ^\n                              (S[(tt >> 24) & 0xFF] << 24));\n\n                for (var i = (KC / 2) + 1; i < KC; i++) {\n                    tk[i] ^= tk[i - 1];\n                }\n            }\n\n            // copy values into round key arrays\n            var i = 0, r, c;\n            while (i < KC && t < roundKeyCount) {\n                r = t >> 2;\n                c = t % 4;\n                this._Ke[r][c] = tk[i];\n                this._Kd[rounds - r][c] = tk[i++];\n                t++;\n            }\n        }\n\n        // inverse-cipher-ify the decryption round key (fips-197 section 5.3)\n        for (var r = 1; r < rounds; r++) {\n            for (var c = 0; c < 4; c++) {\n                tt = this._Kd[r][c];\n                this._Kd[r][c] = (U1[(tt >> 24) & 0xFF] ^\n                                  U2[(tt >> 16) & 0xFF] ^\n                                  U3[(tt >>  8) & 0xFF] ^\n                                  U4[ tt        & 0xFF]);\n            }\n        }\n    }\n\n    AES.prototype.encrypt = function(plaintext) {\n        if (plaintext.length != 16) {\n            throw new Error('invalid plaintext size (must be 16 bytes)');\n        }\n\n        var rounds = this._Ke.length - 1;\n        var a = [0, 0, 0, 0];\n\n        // convert plaintext to (ints ^ key)\n        var t = convertToInt32(plaintext);\n        for (var i = 0; i < 4; i++) {\n            t[i] ^= this._Ke[0][i];\n        }\n\n        // apply round transforms\n        for (var r = 1; r < rounds; r++) {\n            for (var i = 0; i < 4; i++) {\n                a[i] = (T1[(t[ i         ] >> 24) & 0xff] ^\n                        T2[(t[(i + 1) % 4] >> 16) & 0xff] ^\n                        T3[(t[(i + 2) % 4] >>  8) & 0xff] ^\n                        T4[ t[(i + 3) % 4]        & 0xff] ^\n                        this._Ke[r][i]);\n            }\n            t = a.slice();\n        }\n\n        // the last round is special\n        var result = createArray(16), tt;\n        for (var i = 0; i < 4; i++) {\n            tt = this._Ke[rounds][i];\n            result[4 * i    ] = (S[(t[ i         ] >> 24) & 0xff] ^ (tt >> 24)) & 0xff;\n            result[4 * i + 1] = (S[(t[(i + 1) % 4] >> 16) & 0xff] ^ (tt >> 16)) & 0xff;\n            result[4 * i + 2] = (S[(t[(i + 2) % 4] >>  8) & 0xff] ^ (tt >>  8)) & 0xff;\n            result[4 * i + 3] = (S[ t[(i + 3) % 4]        & 0xff] ^  tt       ) & 0xff;\n        }\n\n        return result;\n    }\n\n    AES.prototype.decrypt = function(ciphertext) {\n        if (ciphertext.length != 16) {\n            throw new Error('invalid ciphertext size (must be 16 bytes)');\n        }\n\n        var rounds = this._Kd.length - 1;\n        var a = [0, 0, 0, 0];\n\n        // convert plaintext to (ints ^ key)\n        var t = convertToInt32(ciphertext);\n        for (var i = 0; i < 4; i++) {\n            t[i] ^= this._Kd[0][i];\n        }\n\n        // apply round transforms\n        for (var r = 1; r < rounds; r++) {\n            for (var i = 0; i < 4; i++) {\n                a[i] = (T5[(t[ i          ] >> 24) & 0xff] ^\n                        T6[(t[(i + 3) % 4] >> 16) & 0xff] ^\n                        T7[(t[(i + 2) % 4] >>  8) & 0xff] ^\n                        T8[ t[(i + 1) % 4]        & 0xff] ^\n                        this._Kd[r][i]);\n            }\n            t = a.slice();\n        }\n\n        // the last round is special\n        var result = createArray(16), tt;\n        for (var i = 0; i < 4; i++) {\n            tt = this._Kd[rounds][i];\n            result[4 * i    ] = (Si[(t[ i         ] >> 24) & 0xff] ^ (tt >> 24)) & 0xff;\n            result[4 * i + 1] = (Si[(t[(i + 3) % 4] >> 16) & 0xff] ^ (tt >> 16)) & 0xff;\n            result[4 * i + 2] = (Si[(t[(i + 2) % 4] >>  8) & 0xff] ^ (tt >>  8)) & 0xff;\n            result[4 * i + 3] = (Si[ t[(i + 1) % 4]        & 0xff] ^  tt       ) & 0xff;\n        }\n\n        return result;\n    }\n\n\n    /**\n     *  Mode Of Operation - Electonic Codebook (ECB)\n     */\n    var ModeOfOperationECB = function(key) {\n        if (!(this instanceof ModeOfOperationECB)) {\n            throw Error('AES must be instanitated with `new`');\n        }\n\n        this.description = \"Electronic Code Block\";\n        this.name = \"ecb\";\n\n        this._aes = new AES(key);\n    }\n\n    ModeOfOperationECB.prototype.encrypt = function(plaintext) {\n        plaintext = coerceArray(plaintext);\n\n        if ((plaintext.length % 16) !== 0) {\n            throw new Error('invalid plaintext size (must be multiple of 16 bytes)');\n        }\n\n        var ciphertext = createArray(plaintext.length);\n        var block = createArray(16);\n\n        for (var i = 0; i < plaintext.length; i += 16) {\n            copyArray(plaintext, block, 0, i, i + 16);\n            block = this._aes.encrypt(block);\n            copyArray(block, ciphertext, i);\n        }\n\n        return ciphertext;\n    }\n\n    ModeOfOperationECB.prototype.decrypt = function(ciphertext) {\n        ciphertext = coerceArray(ciphertext);\n\n        if ((ciphertext.length % 16) !== 0) {\n            throw new Error('invalid ciphertext size (must be multiple of 16 bytes)');\n        }\n\n        var plaintext = createArray(ciphertext.length);\n        var block = createArray(16);\n\n        for (var i = 0; i < ciphertext.length; i += 16) {\n            copyArray(ciphertext, block, 0, i, i + 16);\n            block = this._aes.decrypt(block);\n            copyArray(block, plaintext, i);\n        }\n\n        return plaintext;\n    }\n\n\n    /**\n     *  Mode Of Operation - Cipher Block Chaining (CBC)\n     */\n    var ModeOfOperationCBC = function(key, iv) {\n        if (!(this instanceof ModeOfOperationCBC)) {\n            throw Error('AES must be instanitated with `new`');\n        }\n\n        this.description = \"Cipher Block Chaining\";\n        this.name = \"cbc\";\n\n        if (!iv) {\n            iv = createArray(16);\n\n        } else if (iv.length != 16) {\n            throw new Error('invalid initialation vector size (must be 16 bytes)');\n        }\n\n        this._lastCipherblock = coerceArray(iv, true);\n\n        this._aes = new AES(key);\n    }\n\n    ModeOfOperationCBC.prototype.encrypt = function(plaintext) {\n        plaintext = coerceArray(plaintext);\n\n        if ((plaintext.length % 16) !== 0) {\n            throw new Error('invalid plaintext size (must be multiple of 16 bytes)');\n        }\n\n        var ciphertext = createArray(plaintext.length);\n        var block = createArray(16);\n\n        for (var i = 0; i < plaintext.length; i += 16) {\n            copyArray(plaintext, block, 0, i, i + 16);\n\n            for (var j = 0; j < 16; j++) {\n                block[j] ^= this._lastCipherblock[j];\n            }\n\n            this._lastCipherblock = this._aes.encrypt(block);\n            copyArray(this._lastCipherblock, ciphertext, i);\n        }\n\n        return ciphertext;\n    }\n\n    ModeOfOperationCBC.prototype.decrypt = function(ciphertext) {\n        ciphertext = coerceArray(ciphertext);\n\n        if ((ciphertext.length % 16) !== 0) {\n            throw new Error('invalid ciphertext size (must be multiple of 16 bytes)');\n        }\n\n        var plaintext = createArray(ciphertext.length);\n        var block = createArray(16);\n\n        for (var i = 0; i < ciphertext.length; i += 16) {\n            copyArray(ciphertext, block, 0, i, i + 16);\n            block = this._aes.decrypt(block);\n\n            for (var j = 0; j < 16; j++) {\n                plaintext[i + j] = block[j] ^ this._lastCipherblock[j];\n            }\n\n            copyArray(ciphertext, this._lastCipherblock, 0, i, i + 16);\n        }\n\n        return plaintext;\n    }\n\n\n    /**\n     *  Mode Of Operation - Cipher Feedback (CFB)\n     */\n    var ModeOfOperationCFB = function(key, iv, segmentSize) {\n        if (!(this instanceof ModeOfOperationCFB)) {\n            throw Error('AES must be instanitated with `new`');\n        }\n\n        this.description = \"Cipher Feedback\";\n        this.name = \"cfb\";\n\n        if (!iv) {\n            iv = createArray(16);\n\n        } else if (iv.length != 16) {\n            throw new Error('invalid initialation vector size (must be 16 size)');\n        }\n\n        if (!segmentSize) { segmentSize = 1; }\n\n        this.segmentSize = segmentSize;\n\n        this._shiftRegister = coerceArray(iv, true);\n\n        this._aes = new AES(key);\n    }\n\n    ModeOfOperationCFB.prototype.encrypt = function(plaintext) {\n        if ((plaintext.length % this.segmentSize) != 0) {\n            throw new Error('invalid plaintext size (must be segmentSize bytes)');\n        }\n\n        var encrypted = coerceArray(plaintext, true);\n\n        var xorSegment;\n        for (var i = 0; i < encrypted.length; i += this.segmentSize) {\n            xorSegment = this._aes.encrypt(this._shiftRegister);\n            for (var j = 0; j < this.segmentSize; j++) {\n                encrypted[i + j] ^= xorSegment[j];\n            }\n\n            // Shift the register\n            copyArray(this._shiftRegister, this._shiftRegister, 0, this.segmentSize);\n            copyArray(encrypted, this._shiftRegister, 16 - this.segmentSize, i, i + this.segmentSize);\n        }\n\n        return encrypted;\n    }\n\n    ModeOfOperationCFB.prototype.decrypt = function(ciphertext) {\n        if ((ciphertext.length % this.segmentSize) != 0) {\n            throw new Error('invalid ciphertext size (must be segmentSize bytes)');\n        }\n\n        var plaintext = coerceArray(ciphertext, true);\n\n        var xorSegment;\n        for (var i = 0; i < plaintext.length; i += this.segmentSize) {\n            xorSegment = this._aes.encrypt(this._shiftRegister);\n\n            for (var j = 0; j < this.segmentSize; j++) {\n                plaintext[i + j] ^= xorSegment[j];\n            }\n\n            // Shift the register\n            copyArray(this._shiftRegister, this._shiftRegister, 0, this.segmentSize);\n            copyArray(ciphertext, this._shiftRegister, 16 - this.segmentSize, i, i + this.segmentSize);\n        }\n\n        return plaintext;\n    }\n\n    /**\n     *  Mode Of Operation - Output Feedback (OFB)\n     */\n    var ModeOfOperationOFB = function(key, iv) {\n        if (!(this instanceof ModeOfOperationOFB)) {\n            throw Error('AES must be instanitated with `new`');\n        }\n\n        this.description = \"Output Feedback\";\n        this.name = \"ofb\";\n\n        if (!iv) {\n            iv = createArray(16);\n\n        } else if (iv.length != 16) {\n            throw new Error('invalid initialation vector size (must be 16 bytes)');\n        }\n\n        this._lastPrecipher = coerceArray(iv, true);\n        this._lastPrecipherIndex = 16;\n\n        this._aes = new AES(key);\n    }\n\n    ModeOfOperationOFB.prototype.encrypt = function(plaintext) {\n        var encrypted = coerceArray(plaintext, true);\n\n        for (var i = 0; i < encrypted.length; i++) {\n            if (this._lastPrecipherIndex === 16) {\n                this._lastPrecipher = this._aes.encrypt(this._lastPrecipher);\n                this._lastPrecipherIndex = 0;\n            }\n            encrypted[i] ^= this._lastPrecipher[this._lastPrecipherIndex++];\n        }\n\n        return encrypted;\n    }\n\n    // Decryption is symetric\n    ModeOfOperationOFB.prototype.decrypt = ModeOfOperationOFB.prototype.encrypt;\n\n\n    /**\n     *  Counter object for CTR common mode of operation\n     */\n    var Counter = function(initialValue) {\n        if (!(this instanceof Counter)) {\n            throw Error('Counter must be instanitated with `new`');\n        }\n\n        // We allow 0, but anything false-ish uses the default 1\n        if (initialValue !== 0 && !initialValue) { initialValue = 1; }\n\n        if (typeof(initialValue) === 'number') {\n            this._counter = createArray(16);\n            this.setValue(initialValue);\n\n        } else {\n            this.setBytes(initialValue);\n        }\n    }\n\n    Counter.prototype.setValue = function(value) {\n        if (typeof(value) !== 'number' || parseInt(value) != value) {\n            throw new Error('invalid counter value (must be an integer)');\n        }\n\n        // We cannot safely handle numbers beyond the safe range for integers\n        if (value > Number.MAX_SAFE_INTEGER) {\n            throw new Error('integer value out of safe range');\n        }\n\n        for (var index = 15; index >= 0; --index) {\n            this._counter[index] = value % 256;\n            value = parseInt(value / 256);\n        }\n    }\n\n    Counter.prototype.setBytes = function(bytes) {\n        bytes = coerceArray(bytes, true);\n\n        if (bytes.length != 16) {\n            throw new Error('invalid counter bytes size (must be 16 bytes)');\n        }\n\n        this._counter = bytes;\n    };\n\n    Counter.prototype.increment = function() {\n        for (var i = 15; i >= 0; i--) {\n            if (this._counter[i] === 255) {\n                this._counter[i] = 0;\n            } else {\n                this._counter[i]++;\n                break;\n            }\n        }\n    }\n\n\n    /**\n     *  Mode Of Operation - Counter (CTR)\n     */\n    var ModeOfOperationCTR = function(key, counter) {\n        if (!(this instanceof ModeOfOperationCTR)) {\n            throw Error('AES must be instanitated with `new`');\n        }\n\n        this.description = \"Counter\";\n        this.name = \"ctr\";\n\n        if (!(counter instanceof Counter)) {\n            counter = new Counter(counter)\n        }\n\n        this._counter = counter;\n\n        this._remainingCounter = null;\n        this._remainingCounterIndex = 16;\n\n        this._aes = new AES(key);\n    }\n\n    ModeOfOperationCTR.prototype.encrypt = function(plaintext) {\n        var encrypted = coerceArray(plaintext, true);\n\n        for (var i = 0; i < encrypted.length; i++) {\n            if (this._remainingCounterIndex === 16) {\n                this._remainingCounter = this._aes.encrypt(this._counter._counter);\n                this._remainingCounterIndex = 0;\n                this._counter.increment();\n            }\n            encrypted[i] ^= this._remainingCounter[this._remainingCounterIndex++];\n        }\n\n        return encrypted;\n    }\n\n    // Decryption is symetric\n    ModeOfOperationCTR.prototype.decrypt = ModeOfOperationCTR.prototype.encrypt;\n\n\n    ///////////////////////\n    // Padding\n\n    // See:https://tools.ietf.org/html/rfc2315\n    function pkcs7pad(data) {\n        data = coerceArray(data, true);\n        var padder = 16 - (data.length % 16);\n        var result = createArray(data.length + padder);\n        copyArray(data, result);\n        for (var i = data.length; i < result.length; i++) {\n            result[i] = padder;\n        }\n        return result;\n    }\n\n    function pkcs7strip(data) {\n        data = coerceArray(data, true);\n        if (data.length < 16) { throw new Error('PKCS#7 invalid length'); }\n\n        var padder = data[data.length - 1];\n        if (padder > 16) { throw new Error('PKCS#7 padding byte out of range'); }\n\n        var length = data.length - padder;\n        for (var i = 0; i < padder; i++) {\n            if (data[length + i] !== padder) {\n                throw new Error('PKCS#7 invalid padding byte');\n            }\n        }\n\n        var result = createArray(length);\n        copyArray(data, result, 0, 0, length);\n        return result;\n    }\n\n    ///////////////////////\n    // Exporting\n\n\n    // The block cipher\n    var aesjs = {\n        AES: AES,\n        Counter: Counter,\n\n        ModeOfOperation: {\n            ecb: ModeOfOperationECB,\n            cbc: ModeOfOperationCBC,\n            cfb: ModeOfOperationCFB,\n            ofb: ModeOfOperationOFB,\n            ctr: ModeOfOperationCTR\n        },\n\n        utils: {\n            hex: convertHex,\n            utf8: convertUtf8\n        },\n\n        padding: {\n            pkcs7: {\n                pad: pkcs7pad,\n                strip: pkcs7strip\n            }\n        },\n\n        _arrayTest: {\n            coerceArray: coerceArray,\n            createArray: createArray,\n            copyArray: copyArray,\n        }\n    };\n\n\n    // node.js\n    if (typeof exports !== 'undefined') {\n        module.exports = aesjs\n\n    // RequireJS/AMD\n    // http://www.requirejs.org/docs/api.html\n    // https://github.com/amdjs/amdjs-api/wiki/AMD\n    } else if (typeof(define) === 'function' && define.amd) {\n        define([], function() { return aesjs; });\n\n    // Web Browsers\n    } else {\n\n        // If there was an existing library at \"aesjs\" make sure it's still available\n        if (root.aesjs) {\n            aesjs._aesjs = root.aesjs;\n        }\n\n        root.aesjs = aesjs;\n    }\n\n\n})(this);\n","/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type { HandshakeType } from \"../../handshake/const\";\nimport { getObjectSummary } from \"../../helper\";\n\nexport class FragmentedHandshake {\n  static readonly spec = {\n    msg_type: types.uint8,\n    length: types.uint24be,\n    message_seq: types.uint16be,\n    fragment_offset: types.uint24be,\n    fragment_length: types.uint24be,\n    fragment: types.buffer((context: any) => context.current.fragment_length),\n  };\n\n  constructor(\n    public msg_type: number,\n    public length: number,\n    public message_seq: number,\n    public fragment_offset: number,\n    public fragment_length: number,\n    public fragment: Buffer,\n  ) {}\n\n  get summary() {\n    return getObjectSummary(this);\n  }\n\n  static createEmpty() {\n    return new FragmentedHandshake(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new FragmentedHandshake(\n      //@ts-ignore\n      ...Object.values(decode(buf, FragmentedHandshake.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, FragmentedHandshake.spec).slice();\n    return Buffer.from(res);\n  }\n\n  chunk(maxFragmentLength?: number): FragmentedHandshake[] {\n    let start = 0;\n    const totalLength = this.fragment.length;\n\n    if (totalLength === 0)\n      return [\n        new FragmentedHandshake(\n          this.msg_type,\n          totalLength,\n          this.message_seq,\n          start,\n          0,\n          this.fragment,\n        ),\n      ];\n\n    const fragments: FragmentedHandshake[] = [];\n    if (!maxFragmentLength) {\n      maxFragmentLength = 1280 - (20 + 8) - (1 + 3 + 2 + 3 + 3);\n    }\n    // loop through the message and fragment it\n    while (start < totalLength) {\n      // calculate maximum length, limited by MTU - IP/UDP headers - handshake overhead\n      const fragmentLength = Math.min(maxFragmentLength, totalLength - start);\n      // slice and dice\n      const data = Buffer.from(\n        this.fragment.slice(start, start + fragmentLength),\n      );\n      if (data.length <= 0) {\n        // this shouldn't happen, but we don't want to introduce an infinite loop\n        throw new Error(\n          `Zero or less bytes processed while fragmenting handshake message.`,\n        );\n      }\n      // create the message\n      fragments.push(\n        new FragmentedHandshake(\n          this.msg_type,\n          totalLength,\n          this.message_seq,\n          start,\n          data.length,\n          data,\n        ),\n      );\n      // step forward by the actual fragment length\n      start += data.length;\n    }\n\n    return fragments;\n  }\n\n  static assemble(messages: FragmentedHandshake[]): FragmentedHandshake {\n    // cannot reassemble empty arrays\n    if (!messages?.length) {\n      throw new Error(\"cannot reassemble handshake from empty array\");\n    }\n\n    // sort by fragment start\n    messages = messages.sort((a, b) => a.fragment_offset - b.fragment_offset);\n    // combine into a single buffer\n    const combined = Buffer.alloc(messages[0].length);\n    for (const msg of messages) {\n      msg.fragment.copy(combined, msg.fragment_offset);\n    }\n\n    // and return the complete message\n    return new FragmentedHandshake(\n      messages[0].msg_type,\n      messages[0].length,\n      messages[0].message_seq,\n      0,\n      combined.length,\n      combined,\n    );\n  }\n\n  static findAllFragments(\n    fragments: FragmentedHandshake[],\n    type: HandshakeType,\n  ): FragmentedHandshake[] {\n    const reference = fragments.find((v) => v.msg_type === type);\n    if (!reference) return [];\n\n    // ignore empty arrays\n    if (!fragments?.length) return [];\n\n    // return all fragments with matching msg_type, message_seq and total length\n    return fragments.filter((f) => {\n      return (\n        f.msg_type === reference.msg_type &&\n        f.message_seq === reference.message_seq &&\n        f.length === reference.length\n      );\n    });\n  }\n}\n","import { random16, random32, uint16Add, uint32Add } from \"../../common/src\";\nimport { RtpHeader, RtpPacket } from \"./rtp/rtp\";\n\nexport class RtpBuilder {\n  sequenceNumber = random16();\n  timestamp = random32();\n\n  constructor(\n    private props: {\n      between: number;\n      clockRate: number;\n    },\n  ) {}\n\n  create(payload: Buffer) {\n    this.sequenceNumber = uint16Add(this.sequenceNumber, 1);\n    const elapsed = (this.props.between * this.props.clockRate) / 1000;\n    this.timestamp = uint32Add(this.timestamp, elapsed);\n\n    const header = new RtpHeader({\n      sequenceNumber: this.sequenceNumber,\n      timestamp: Number(this.timestamp),\n      payloadType: 96,\n      extension: true,\n      marker: false,\n      padding: false,\n    });\n    const rtp = new RtpPacket(header, payload);\n    return rtp;\n  }\n}\n","import { bufferReader, bufferWriter } from \"../../../../common/src\";\n\nexport class PictureLossIndication {\n  static count = 1;\n  count = PictureLossIndication.count;\n  length = 2;\n\n  senderSsrc!: number;\n  mediaSsrc!: number;\n\n  constructor(props: Partial<PictureLossIndication> = {}) {\n    Object.assign(this, props);\n  }\n\n  static deSerialize(data: Buffer) {\n    const [senderSsrc, mediaSsrc] = bufferReader(data, [4, 4]);\n    return new PictureLossIndication({ senderSsrc, mediaSsrc });\n  }\n\n  serialize() {\n    return bufferWriter([4, 4], [this.senderSsrc, this.mediaSsrc]);\n  }\n}\n","'use strict';\n\nfunction getDefaultExportFromCjs (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nconst CRC_TABLE = new Int32Array([\n  0,\n  1996959894,\n  3993919788,\n  2567524794,\n  124634137,\n  1886057615,\n  3915621685,\n  2657392035,\n  249268274,\n  2044508324,\n  3772115230,\n  2547177864,\n  162941995,\n  2125561021,\n  3887607047,\n  2428444049,\n  498536548,\n  1789927666,\n  4089016648,\n  2227061214,\n  450548861,\n  1843258603,\n  4107580753,\n  2211677639,\n  325883990,\n  1684777152,\n  4251122042,\n  2321926636,\n  335633487,\n  1661365465,\n  4195302755,\n  2366115317,\n  997073096,\n  1281953886,\n  3579855332,\n  2724688242,\n  1006888145,\n  1258607687,\n  3524101629,\n  2768942443,\n  901097722,\n  1119000684,\n  3686517206,\n  2898065728,\n  853044451,\n  1172266101,\n  3705015759,\n  2882616665,\n  651767980,\n  1373503546,\n  3369554304,\n  3218104598,\n  565507253,\n  1454621731,\n  3485111705,\n  3099436303,\n  671266974,\n  1594198024,\n  3322730930,\n  2970347812,\n  795835527,\n  1483230225,\n  3244367275,\n  3060149565,\n  1994146192,\n  31158534,\n  2563907772,\n  4023717930,\n  1907459465,\n  112637215,\n  2680153253,\n  3904427059,\n  2013776290,\n  251722036,\n  2517215374,\n  3775830040,\n  2137656763,\n  141376813,\n  2439277719,\n  3865271297,\n  1802195444,\n  476864866,\n  2238001368,\n  4066508878,\n  1812370925,\n  453092731,\n  2181625025,\n  4111451223,\n  1706088902,\n  314042704,\n  2344532202,\n  4240017532,\n  1658658271,\n  366619977,\n  2362670323,\n  4224994405,\n  1303535960,\n  984961486,\n  2747007092,\n  3569037538,\n  1256170817,\n  1037604311,\n  2765210733,\n  3554079995,\n  1131014506,\n  879679996,\n  2909243462,\n  3663771856,\n  1141124467,\n  855842277,\n  2852801631,\n  3708648649,\n  1342533948,\n  654459306,\n  3188396048,\n  3373015174,\n  1466479909,\n  544179635,\n  3110523913,\n  3462522015,\n  1591671054,\n  702138776,\n  2966460450,\n  3352799412,\n  1504918807,\n  783551873,\n  3082640443,\n  3233442989,\n  3988292384,\n  2596254646,\n  62317068,\n  1957810842,\n  3939845945,\n  2647816111,\n  81470997,\n  1943803523,\n  3814918930,\n  2489596804,\n  225274430,\n  2053790376,\n  3826175755,\n  2466906013,\n  167816743,\n  2097651377,\n  4027552580,\n  2265490386,\n  503444072,\n  1762050814,\n  4150417245,\n  2154129355,\n  426522225,\n  1852507879,\n  4275313526,\n  2312317920,\n  282753626,\n  1742555852,\n  4189708143,\n  2394877945,\n  397917763,\n  1622183637,\n  3604390888,\n  2714866558,\n  953729732,\n  1340076626,\n  3518719985,\n  2797360999,\n  1068828381,\n  1219638859,\n  3624741850,\n  2936675148,\n  906185462,\n  1090812512,\n  3747672003,\n  2825379669,\n  829329135,\n  1181335161,\n  3412177804,\n  3160834842,\n  628085408,\n  1382605366,\n  3423369109,\n  3138078467,\n  570562233,\n  1426400815,\n  3317316542,\n  2998733608,\n  733239954,\n  1555261956,\n  3268935591,\n  3050360625,\n  752459403,\n  1541320221,\n  2607071920,\n  3965973030,\n  1969922972,\n  40735498,\n  2617837225,\n  3943577151,\n  1913087877,\n  83908371,\n  2512341634,\n  3803740692,\n  2075208622,\n  213261112,\n  2463272603,\n  3855990285,\n  2094854071,\n  198958881,\n  2262029012,\n  4057260610,\n  1759359992,\n  534414190,\n  2176718541,\n  4139329115,\n  1873836001,\n  414664567,\n  2282248934,\n  4279200368,\n  1711684554,\n  285281116,\n  2405801727,\n  4167216745,\n  1634467795,\n  376229701,\n  2685067896,\n  3608007406,\n  1308918612,\n  956543938,\n  2808555105,\n  3495958263,\n  1231636301,\n  1047427035,\n  2932959818,\n  3654703836,\n  1088359270,\n  936918e3,\n  2847714899,\n  3736837829,\n  1202900863,\n  817233897,\n  3183342108,\n  3401237130,\n  1404277552,\n  615818150,\n  3134207493,\n  3453421203,\n  1423857449,\n  601450431,\n  3009837614,\n  3294710456,\n  1567103746,\n  711928724,\n  3020668471,\n  3272380065,\n  1510334235,\n  755167117\n]);\nfunction ensureBuffer(input) {\n  if (Buffer.isBuffer(input)) {\n    return input;\n  }\n  if (typeof input === \"number\") {\n    return Buffer.alloc(input);\n  } else if (typeof input === \"string\") {\n    return Buffer.from(input);\n  } else {\n    throw new Error(\"input must be buffer, number, or string, received \" + typeof input);\n  }\n}\nfunction bufferizeInt(num) {\n  const tmp = ensureBuffer(4);\n  tmp.writeInt32BE(num, 0);\n  return tmp;\n}\nfunction _crc32(buf, previous) {\n  buf = ensureBuffer(buf);\n  if (Buffer.isBuffer(previous)) {\n    previous = previous.readUInt32BE(0);\n  }\n  let crc = ~~previous ^ -1;\n  for (var n = 0; n < buf.length; n++) {\n    crc = CRC_TABLE[(crc ^ buf[n]) & 255] ^ crc >>> 8;\n  }\n  return crc ^ -1;\n}\nfunction crc32() {\n  return bufferizeInt(_crc32.apply(null, arguments));\n}\ncrc32.signed = function() {\n  return _crc32.apply(null, arguments);\n};\ncrc32.unsigned = function() {\n  return _crc32.apply(null, arguments) >>> 0;\n};\nvar bufferCrc32 = crc32;\n\nconst index = /*@__PURE__*/getDefaultExportFromCjs(bufferCrc32);\n\nmodule.exports = index;\n","module.exports = require(\"dgram\");","'use strict'\n\nexports.toString = function (type) {\n  switch (type) {\n    case 1: return 'A'\n    case 10: return 'NULL'\n    case 28: return 'AAAA'\n    case 18: return 'AFSDB'\n    case 42: return 'APL'\n    case 257: return 'CAA'\n    case 60: return 'CDNSKEY'\n    case 59: return 'CDS'\n    case 37: return 'CERT'\n    case 5: return 'CNAME'\n    case 49: return 'DHCID'\n    case 32769: return 'DLV'\n    case 39: return 'DNAME'\n    case 48: return 'DNSKEY'\n    case 43: return 'DS'\n    case 55: return 'HIP'\n    case 13: return 'HINFO'\n    case 45: return 'IPSECKEY'\n    case 25: return 'KEY'\n    case 36: return 'KX'\n    case 29: return 'LOC'\n    case 15: return 'MX'\n    case 35: return 'NAPTR'\n    case 2: return 'NS'\n    case 47: return 'NSEC'\n    case 50: return 'NSEC3'\n    case 51: return 'NSEC3PARAM'\n    case 12: return 'PTR'\n    case 46: return 'RRSIG'\n    case 17: return 'RP'\n    case 24: return 'SIG'\n    case 6: return 'SOA'\n    case 99: return 'SPF'\n    case 33: return 'SRV'\n    case 44: return 'SSHFP'\n    case 32768: return 'TA'\n    case 249: return 'TKEY'\n    case 52: return 'TLSA'\n    case 250: return 'TSIG'\n    case 16: return 'TXT'\n    case 252: return 'AXFR'\n    case 251: return 'IXFR'\n    case 41: return 'OPT'\n    case 255: return 'ANY'\n  }\n  return 'UNKNOWN_' + type\n}\n\nexports.toType = function (name) {\n  switch (name.toUpperCase()) {\n    case 'A': return 1\n    case 'NULL': return 10\n    case 'AAAA': return 28\n    case 'AFSDB': return 18\n    case 'APL': return 42\n    case 'CAA': return 257\n    case 'CDNSKEY': return 60\n    case 'CDS': return 59\n    case 'CERT': return 37\n    case 'CNAME': return 5\n    case 'DHCID': return 49\n    case 'DLV': return 32769\n    case 'DNAME': return 39\n    case 'DNSKEY': return 48\n    case 'DS': return 43\n    case 'HIP': return 55\n    case 'HINFO': return 13\n    case 'IPSECKEY': return 45\n    case 'KEY': return 25\n    case 'KX': return 36\n    case 'LOC': return 29\n    case 'MX': return 15\n    case 'NAPTR': return 35\n    case 'NS': return 2\n    case 'NSEC': return 47\n    case 'NSEC3': return 50\n    case 'NSEC3PARAM': return 51\n    case 'PTR': return 12\n    case 'RRSIG': return 46\n    case 'RP': return 17\n    case 'SIG': return 24\n    case 'SOA': return 6\n    case 'SPF': return 99\n    case 'SRV': return 33\n    case 'SSHFP': return 44\n    case 'TA': return 32768\n    case 'TKEY': return 249\n    case 'TLSA': return 52\n    case 'TSIG': return 250\n    case 'TXT': return 16\n    case 'AXFR': return 252\n    case 'IXFR': return 251\n    case 'OPT': return 41\n    case 'ANY': return 255\n    case '*': return 255\n  }\n  if (name.toUpperCase().startsWith('UNKNOWN_')) return parseInt(name.slice(8))\n  return 0\n}\n","'use strict';\n\nconst { isType } = require('lib/util');\n\nmodule.exports = bool;\n\n/**\n * Boolean type.\n * @param {Object} type Any builtin type or schema.\n * @returns {Object}\n */\nfunction bool(type) {\n  if (!isType(type)) {\n    throw new TypeError('Argument #1 should be valid type.');\n  }\n\n  /**\n   * Decode element as boolean.\n   * @param {DecodeStream} rstream\n   * @returns {bool}\n   */\n  function decode(rstream) {\n    // eslint-disable-next-line no-invalid-this\n    const context = this;\n\n    const value = type.decode.call(context, rstream);\n    decode.bytes = type.decode.bytes;\n\n    return Boolean(value);\n  }\n\n  /**\n   * Encode boolean item.\n   * @param {bool} value\n   * @param {EncodeStream} wstream\n   */\n  function encode(value, wstream) {\n    // eslint-disable-next-line no-invalid-this\n    const context = this;\n\n    type.encode.call(context, value ? 1 : 0, wstream);\n    encode.bytes = type.encode.bytes;\n  }\n\n  return {\n    encode,\n    decode,\n    encodingLength: type.encodingLength,\n  };\n}\n","/**\n * @module http-auth-utils/mechanisms/basic\n */\nimport { YError } from 'yerror';\nimport { parseHTTPHeadersQuotedKeyValueSet, buildHTTPHeadersQuotedKeyValueSet, } from '../utils.js';\nconst REQUIRED_WWW_AUTHENTICATE_KEYS = ['realm'];\nconst AUTHORIZED_WWW_AUTHENTICATE_KEYS = REQUIRED_WWW_AUTHENTICATE_KEYS;\n/* Architecture Note #1.2: Basic mechanism\n\nSee the following [RFC](https://tools.ietf.org/html/rfc7617).\n\n*/\n/**\n * Basic authentication mechanism.\n * @type {Object}\n * @see http://tools.ietf.org/html/rfc2617#section-2\n */\nconst BASIC = {\n    /**\n     * The Basic auth mechanism prefix.\n     * @type {String}\n     */\n    type: 'Basic',\n    /**\n     * Parse the WWW Authenticate header rest.\n     * @param  {String} rest The header rest (string after the authentication mechanism prefix).\n     * @return {Object}      Object representing the result of the parse operation.\n     * @example\n     * assert.deepEqual(\n     *   BASIC.parseWWWAuthenticateRest('realm=\"perlinpinpin\"'), {\n     *     realm: 'perlinpinpin'\n     *   }\n     * );\n     * @api public\n     */\n    parseWWWAuthenticateRest: function parseWWWAuthenticateRest(rest) {\n        return parseHTTPHeadersQuotedKeyValueSet(rest, AUTHORIZED_WWW_AUTHENTICATE_KEYS, REQUIRED_WWW_AUTHENTICATE_KEYS);\n    },\n    /**\n     * Build the WWW Authenticate header rest.\n     * @param  {Object} data The content from wich to build the rest.\n     * @return {String}         The built rest.\n     * @example\n     * assert.equal(\n     *   BASIC.buildWWWAuthenticateRest({\n     *     realm: 'perlinpinpin'\n     *   }),\n     *   'realm=\"perlinpinpin\"'\n     * );\n     * @api public\n     */\n    buildWWWAuthenticateRest: function buildWWWAuthenticateRest(data) {\n        return buildHTTPHeadersQuotedKeyValueSet(data, AUTHORIZED_WWW_AUTHENTICATE_KEYS, REQUIRED_WWW_AUTHENTICATE_KEYS);\n    },\n    /**\n     * Parse the Authorization header rest.\n     * @param  {String} rest The header rest (string after the authentication mechanism prefix).)\n     * @return {Object}      Object representing the result of the parse operation {hash}.\n     * @example\n     * assert.deepEqual(\n     *   BASIC.parseAuthorizationRest('QWxpIEJhYmE6b3BlbiBzZXNhbWU='), {\n     *     hash: 'QWxpIEJhYmE6b3BlbiBzZXNhbWU=',\n     *     username: 'Ali Baba',\n     *     password: 'open sesame'\n     *   }\n     * );\n     * @api public\n     */\n    parseAuthorizationRest: function parseAuthorizationRest(rest) {\n        if (!rest) {\n            throw new YError('E_EMPTY_AUTH');\n        }\n        const { username, password } = BASIC.decodeHash(rest);\n        return {\n            hash: rest,\n            username,\n            password,\n        };\n    },\n    /**\n     * Build the Authorization header rest.\n     * @param  {Object} content The content from wich to build the rest.\n     * @return {String}         The rest built.\n     * @example\n     * assert.equal(\n     *   BASIC.buildAuthorizationRest({\n     *     hash: 'QWxpIEJhYmE6b3BlbiBzZXNhbWU='\n     *   }),\n     *   'QWxpIEJhYmE6b3BlbiBzZXNhbWU='\n     * );\n     * @api public\n     */\n    buildAuthorizationRest: function buildAuthorizationRest({ hash, username, password, }) {\n        if (username && password) {\n            return BASIC.computeHash({\n                username,\n                password,\n            });\n        }\n        if (!hash) {\n            throw new YError('E_NO_HASH');\n        }\n        return hash;\n    },\n    /**\n     * Compute the Basic authentication hash from the given credentials.\n     * @param  {Object} credentials The credentials to encode {username, password}.\n     * @return {String}             The hash representing the credentials.\n     * @example\n     * assert.equal(\n     *   BASIC.computeHash({\n     *     username: 'Ali Baba',\n     *     password: 'open sesame'\n     *   }),\n     *   'QWxpIEJhYmE6b3BlbiBzZXNhbWU='\n     * );\n     * @api public\n     */\n    computeHash: function computeHash({ username, password, }) {\n        return Buffer.from(username + ':' + password).toString('base64');\n    },\n    /**\n     * Decode the Basic hash and return the corresponding credentials.\n     * @param  {String} hash The hash.\n     * @return {Object}      Object representing the credentials {username, password}.\n     * @example\n     * assert.deepEqual(\n     *   BASIC.decodeHash('QWxpIEJhYmE6b3BlbiBzZXNhbWU='), {\n     *     username: 'Ali Baba',\n     *     password: 'open sesame'\n     *   }\n     * );\n     * @api public\n     */\n    decodeHash: function decodeHash(hash) {\n        const [username, ...passwordParts] = Buffer.from(hash, 'base64')\n            .toString()\n            .split(':');\n        return {\n            username,\n            password: passwordParts.join(':'),\n        };\n    },\n};\nexport default BASIC;\n//# sourceMappingURL=basic.js.map","/**\n * @module http-auth-utils/mechanisms/digest\n */\nimport { parseHTTPHeadersQuotedKeyValueSet, buildHTTPHeadersQuotedKeyValueSet, } from '../utils.js';\nimport crypto from 'crypto';\nconst REQUIRED_WWW_AUTHENTICATE_KEYS = ['realm', 'nonce'];\nconst AUTHORIZED_WWW_AUTHENTICATE_KEYS = [\n    ...REQUIRED_WWW_AUTHENTICATE_KEYS,\n    'domain',\n    'opaque',\n    'stale',\n    'algorithm',\n    'qop',\n];\nconst CASE_INSENSITIVE_WWW_AUTHENTICATE_VALUES = ['stale'];\nconst REQUIRED_AUTHORIZATION_KEYS = [\n    'username',\n    'realm',\n    'nonce',\n    'uri',\n    'response',\n];\nconst AUTHORIZED_AUTHORIZATION_KEYS = [\n    ...REQUIRED_AUTHORIZATION_KEYS,\n    'algorithm',\n    'cnonce',\n    'opaque',\n    'qop',\n    'nc',\n];\n/* Architecture Note #1.3: Digest mechanism\n\nSee the following [RFC](https://tools.ietf.org/html/rfc2617).\n\n*/\n/**\n * Digest authentication mechanism.\n * @type {Object}\n * @see http://tools.ietf.org/html/rfc2617#section-3\n * @see http://tools.ietf.org/html/rfc2069#section-2\n */\nconst DIGEST = {\n    /**\n     * The Digest auth mechanism prefix.\n     * @type {String}\n     */\n    type: 'Digest',\n    /**\n     * Parse the WWW Authenticate header rest.\n     * @param  {String} rest The header rest (string after the authentication mechanism prefix).\n     * @return {Object}      Object representing the result of the parse operation.\n     * @example\n     * assert.deepEqual(\n     *   DIGEST.parseWWWAuthenticateRest(\n     *     'realm=\"testrealm@host.com\", ' +\n     *     'qop=\"auth, auth-int\", ' +\n     *     'nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\", ' +\n     *     'opaque=\"5ccc069c403ebaf9f0171e9517f40e41\"'\n     *   ), {\n     *     realm: 'testrealm@host.com',\n     *     qop: 'auth, auth-int',\n     *     nonce: 'dcd98b7102dd2f0e8b11d0f600bfb0c093',\n     *     opaque: '5ccc069c403ebaf9f0171e9517f40e41'\n     *   }\n     * );\n     * @api public\n     */\n    parseWWWAuthenticateRest: function parseWWWAuthenticateRest(rest) {\n        return parseHTTPHeadersQuotedKeyValueSet(rest, AUTHORIZED_WWW_AUTHENTICATE_KEYS, REQUIRED_WWW_AUTHENTICATE_KEYS, CASE_INSENSITIVE_WWW_AUTHENTICATE_VALUES);\n    },\n    /**\n     * Build the WWW Authenticate header rest.\n     * @param  {Object} data The content from which to build the rest.\n     * @return {String}         The built rest.\n     * @example\n     * assert.equal(\n     *   DIGEST.buildWWWAuthenticateRest({\n     *     realm: 'testrealm@host.com',\n     *     qop: 'auth, auth-int',\n     *     nonce: 'dcd98b7102dd2f0e8b11d0f600bfb0c093',\n     *     opaque: '5ccc069c403ebaf9f0171e9517f40e41'\n     *   }),\n     *   'realm=\"testrealm@host.com\", ' +\n     *   'qop=\"auth, auth-int\", ' +\n     *   'nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\", ' +\n     *   'opaque=\"5ccc069c403ebaf9f0171e9517f40e41\"'\n     * );\n     * @api public\n     */\n    buildWWWAuthenticateRest: function buildWWWAuthenticateRest(data) {\n        return buildHTTPHeadersQuotedKeyValueSet(data, AUTHORIZED_WWW_AUTHENTICATE_KEYS, REQUIRED_WWW_AUTHENTICATE_KEYS);\n    },\n    /**\n     * Parse the Authorization header rest.\n     * @param  {String} rest The header rest (string after the authentication mechanism prefix).)\n     * @return {Object}      Object representing the result of the parse operation {hash}.\n     * @example\n     * assert.deepEqual(\n     *   DIGEST.parseAuthorizationRest(\n     *     'username=\"Mufasa\",' +\n     *     'realm=\"testrealm@host.com\",' +\n     *     'nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\",' +\n     *     'uri=\"/dir/index.html\",' +\n     *     'qop=\"auth\",' +\n     *     'nc=\"00000001\",' +\n     *     'cnonce=\"0a4f113b\",' +\n     *     'response=\"6629fae49393a05397450978507c4ef1\",' +\n     *     'opaque=\"5ccc069c403ebaf9f0171e9517f40e41\"'\n     *   ), {\n     *     username: \"Mufasa\",\n     *     realm: 'testrealm@host.com',\n     *     nonce: \"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n     *     uri: \"/dir/index.html\",\n     *     qop: 'auth',\n     *     nc: '00000001',\n     *     cnonce: \"0a4f113b\",\n     *     response: \"6629fae49393a05397450978507c4ef1\",\n     *     opaque: \"5ccc069c403ebaf9f0171e9517f40e41\"\n     *   }\n     * );\n     * @api public\n     */\n    parseAuthorizationRest: function parseAuthorizationRest(rest) {\n        return parseHTTPHeadersQuotedKeyValueSet(rest, AUTHORIZED_AUTHORIZATION_KEYS, REQUIRED_AUTHORIZATION_KEYS);\n    },\n    /**\n     * Build the Authorization header rest.\n     * @param  {Object} data The content from which to build the rest.\n     * @return {String}         The rest built.\n     * @example\n     * assert.equal(\n     *   DIGEST.buildAuthorizationRest({\n     *     username: \"Mufasa\",\n     *     realm: 'testrealm@host.com',\n     *     nonce: \"dcd98b7102dd2f0e8b11d0f600bfb0c093\",\n     *     uri: \"/dir/index.html\",\n     *     qop: 'auth',\n     *     nc: '00000001',\n     *     cnonce: \"0a4f113b\",\n     *     response: \"6629fae49393a05397450978507c4ef1\",\n     *     opaque: \"5ccc069c403ebaf9f0171e9517f40e41\"\n     *   }),\n     *   'username=\"Mufasa\", ' +\n     *   'realm=\"testrealm@host.com\", ' +\n     *   'nonce=\"dcd98b7102dd2f0e8b11d0f600bfb0c093\", ' +\n     *   'uri=\"/dir/index.html\", ' +\n     *   'response=\"6629fae49393a05397450978507c4ef1\", ' +\n     *   'cnonce=\"0a4f113b\", ' +\n     *   'opaque=\"5ccc069c403ebaf9f0171e9517f40e41\", ' +\n     *   'qop=\"auth\", ' +\n     *   'nc=\"00000001\"'\n     * );\n     * @api public\n     */\n    buildAuthorizationRest: function buildAuthorizationRest(data) {\n        return buildHTTPHeadersQuotedKeyValueSet(data, AUTHORIZED_AUTHORIZATION_KEYS, REQUIRED_AUTHORIZATION_KEYS);\n    },\n    /**\n     * Compute the Digest authentication hash from the given credentials.\n     * @param  {Object} data The credentials to encode and other encoding details.\n     * @return {String}             The hash representing the credentials.\n     * @example\n     * assert.equal(\n     *   DIGEST.computeHash({\n     *     username: 'Mufasa',\n     *     realm: 'testrealm@host.com',\n     *     password: 'Circle Of Life',\n     *     method: 'GET',\n     *     uri: '/dir/index.html',\n     *     nonce: 'dcd98b7102dd2f0e8b11d0f600bfb0c093',\n     *     nc: '00000001',\n     *     cnonce: '0a4f113b',\n     *     qop: 'auth',\n     *     algorithm: 'md5'\n     *   }),\n     *   '6629fae49393a05397450978507c4ef1'\n     * );\n     * @api public\n     */\n    computeHash: function computeHash(data) {\n        const ha1 = data.ha1 ||\n            _computeHash(data.algorithm, [data.username, data.realm, data.password].join(':'));\n        const ha2 = _computeHash(data.algorithm, [data.method, data.uri].join(':'));\n        return _computeHash(data.algorithm, [ha1, data.nonce, data.nc, data.cnonce, data.qop, ha2].join(':'));\n    },\n};\nfunction _computeHash(algorithm, str) {\n    const hashsum = crypto.createHash(algorithm);\n    hashsum.update(str);\n    return hashsum.digest('hex');\n}\nexport default DIGEST;\n//# sourceMappingURL=digest.js.map","import os from 'os';\n/**\n * A YError class able to contain some params and\n *  print better stack traces\n * @extends Error\n */\nclass YError extends Error {\n    code;\n    params;\n    wrappedErrors;\n    constructor(wrappedErrors, errorCode, ...params) {\n        // Detecting if wrappedErrors are passed\n        if (!(wrappedErrors instanceof Array)) {\n            params = ('undefined' === typeof errorCode ? [] : [errorCode]).concat(params);\n            errorCode = wrappedErrors;\n            wrappedErrors = [];\n        }\n        // Call the parent constructor\n        super(errorCode);\n        // Filling error\n        this.code = errorCode || 'E_UNEXPECTED';\n        this.params = params;\n        this.wrappedErrors = wrappedErrors;\n        this.name = this.toString();\n        if (Error.captureStackTrace) {\n            Error.captureStackTrace(this, this.constructor);\n        }\n    }\n    /**\n     * Wraps any error and output a YError with an error\n     *  code and some params as debug values.\n     * @param {Error} err\n     * The error to wrap\n     * @param {string} [errorCode = 'E_UNEXPECTED']\n     * The error code corresponding to the actual error\n     * @param {...YErrorParams} [params]\n     * Some additional debugging values\n     * @return {YError}\n     * The wrapped error\n     */\n    static wrap(err, errorCode, ...params) {\n        const wrappedErrorIsACode = _looksLikeAYErrorCode(err.message);\n        const wrappedErrors = ('wrappedErrors' in err ? err.wrappedErrors : []).concat(err);\n        if (!errorCode) {\n            if (wrappedErrorIsACode) {\n                errorCode = err.message;\n            }\n            else {\n                errorCode = 'E_UNEXPECTED';\n            }\n        }\n        if (err.message && !wrappedErrorIsACode) {\n            params.push(err.message);\n        }\n        return new YError(wrappedErrors, errorCode, ...params);\n    }\n    /**\n     * Return a YError as is or wraps any other error and output\n     *  a YError with a code and some params as debug values.\n     * @param {Error} err\n     * The error to cast\n     * @param {string} [errorCode = 'E_UNEXPECTED']\n     * The error code corresponding to the actual error\n     * @param {...YErrorParams} [params]\n     * Some additional debugging values\n     * @return {YError}\n     * The wrapped error\n     */\n    static cast(err, errorCode, ...params) {\n        if (_looksLikeAYError(err)) {\n            return err;\n        }\n        return YError.wrap(err, errorCode, ...params);\n    }\n    /**\n     * Same than `YError.wrap()` but preserves the code\n     *  and the debug values of the error if it is\n     *  already an instance of the YError constructor.\n     * @param {Error} err\n     * The error to bump\n     * @param {string} [errorCode = 'E_UNEXPECTED']\n     * The error code corresponding to the actual error\n     * @param {...YErrorParams} [params]\n     * Some additional debugging values\n     * @return {YError}\n     * The wrapped error\n     */\n    static bump(err, errorCode, ...params) {\n        if (_looksLikeAYError(err)) {\n            return YError.wrap(err, err.code, ...err.params);\n        }\n        return YError.wrap(err, errorCode, ...params);\n    }\n    toString() {\n        return ((this.wrappedErrors.length\n            ? // eslint-disable-next-line\n                this.wrappedErrors[this.wrappedErrors.length - 1].stack + os.EOL\n            : '') +\n            this.constructor.name +\n            ': ' +\n            this.code +\n            ' (' +\n            this.params.join(', ') +\n            ')');\n    }\n}\n/**\n * Allow to print a stack from anything (especially catched\n *  errors that may or may not contain errors ).\n * @param {Error} err\n * The error to print\n * @return {string}\n * The stack trace if any\n */\nexport function printStackTrace(err) {\n    return typeof err === 'object' && typeof err.stack === 'string'\n        ? err.stack\n        : `[no_stack_trace]: error is ${err != null && typeof err.toString === 'function'\n            ? err.toString()\n            : typeof err}`;\n}\n// In order to keep compatibility through major versions\n// we have to make kind of an cross major version instanceof\nfunction _looksLikeAYError(err) {\n    return (!!(err instanceof YError) ||\n        !!(err.constructor &&\n            err.constructor.name &&\n            err.constructor.name.endsWith('Error') &&\n            'code' in err &&\n            'string' === typeof err.code &&\n            _looksLikeAYErrorCode(err.code) &&\n            'params' in err &&\n            err.params &&\n            err.params instanceof Array));\n}\nfunction _looksLikeAYErrorCode(str) {\n    return /^([A-Z0-9_]+)$/.test(str);\n}\nexport { YError };\n//# sourceMappingURL=index.js.map","import { type SocketType, createSocket } from \"dgram\";\n\nexport type InterfaceAddresses = {\n  [K in SocketType]?: string;\n};\n\nexport const interfaceAddress = (\n  type: SocketType,\n  interfaceAddresses: InterfaceAddresses | undefined,\n) => (interfaceAddresses ? interfaceAddresses[type] : undefined);\n\nexport async function randomPort(\n  protocol: SocketType = \"udp4\",\n  interfaceAddresses?: InterfaceAddresses,\n) {\n  const socket = createSocket(protocol);\n\n  setImmediate(() =>\n    socket.bind({\n      port: 0,\n      address: interfaceAddress(protocol, interfaceAddresses),\n    }),\n  );\n\n  await new Promise<void>((r) => {\n    socket.once(\"error\", r);\n    socket.once(\"listening\", r);\n  });\n\n  const port = socket.address()?.port;\n  await new Promise<void>((r) => socket.close(() => r()));\n  return port;\n}\n\nexport async function randomPorts(\n  num: number,\n  protocol: SocketType = \"udp4\",\n  interfaceAddresses?: InterfaceAddresses,\n) {\n  return Promise.all(\n    [...Array(num)].map(() => randomPort(protocol, interfaceAddresses)),\n  );\n}\n\nexport async function findPort(\n  min: number,\n  max: number,\n  protocol: SocketType = \"udp4\",\n  interfaceAddresses?: InterfaceAddresses,\n) {\n  let port: number | undefined;\n\n  for (let i = min; i <= max; i++) {\n    const socket = createSocket(protocol);\n\n    setImmediate(() =>\n      socket.bind({\n        port: i,\n        address: interfaceAddress(protocol, interfaceAddresses),\n      }),\n    );\n\n    const err = await new Promise<Error | void>((r) => {\n      socket.once(\"error\", (e) => r(e));\n      socket.once(\"listening\", () => r());\n    });\n    if (err) {\n      await new Promise<void>((r) => socket.close(() => r()));\n      continue;\n    }\n\n    port = socket.address()?.port;\n    await new Promise<void>((r) => socket.close(() => r()));\n    if (min <= port && port <= max) {\n      break;\n    }\n  }\n\n  if (!port) throw new Error(\"port not found\");\n\n  return port;\n}\n\nexport type Address = Readonly<[string, number]>;\n\nexport function normalizeFamilyNodeV18(family: string | number): 4 | 6 {\n  if (family === \"IPv4\") return 4;\n  if (family === \"IPv6\") return 6;\n\n  return family as 4 | 6;\n}\n","import { decode, encode } from \"@shinyoshiaki/binary-data\";\n\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type { Handshake } from \"../../../typings/domain\";\nimport { HandshakeType } from \"../../const\";\n\n// 7.4.5.  Server Hello Done\n\nexport class ServerHelloDone implements Handshake {\n  msgType = HandshakeType.server_hello_done_14;\n  messageSeq?: number;\n  static readonly spec = {};\n\n  static createEmpty() {\n    return new ServerHelloDone();\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new ServerHelloDone(\n      //@ts-ignore\n      ...Object.values(decode(buf, ServerHelloDone.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, ServerHelloDone.spec).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","import { ReceiverDirection, SenderDirections } from \"./const\";\nimport { Event, debug } from \"./imports/common\";\nimport {\n  MediaStream,\n  type MediaStreamTrack,\n  type RTCRtpCodecParameters,\n  RTCRtpCodingParameters,\n  type RTCRtpParameters,\n  type RTCRtpReceiveParameters,\n  RTCRtpReceiver,\n  RTCRtpRtxParameters,\n  RTCRtpSender,\n  RTCRtpTransceiver,\n  Recvonly,\n  type RtpRouter,\n  Sendonly,\n  Sendrecv,\n  type TransceiverOptions,\n} from \"./media\";\nimport type { RTCStats } from \"./media/stats\";\nimport { type PeerConfig, findCodecByMimeType } from \"./peerConnection\";\nimport { type MediaDescription, codecParametersFromString } from \"./sdp\";\nimport type { RTCDtlsTransport } from \"./transport/dtls\";\nimport type { Kind } from \"./types/domain\";\nimport { reverseDirection } from \"./utils\";\n\nconst log = debug(\"werift:packages/webrtc/src/media/rtpTransceiverManager.ts\");\n\nexport class TransceiverManager {\n  private readonly transceivers: RTCRtpTransceiver[] = [];\n\n  readonly onTransceiverAdded = new Event<[RTCRtpTransceiver]>();\n  readonly onRemoteTransceiverAdded = new Event<[RTCRtpTransceiver]>();\n  readonly onTrack = new Event<\n    [\n      {\n        track: MediaStreamTrack;\n        transceiver: RTCRtpTransceiver;\n        stream: MediaStream;\n      },\n    ]\n  >();\n  readonly onNegotiationNeeded = new Event<[]>();\n\n  constructor(\n    private readonly cname: string,\n    private readonly config: Required<PeerConfig>,\n    private readonly router: RtpRouter,\n  ) {}\n\n  getTransceivers(): RTCRtpTransceiver[] {\n    return this.transceivers;\n  }\n\n  getSenders(): RTCRtpSender[] {\n    return this.getTransceivers().map((t) => t.sender);\n  }\n\n  getReceivers() {\n    return this.getTransceivers().map((t) => t.receiver);\n  }\n\n  getTransceiverByMLineIndex(index: number): RTCRtpTransceiver | undefined {\n    return this.transceivers.find(\n      (transceiver) => transceiver.mLineIndex === index,\n    );\n  }\n\n  pushTransceiver(t: RTCRtpTransceiver): void {\n    this.transceivers.push(t);\n  }\n\n  replaceTransceiver(t: RTCRtpTransceiver, index: number): void {\n    this.transceivers[index] = t;\n  }\n\n  addTransceiver(\n    trackOrKind: Kind | MediaStreamTrack,\n    dtlsTransport?: RTCDtlsTransport,\n    options: Partial<TransceiverOptions> = {},\n  ): RTCRtpTransceiver {\n    const kind =\n      typeof trackOrKind === \"string\" ? trackOrKind : trackOrKind.kind;\n\n    const direction = options.direction || \"sendrecv\";\n\n    const sender = new RTCRtpSender(trackOrKind);\n    const receiver = new RTCRtpReceiver(this.config, kind, sender.ssrc);\n    const newTransceiver = new RTCRtpTransceiver(\n      kind,\n      dtlsTransport,\n      receiver,\n      sender,\n      direction,\n    );\n    newTransceiver.options = options;\n    this.router.registerRtpSender(newTransceiver.sender);\n\n    // reuse inactive\n    const inactiveTransceiverIndex = this.transceivers.findIndex(\n      (t) => t.currentDirection === \"inactive\",\n    );\n    const inactiveTransceiver = this.transceivers.find(\n      (t) => t.currentDirection === \"inactive\",\n    );\n    if (inactiveTransceiverIndex > -1 && inactiveTransceiver) {\n      this.replaceTransceiver(newTransceiver, inactiveTransceiverIndex);\n      newTransceiver.mLineIndex = inactiveTransceiver.mLineIndex;\n      inactiveTransceiver.setCurrentDirection(undefined);\n    } else {\n      this.pushTransceiver(newTransceiver);\n    }\n    this.onTransceiverAdded.execute(newTransceiver);\n\n    return newTransceiver;\n  }\n\n  addTrack(track: MediaStreamTrack, ms?: MediaStream): RTCRtpTransceiver {\n    if (this.getSenders().find((sender) => sender.track?.uuid === track.uuid)) {\n      throw new Error(\"Track already added\");\n    }\n\n    const emptyTrackSenderTransceiver = this.transceivers.find(\n      (t) =>\n        t.sender.track == undefined &&\n        t.kind === track.kind &&\n        SenderDirections.includes(t.direction) === true,\n    );\n    if (emptyTrackSenderTransceiver) {\n      const sender = emptyTrackSenderTransceiver.sender;\n      sender.registerTrack(track);\n      return emptyTrackSenderTransceiver;\n    }\n\n    const notSendTransceiver = this.transceivers.find(\n      (t) =>\n        t.sender.track == undefined &&\n        t.kind === track.kind &&\n        SenderDirections.includes(t.direction) === false &&\n        !t.usedForSender,\n    );\n    if (notSendTransceiver) {\n      const sender = notSendTransceiver.sender;\n      sender.registerTrack(track);\n      switch (notSendTransceiver.direction) {\n        case \"recvonly\":\n          notSendTransceiver.setDirection(\"sendrecv\");\n          break;\n        case \"inactive\":\n          notSendTransceiver.setDirection(\"sendonly\");\n          break;\n      }\n      return notSendTransceiver;\n    } else {\n      const transceiver = this.addTransceiver(track, undefined, {\n        direction: \"sendrecv\",\n      });\n      return transceiver;\n    }\n  }\n\n  removeTrack(sender: RTCRtpSender): void {\n    if (!this.getSenders().find(({ ssrc }) => sender.ssrc === ssrc)) {\n      throw new Error(\"Sender does not exist\");\n    }\n\n    const transceiver = this.transceivers.find(\n      ({ sender: { ssrc } }) => sender.ssrc === ssrc,\n    );\n    if (!transceiver) throw new Error(\"No matching transceiver found\");\n\n    sender.stop();\n\n    if (transceiver.currentDirection === \"recvonly\") {\n      this.onNegotiationNeeded.execute();\n      return;\n    }\n\n    if (transceiver.stopping || transceiver.stopped) {\n      transceiver.setDirection(\"inactive\");\n    } else {\n      if (transceiver.direction === \"sendrecv\") {\n        transceiver.setDirection(\"recvonly\");\n      } else if (\n        transceiver.direction === \"sendonly\" ||\n        transceiver.direction === \"recvonly\"\n      ) {\n        transceiver.setDirection(\"inactive\");\n      }\n    }\n  }\n\n  assignTransceiverCodecs(transceiver: RTCRtpTransceiver): void {\n    const codecs = (\n      this.config.codecs[transceiver.kind] as RTCRtpCodecParameters[]\n    ).filter((codecCandidate) => {\n      switch (codecCandidate.direction) {\n        case \"recvonly\": {\n          if (ReceiverDirection.includes(transceiver.direction)) return true;\n          return false;\n        }\n        case \"sendonly\": {\n          if (SenderDirections.includes(transceiver.direction)) return true;\n          return false;\n        }\n        case \"sendrecv\": {\n          if ([Sendrecv, Recvonly, Sendonly].includes(transceiver.direction))\n            return true;\n          return false;\n        }\n        case \"all\": {\n          return true;\n        }\n        default:\n          return false;\n      }\n    });\n    transceiver.codecs = codecs;\n  }\n\n  getLocalRtpParams(transceiver: RTCRtpTransceiver): RTCRtpParameters {\n    if (transceiver.mid == undefined) throw new Error(\"mid not assigned\");\n\n    const rtp: RTCRtpParameters = {\n      codecs: transceiver.codecs,\n      muxId: transceiver.mid,\n      headerExtensions: transceiver.headerExtensions,\n      rtcp: { cname: this.cname, ssrc: transceiver.sender.ssrc, mux: true },\n    };\n    return rtp;\n  }\n\n  getRemoteRtpParams(\n    media: MediaDescription,\n    transceiver: RTCRtpTransceiver,\n  ): RTCRtpReceiveParameters {\n    const receiveParameters: RTCRtpReceiveParameters = {\n      muxId: media.rtp.muxId,\n      rtcp: media.rtp.rtcp,\n      codecs: transceiver.codecs,\n      headerExtensions: transceiver.headerExtensions,\n      encodings: Object.values(\n        transceiver.codecs.reduce(\n          (acc: { [pt: number]: RTCRtpCodingParameters }, codec) => {\n            if (codec.name.toLowerCase() === \"rtx\") {\n              const params = codecParametersFromString(codec.parameters ?? \"\");\n              const apt = acc[params[\"apt\"]];\n              if (apt && media.ssrc.length === 2) {\n                apt.rtx = new RTCRtpRtxParameters({ ssrc: media.ssrc[1].ssrc });\n              }\n              return acc;\n            }\n            acc[codec.payloadType] = new RTCRtpCodingParameters({\n              ssrc: media.ssrc[0]?.ssrc,\n              payloadType: codec.payloadType,\n            });\n            return acc;\n          },\n          {},\n        ),\n      ),\n    };\n\n    return receiveParameters;\n  }\n\n  setRemoteRTP(\n    transceiver: RTCRtpTransceiver,\n    remoteMedia: MediaDescription,\n    type: \"offer\" | \"answer\",\n    mLineIndex: number,\n  ): void {\n    if (!transceiver.mid) {\n      transceiver.mid = remoteMedia.rtp.muxId;\n    }\n    transceiver.mLineIndex = mLineIndex;\n\n    // # negotiate codecs\n    transceiver.codecs = remoteMedia.rtp.codecs.filter((remoteCodec) => {\n      const localCodecs = this.config.codecs[remoteMedia.kind] || [];\n\n      const existCodec = findCodecByMimeType(localCodecs, remoteCodec);\n      if (!existCodec) {\n        return false;\n      }\n\n      if (existCodec?.name.toLowerCase() === \"rtx\") {\n        const params = codecParametersFromString(existCodec.parameters ?? \"\");\n        const pt = params[\"apt\"];\n        const origin = remoteMedia.rtp.codecs.find((c) => c.payloadType === pt);\n        if (!origin) {\n          return false;\n        }\n        return !!findCodecByMimeType(localCodecs, origin);\n      }\n\n      return true;\n    });\n\n    log(\"negotiated codecs\", transceiver.codecs);\n    if (transceiver.codecs.length === 0) {\n      throw new Error(\"negotiate codecs failed.\");\n    }\n    transceiver.headerExtensions = remoteMedia.rtp.headerExtensions.filter(\n      (extension) =>\n        (\n          this.config.headerExtensions[remoteMedia.kind as \"audio\" | \"video\"] ||\n          []\n        ).find((v) => v.uri === extension.uri),\n    );\n\n    // # configure direction\n    const mediaDirection = remoteMedia.direction ?? \"inactive\";\n    const direction = reverseDirection(mediaDirection);\n    if ([\"answer\", \"pranswer\"].includes(type)) {\n      transceiver.setCurrentDirection(direction);\n    } else {\n      transceiver.offerDirection = direction;\n    }\n    const localParams = this.getLocalRtpParams(transceiver);\n    transceiver.sender.prepareSend(localParams);\n\n    if ([\"recvonly\", \"sendrecv\"].includes(transceiver.direction)) {\n      const remotePrams = this.getRemoteRtpParams(remoteMedia, transceiver);\n\n      // register simulcast receiver\n      for (const param of remoteMedia.simulcastParameters) {\n        this.router.registerRtpReceiverByRid(transceiver, param, remotePrams);\n      }\n\n      transceiver.receiver.prepareReceive(remotePrams);\n      // register ssrc receiver\n      this.router.registerRtpReceiverBySsrc(transceiver, remotePrams);\n    }\n    if ([\"sendonly\", \"sendrecv\"].includes(mediaDirection)) {\n      if (remoteMedia.msid) {\n        const [streamId, trackId] = remoteMedia.msid.split(\" \");\n        transceiver.receiver.remoteStreamId = streamId;\n        transceiver.receiver.remoteTrackId = trackId;\n      }\n\n      this.onTrack.execute({\n        track: transceiver.receiver.track,\n        transceiver,\n        stream: new MediaStream({\n          id: transceiver.receiver.remoteStreamId,\n          tracks: [transceiver.receiver.track],\n        }),\n      });\n    }\n\n    if (remoteMedia.ssrc[0]?.ssrc) {\n      transceiver.receiver.setupTWCC(remoteMedia.ssrc[0].ssrc);\n    }\n  }\n\n  async getStats(selector?: MediaStreamTrack | null): Promise<RTCStats[]> {\n    const stats: RTCStats[] = [];\n\n    for (const transceiver of this.transceivers) {\n      const includeTransceiverStats =\n        !selector ||\n        transceiver.sender.track === selector ||\n        transceiver.receiver.track === selector;\n\n      if (transceiver.sender) {\n        const senderStats = await transceiver.sender.getStats();\n        if (senderStats) {\n          for (const stat of senderStats) {\n            if (stat.type === \"outbound-rtp\" || stat.type === \"media-source\") {\n              if (includeTransceiverStats) {\n                stats.push(stat);\n              }\n            } else {\n              stats.push(stat);\n            }\n          }\n        }\n      }\n\n      if (transceiver.receiver) {\n        const receiverStats = await transceiver.receiver.getStats();\n        if (receiverStats) {\n          for (const stat of receiverStats) {\n            if (\n              stat.type === \"inbound-rtp\" ||\n              stat.type === \"remote-outbound-rtp\"\n            ) {\n              if (includeTransceiverStats) {\n                stats.push(stat);\n              }\n            } else {\n              stats.push(stat);\n            }\n          }\n        }\n      }\n\n      if (includeTransceiverStats) {\n        const codecStats = transceiver.getCodecStats();\n        if (codecStats) {\n          stats.push(...codecStats);\n        }\n      }\n    }\n\n    return stats;\n  }\n\n  /**\n   * receiver/senderstopclose\n   */\n  close() {\n    for (const transceiver of this.transceivers) {\n      transceiver.receiver.stop();\n      transceiver.sender.stop();\n    }\n\n    this.onTransceiverAdded.allUnsubscribe();\n    this.onRemoteTransceiverAdded.allUnsubscribe();\n    this.onTrack.allUnsubscribe();\n    this.onNegotiationNeeded.allUnsubscribe();\n  }\n}\n","'use strict';\n\nconst createFunction = require('generate-function');\nconst NotEnoughDataError = require('lib/not-enough-data-error');\n\n/**\n * Helps to read the whole data chunk.\n */\nclass Transaction {\n  /**\n   * @class Transaction\n   * @param {DecodeStream} stream\n   */\n  constructor(stream) {\n    this.stream = stream;\n    this.index = 0;\n  }\n\n  /**\n   * @param {Buffer} buf\n   */\n  append(buf) {\n    this.stream.append(buf);\n  }\n\n  /**\n   * Confirm reading and removes data from stream.\n   */\n  commit() {\n    this.stream.consume(this.index);\n  }\n\n  /**\n   * Get byte from stream by index.\n   * @param {number} i\n   * @returns {number}\n   */\n  get(i = 0) {\n    return this.stream.get(this.index + i);\n  }\n\n  /**\n   * Get the number of bytes in stream.\n   * @returns {number}\n   */\n  get length() {\n    return this.stream.length;\n  }\n\n  /**\n   * @param {number} [start]\n   * @param {number} [end]\n   * @returns {Buffer}\n   */\n  slice(start, end) {\n    return this.stream.slice(start, end);\n  }\n\n  /**\n   * @param {string} encoding\n   * @param {number} [start]\n   * @param {number} [end]\n   * @returns {string}\n   */\n  toString(encoding, start, end) {\n    return this.stream.toString(encoding, start, end);\n  }\n\n  /**\n   * Read provided amount of bytes from stream.\n   * @param {number} size\n   * @returns {Buffer}\n   */\n  readBuffer(size) {\n    assertSize(this.index + size, this.length);\n\n    const buf = this.stream.slice(this.index, this.index + size);\n    this.index += size;\n\n    return buf;\n  }\n\n  /**\n   * @param {number} byte\n   * @param {number} [offset]\n   * @returns {number}\n   */\n  indexOf(byte, offset = 0) {\n    return this.stream.indexOf(byte, this.index + offset) - this.index;\n  }\n}\n\nconst methods = {\n  readDoubleBE: 8,\n  readDoubleLE: 8,\n  readFloatBE: 4,\n  readFloatLE: 4,\n  readInt32BE: 4,\n  readInt32LE: 4,\n  readUInt32BE: 4,\n  readUInt32LE: 4,\n  readInt16BE: 2,\n  readInt16LE: 2,\n  readUInt16BE: 2,\n  readUInt16LE: 2,\n  readInt8: 1,\n  readUInt8: 1,\n};\n\nObject.keys(methods).forEach(method => {\n  const gen = createFunction();\n  const bytes = methods[method];\n\n  gen(`\n    function transaction_${method}() {\n      assertSize(this.index + ${gen.formats.d(bytes)}, this.length);\n      const value = this.stream.buffer.${method}(this.index);\n      this.index += ${gen.formats.d(bytes)};\n      return value;\n    }\n  `);\n\n  Transaction.prototype[method] = gen.toFunction({ assertSize });\n});\n\n['readIntBE', 'readIntLE', 'readUIntBE', 'readUIntLE'].forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function transaction_${method}(bytes) {\n      assertSize(this.index + bytes, this.length);\n      const value = this.stream.buffer.${method}(bytes, this.index);\n      this.index += bytes;\n      return value;\n    }\n  `);\n\n  Transaction.prototype[method] = gen.toFunction({ assertSize });\n});\n\nmodule.exports = Transaction;\n\n/**\n * Check if stream is able to read requested amound of data.\n * @param {number} size Requested data size to read.\n * @param {number} length The number of bytes in stream.\n */\nfunction assertSize(size, length) {\n  if (size > length) {\n    throw new NotEnoughDataError(size, length);\n  }\n}\n","import { SessionType } from \"./cipher/suites/abstract\";\nimport { Flight1 } from \"./flight/client/flight1\";\nimport { Flight3 } from \"./flight/client/flight3\";\nimport { Flight5 } from \"./flight/client/flight5\";\nimport { HandshakeType } from \"./handshake/const\";\nimport { ServerHelloVerifyRequest } from \"./handshake/message/server/helloVerifyRequest\";\nimport { debug } from \"./imports/common\";\nimport type { FragmentedHandshake } from \"./record/message/fragment\";\nimport { DtlsSocket, type Options } from \"./socket\";\n\nconst log = debug(\"werift-dtls : packages/dtls/src/client.ts : log\");\n\nexport class DtlsClient extends DtlsSocket {\n  constructor(options: Options) {\n    super(options, SessionType.CLIENT);\n    this.onHandleHandshakes = this.handleHandshakes;\n    log(this.dtls.sessionId, \"start client\");\n  }\n\n  async connect() {\n    await new Flight1(this.transport, this.dtls, this.cipher).exec(\n      this.extensions,\n    );\n  }\n\n  private flight5?: Flight5;\n  private handleHandshakes = async (assembled: FragmentedHandshake[]) => {\n    log(\n      this.dtls.sessionId,\n      \"handleHandshakes\",\n      assembled.map((a) => a.msg_type),\n    );\n\n    for (const handshake of assembled) {\n      switch (handshake.msg_type) {\n        // flight2\n        case HandshakeType.hello_verify_request_3:\n          {\n            const verifyReq = ServerHelloVerifyRequest.deSerialize(\n              handshake.fragment,\n            );\n            await new Flight3(this.transport, this.dtls).exec(verifyReq);\n          }\n          break;\n        // flight 4\n        case HandshakeType.server_hello_2:\n          {\n            if (this.connected) return;\n            this.flight5 = new Flight5(\n              this.transport,\n              this.dtls,\n              this.cipher,\n              this.srtp,\n            );\n            this.flight5.handleHandshake(handshake);\n          }\n          break;\n        case HandshakeType.certificate_11:\n        case HandshakeType.server_key_exchange_12:\n        case HandshakeType.certificate_request_13:\n          {\n            await this.waitForReady(() => !!this.flight5);\n            this.flight5?.handleHandshake(handshake);\n          }\n          break;\n        case HandshakeType.server_hello_done_14:\n          {\n            await this.waitForReady(() => !!this.flight5);\n            this.flight5?.handleHandshake(handshake);\n\n            const targets = [\n              11,\n              12,\n              this.options.certificateRequest && 13,\n            ].filter((n): n is number => typeof n === \"number\");\n            await this.waitForReady(() =>\n              this.dtls.checkHandshakesExist(targets),\n            );\n            await this.flight5?.exec();\n          }\n          break;\n        // flight 6\n        case HandshakeType.finished_20:\n          {\n            this.dtls.flight = 7;\n            this.connected = true;\n            this.onConnect.execute();\n            log(this.dtls.sessionId, \"dtls connected\");\n          }\n          break;\n      }\n    }\n  };\n}\n","import { createSign, randomBytes, webcrypto } from \"crypto\";\nimport { Certificate, PrivateKey } from \"@fidm/x509\";\nimport * as x509 from \"@peculiar/x509\";\nimport { encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport {\n  type CipherSuites,\n  CurveType,\n  HashAlgorithm,\n  NamedCurveAlgorithm,\n  type NamedCurveAlgorithms,\n  SignatureAlgorithm,\n  type SignatureHash,\n} from \"../cipher/const\";\nimport type { NamedCurveKeyPair } from \"../cipher/namedCurve\";\nimport { prfVerifyDataClient, prfVerifyDataServer } from \"../cipher/prf\";\nimport { SessionType, type SessionTypes } from \"../cipher/suites/abstract\";\nimport type AEADCipher from \"../cipher/suites/aead\";\nimport type { DtlsRandom } from \"../handshake/random\";\nimport type { DtlsPlaintext } from \"../record/message/plaintext\";\n\nconst crypto = webcrypto;\nx509.cryptoProvider.set(crypto as any);\n\nexport class CipherContext {\n  localRandom!: DtlsRandom;\n  remoteRandom!: DtlsRandom;\n  cipherSuite!: CipherSuites;\n  remoteCertificate?: Buffer;\n  remoteKeyPair!: Partial<NamedCurveKeyPair>;\n  localKeyPair!: NamedCurveKeyPair;\n  masterSecret!: Buffer;\n  cipher!: AEADCipher;\n  namedCurve!: NamedCurveAlgorithms;\n  signatureHashAlgorithm?: SignatureHash;\n  localCert!: Buffer;\n  localPrivateKey!: PrivateKey;\n\n  constructor(\n    public sessionType: SessionTypes,\n    public certPem?: string,\n    public keyPem?: string,\n    signatureHashAlgorithm?: SignatureHash,\n  ) {\n    if (certPem && keyPem && signatureHashAlgorithm) {\n      this.parseX509(certPem, keyPem, signatureHashAlgorithm);\n    }\n  }\n\n  /**\n   *\n   * @param signatureHash\n   * @param namedCurveAlgorithm necessary when use ecdsa\n   */\n  static createSelfSignedCertificateWithKey = async (\n    signatureHash: SignatureHash,\n    namedCurveAlgorithm?: NamedCurveAlgorithms,\n  ) => {\n    const signatureAlgorithmName = (() => {\n      switch (signatureHash.signature) {\n        case SignatureAlgorithm.rsa_1:\n          return \"RSASSA-PKCS1-v1_5\";\n        case SignatureAlgorithm.ecdsa_3:\n          return \"ECDSA\";\n      }\n    })();\n    const hash = (() => {\n      switch (signatureHash.hash) {\n        case HashAlgorithm.sha256_4:\n          return \"SHA-256\";\n      }\n    })();\n    const namedCurve = (() => {\n      switch (namedCurveAlgorithm) {\n        case NamedCurveAlgorithm.secp256r1_23:\n          return \"P-256\";\n        case NamedCurveAlgorithm.x25519_29:\n          // todo fix (X25519 not supported with ECDSA)\n          if (signatureAlgorithmName === \"ECDSA\") {\n            return \"P-256\";\n          }\n          return \"X25519\";\n        default: {\n          if (signatureAlgorithmName === \"ECDSA\") return \"P-256\";\n          if (signatureAlgorithmName === \"RSASSA-PKCS1-v1_5\") return \"X25519\";\n        }\n      }\n    })();\n    const alg = (() => {\n      switch (signatureAlgorithmName) {\n        case \"ECDSA\":\n          return { name: signatureAlgorithmName, hash, namedCurve };\n        case \"RSASSA-PKCS1-v1_5\":\n          return {\n            name: signatureAlgorithmName,\n            hash,\n            publicExponent: new Uint8Array([1, 0, 1]),\n            modulusLength: 2048,\n          };\n      }\n    })();\n\n    const keys = (await crypto.subtle.generateKey(alg, true, [\n      \"sign\",\n      \"verify\",\n    ])) as webcrypto.CryptoKeyPair;\n\n    const cert = await x509.X509CertificateGenerator.createSelfSigned({\n      serialNumber: randomBytes(8).toString(\"hex\"),\n      name: \"C=AU, ST=Some-State, O=Internet Widgits Pty Ltd\",\n      notBefore: new Date(),\n      notAfter: new Date(Date.now() + 10 * 365 * 24 * 60 * 60 * 1000),\n      signingAlgorithm: alg,\n      keys,\n    });\n\n    const certPem = cert.toString(\"pem\");\n    const keyPem = x509.PemConverter.encode(\n      await crypto.subtle.exportKey(\"pkcs8\", keys.privateKey as any),\n      \"private key\",\n    );\n\n    return { certPem, keyPem, signatureHash };\n  };\n\n  encryptPacket(pkt: DtlsPlaintext) {\n    const header = pkt.recordLayerHeader;\n    const version =\n      (header.protocolVersion.major << 8) | header.protocolVersion.minor;\n    const enc = this.cipher.encrypt(this.sessionType, pkt.fragment, {\n      type: header.contentType,\n      version,\n      epoch: header.epoch,\n      sequenceNumber: header.sequenceNumber,\n    });\n    pkt.fragment = enc;\n    pkt.recordLayerHeader.contentLen = enc.length;\n    return pkt;\n  }\n\n  decryptPacket(pkt: DtlsPlaintext) {\n    const header = pkt.recordLayerHeader;\n    const version =\n      (header.protocolVersion.major << 8) | header.protocolVersion.minor;\n    const dec = this.cipher.decrypt(this.sessionType, pkt.fragment, {\n      type: header.contentType,\n      version,\n      epoch: header.epoch,\n      sequenceNumber: header.sequenceNumber,\n    });\n    return dec;\n  }\n\n  verifyData(buf: Buffer) {\n    if (this.sessionType === SessionType.CLIENT)\n      return prfVerifyDataClient(this.masterSecret, buf);\n    else return prfVerifyDataServer(this.masterSecret, buf);\n  }\n\n  signatureData(data: Buffer, hash: string) {\n    const signature = createSign(hash).update(data);\n    const key = this.localPrivateKey.toPEM().toString();\n    const signed = signature.sign(key);\n    return signed;\n  }\n\n  generateKeySignature(hashAlgorithm: string) {\n    const clientRandom =\n      this.sessionType === SessionType.CLIENT\n        ? this.localRandom\n        : this.remoteRandom;\n    const serverRandom =\n      this.sessionType === SessionType.SERVER\n        ? this.localRandom\n        : this.remoteRandom;\n\n    const sig = this.valueKeySignature(\n      clientRandom.serialize(),\n      serverRandom.serialize(),\n      this.localKeyPair.publicKey,\n      this.namedCurve,\n    );\n\n    const enc = this.localPrivateKey.sign(sig, hashAlgorithm);\n    return enc;\n  }\n\n  parseX509(certPem: string, keyPem: string, signatureHash: SignatureHash) {\n    const cert = Certificate.fromPEM(Buffer.from(certPem));\n    const sec = PrivateKey.fromPEM(Buffer.from(keyPem));\n    this.localCert = cert.raw;\n    this.localPrivateKey = sec;\n    this.signatureHashAlgorithm = signatureHash;\n  }\n\n  private valueKeySignature(\n    clientRandom: Buffer,\n    serverRandom: Buffer,\n    publicKey: Buffer,\n    namedCurve: number,\n  ) {\n    const serverParams = Buffer.from(\n      encode(\n        {\n          type: CurveType.named_curve_3,\n          curve: namedCurve,\n          len: publicKey.length,\n        },\n        { type: types.uint8, curve: types.uint16be, len: types.uint8 },\n      ).slice(),\n    );\n    return Buffer.concat([clientRandom, serverRandom, serverParams, publicKey]);\n  }\n}\n","module.exports = require(\"node:crypto\");","import type { Transport } from \"../imports/common\";\n\nexport class TransportContext {\n  constructor(public socket: Transport) {}\n\n  readonly send = (buf: Buffer) => {\n    return this.socket.send(buf);\n  };\n}\n","export { sleep } from \"../../server/src/sleep\";\n","import type { RTCPFB } from \"../parameters\";\n\nexport const useFIR = (): RTCPFB => ({ type: \"ccm\", parameter: \"fir\" });\n\nexport const useNACK = (): RTCPFB => ({ type: \"nack\" });\n\nexport const usePLI = (): RTCPFB => ({ type: \"nack\", parameter: \"pli\" });\n\nexport const useREMB = (): RTCPFB => ({ type: \"goog-remb\" });\n\nexport const useTWCC = (): RTCPFB => ({ type: \"transport-cc\" });\n","import { debug } from \"../imports/common\";\nimport { RTCP_HEADER_SIZE, RtcpHeader } from \"./header\";\nimport { RtcpPayloadSpecificFeedback } from \"./psfb\";\nimport { RtcpRrPacket } from \"./rr\";\nimport { RtcpTransportLayerFeedback } from \"./rtpfb\";\nimport { RtcpSourceDescriptionPacket } from \"./sdes\";\nimport { RtcpSrPacket } from \"./sr\";\n\nconst log = debug(\"werift-rtp:packages/rtp/src/rtcp/rtcp.ts\");\n\nexport type RtcpPacket =\n  | RtcpRrPacket\n  | RtcpSrPacket\n  | RtcpPayloadSpecificFeedback\n  | RtcpSourceDescriptionPacket\n  | RtcpTransportLayerFeedback;\n\nexport class RtcpPacketConverter {\n  static deSerialize(data: Buffer) {\n    let pos = 0;\n    const packets: RtcpPacket[] = [];\n\n    while (pos < data.length) {\n      const header = RtcpHeader.deSerialize(\n        data.subarray(pos, pos + RTCP_HEADER_SIZE),\n      );\n      pos += RTCP_HEADER_SIZE;\n\n      let payload = data.subarray(pos);\n      pos += header.length * 4;\n\n      if (header.padding) {\n        payload = payload.subarray(0, payload.length - payload.subarray(-1)[0]);\n      }\n\n      try {\n        switch (header.type) {\n          case RtcpSrPacket.type:\n            packets.push(RtcpSrPacket.deSerialize(payload, header.count));\n            break;\n          case RtcpRrPacket.type:\n            packets.push(RtcpRrPacket.deSerialize(payload, header.count));\n            break;\n          case RtcpSourceDescriptionPacket.type:\n            packets.push(\n              RtcpSourceDescriptionPacket.deSerialize(payload, header),\n            );\n            break;\n          case RtcpTransportLayerFeedback.type:\n            packets.push(\n              RtcpTransportLayerFeedback.deSerialize(payload, header),\n            );\n            break;\n          case RtcpPayloadSpecificFeedback.type:\n            packets.push(\n              RtcpPayloadSpecificFeedback.deSerialize(payload, header),\n            );\n            break;\n          default:\n            // log(\"unknown rtcp packet\", header.type);\n            break;\n        }\n      } catch (error) {\n        log(\"deSerialize RTCP\", error);\n      }\n    }\n\n    return packets;\n  }\n}\n\nexport function isRtcp(buf: Buffer) {\n  return buf.length >= 2 && buf[1] >= 192 && buf[1] <= 208;\n}\n","export * from \"./imports/common\";\nexport * from \"./imports/dtls\";\nexport * from \"./imports/ice\";\nexport * from \"./imports/rtp\";\nexport * from \"./dataChannel\";\nexport * from \"./media\";\nexport * from \"./peerConnection\";\nexport * from \"./sdp\";\nexport * from \"./transport/dtls\";\nexport * from \"./transport/ice\";\nexport * from \"./transport/sctp\";\nexport * from \"./types/domain\";\nexport * from \"./utils\";\nexport * from \"./sdpManager\";\n","import { Event, UdpTransport, debug } from \"../imports/common\";\n\nimport type { Address, InterfaceAddresses } from \"../../../common/src/network\";\nimport type { Candidate } from \"../candidate\";\n\nimport type { Protocol } from \"../types/model\";\nimport { classes } from \"./const\";\nimport { type Message, parseMessage } from \"./message\";\nimport { Transaction } from \"./transaction\";\n\nconst log = debug(\"werift-ice : packages/ice/src/stun/protocol.ts\");\n\nexport class StunProtocol implements Protocol {\n  static readonly type = \"stun\";\n  readonly type = StunProtocol.type;\n  transport!: UdpTransport;\n  transactions: { [key: string]: Transaction } = {};\n  get transactionsKeys() {\n    return Object.keys(this.transactions);\n  }\n  localCandidate?: Candidate;\n  sentMessage?: Message;\n  localIp?: string;\n\n  readonly onRequestReceived = new Event<[Message, Address, Buffer]>();\n  readonly onDataReceived = new Event<[Buffer]>();\n\n  constructor() {}\n\n  connectionMade = async (\n    useIpv4: boolean,\n    portRange?: [number, number],\n    interfaceAddresses?: InterfaceAddresses,\n  ) => {\n    if (useIpv4) {\n      this.transport = await UdpTransport.init(\"udp4\", {\n        portRange,\n        interfaceAddresses,\n      });\n    } else {\n      this.transport = await UdpTransport.init(\"udp6\", {\n        portRange,\n        interfaceAddresses,\n      });\n    }\n\n    this.transport.onData = (data, addr) => {\n      this.datagramReceived(data, addr);\n    };\n  };\n\n  private datagramReceived(data: Buffer, addr: Address) {\n    try {\n      const message = parseMessage(data);\n      if (!message) {\n        if (this.localCandidate) {\n          this.onDataReceived.execute(data);\n        }\n        return;\n      }\n      // log(\"parseMessage\", addr, message.toJSON());\n      if (\n        (message.messageClass === classes.RESPONSE ||\n          message.messageClass === classes.ERROR) &&\n        this.transactionsKeys.includes(message.transactionIdHex)\n      ) {\n        const transaction = this.transactions[message.transactionIdHex];\n        transaction.responseReceived(message, addr);\n      } else if (message.messageClass === classes.REQUEST) {\n        this.onRequestReceived.execute(message, addr, data);\n      }\n    } catch (error) {\n      log(\"datagramReceived error\", error);\n    }\n  }\n\n  getExtraInfo(): Address {\n    const { address: host, port } = this.transport.address;\n    return [host, port];\n  }\n\n  async sendStun(message: Message, addr: Address) {\n    if (this.transport.closed) {\n      return;\n    }\n\n    const data = message.bytes;\n    await this.transport.send(data, addr).catch(() => {\n      log(\"sendStun failed\", addr, message);\n    });\n  }\n\n  async sendData(data: Buffer, addr: Address) {\n    if (this.transport.closed) {\n      return;\n    }\n\n    await this.transport.send(data, addr);\n  }\n\n  async request(\n    request: Message,\n    addr: Address,\n    integrityKey?: Buffer,\n    retransmissions?: number,\n  ) {\n    // \"\"\"\n    // Execute a STUN transaction and return the response.\n    // \"\"\"\n    if (this.transactionsKeys.includes(request.transactionIdHex))\n      throw new Error(\"already request ed\");\n\n    if (integrityKey) {\n      request.addMessageIntegrity(integrityKey);\n      request.addFingerprint();\n    }\n\n    const transaction: Transaction = new Transaction(\n      request,\n      addr,\n      this,\n      retransmissions,\n    );\n    this.transactions[request.transactionIdHex] = transaction;\n\n    try {\n      return await transaction.run();\n    } catch (e) {\n      throw e;\n    } finally {\n      delete this.transactions[request.transactionIdHex];\n    }\n  }\n\n  async close() {\n    Object.values(this.transactions).forEach((transaction) => {\n      transaction.cancel();\n    });\n    await this.transport.close();\n    this.onRequestReceived.complete();\n    this.onDataReceived.complete();\n  }\n}\n","/*!\n * MIT License\n * \n * Copyright (c) 2017-2024 Peculiar Ventures, LLC\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * \n */\n\nconst ARRAY_BUFFER_NAME = \"[object ArrayBuffer]\";\nclass BufferSourceConverter {\n    static isArrayBuffer(data) {\n        return Object.prototype.toString.call(data) === ARRAY_BUFFER_NAME;\n    }\n    static toArrayBuffer(data) {\n        if (this.isArrayBuffer(data)) {\n            return data;\n        }\n        if (data.byteLength === data.buffer.byteLength) {\n            return data.buffer;\n        }\n        if (data.byteOffset === 0 && data.byteLength === data.buffer.byteLength) {\n            return data.buffer;\n        }\n        return this.toUint8Array(data.buffer)\n            .slice(data.byteOffset, data.byteOffset + data.byteLength)\n            .buffer;\n    }\n    static toUint8Array(data) {\n        return this.toView(data, Uint8Array);\n    }\n    static toView(data, type) {\n        if (data.constructor === type) {\n            return data;\n        }\n        if (this.isArrayBuffer(data)) {\n            return new type(data);\n        }\n        if (this.isArrayBufferView(data)) {\n            return new type(data.buffer, data.byteOffset, data.byteLength);\n        }\n        throw new TypeError(\"The provided value is not of type '(ArrayBuffer or ArrayBufferView)'\");\n    }\n    static isBufferSource(data) {\n        return this.isArrayBufferView(data)\n            || this.isArrayBuffer(data);\n    }\n    static isArrayBufferView(data) {\n        return ArrayBuffer.isView(data)\n            || (data && this.isArrayBuffer(data.buffer));\n    }\n    static isEqual(a, b) {\n        const aView = BufferSourceConverter.toUint8Array(a);\n        const bView = BufferSourceConverter.toUint8Array(b);\n        if (aView.length !== bView.byteLength) {\n            return false;\n        }\n        for (let i = 0; i < aView.length; i++) {\n            if (aView[i] !== bView[i]) {\n                return false;\n            }\n        }\n        return true;\n    }\n    static concat(...args) {\n        let buffers;\n        if (Array.isArray(args[0]) && !(args[1] instanceof Function)) {\n            buffers = args[0];\n        }\n        else if (Array.isArray(args[0]) && args[1] instanceof Function) {\n            buffers = args[0];\n        }\n        else {\n            if (args[args.length - 1] instanceof Function) {\n                buffers = args.slice(0, args.length - 1);\n            }\n            else {\n                buffers = args;\n            }\n        }\n        let size = 0;\n        for (const buffer of buffers) {\n            size += buffer.byteLength;\n        }\n        const res = new Uint8Array(size);\n        let offset = 0;\n        for (const buffer of buffers) {\n            const view = this.toUint8Array(buffer);\n            res.set(view, offset);\n            offset += view.length;\n        }\n        if (args[args.length - 1] instanceof Function) {\n            return this.toView(res, args[args.length - 1]);\n        }\n        return res.buffer;\n    }\n}\n\nconst STRING_TYPE = \"string\";\nconst HEX_REGEX = /^[0-9a-f\\s]+$/i;\nconst BASE64_REGEX = /^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/;\nconst BASE64URL_REGEX = /^[a-zA-Z0-9-_]+$/;\nclass Utf8Converter {\n    static fromString(text) {\n        const s = unescape(encodeURIComponent(text));\n        const uintArray = new Uint8Array(s.length);\n        for (let i = 0; i < s.length; i++) {\n            uintArray[i] = s.charCodeAt(i);\n        }\n        return uintArray.buffer;\n    }\n    static toString(buffer) {\n        const buf = BufferSourceConverter.toUint8Array(buffer);\n        let encodedString = \"\";\n        for (let i = 0; i < buf.length; i++) {\n            encodedString += String.fromCharCode(buf[i]);\n        }\n        const decodedString = decodeURIComponent(escape(encodedString));\n        return decodedString;\n    }\n}\nclass Utf16Converter {\n    static toString(buffer, littleEndian = false) {\n        const arrayBuffer = BufferSourceConverter.toArrayBuffer(buffer);\n        const dataView = new DataView(arrayBuffer);\n        let res = \"\";\n        for (let i = 0; i < arrayBuffer.byteLength; i += 2) {\n            const code = dataView.getUint16(i, littleEndian);\n            res += String.fromCharCode(code);\n        }\n        return res;\n    }\n    static fromString(text, littleEndian = false) {\n        const res = new ArrayBuffer(text.length * 2);\n        const dataView = new DataView(res);\n        for (let i = 0; i < text.length; i++) {\n            dataView.setUint16(i * 2, text.charCodeAt(i), littleEndian);\n        }\n        return res;\n    }\n}\nclass Convert {\n    static isHex(data) {\n        return typeof data === STRING_TYPE\n            && HEX_REGEX.test(data);\n    }\n    static isBase64(data) {\n        return typeof data === STRING_TYPE\n            && BASE64_REGEX.test(data);\n    }\n    static isBase64Url(data) {\n        return typeof data === STRING_TYPE\n            && BASE64URL_REGEX.test(data);\n    }\n    static ToString(buffer, enc = \"utf8\") {\n        const buf = BufferSourceConverter.toUint8Array(buffer);\n        switch (enc.toLowerCase()) {\n            case \"utf8\":\n                return this.ToUtf8String(buf);\n            case \"binary\":\n                return this.ToBinary(buf);\n            case \"hex\":\n                return this.ToHex(buf);\n            case \"base64\":\n                return this.ToBase64(buf);\n            case \"base64url\":\n                return this.ToBase64Url(buf);\n            case \"utf16le\":\n                return Utf16Converter.toString(buf, true);\n            case \"utf16\":\n            case \"utf16be\":\n                return Utf16Converter.toString(buf);\n            default:\n                throw new Error(`Unknown type of encoding '${enc}'`);\n        }\n    }\n    static FromString(str, enc = \"utf8\") {\n        if (!str) {\n            return new ArrayBuffer(0);\n        }\n        switch (enc.toLowerCase()) {\n            case \"utf8\":\n                return this.FromUtf8String(str);\n            case \"binary\":\n                return this.FromBinary(str);\n            case \"hex\":\n                return this.FromHex(str);\n            case \"base64\":\n                return this.FromBase64(str);\n            case \"base64url\":\n                return this.FromBase64Url(str);\n            case \"utf16le\":\n                return Utf16Converter.fromString(str, true);\n            case \"utf16\":\n            case \"utf16be\":\n                return Utf16Converter.fromString(str);\n            default:\n                throw new Error(`Unknown type of encoding '${enc}'`);\n        }\n    }\n    static ToBase64(buffer) {\n        const buf = BufferSourceConverter.toUint8Array(buffer);\n        if (typeof btoa !== \"undefined\") {\n            const binary = this.ToString(buf, \"binary\");\n            return btoa(binary);\n        }\n        else {\n            return Buffer.from(buf).toString(\"base64\");\n        }\n    }\n    static FromBase64(base64) {\n        const formatted = this.formatString(base64);\n        if (!formatted) {\n            return new ArrayBuffer(0);\n        }\n        if (!Convert.isBase64(formatted)) {\n            throw new TypeError(\"Argument 'base64Text' is not Base64 encoded\");\n        }\n        if (typeof atob !== \"undefined\") {\n            return this.FromBinary(atob(formatted));\n        }\n        else {\n            return new Uint8Array(Buffer.from(formatted, \"base64\")).buffer;\n        }\n    }\n    static FromBase64Url(base64url) {\n        const formatted = this.formatString(base64url);\n        if (!formatted) {\n            return new ArrayBuffer(0);\n        }\n        if (!Convert.isBase64Url(formatted)) {\n            throw new TypeError(\"Argument 'base64url' is not Base64Url encoded\");\n        }\n        return this.FromBase64(this.Base64Padding(formatted.replace(/\\-/g, \"+\").replace(/\\_/g, \"/\")));\n    }\n    static ToBase64Url(data) {\n        return this.ToBase64(data).replace(/\\+/g, \"-\").replace(/\\//g, \"_\").replace(/\\=/g, \"\");\n    }\n    static FromUtf8String(text, encoding = Convert.DEFAULT_UTF8_ENCODING) {\n        switch (encoding) {\n            case \"ascii\":\n                return this.FromBinary(text);\n            case \"utf8\":\n                return Utf8Converter.fromString(text);\n            case \"utf16\":\n            case \"utf16be\":\n                return Utf16Converter.fromString(text);\n            case \"utf16le\":\n            case \"usc2\":\n                return Utf16Converter.fromString(text, true);\n            default:\n                throw new Error(`Unknown type of encoding '${encoding}'`);\n        }\n    }\n    static ToUtf8String(buffer, encoding = Convert.DEFAULT_UTF8_ENCODING) {\n        switch (encoding) {\n            case \"ascii\":\n                return this.ToBinary(buffer);\n            case \"utf8\":\n                return Utf8Converter.toString(buffer);\n            case \"utf16\":\n            case \"utf16be\":\n                return Utf16Converter.toString(buffer);\n            case \"utf16le\":\n            case \"usc2\":\n                return Utf16Converter.toString(buffer, true);\n            default:\n                throw new Error(`Unknown type of encoding '${encoding}'`);\n        }\n    }\n    static FromBinary(text) {\n        const stringLength = text.length;\n        const resultView = new Uint8Array(stringLength);\n        for (let i = 0; i < stringLength; i++) {\n            resultView[i] = text.charCodeAt(i);\n        }\n        return resultView.buffer;\n    }\n    static ToBinary(buffer) {\n        const buf = BufferSourceConverter.toUint8Array(buffer);\n        let res = \"\";\n        for (let i = 0; i < buf.length; i++) {\n            res += String.fromCharCode(buf[i]);\n        }\n        return res;\n    }\n    static ToHex(buffer) {\n        const buf = BufferSourceConverter.toUint8Array(buffer);\n        let result = \"\";\n        const len = buf.length;\n        for (let i = 0; i < len; i++) {\n            const byte = buf[i];\n            if (byte < 16) {\n                result += \"0\";\n            }\n            result += byte.toString(16);\n        }\n        return result;\n    }\n    static FromHex(hexString) {\n        let formatted = this.formatString(hexString);\n        if (!formatted) {\n            return new ArrayBuffer(0);\n        }\n        if (!Convert.isHex(formatted)) {\n            throw new TypeError(\"Argument 'hexString' is not HEX encoded\");\n        }\n        if (formatted.length % 2) {\n            formatted = `0${formatted}`;\n        }\n        const res = new Uint8Array(formatted.length / 2);\n        for (let i = 0; i < formatted.length; i = i + 2) {\n            const c = formatted.slice(i, i + 2);\n            res[i / 2] = parseInt(c, 16);\n        }\n        return res.buffer;\n    }\n    static ToUtf16String(buffer, littleEndian = false) {\n        return Utf16Converter.toString(buffer, littleEndian);\n    }\n    static FromUtf16String(text, littleEndian = false) {\n        return Utf16Converter.fromString(text, littleEndian);\n    }\n    static Base64Padding(base64) {\n        const padCount = 4 - (base64.length % 4);\n        if (padCount < 4) {\n            for (let i = 0; i < padCount; i++) {\n                base64 += \"=\";\n            }\n        }\n        return base64;\n    }\n    static formatString(data) {\n        return (data === null || data === void 0 ? void 0 : data.replace(/[\\n\\r\\t ]/g, \"\")) || \"\";\n    }\n}\nConvert.DEFAULT_UTF8_ENCODING = \"utf8\";\n\nfunction assign(target, ...sources) {\n    const res = arguments[0];\n    for (let i = 1; i < arguments.length; i++) {\n        const obj = arguments[i];\n        for (const prop in obj) {\n            res[prop] = obj[prop];\n        }\n    }\n    return res;\n}\nfunction combine(...buf) {\n    const totalByteLength = buf.map((item) => item.byteLength).reduce((prev, cur) => prev + cur);\n    const res = new Uint8Array(totalByteLength);\n    let currentPos = 0;\n    buf.map((item) => new Uint8Array(item)).forEach((arr) => {\n        for (const item2 of arr) {\n            res[currentPos++] = item2;\n        }\n    });\n    return res.buffer;\n}\nfunction isEqual(bytes1, bytes2) {\n    if (!(bytes1 && bytes2)) {\n        return false;\n    }\n    if (bytes1.byteLength !== bytes2.byteLength) {\n        return false;\n    }\n    const b1 = new Uint8Array(bytes1);\n    const b2 = new Uint8Array(bytes2);\n    for (let i = 0; i < bytes1.byteLength; i++) {\n        if (b1[i] !== b2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n\nexport { BufferSourceConverter, Convert, assign, combine, isEqual };\n","/*!\n Copyright (c) Peculiar Ventures, LLC\n*/\n\nfunction getUTCDate(date) {\r\n    return new Date(date.getTime() + (date.getTimezoneOffset() * 60000));\r\n}\r\nfunction getParametersValue(parameters, name, defaultValue) {\r\n    var _a;\r\n    if ((parameters instanceof Object) === false) {\r\n        return defaultValue;\r\n    }\r\n    return (_a = parameters[name]) !== null && _a !== void 0 ? _a : defaultValue;\r\n}\r\nfunction bufferToHexCodes(inputBuffer, inputOffset = 0, inputLength = (inputBuffer.byteLength - inputOffset), insertSpace = false) {\r\n    let result = \"\";\r\n    for (const item of (new Uint8Array(inputBuffer, inputOffset, inputLength))) {\r\n        const str = item.toString(16).toUpperCase();\r\n        if (str.length === 1) {\r\n            result += \"0\";\r\n        }\r\n        result += str;\r\n        if (insertSpace) {\r\n            result += \" \";\r\n        }\r\n    }\r\n    return result.trim();\r\n}\r\nfunction checkBufferParams(baseBlock, inputBuffer, inputOffset, inputLength) {\r\n    if (!(inputBuffer instanceof ArrayBuffer)) {\r\n        baseBlock.error = \"Wrong parameter: inputBuffer must be \\\"ArrayBuffer\\\"\";\r\n        return false;\r\n    }\r\n    if (!inputBuffer.byteLength) {\r\n        baseBlock.error = \"Wrong parameter: inputBuffer has zero length\";\r\n        return false;\r\n    }\r\n    if (inputOffset < 0) {\r\n        baseBlock.error = \"Wrong parameter: inputOffset less than zero\";\r\n        return false;\r\n    }\r\n    if (inputLength < 0) {\r\n        baseBlock.error = \"Wrong parameter: inputLength less than zero\";\r\n        return false;\r\n    }\r\n    if ((inputBuffer.byteLength - inputOffset - inputLength) < 0) {\r\n        baseBlock.error = \"End of input reached before message was fully decoded (inconsistent offset and length values)\";\r\n        return false;\r\n    }\r\n    return true;\r\n}\r\nfunction utilFromBase(inputBuffer, inputBase) {\r\n    let result = 0;\r\n    if (inputBuffer.length === 1) {\r\n        return inputBuffer[0];\r\n    }\r\n    for (let i = (inputBuffer.length - 1); i >= 0; i--) {\r\n        result += inputBuffer[(inputBuffer.length - 1) - i] * Math.pow(2, inputBase * i);\r\n    }\r\n    return result;\r\n}\r\nfunction utilToBase(value, base, reserved = (-1)) {\r\n    const internalReserved = reserved;\r\n    let internalValue = value;\r\n    let result = 0;\r\n    let biggest = Math.pow(2, base);\r\n    for (let i = 1; i < 8; i++) {\r\n        if (value < biggest) {\r\n            let retBuf;\r\n            if (internalReserved < 0) {\r\n                retBuf = new ArrayBuffer(i);\r\n                result = i;\r\n            }\r\n            else {\r\n                if (internalReserved < i) {\r\n                    return (new ArrayBuffer(0));\r\n                }\r\n                retBuf = new ArrayBuffer(internalReserved);\r\n                result = internalReserved;\r\n            }\r\n            const retView = new Uint8Array(retBuf);\r\n            for (let j = (i - 1); j >= 0; j--) {\r\n                const basis = Math.pow(2, j * base);\r\n                retView[result - j - 1] = Math.floor(internalValue / basis);\r\n                internalValue -= (retView[result - j - 1]) * basis;\r\n            }\r\n            return retBuf;\r\n        }\r\n        biggest *= Math.pow(2, base);\r\n    }\r\n    return new ArrayBuffer(0);\r\n}\r\nfunction utilConcatBuf(...buffers) {\r\n    let outputLength = 0;\r\n    let prevLength = 0;\r\n    for (const buffer of buffers) {\r\n        outputLength += buffer.byteLength;\r\n    }\r\n    const retBuf = new ArrayBuffer(outputLength);\r\n    const retView = new Uint8Array(retBuf);\r\n    for (const buffer of buffers) {\r\n        retView.set(new Uint8Array(buffer), prevLength);\r\n        prevLength += buffer.byteLength;\r\n    }\r\n    return retBuf;\r\n}\r\nfunction utilConcatView(...views) {\r\n    let outputLength = 0;\r\n    let prevLength = 0;\r\n    for (const view of views) {\r\n        outputLength += view.length;\r\n    }\r\n    const retBuf = new ArrayBuffer(outputLength);\r\n    const retView = new Uint8Array(retBuf);\r\n    for (const view of views) {\r\n        retView.set(view, prevLength);\r\n        prevLength += view.length;\r\n    }\r\n    return retView;\r\n}\r\nfunction utilDecodeTC() {\r\n    const buf = new Uint8Array(this.valueHex);\r\n    if (this.valueHex.byteLength >= 2) {\r\n        const condition1 = (buf[0] === 0xFF) && (buf[1] & 0x80);\r\n        const condition2 = (buf[0] === 0x00) && ((buf[1] & 0x80) === 0x00);\r\n        if (condition1 || condition2) {\r\n            this.warnings.push(\"Needlessly long format\");\r\n        }\r\n    }\r\n    const bigIntBuffer = new ArrayBuffer(this.valueHex.byteLength);\r\n    const bigIntView = new Uint8Array(bigIntBuffer);\r\n    for (let i = 0; i < this.valueHex.byteLength; i++) {\r\n        bigIntView[i] = 0;\r\n    }\r\n    bigIntView[0] = (buf[0] & 0x80);\r\n    const bigInt = utilFromBase(bigIntView, 8);\r\n    const smallIntBuffer = new ArrayBuffer(this.valueHex.byteLength);\r\n    const smallIntView = new Uint8Array(smallIntBuffer);\r\n    for (let j = 0; j < this.valueHex.byteLength; j++) {\r\n        smallIntView[j] = buf[j];\r\n    }\r\n    smallIntView[0] &= 0x7F;\r\n    const smallInt = utilFromBase(smallIntView, 8);\r\n    return (smallInt - bigInt);\r\n}\r\nfunction utilEncodeTC(value) {\r\n    const modValue = (value < 0) ? (value * (-1)) : value;\r\n    let bigInt = 128;\r\n    for (let i = 1; i < 8; i++) {\r\n        if (modValue <= bigInt) {\r\n            if (value < 0) {\r\n                const smallInt = bigInt - modValue;\r\n                const retBuf = utilToBase(smallInt, 8, i);\r\n                const retView = new Uint8Array(retBuf);\r\n                retView[0] |= 0x80;\r\n                return retBuf;\r\n            }\r\n            let retBuf = utilToBase(modValue, 8, i);\r\n            let retView = new Uint8Array(retBuf);\r\n            if (retView[0] & 0x80) {\r\n                const tempBuf = retBuf.slice(0);\r\n                const tempView = new Uint8Array(tempBuf);\r\n                retBuf = new ArrayBuffer(retBuf.byteLength + 1);\r\n                retView = new Uint8Array(retBuf);\r\n                for (let k = 0; k < tempBuf.byteLength; k++) {\r\n                    retView[k + 1] = tempView[k];\r\n                }\r\n                retView[0] = 0x00;\r\n            }\r\n            return retBuf;\r\n        }\r\n        bigInt *= Math.pow(2, 8);\r\n    }\r\n    return (new ArrayBuffer(0));\r\n}\r\nfunction isEqualBuffer(inputBuffer1, inputBuffer2) {\r\n    if (inputBuffer1.byteLength !== inputBuffer2.byteLength) {\r\n        return false;\r\n    }\r\n    const view1 = new Uint8Array(inputBuffer1);\r\n    const view2 = new Uint8Array(inputBuffer2);\r\n    for (let i = 0; i < view1.length; i++) {\r\n        if (view1[i] !== view2[i]) {\r\n            return false;\r\n        }\r\n    }\r\n    return true;\r\n}\r\nfunction padNumber(inputNumber, fullLength) {\r\n    const str = inputNumber.toString(10);\r\n    if (fullLength < str.length) {\r\n        return \"\";\r\n    }\r\n    const dif = fullLength - str.length;\r\n    const padding = new Array(dif);\r\n    for (let i = 0; i < dif; i++) {\r\n        padding[i] = \"0\";\r\n    }\r\n    const paddingString = padding.join(\"\");\r\n    return paddingString.concat(str);\r\n}\r\nconst base64Template = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\r\nconst base64UrlTemplate = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=\";\r\nfunction toBase64(input, useUrlTemplate = false, skipPadding = false, skipLeadingZeros = false) {\r\n    let i = 0;\r\n    let flag1 = 0;\r\n    let flag2 = 0;\r\n    let output = \"\";\r\n    const template = (useUrlTemplate) ? base64UrlTemplate : base64Template;\r\n    if (skipLeadingZeros) {\r\n        let nonZeroPosition = 0;\r\n        for (let i = 0; i < input.length; i++) {\r\n            if (input.charCodeAt(i) !== 0) {\r\n                nonZeroPosition = i;\r\n                break;\r\n            }\r\n        }\r\n        input = input.slice(nonZeroPosition);\r\n    }\r\n    while (i < input.length) {\r\n        const chr1 = input.charCodeAt(i++);\r\n        if (i >= input.length) {\r\n            flag1 = 1;\r\n        }\r\n        const chr2 = input.charCodeAt(i++);\r\n        if (i >= input.length) {\r\n            flag2 = 1;\r\n        }\r\n        const chr3 = input.charCodeAt(i++);\r\n        const enc1 = chr1 >> 2;\r\n        const enc2 = ((chr1 & 0x03) << 4) | (chr2 >> 4);\r\n        let enc3 = ((chr2 & 0x0F) << 2) | (chr3 >> 6);\r\n        let enc4 = chr3 & 0x3F;\r\n        if (flag1 === 1) {\r\n            enc3 = enc4 = 64;\r\n        }\r\n        else {\r\n            if (flag2 === 1) {\r\n                enc4 = 64;\r\n            }\r\n        }\r\n        if (skipPadding) {\r\n            if (enc3 === 64) {\r\n                output += `${template.charAt(enc1)}${template.charAt(enc2)}`;\r\n            }\r\n            else {\r\n                if (enc4 === 64) {\r\n                    output += `${template.charAt(enc1)}${template.charAt(enc2)}${template.charAt(enc3)}`;\r\n                }\r\n                else {\r\n                    output += `${template.charAt(enc1)}${template.charAt(enc2)}${template.charAt(enc3)}${template.charAt(enc4)}`;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            output += `${template.charAt(enc1)}${template.charAt(enc2)}${template.charAt(enc3)}${template.charAt(enc4)}`;\r\n        }\r\n    }\r\n    return output;\r\n}\r\nfunction fromBase64(input, useUrlTemplate = false, cutTailZeros = false) {\r\n    const template = (useUrlTemplate) ? base64UrlTemplate : base64Template;\r\n    function indexOf(toSearch) {\r\n        for (let i = 0; i < 64; i++) {\r\n            if (template.charAt(i) === toSearch)\r\n                return i;\r\n        }\r\n        return 64;\r\n    }\r\n    function test(incoming) {\r\n        return ((incoming === 64) ? 0x00 : incoming);\r\n    }\r\n    let i = 0;\r\n    let output = \"\";\r\n    while (i < input.length) {\r\n        const enc1 = indexOf(input.charAt(i++));\r\n        const enc2 = (i >= input.length) ? 0x00 : indexOf(input.charAt(i++));\r\n        const enc3 = (i >= input.length) ? 0x00 : indexOf(input.charAt(i++));\r\n        const enc4 = (i >= input.length) ? 0x00 : indexOf(input.charAt(i++));\r\n        const chr1 = (test(enc1) << 2) | (test(enc2) >> 4);\r\n        const chr2 = ((test(enc2) & 0x0F) << 4) | (test(enc3) >> 2);\r\n        const chr3 = ((test(enc3) & 0x03) << 6) | test(enc4);\r\n        output += String.fromCharCode(chr1);\r\n        if (enc3 !== 64) {\r\n            output += String.fromCharCode(chr2);\r\n        }\r\n        if (enc4 !== 64) {\r\n            output += String.fromCharCode(chr3);\r\n        }\r\n    }\r\n    if (cutTailZeros) {\r\n        const outputLength = output.length;\r\n        let nonZeroStart = (-1);\r\n        for (let i = (outputLength - 1); i >= 0; i--) {\r\n            if (output.charCodeAt(i) !== 0) {\r\n                nonZeroStart = i;\r\n                break;\r\n            }\r\n        }\r\n        if (nonZeroStart !== (-1)) {\r\n            output = output.slice(0, nonZeroStart + 1);\r\n        }\r\n        else {\r\n            output = \"\";\r\n        }\r\n    }\r\n    return output;\r\n}\r\nfunction arrayBufferToString(buffer) {\r\n    let resultString = \"\";\r\n    const view = new Uint8Array(buffer);\r\n    for (const element of view) {\r\n        resultString += String.fromCharCode(element);\r\n    }\r\n    return resultString;\r\n}\r\nfunction stringToArrayBuffer(str) {\r\n    const stringLength = str.length;\r\n    const resultBuffer = new ArrayBuffer(stringLength);\r\n    const resultView = new Uint8Array(resultBuffer);\r\n    for (let i = 0; i < stringLength; i++) {\r\n        resultView[i] = str.charCodeAt(i);\r\n    }\r\n    return resultBuffer;\r\n}\r\nconst log2 = Math.log(2);\r\nfunction nearestPowerOf2(length) {\r\n    const base = (Math.log(length) / log2);\r\n    const floor = Math.floor(base);\r\n    const round = Math.round(base);\r\n    return ((floor === round) ? floor : round);\r\n}\r\nfunction clearProps(object, propsArray) {\r\n    for (const prop of propsArray) {\r\n        delete object[prop];\r\n    }\r\n}\n\nexport { arrayBufferToString, bufferToHexCodes, checkBufferParams, clearProps, fromBase64, getParametersValue, getUTCDate, isEqualBuffer, nearestPowerOf2, padNumber, stringToArrayBuffer, toBase64, utilConcatBuf, utilConcatView, utilDecodeTC, utilEncodeTC, utilFromBase, utilToBase };\n","/*!\n * Copyright (c) 2014, GMO GlobalSign\n * Copyright (c) 2015-2022, Peculiar Ventures\n * All rights reserved.\n * \n * Author 2014-2019, Yury Strozhevsky\n * \n * Redistribution and use in source and binary forms, with or without modification,\n * are permitted provided that the following conditions are met:\n * \n * * Redistributions of source code must retain the above copyright notice, this\n *   list of conditions and the following disclaimer.\n * \n * * Redistributions in binary form must reproduce the above copyright notice, this\n *   list of conditions and the following disclaimer in the documentation and/or\n *   other materials provided with the distribution.\n * \n * * Neither the name of the copyright holder nor the names of its\n *   contributors may be used to endorse or promote products derived from\n *   this software without specific prior written permission.\n * \n * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS \"AS IS\" AND\n * ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED\n * WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE\n * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE FOR\n * ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES\n * (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;\n * LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON\n * ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT\n * (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS\n * SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.\n * \n */\n\nimport * as pvtsutils from 'pvtsutils';\nimport * as pvutils from 'pvutils';\n\nfunction assertBigInt() {\r\n    if (typeof BigInt === \"undefined\") {\r\n        throw new Error(\"BigInt is not defined. Your environment doesn't implement BigInt.\");\r\n    }\r\n}\r\nfunction concat(buffers) {\r\n    let outputLength = 0;\r\n    let prevLength = 0;\r\n    for (let i = 0; i < buffers.length; i++) {\r\n        const buffer = buffers[i];\r\n        outputLength += buffer.byteLength;\r\n    }\r\n    const retView = new Uint8Array(outputLength);\r\n    for (let i = 0; i < buffers.length; i++) {\r\n        const buffer = buffers[i];\r\n        retView.set(new Uint8Array(buffer), prevLength);\r\n        prevLength += buffer.byteLength;\r\n    }\r\n    return retView.buffer;\r\n}\r\nfunction checkBufferParams(baseBlock, inputBuffer, inputOffset, inputLength) {\r\n    if (!(inputBuffer instanceof Uint8Array)) {\r\n        baseBlock.error = \"Wrong parameter: inputBuffer must be 'Uint8Array'\";\r\n        return false;\r\n    }\r\n    if (!inputBuffer.byteLength) {\r\n        baseBlock.error = \"Wrong parameter: inputBuffer has zero length\";\r\n        return false;\r\n    }\r\n    if (inputOffset < 0) {\r\n        baseBlock.error = \"Wrong parameter: inputOffset less than zero\";\r\n        return false;\r\n    }\r\n    if (inputLength < 0) {\r\n        baseBlock.error = \"Wrong parameter: inputLength less than zero\";\r\n        return false;\r\n    }\r\n    if ((inputBuffer.byteLength - inputOffset - inputLength) < 0) {\r\n        baseBlock.error = \"End of input reached before message was fully decoded (inconsistent offset and length values)\";\r\n        return false;\r\n    }\r\n    return true;\r\n}\n\nclass ViewWriter {\r\n    constructor() {\r\n        this.items = [];\r\n    }\r\n    write(buf) {\r\n        this.items.push(buf);\r\n    }\r\n    final() {\r\n        return concat(this.items);\r\n    }\r\n}\n\nconst powers2 = [new Uint8Array([1])];\r\nconst digitsString = \"0123456789\";\r\nconst NAME = \"name\";\r\nconst VALUE_HEX_VIEW = \"valueHexView\";\r\nconst IS_HEX_ONLY = \"isHexOnly\";\r\nconst ID_BLOCK = \"idBlock\";\r\nconst TAG_CLASS = \"tagClass\";\r\nconst TAG_NUMBER = \"tagNumber\";\r\nconst IS_CONSTRUCTED = \"isConstructed\";\r\nconst FROM_BER = \"fromBER\";\r\nconst TO_BER = \"toBER\";\r\nconst LOCAL = \"local\";\r\nconst EMPTY_STRING = \"\";\r\nconst EMPTY_BUFFER = new ArrayBuffer(0);\r\nconst EMPTY_VIEW = new Uint8Array(0);\r\nconst END_OF_CONTENT_NAME = \"EndOfContent\";\r\nconst OCTET_STRING_NAME = \"OCTET STRING\";\r\nconst BIT_STRING_NAME = \"BIT STRING\";\n\nfunction HexBlock(BaseClass) {\r\n    var _a;\r\n    return _a = class Some extends BaseClass {\r\n            constructor(...args) {\r\n                var _a;\r\n                super(...args);\r\n                const params = args[0] || {};\r\n                this.isHexOnly = (_a = params.isHexOnly) !== null && _a !== void 0 ? _a : false;\r\n                this.valueHexView = params.valueHex ? pvtsutils.BufferSourceConverter.toUint8Array(params.valueHex) : EMPTY_VIEW;\r\n            }\r\n            get valueHex() {\r\n                return this.valueHexView.slice().buffer;\r\n            }\r\n            set valueHex(value) {\r\n                this.valueHexView = new Uint8Array(value);\r\n            }\r\n            fromBER(inputBuffer, inputOffset, inputLength) {\r\n                const view = inputBuffer instanceof ArrayBuffer ? new Uint8Array(inputBuffer) : inputBuffer;\r\n                if (!checkBufferParams(this, view, inputOffset, inputLength)) {\r\n                    return -1;\r\n                }\r\n                const endLength = inputOffset + inputLength;\r\n                this.valueHexView = view.subarray(inputOffset, endLength);\r\n                if (!this.valueHexView.length) {\r\n                    this.warnings.push(\"Zero buffer length\");\r\n                    return inputOffset;\r\n                }\r\n                this.blockLength = inputLength;\r\n                return endLength;\r\n            }\r\n            toBER(sizeOnly = false) {\r\n                if (!this.isHexOnly) {\r\n                    this.error = \"Flag 'isHexOnly' is not set, abort\";\r\n                    return EMPTY_BUFFER;\r\n                }\r\n                if (sizeOnly) {\r\n                    return new ArrayBuffer(this.valueHexView.byteLength);\r\n                }\r\n                return (this.valueHexView.byteLength === this.valueHexView.buffer.byteLength)\r\n                    ? this.valueHexView.buffer\r\n                    : this.valueHexView.slice().buffer;\r\n            }\r\n            toJSON() {\r\n                return {\r\n                    ...super.toJSON(),\r\n                    isHexOnly: this.isHexOnly,\r\n                    valueHex: pvtsutils.Convert.ToHex(this.valueHexView),\r\n                };\r\n            }\r\n        },\r\n        _a.NAME = \"hexBlock\",\r\n        _a;\r\n}\n\nclass LocalBaseBlock {\r\n    constructor({ blockLength = 0, error = EMPTY_STRING, warnings = [], valueBeforeDecode = EMPTY_VIEW, } = {}) {\r\n        this.blockLength = blockLength;\r\n        this.error = error;\r\n        this.warnings = warnings;\r\n        this.valueBeforeDecodeView = pvtsutils.BufferSourceConverter.toUint8Array(valueBeforeDecode);\r\n    }\r\n    static blockName() {\r\n        return this.NAME;\r\n    }\r\n    get valueBeforeDecode() {\r\n        return this.valueBeforeDecodeView.slice().buffer;\r\n    }\r\n    set valueBeforeDecode(value) {\r\n        this.valueBeforeDecodeView = new Uint8Array(value);\r\n    }\r\n    toJSON() {\r\n        return {\r\n            blockName: this.constructor.NAME,\r\n            blockLength: this.blockLength,\r\n            error: this.error,\r\n            warnings: this.warnings,\r\n            valueBeforeDecode: pvtsutils.Convert.ToHex(this.valueBeforeDecodeView),\r\n        };\r\n    }\r\n}\r\nLocalBaseBlock.NAME = \"baseBlock\";\n\nclass ValueBlock extends LocalBaseBlock {\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        throw TypeError(\"User need to make a specific function in a class which extends 'ValueBlock'\");\r\n    }\r\n    toBER(sizeOnly, writer) {\r\n        throw TypeError(\"User need to make a specific function in a class which extends 'ValueBlock'\");\r\n    }\r\n}\r\nValueBlock.NAME = \"valueBlock\";\n\nclass LocalIdentificationBlock extends HexBlock(LocalBaseBlock) {\r\n    constructor({ idBlock = {}, } = {}) {\r\n        var _a, _b, _c, _d;\r\n        super();\r\n        if (idBlock) {\r\n            this.isHexOnly = (_a = idBlock.isHexOnly) !== null && _a !== void 0 ? _a : false;\r\n            this.valueHexView = idBlock.valueHex ? pvtsutils.BufferSourceConverter.toUint8Array(idBlock.valueHex) : EMPTY_VIEW;\r\n            this.tagClass = (_b = idBlock.tagClass) !== null && _b !== void 0 ? _b : -1;\r\n            this.tagNumber = (_c = idBlock.tagNumber) !== null && _c !== void 0 ? _c : -1;\r\n            this.isConstructed = (_d = idBlock.isConstructed) !== null && _d !== void 0 ? _d : false;\r\n        }\r\n        else {\r\n            this.tagClass = -1;\r\n            this.tagNumber = -1;\r\n            this.isConstructed = false;\r\n        }\r\n    }\r\n    toBER(sizeOnly = false) {\r\n        let firstOctet = 0;\r\n        switch (this.tagClass) {\r\n            case 1:\r\n                firstOctet |= 0x00;\r\n                break;\r\n            case 2:\r\n                firstOctet |= 0x40;\r\n                break;\r\n            case 3:\r\n                firstOctet |= 0x80;\r\n                break;\r\n            case 4:\r\n                firstOctet |= 0xC0;\r\n                break;\r\n            default:\r\n                this.error = \"Unknown tag class\";\r\n                return EMPTY_BUFFER;\r\n        }\r\n        if (this.isConstructed)\r\n            firstOctet |= 0x20;\r\n        if (this.tagNumber < 31 && !this.isHexOnly) {\r\n            const retView = new Uint8Array(1);\r\n            if (!sizeOnly) {\r\n                let number = this.tagNumber;\r\n                number &= 0x1F;\r\n                firstOctet |= number;\r\n                retView[0] = firstOctet;\r\n            }\r\n            return retView.buffer;\r\n        }\r\n        if (!this.isHexOnly) {\r\n            const encodedBuf = pvutils.utilToBase(this.tagNumber, 7);\r\n            const encodedView = new Uint8Array(encodedBuf);\r\n            const size = encodedBuf.byteLength;\r\n            const retView = new Uint8Array(size + 1);\r\n            retView[0] = (firstOctet | 0x1F);\r\n            if (!sizeOnly) {\r\n                for (let i = 0; i < (size - 1); i++)\r\n                    retView[i + 1] = encodedView[i] | 0x80;\r\n                retView[size] = encodedView[size - 1];\r\n            }\r\n            return retView.buffer;\r\n        }\r\n        const retView = new Uint8Array(this.valueHexView.byteLength + 1);\r\n        retView[0] = (firstOctet | 0x1F);\r\n        if (!sizeOnly) {\r\n            const curView = this.valueHexView;\r\n            for (let i = 0; i < (curView.length - 1); i++)\r\n                retView[i + 1] = curView[i] | 0x80;\r\n            retView[this.valueHexView.byteLength] = curView[curView.length - 1];\r\n        }\r\n        return retView.buffer;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const inputView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        if (!checkBufferParams(this, inputView, inputOffset, inputLength)) {\r\n            return -1;\r\n        }\r\n        const intBuffer = inputView.subarray(inputOffset, inputOffset + inputLength);\r\n        if (intBuffer.length === 0) {\r\n            this.error = \"Zero buffer length\";\r\n            return -1;\r\n        }\r\n        const tagClassMask = intBuffer[0] & 0xC0;\r\n        switch (tagClassMask) {\r\n            case 0x00:\r\n                this.tagClass = (1);\r\n                break;\r\n            case 0x40:\r\n                this.tagClass = (2);\r\n                break;\r\n            case 0x80:\r\n                this.tagClass = (3);\r\n                break;\r\n            case 0xC0:\r\n                this.tagClass = (4);\r\n                break;\r\n            default:\r\n                this.error = \"Unknown tag class\";\r\n                return -1;\r\n        }\r\n        this.isConstructed = (intBuffer[0] & 0x20) === 0x20;\r\n        this.isHexOnly = false;\r\n        const tagNumberMask = intBuffer[0] & 0x1F;\r\n        if (tagNumberMask !== 0x1F) {\r\n            this.tagNumber = (tagNumberMask);\r\n            this.blockLength = 1;\r\n        }\r\n        else {\r\n            let count = 1;\r\n            let intTagNumberBuffer = this.valueHexView = new Uint8Array(255);\r\n            let tagNumberBufferMaxLength = 255;\r\n            while (intBuffer[count] & 0x80) {\r\n                intTagNumberBuffer[count - 1] = intBuffer[count] & 0x7F;\r\n                count++;\r\n                if (count >= intBuffer.length) {\r\n                    this.error = \"End of input reached before message was fully decoded\";\r\n                    return -1;\r\n                }\r\n                if (count === tagNumberBufferMaxLength) {\r\n                    tagNumberBufferMaxLength += 255;\r\n                    const tempBufferView = new Uint8Array(tagNumberBufferMaxLength);\r\n                    for (let i = 0; i < intTagNumberBuffer.length; i++)\r\n                        tempBufferView[i] = intTagNumberBuffer[i];\r\n                    intTagNumberBuffer = this.valueHexView = new Uint8Array(tagNumberBufferMaxLength);\r\n                }\r\n            }\r\n            this.blockLength = (count + 1);\r\n            intTagNumberBuffer[count - 1] = intBuffer[count] & 0x7F;\r\n            const tempBufferView = new Uint8Array(count);\r\n            for (let i = 0; i < count; i++)\r\n                tempBufferView[i] = intTagNumberBuffer[i];\r\n            intTagNumberBuffer = this.valueHexView = new Uint8Array(count);\r\n            intTagNumberBuffer.set(tempBufferView);\r\n            if (this.blockLength <= 9)\r\n                this.tagNumber = pvutils.utilFromBase(intTagNumberBuffer, 7);\r\n            else {\r\n                this.isHexOnly = true;\r\n                this.warnings.push(\"Tag too long, represented as hex-coded\");\r\n            }\r\n        }\r\n        if (((this.tagClass === 1)) &&\r\n            (this.isConstructed)) {\r\n            switch (this.tagNumber) {\r\n                case 1:\r\n                case 2:\r\n                case 5:\r\n                case 6:\r\n                case 9:\r\n                case 13:\r\n                case 14:\r\n                case 23:\r\n                case 24:\r\n                case 31:\r\n                case 32:\r\n                case 33:\r\n                case 34:\r\n                    this.error = \"Constructed encoding used for primitive type\";\r\n                    return -1;\r\n            }\r\n        }\r\n        return (inputOffset + this.blockLength);\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            tagClass: this.tagClass,\r\n            tagNumber: this.tagNumber,\r\n            isConstructed: this.isConstructed,\r\n        };\r\n    }\r\n}\r\nLocalIdentificationBlock.NAME = \"identificationBlock\";\n\nclass LocalLengthBlock extends LocalBaseBlock {\r\n    constructor({ lenBlock = {}, } = {}) {\r\n        var _a, _b, _c;\r\n        super();\r\n        this.isIndefiniteForm = (_a = lenBlock.isIndefiniteForm) !== null && _a !== void 0 ? _a : false;\r\n        this.longFormUsed = (_b = lenBlock.longFormUsed) !== null && _b !== void 0 ? _b : false;\r\n        this.length = (_c = lenBlock.length) !== null && _c !== void 0 ? _c : 0;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const view = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        if (!checkBufferParams(this, view, inputOffset, inputLength)) {\r\n            return -1;\r\n        }\r\n        const intBuffer = view.subarray(inputOffset, inputOffset + inputLength);\r\n        if (intBuffer.length === 0) {\r\n            this.error = \"Zero buffer length\";\r\n            return -1;\r\n        }\r\n        if (intBuffer[0] === 0xFF) {\r\n            this.error = \"Length block 0xFF is reserved by standard\";\r\n            return -1;\r\n        }\r\n        this.isIndefiniteForm = intBuffer[0] === 0x80;\r\n        if (this.isIndefiniteForm) {\r\n            this.blockLength = 1;\r\n            return (inputOffset + this.blockLength);\r\n        }\r\n        this.longFormUsed = !!(intBuffer[0] & 0x80);\r\n        if (this.longFormUsed === false) {\r\n            this.length = (intBuffer[0]);\r\n            this.blockLength = 1;\r\n            return (inputOffset + this.blockLength);\r\n        }\r\n        const count = intBuffer[0] & 0x7F;\r\n        if (count > 8) {\r\n            this.error = \"Too big integer\";\r\n            return -1;\r\n        }\r\n        if ((count + 1) > intBuffer.length) {\r\n            this.error = \"End of input reached before message was fully decoded\";\r\n            return -1;\r\n        }\r\n        const lenOffset = inputOffset + 1;\r\n        const lengthBufferView = view.subarray(lenOffset, lenOffset + count);\r\n        if (lengthBufferView[count - 1] === 0x00)\r\n            this.warnings.push(\"Needlessly long encoded length\");\r\n        this.length = pvutils.utilFromBase(lengthBufferView, 8);\r\n        if (this.longFormUsed && (this.length <= 127))\r\n            this.warnings.push(\"Unnecessary usage of long length form\");\r\n        this.blockLength = count + 1;\r\n        return (inputOffset + this.blockLength);\r\n    }\r\n    toBER(sizeOnly = false) {\r\n        let retBuf;\r\n        let retView;\r\n        if (this.length > 127)\r\n            this.longFormUsed = true;\r\n        if (this.isIndefiniteForm) {\r\n            retBuf = new ArrayBuffer(1);\r\n            if (sizeOnly === false) {\r\n                retView = new Uint8Array(retBuf);\r\n                retView[0] = 0x80;\r\n            }\r\n            return retBuf;\r\n        }\r\n        if (this.longFormUsed) {\r\n            const encodedBuf = pvutils.utilToBase(this.length, 8);\r\n            if (encodedBuf.byteLength > 127) {\r\n                this.error = \"Too big length\";\r\n                return (EMPTY_BUFFER);\r\n            }\r\n            retBuf = new ArrayBuffer(encodedBuf.byteLength + 1);\r\n            if (sizeOnly)\r\n                return retBuf;\r\n            const encodedView = new Uint8Array(encodedBuf);\r\n            retView = new Uint8Array(retBuf);\r\n            retView[0] = encodedBuf.byteLength | 0x80;\r\n            for (let i = 0; i < encodedBuf.byteLength; i++)\r\n                retView[i + 1] = encodedView[i];\r\n            return retBuf;\r\n        }\r\n        retBuf = new ArrayBuffer(1);\r\n        if (sizeOnly === false) {\r\n            retView = new Uint8Array(retBuf);\r\n            retView[0] = this.length;\r\n        }\r\n        return retBuf;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            isIndefiniteForm: this.isIndefiniteForm,\r\n            longFormUsed: this.longFormUsed,\r\n            length: this.length,\r\n        };\r\n    }\r\n}\r\nLocalLengthBlock.NAME = \"lengthBlock\";\n\nconst typeStore = {};\n\nclass BaseBlock extends LocalBaseBlock {\r\n    constructor({ name = EMPTY_STRING, optional = false, primitiveSchema, ...parameters } = {}, valueBlockType) {\r\n        super(parameters);\r\n        this.name = name;\r\n        this.optional = optional;\r\n        if (primitiveSchema) {\r\n            this.primitiveSchema = primitiveSchema;\r\n        }\r\n        this.idBlock = new LocalIdentificationBlock(parameters);\r\n        this.lenBlock = new LocalLengthBlock(parameters);\r\n        this.valueBlock = valueBlockType ? new valueBlockType(parameters) : new ValueBlock(parameters);\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const resultOffset = this.valueBlock.fromBER(inputBuffer, inputOffset, (this.lenBlock.isIndefiniteForm) ? inputLength : this.lenBlock.length);\r\n        if (resultOffset === -1) {\r\n            this.error = this.valueBlock.error;\r\n            return resultOffset;\r\n        }\r\n        if (!this.idBlock.error.length)\r\n            this.blockLength += this.idBlock.blockLength;\r\n        if (!this.lenBlock.error.length)\r\n            this.blockLength += this.lenBlock.blockLength;\r\n        if (!this.valueBlock.error.length)\r\n            this.blockLength += this.valueBlock.blockLength;\r\n        return resultOffset;\r\n    }\r\n    toBER(sizeOnly, writer) {\r\n        const _writer = writer || new ViewWriter();\r\n        if (!writer) {\r\n            prepareIndefiniteForm(this);\r\n        }\r\n        const idBlockBuf = this.idBlock.toBER(sizeOnly);\r\n        _writer.write(idBlockBuf);\r\n        if (this.lenBlock.isIndefiniteForm) {\r\n            _writer.write(new Uint8Array([0x80]).buffer);\r\n            this.valueBlock.toBER(sizeOnly, _writer);\r\n            _writer.write(new ArrayBuffer(2));\r\n        }\r\n        else {\r\n            const valueBlockBuf = this.valueBlock.toBER(sizeOnly);\r\n            this.lenBlock.length = valueBlockBuf.byteLength;\r\n            const lenBlockBuf = this.lenBlock.toBER(sizeOnly);\r\n            _writer.write(lenBlockBuf);\r\n            _writer.write(valueBlockBuf);\r\n        }\r\n        if (!writer) {\r\n            return _writer.final();\r\n        }\r\n        return EMPTY_BUFFER;\r\n    }\r\n    toJSON() {\r\n        const object = {\r\n            ...super.toJSON(),\r\n            idBlock: this.idBlock.toJSON(),\r\n            lenBlock: this.lenBlock.toJSON(),\r\n            valueBlock: this.valueBlock.toJSON(),\r\n            name: this.name,\r\n            optional: this.optional,\r\n        };\r\n        if (this.primitiveSchema)\r\n            object.primitiveSchema = this.primitiveSchema.toJSON();\r\n        return object;\r\n    }\r\n    toString(encoding = \"ascii\") {\r\n        if (encoding === \"ascii\") {\r\n            return this.onAsciiEncoding();\r\n        }\r\n        return pvtsutils.Convert.ToHex(this.toBER());\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME} : ${pvtsutils.Convert.ToHex(this.valueBlock.valueBeforeDecodeView)}`;\r\n    }\r\n    isEqual(other) {\r\n        if (this === other) {\r\n            return true;\r\n        }\r\n        if (!(other instanceof this.constructor)) {\r\n            return false;\r\n        }\r\n        const thisRaw = this.toBER();\r\n        const otherRaw = other.toBER();\r\n        return pvutils.isEqualBuffer(thisRaw, otherRaw);\r\n    }\r\n}\r\nBaseBlock.NAME = \"BaseBlock\";\r\nfunction prepareIndefiniteForm(baseBlock) {\r\n    if (baseBlock instanceof typeStore.Constructed) {\r\n        for (const value of baseBlock.valueBlock.value) {\r\n            if (prepareIndefiniteForm(value)) {\r\n                baseBlock.lenBlock.isIndefiniteForm = true;\r\n            }\r\n        }\r\n    }\r\n    return !!baseBlock.lenBlock.isIndefiniteForm;\r\n}\n\nclass BaseStringBlock extends BaseBlock {\r\n    constructor({ value = EMPTY_STRING, ...parameters } = {}, stringValueBlockType) {\r\n        super(parameters, stringValueBlockType);\r\n        if (value) {\r\n            this.fromString(value);\r\n        }\r\n    }\r\n    getValue() {\r\n        return this.valueBlock.value;\r\n    }\r\n    setValue(value) {\r\n        this.valueBlock.value = value;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const resultOffset = this.valueBlock.fromBER(inputBuffer, inputOffset, (this.lenBlock.isIndefiniteForm) ? inputLength : this.lenBlock.length);\r\n        if (resultOffset === -1) {\r\n            this.error = this.valueBlock.error;\r\n            return resultOffset;\r\n        }\r\n        this.fromBuffer(this.valueBlock.valueHexView);\r\n        if (!this.idBlock.error.length)\r\n            this.blockLength += this.idBlock.blockLength;\r\n        if (!this.lenBlock.error.length)\r\n            this.blockLength += this.lenBlock.blockLength;\r\n        if (!this.valueBlock.error.length)\r\n            this.blockLength += this.valueBlock.blockLength;\r\n        return resultOffset;\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME} : '${this.valueBlock.value}'`;\r\n    }\r\n}\r\nBaseStringBlock.NAME = \"BaseStringBlock\";\n\nclass LocalPrimitiveValueBlock extends HexBlock(ValueBlock) {\r\n    constructor({ isHexOnly = true, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.isHexOnly = isHexOnly;\r\n    }\r\n}\r\nLocalPrimitiveValueBlock.NAME = \"PrimitiveValueBlock\";\n\nvar _a$w;\r\nclass Primitive extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, LocalPrimitiveValueBlock);\r\n        this.idBlock.isConstructed = false;\r\n    }\r\n}\r\n_a$w = Primitive;\r\n(() => {\r\n    typeStore.Primitive = _a$w;\r\n})();\r\nPrimitive.NAME = \"PRIMITIVE\";\n\nfunction localChangeType(inputObject, newType) {\r\n    if (inputObject instanceof newType) {\r\n        return inputObject;\r\n    }\r\n    const newObject = new newType();\r\n    newObject.idBlock = inputObject.idBlock;\r\n    newObject.lenBlock = inputObject.lenBlock;\r\n    newObject.warnings = inputObject.warnings;\r\n    newObject.valueBeforeDecodeView = inputObject.valueBeforeDecodeView;\r\n    return newObject;\r\n}\r\nfunction localFromBER(inputBuffer, inputOffset = 0, inputLength = inputBuffer.length) {\r\n    const incomingOffset = inputOffset;\r\n    let returnObject = new BaseBlock({}, ValueBlock);\r\n    const baseBlock = new LocalBaseBlock();\r\n    if (!checkBufferParams(baseBlock, inputBuffer, inputOffset, inputLength)) {\r\n        returnObject.error = baseBlock.error;\r\n        return {\r\n            offset: -1,\r\n            result: returnObject\r\n        };\r\n    }\r\n    const intBuffer = inputBuffer.subarray(inputOffset, inputOffset + inputLength);\r\n    if (!intBuffer.length) {\r\n        returnObject.error = \"Zero buffer length\";\r\n        return {\r\n            offset: -1,\r\n            result: returnObject\r\n        };\r\n    }\r\n    let resultOffset = returnObject.idBlock.fromBER(inputBuffer, inputOffset, inputLength);\r\n    if (returnObject.idBlock.warnings.length) {\r\n        returnObject.warnings.concat(returnObject.idBlock.warnings);\r\n    }\r\n    if (resultOffset === -1) {\r\n        returnObject.error = returnObject.idBlock.error;\r\n        return {\r\n            offset: -1,\r\n            result: returnObject\r\n        };\r\n    }\r\n    inputOffset = resultOffset;\r\n    inputLength -= returnObject.idBlock.blockLength;\r\n    resultOffset = returnObject.lenBlock.fromBER(inputBuffer, inputOffset, inputLength);\r\n    if (returnObject.lenBlock.warnings.length) {\r\n        returnObject.warnings.concat(returnObject.lenBlock.warnings);\r\n    }\r\n    if (resultOffset === -1) {\r\n        returnObject.error = returnObject.lenBlock.error;\r\n        return {\r\n            offset: -1,\r\n            result: returnObject\r\n        };\r\n    }\r\n    inputOffset = resultOffset;\r\n    inputLength -= returnObject.lenBlock.blockLength;\r\n    if (!returnObject.idBlock.isConstructed &&\r\n        returnObject.lenBlock.isIndefiniteForm) {\r\n        returnObject.error = \"Indefinite length form used for primitive encoding form\";\r\n        return {\r\n            offset: -1,\r\n            result: returnObject\r\n        };\r\n    }\r\n    let newASN1Type = BaseBlock;\r\n    switch (returnObject.idBlock.tagClass) {\r\n        case 1:\r\n            if ((returnObject.idBlock.tagNumber >= 37) &&\r\n                (returnObject.idBlock.isHexOnly === false)) {\r\n                returnObject.error = \"UNIVERSAL 37 and upper tags are reserved by ASN.1 standard\";\r\n                return {\r\n                    offset: -1,\r\n                    result: returnObject\r\n                };\r\n            }\r\n            switch (returnObject.idBlock.tagNumber) {\r\n                case 0:\r\n                    if ((returnObject.idBlock.isConstructed) &&\r\n                        (returnObject.lenBlock.length > 0)) {\r\n                        returnObject.error = \"Type [UNIVERSAL 0] is reserved\";\r\n                        return {\r\n                            offset: -1,\r\n                            result: returnObject\r\n                        };\r\n                    }\r\n                    newASN1Type = typeStore.EndOfContent;\r\n                    break;\r\n                case 1:\r\n                    newASN1Type = typeStore.Boolean;\r\n                    break;\r\n                case 2:\r\n                    newASN1Type = typeStore.Integer;\r\n                    break;\r\n                case 3:\r\n                    newASN1Type = typeStore.BitString;\r\n                    break;\r\n                case 4:\r\n                    newASN1Type = typeStore.OctetString;\r\n                    break;\r\n                case 5:\r\n                    newASN1Type = typeStore.Null;\r\n                    break;\r\n                case 6:\r\n                    newASN1Type = typeStore.ObjectIdentifier;\r\n                    break;\r\n                case 10:\r\n                    newASN1Type = typeStore.Enumerated;\r\n                    break;\r\n                case 12:\r\n                    newASN1Type = typeStore.Utf8String;\r\n                    break;\r\n                case 13:\r\n                    newASN1Type = typeStore.RelativeObjectIdentifier;\r\n                    break;\r\n                case 14:\r\n                    newASN1Type = typeStore.TIME;\r\n                    break;\r\n                case 15:\r\n                    returnObject.error = \"[UNIVERSAL 15] is reserved by ASN.1 standard\";\r\n                    return {\r\n                        offset: -1,\r\n                        result: returnObject\r\n                    };\r\n                case 16:\r\n                    newASN1Type = typeStore.Sequence;\r\n                    break;\r\n                case 17:\r\n                    newASN1Type = typeStore.Set;\r\n                    break;\r\n                case 18:\r\n                    newASN1Type = typeStore.NumericString;\r\n                    break;\r\n                case 19:\r\n                    newASN1Type = typeStore.PrintableString;\r\n                    break;\r\n                case 20:\r\n                    newASN1Type = typeStore.TeletexString;\r\n                    break;\r\n                case 21:\r\n                    newASN1Type = typeStore.VideotexString;\r\n                    break;\r\n                case 22:\r\n                    newASN1Type = typeStore.IA5String;\r\n                    break;\r\n                case 23:\r\n                    newASN1Type = typeStore.UTCTime;\r\n                    break;\r\n                case 24:\r\n                    newASN1Type = typeStore.GeneralizedTime;\r\n                    break;\r\n                case 25:\r\n                    newASN1Type = typeStore.GraphicString;\r\n                    break;\r\n                case 26:\r\n                    newASN1Type = typeStore.VisibleString;\r\n                    break;\r\n                case 27:\r\n                    newASN1Type = typeStore.GeneralString;\r\n                    break;\r\n                case 28:\r\n                    newASN1Type = typeStore.UniversalString;\r\n                    break;\r\n                case 29:\r\n                    newASN1Type = typeStore.CharacterString;\r\n                    break;\r\n                case 30:\r\n                    newASN1Type = typeStore.BmpString;\r\n                    break;\r\n                case 31:\r\n                    newASN1Type = typeStore.DATE;\r\n                    break;\r\n                case 32:\r\n                    newASN1Type = typeStore.TimeOfDay;\r\n                    break;\r\n                case 33:\r\n                    newASN1Type = typeStore.DateTime;\r\n                    break;\r\n                case 34:\r\n                    newASN1Type = typeStore.Duration;\r\n                    break;\r\n                default: {\r\n                    const newObject = returnObject.idBlock.isConstructed\r\n                        ? new typeStore.Constructed()\r\n                        : new typeStore.Primitive();\r\n                    newObject.idBlock = returnObject.idBlock;\r\n                    newObject.lenBlock = returnObject.lenBlock;\r\n                    newObject.warnings = returnObject.warnings;\r\n                    returnObject = newObject;\r\n                }\r\n            }\r\n            break;\r\n        case 2:\r\n        case 3:\r\n        case 4:\r\n        default: {\r\n            newASN1Type = returnObject.idBlock.isConstructed\r\n                ? typeStore.Constructed\r\n                : typeStore.Primitive;\r\n        }\r\n    }\r\n    returnObject = localChangeType(returnObject, newASN1Type);\r\n    resultOffset = returnObject.fromBER(inputBuffer, inputOffset, returnObject.lenBlock.isIndefiniteForm ? inputLength : returnObject.lenBlock.length);\r\n    returnObject.valueBeforeDecodeView = inputBuffer.subarray(incomingOffset, incomingOffset + returnObject.blockLength);\r\n    return {\r\n        offset: resultOffset,\r\n        result: returnObject\r\n    };\r\n}\r\nfunction fromBER(inputBuffer) {\r\n    if (!inputBuffer.byteLength) {\r\n        const result = new BaseBlock({}, ValueBlock);\r\n        result.error = \"Input buffer has zero length\";\r\n        return {\r\n            offset: -1,\r\n            result\r\n        };\r\n    }\r\n    return localFromBER(pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer).slice(), 0, inputBuffer.byteLength);\r\n}\n\nfunction checkLen(indefiniteLength, length) {\r\n    if (indefiniteLength) {\r\n        return 1;\r\n    }\r\n    return length;\r\n}\r\nclass LocalConstructedValueBlock extends ValueBlock {\r\n    constructor({ value = [], isIndefiniteForm = false, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.value = value;\r\n        this.isIndefiniteForm = isIndefiniteForm;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const view = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        if (!checkBufferParams(this, view, inputOffset, inputLength)) {\r\n            return -1;\r\n        }\r\n        this.valueBeforeDecodeView = view.subarray(inputOffset, inputOffset + inputLength);\r\n        if (this.valueBeforeDecodeView.length === 0) {\r\n            this.warnings.push(\"Zero buffer length\");\r\n            return inputOffset;\r\n        }\r\n        let currentOffset = inputOffset;\r\n        while (checkLen(this.isIndefiniteForm, inputLength) > 0) {\r\n            const returnObject = localFromBER(view, currentOffset, inputLength);\r\n            if (returnObject.offset === -1) {\r\n                this.error = returnObject.result.error;\r\n                this.warnings.concat(returnObject.result.warnings);\r\n                return -1;\r\n            }\r\n            currentOffset = returnObject.offset;\r\n            this.blockLength += returnObject.result.blockLength;\r\n            inputLength -= returnObject.result.blockLength;\r\n            this.value.push(returnObject.result);\r\n            if (this.isIndefiniteForm && returnObject.result.constructor.NAME === END_OF_CONTENT_NAME) {\r\n                break;\r\n            }\r\n        }\r\n        if (this.isIndefiniteForm) {\r\n            if (this.value[this.value.length - 1].constructor.NAME === END_OF_CONTENT_NAME) {\r\n                this.value.pop();\r\n            }\r\n            else {\r\n                this.warnings.push(\"No EndOfContent block encoded\");\r\n            }\r\n        }\r\n        return currentOffset;\r\n    }\r\n    toBER(sizeOnly, writer) {\r\n        const _writer = writer || new ViewWriter();\r\n        for (let i = 0; i < this.value.length; i++) {\r\n            this.value[i].toBER(sizeOnly, _writer);\r\n        }\r\n        if (!writer) {\r\n            return _writer.final();\r\n        }\r\n        return EMPTY_BUFFER;\r\n    }\r\n    toJSON() {\r\n        const object = {\r\n            ...super.toJSON(),\r\n            isIndefiniteForm: this.isIndefiniteForm,\r\n            value: [],\r\n        };\r\n        for (const value of this.value) {\r\n            object.value.push(value.toJSON());\r\n        }\r\n        return object;\r\n    }\r\n}\r\nLocalConstructedValueBlock.NAME = \"ConstructedValueBlock\";\n\nvar _a$v;\r\nclass Constructed extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, LocalConstructedValueBlock);\r\n        this.idBlock.isConstructed = true;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        this.valueBlock.isIndefiniteForm = this.lenBlock.isIndefiniteForm;\r\n        const resultOffset = this.valueBlock.fromBER(inputBuffer, inputOffset, (this.lenBlock.isIndefiniteForm) ? inputLength : this.lenBlock.length);\r\n        if (resultOffset === -1) {\r\n            this.error = this.valueBlock.error;\r\n            return resultOffset;\r\n        }\r\n        if (!this.idBlock.error.length)\r\n            this.blockLength += this.idBlock.blockLength;\r\n        if (!this.lenBlock.error.length)\r\n            this.blockLength += this.lenBlock.blockLength;\r\n        if (!this.valueBlock.error.length)\r\n            this.blockLength += this.valueBlock.blockLength;\r\n        return resultOffset;\r\n    }\r\n    onAsciiEncoding() {\r\n        const values = [];\r\n        for (const value of this.valueBlock.value) {\r\n            values.push(value.toString(\"ascii\").split(\"\\n\").map(o => `  ${o}`).join(\"\\n\"));\r\n        }\r\n        const blockName = this.idBlock.tagClass === 3\r\n            ? `[${this.idBlock.tagNumber}]`\r\n            : this.constructor.NAME;\r\n        return values.length\r\n            ? `${blockName} :\\n${values.join(\"\\n\")}`\r\n            : `${blockName} :`;\r\n    }\r\n}\r\n_a$v = Constructed;\r\n(() => {\r\n    typeStore.Constructed = _a$v;\r\n})();\r\nConstructed.NAME = \"CONSTRUCTED\";\n\nclass LocalEndOfContentValueBlock extends ValueBlock {\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        return inputOffset;\r\n    }\r\n    toBER(sizeOnly) {\r\n        return EMPTY_BUFFER;\r\n    }\r\n}\r\nLocalEndOfContentValueBlock.override = \"EndOfContentValueBlock\";\n\nvar _a$u;\r\nclass EndOfContent extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, LocalEndOfContentValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 0;\r\n    }\r\n}\r\n_a$u = EndOfContent;\r\n(() => {\r\n    typeStore.EndOfContent = _a$u;\r\n})();\r\nEndOfContent.NAME = END_OF_CONTENT_NAME;\n\nvar _a$t;\r\nclass Null extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, ValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 5;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        if (this.lenBlock.length > 0)\r\n            this.warnings.push(\"Non-zero length of value block for Null type\");\r\n        if (!this.idBlock.error.length)\r\n            this.blockLength += this.idBlock.blockLength;\r\n        if (!this.lenBlock.error.length)\r\n            this.blockLength += this.lenBlock.blockLength;\r\n        this.blockLength += inputLength;\r\n        if ((inputOffset + inputLength) > inputBuffer.byteLength) {\r\n            this.error = \"End of input reached before message was fully decoded (inconsistent offset and length values)\";\r\n            return -1;\r\n        }\r\n        return (inputOffset + inputLength);\r\n    }\r\n    toBER(sizeOnly, writer) {\r\n        const retBuf = new ArrayBuffer(2);\r\n        if (!sizeOnly) {\r\n            const retView = new Uint8Array(retBuf);\r\n            retView[0] = 0x05;\r\n            retView[1] = 0x00;\r\n        }\r\n        if (writer) {\r\n            writer.write(retBuf);\r\n        }\r\n        return retBuf;\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME}`;\r\n    }\r\n}\r\n_a$t = Null;\r\n(() => {\r\n    typeStore.Null = _a$t;\r\n})();\r\nNull.NAME = \"NULL\";\n\nclass LocalBooleanValueBlock extends HexBlock(ValueBlock) {\r\n    constructor({ value, ...parameters } = {}) {\r\n        super(parameters);\r\n        if (parameters.valueHex) {\r\n            this.valueHexView = pvtsutils.BufferSourceConverter.toUint8Array(parameters.valueHex);\r\n        }\r\n        else {\r\n            this.valueHexView = new Uint8Array(1);\r\n        }\r\n        if (value) {\r\n            this.value = value;\r\n        }\r\n    }\r\n    get value() {\r\n        for (const octet of this.valueHexView) {\r\n            if (octet > 0) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    set value(value) {\r\n        this.valueHexView[0] = value ? 0xFF : 0x00;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const inputView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        if (!checkBufferParams(this, inputView, inputOffset, inputLength)) {\r\n            return -1;\r\n        }\r\n        this.valueHexView = inputView.subarray(inputOffset, inputOffset + inputLength);\r\n        if (inputLength > 1)\r\n            this.warnings.push(\"Boolean value encoded in more then 1 octet\");\r\n        this.isHexOnly = true;\r\n        pvutils.utilDecodeTC.call(this);\r\n        this.blockLength = inputLength;\r\n        return (inputOffset + inputLength);\r\n    }\r\n    toBER() {\r\n        return this.valueHexView.slice();\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            value: this.value,\r\n        };\r\n    }\r\n}\r\nLocalBooleanValueBlock.NAME = \"BooleanValueBlock\";\n\nvar _a$s;\r\nclass Boolean extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, LocalBooleanValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 1;\r\n    }\r\n    getValue() {\r\n        return this.valueBlock.value;\r\n    }\r\n    setValue(value) {\r\n        this.valueBlock.value = value;\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME} : ${this.getValue}`;\r\n    }\r\n}\r\n_a$s = Boolean;\r\n(() => {\r\n    typeStore.Boolean = _a$s;\r\n})();\r\nBoolean.NAME = \"BOOLEAN\";\n\nclass LocalOctetStringValueBlock extends HexBlock(LocalConstructedValueBlock) {\r\n    constructor({ isConstructed = false, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.isConstructed = isConstructed;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        let resultOffset = 0;\r\n        if (this.isConstructed) {\r\n            this.isHexOnly = false;\r\n            resultOffset = LocalConstructedValueBlock.prototype.fromBER.call(this, inputBuffer, inputOffset, inputLength);\r\n            if (resultOffset === -1)\r\n                return resultOffset;\r\n            for (let i = 0; i < this.value.length; i++) {\r\n                const currentBlockName = this.value[i].constructor.NAME;\r\n                if (currentBlockName === END_OF_CONTENT_NAME) {\r\n                    if (this.isIndefiniteForm)\r\n                        break;\r\n                    else {\r\n                        this.error = \"EndOfContent is unexpected, OCTET STRING may consists of OCTET STRINGs only\";\r\n                        return -1;\r\n                    }\r\n                }\r\n                if (currentBlockName !== OCTET_STRING_NAME) {\r\n                    this.error = \"OCTET STRING may consists of OCTET STRINGs only\";\r\n                    return -1;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.isHexOnly = true;\r\n            resultOffset = super.fromBER(inputBuffer, inputOffset, inputLength);\r\n            this.blockLength = inputLength;\r\n        }\r\n        return resultOffset;\r\n    }\r\n    toBER(sizeOnly, writer) {\r\n        if (this.isConstructed)\r\n            return LocalConstructedValueBlock.prototype.toBER.call(this, sizeOnly, writer);\r\n        return sizeOnly\r\n            ? new ArrayBuffer(this.valueHexView.byteLength)\r\n            : this.valueHexView.slice().buffer;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            isConstructed: this.isConstructed,\r\n        };\r\n    }\r\n}\r\nLocalOctetStringValueBlock.NAME = \"OctetStringValueBlock\";\n\nvar _a$r;\r\nclass OctetString extends BaseBlock {\r\n    constructor({ idBlock = {}, lenBlock = {}, ...parameters } = {}) {\r\n        var _b, _c;\r\n        (_b = parameters.isConstructed) !== null && _b !== void 0 ? _b : (parameters.isConstructed = !!((_c = parameters.value) === null || _c === void 0 ? void 0 : _c.length));\r\n        super({\r\n            idBlock: {\r\n                isConstructed: parameters.isConstructed,\r\n                ...idBlock,\r\n            },\r\n            lenBlock: {\r\n                ...lenBlock,\r\n                isIndefiniteForm: !!parameters.isIndefiniteForm,\r\n            },\r\n            ...parameters,\r\n        }, LocalOctetStringValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 4;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        this.valueBlock.isConstructed = this.idBlock.isConstructed;\r\n        this.valueBlock.isIndefiniteForm = this.lenBlock.isIndefiniteForm;\r\n        if (inputLength === 0) {\r\n            if (this.idBlock.error.length === 0)\r\n                this.blockLength += this.idBlock.blockLength;\r\n            if (this.lenBlock.error.length === 0)\r\n                this.blockLength += this.lenBlock.blockLength;\r\n            return inputOffset;\r\n        }\r\n        if (!this.valueBlock.isConstructed) {\r\n            const view = inputBuffer instanceof ArrayBuffer ? new Uint8Array(inputBuffer) : inputBuffer;\r\n            const buf = view.subarray(inputOffset, inputOffset + inputLength);\r\n            try {\r\n                if (buf.byteLength) {\r\n                    const asn = localFromBER(buf, 0, buf.byteLength);\r\n                    if (asn.offset !== -1 && asn.offset === inputLength) {\r\n                        this.valueBlock.value = [asn.result];\r\n                    }\r\n                }\r\n            }\r\n            catch (e) {\r\n            }\r\n        }\r\n        return super.fromBER(inputBuffer, inputOffset, inputLength);\r\n    }\r\n    onAsciiEncoding() {\r\n        if (this.valueBlock.isConstructed || (this.valueBlock.value && this.valueBlock.value.length)) {\r\n            return Constructed.prototype.onAsciiEncoding.call(this);\r\n        }\r\n        return `${this.constructor.NAME} : ${pvtsutils.Convert.ToHex(this.valueBlock.valueHexView)}`;\r\n    }\r\n    getValue() {\r\n        if (!this.idBlock.isConstructed) {\r\n            return this.valueBlock.valueHexView.slice().buffer;\r\n        }\r\n        const array = [];\r\n        for (const content of this.valueBlock.value) {\r\n            if (content instanceof OctetString) {\r\n                array.push(content.valueBlock.valueHexView);\r\n            }\r\n        }\r\n        return pvtsutils.BufferSourceConverter.concat(array);\r\n    }\r\n}\r\n_a$r = OctetString;\r\n(() => {\r\n    typeStore.OctetString = _a$r;\r\n})();\r\nOctetString.NAME = OCTET_STRING_NAME;\n\nclass LocalBitStringValueBlock extends HexBlock(LocalConstructedValueBlock) {\r\n    constructor({ unusedBits = 0, isConstructed = false, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.unusedBits = unusedBits;\r\n        this.isConstructed = isConstructed;\r\n        this.blockLength = this.valueHexView.byteLength;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        if (!inputLength) {\r\n            return inputOffset;\r\n        }\r\n        let resultOffset = -1;\r\n        if (this.isConstructed) {\r\n            resultOffset = LocalConstructedValueBlock.prototype.fromBER.call(this, inputBuffer, inputOffset, inputLength);\r\n            if (resultOffset === -1)\r\n                return resultOffset;\r\n            for (const value of this.value) {\r\n                const currentBlockName = value.constructor.NAME;\r\n                if (currentBlockName === END_OF_CONTENT_NAME) {\r\n                    if (this.isIndefiniteForm)\r\n                        break;\r\n                    else {\r\n                        this.error = \"EndOfContent is unexpected, BIT STRING may consists of BIT STRINGs only\";\r\n                        return -1;\r\n                    }\r\n                }\r\n                if (currentBlockName !== BIT_STRING_NAME) {\r\n                    this.error = \"BIT STRING may consists of BIT STRINGs only\";\r\n                    return -1;\r\n                }\r\n                const valueBlock = value.valueBlock;\r\n                if ((this.unusedBits > 0) && (valueBlock.unusedBits > 0)) {\r\n                    this.error = \"Using of \\\"unused bits\\\" inside constructive BIT STRING allowed for least one only\";\r\n                    return -1;\r\n                }\r\n                this.unusedBits = valueBlock.unusedBits;\r\n            }\r\n            return resultOffset;\r\n        }\r\n        const inputView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        if (!checkBufferParams(this, inputView, inputOffset, inputLength)) {\r\n            return -1;\r\n        }\r\n        const intBuffer = inputView.subarray(inputOffset, inputOffset + inputLength);\r\n        this.unusedBits = intBuffer[0];\r\n        if (this.unusedBits > 7) {\r\n            this.error = \"Unused bits for BitString must be in range 0-7\";\r\n            return -1;\r\n        }\r\n        if (!this.unusedBits) {\r\n            const buf = intBuffer.subarray(1);\r\n            try {\r\n                if (buf.byteLength) {\r\n                    const asn = localFromBER(buf, 0, buf.byteLength);\r\n                    if (asn.offset !== -1 && asn.offset === (inputLength - 1)) {\r\n                        this.value = [asn.result];\r\n                    }\r\n                }\r\n            }\r\n            catch (e) {\r\n            }\r\n        }\r\n        this.valueHexView = intBuffer.subarray(1);\r\n        this.blockLength = intBuffer.length;\r\n        return (inputOffset + inputLength);\r\n    }\r\n    toBER(sizeOnly, writer) {\r\n        if (this.isConstructed) {\r\n            return LocalConstructedValueBlock.prototype.toBER.call(this, sizeOnly, writer);\r\n        }\r\n        if (sizeOnly) {\r\n            return new ArrayBuffer(this.valueHexView.byteLength + 1);\r\n        }\r\n        if (!this.valueHexView.byteLength) {\r\n            return EMPTY_BUFFER;\r\n        }\r\n        const retView = new Uint8Array(this.valueHexView.length + 1);\r\n        retView[0] = this.unusedBits;\r\n        retView.set(this.valueHexView, 1);\r\n        return retView.buffer;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            unusedBits: this.unusedBits,\r\n            isConstructed: this.isConstructed,\r\n        };\r\n    }\r\n}\r\nLocalBitStringValueBlock.NAME = \"BitStringValueBlock\";\n\nvar _a$q;\r\nclass BitString extends BaseBlock {\r\n    constructor({ idBlock = {}, lenBlock = {}, ...parameters } = {}) {\r\n        var _b, _c;\r\n        (_b = parameters.isConstructed) !== null && _b !== void 0 ? _b : (parameters.isConstructed = !!((_c = parameters.value) === null || _c === void 0 ? void 0 : _c.length));\r\n        super({\r\n            idBlock: {\r\n                isConstructed: parameters.isConstructed,\r\n                ...idBlock,\r\n            },\r\n            lenBlock: {\r\n                ...lenBlock,\r\n                isIndefiniteForm: !!parameters.isIndefiniteForm,\r\n            },\r\n            ...parameters,\r\n        }, LocalBitStringValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 3;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        this.valueBlock.isConstructed = this.idBlock.isConstructed;\r\n        this.valueBlock.isIndefiniteForm = this.lenBlock.isIndefiniteForm;\r\n        return super.fromBER(inputBuffer, inputOffset, inputLength);\r\n    }\r\n    onAsciiEncoding() {\r\n        if (this.valueBlock.isConstructed || (this.valueBlock.value && this.valueBlock.value.length)) {\r\n            return Constructed.prototype.onAsciiEncoding.call(this);\r\n        }\r\n        else {\r\n            const bits = [];\r\n            const valueHex = this.valueBlock.valueHexView;\r\n            for (const byte of valueHex) {\r\n                bits.push(byte.toString(2).padStart(8, \"0\"));\r\n            }\r\n            const bitsStr = bits.join(\"\");\r\n            return `${this.constructor.NAME} : ${bitsStr.substring(0, bitsStr.length - this.valueBlock.unusedBits)}`;\r\n        }\r\n    }\r\n}\r\n_a$q = BitString;\r\n(() => {\r\n    typeStore.BitString = _a$q;\r\n})();\r\nBitString.NAME = BIT_STRING_NAME;\n\nvar _a$p;\r\nfunction viewAdd(first, second) {\r\n    const c = new Uint8Array([0]);\r\n    const firstView = new Uint8Array(first);\r\n    const secondView = new Uint8Array(second);\r\n    let firstViewCopy = firstView.slice(0);\r\n    const firstViewCopyLength = firstViewCopy.length - 1;\r\n    const secondViewCopy = secondView.slice(0);\r\n    const secondViewCopyLength = secondViewCopy.length - 1;\r\n    let value = 0;\r\n    const max = (secondViewCopyLength < firstViewCopyLength) ? firstViewCopyLength : secondViewCopyLength;\r\n    let counter = 0;\r\n    for (let i = max; i >= 0; i--, counter++) {\r\n        switch (true) {\r\n            case (counter < secondViewCopy.length):\r\n                value = firstViewCopy[firstViewCopyLength - counter] + secondViewCopy[secondViewCopyLength - counter] + c[0];\r\n                break;\r\n            default:\r\n                value = firstViewCopy[firstViewCopyLength - counter] + c[0];\r\n        }\r\n        c[0] = value / 10;\r\n        switch (true) {\r\n            case (counter >= firstViewCopy.length):\r\n                firstViewCopy = pvutils.utilConcatView(new Uint8Array([value % 10]), firstViewCopy);\r\n                break;\r\n            default:\r\n                firstViewCopy[firstViewCopyLength - counter] = value % 10;\r\n        }\r\n    }\r\n    if (c[0] > 0)\r\n        firstViewCopy = pvutils.utilConcatView(c, firstViewCopy);\r\n    return firstViewCopy;\r\n}\r\nfunction power2(n) {\r\n    if (n >= powers2.length) {\r\n        for (let p = powers2.length; p <= n; p++) {\r\n            const c = new Uint8Array([0]);\r\n            let digits = (powers2[p - 1]).slice(0);\r\n            for (let i = (digits.length - 1); i >= 0; i--) {\r\n                const newValue = new Uint8Array([(digits[i] << 1) + c[0]]);\r\n                c[0] = newValue[0] / 10;\r\n                digits[i] = newValue[0] % 10;\r\n            }\r\n            if (c[0] > 0)\r\n                digits = pvutils.utilConcatView(c, digits);\r\n            powers2.push(digits);\r\n        }\r\n    }\r\n    return powers2[n];\r\n}\r\nfunction viewSub(first, second) {\r\n    let b = 0;\r\n    const firstView = new Uint8Array(first);\r\n    const secondView = new Uint8Array(second);\r\n    const firstViewCopy = firstView.slice(0);\r\n    const firstViewCopyLength = firstViewCopy.length - 1;\r\n    const secondViewCopy = secondView.slice(0);\r\n    const secondViewCopyLength = secondViewCopy.length - 1;\r\n    let value;\r\n    let counter = 0;\r\n    for (let i = secondViewCopyLength; i >= 0; i--, counter++) {\r\n        value = firstViewCopy[firstViewCopyLength - counter] - secondViewCopy[secondViewCopyLength - counter] - b;\r\n        switch (true) {\r\n            case (value < 0):\r\n                b = 1;\r\n                firstViewCopy[firstViewCopyLength - counter] = value + 10;\r\n                break;\r\n            default:\r\n                b = 0;\r\n                firstViewCopy[firstViewCopyLength - counter] = value;\r\n        }\r\n    }\r\n    if (b > 0) {\r\n        for (let i = (firstViewCopyLength - secondViewCopyLength + 1); i >= 0; i--, counter++) {\r\n            value = firstViewCopy[firstViewCopyLength - counter] - b;\r\n            if (value < 0) {\r\n                b = 1;\r\n                firstViewCopy[firstViewCopyLength - counter] = value + 10;\r\n            }\r\n            else {\r\n                b = 0;\r\n                firstViewCopy[firstViewCopyLength - counter] = value;\r\n                break;\r\n            }\r\n        }\r\n    }\r\n    return firstViewCopy.slice();\r\n}\r\nclass LocalIntegerValueBlock extends HexBlock(ValueBlock) {\r\n    constructor({ value, ...parameters } = {}) {\r\n        super(parameters);\r\n        this._valueDec = 0;\r\n        if (parameters.valueHex) {\r\n            this.setValueHex();\r\n        }\r\n        if (value !== undefined) {\r\n            this.valueDec = value;\r\n        }\r\n    }\r\n    setValueHex() {\r\n        if (this.valueHexView.length >= 4) {\r\n            this.warnings.push(\"Too big Integer for decoding, hex only\");\r\n            this.isHexOnly = true;\r\n            this._valueDec = 0;\r\n        }\r\n        else {\r\n            this.isHexOnly = false;\r\n            if (this.valueHexView.length > 0) {\r\n                this._valueDec = pvutils.utilDecodeTC.call(this);\r\n            }\r\n        }\r\n    }\r\n    set valueDec(v) {\r\n        this._valueDec = v;\r\n        this.isHexOnly = false;\r\n        this.valueHexView = new Uint8Array(pvutils.utilEncodeTC(v));\r\n    }\r\n    get valueDec() {\r\n        return this._valueDec;\r\n    }\r\n    fromDER(inputBuffer, inputOffset, inputLength, expectedLength = 0) {\r\n        const offset = this.fromBER(inputBuffer, inputOffset, inputLength);\r\n        if (offset === -1)\r\n            return offset;\r\n        const view = this.valueHexView;\r\n        if ((view[0] === 0x00) && ((view[1] & 0x80) !== 0)) {\r\n            this.valueHexView = view.subarray(1);\r\n        }\r\n        else {\r\n            if (expectedLength !== 0) {\r\n                if (view.length < expectedLength) {\r\n                    if ((expectedLength - view.length) > 1)\r\n                        expectedLength = view.length + 1;\r\n                    this.valueHexView = view.subarray(expectedLength - view.length);\r\n                }\r\n            }\r\n        }\r\n        return offset;\r\n    }\r\n    toDER(sizeOnly = false) {\r\n        const view = this.valueHexView;\r\n        switch (true) {\r\n            case ((view[0] & 0x80) !== 0):\r\n                {\r\n                    const updatedView = new Uint8Array(this.valueHexView.length + 1);\r\n                    updatedView[0] = 0x00;\r\n                    updatedView.set(view, 1);\r\n                    this.valueHexView = updatedView;\r\n                }\r\n                break;\r\n            case ((view[0] === 0x00) && ((view[1] & 0x80) === 0)):\r\n                {\r\n                    this.valueHexView = this.valueHexView.subarray(1);\r\n                }\r\n                break;\r\n        }\r\n        return this.toBER(sizeOnly);\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const resultOffset = super.fromBER(inputBuffer, inputOffset, inputLength);\r\n        if (resultOffset === -1) {\r\n            return resultOffset;\r\n        }\r\n        this.setValueHex();\r\n        return resultOffset;\r\n    }\r\n    toBER(sizeOnly) {\r\n        return sizeOnly\r\n            ? new ArrayBuffer(this.valueHexView.length)\r\n            : this.valueHexView.slice().buffer;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            valueDec: this.valueDec,\r\n        };\r\n    }\r\n    toString() {\r\n        const firstBit = (this.valueHexView.length * 8) - 1;\r\n        let digits = new Uint8Array((this.valueHexView.length * 8) / 3);\r\n        let bitNumber = 0;\r\n        let currentByte;\r\n        const asn1View = this.valueHexView;\r\n        let result = \"\";\r\n        let flag = false;\r\n        for (let byteNumber = (asn1View.byteLength - 1); byteNumber >= 0; byteNumber--) {\r\n            currentByte = asn1View[byteNumber];\r\n            for (let i = 0; i < 8; i++) {\r\n                if ((currentByte & 1) === 1) {\r\n                    switch (bitNumber) {\r\n                        case firstBit:\r\n                            digits = viewSub(power2(bitNumber), digits);\r\n                            result = \"-\";\r\n                            break;\r\n                        default:\r\n                            digits = viewAdd(digits, power2(bitNumber));\r\n                    }\r\n                }\r\n                bitNumber++;\r\n                currentByte >>= 1;\r\n            }\r\n        }\r\n        for (let i = 0; i < digits.length; i++) {\r\n            if (digits[i])\r\n                flag = true;\r\n            if (flag)\r\n                result += digitsString.charAt(digits[i]);\r\n        }\r\n        if (flag === false)\r\n            result += digitsString.charAt(0);\r\n        return result;\r\n    }\r\n}\r\n_a$p = LocalIntegerValueBlock;\r\nLocalIntegerValueBlock.NAME = \"IntegerValueBlock\";\r\n(() => {\r\n    Object.defineProperty(_a$p.prototype, \"valueHex\", {\r\n        set: function (v) {\r\n            this.valueHexView = new Uint8Array(v);\r\n            this.setValueHex();\r\n        },\r\n        get: function () {\r\n            return this.valueHexView.slice().buffer;\r\n        },\r\n    });\r\n})();\n\nvar _a$o;\r\nclass Integer extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, LocalIntegerValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 2;\r\n    }\r\n    toBigInt() {\r\n        assertBigInt();\r\n        return BigInt(this.valueBlock.toString());\r\n    }\r\n    static fromBigInt(value) {\r\n        assertBigInt();\r\n        const bigIntValue = BigInt(value);\r\n        const writer = new ViewWriter();\r\n        const hex = bigIntValue.toString(16).replace(/^-/, \"\");\r\n        const view = new Uint8Array(pvtsutils.Convert.FromHex(hex));\r\n        if (bigIntValue < 0) {\r\n            const first = new Uint8Array(view.length + (view[0] & 0x80 ? 1 : 0));\r\n            first[0] |= 0x80;\r\n            const firstInt = BigInt(`0x${pvtsutils.Convert.ToHex(first)}`);\r\n            const secondInt = firstInt + bigIntValue;\r\n            const second = pvtsutils.BufferSourceConverter.toUint8Array(pvtsutils.Convert.FromHex(secondInt.toString(16)));\r\n            second[0] |= 0x80;\r\n            writer.write(second);\r\n        }\r\n        else {\r\n            if (view[0] & 0x80) {\r\n                writer.write(new Uint8Array([0]));\r\n            }\r\n            writer.write(view);\r\n        }\r\n        const res = new Integer({\r\n            valueHex: writer.final(),\r\n        });\r\n        return res;\r\n    }\r\n    convertToDER() {\r\n        const integer = new Integer({ valueHex: this.valueBlock.valueHexView });\r\n        integer.valueBlock.toDER();\r\n        return integer;\r\n    }\r\n    convertFromDER() {\r\n        return new Integer({\r\n            valueHex: this.valueBlock.valueHexView[0] === 0\r\n                ? this.valueBlock.valueHexView.subarray(1)\r\n                : this.valueBlock.valueHexView,\r\n        });\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME} : ${this.valueBlock.toString()}`;\r\n    }\r\n}\r\n_a$o = Integer;\r\n(() => {\r\n    typeStore.Integer = _a$o;\r\n})();\r\nInteger.NAME = \"INTEGER\";\n\nvar _a$n;\r\nclass Enumerated extends Integer {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 10;\r\n    }\r\n}\r\n_a$n = Enumerated;\r\n(() => {\r\n    typeStore.Enumerated = _a$n;\r\n})();\r\nEnumerated.NAME = \"ENUMERATED\";\n\nclass LocalSidValueBlock extends HexBlock(ValueBlock) {\r\n    constructor({ valueDec = -1, isFirstSid = false, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.valueDec = valueDec;\r\n        this.isFirstSid = isFirstSid;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        if (!inputLength) {\r\n            return inputOffset;\r\n        }\r\n        const inputView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        if (!checkBufferParams(this, inputView, inputOffset, inputLength)) {\r\n            return -1;\r\n        }\r\n        const intBuffer = inputView.subarray(inputOffset, inputOffset + inputLength);\r\n        this.valueHexView = new Uint8Array(inputLength);\r\n        for (let i = 0; i < inputLength; i++) {\r\n            this.valueHexView[i] = intBuffer[i] & 0x7F;\r\n            this.blockLength++;\r\n            if ((intBuffer[i] & 0x80) === 0x00)\r\n                break;\r\n        }\r\n        const tempView = new Uint8Array(this.blockLength);\r\n        for (let i = 0; i < this.blockLength; i++) {\r\n            tempView[i] = this.valueHexView[i];\r\n        }\r\n        this.valueHexView = tempView;\r\n        if ((intBuffer[this.blockLength - 1] & 0x80) !== 0x00) {\r\n            this.error = \"End of input reached before message was fully decoded\";\r\n            return -1;\r\n        }\r\n        if (this.valueHexView[0] === 0x00)\r\n            this.warnings.push(\"Needlessly long format of SID encoding\");\r\n        if (this.blockLength <= 8)\r\n            this.valueDec = pvutils.utilFromBase(this.valueHexView, 7);\r\n        else {\r\n            this.isHexOnly = true;\r\n            this.warnings.push(\"Too big SID for decoding, hex only\");\r\n        }\r\n        return (inputOffset + this.blockLength);\r\n    }\r\n    set valueBigInt(value) {\r\n        assertBigInt();\r\n        let bits = BigInt(value).toString(2);\r\n        while (bits.length % 7) {\r\n            bits = \"0\" + bits;\r\n        }\r\n        const bytes = new Uint8Array(bits.length / 7);\r\n        for (let i = 0; i < bytes.length; i++) {\r\n            bytes[i] = parseInt(bits.slice(i * 7, i * 7 + 7), 2) + (i + 1 < bytes.length ? 0x80 : 0);\r\n        }\r\n        this.fromBER(bytes.buffer, 0, bytes.length);\r\n    }\r\n    toBER(sizeOnly) {\r\n        if (this.isHexOnly) {\r\n            if (sizeOnly)\r\n                return (new ArrayBuffer(this.valueHexView.byteLength));\r\n            const curView = this.valueHexView;\r\n            const retView = new Uint8Array(this.blockLength);\r\n            for (let i = 0; i < (this.blockLength - 1); i++)\r\n                retView[i] = curView[i] | 0x80;\r\n            retView[this.blockLength - 1] = curView[this.blockLength - 1];\r\n            return retView.buffer;\r\n        }\r\n        const encodedBuf = pvutils.utilToBase(this.valueDec, 7);\r\n        if (encodedBuf.byteLength === 0) {\r\n            this.error = \"Error during encoding SID value\";\r\n            return EMPTY_BUFFER;\r\n        }\r\n        const retView = new Uint8Array(encodedBuf.byteLength);\r\n        if (!sizeOnly) {\r\n            const encodedView = new Uint8Array(encodedBuf);\r\n            const len = encodedBuf.byteLength - 1;\r\n            for (let i = 0; i < len; i++)\r\n                retView[i] = encodedView[i] | 0x80;\r\n            retView[len] = encodedView[len];\r\n        }\r\n        return retView;\r\n    }\r\n    toString() {\r\n        let result = \"\";\r\n        if (this.isHexOnly)\r\n            result = pvtsutils.Convert.ToHex(this.valueHexView);\r\n        else {\r\n            if (this.isFirstSid) {\r\n                let sidValue = this.valueDec;\r\n                if (this.valueDec <= 39)\r\n                    result = \"0.\";\r\n                else {\r\n                    if (this.valueDec <= 79) {\r\n                        result = \"1.\";\r\n                        sidValue -= 40;\r\n                    }\r\n                    else {\r\n                        result = \"2.\";\r\n                        sidValue -= 80;\r\n                    }\r\n                }\r\n                result += sidValue.toString();\r\n            }\r\n            else\r\n                result = this.valueDec.toString();\r\n        }\r\n        return result;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            valueDec: this.valueDec,\r\n            isFirstSid: this.isFirstSid,\r\n        };\r\n    }\r\n}\r\nLocalSidValueBlock.NAME = \"sidBlock\";\n\nclass LocalObjectIdentifierValueBlock extends ValueBlock {\r\n    constructor({ value = EMPTY_STRING, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.value = [];\r\n        if (value) {\r\n            this.fromString(value);\r\n        }\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        let resultOffset = inputOffset;\r\n        while (inputLength > 0) {\r\n            const sidBlock = new LocalSidValueBlock();\r\n            resultOffset = sidBlock.fromBER(inputBuffer, resultOffset, inputLength);\r\n            if (resultOffset === -1) {\r\n                this.blockLength = 0;\r\n                this.error = sidBlock.error;\r\n                return resultOffset;\r\n            }\r\n            if (this.value.length === 0)\r\n                sidBlock.isFirstSid = true;\r\n            this.blockLength += sidBlock.blockLength;\r\n            inputLength -= sidBlock.blockLength;\r\n            this.value.push(sidBlock);\r\n        }\r\n        return resultOffset;\r\n    }\r\n    toBER(sizeOnly) {\r\n        const retBuffers = [];\r\n        for (let i = 0; i < this.value.length; i++) {\r\n            const valueBuf = this.value[i].toBER(sizeOnly);\r\n            if (valueBuf.byteLength === 0) {\r\n                this.error = this.value[i].error;\r\n                return EMPTY_BUFFER;\r\n            }\r\n            retBuffers.push(valueBuf);\r\n        }\r\n        return concat(retBuffers);\r\n    }\r\n    fromString(string) {\r\n        this.value = [];\r\n        let pos1 = 0;\r\n        let pos2 = 0;\r\n        let sid = \"\";\r\n        let flag = false;\r\n        do {\r\n            pos2 = string.indexOf(\".\", pos1);\r\n            if (pos2 === -1)\r\n                sid = string.substring(pos1);\r\n            else\r\n                sid = string.substring(pos1, pos2);\r\n            pos1 = pos2 + 1;\r\n            if (flag) {\r\n                const sidBlock = this.value[0];\r\n                let plus = 0;\r\n                switch (sidBlock.valueDec) {\r\n                    case 0:\r\n                        break;\r\n                    case 1:\r\n                        plus = 40;\r\n                        break;\r\n                    case 2:\r\n                        plus = 80;\r\n                        break;\r\n                    default:\r\n                        this.value = [];\r\n                        return;\r\n                }\r\n                const parsedSID = parseInt(sid, 10);\r\n                if (isNaN(parsedSID))\r\n                    return;\r\n                sidBlock.valueDec = parsedSID + plus;\r\n                flag = false;\r\n            }\r\n            else {\r\n                const sidBlock = new LocalSidValueBlock();\r\n                if (sid > Number.MAX_SAFE_INTEGER) {\r\n                    assertBigInt();\r\n                    const sidValue = BigInt(sid);\r\n                    sidBlock.valueBigInt = sidValue;\r\n                }\r\n                else {\r\n                    sidBlock.valueDec = parseInt(sid, 10);\r\n                    if (isNaN(sidBlock.valueDec))\r\n                        return;\r\n                }\r\n                if (!this.value.length) {\r\n                    sidBlock.isFirstSid = true;\r\n                    flag = true;\r\n                }\r\n                this.value.push(sidBlock);\r\n            }\r\n        } while (pos2 !== -1);\r\n    }\r\n    toString() {\r\n        let result = \"\";\r\n        let isHexOnly = false;\r\n        for (let i = 0; i < this.value.length; i++) {\r\n            isHexOnly = this.value[i].isHexOnly;\r\n            let sidStr = this.value[i].toString();\r\n            if (i !== 0)\r\n                result = `${result}.`;\r\n            if (isHexOnly) {\r\n                sidStr = `{${sidStr}}`;\r\n                if (this.value[i].isFirstSid)\r\n                    result = `2.{${sidStr} - 80}`;\r\n                else\r\n                    result += sidStr;\r\n            }\r\n            else\r\n                result += sidStr;\r\n        }\r\n        return result;\r\n    }\r\n    toJSON() {\r\n        const object = {\r\n            ...super.toJSON(),\r\n            value: this.toString(),\r\n            sidArray: [],\r\n        };\r\n        for (let i = 0; i < this.value.length; i++) {\r\n            object.sidArray.push(this.value[i].toJSON());\r\n        }\r\n        return object;\r\n    }\r\n}\r\nLocalObjectIdentifierValueBlock.NAME = \"ObjectIdentifierValueBlock\";\n\nvar _a$m;\r\nclass ObjectIdentifier extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, LocalObjectIdentifierValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 6;\r\n    }\r\n    getValue() {\r\n        return this.valueBlock.toString();\r\n    }\r\n    setValue(value) {\r\n        this.valueBlock.fromString(value);\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME} : ${this.valueBlock.toString() || \"empty\"}`;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            value: this.getValue(),\r\n        };\r\n    }\r\n}\r\n_a$m = ObjectIdentifier;\r\n(() => {\r\n    typeStore.ObjectIdentifier = _a$m;\r\n})();\r\nObjectIdentifier.NAME = \"OBJECT IDENTIFIER\";\n\nclass LocalRelativeSidValueBlock extends HexBlock(LocalBaseBlock) {\r\n    constructor({ valueDec = 0, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.valueDec = valueDec;\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        if (inputLength === 0)\r\n            return inputOffset;\r\n        const inputView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        if (!checkBufferParams(this, inputView, inputOffset, inputLength))\r\n            return -1;\r\n        const intBuffer = inputView.subarray(inputOffset, inputOffset + inputLength);\r\n        this.valueHexView = new Uint8Array(inputLength);\r\n        for (let i = 0; i < inputLength; i++) {\r\n            this.valueHexView[i] = intBuffer[i] & 0x7F;\r\n            this.blockLength++;\r\n            if ((intBuffer[i] & 0x80) === 0x00)\r\n                break;\r\n        }\r\n        const tempView = new Uint8Array(this.blockLength);\r\n        for (let i = 0; i < this.blockLength; i++)\r\n            tempView[i] = this.valueHexView[i];\r\n        this.valueHexView = tempView;\r\n        if ((intBuffer[this.blockLength - 1] & 0x80) !== 0x00) {\r\n            this.error = \"End of input reached before message was fully decoded\";\r\n            return -1;\r\n        }\r\n        if (this.valueHexView[0] === 0x00)\r\n            this.warnings.push(\"Needlessly long format of SID encoding\");\r\n        if (this.blockLength <= 8)\r\n            this.valueDec = pvutils.utilFromBase(this.valueHexView, 7);\r\n        else {\r\n            this.isHexOnly = true;\r\n            this.warnings.push(\"Too big SID for decoding, hex only\");\r\n        }\r\n        return (inputOffset + this.blockLength);\r\n    }\r\n    toBER(sizeOnly) {\r\n        if (this.isHexOnly) {\r\n            if (sizeOnly)\r\n                return (new ArrayBuffer(this.valueHexView.byteLength));\r\n            const curView = this.valueHexView;\r\n            const retView = new Uint8Array(this.blockLength);\r\n            for (let i = 0; i < (this.blockLength - 1); i++)\r\n                retView[i] = curView[i] | 0x80;\r\n            retView[this.blockLength - 1] = curView[this.blockLength - 1];\r\n            return retView.buffer;\r\n        }\r\n        const encodedBuf = pvutils.utilToBase(this.valueDec, 7);\r\n        if (encodedBuf.byteLength === 0) {\r\n            this.error = \"Error during encoding SID value\";\r\n            return EMPTY_BUFFER;\r\n        }\r\n        const retView = new Uint8Array(encodedBuf.byteLength);\r\n        if (!sizeOnly) {\r\n            const encodedView = new Uint8Array(encodedBuf);\r\n            const len = encodedBuf.byteLength - 1;\r\n            for (let i = 0; i < len; i++)\r\n                retView[i] = encodedView[i] | 0x80;\r\n            retView[len] = encodedView[len];\r\n        }\r\n        return retView.buffer;\r\n    }\r\n    toString() {\r\n        let result = \"\";\r\n        if (this.isHexOnly)\r\n            result = pvtsutils.Convert.ToHex(this.valueHexView);\r\n        else {\r\n            result = this.valueDec.toString();\r\n        }\r\n        return result;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            valueDec: this.valueDec,\r\n        };\r\n    }\r\n}\r\nLocalRelativeSidValueBlock.NAME = \"relativeSidBlock\";\n\nclass LocalRelativeObjectIdentifierValueBlock extends ValueBlock {\r\n    constructor({ value = EMPTY_STRING, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.value = [];\r\n        if (value) {\r\n            this.fromString(value);\r\n        }\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        let resultOffset = inputOffset;\r\n        while (inputLength > 0) {\r\n            const sidBlock = new LocalRelativeSidValueBlock();\r\n            resultOffset = sidBlock.fromBER(inputBuffer, resultOffset, inputLength);\r\n            if (resultOffset === -1) {\r\n                this.blockLength = 0;\r\n                this.error = sidBlock.error;\r\n                return resultOffset;\r\n            }\r\n            this.blockLength += sidBlock.blockLength;\r\n            inputLength -= sidBlock.blockLength;\r\n            this.value.push(sidBlock);\r\n        }\r\n        return resultOffset;\r\n    }\r\n    toBER(sizeOnly, writer) {\r\n        const retBuffers = [];\r\n        for (let i = 0; i < this.value.length; i++) {\r\n            const valueBuf = this.value[i].toBER(sizeOnly);\r\n            if (valueBuf.byteLength === 0) {\r\n                this.error = this.value[i].error;\r\n                return EMPTY_BUFFER;\r\n            }\r\n            retBuffers.push(valueBuf);\r\n        }\r\n        return concat(retBuffers);\r\n    }\r\n    fromString(string) {\r\n        this.value = [];\r\n        let pos1 = 0;\r\n        let pos2 = 0;\r\n        let sid = \"\";\r\n        do {\r\n            pos2 = string.indexOf(\".\", pos1);\r\n            if (pos2 === -1)\r\n                sid = string.substring(pos1);\r\n            else\r\n                sid = string.substring(pos1, pos2);\r\n            pos1 = pos2 + 1;\r\n            const sidBlock = new LocalRelativeSidValueBlock();\r\n            sidBlock.valueDec = parseInt(sid, 10);\r\n            if (isNaN(sidBlock.valueDec))\r\n                return true;\r\n            this.value.push(sidBlock);\r\n        } while (pos2 !== -1);\r\n        return true;\r\n    }\r\n    toString() {\r\n        let result = \"\";\r\n        let isHexOnly = false;\r\n        for (let i = 0; i < this.value.length; i++) {\r\n            isHexOnly = this.value[i].isHexOnly;\r\n            let sidStr = this.value[i].toString();\r\n            if (i !== 0)\r\n                result = `${result}.`;\r\n            if (isHexOnly) {\r\n                sidStr = `{${sidStr}}`;\r\n                result += sidStr;\r\n            }\r\n            else\r\n                result += sidStr;\r\n        }\r\n        return result;\r\n    }\r\n    toJSON() {\r\n        const object = {\r\n            ...super.toJSON(),\r\n            value: this.toString(),\r\n            sidArray: [],\r\n        };\r\n        for (let i = 0; i < this.value.length; i++)\r\n            object.sidArray.push(this.value[i].toJSON());\r\n        return object;\r\n    }\r\n}\r\nLocalRelativeObjectIdentifierValueBlock.NAME = \"RelativeObjectIdentifierValueBlock\";\n\nvar _a$l;\r\nclass RelativeObjectIdentifier extends BaseBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters, LocalRelativeObjectIdentifierValueBlock);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 13;\r\n    }\r\n    getValue() {\r\n        return this.valueBlock.toString();\r\n    }\r\n    setValue(value) {\r\n        this.valueBlock.fromString(value);\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME} : ${this.valueBlock.toString() || \"empty\"}`;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            value: this.getValue(),\r\n        };\r\n    }\r\n}\r\n_a$l = RelativeObjectIdentifier;\r\n(() => {\r\n    typeStore.RelativeObjectIdentifier = _a$l;\r\n})();\r\nRelativeObjectIdentifier.NAME = \"RelativeObjectIdentifier\";\n\nvar _a$k;\r\nclass Sequence extends Constructed {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 16;\r\n    }\r\n}\r\n_a$k = Sequence;\r\n(() => {\r\n    typeStore.Sequence = _a$k;\r\n})();\r\nSequence.NAME = \"SEQUENCE\";\n\nvar _a$j;\r\nclass Set extends Constructed {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 17;\r\n    }\r\n}\r\n_a$j = Set;\r\n(() => {\r\n    typeStore.Set = _a$j;\r\n})();\r\nSet.NAME = \"SET\";\n\nclass LocalStringValueBlock extends HexBlock(ValueBlock) {\r\n    constructor({ ...parameters } = {}) {\r\n        super(parameters);\r\n        this.isHexOnly = true;\r\n        this.value = EMPTY_STRING;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            value: this.value,\r\n        };\r\n    }\r\n}\r\nLocalStringValueBlock.NAME = \"StringValueBlock\";\n\nclass LocalSimpleStringValueBlock extends LocalStringValueBlock {\r\n}\r\nLocalSimpleStringValueBlock.NAME = \"SimpleStringValueBlock\";\n\nclass LocalSimpleStringBlock extends BaseStringBlock {\r\n    constructor({ ...parameters } = {}) {\r\n        super(parameters, LocalSimpleStringValueBlock);\r\n    }\r\n    fromBuffer(inputBuffer) {\r\n        this.valueBlock.value = String.fromCharCode.apply(null, pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer));\r\n    }\r\n    fromString(inputString) {\r\n        const strLen = inputString.length;\r\n        const view = this.valueBlock.valueHexView = new Uint8Array(strLen);\r\n        for (let i = 0; i < strLen; i++)\r\n            view[i] = inputString.charCodeAt(i);\r\n        this.valueBlock.value = inputString;\r\n    }\r\n}\r\nLocalSimpleStringBlock.NAME = \"SIMPLE STRING\";\n\nclass LocalUtf8StringValueBlock extends LocalSimpleStringBlock {\r\n    fromBuffer(inputBuffer) {\r\n        this.valueBlock.valueHexView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n        try {\r\n            this.valueBlock.value = pvtsutils.Convert.ToUtf8String(inputBuffer);\r\n        }\r\n        catch (ex) {\r\n            this.warnings.push(`Error during \"decodeURIComponent\": ${ex}, using raw string`);\r\n            this.valueBlock.value = pvtsutils.Convert.ToBinary(inputBuffer);\r\n        }\r\n    }\r\n    fromString(inputString) {\r\n        this.valueBlock.valueHexView = new Uint8Array(pvtsutils.Convert.FromUtf8String(inputString));\r\n        this.valueBlock.value = inputString;\r\n    }\r\n}\r\nLocalUtf8StringValueBlock.NAME = \"Utf8StringValueBlock\";\n\nvar _a$i;\r\nclass Utf8String extends LocalUtf8StringValueBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 12;\r\n    }\r\n}\r\n_a$i = Utf8String;\r\n(() => {\r\n    typeStore.Utf8String = _a$i;\r\n})();\r\nUtf8String.NAME = \"UTF8String\";\n\nclass LocalBmpStringValueBlock extends LocalSimpleStringBlock {\r\n    fromBuffer(inputBuffer) {\r\n        this.valueBlock.value = pvtsutils.Convert.ToUtf16String(inputBuffer);\r\n        this.valueBlock.valueHexView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer);\r\n    }\r\n    fromString(inputString) {\r\n        this.valueBlock.value = inputString;\r\n        this.valueBlock.valueHexView = new Uint8Array(pvtsutils.Convert.FromUtf16String(inputString));\r\n    }\r\n}\r\nLocalBmpStringValueBlock.NAME = \"BmpStringValueBlock\";\n\nvar _a$h;\r\nclass BmpString extends LocalBmpStringValueBlock {\r\n    constructor({ ...parameters } = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 30;\r\n    }\r\n}\r\n_a$h = BmpString;\r\n(() => {\r\n    typeStore.BmpString = _a$h;\r\n})();\r\nBmpString.NAME = \"BMPString\";\n\nclass LocalUniversalStringValueBlock extends LocalSimpleStringBlock {\r\n    fromBuffer(inputBuffer) {\r\n        const copyBuffer = ArrayBuffer.isView(inputBuffer) ? inputBuffer.slice().buffer : inputBuffer.slice(0);\r\n        const valueView = new Uint8Array(copyBuffer);\r\n        for (let i = 0; i < valueView.length; i += 4) {\r\n            valueView[i] = valueView[i + 3];\r\n            valueView[i + 1] = valueView[i + 2];\r\n            valueView[i + 2] = 0x00;\r\n            valueView[i + 3] = 0x00;\r\n        }\r\n        this.valueBlock.value = String.fromCharCode.apply(null, new Uint32Array(copyBuffer));\r\n    }\r\n    fromString(inputString) {\r\n        const strLength = inputString.length;\r\n        const valueHexView = this.valueBlock.valueHexView = new Uint8Array(strLength * 4);\r\n        for (let i = 0; i < strLength; i++) {\r\n            const codeBuf = pvutils.utilToBase(inputString.charCodeAt(i), 8);\r\n            const codeView = new Uint8Array(codeBuf);\r\n            if (codeView.length > 4)\r\n                continue;\r\n            const dif = 4 - codeView.length;\r\n            for (let j = (codeView.length - 1); j >= 0; j--)\r\n                valueHexView[i * 4 + j + dif] = codeView[j];\r\n        }\r\n        this.valueBlock.value = inputString;\r\n    }\r\n}\r\nLocalUniversalStringValueBlock.NAME = \"UniversalStringValueBlock\";\n\nvar _a$g;\r\nclass UniversalString extends LocalUniversalStringValueBlock {\r\n    constructor({ ...parameters } = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 28;\r\n    }\r\n}\r\n_a$g = UniversalString;\r\n(() => {\r\n    typeStore.UniversalString = _a$g;\r\n})();\r\nUniversalString.NAME = \"UniversalString\";\n\nvar _a$f;\r\nclass NumericString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 18;\r\n    }\r\n}\r\n_a$f = NumericString;\r\n(() => {\r\n    typeStore.NumericString = _a$f;\r\n})();\r\nNumericString.NAME = \"NumericString\";\n\nvar _a$e;\r\nclass PrintableString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 19;\r\n    }\r\n}\r\n_a$e = PrintableString;\r\n(() => {\r\n    typeStore.PrintableString = _a$e;\r\n})();\r\nPrintableString.NAME = \"PrintableString\";\n\nvar _a$d;\r\nclass TeletexString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 20;\r\n    }\r\n}\r\n_a$d = TeletexString;\r\n(() => {\r\n    typeStore.TeletexString = _a$d;\r\n})();\r\nTeletexString.NAME = \"TeletexString\";\n\nvar _a$c;\r\nclass VideotexString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 21;\r\n    }\r\n}\r\n_a$c = VideotexString;\r\n(() => {\r\n    typeStore.VideotexString = _a$c;\r\n})();\r\nVideotexString.NAME = \"VideotexString\";\n\nvar _a$b;\r\nclass IA5String extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 22;\r\n    }\r\n}\r\n_a$b = IA5String;\r\n(() => {\r\n    typeStore.IA5String = _a$b;\r\n})();\r\nIA5String.NAME = \"IA5String\";\n\nvar _a$a;\r\nclass GraphicString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 25;\r\n    }\r\n}\r\n_a$a = GraphicString;\r\n(() => {\r\n    typeStore.GraphicString = _a$a;\r\n})();\r\nGraphicString.NAME = \"GraphicString\";\n\nvar _a$9;\r\nclass VisibleString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 26;\r\n    }\r\n}\r\n_a$9 = VisibleString;\r\n(() => {\r\n    typeStore.VisibleString = _a$9;\r\n})();\r\nVisibleString.NAME = \"VisibleString\";\n\nvar _a$8;\r\nclass GeneralString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 27;\r\n    }\r\n}\r\n_a$8 = GeneralString;\r\n(() => {\r\n    typeStore.GeneralString = _a$8;\r\n})();\r\nGeneralString.NAME = \"GeneralString\";\n\nvar _a$7;\r\nclass CharacterString extends LocalSimpleStringBlock {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 29;\r\n    }\r\n}\r\n_a$7 = CharacterString;\r\n(() => {\r\n    typeStore.CharacterString = _a$7;\r\n})();\r\nCharacterString.NAME = \"CharacterString\";\n\nvar _a$6;\r\nclass UTCTime extends VisibleString {\r\n    constructor({ value, valueDate, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.year = 0;\r\n        this.month = 0;\r\n        this.day = 0;\r\n        this.hour = 0;\r\n        this.minute = 0;\r\n        this.second = 0;\r\n        if (value) {\r\n            this.fromString(value);\r\n            this.valueBlock.valueHexView = new Uint8Array(value.length);\r\n            for (let i = 0; i < value.length; i++)\r\n                this.valueBlock.valueHexView[i] = value.charCodeAt(i);\r\n        }\r\n        if (valueDate) {\r\n            this.fromDate(valueDate);\r\n            this.valueBlock.valueHexView = new Uint8Array(this.toBuffer());\r\n        }\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 23;\r\n    }\r\n    fromBuffer(inputBuffer) {\r\n        this.fromString(String.fromCharCode.apply(null, pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer)));\r\n    }\r\n    toBuffer() {\r\n        const str = this.toString();\r\n        const buffer = new ArrayBuffer(str.length);\r\n        const view = new Uint8Array(buffer);\r\n        for (let i = 0; i < str.length; i++)\r\n            view[i] = str.charCodeAt(i);\r\n        return buffer;\r\n    }\r\n    fromDate(inputDate) {\r\n        this.year = inputDate.getUTCFullYear();\r\n        this.month = inputDate.getUTCMonth() + 1;\r\n        this.day = inputDate.getUTCDate();\r\n        this.hour = inputDate.getUTCHours();\r\n        this.minute = inputDate.getUTCMinutes();\r\n        this.second = inputDate.getUTCSeconds();\r\n    }\r\n    toDate() {\r\n        return (new Date(Date.UTC(this.year, this.month - 1, this.day, this.hour, this.minute, this.second)));\r\n    }\r\n    fromString(inputString) {\r\n        const parser = /(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})Z/ig;\r\n        const parserArray = parser.exec(inputString);\r\n        if (parserArray === null) {\r\n            this.error = \"Wrong input string for conversion\";\r\n            return;\r\n        }\r\n        const year = parseInt(parserArray[1], 10);\r\n        if (year >= 50)\r\n            this.year = 1900 + year;\r\n        else\r\n            this.year = 2000 + year;\r\n        this.month = parseInt(parserArray[2], 10);\r\n        this.day = parseInt(parserArray[3], 10);\r\n        this.hour = parseInt(parserArray[4], 10);\r\n        this.minute = parseInt(parserArray[5], 10);\r\n        this.second = parseInt(parserArray[6], 10);\r\n    }\r\n    toString(encoding = \"iso\") {\r\n        if (encoding === \"iso\") {\r\n            const outputArray = new Array(7);\r\n            outputArray[0] = pvutils.padNumber(((this.year < 2000) ? (this.year - 1900) : (this.year - 2000)), 2);\r\n            outputArray[1] = pvutils.padNumber(this.month, 2);\r\n            outputArray[2] = pvutils.padNumber(this.day, 2);\r\n            outputArray[3] = pvutils.padNumber(this.hour, 2);\r\n            outputArray[4] = pvutils.padNumber(this.minute, 2);\r\n            outputArray[5] = pvutils.padNumber(this.second, 2);\r\n            outputArray[6] = \"Z\";\r\n            return outputArray.join(\"\");\r\n        }\r\n        return super.toString(encoding);\r\n    }\r\n    onAsciiEncoding() {\r\n        return `${this.constructor.NAME} : ${this.toDate().toISOString()}`;\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            year: this.year,\r\n            month: this.month,\r\n            day: this.day,\r\n            hour: this.hour,\r\n            minute: this.minute,\r\n            second: this.second,\r\n        };\r\n    }\r\n}\r\n_a$6 = UTCTime;\r\n(() => {\r\n    typeStore.UTCTime = _a$6;\r\n})();\r\nUTCTime.NAME = \"UTCTime\";\n\nvar _a$5;\r\nclass GeneralizedTime extends UTCTime {\r\n    constructor(parameters = {}) {\r\n        var _b;\r\n        super(parameters);\r\n        (_b = this.millisecond) !== null && _b !== void 0 ? _b : (this.millisecond = 0);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 24;\r\n    }\r\n    fromDate(inputDate) {\r\n        super.fromDate(inputDate);\r\n        this.millisecond = inputDate.getUTCMilliseconds();\r\n    }\r\n    toDate() {\r\n        return (new Date(Date.UTC(this.year, this.month - 1, this.day, this.hour, this.minute, this.second, this.millisecond)));\r\n    }\r\n    fromString(inputString) {\r\n        let isUTC = false;\r\n        let timeString = \"\";\r\n        let dateTimeString = \"\";\r\n        let fractionPart = 0;\r\n        let parser;\r\n        let hourDifference = 0;\r\n        let minuteDifference = 0;\r\n        if (inputString[inputString.length - 1] === \"Z\") {\r\n            timeString = inputString.substring(0, inputString.length - 1);\r\n            isUTC = true;\r\n        }\r\n        else {\r\n            const number = new Number(inputString[inputString.length - 1]);\r\n            if (isNaN(number.valueOf()))\r\n                throw new Error(\"Wrong input string for conversion\");\r\n            timeString = inputString;\r\n        }\r\n        if (isUTC) {\r\n            if (timeString.indexOf(\"+\") !== -1)\r\n                throw new Error(\"Wrong input string for conversion\");\r\n            if (timeString.indexOf(\"-\") !== -1)\r\n                throw new Error(\"Wrong input string for conversion\");\r\n        }\r\n        else {\r\n            let multiplier = 1;\r\n            let differencePosition = timeString.indexOf(\"+\");\r\n            let differenceString = \"\";\r\n            if (differencePosition === -1) {\r\n                differencePosition = timeString.indexOf(\"-\");\r\n                multiplier = -1;\r\n            }\r\n            if (differencePosition !== -1) {\r\n                differenceString = timeString.substring(differencePosition + 1);\r\n                timeString = timeString.substring(0, differencePosition);\r\n                if ((differenceString.length !== 2) && (differenceString.length !== 4))\r\n                    throw new Error(\"Wrong input string for conversion\");\r\n                let number = parseInt(differenceString.substring(0, 2), 10);\r\n                if (isNaN(number.valueOf()))\r\n                    throw new Error(\"Wrong input string for conversion\");\r\n                hourDifference = multiplier * number;\r\n                if (differenceString.length === 4) {\r\n                    number = parseInt(differenceString.substring(2, 4), 10);\r\n                    if (isNaN(number.valueOf()))\r\n                        throw new Error(\"Wrong input string for conversion\");\r\n                    minuteDifference = multiplier * number;\r\n                }\r\n            }\r\n        }\r\n        let fractionPointPosition = timeString.indexOf(\".\");\r\n        if (fractionPointPosition === -1)\r\n            fractionPointPosition = timeString.indexOf(\",\");\r\n        if (fractionPointPosition !== -1) {\r\n            const fractionPartCheck = new Number(`0${timeString.substring(fractionPointPosition)}`);\r\n            if (isNaN(fractionPartCheck.valueOf()))\r\n                throw new Error(\"Wrong input string for conversion\");\r\n            fractionPart = fractionPartCheck.valueOf();\r\n            dateTimeString = timeString.substring(0, fractionPointPosition);\r\n        }\r\n        else\r\n            dateTimeString = timeString;\r\n        switch (true) {\r\n            case (dateTimeString.length === 8):\r\n                parser = /(\\d{4})(\\d{2})(\\d{2})/ig;\r\n                if (fractionPointPosition !== -1)\r\n                    throw new Error(\"Wrong input string for conversion\");\r\n                break;\r\n            case (dateTimeString.length === 10):\r\n                parser = /(\\d{4})(\\d{2})(\\d{2})(\\d{2})/ig;\r\n                if (fractionPointPosition !== -1) {\r\n                    let fractionResult = 60 * fractionPart;\r\n                    this.minute = Math.floor(fractionResult);\r\n                    fractionResult = 60 * (fractionResult - this.minute);\r\n                    this.second = Math.floor(fractionResult);\r\n                    fractionResult = 1000 * (fractionResult - this.second);\r\n                    this.millisecond = Math.floor(fractionResult);\r\n                }\r\n                break;\r\n            case (dateTimeString.length === 12):\r\n                parser = /(\\d{4})(\\d{2})(\\d{2})(\\d{2})(\\d{2})/ig;\r\n                if (fractionPointPosition !== -1) {\r\n                    let fractionResult = 60 * fractionPart;\r\n                    this.second = Math.floor(fractionResult);\r\n                    fractionResult = 1000 * (fractionResult - this.second);\r\n                    this.millisecond = Math.floor(fractionResult);\r\n                }\r\n                break;\r\n            case (dateTimeString.length === 14):\r\n                parser = /(\\d{4})(\\d{2})(\\d{2})(\\d{2})(\\d{2})(\\d{2})/ig;\r\n                if (fractionPointPosition !== -1) {\r\n                    const fractionResult = 1000 * fractionPart;\r\n                    this.millisecond = Math.floor(fractionResult);\r\n                }\r\n                break;\r\n            default:\r\n                throw new Error(\"Wrong input string for conversion\");\r\n        }\r\n        const parserArray = parser.exec(dateTimeString);\r\n        if (parserArray === null)\r\n            throw new Error(\"Wrong input string for conversion\");\r\n        for (let j = 1; j < parserArray.length; j++) {\r\n            switch (j) {\r\n                case 1:\r\n                    this.year = parseInt(parserArray[j], 10);\r\n                    break;\r\n                case 2:\r\n                    this.month = parseInt(parserArray[j], 10);\r\n                    break;\r\n                case 3:\r\n                    this.day = parseInt(parserArray[j], 10);\r\n                    break;\r\n                case 4:\r\n                    this.hour = parseInt(parserArray[j], 10) + hourDifference;\r\n                    break;\r\n                case 5:\r\n                    this.minute = parseInt(parserArray[j], 10) + minuteDifference;\r\n                    break;\r\n                case 6:\r\n                    this.second = parseInt(parserArray[j], 10);\r\n                    break;\r\n                default:\r\n                    throw new Error(\"Wrong input string for conversion\");\r\n            }\r\n        }\r\n        if (isUTC === false) {\r\n            const tempDate = new Date(this.year, this.month, this.day, this.hour, this.minute, this.second, this.millisecond);\r\n            this.year = tempDate.getUTCFullYear();\r\n            this.month = tempDate.getUTCMonth();\r\n            this.day = tempDate.getUTCDay();\r\n            this.hour = tempDate.getUTCHours();\r\n            this.minute = tempDate.getUTCMinutes();\r\n            this.second = tempDate.getUTCSeconds();\r\n            this.millisecond = tempDate.getUTCMilliseconds();\r\n        }\r\n    }\r\n    toString(encoding = \"iso\") {\r\n        if (encoding === \"iso\") {\r\n            const outputArray = [];\r\n            outputArray.push(pvutils.padNumber(this.year, 4));\r\n            outputArray.push(pvutils.padNumber(this.month, 2));\r\n            outputArray.push(pvutils.padNumber(this.day, 2));\r\n            outputArray.push(pvutils.padNumber(this.hour, 2));\r\n            outputArray.push(pvutils.padNumber(this.minute, 2));\r\n            outputArray.push(pvutils.padNumber(this.second, 2));\r\n            if (this.millisecond !== 0) {\r\n                outputArray.push(\".\");\r\n                outputArray.push(pvutils.padNumber(this.millisecond, 3));\r\n            }\r\n            outputArray.push(\"Z\");\r\n            return outputArray.join(\"\");\r\n        }\r\n        return super.toString(encoding);\r\n    }\r\n    toJSON() {\r\n        return {\r\n            ...super.toJSON(),\r\n            millisecond: this.millisecond,\r\n        };\r\n    }\r\n}\r\n_a$5 = GeneralizedTime;\r\n(() => {\r\n    typeStore.GeneralizedTime = _a$5;\r\n})();\r\nGeneralizedTime.NAME = \"GeneralizedTime\";\n\nvar _a$4;\r\nclass DATE extends Utf8String {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 31;\r\n    }\r\n}\r\n_a$4 = DATE;\r\n(() => {\r\n    typeStore.DATE = _a$4;\r\n})();\r\nDATE.NAME = \"DATE\";\n\nvar _a$3;\r\nclass TimeOfDay extends Utf8String {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 32;\r\n    }\r\n}\r\n_a$3 = TimeOfDay;\r\n(() => {\r\n    typeStore.TimeOfDay = _a$3;\r\n})();\r\nTimeOfDay.NAME = \"TimeOfDay\";\n\nvar _a$2;\r\nclass DateTime extends Utf8String {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 33;\r\n    }\r\n}\r\n_a$2 = DateTime;\r\n(() => {\r\n    typeStore.DateTime = _a$2;\r\n})();\r\nDateTime.NAME = \"DateTime\";\n\nvar _a$1;\r\nclass Duration extends Utf8String {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 34;\r\n    }\r\n}\r\n_a$1 = Duration;\r\n(() => {\r\n    typeStore.Duration = _a$1;\r\n})();\r\nDuration.NAME = \"Duration\";\n\nvar _a;\r\nclass TIME extends Utf8String {\r\n    constructor(parameters = {}) {\r\n        super(parameters);\r\n        this.idBlock.tagClass = 1;\r\n        this.idBlock.tagNumber = 14;\r\n    }\r\n}\r\n_a = TIME;\r\n(() => {\r\n    typeStore.TIME = _a;\r\n})();\r\nTIME.NAME = \"TIME\";\n\nclass Any {\r\n    constructor({ name = EMPTY_STRING, optional = false, } = {}) {\r\n        this.name = name;\r\n        this.optional = optional;\r\n    }\r\n}\n\nclass Choice extends Any {\r\n    constructor({ value = [], ...parameters } = {}) {\r\n        super(parameters);\r\n        this.value = value;\r\n    }\r\n}\n\nclass Repeated extends Any {\r\n    constructor({ value = new Any(), local = false, ...parameters } = {}) {\r\n        super(parameters);\r\n        this.value = value;\r\n        this.local = local;\r\n    }\r\n}\n\nclass RawData {\r\n    constructor({ data = EMPTY_VIEW } = {}) {\r\n        this.dataView = pvtsutils.BufferSourceConverter.toUint8Array(data);\r\n    }\r\n    get data() {\r\n        return this.dataView.slice().buffer;\r\n    }\r\n    set data(value) {\r\n        this.dataView = pvtsutils.BufferSourceConverter.toUint8Array(value);\r\n    }\r\n    fromBER(inputBuffer, inputOffset, inputLength) {\r\n        const endLength = inputOffset + inputLength;\r\n        this.dataView = pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer).subarray(inputOffset, endLength);\r\n        return endLength;\r\n    }\r\n    toBER(sizeOnly) {\r\n        return this.dataView.slice().buffer;\r\n    }\r\n}\n\nfunction compareSchema(root, inputData, inputSchema) {\r\n    if (inputSchema instanceof Choice) {\r\n        for (let j = 0; j < inputSchema.value.length; j++) {\r\n            const result = compareSchema(root, inputData, inputSchema.value[j]);\r\n            if (result.verified) {\r\n                return {\r\n                    verified: true,\r\n                    result: root\r\n                };\r\n            }\r\n        }\r\n        {\r\n            const _result = {\r\n                verified: false,\r\n                result: {\r\n                    error: \"Wrong values for Choice type\"\r\n                },\r\n            };\r\n            if (inputSchema.hasOwnProperty(NAME))\r\n                _result.name = inputSchema.name;\r\n            return _result;\r\n        }\r\n    }\r\n    if (inputSchema instanceof Any) {\r\n        if (inputSchema.hasOwnProperty(NAME))\r\n            root[inputSchema.name] = inputData;\r\n        return {\r\n            verified: true,\r\n            result: root\r\n        };\r\n    }\r\n    if ((root instanceof Object) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong root object\" }\r\n        };\r\n    }\r\n    if ((inputData instanceof Object) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 data\" }\r\n        };\r\n    }\r\n    if ((inputSchema instanceof Object) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    if ((ID_BLOCK in inputSchema) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    if ((FROM_BER in inputSchema.idBlock) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    if ((TO_BER in inputSchema.idBlock) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    const encodedId = inputSchema.idBlock.toBER(false);\r\n    if (encodedId.byteLength === 0) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Error encoding idBlock for ASN.1 schema\" }\r\n        };\r\n    }\r\n    const decodedOffset = inputSchema.idBlock.fromBER(encodedId, 0, encodedId.byteLength);\r\n    if (decodedOffset === -1) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Error decoding idBlock for ASN.1 schema\" }\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.hasOwnProperty(TAG_CLASS) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.tagClass !== inputData.idBlock.tagClass) {\r\n        return {\r\n            verified: false,\r\n            result: root\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.hasOwnProperty(TAG_NUMBER) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.tagNumber !== inputData.idBlock.tagNumber) {\r\n        return {\r\n            verified: false,\r\n            result: root\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.hasOwnProperty(IS_CONSTRUCTED) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.isConstructed !== inputData.idBlock.isConstructed) {\r\n        return {\r\n            verified: false,\r\n            result: root\r\n        };\r\n    }\r\n    if (!(IS_HEX_ONLY in inputSchema.idBlock)) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema\" }\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.isHexOnly !== inputData.idBlock.isHexOnly) {\r\n        return {\r\n            verified: false,\r\n            result: root\r\n        };\r\n    }\r\n    if (inputSchema.idBlock.isHexOnly) {\r\n        if ((VALUE_HEX_VIEW in inputSchema.idBlock) === false) {\r\n            return {\r\n                verified: false,\r\n                result: { error: \"Wrong ASN.1 schema\" }\r\n            };\r\n        }\r\n        const schemaView = inputSchema.idBlock.valueHexView;\r\n        const asn1View = inputData.idBlock.valueHexView;\r\n        if (schemaView.length !== asn1View.length) {\r\n            return {\r\n                verified: false,\r\n                result: root\r\n            };\r\n        }\r\n        for (let i = 0; i < schemaView.length; i++) {\r\n            if (schemaView[i] !== asn1View[1]) {\r\n                return {\r\n                    verified: false,\r\n                    result: root\r\n                };\r\n            }\r\n        }\r\n    }\r\n    if (inputSchema.name) {\r\n        inputSchema.name = inputSchema.name.replace(/^\\s+|\\s+$/g, EMPTY_STRING);\r\n        if (inputSchema.name)\r\n            root[inputSchema.name] = inputData;\r\n    }\r\n    if (inputSchema instanceof typeStore.Constructed) {\r\n        let admission = 0;\r\n        let result = {\r\n            verified: false,\r\n            result: {\r\n                error: \"Unknown error\",\r\n            }\r\n        };\r\n        let maxLength = inputSchema.valueBlock.value.length;\r\n        if (maxLength > 0) {\r\n            if (inputSchema.valueBlock.value[0] instanceof Repeated) {\r\n                maxLength = inputData.valueBlock.value.length;\r\n            }\r\n        }\r\n        if (maxLength === 0) {\r\n            return {\r\n                verified: true,\r\n                result: root\r\n            };\r\n        }\r\n        if ((inputData.valueBlock.value.length === 0) &&\r\n            (inputSchema.valueBlock.value.length !== 0)) {\r\n            let _optional = true;\r\n            for (let i = 0; i < inputSchema.valueBlock.value.length; i++)\r\n                _optional = _optional && (inputSchema.valueBlock.value[i].optional || false);\r\n            if (_optional) {\r\n                return {\r\n                    verified: true,\r\n                    result: root\r\n                };\r\n            }\r\n            if (inputSchema.name) {\r\n                inputSchema.name = inputSchema.name.replace(/^\\s+|\\s+$/g, EMPTY_STRING);\r\n                if (inputSchema.name)\r\n                    delete root[inputSchema.name];\r\n            }\r\n            root.error = \"Inconsistent object length\";\r\n            return {\r\n                verified: false,\r\n                result: root\r\n            };\r\n        }\r\n        for (let i = 0; i < maxLength; i++) {\r\n            if ((i - admission) >= inputData.valueBlock.value.length) {\r\n                if (inputSchema.valueBlock.value[i].optional === false) {\r\n                    const _result = {\r\n                        verified: false,\r\n                        result: root\r\n                    };\r\n                    root.error = \"Inconsistent length between ASN.1 data and schema\";\r\n                    if (inputSchema.name) {\r\n                        inputSchema.name = inputSchema.name.replace(/^\\s+|\\s+$/g, EMPTY_STRING);\r\n                        if (inputSchema.name) {\r\n                            delete root[inputSchema.name];\r\n                            _result.name = inputSchema.name;\r\n                        }\r\n                    }\r\n                    return _result;\r\n                }\r\n            }\r\n            else {\r\n                if (inputSchema.valueBlock.value[0] instanceof Repeated) {\r\n                    result = compareSchema(root, inputData.valueBlock.value[i], inputSchema.valueBlock.value[0].value);\r\n                    if (result.verified === false) {\r\n                        if (inputSchema.valueBlock.value[0].optional)\r\n                            admission++;\r\n                        else {\r\n                            if (inputSchema.name) {\r\n                                inputSchema.name = inputSchema.name.replace(/^\\s+|\\s+$/g, EMPTY_STRING);\r\n                                if (inputSchema.name)\r\n                                    delete root[inputSchema.name];\r\n                            }\r\n                            return result;\r\n                        }\r\n                    }\r\n                    if ((NAME in inputSchema.valueBlock.value[0]) && (inputSchema.valueBlock.value[0].name.length > 0)) {\r\n                        let arrayRoot = {};\r\n                        if ((LOCAL in inputSchema.valueBlock.value[0]) && (inputSchema.valueBlock.value[0].local))\r\n                            arrayRoot = inputData;\r\n                        else\r\n                            arrayRoot = root;\r\n                        if (typeof arrayRoot[inputSchema.valueBlock.value[0].name] === \"undefined\")\r\n                            arrayRoot[inputSchema.valueBlock.value[0].name] = [];\r\n                        arrayRoot[inputSchema.valueBlock.value[0].name].push(inputData.valueBlock.value[i]);\r\n                    }\r\n                }\r\n                else {\r\n                    result = compareSchema(root, inputData.valueBlock.value[i - admission], inputSchema.valueBlock.value[i]);\r\n                    if (result.verified === false) {\r\n                        if (inputSchema.valueBlock.value[i].optional)\r\n                            admission++;\r\n                        else {\r\n                            if (inputSchema.name) {\r\n                                inputSchema.name = inputSchema.name.replace(/^\\s+|\\s+$/g, EMPTY_STRING);\r\n                                if (inputSchema.name)\r\n                                    delete root[inputSchema.name];\r\n                            }\r\n                            return result;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (result.verified === false) {\r\n            const _result = {\r\n                verified: false,\r\n                result: root\r\n            };\r\n            if (inputSchema.name) {\r\n                inputSchema.name = inputSchema.name.replace(/^\\s+|\\s+$/g, EMPTY_STRING);\r\n                if (inputSchema.name) {\r\n                    delete root[inputSchema.name];\r\n                    _result.name = inputSchema.name;\r\n                }\r\n            }\r\n            return _result;\r\n        }\r\n        return {\r\n            verified: true,\r\n            result: root\r\n        };\r\n    }\r\n    if (inputSchema.primitiveSchema &&\r\n        (VALUE_HEX_VIEW in inputData.valueBlock)) {\r\n        const asn1 = localFromBER(inputData.valueBlock.valueHexView);\r\n        if (asn1.offset === -1) {\r\n            const _result = {\r\n                verified: false,\r\n                result: asn1.result\r\n            };\r\n            if (inputSchema.name) {\r\n                inputSchema.name = inputSchema.name.replace(/^\\s+|\\s+$/g, EMPTY_STRING);\r\n                if (inputSchema.name) {\r\n                    delete root[inputSchema.name];\r\n                    _result.name = inputSchema.name;\r\n                }\r\n            }\r\n            return _result;\r\n        }\r\n        return compareSchema(root, asn1.result, inputSchema.primitiveSchema);\r\n    }\r\n    return {\r\n        verified: true,\r\n        result: root\r\n    };\r\n}\r\nfunction verifySchema(inputBuffer, inputSchema) {\r\n    if ((inputSchema instanceof Object) === false) {\r\n        return {\r\n            verified: false,\r\n            result: { error: \"Wrong ASN.1 schema type\" }\r\n        };\r\n    }\r\n    const asn1 = localFromBER(pvtsutils.BufferSourceConverter.toUint8Array(inputBuffer));\r\n    if (asn1.offset === -1) {\r\n        return {\r\n            verified: false,\r\n            result: asn1.result\r\n        };\r\n    }\r\n    return compareSchema(asn1.result, asn1.result, inputSchema);\r\n}\n\nexport { Any, BaseBlock, BaseStringBlock, BitString, BmpString, Boolean, CharacterString, Choice, Constructed, DATE, DateTime, Duration, EndOfContent, Enumerated, GeneralString, GeneralizedTime, GraphicString, HexBlock, IA5String, Integer, Null, NumericString, ObjectIdentifier, OctetString, Primitive, PrintableString, RawData, RelativeObjectIdentifier, Repeated, Sequence, Set, TIME, TeletexString, TimeOfDay, UTCTime, UniversalString, Utf8String, ValueBlock, VideotexString, ViewWriter, VisibleString, compareSchema, fromBER, verifySchema };\n","export var AsnTypeTypes;\n(function (AsnTypeTypes) {\n    AsnTypeTypes[AsnTypeTypes[\"Sequence\"] = 0] = \"Sequence\";\n    AsnTypeTypes[AsnTypeTypes[\"Set\"] = 1] = \"Set\";\n    AsnTypeTypes[AsnTypeTypes[\"Choice\"] = 2] = \"Choice\";\n})(AsnTypeTypes || (AsnTypeTypes = {}));\nexport var AsnPropTypes;\n(function (AsnPropTypes) {\n    AsnPropTypes[AsnPropTypes[\"Any\"] = 1] = \"Any\";\n    AsnPropTypes[AsnPropTypes[\"Boolean\"] = 2] = \"Boolean\";\n    AsnPropTypes[AsnPropTypes[\"OctetString\"] = 3] = \"OctetString\";\n    AsnPropTypes[AsnPropTypes[\"BitString\"] = 4] = \"BitString\";\n    AsnPropTypes[AsnPropTypes[\"Integer\"] = 5] = \"Integer\";\n    AsnPropTypes[AsnPropTypes[\"Enumerated\"] = 6] = \"Enumerated\";\n    AsnPropTypes[AsnPropTypes[\"ObjectIdentifier\"] = 7] = \"ObjectIdentifier\";\n    AsnPropTypes[AsnPropTypes[\"Utf8String\"] = 8] = \"Utf8String\";\n    AsnPropTypes[AsnPropTypes[\"BmpString\"] = 9] = \"BmpString\";\n    AsnPropTypes[AsnPropTypes[\"UniversalString\"] = 10] = \"UniversalString\";\n    AsnPropTypes[AsnPropTypes[\"NumericString\"] = 11] = \"NumericString\";\n    AsnPropTypes[AsnPropTypes[\"PrintableString\"] = 12] = \"PrintableString\";\n    AsnPropTypes[AsnPropTypes[\"TeletexString\"] = 13] = \"TeletexString\";\n    AsnPropTypes[AsnPropTypes[\"VideotexString\"] = 14] = \"VideotexString\";\n    AsnPropTypes[AsnPropTypes[\"IA5String\"] = 15] = \"IA5String\";\n    AsnPropTypes[AsnPropTypes[\"GraphicString\"] = 16] = \"GraphicString\";\n    AsnPropTypes[AsnPropTypes[\"VisibleString\"] = 17] = \"VisibleString\";\n    AsnPropTypes[AsnPropTypes[\"GeneralString\"] = 18] = \"GeneralString\";\n    AsnPropTypes[AsnPropTypes[\"CharacterString\"] = 19] = \"CharacterString\";\n    AsnPropTypes[AsnPropTypes[\"UTCTime\"] = 20] = \"UTCTime\";\n    AsnPropTypes[AsnPropTypes[\"GeneralizedTime\"] = 21] = \"GeneralizedTime\";\n    AsnPropTypes[AsnPropTypes[\"DATE\"] = 22] = \"DATE\";\n    AsnPropTypes[AsnPropTypes[\"TimeOfDay\"] = 23] = \"TimeOfDay\";\n    AsnPropTypes[AsnPropTypes[\"DateTime\"] = 24] = \"DateTime\";\n    AsnPropTypes[AsnPropTypes[\"Duration\"] = 25] = \"Duration\";\n    AsnPropTypes[AsnPropTypes[\"TIME\"] = 26] = \"TIME\";\n    AsnPropTypes[AsnPropTypes[\"Null\"] = 27] = \"Null\";\n})(AsnPropTypes || (AsnPropTypes = {}));\n","import * as asn1js from \"asn1js\";\nimport { BufferSourceConverter } from \"pvtsutils\";\nexport class BitString {\n    constructor(params, unusedBits = 0) {\n        this.unusedBits = 0;\n        this.value = new ArrayBuffer(0);\n        if (params) {\n            if (typeof params === \"number\") {\n                this.fromNumber(params);\n            }\n            else if (BufferSourceConverter.isBufferSource(params)) {\n                this.unusedBits = unusedBits;\n                this.value = BufferSourceConverter.toArrayBuffer(params);\n            }\n            else {\n                throw TypeError(\"Unsupported type of 'params' argument for BitString\");\n            }\n        }\n    }\n    fromASN(asn) {\n        if (!(asn instanceof asn1js.BitString)) {\n            throw new TypeError(\"Argument 'asn' is not instance of ASN.1 BitString\");\n        }\n        this.unusedBits = asn.valueBlock.unusedBits;\n        this.value = asn.valueBlock.valueHex;\n        return this;\n    }\n    toASN() {\n        return new asn1js.BitString({ unusedBits: this.unusedBits, valueHex: this.value });\n    }\n    toSchema(name) {\n        return new asn1js.BitString({ name });\n    }\n    toNumber() {\n        let res = \"\";\n        const uintArray = new Uint8Array(this.value);\n        for (const octet of uintArray) {\n            res += octet.toString(2).padStart(8, \"0\");\n        }\n        res = res.split(\"\").reverse().join(\"\");\n        if (this.unusedBits) {\n            res = res.slice(this.unusedBits).padStart(this.unusedBits, \"0\");\n        }\n        return parseInt(res, 2);\n    }\n    fromNumber(value) {\n        let bits = value.toString(2);\n        const octetSize = (bits.length + 7) >> 3;\n        this.unusedBits = (octetSize << 3) - bits.length;\n        const octets = new Uint8Array(octetSize);\n        bits = bits\n            .padStart(octetSize << 3, \"0\")\n            .split(\"\")\n            .reverse()\n            .join(\"\");\n        let index = 0;\n        while (index < octetSize) {\n            octets[index] = parseInt(bits.slice(index << 3, (index << 3) + 8), 2);\n            index++;\n        }\n        this.value = octets.buffer;\n    }\n}\n","import * as asn1js from \"asn1js\";\nimport { BufferSourceConverter } from \"pvtsutils\";\nexport class OctetString {\n    get byteLength() {\n        return this.buffer.byteLength;\n    }\n    get byteOffset() {\n        return 0;\n    }\n    constructor(param) {\n        if (typeof param === \"number\") {\n            this.buffer = new ArrayBuffer(param);\n        }\n        else {\n            if (BufferSourceConverter.isBufferSource(param)) {\n                this.buffer = BufferSourceConverter.toArrayBuffer(param);\n            }\n            else if (Array.isArray(param)) {\n                this.buffer = new Uint8Array(param);\n            }\n            else {\n                this.buffer = new ArrayBuffer(0);\n            }\n        }\n    }\n    fromASN(asn) {\n        if (!(asn instanceof asn1js.OctetString)) {\n            throw new TypeError(\"Argument 'asn' is not instance of ASN.1 OctetString\");\n        }\n        this.buffer = asn.valueBlock.valueHex;\n        return this;\n    }\n    toASN() {\n        return new asn1js.OctetString({ valueHex: this.buffer });\n    }\n    toSchema(name) {\n        return new asn1js.OctetString({ name });\n    }\n}\n","import * as asn1js from \"asn1js\";\nimport { AsnPropTypes } from \"./enums\";\nimport { OctetString } from \"./types/index\";\nexport const AsnAnyConverter = {\n    fromASN: (value) => value instanceof asn1js.Null ? null : value.valueBeforeDecodeView,\n    toASN: (value) => {\n        if (value === null) {\n            return new asn1js.Null();\n        }\n        const schema = asn1js.fromBER(value);\n        if (schema.result.error) {\n            throw new Error(schema.result.error);\n        }\n        return schema.result;\n    },\n};\nexport const AsnIntegerConverter = {\n    fromASN: (value) => value.valueBlock.valueHexView.byteLength >= 4\n        ? value.valueBlock.toString()\n        : value.valueBlock.valueDec,\n    toASN: (value) => new asn1js.Integer({ value: +value }),\n};\nexport const AsnEnumeratedConverter = {\n    fromASN: (value) => value.valueBlock.valueDec,\n    toASN: (value) => new asn1js.Enumerated({ value }),\n};\nexport const AsnIntegerArrayBufferConverter = {\n    fromASN: (value) => value.valueBlock.valueHexView,\n    toASN: (value) => new asn1js.Integer({ valueHex: value }),\n};\nexport const AsnIntegerBigIntConverter = {\n    fromASN: (value) => value.toBigInt(),\n    toASN: (value) => asn1js.Integer.fromBigInt(value),\n};\nexport const AsnBitStringConverter = {\n    fromASN: (value) => value.valueBlock.valueHexView,\n    toASN: (value) => new asn1js.BitString({ valueHex: value }),\n};\nexport const AsnObjectIdentifierConverter = {\n    fromASN: (value) => value.valueBlock.toString(),\n    toASN: (value) => new asn1js.ObjectIdentifier({ value }),\n};\nexport const AsnBooleanConverter = {\n    fromASN: (value) => value.valueBlock.value,\n    toASN: (value) => new asn1js.Boolean({ value }),\n};\nexport const AsnOctetStringConverter = {\n    fromASN: (value) => value.valueBlock.valueHexView,\n    toASN: (value) => new asn1js.OctetString({ valueHex: value }),\n};\nexport const AsnConstructedOctetStringConverter = {\n    fromASN: (value) => new OctetString(value.getValue()),\n    toASN: (value) => value.toASN(),\n};\nfunction createStringConverter(Asn1Type) {\n    return {\n        fromASN: (value) => value.valueBlock.value,\n        toASN: (value) => new Asn1Type({ value }),\n    };\n}\nexport const AsnUtf8StringConverter = createStringConverter(asn1js.Utf8String);\nexport const AsnBmpStringConverter = createStringConverter(asn1js.BmpString);\nexport const AsnUniversalStringConverter = createStringConverter(asn1js.UniversalString);\nexport const AsnNumericStringConverter = createStringConverter(asn1js.NumericString);\nexport const AsnPrintableStringConverter = createStringConverter(asn1js.PrintableString);\nexport const AsnTeletexStringConverter = createStringConverter(asn1js.TeletexString);\nexport const AsnVideotexStringConverter = createStringConverter(asn1js.VideotexString);\nexport const AsnIA5StringConverter = createStringConverter(asn1js.IA5String);\nexport const AsnGraphicStringConverter = createStringConverter(asn1js.GraphicString);\nexport const AsnVisibleStringConverter = createStringConverter(asn1js.VisibleString);\nexport const AsnGeneralStringConverter = createStringConverter(asn1js.GeneralString);\nexport const AsnCharacterStringConverter = createStringConverter(asn1js.CharacterString);\nexport const AsnUTCTimeConverter = {\n    fromASN: (value) => value.toDate(),\n    toASN: (value) => new asn1js.UTCTime({ valueDate: value }),\n};\nexport const AsnGeneralizedTimeConverter = {\n    fromASN: (value) => value.toDate(),\n    toASN: (value) => new asn1js.GeneralizedTime({ valueDate: value }),\n};\nexport const AsnNullConverter = {\n    fromASN: () => null,\n    toASN: () => {\n        return new asn1js.Null();\n    },\n};\nexport function defaultConverter(type) {\n    switch (type) {\n        case AsnPropTypes.Any:\n            return AsnAnyConverter;\n        case AsnPropTypes.BitString:\n            return AsnBitStringConverter;\n        case AsnPropTypes.BmpString:\n            return AsnBmpStringConverter;\n        case AsnPropTypes.Boolean:\n            return AsnBooleanConverter;\n        case AsnPropTypes.CharacterString:\n            return AsnCharacterStringConverter;\n        case AsnPropTypes.Enumerated:\n            return AsnEnumeratedConverter;\n        case AsnPropTypes.GeneralString:\n            return AsnGeneralStringConverter;\n        case AsnPropTypes.GeneralizedTime:\n            return AsnGeneralizedTimeConverter;\n        case AsnPropTypes.GraphicString:\n            return AsnGraphicStringConverter;\n        case AsnPropTypes.IA5String:\n            return AsnIA5StringConverter;\n        case AsnPropTypes.Integer:\n            return AsnIntegerConverter;\n        case AsnPropTypes.Null:\n            return AsnNullConverter;\n        case AsnPropTypes.NumericString:\n            return AsnNumericStringConverter;\n        case AsnPropTypes.ObjectIdentifier:\n            return AsnObjectIdentifierConverter;\n        case AsnPropTypes.OctetString:\n            return AsnOctetStringConverter;\n        case AsnPropTypes.PrintableString:\n            return AsnPrintableStringConverter;\n        case AsnPropTypes.TeletexString:\n            return AsnTeletexStringConverter;\n        case AsnPropTypes.UTCTime:\n            return AsnUTCTimeConverter;\n        case AsnPropTypes.UniversalString:\n            return AsnUniversalStringConverter;\n        case AsnPropTypes.Utf8String:\n            return AsnUtf8StringConverter;\n        case AsnPropTypes.VideotexString:\n            return AsnVideotexStringConverter;\n        case AsnPropTypes.VisibleString:\n            return AsnVisibleStringConverter;\n        default:\n            return null;\n    }\n}\n","export function isConvertible(target) {\n    if (typeof target === \"function\" && target.prototype) {\n        if (target.prototype.toASN && target.prototype.fromASN) {\n            return true;\n        }\n        else {\n            return isConvertible(target.prototype);\n        }\n    }\n    else {\n        return !!(target && typeof target === \"object\" && \"toASN\" in target && \"fromASN\" in target);\n    }\n}\nexport function isTypeOfArray(target) {\n    var _a;\n    if (target) {\n        const proto = Object.getPrototypeOf(target);\n        if (((_a = proto === null || proto === void 0 ? void 0 : proto.prototype) === null || _a === void 0 ? void 0 : _a.constructor) === Array) {\n            return true;\n        }\n        return isTypeOfArray(proto);\n    }\n    return false;\n}\nexport function isArrayEqual(bytes1, bytes2) {\n    if (!(bytes1 && bytes2)) {\n        return false;\n    }\n    if (bytes1.byteLength !== bytes2.byteLength) {\n        return false;\n    }\n    const b1 = new Uint8Array(bytes1);\n    const b2 = new Uint8Array(bytes2);\n    for (let i = 0; i < bytes1.byteLength; i++) {\n        if (b1[i] !== b2[i]) {\n            return false;\n        }\n    }\n    return true;\n}\n","import { AsnSchemaStorage } from \"./schema\";\nexport const schemaStorage = new AsnSchemaStorage();\n","import * as asn1js from \"asn1js\";\nimport { AsnPropTypes, AsnTypeTypes } from \"./enums\";\nimport { isConvertible } from \"./helper\";\nexport class AsnSchemaStorage {\n    constructor() {\n        this.items = new WeakMap();\n    }\n    has(target) {\n        return this.items.has(target);\n    }\n    get(target, checkSchema = false) {\n        const schema = this.items.get(target);\n        if (!schema) {\n            throw new Error(`Cannot get schema for '${target.prototype.constructor.name}' target`);\n        }\n        if (checkSchema && !schema.schema) {\n            throw new Error(`Schema '${target.prototype.constructor.name}' doesn't contain ASN.1 schema. Call 'AsnSchemaStorage.cache'.`);\n        }\n        return schema;\n    }\n    cache(target) {\n        const schema = this.get(target);\n        if (!schema.schema) {\n            schema.schema = this.create(target, true);\n        }\n    }\n    createDefault(target) {\n        const schema = {\n            type: AsnTypeTypes.Sequence,\n            items: {},\n        };\n        const parentSchema = this.findParentSchema(target);\n        if (parentSchema) {\n            Object.assign(schema, parentSchema);\n            schema.items = Object.assign({}, schema.items, parentSchema.items);\n        }\n        return schema;\n    }\n    create(target, useNames) {\n        const schema = this.items.get(target) || this.createDefault(target);\n        const asn1Value = [];\n        for (const key in schema.items) {\n            const item = schema.items[key];\n            const name = useNames ? key : \"\";\n            let asn1Item;\n            if (typeof item.type === \"number\") {\n                const Asn1TypeName = AsnPropTypes[item.type];\n                const Asn1Type = asn1js[Asn1TypeName];\n                if (!Asn1Type) {\n                    throw new Error(`Cannot get ASN1 class by name '${Asn1TypeName}'`);\n                }\n                asn1Item = new Asn1Type({ name });\n            }\n            else if (isConvertible(item.type)) {\n                const instance = new item.type();\n                asn1Item = instance.toSchema(name);\n            }\n            else if (item.optional) {\n                const itemSchema = this.get(item.type);\n                if (itemSchema.type === AsnTypeTypes.Choice) {\n                    asn1Item = new asn1js.Any({ name });\n                }\n                else {\n                    asn1Item = this.create(item.type, false);\n                    asn1Item.name = name;\n                }\n            }\n            else {\n                asn1Item = new asn1js.Any({ name });\n            }\n            const optional = !!item.optional || item.defaultValue !== undefined;\n            if (item.repeated) {\n                asn1Item.name = \"\";\n                const Container = item.repeated === \"set\" ? asn1js.Set : asn1js.Sequence;\n                asn1Item = new Container({\n                    name: \"\",\n                    value: [\n                        new asn1js.Repeated({\n                            name,\n                            value: asn1Item,\n                        }),\n                    ],\n                });\n            }\n            if (item.context !== null && item.context !== undefined) {\n                if (item.implicit) {\n                    if (typeof item.type === \"number\" || isConvertible(item.type)) {\n                        const Container = item.repeated ? asn1js.Constructed : asn1js.Primitive;\n                        asn1Value.push(new Container({\n                            name,\n                            optional,\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: item.context,\n                            },\n                        }));\n                    }\n                    else {\n                        this.cache(item.type);\n                        const isRepeated = !!item.repeated;\n                        let value = !isRepeated ? this.get(item.type, true).schema : asn1Item;\n                        value =\n                            \"valueBlock\" in value\n                                ? value.valueBlock.value\n                                : value.value;\n                        asn1Value.push(new asn1js.Constructed({\n                            name: !isRepeated ? name : \"\",\n                            optional,\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: item.context,\n                            },\n                            value: value,\n                        }));\n                    }\n                }\n                else {\n                    asn1Value.push(new asn1js.Constructed({\n                        optional,\n                        idBlock: {\n                            tagClass: 3,\n                            tagNumber: item.context,\n                        },\n                        value: [asn1Item],\n                    }));\n                }\n            }\n            else {\n                asn1Item.optional = optional;\n                asn1Value.push(asn1Item);\n            }\n        }\n        switch (schema.type) {\n            case AsnTypeTypes.Sequence:\n                return new asn1js.Sequence({ value: asn1Value, name: \"\" });\n            case AsnTypeTypes.Set:\n                return new asn1js.Set({ value: asn1Value, name: \"\" });\n            case AsnTypeTypes.Choice:\n                return new asn1js.Choice({ value: asn1Value, name: \"\" });\n            default:\n                throw new Error(`Unsupported ASN1 type in use`);\n        }\n    }\n    set(target, schema) {\n        this.items.set(target, schema);\n        return this;\n    }\n    findParentSchema(target) {\n        const parent = Object.getPrototypeOf(target);\n        if (parent) {\n            const schema = this.items.get(parent);\n            return schema || this.findParentSchema(parent);\n        }\n        return null;\n    }\n}\n","import * as converters from \"./converters\";\nimport { AsnTypeTypes } from \"./enums\";\nimport { schemaStorage } from \"./storage\";\nexport const AsnType = (options) => (target) => {\n    let schema;\n    if (!schemaStorage.has(target)) {\n        schema = schemaStorage.createDefault(target);\n        schemaStorage.set(target, schema);\n    }\n    else {\n        schema = schemaStorage.get(target);\n    }\n    Object.assign(schema, options);\n};\nexport const AsnChoiceType = () => AsnType({ type: AsnTypeTypes.Choice });\nexport const AsnSetType = (options) => AsnType({ type: AsnTypeTypes.Set, ...options });\nexport const AsnSequenceType = (options) => AsnType({ type: AsnTypeTypes.Sequence, ...options });\nexport const AsnProp = (options) => (target, propertyKey) => {\n    let schema;\n    if (!schemaStorage.has(target.constructor)) {\n        schema = schemaStorage.createDefault(target.constructor);\n        schemaStorage.set(target.constructor, schema);\n    }\n    else {\n        schema = schemaStorage.get(target.constructor);\n    }\n    const copyOptions = Object.assign({}, options);\n    if (typeof copyOptions.type === \"number\" && !copyOptions.converter) {\n        const defaultConverter = converters.defaultConverter(options.type);\n        if (!defaultConverter) {\n            throw new Error(`Cannot get default converter for property '${propertyKey}' of ${target.constructor.name}`);\n        }\n        copyOptions.converter = defaultConverter;\n    }\n    schema.items[propertyKey] = copyOptions;\n};\n","export class AsnSchemaValidationError extends Error {\n    constructor() {\n        super(...arguments);\n        this.schemas = [];\n    }\n}\n","import * as asn1js from \"asn1js\";\nimport { AsnPropTypes, AsnTypeTypes } from \"./enums\";\nimport * as converters from \"./converters\";\nimport { AsnSchemaValidationError } from \"./errors\";\nimport { isConvertible, isTypeOfArray } from \"./helper\";\nimport { schemaStorage } from \"./storage\";\nexport class AsnParser {\n    static parse(data, target) {\n        const asn1Parsed = asn1js.fromBER(data);\n        if (asn1Parsed.result.error) {\n            throw new Error(asn1Parsed.result.error);\n        }\n        const res = this.fromASN(asn1Parsed.result, target);\n        return res;\n    }\n    static fromASN(asn1Schema, target) {\n        var _a;\n        try {\n            if (isConvertible(target)) {\n                const value = new target();\n                return value.fromASN(asn1Schema);\n            }\n            const schema = schemaStorage.get(target);\n            schemaStorage.cache(target);\n            let targetSchema = schema.schema;\n            if (asn1Schema.constructor === asn1js.Constructed && schema.type !== AsnTypeTypes.Choice) {\n                targetSchema = new asn1js.Constructed({\n                    idBlock: {\n                        tagClass: 3,\n                        tagNumber: asn1Schema.idBlock.tagNumber,\n                    },\n                    value: schema.schema.valueBlock.value,\n                });\n                for (const key in schema.items) {\n                    delete asn1Schema[key];\n                }\n            }\n            const asn1ComparedSchema = asn1js.compareSchema({}, asn1Schema, targetSchema);\n            if (!asn1ComparedSchema.verified) {\n                throw new AsnSchemaValidationError(`Data does not match to ${target.name} ASN1 schema. ${asn1ComparedSchema.result.error}`);\n            }\n            const res = new target();\n            if (isTypeOfArray(target)) {\n                if (!(\"value\" in asn1Schema.valueBlock && Array.isArray(asn1Schema.valueBlock.value))) {\n                    throw new Error(`Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.`);\n                }\n                const itemType = schema.itemType;\n                if (typeof itemType === \"number\") {\n                    const converter = converters.defaultConverter(itemType);\n                    if (!converter) {\n                        throw new Error(`Cannot get default converter for array item of ${target.name} ASN1 schema`);\n                    }\n                    return target.from(asn1Schema.valueBlock.value, (element) => converter.fromASN(element));\n                }\n                else {\n                    return target.from(asn1Schema.valueBlock.value, (element) => this.fromASN(element, itemType));\n                }\n            }\n            for (const key in schema.items) {\n                const asn1SchemaValue = asn1ComparedSchema.result[key];\n                if (!asn1SchemaValue) {\n                    continue;\n                }\n                const schemaItem = schema.items[key];\n                const schemaItemType = schemaItem.type;\n                if (typeof schemaItemType === \"number\" || isConvertible(schemaItemType)) {\n                    const converter = (_a = schemaItem.converter) !== null && _a !== void 0 ? _a : (isConvertible(schemaItemType)\n                        ? new schemaItemType()\n                        : null);\n                    if (!converter) {\n                        throw new Error(\"Converter is empty\");\n                    }\n                    if (schemaItem.repeated) {\n                        if (schemaItem.implicit) {\n                            const Container = schemaItem.repeated === \"sequence\" ? asn1js.Sequence : asn1js.Set;\n                            const newItem = new Container();\n                            newItem.valueBlock = asn1SchemaValue.valueBlock;\n                            const newItemAsn = asn1js.fromBER(newItem.toBER(false));\n                            if (newItemAsn.offset === -1) {\n                                throw new Error(`Cannot parse the child item. ${newItemAsn.result.error}`);\n                            }\n                            if (!(\"value\" in newItemAsn.result.valueBlock &&\n                                Array.isArray(newItemAsn.result.valueBlock.value))) {\n                                throw new Error(\"Cannot get items from the ASN.1 parsed value. ASN.1 object is not constructed.\");\n                            }\n                            const value = newItemAsn.result.valueBlock.value;\n                            res[key] = Array.from(value, (element) => converter.fromASN(element));\n                        }\n                        else {\n                            res[key] = Array.from(asn1SchemaValue, (element) => converter.fromASN(element));\n                        }\n                    }\n                    else {\n                        let value = asn1SchemaValue;\n                        if (schemaItem.implicit) {\n                            let newItem;\n                            if (isConvertible(schemaItemType)) {\n                                newItem = new schemaItemType().toSchema(\"\");\n                            }\n                            else {\n                                const Asn1TypeName = AsnPropTypes[schemaItemType];\n                                const Asn1Type = asn1js[Asn1TypeName];\n                                if (!Asn1Type) {\n                                    throw new Error(`Cannot get '${Asn1TypeName}' class from asn1js module`);\n                                }\n                                newItem = new Asn1Type();\n                            }\n                            newItem.valueBlock = value.valueBlock;\n                            value = asn1js.fromBER(newItem.toBER(false)).result;\n                        }\n                        res[key] = converter.fromASN(value);\n                    }\n                }\n                else {\n                    if (schemaItem.repeated) {\n                        if (!Array.isArray(asn1SchemaValue)) {\n                            throw new Error(\"Cannot get list of items from the ASN.1 parsed value. ASN.1 value should be iterable.\");\n                        }\n                        res[key] = Array.from(asn1SchemaValue, (element) => this.fromASN(element, schemaItemType));\n                    }\n                    else {\n                        res[key] = this.fromASN(asn1SchemaValue, schemaItemType);\n                    }\n                }\n            }\n            return res;\n        }\n        catch (error) {\n            if (error instanceof AsnSchemaValidationError) {\n                error.schemas.push(target.name);\n            }\n            throw error;\n        }\n    }\n}\n","import * as asn1js from \"asn1js\";\nimport * as converters from \"./converters\";\nimport { AsnPropTypes, AsnTypeTypes } from \"./enums\";\nimport { isConvertible, isArrayEqual } from \"./helper\";\nimport { schemaStorage } from \"./storage\";\nexport class AsnSerializer {\n    static serialize(obj) {\n        if (obj instanceof asn1js.BaseBlock) {\n            return obj.toBER(false);\n        }\n        return this.toASN(obj).toBER(false);\n    }\n    static toASN(obj) {\n        if (obj && typeof obj === \"object\" && isConvertible(obj)) {\n            return obj.toASN();\n        }\n        if (!(obj && typeof obj === \"object\")) {\n            throw new TypeError(\"Parameter 1 should be type of Object.\");\n        }\n        const target = obj.constructor;\n        const schema = schemaStorage.get(target);\n        schemaStorage.cache(target);\n        let asn1Value = [];\n        if (schema.itemType) {\n            if (!Array.isArray(obj)) {\n                throw new TypeError(\"Parameter 1 should be type of Array.\");\n            }\n            if (typeof schema.itemType === \"number\") {\n                const converter = converters.defaultConverter(schema.itemType);\n                if (!converter) {\n                    throw new Error(`Cannot get default converter for array item of ${target.name} ASN1 schema`);\n                }\n                asn1Value = obj.map((o) => converter.toASN(o));\n            }\n            else {\n                asn1Value = obj.map((o) => this.toAsnItem({ type: schema.itemType }, \"[]\", target, o));\n            }\n        }\n        else {\n            for (const key in schema.items) {\n                const schemaItem = schema.items[key];\n                const objProp = obj[key];\n                if (objProp === undefined ||\n                    schemaItem.defaultValue === objProp ||\n                    (typeof schemaItem.defaultValue === \"object\" &&\n                        typeof objProp === \"object\" &&\n                        isArrayEqual(this.serialize(schemaItem.defaultValue), this.serialize(objProp)))) {\n                    continue;\n                }\n                const asn1Item = AsnSerializer.toAsnItem(schemaItem, key, target, objProp);\n                if (typeof schemaItem.context === \"number\") {\n                    if (schemaItem.implicit) {\n                        if (!schemaItem.repeated &&\n                            (typeof schemaItem.type === \"number\" || isConvertible(schemaItem.type))) {\n                            const value = {};\n                            value.valueHex =\n                                asn1Item instanceof asn1js.Null\n                                    ? asn1Item.valueBeforeDecodeView\n                                    : asn1Item.valueBlock.toBER();\n                            asn1Value.push(new asn1js.Primitive({\n                                optional: schemaItem.optional,\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: schemaItem.context,\n                                },\n                                ...value,\n                            }));\n                        }\n                        else {\n                            asn1Value.push(new asn1js.Constructed({\n                                optional: schemaItem.optional,\n                                idBlock: {\n                                    tagClass: 3,\n                                    tagNumber: schemaItem.context,\n                                },\n                                value: asn1Item.valueBlock.value,\n                            }));\n                        }\n                    }\n                    else {\n                        asn1Value.push(new asn1js.Constructed({\n                            optional: schemaItem.optional,\n                            idBlock: {\n                                tagClass: 3,\n                                tagNumber: schemaItem.context,\n                            },\n                            value: [asn1Item],\n                        }));\n                    }\n                }\n                else if (schemaItem.repeated) {\n                    asn1Value = asn1Value.concat(asn1Item);\n                }\n                else {\n                    asn1Value.push(asn1Item);\n                }\n            }\n        }\n        let asnSchema;\n        switch (schema.type) {\n            case AsnTypeTypes.Sequence:\n                asnSchema = new asn1js.Sequence({ value: asn1Value });\n                break;\n            case AsnTypeTypes.Set:\n                asnSchema = new asn1js.Set({ value: asn1Value });\n                break;\n            case AsnTypeTypes.Choice:\n                if (!asn1Value[0]) {\n                    throw new Error(`Schema '${target.name}' has wrong data. Choice cannot be empty.`);\n                }\n                asnSchema = asn1Value[0];\n                break;\n        }\n        return asnSchema;\n    }\n    static toAsnItem(schemaItem, key, target, objProp) {\n        let asn1Item;\n        if (typeof schemaItem.type === \"number\") {\n            const converter = schemaItem.converter;\n            if (!converter) {\n                throw new Error(`Property '${key}' doesn't have converter for type ${AsnPropTypes[schemaItem.type]} in schema '${target.name}'`);\n            }\n            if (schemaItem.repeated) {\n                if (!Array.isArray(objProp)) {\n                    throw new TypeError(\"Parameter 'objProp' should be type of Array.\");\n                }\n                const items = Array.from(objProp, (element) => converter.toASN(element));\n                const Container = schemaItem.repeated === \"sequence\" ? asn1js.Sequence : asn1js.Set;\n                asn1Item = new Container({\n                    value: items,\n                });\n            }\n            else {\n                asn1Item = converter.toASN(objProp);\n            }\n        }\n        else {\n            if (schemaItem.repeated) {\n                if (!Array.isArray(objProp)) {\n                    throw new TypeError(\"Parameter 'objProp' should be type of Array.\");\n                }\n                const items = Array.from(objProp, (element) => this.toASN(element));\n                const Container = schemaItem.repeated === \"sequence\" ? asn1js.Sequence : asn1js.Set;\n                asn1Item = new Container({\n                    value: items,\n                });\n            }\n            else {\n                asn1Item = this.toASN(objProp);\n            }\n        }\n        return asn1Item;\n    }\n}\n","export class AsnArray extends Array {\n    constructor(items = []) {\n        if (typeof items === \"number\") {\n            super(items);\n        }\n        else {\n            super();\n            for (const item of items) {\n                this.push(item);\n            }\n        }\n    }\n}\n","import * as asn1js from \"asn1js\";\nimport { BufferSourceConverter } from \"pvtsutils\";\nimport { AsnParser } from \"./parser\";\nimport { AsnSerializer } from \"./serializer\";\nexport class AsnConvert {\n    static serialize(obj) {\n        return AsnSerializer.serialize(obj);\n    }\n    static parse(data, target) {\n        return AsnParser.parse(data, target);\n    }\n    static toString(data) {\n        const buf = BufferSourceConverter.isBufferSource(data)\n            ? BufferSourceConverter.toArrayBuffer(data)\n            : AsnConvert.serialize(data);\n        const asn = asn1js.fromBER(buf);\n        if (asn.offset === -1) {\n            throw new Error(`Cannot decode ASN.1 data. ${asn.result.error}`);\n        }\n        return asn.result.toString();\n    }\n}\n","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n","import { Convert } from \"pvtsutils\";\nexport class IpConverter {\n    static isIPv4(ip) {\n        return /^(\\d{1,3}\\.){3}\\d{1,3}$/.test(ip);\n    }\n    static parseIPv4(ip) {\n        const parts = ip.split(\".\");\n        if (parts.length !== 4) {\n            throw new Error(\"Invalid IPv4 address\");\n        }\n        return parts.map((part) => {\n            const num = parseInt(part, 10);\n            if (isNaN(num) || num < 0 || num > 255) {\n                throw new Error(\"Invalid IPv4 address part\");\n            }\n            return num;\n        });\n    }\n    static parseIPv6(ip) {\n        const expandedIP = this.expandIPv6(ip);\n        const parts = expandedIP.split(\":\");\n        if (parts.length !== 8) {\n            throw new Error(\"Invalid IPv6 address\");\n        }\n        return parts.reduce((bytes, part) => {\n            const num = parseInt(part, 16);\n            if (isNaN(num) || num < 0 || num > 0xffff) {\n                throw new Error(\"Invalid IPv6 address part\");\n            }\n            bytes.push((num >> 8) & 0xff);\n            bytes.push(num & 0xff);\n            return bytes;\n        }, []);\n    }\n    static expandIPv6(ip) {\n        if (!ip.includes(\"::\")) {\n            return ip;\n        }\n        const parts = ip.split(\"::\");\n        if (parts.length > 2) {\n            throw new Error(\"Invalid IPv6 address\");\n        }\n        const left = parts[0] ? parts[0].split(\":\") : [];\n        const right = parts[1] ? parts[1].split(\":\") : [];\n        const missing = 8 - (left.length + right.length);\n        if (missing < 0) {\n            throw new Error(\"Invalid IPv6 address\");\n        }\n        return [...left, ...Array(missing).fill(\"0\"), ...right].join(\":\");\n    }\n    static formatIPv6(bytes) {\n        const parts = [];\n        for (let i = 0; i < 16; i += 2) {\n            parts.push(((bytes[i] << 8) | bytes[i + 1]).toString(16));\n        }\n        return this.compressIPv6(parts.join(\":\"));\n    }\n    static compressIPv6(ip) {\n        const parts = ip.split(\":\");\n        let longestZeroStart = -1;\n        let longestZeroLength = 0;\n        let currentZeroStart = -1;\n        let currentZeroLength = 0;\n        for (let i = 0; i < parts.length; i++) {\n            if (parts[i] === \"0\") {\n                if (currentZeroStart === -1) {\n                    currentZeroStart = i;\n                }\n                currentZeroLength++;\n            }\n            else {\n                if (currentZeroLength > longestZeroLength) {\n                    longestZeroStart = currentZeroStart;\n                    longestZeroLength = currentZeroLength;\n                }\n                currentZeroStart = -1;\n                currentZeroLength = 0;\n            }\n        }\n        if (currentZeroLength > longestZeroLength) {\n            longestZeroStart = currentZeroStart;\n            longestZeroLength = currentZeroLength;\n        }\n        if (longestZeroLength > 1) {\n            const before = parts.slice(0, longestZeroStart).join(\":\");\n            const after = parts.slice(longestZeroStart + longestZeroLength).join(\":\");\n            return `${before}::${after}`;\n        }\n        return ip;\n    }\n    static parseCIDR(text) {\n        const [addr, prefixStr] = text.split(\"/\");\n        const prefix = parseInt(prefixStr, 10);\n        if (this.isIPv4(addr)) {\n            if (prefix < 0 || prefix > 32) {\n                throw new Error(\"Invalid IPv4 prefix length\");\n            }\n            return [this.parseIPv4(addr), prefix];\n        }\n        else {\n            if (prefix < 0 || prefix > 128) {\n                throw new Error(\"Invalid IPv6 prefix length\");\n            }\n            return [this.parseIPv6(addr), prefix];\n        }\n    }\n    static decodeIP(value) {\n        if (value.length === 64 && parseInt(value, 16) === 0) {\n            return \"::/0\";\n        }\n        if (value.length !== 16) {\n            return value;\n        }\n        const mask = parseInt(value.slice(8), 16)\n            .toString(2)\n            .split(\"\")\n            .reduce((a, k) => a + +k, 0);\n        let ip = value.slice(0, 8).replace(/(.{2})/g, (match) => `${parseInt(match, 16)}.`);\n        ip = ip.slice(0, -1);\n        return `${ip}/${mask}`;\n    }\n    static toString(buf) {\n        const uint8 = new Uint8Array(buf);\n        if (uint8.length === 4) {\n            return Array.from(uint8).join(\".\");\n        }\n        if (uint8.length === 16) {\n            return this.formatIPv6(uint8);\n        }\n        if (uint8.length === 8 || uint8.length === 32) {\n            const half = uint8.length / 2;\n            const addrBytes = uint8.slice(0, half);\n            const maskBytes = uint8.slice(half);\n            const isAllZeros = uint8.every((byte) => byte === 0);\n            if (isAllZeros) {\n                return uint8.length === 8 ? \"0.0.0.0/0\" : \"::/0\";\n            }\n            const prefixLen = maskBytes.reduce((a, b) => a + (b.toString(2).match(/1/g) || []).length, 0);\n            if (uint8.length === 8) {\n                const addrStr = Array.from(addrBytes).join(\".\");\n                return `${addrStr}/${prefixLen}`;\n            }\n            else {\n                const addrStr = this.formatIPv6(addrBytes);\n                return `${addrStr}/${prefixLen}`;\n            }\n        }\n        return this.decodeIP(Convert.ToHex(buf));\n    }\n    static fromString(text) {\n        if (text.includes(\"/\")) {\n            const [addr, prefix] = this.parseCIDR(text);\n            const maskBytes = new Uint8Array(addr.length);\n            let bitsLeft = prefix;\n            for (let i = 0; i < maskBytes.length; i++) {\n                if (bitsLeft >= 8) {\n                    maskBytes[i] = 0xff;\n                    bitsLeft -= 8;\n                }\n                else if (bitsLeft > 0) {\n                    maskBytes[i] = 0xff << (8 - bitsLeft);\n                    bitsLeft = 0;\n                }\n            }\n            const out = new Uint8Array(addr.length * 2);\n            out.set(addr, 0);\n            out.set(maskBytes, addr.length);\n            return out.buffer;\n        }\n        const bytes = this.isIPv4(text) ? this.parseIPv4(text) : this.parseIPv6(text);\n        return new Uint8Array(bytes).buffer;\n    }\n}\n","var RelativeDistinguishedName_1, RDNSequence_1, Name_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, AsnArray } from \"@peculiar/asn1-schema\";\nimport { Convert } from \"pvtsutils\";\nlet DirectoryString = class DirectoryString {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n    toString() {\n        return (this.bmpString ||\n            this.printableString ||\n            this.teletexString ||\n            this.universalString ||\n            this.utf8String ||\n            \"\");\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.TeletexString })\n], DirectoryString.prototype, \"teletexString\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.PrintableString })\n], DirectoryString.prototype, \"printableString\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.UniversalString })\n], DirectoryString.prototype, \"universalString\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Utf8String })\n], DirectoryString.prototype, \"utf8String\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BmpString })\n], DirectoryString.prototype, \"bmpString\", void 0);\nDirectoryString = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], DirectoryString);\nexport { DirectoryString };\nlet AttributeValue = class AttributeValue extends DirectoryString {\n    constructor(params = {}) {\n        super(params);\n        Object.assign(this, params);\n    }\n    toString() {\n        return this.ia5String || (this.anyValue ? Convert.ToHex(this.anyValue) : super.toString());\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String })\n], AttributeValue.prototype, \"ia5String\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any })\n], AttributeValue.prototype, \"anyValue\", void 0);\nAttributeValue = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], AttributeValue);\nexport { AttributeValue };\nexport class AttributeTypeAndValue {\n    constructor(params = {}) {\n        this.type = \"\";\n        this.value = new AttributeValue();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], AttributeTypeAndValue.prototype, \"type\", void 0);\n__decorate([\n    AsnProp({ type: AttributeValue })\n], AttributeTypeAndValue.prototype, \"value\", void 0);\nlet RelativeDistinguishedName = RelativeDistinguishedName_1 = class RelativeDistinguishedName extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, RelativeDistinguishedName_1.prototype);\n    }\n};\nRelativeDistinguishedName = RelativeDistinguishedName_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: AttributeTypeAndValue })\n], RelativeDistinguishedName);\nexport { RelativeDistinguishedName };\nlet RDNSequence = RDNSequence_1 = class RDNSequence extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, RDNSequence_1.prototype);\n    }\n};\nRDNSequence = RDNSequence_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: RelativeDistinguishedName })\n], RDNSequence);\nexport { RDNSequence };\nlet Name = Name_1 = class Name extends RDNSequence {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, Name_1.prototype);\n    }\n};\nName = Name_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], Name);\nexport { Name };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, AsnOctetStringConverter, } from \"@peculiar/asn1-schema\";\nimport { IpConverter } from \"./ip_converter\";\nimport { DirectoryString, Name } from \"./name\";\nexport const AsnIpConverter = {\n    fromASN: (value) => IpConverter.toString(AsnOctetStringConverter.fromASN(value)),\n    toASN: (value) => AsnOctetStringConverter.toASN(IpConverter.fromString(value)),\n};\nexport class OtherName {\n    constructor(params = {}) {\n        this.typeId = \"\";\n        this.value = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], OtherName.prototype, \"typeId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, context: 0 })\n], OtherName.prototype, \"value\", void 0);\nexport class EDIPartyName {\n    constructor(params = {}) {\n        this.partyName = new DirectoryString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: DirectoryString, optional: true, context: 0, implicit: true })\n], EDIPartyName.prototype, \"nameAssigner\", void 0);\n__decorate([\n    AsnProp({ type: DirectoryString, context: 1, implicit: true })\n], EDIPartyName.prototype, \"partyName\", void 0);\nlet GeneralName = class GeneralName {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: OtherName, context: 0, implicit: true })\n], GeneralName.prototype, \"otherName\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String, context: 1, implicit: true })\n], GeneralName.prototype, \"rfc822Name\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String, context: 2, implicit: true })\n], GeneralName.prototype, \"dNSName\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, context: 3, implicit: true })\n], GeneralName.prototype, \"x400Address\", void 0);\n__decorate([\n    AsnProp({ type: Name, context: 4, implicit: false })\n], GeneralName.prototype, \"directoryName\", void 0);\n__decorate([\n    AsnProp({ type: EDIPartyName, context: 5 })\n], GeneralName.prototype, \"ediPartyName\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String, context: 6, implicit: true })\n], GeneralName.prototype, \"uniformResourceIdentifier\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.OctetString,\n        context: 7,\n        implicit: true,\n        converter: AsnIpConverter,\n    })\n], GeneralName.prototype, \"iPAddress\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier, context: 8, implicit: true })\n], GeneralName.prototype, \"registeredID\", void 0);\nGeneralName = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], GeneralName);\nexport { GeneralName };\n","export const id_pkix = \"1.3.6.1.5.5.7\";\nexport const id_pe = `${id_pkix}.1`;\nexport const id_qt = `${id_pkix}.2`;\nexport const id_kp = `${id_pkix}.3`;\nexport const id_ad = `${id_pkix}.48`;\nexport const id_qt_csp = `${id_qt}.1`;\nexport const id_qt_unotice = `${id_qt}.2`;\nexport const id_ad_ocsp = `${id_ad}.1`;\nexport const id_ad_caIssuers = `${id_ad}.2`;\nexport const id_ad_timeStamping = `${id_ad}.3`;\nexport const id_ad_caRepository = `${id_ad}.5`;\nexport const id_ce = \"2.5.29\";\n","var AuthorityInfoAccessSyntax_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralName } from \"../general_name\";\nimport { id_pe } from \"../object_identifiers\";\nexport const id_pe_authorityInfoAccess = `${id_pe}.1`;\nexport class AccessDescription {\n    constructor(params = {}) {\n        this.accessMethod = \"\";\n        this.accessLocation = new GeneralName();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], AccessDescription.prototype, \"accessMethod\", void 0);\n__decorate([\n    AsnProp({ type: GeneralName })\n], AccessDescription.prototype, \"accessLocation\", void 0);\nlet AuthorityInfoAccessSyntax = AuthorityInfoAccessSyntax_1 = class AuthorityInfoAccessSyntax extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, AuthorityInfoAccessSyntax_1.prototype);\n    }\n};\nAuthorityInfoAccessSyntax = AuthorityInfoAccessSyntax_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: AccessDescription })\n], AuthorityInfoAccessSyntax);\nexport { AuthorityInfoAccessSyntax };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter, OctetString, } from \"@peculiar/asn1-schema\";\nimport { GeneralName } from \"../general_name\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_authorityKeyIdentifier = `${id_ce}.35`;\nexport class KeyIdentifier extends OctetString {\n}\nexport class AuthorityKeyIdentifier {\n    constructor(params = {}) {\n        if (params) {\n            Object.assign(this, params);\n        }\n    }\n}\n__decorate([\n    AsnProp({ type: KeyIdentifier, context: 0, optional: true, implicit: true })\n], AuthorityKeyIdentifier.prototype, \"keyIdentifier\", void 0);\n__decorate([\n    AsnProp({ type: GeneralName, context: 1, optional: true, implicit: true, repeated: \"sequence\" })\n], AuthorityKeyIdentifier.prototype, \"authorityCertIssuer\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Integer,\n        context: 2,\n        optional: true,\n        implicit: true,\n        converter: AsnIntegerArrayBufferConverter,\n    })\n], AuthorityKeyIdentifier.prototype, \"authorityCertSerialNumber\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_basicConstraints = `${id_ce}.19`;\nexport class BasicConstraints {\n    constructor(params = {}) {\n        this.cA = false;\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Boolean, defaultValue: false })\n], BasicConstraints.prototype, \"cA\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, optional: true })\n], BasicConstraints.prototype, \"pathLenConstraint\", void 0);\n","var GeneralNames_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralName } from \"./general_name\";\nimport { AsnArray } from \"@peculiar/asn1-schema\";\nlet GeneralNames = GeneralNames_1 = class GeneralNames extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, GeneralNames_1.prototype);\n    }\n};\nGeneralNames = GeneralNames_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: GeneralName })\n], GeneralNames);\nexport { GeneralNames };\n","var CertificateIssuer_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralNames } from \"../general_names\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_certificateIssuer = `${id_ce}.29`;\nlet CertificateIssuer = CertificateIssuer_1 = class CertificateIssuer extends GeneralNames {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, CertificateIssuer_1.prototype);\n    }\n};\nCertificateIssuer = CertificateIssuer_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], CertificateIssuer);\nexport { CertificateIssuer };\n","var CertificatePolicies_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, AsnArray } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_certificatePolicies = `${id_ce}.32`;\nexport const id_ce_certificatePolicies_anyPolicy = `${id_ce_certificatePolicies}.0`;\nlet DisplayText = class DisplayText {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n    toString() {\n        return this.ia5String || this.visibleString || this.bmpString || this.utf8String || \"\";\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String })\n], DisplayText.prototype, \"ia5String\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.VisibleString })\n], DisplayText.prototype, \"visibleString\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BmpString })\n], DisplayText.prototype, \"bmpString\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Utf8String })\n], DisplayText.prototype, \"utf8String\", void 0);\nDisplayText = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], DisplayText);\nexport { DisplayText };\nexport class NoticeReference {\n    constructor(params = {}) {\n        this.organization = new DisplayText();\n        this.noticeNumbers = [];\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: DisplayText })\n], NoticeReference.prototype, \"organization\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, repeated: \"sequence\" })\n], NoticeReference.prototype, \"noticeNumbers\", void 0);\nexport class UserNotice {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: NoticeReference, optional: true })\n], UserNotice.prototype, \"noticeRef\", void 0);\n__decorate([\n    AsnProp({ type: DisplayText, optional: true })\n], UserNotice.prototype, \"explicitText\", void 0);\nlet Qualifier = class Qualifier {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String })\n], Qualifier.prototype, \"cPSuri\", void 0);\n__decorate([\n    AsnProp({ type: UserNotice })\n], Qualifier.prototype, \"userNotice\", void 0);\nQualifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], Qualifier);\nexport { Qualifier };\nexport class PolicyQualifierInfo {\n    constructor(params = {}) {\n        this.policyQualifierId = \"\";\n        this.qualifier = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], PolicyQualifierInfo.prototype, \"policyQualifierId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any })\n], PolicyQualifierInfo.prototype, \"qualifier\", void 0);\nexport class PolicyInformation {\n    constructor(params = {}) {\n        this.policyIdentifier = \"\";\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], PolicyInformation.prototype, \"policyIdentifier\", void 0);\n__decorate([\n    AsnProp({ type: PolicyQualifierInfo, repeated: \"sequence\", optional: true })\n], PolicyInformation.prototype, \"policyQualifiers\", void 0);\nlet CertificatePolicies = CertificatePolicies_1 = class CertificatePolicies extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, CertificatePolicies_1.prototype);\n    }\n};\nCertificatePolicies = CertificatePolicies_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: PolicyInformation })\n], CertificatePolicies);\nexport { CertificatePolicies };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_cRLNumber = `${id_ce}.20`;\nlet CRLNumber = class CRLNumber {\n    constructor(value = 0) {\n        this.value = value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], CRLNumber.prototype, \"value\", void 0);\nCRLNumber = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], CRLNumber);\nexport { CRLNumber };\n","import { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nimport { CRLNumber } from \"./crl_number\";\nexport const id_ce_deltaCRLIndicator = `${id_ce}.27`;\nlet BaseCRLNumber = class BaseCRLNumber extends CRLNumber {\n};\nBaseCRLNumber = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], BaseCRLNumber);\nexport { BaseCRLNumber };\n","var CRLDistributionPoints_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnType, AsnTypeTypes, AsnArray, BitString } from \"@peculiar/asn1-schema\";\nimport { RelativeDistinguishedName } from \"../name\";\nimport { GeneralName } from \"../general_name\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_cRLDistributionPoints = `${id_ce}.31`;\nexport var ReasonFlags;\n(function (ReasonFlags) {\n    ReasonFlags[ReasonFlags[\"unused\"] = 1] = \"unused\";\n    ReasonFlags[ReasonFlags[\"keyCompromise\"] = 2] = \"keyCompromise\";\n    ReasonFlags[ReasonFlags[\"cACompromise\"] = 4] = \"cACompromise\";\n    ReasonFlags[ReasonFlags[\"affiliationChanged\"] = 8] = \"affiliationChanged\";\n    ReasonFlags[ReasonFlags[\"superseded\"] = 16] = \"superseded\";\n    ReasonFlags[ReasonFlags[\"cessationOfOperation\"] = 32] = \"cessationOfOperation\";\n    ReasonFlags[ReasonFlags[\"certificateHold\"] = 64] = \"certificateHold\";\n    ReasonFlags[ReasonFlags[\"privilegeWithdrawn\"] = 128] = \"privilegeWithdrawn\";\n    ReasonFlags[ReasonFlags[\"aACompromise\"] = 256] = \"aACompromise\";\n})(ReasonFlags || (ReasonFlags = {}));\nexport class Reason extends BitString {\n    toJSON() {\n        const res = [];\n        const flags = this.toNumber();\n        if (flags & ReasonFlags.aACompromise) {\n            res.push(\"aACompromise\");\n        }\n        if (flags & ReasonFlags.affiliationChanged) {\n            res.push(\"affiliationChanged\");\n        }\n        if (flags & ReasonFlags.cACompromise) {\n            res.push(\"cACompromise\");\n        }\n        if (flags & ReasonFlags.certificateHold) {\n            res.push(\"certificateHold\");\n        }\n        if (flags & ReasonFlags.cessationOfOperation) {\n            res.push(\"cessationOfOperation\");\n        }\n        if (flags & ReasonFlags.keyCompromise) {\n            res.push(\"keyCompromise\");\n        }\n        if (flags & ReasonFlags.privilegeWithdrawn) {\n            res.push(\"privilegeWithdrawn\");\n        }\n        if (flags & ReasonFlags.superseded) {\n            res.push(\"superseded\");\n        }\n        if (flags & ReasonFlags.unused) {\n            res.push(\"unused\");\n        }\n        return res;\n    }\n    toString() {\n        return `[${this.toJSON().join(\", \")}]`;\n    }\n}\nlet DistributionPointName = class DistributionPointName {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: GeneralName, context: 0, repeated: \"sequence\", implicit: true })\n], DistributionPointName.prototype, \"fullName\", void 0);\n__decorate([\n    AsnProp({ type: RelativeDistinguishedName, context: 1, implicit: true })\n], DistributionPointName.prototype, \"nameRelativeToCRLIssuer\", void 0);\nDistributionPointName = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], DistributionPointName);\nexport { DistributionPointName };\nexport class DistributionPoint {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: DistributionPointName, context: 0, optional: true })\n], DistributionPoint.prototype, \"distributionPoint\", void 0);\n__decorate([\n    AsnProp({ type: Reason, context: 1, optional: true, implicit: true })\n], DistributionPoint.prototype, \"reasons\", void 0);\n__decorate([\n    AsnProp({ type: GeneralName, context: 2, optional: true, repeated: \"sequence\", implicit: true })\n], DistributionPoint.prototype, \"cRLIssuer\", void 0);\nlet CRLDistributionPoints = CRLDistributionPoints_1 = class CRLDistributionPoints extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, CRLDistributionPoints_1.prototype);\n    }\n};\nCRLDistributionPoints = CRLDistributionPoints_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: DistributionPoint })\n], CRLDistributionPoints);\nexport { CRLDistributionPoints };\n","var FreshestCRL_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nimport { CRLDistributionPoints, DistributionPoint } from \"./crl_distribution_points\";\nexport const id_ce_freshestCRL = `${id_ce}.46`;\nlet FreshestCRL = FreshestCRL_1 = class FreshestCRL extends CRLDistributionPoints {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, FreshestCRL_1.prototype);\n    }\n};\nFreshestCRL = FreshestCRL_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: DistributionPoint })\n], FreshestCRL);\nexport { FreshestCRL };\n","import { __decorate } from \"tslib\";\nimport { AsnProp } from \"@peculiar/asn1-schema\";\nimport { DistributionPointName, Reason } from \"./crl_distribution_points\";\nimport { id_ce } from \"../object_identifiers\";\nimport { AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport const id_ce_issuingDistributionPoint = `${id_ce}.28`;\nexport class IssuingDistributionPoint {\n    constructor(params = {}) {\n        this.onlyContainsUserCerts = IssuingDistributionPoint.ONLY;\n        this.onlyContainsCACerts = IssuingDistributionPoint.ONLY;\n        this.indirectCRL = IssuingDistributionPoint.ONLY;\n        this.onlyContainsAttributeCerts = IssuingDistributionPoint.ONLY;\n        Object.assign(this, params);\n    }\n}\nIssuingDistributionPoint.ONLY = false;\n__decorate([\n    AsnProp({ type: DistributionPointName, context: 0, optional: true })\n], IssuingDistributionPoint.prototype, \"distributionPoint\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Boolean,\n        context: 1,\n        defaultValue: IssuingDistributionPoint.ONLY,\n        implicit: true,\n    })\n], IssuingDistributionPoint.prototype, \"onlyContainsUserCerts\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Boolean,\n        context: 2,\n        defaultValue: IssuingDistributionPoint.ONLY,\n        implicit: true,\n    })\n], IssuingDistributionPoint.prototype, \"onlyContainsCACerts\", void 0);\n__decorate([\n    AsnProp({ type: Reason, context: 3, optional: true, implicit: true })\n], IssuingDistributionPoint.prototype, \"onlySomeReasons\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Boolean,\n        context: 4,\n        defaultValue: IssuingDistributionPoint.ONLY,\n        implicit: true,\n    })\n], IssuingDistributionPoint.prototype, \"indirectCRL\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Boolean,\n        context: 5,\n        defaultValue: IssuingDistributionPoint.ONLY,\n        implicit: true,\n    })\n], IssuingDistributionPoint.prototype, \"onlyContainsAttributeCerts\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_cRLReasons = `${id_ce}.21`;\nexport var CRLReasons;\n(function (CRLReasons) {\n    CRLReasons[CRLReasons[\"unspecified\"] = 0] = \"unspecified\";\n    CRLReasons[CRLReasons[\"keyCompromise\"] = 1] = \"keyCompromise\";\n    CRLReasons[CRLReasons[\"cACompromise\"] = 2] = \"cACompromise\";\n    CRLReasons[CRLReasons[\"affiliationChanged\"] = 3] = \"affiliationChanged\";\n    CRLReasons[CRLReasons[\"superseded\"] = 4] = \"superseded\";\n    CRLReasons[CRLReasons[\"cessationOfOperation\"] = 5] = \"cessationOfOperation\";\n    CRLReasons[CRLReasons[\"certificateHold\"] = 6] = \"certificateHold\";\n    CRLReasons[CRLReasons[\"removeFromCRL\"] = 8] = \"removeFromCRL\";\n    CRLReasons[CRLReasons[\"privilegeWithdrawn\"] = 9] = \"privilegeWithdrawn\";\n    CRLReasons[CRLReasons[\"aACompromise\"] = 10] = \"aACompromise\";\n})(CRLReasons || (CRLReasons = {}));\nlet CRLReason = class CRLReason {\n    constructor(reason = CRLReasons.unspecified) {\n        this.reason = CRLReasons.unspecified;\n        this.reason = reason;\n    }\n    toJSON() {\n        return CRLReasons[this.reason];\n    }\n    toString() {\n        return this.toJSON();\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.Enumerated })\n], CRLReason.prototype, \"reason\", void 0);\nCRLReason = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], CRLReason);\nexport { CRLReason };\n","var ExtendedKeyUsage_1;\nimport { __decorate } from \"tslib\";\nimport { AsnPropTypes, AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce, id_kp } from \"../object_identifiers\";\nexport const id_ce_extKeyUsage = `${id_ce}.37`;\nlet ExtendedKeyUsage = ExtendedKeyUsage_1 = class ExtendedKeyUsage extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, ExtendedKeyUsage_1.prototype);\n    }\n};\nExtendedKeyUsage = ExtendedKeyUsage_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: AsnPropTypes.ObjectIdentifier })\n], ExtendedKeyUsage);\nexport { ExtendedKeyUsage };\nexport const anyExtendedKeyUsage = `${id_ce_extKeyUsage}.0`;\nexport const id_kp_serverAuth = `${id_kp}.1`;\nexport const id_kp_clientAuth = `${id_kp}.2`;\nexport const id_kp_codeSigning = `${id_kp}.3`;\nexport const id_kp_emailProtection = `${id_kp}.4`;\nexport const id_kp_timeStamping = `${id_kp}.8`;\nexport const id_kp_OCSPSigning = `${id_kp}.9`;\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, AsnIntegerArrayBufferConverter, } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_inhibitAnyPolicy = `${id_ce}.54`;\nlet InhibitAnyPolicy = class InhibitAnyPolicy {\n    constructor(value = new ArrayBuffer(0)) {\n        this.value = value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], InhibitAnyPolicy.prototype, \"value\", void 0);\nInhibitAnyPolicy = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], InhibitAnyPolicy);\nexport { InhibitAnyPolicy };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_invalidityDate = `${id_ce}.24`;\nlet InvalidityDate = class InvalidityDate {\n    constructor(value) {\n        this.value = new Date();\n        if (value) {\n            this.value = value;\n        }\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime })\n], InvalidityDate.prototype, \"value\", void 0);\nInvalidityDate = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], InvalidityDate);\nexport { InvalidityDate };\n","var IssueAlternativeName_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralNames } from \"../general_names\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_issuerAltName = `${id_ce}.18`;\nlet IssueAlternativeName = IssueAlternativeName_1 = class IssueAlternativeName extends GeneralNames {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, IssueAlternativeName_1.prototype);\n    }\n};\nIssueAlternativeName = IssueAlternativeName_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], IssueAlternativeName);\nexport { IssueAlternativeName };\n","import { BitString } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_keyUsage = `${id_ce}.15`;\nexport var KeyUsageFlags;\n(function (KeyUsageFlags) {\n    KeyUsageFlags[KeyUsageFlags[\"digitalSignature\"] = 1] = \"digitalSignature\";\n    KeyUsageFlags[KeyUsageFlags[\"nonRepudiation\"] = 2] = \"nonRepudiation\";\n    KeyUsageFlags[KeyUsageFlags[\"keyEncipherment\"] = 4] = \"keyEncipherment\";\n    KeyUsageFlags[KeyUsageFlags[\"dataEncipherment\"] = 8] = \"dataEncipherment\";\n    KeyUsageFlags[KeyUsageFlags[\"keyAgreement\"] = 16] = \"keyAgreement\";\n    KeyUsageFlags[KeyUsageFlags[\"keyCertSign\"] = 32] = \"keyCertSign\";\n    KeyUsageFlags[KeyUsageFlags[\"cRLSign\"] = 64] = \"cRLSign\";\n    KeyUsageFlags[KeyUsageFlags[\"encipherOnly\"] = 128] = \"encipherOnly\";\n    KeyUsageFlags[KeyUsageFlags[\"decipherOnly\"] = 256] = \"decipherOnly\";\n})(KeyUsageFlags || (KeyUsageFlags = {}));\nexport class KeyUsage extends BitString {\n    toJSON() {\n        const flag = this.toNumber();\n        const res = [];\n        if (flag & KeyUsageFlags.cRLSign) {\n            res.push(\"crlSign\");\n        }\n        if (flag & KeyUsageFlags.dataEncipherment) {\n            res.push(\"dataEncipherment\");\n        }\n        if (flag & KeyUsageFlags.decipherOnly) {\n            res.push(\"decipherOnly\");\n        }\n        if (flag & KeyUsageFlags.digitalSignature) {\n            res.push(\"digitalSignature\");\n        }\n        if (flag & KeyUsageFlags.encipherOnly) {\n            res.push(\"encipherOnly\");\n        }\n        if (flag & KeyUsageFlags.keyAgreement) {\n            res.push(\"keyAgreement\");\n        }\n        if (flag & KeyUsageFlags.keyCertSign) {\n            res.push(\"keyCertSign\");\n        }\n        if (flag & KeyUsageFlags.keyEncipherment) {\n            res.push(\"keyEncipherment\");\n        }\n        if (flag & KeyUsageFlags.nonRepudiation) {\n            res.push(\"nonRepudiation\");\n        }\n        return res;\n    }\n    toString() {\n        return `[${this.toJSON().join(\", \")}]`;\n    }\n}\n","var GeneralSubtrees_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralName } from \"../general_name\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_nameConstraints = `${id_ce}.30`;\nexport class GeneralSubtree {\n    constructor(params = {}) {\n        this.base = new GeneralName();\n        this.minimum = 0;\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralName })\n], GeneralSubtree.prototype, \"base\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, context: 0, defaultValue: 0, implicit: true })\n], GeneralSubtree.prototype, \"minimum\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, context: 1, optional: true, implicit: true })\n], GeneralSubtree.prototype, \"maximum\", void 0);\nlet GeneralSubtrees = GeneralSubtrees_1 = class GeneralSubtrees extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, GeneralSubtrees_1.prototype);\n    }\n};\nGeneralSubtrees = GeneralSubtrees_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: GeneralSubtree })\n], GeneralSubtrees);\nexport { GeneralSubtrees };\nexport class NameConstraints {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralSubtrees, context: 0, optional: true, implicit: true })\n], NameConstraints.prototype, \"permittedSubtrees\", void 0);\n__decorate([\n    AsnProp({ type: GeneralSubtrees, context: 1, optional: true, implicit: true })\n], NameConstraints.prototype, \"excludedSubtrees\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_policyConstraints = `${id_ce}.36`;\nexport class PolicyConstraints {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Integer,\n        context: 0,\n        implicit: true,\n        optional: true,\n        converter: AsnIntegerArrayBufferConverter,\n    })\n], PolicyConstraints.prototype, \"requireExplicitPolicy\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Integer,\n        context: 1,\n        implicit: true,\n        optional: true,\n        converter: AsnIntegerArrayBufferConverter,\n    })\n], PolicyConstraints.prototype, \"inhibitPolicyMapping\", void 0);\n","var PolicyMappings_1;\nimport { __decorate } from \"tslib\";\nimport { AsnArray, AsnProp, AsnPropTypes, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_policyMappings = `${id_ce}.33`;\nexport class PolicyMapping {\n    constructor(params = {}) {\n        this.issuerDomainPolicy = \"\";\n        this.subjectDomainPolicy = \"\";\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], PolicyMapping.prototype, \"issuerDomainPolicy\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], PolicyMapping.prototype, \"subjectDomainPolicy\", void 0);\nlet PolicyMappings = PolicyMappings_1 = class PolicyMappings extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, PolicyMappings_1.prototype);\n    }\n};\nPolicyMappings = PolicyMappings_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: PolicyMapping })\n], PolicyMappings);\nexport { PolicyMappings };\n","var SubjectAlternativeName_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralNames } from \"../general_names\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_subjectAltName = `${id_ce}.17`;\nlet SubjectAlternativeName = SubjectAlternativeName_1 = class SubjectAlternativeName extends GeneralNames {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, SubjectAlternativeName_1.prototype);\n    }\n};\nSubjectAlternativeName = SubjectAlternativeName_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], SubjectAlternativeName);\nexport { SubjectAlternativeName };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport class Attribute {\n    constructor(params = {}) {\n        this.type = \"\";\n        this.values = [];\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], Attribute.prototype, \"type\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, repeated: \"set\" })\n], Attribute.prototype, \"values\", void 0);\n","var SubjectDirectoryAttributes_1;\nimport { __decorate } from \"tslib\";\nimport { AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { Attribute } from \"../attribute\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_subjectDirectoryAttributes = `${id_ce}.9`;\nlet SubjectDirectoryAttributes = SubjectDirectoryAttributes_1 = class SubjectDirectoryAttributes extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, SubjectDirectoryAttributes_1.prototype);\n    }\n};\nSubjectDirectoryAttributes = SubjectDirectoryAttributes_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: Attribute })\n], SubjectDirectoryAttributes);\nexport { SubjectDirectoryAttributes };\n","import { id_ce } from \"../object_identifiers\";\nimport { KeyIdentifier } from \"./authority_key_identifier\";\nexport const id_ce_subjectKeyIdentifier = `${id_ce}.14`;\nexport class SubjectKeyIdentifier extends KeyIdentifier {\n}\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { id_ce } from \"../object_identifiers\";\nexport const id_ce_privateKeyUsagePeriod = `${id_ce}.16`;\nexport class PrivateKeyUsagePeriod {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime, context: 0, implicit: true, optional: true })\n], PrivateKeyUsagePeriod.prototype, \"notBefore\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime, context: 1, implicit: true, optional: true })\n], PrivateKeyUsagePeriod.prototype, \"notAfter\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, BitString } from \"@peculiar/asn1-schema\";\nexport const id_entrust_entrustVersInfo = \"1.2.840.113533.7.65.0\";\nexport var EntrustInfoFlags;\n(function (EntrustInfoFlags) {\n    EntrustInfoFlags[EntrustInfoFlags[\"keyUpdateAllowed\"] = 1] = \"keyUpdateAllowed\";\n    EntrustInfoFlags[EntrustInfoFlags[\"newExtensions\"] = 2] = \"newExtensions\";\n    EntrustInfoFlags[EntrustInfoFlags[\"pKIXCertificate\"] = 4] = \"pKIXCertificate\";\n})(EntrustInfoFlags || (EntrustInfoFlags = {}));\nexport class EntrustInfo extends BitString {\n    toJSON() {\n        const res = [];\n        const flags = this.toNumber();\n        if (flags & EntrustInfoFlags.pKIXCertificate) {\n            res.push(\"pKIXCertificate\");\n        }\n        if (flags & EntrustInfoFlags.newExtensions) {\n            res.push(\"newExtensions\");\n        }\n        if (flags & EntrustInfoFlags.keyUpdateAllowed) {\n            res.push(\"keyUpdateAllowed\");\n        }\n        return res;\n    }\n    toString() {\n        return `[${this.toJSON().join(\", \")}]`;\n    }\n}\nexport class EntrustVersionInfo {\n    constructor(params = {}) {\n        this.entrustVers = \"\";\n        this.entrustInfoFlags = new EntrustInfo();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralString })\n], EntrustVersionInfo.prototype, \"entrustVers\", void 0);\n__decorate([\n    AsnProp({ type: EntrustInfo })\n], EntrustVersionInfo.prototype, \"entrustInfoFlags\", void 0);\n","var SubjectInfoAccessSyntax_1;\nimport { __decorate } from \"tslib\";\nimport { AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { id_pe } from \"../object_identifiers\";\nimport { AccessDescription } from \"./authority_information_access\";\nexport const id_pe_subjectInfoAccess = `${id_pe}.11`;\nlet SubjectInfoAccessSyntax = SubjectInfoAccessSyntax_1 = class SubjectInfoAccessSyntax extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, SubjectInfoAccessSyntax_1.prototype);\n    }\n};\nSubjectInfoAccessSyntax = SubjectInfoAccessSyntax_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: AccessDescription })\n], SubjectInfoAccessSyntax);\nexport { SubjectInfoAccessSyntax };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport * as pvtsutils from \"pvtsutils\";\nexport class AlgorithmIdentifier {\n    constructor(params = {}) {\n        this.algorithm = \"\";\n        Object.assign(this, params);\n    }\n    isEqual(data) {\n        return (data instanceof AlgorithmIdentifier &&\n            data.algorithm == this.algorithm &&\n            ((data.parameters &&\n                this.parameters &&\n                pvtsutils.isEqual(data.parameters, this.parameters)) ||\n                data.parameters === this.parameters));\n    }\n}\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.ObjectIdentifier,\n    })\n], AlgorithmIdentifier.prototype, \"algorithm\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Any,\n        optional: true,\n    })\n], AlgorithmIdentifier.prototype, \"parameters\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"./algorithm_identifier\";\nexport class SubjectPublicKeyInfo {\n    constructor(params = {}) {\n        this.algorithm = new AlgorithmIdentifier();\n        this.subjectPublicKey = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], SubjectPublicKeyInfo.prototype, \"algorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString })\n], SubjectPublicKeyInfo.prototype, \"subjectPublicKey\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nlet Time = class Time {\n    constructor(time) {\n        if (time) {\n            if (typeof time === \"string\" || typeof time === \"number\" || time instanceof Date) {\n                const date = new Date(time);\n                if (date.getUTCFullYear() > 2049) {\n                    this.generalTime = date;\n                }\n                else {\n                    this.utcTime = date;\n                }\n            }\n            else {\n                Object.assign(this, time);\n            }\n        }\n    }\n    getTime() {\n        const time = this.utcTime || this.generalTime;\n        if (!time) {\n            throw new Error(\"Cannot get time from CHOICE object\");\n        }\n        return time;\n    }\n};\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.UTCTime,\n    })\n], Time.prototype, \"utcTime\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.GeneralizedTime,\n    })\n], Time.prototype, \"generalTime\", void 0);\nTime = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], Time);\nexport { Time };\n","import { __decorate } from \"tslib\";\nimport { AsnProp } from \"@peculiar/asn1-schema\";\nimport { Time } from \"./time\";\nexport class Validity {\n    constructor(params) {\n        this.notBefore = new Time(new Date());\n        this.notAfter = new Time(new Date());\n        if (params) {\n            this.notBefore = new Time(params.notBefore);\n            this.notAfter = new Time(params.notAfter);\n        }\n    }\n}\n__decorate([\n    AsnProp({ type: Time })\n], Validity.prototype, \"notBefore\", void 0);\n__decorate([\n    AsnProp({ type: Time })\n], Validity.prototype, \"notAfter\", void 0);\n","var Extensions_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes, OctetString, } from \"@peculiar/asn1-schema\";\nexport class Extension {\n    constructor(params = {}) {\n        this.extnID = \"\";\n        this.critical = Extension.CRITICAL;\n        this.extnValue = new OctetString();\n        Object.assign(this, params);\n    }\n}\nExtension.CRITICAL = false;\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], Extension.prototype, \"extnID\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Boolean,\n        defaultValue: Extension.CRITICAL,\n    })\n], Extension.prototype, \"critical\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], Extension.prototype, \"extnValue\", void 0);\nlet Extensions = Extensions_1 = class Extensions extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, Extensions_1.prototype);\n    }\n};\nExtensions = Extensions_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: Extension })\n], Extensions);\nexport { Extensions };\n","export var Version;\n(function (Version) {\n    Version[Version[\"v1\"] = 0] = \"v1\";\n    Version[Version[\"v2\"] = 1] = \"v2\";\n    Version[Version[\"v3\"] = 2] = \"v3\";\n})(Version || (Version = {}));\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"./algorithm_identifier\";\nimport { Name } from \"./name\";\nimport { SubjectPublicKeyInfo } from \"./subject_public_key_info\";\nimport { Validity } from \"./validity\";\nimport { Extensions } from \"./extension\";\nimport { Version } from \"./types\";\nexport class TBSCertificate {\n    constructor(params = {}) {\n        this.version = Version.v1;\n        this.serialNumber = new ArrayBuffer(0);\n        this.signature = new AlgorithmIdentifier();\n        this.issuer = new Name();\n        this.validity = new Validity();\n        this.subject = new Name();\n        this.subjectPublicKeyInfo = new SubjectPublicKeyInfo();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Integer,\n        context: 0,\n        defaultValue: Version.v1,\n    })\n], TBSCertificate.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.Integer,\n        converter: AsnIntegerArrayBufferConverter,\n    })\n], TBSCertificate.prototype, \"serialNumber\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], TBSCertificate.prototype, \"signature\", void 0);\n__decorate([\n    AsnProp({ type: Name })\n], TBSCertificate.prototype, \"issuer\", void 0);\n__decorate([\n    AsnProp({ type: Validity })\n], TBSCertificate.prototype, \"validity\", void 0);\n__decorate([\n    AsnProp({ type: Name })\n], TBSCertificate.prototype, \"subject\", void 0);\n__decorate([\n    AsnProp({ type: SubjectPublicKeyInfo })\n], TBSCertificate.prototype, \"subjectPublicKeyInfo\", void 0);\n__decorate([\n    AsnProp({\n        type: AsnPropTypes.BitString,\n        context: 1,\n        implicit: true,\n        optional: true,\n    })\n], TBSCertificate.prototype, \"issuerUniqueID\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString, context: 2, implicit: true, optional: true })\n], TBSCertificate.prototype, \"subjectUniqueID\", void 0);\n__decorate([\n    AsnProp({ type: Extensions, context: 3, optional: true })\n], TBSCertificate.prototype, \"extensions\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"./algorithm_identifier\";\nimport { TBSCertificate } from \"./tbs_certificate\";\nexport class Certificate {\n    constructor(params = {}) {\n        this.tbsCertificate = new TBSCertificate();\n        this.signatureAlgorithm = new AlgorithmIdentifier();\n        this.signatureValue = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: TBSCertificate })\n], Certificate.prototype, \"tbsCertificate\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], Certificate.prototype, \"signatureAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString })\n], Certificate.prototype, \"signatureValue\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"./algorithm_identifier\";\nimport { Name } from \"./name\";\nimport { Time } from \"./time\";\nimport { Extension } from \"./extension\";\nexport class RevokedCertificate {\n    constructor(params = {}) {\n        this.userCertificate = new ArrayBuffer(0);\n        this.revocationDate = new Time();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RevokedCertificate.prototype, \"userCertificate\", void 0);\n__decorate([\n    AsnProp({ type: Time })\n], RevokedCertificate.prototype, \"revocationDate\", void 0);\n__decorate([\n    AsnProp({ type: Extension, optional: true, repeated: \"sequence\" })\n], RevokedCertificate.prototype, \"crlEntryExtensions\", void 0);\nexport class TBSCertList {\n    constructor(params = {}) {\n        this.signature = new AlgorithmIdentifier();\n        this.issuer = new Name();\n        this.thisUpdate = new Time();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, optional: true })\n], TBSCertList.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], TBSCertList.prototype, \"signature\", void 0);\n__decorate([\n    AsnProp({ type: Name })\n], TBSCertList.prototype, \"issuer\", void 0);\n__decorate([\n    AsnProp({ type: Time })\n], TBSCertList.prototype, \"thisUpdate\", void 0);\n__decorate([\n    AsnProp({ type: Time, optional: true })\n], TBSCertList.prototype, \"nextUpdate\", void 0);\n__decorate([\n    AsnProp({ type: RevokedCertificate, repeated: \"sequence\", optional: true })\n], TBSCertList.prototype, \"revokedCertificates\", void 0);\n__decorate([\n    AsnProp({ type: Extension, optional: true, context: 0, repeated: \"sequence\" })\n], TBSCertList.prototype, \"crlExtensions\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"./algorithm_identifier\";\nimport { TBSCertList } from \"./tbs_cert_list\";\nexport class CertificateList {\n    constructor(params = {}) {\n        this.tbsCertList = new TBSCertList();\n        this.signatureAlgorithm = new AlgorithmIdentifier();\n        this.signature = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: TBSCertList })\n], CertificateList.prototype, \"tbsCertList\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], CertificateList.prototype, \"signatureAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString })\n], CertificateList.prototype, \"signature\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nimport { Name } from \"@peculiar/asn1-x509\";\nexport class IssuerAndSerialNumber {\n    constructor(params = {}) {\n        this.issuer = new Name;\n        this.serialNumber = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: Name })\n], IssuerAndSerialNumber.prototype, \"issuer\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], IssuerAndSerialNumber.prototype, \"serialNumber\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { IssuerAndSerialNumber } from \"./issuer_and_serial_number\";\nimport { SubjectKeyIdentifier } from \"@peculiar/asn1-x509\";\nlet SignerIdentifier = class SignerIdentifier {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: SubjectKeyIdentifier, context: 0, implicit: true })\n], SignerIdentifier.prototype, \"subjectKeyIdentifier\", void 0);\n__decorate([\n    AsnProp({ type: IssuerAndSerialNumber })\n], SignerIdentifier.prototype, \"issuerAndSerialNumber\", void 0);\nSignerIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], SignerIdentifier);\nexport { SignerIdentifier };\n","import { __decorate } from \"tslib\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nimport { AsnTypeTypes, AsnType } from \"@peculiar/asn1-schema\";\nexport var CMSVersion;\n(function (CMSVersion) {\n    CMSVersion[CMSVersion[\"v0\"] = 0] = \"v0\";\n    CMSVersion[CMSVersion[\"v1\"] = 1] = \"v1\";\n    CMSVersion[CMSVersion[\"v2\"] = 2] = \"v2\";\n    CMSVersion[CMSVersion[\"v3\"] = 3] = \"v3\";\n    CMSVersion[CMSVersion[\"v4\"] = 4] = \"v4\";\n    CMSVersion[CMSVersion[\"v5\"] = 5] = \"v5\";\n})(CMSVersion || (CMSVersion = {}));\nlet DigestAlgorithmIdentifier = class DigestAlgorithmIdentifier extends AlgorithmIdentifier {\n};\nDigestAlgorithmIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], DigestAlgorithmIdentifier);\nexport { DigestAlgorithmIdentifier };\nlet SignatureAlgorithmIdentifier = class SignatureAlgorithmIdentifier extends AlgorithmIdentifier {\n};\nSignatureAlgorithmIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], SignatureAlgorithmIdentifier);\nexport { SignatureAlgorithmIdentifier };\nlet KeyEncryptionAlgorithmIdentifier = class KeyEncryptionAlgorithmIdentifier extends AlgorithmIdentifier {\n};\nKeyEncryptionAlgorithmIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], KeyEncryptionAlgorithmIdentifier);\nexport { KeyEncryptionAlgorithmIdentifier };\nlet ContentEncryptionAlgorithmIdentifier = class ContentEncryptionAlgorithmIdentifier extends AlgorithmIdentifier {\n};\nContentEncryptionAlgorithmIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], ContentEncryptionAlgorithmIdentifier);\nexport { ContentEncryptionAlgorithmIdentifier };\nlet MessageAuthenticationCodeAlgorithm = class MessageAuthenticationCodeAlgorithm extends AlgorithmIdentifier {\n};\nMessageAuthenticationCodeAlgorithm = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], MessageAuthenticationCodeAlgorithm);\nexport { MessageAuthenticationCodeAlgorithm };\nlet KeyDerivationAlgorithmIdentifier = class KeyDerivationAlgorithmIdentifier extends AlgorithmIdentifier {\n};\nKeyDerivationAlgorithmIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], KeyDerivationAlgorithmIdentifier);\nexport { KeyDerivationAlgorithmIdentifier };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport class Attribute {\n    constructor(params = {}) {\n        this.attrType = \"\";\n        this.attrValues = [];\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], Attribute.prototype, \"attrType\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, repeated: \"set\" })\n], Attribute.prototype, \"attrValues\", void 0);\n","var SignerInfos_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { SignerIdentifier } from \"./signer_identifier\";\nimport { CMSVersion, SignatureAlgorithmIdentifier, DigestAlgorithmIdentifier } from \"./types\";\nimport { Attribute } from \"./attribute\";\nexport class SignerInfo {\n    constructor(params = {}) {\n        this.version = CMSVersion.v0;\n        this.sid = new SignerIdentifier();\n        this.digestAlgorithm = new DigestAlgorithmIdentifier();\n        this.signatureAlgorithm = new SignatureAlgorithmIdentifier();\n        this.signature = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], SignerInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: SignerIdentifier })\n], SignerInfo.prototype, \"sid\", void 0);\n__decorate([\n    AsnProp({ type: DigestAlgorithmIdentifier })\n], SignerInfo.prototype, \"digestAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: Attribute, repeated: \"set\", context: 0, implicit: true, optional: true })\n], SignerInfo.prototype, \"signedAttrs\", void 0);\n__decorate([\n    AsnProp({ type: SignatureAlgorithmIdentifier })\n], SignerInfo.prototype, \"signatureAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], SignerInfo.prototype, \"signature\", void 0);\n__decorate([\n    AsnProp({ type: Attribute, repeated: \"set\", context: 1, implicit: true, optional: true })\n], SignerInfo.prototype, \"unsignedAttrs\", void 0);\nlet SignerInfos = SignerInfos_1 = class SignerInfos extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, SignerInfos_1.prototype);\n    }\n};\nSignerInfos = SignerInfos_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: SignerInfo })\n], SignerInfos);\nexport { SignerInfos };\n","import { __decorate } from \"tslib\";\nimport { AsnTypeTypes, AsnType } from \"@peculiar/asn1-schema\";\nimport { Time } from \"@peculiar/asn1-x509\";\nimport { SignerInfo } from \"./signer_info\";\nlet SigningTime = class SigningTime extends Time {\n};\nSigningTime = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], SigningTime);\nexport { SigningTime };\nlet CounterSignature = class CounterSignature extends SignerInfo {\n};\nCounterSignature = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], CounterSignature);\nexport { CounterSignature };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralName, Attribute } from \"@peculiar/asn1-x509\";\nexport class ACClearAttrs {\n    constructor(params = {}) {\n        this.acIssuer = new GeneralName();\n        this.acSerial = 0;\n        this.attrs = [];\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralName })\n], ACClearAttrs.prototype, \"acIssuer\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], ACClearAttrs.prototype, \"acSerial\", void 0);\n__decorate([\n    AsnProp({ type: Attribute, repeated: \"sequence\" })\n], ACClearAttrs.prototype, \"attrs\", void 0);\n","var AttrSpec_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes, AsnPropTypes, AsnArray } from \"@peculiar/asn1-schema\";\nlet AttrSpec = AttrSpec_1 = class AttrSpec extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, AttrSpec_1.prototype);\n    }\n};\nAttrSpec = AttrSpec_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: AsnPropTypes.ObjectIdentifier })\n], AttrSpec);\nexport { AttrSpec };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { AttrSpec } from \"./attr_spec\";\nexport class AAControls {\n    constructor(params = {}) {\n        this.permitUnSpecified = true;\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, optional: true })\n], AAControls.prototype, \"pathLenConstraint\", void 0);\n__decorate([\n    AsnProp({ type: AttrSpec, implicit: true, context: 0, optional: true })\n], AAControls.prototype, \"permittedAttrs\", void 0);\n__decorate([\n    AsnProp({ type: AttrSpec, implicit: true, context: 1, optional: true })\n], AAControls.prototype, \"excludedAttrs\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Boolean, defaultValue: true })\n], AAControls.prototype, \"permitUnSpecified\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nimport { GeneralNames } from \"@peculiar/asn1-x509\";\nexport class IssuerSerial {\n    constructor(params = {}) {\n        this.issuer = new GeneralNames();\n        this.serial = new ArrayBuffer(0);\n        this.issuerUID = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralNames })\n], IssuerSerial.prototype, \"issuer\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], IssuerSerial.prototype, \"serial\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString, optional: true })\n], IssuerSerial.prototype, \"issuerUID\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nexport var DigestedObjectType;\n(function (DigestedObjectType) {\n    DigestedObjectType[DigestedObjectType[\"publicKey\"] = 0] = \"publicKey\";\n    DigestedObjectType[DigestedObjectType[\"publicKeyCert\"] = 1] = \"publicKeyCert\";\n    DigestedObjectType[DigestedObjectType[\"otherObjectTypes\"] = 2] = \"otherObjectTypes\";\n})(DigestedObjectType || (DigestedObjectType = {}));\nexport class ObjectDigestInfo {\n    constructor(params = {}) {\n        this.digestedObjectType = DigestedObjectType.publicKey;\n        this.digestAlgorithm = new AlgorithmIdentifier();\n        this.objectDigest = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Enumerated })\n], ObjectDigestInfo.prototype, \"digestedObjectType\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier, optional: true })\n], ObjectDigestInfo.prototype, \"otherObjectTypeID\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], ObjectDigestInfo.prototype, \"digestAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString })\n], ObjectDigestInfo.prototype, \"objectDigest\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp } from \"@peculiar/asn1-schema\";\nimport { GeneralNames } from \"@peculiar/asn1-x509\";\nimport { IssuerSerial } from \"./issuer_serial\";\nimport { ObjectDigestInfo } from \"./object_digest_info\";\nexport class V2Form {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralNames, optional: true })\n], V2Form.prototype, \"issuerName\", void 0);\n__decorate([\n    AsnProp({ type: IssuerSerial, context: 0, implicit: true, optional: true })\n], V2Form.prototype, \"baseCertificateID\", void 0);\n__decorate([\n    AsnProp({ type: ObjectDigestInfo, context: 1, implicit: true, optional: true })\n], V2Form.prototype, \"objectDigestInfo\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes, AsnProp } from \"@peculiar/asn1-schema\";\nimport { GeneralName } from \"@peculiar/asn1-x509\";\nimport { V2Form } from \"./v2_form\";\nlet AttCertIssuer = class AttCertIssuer {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: GeneralName, repeated: \"sequence\" })\n], AttCertIssuer.prototype, \"v1Form\", void 0);\n__decorate([\n    AsnProp({ type: V2Form, context: 0, implicit: true })\n], AttCertIssuer.prototype, \"v2Form\", void 0);\nAttCertIssuer = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], AttCertIssuer);\nexport { AttCertIssuer };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport class AttCertValidityPeriod {\n    constructor(params = {}) {\n        this.notBeforeTime = new Date();\n        this.notAfterTime = new Date();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime })\n], AttCertValidityPeriod.prototype, \"notBeforeTime\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime })\n], AttCertValidityPeriod.prototype, \"notAfterTime\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp } from \"@peculiar/asn1-schema\";\nimport { IssuerSerial } from \"./issuer_serial\";\nimport { GeneralNames } from \"@peculiar/asn1-x509\";\nimport { ObjectDigestInfo } from \"./object_digest_info\";\nexport class Holder {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: IssuerSerial, implicit: true, context: 0, optional: true })\n], Holder.prototype, \"baseCertificateID\", void 0);\n__decorate([\n    AsnProp({ type: GeneralNames, implicit: true, context: 1, optional: true })\n], Holder.prototype, \"entityName\", void 0);\n__decorate([\n    AsnProp({ type: ObjectDigestInfo, implicit: true, context: 2, optional: true })\n], Holder.prototype, \"objectDigestInfo\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier, Attribute, Extensions } from \"@peculiar/asn1-x509\";\nimport { Holder } from \"./holder\";\nimport { AttCertIssuer } from \"./attr_cert_issuer\";\nimport { AttCertValidityPeriod } from \"./attr_cert_validity_period\";\nexport var AttCertVersion;\n(function (AttCertVersion) {\n    AttCertVersion[AttCertVersion[\"v2\"] = 1] = \"v2\";\n})(AttCertVersion || (AttCertVersion = {}));\nexport class AttributeCertificateInfo {\n    constructor(params = {}) {\n        this.version = AttCertVersion.v2;\n        this.holder = new Holder();\n        this.issuer = new AttCertIssuer();\n        this.signature = new AlgorithmIdentifier();\n        this.serialNumber = new ArrayBuffer(0);\n        this.attrCertValidityPeriod = new AttCertValidityPeriod();\n        this.attributes = [];\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], AttributeCertificateInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: Holder })\n], AttributeCertificateInfo.prototype, \"holder\", void 0);\n__decorate([\n    AsnProp({ type: AttCertIssuer })\n], AttributeCertificateInfo.prototype, \"issuer\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], AttributeCertificateInfo.prototype, \"signature\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], AttributeCertificateInfo.prototype, \"serialNumber\", void 0);\n__decorate([\n    AsnProp({ type: AttCertValidityPeriod })\n], AttributeCertificateInfo.prototype, \"attrCertValidityPeriod\", void 0);\n__decorate([\n    AsnProp({ type: Attribute, repeated: \"sequence\" })\n], AttributeCertificateInfo.prototype, \"attributes\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString, optional: true })\n], AttributeCertificateInfo.prototype, \"issuerUniqueID\", void 0);\n__decorate([\n    AsnProp({ type: Extensions, optional: true })\n], AttributeCertificateInfo.prototype, \"extensions\", void 0);\n","import { BitString } from \"@peculiar/asn1-schema\";\nexport var ClassListFlags;\n(function (ClassListFlags) {\n    ClassListFlags[ClassListFlags[\"unmarked\"] = 1] = \"unmarked\";\n    ClassListFlags[ClassListFlags[\"unclassified\"] = 2] = \"unclassified\";\n    ClassListFlags[ClassListFlags[\"restricted\"] = 4] = \"restricted\";\n    ClassListFlags[ClassListFlags[\"confidential\"] = 8] = \"confidential\";\n    ClassListFlags[ClassListFlags[\"secret\"] = 16] = \"secret\";\n    ClassListFlags[ClassListFlags[\"topSecret\"] = 32] = \"topSecret\";\n})(ClassListFlags || (ClassListFlags = {}));\nexport class ClassList extends BitString {\n}\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nimport { AttributeCertificateInfo } from \"./attribute_certificate_info\";\nexport class AttributeCertificate {\n    constructor(params = {}) {\n        this.acinfo = new AttributeCertificateInfo();\n        this.signatureAlgorithm = new AlgorithmIdentifier();\n        this.signatureValue = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AttributeCertificateInfo })\n], AttributeCertificate.prototype, \"acinfo\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], AttributeCertificate.prototype, \"signatureAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString })\n], AttributeCertificate.prototype, \"signatureValue\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport class SecurityCategory {\n    constructor(params = {}) {\n        this.type = \"\";\n        this.value = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier, implicit: true, context: 0 })\n], SecurityCategory.prototype, \"type\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, implicit: true, context: 1 })\n], SecurityCategory.prototype, \"value\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { ClassList, ClassListFlags } from \"./class_list\";\nimport { SecurityCategory } from \"./security_category\";\nexport class Clearance {\n    constructor(params = {}) {\n        this.policyId = \"\";\n        this.classList = new ClassList(ClassListFlags.unclassified);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], Clearance.prototype, \"policyId\", void 0);\n__decorate([\n    AsnProp({ type: ClassList, defaultValue: new ClassList(ClassListFlags.unclassified) })\n], Clearance.prototype, \"classList\", void 0);\n__decorate([\n    AsnProp({ type: SecurityCategory, repeated: \"set\" })\n], Clearance.prototype, \"securityCategories\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, OctetString, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { GeneralNames } from \"@peculiar/asn1-x509\";\nexport class IetfAttrSyntaxValueChoices {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: OctetString })\n], IetfAttrSyntaxValueChoices.prototype, \"cotets\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], IetfAttrSyntaxValueChoices.prototype, \"oid\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Utf8String })\n], IetfAttrSyntaxValueChoices.prototype, \"string\", void 0);\nexport class IetfAttrSyntax {\n    constructor(params = {}) {\n        this.values = [];\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralNames, implicit: true, context: 0, optional: true })\n], IetfAttrSyntax.prototype, \"policyAuthority\", void 0);\n__decorate([\n    AsnProp({ type: IetfAttrSyntaxValueChoices, repeated: \"sequence\" })\n], IetfAttrSyntax.prototype, \"values\", void 0);\n","var Targets_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnType, AsnTypeTypes, AsnArray } from \"@peculiar/asn1-schema\";\nimport { GeneralName } from \"@peculiar/asn1-x509\";\nimport { IssuerSerial } from \"./issuer_serial\";\nimport { ObjectDigestInfo } from \"./object_digest_info\";\nexport class TargetCert {\n    constructor(params = {}) {\n        this.targetCertificate = new IssuerSerial();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: IssuerSerial })\n], TargetCert.prototype, \"targetCertificate\", void 0);\n__decorate([\n    AsnProp({ type: GeneralName, optional: true })\n], TargetCert.prototype, \"targetName\", void 0);\n__decorate([\n    AsnProp({ type: ObjectDigestInfo, optional: true })\n], TargetCert.prototype, \"certDigestInfo\", void 0);\nlet Target = class Target {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: GeneralName, context: 0, implicit: true })\n], Target.prototype, \"targetName\", void 0);\n__decorate([\n    AsnProp({ type: GeneralName, context: 1, implicit: true })\n], Target.prototype, \"targetGroup\", void 0);\n__decorate([\n    AsnProp({ type: TargetCert, context: 2, implicit: true })\n], Target.prototype, \"targetCert\", void 0);\nTarget = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], Target);\nexport { Target };\nlet Targets = Targets_1 = class Targets extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, Targets_1.prototype);\n    }\n};\nTargets = Targets_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: Target })\n], Targets);\nexport { Targets };\n","var ProxyInfo_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes, AsnArray } from \"@peculiar/asn1-schema\";\nimport { Targets } from \"./target\";\nlet ProxyInfo = ProxyInfo_1 = class ProxyInfo extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, ProxyInfo_1.prototype);\n    }\n};\nProxyInfo = ProxyInfo_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: Targets })\n], ProxyInfo);\nexport { ProxyInfo };\n","import { __decorate } from \"tslib\";\nimport { AsnProp } from \"@peculiar/asn1-schema\";\nimport { GeneralNames, GeneralName } from \"@peculiar/asn1-x509\";\nexport class RoleSyntax {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralNames, implicit: true, context: 0, optional: true })\n], RoleSyntax.prototype, \"roleAuthority\", void 0);\n__decorate([\n    AsnProp({ type: GeneralName, implicit: true, context: 1 })\n], RoleSyntax.prototype, \"roleName\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, OctetString } from \"@peculiar/asn1-schema\";\nimport { GeneralName } from \"@peculiar/asn1-x509\";\nexport class SvceAuthInfo {\n    constructor(params = {}) {\n        this.service = new GeneralName();\n        this.ident = new GeneralName();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: GeneralName })\n], SvceAuthInfo.prototype, \"service\", void 0);\n__decorate([\n    AsnProp({ type: GeneralName })\n], SvceAuthInfo.prototype, \"ident\", void 0);\n__decorate([\n    AsnProp({ type: OctetString, optional: true })\n], SvceAuthInfo.prototype, \"authInfo\", void 0);\n","var CertificateSet_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes, AsnProp, AsnPropTypes, AsnArray } from \"@peculiar/asn1-schema\";\nimport { Certificate } from \"@peculiar/asn1-x509\";\nimport { AttributeCertificate } from '@peculiar/asn1-x509-attr';\nexport class OtherCertificateFormat {\n    constructor(params = {}) {\n        this.otherCertFormat = \"\";\n        this.otherCert = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], OtherCertificateFormat.prototype, \"otherCertFormat\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any })\n], OtherCertificateFormat.prototype, \"otherCert\", void 0);\nlet CertificateChoices = class CertificateChoices {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: Certificate })\n], CertificateChoices.prototype, \"certificate\", void 0);\n__decorate([\n    AsnProp({ type: AttributeCertificate, context: 2, implicit: true })\n], CertificateChoices.prototype, \"v2AttrCert\", void 0);\n__decorate([\n    AsnProp({ type: OtherCertificateFormat, context: 3, implicit: true })\n], CertificateChoices.prototype, \"other\", void 0);\nCertificateChoices = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], CertificateChoices);\nexport { CertificateChoices };\nlet CertificateSet = CertificateSet_1 = class CertificateSet extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, CertificateSet_1.prototype);\n    }\n};\nCertificateSet = CertificateSet_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: CertificateChoices })\n], CertificateSet);\nexport { CertificateSet };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport class ContentInfo {\n    constructor(params = {}) {\n        this.contentType = \"\";\n        this.content = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], ContentInfo.prototype, \"contentType\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, context: 0 })\n], ContentInfo.prototype, \"content\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, OctetString } from \"@peculiar/asn1-schema\";\nlet EncapsulatedContent = class EncapsulatedContent {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: OctetString })\n], EncapsulatedContent.prototype, \"single\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any })\n], EncapsulatedContent.prototype, \"any\", void 0);\nEncapsulatedContent = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], EncapsulatedContent);\nexport { EncapsulatedContent };\nexport class EncapsulatedContentInfo {\n    constructor(params = {}) {\n        this.eContentType = \"\";\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], EncapsulatedContentInfo.prototype, \"eContentType\", void 0);\n__decorate([\n    AsnProp({ type: EncapsulatedContent, context: 0, optional: true })\n], EncapsulatedContentInfo.prototype, \"eContent\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnConstructedOctetStringConverter, AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { ContentEncryptionAlgorithmIdentifier } from \"./types\";\nlet EncryptedContent = class EncryptedContent {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: OctetString, context: 0, implicit: true, optional: true })\n], EncryptedContent.prototype, \"value\", void 0);\n__decorate([\n    AsnProp({ type: OctetString, converter: AsnConstructedOctetStringConverter, context: 0, implicit: true, optional: true, repeated: \"sequence\" })\n], EncryptedContent.prototype, \"constructedValue\", void 0);\nEncryptedContent = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], EncryptedContent);\nexport { EncryptedContent };\nexport class EncryptedContentInfo {\n    constructor(params = {}) {\n        this.contentType = \"\";\n        this.contentEncryptionAlgorithm = new ContentEncryptionAlgorithmIdentifier();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], EncryptedContentInfo.prototype, \"contentType\", void 0);\n__decorate([\n    AsnProp({ type: ContentEncryptionAlgorithmIdentifier })\n], EncryptedContentInfo.prototype, \"contentEncryptionAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: EncryptedContent, optional: true })\n], EncryptedContentInfo.prototype, \"encryptedContent\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport class OtherKeyAttribute {\n    constructor(params = {}) {\n        this.keyAttrId = \"\";\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], OtherKeyAttribute.prototype, \"keyAttrId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, optional: true })\n], OtherKeyAttribute.prototype, \"keyAttr\", void 0);\n","var RecipientEncryptedKeys_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { CMSVersion, KeyEncryptionAlgorithmIdentifier } from \"./types\";\nimport { IssuerAndSerialNumber } from \"./issuer_and_serial_number\";\nimport { AlgorithmIdentifier, SubjectKeyIdentifier } from \"@peculiar/asn1-x509\";\nimport { OtherKeyAttribute } from \"./other_key_attribute\";\nexport class RecipientKeyIdentifier {\n    constructor(params = {}) {\n        this.subjectKeyIdentifier = new SubjectKeyIdentifier();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: SubjectKeyIdentifier })\n], RecipientKeyIdentifier.prototype, \"subjectKeyIdentifier\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime, optional: true })\n], RecipientKeyIdentifier.prototype, \"date\", void 0);\n__decorate([\n    AsnProp({ type: OtherKeyAttribute, optional: true })\n], RecipientKeyIdentifier.prototype, \"other\", void 0);\nlet KeyAgreeRecipientIdentifier = class KeyAgreeRecipientIdentifier {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: RecipientKeyIdentifier, context: 0, implicit: true, optional: true })\n], KeyAgreeRecipientIdentifier.prototype, \"rKeyId\", void 0);\n__decorate([\n    AsnProp({ type: IssuerAndSerialNumber, optional: true })\n], KeyAgreeRecipientIdentifier.prototype, \"issuerAndSerialNumber\", void 0);\nKeyAgreeRecipientIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], KeyAgreeRecipientIdentifier);\nexport { KeyAgreeRecipientIdentifier };\nexport class RecipientEncryptedKey {\n    constructor(params = {}) {\n        this.rid = new KeyAgreeRecipientIdentifier();\n        this.encryptedKey = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: KeyAgreeRecipientIdentifier })\n], RecipientEncryptedKey.prototype, \"rid\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], RecipientEncryptedKey.prototype, \"encryptedKey\", void 0);\nlet RecipientEncryptedKeys = RecipientEncryptedKeys_1 = class RecipientEncryptedKeys extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, RecipientEncryptedKeys_1.prototype);\n    }\n};\nRecipientEncryptedKeys = RecipientEncryptedKeys_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: RecipientEncryptedKey })\n], RecipientEncryptedKeys);\nexport { RecipientEncryptedKeys };\nexport class OriginatorPublicKey {\n    constructor(params = {}) {\n        this.algorithm = new AlgorithmIdentifier();\n        this.publicKey = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], OriginatorPublicKey.prototype, \"algorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString })\n], OriginatorPublicKey.prototype, \"publicKey\", void 0);\nlet OriginatorIdentifierOrKey = class OriginatorIdentifierOrKey {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: SubjectKeyIdentifier, context: 0, implicit: true, optional: true })\n], OriginatorIdentifierOrKey.prototype, \"subjectKeyIdentifier\", void 0);\n__decorate([\n    AsnProp({ type: OriginatorPublicKey, context: 1, implicit: true, optional: true })\n], OriginatorIdentifierOrKey.prototype, \"originatorKey\", void 0);\n__decorate([\n    AsnProp({ type: IssuerAndSerialNumber, optional: true })\n], OriginatorIdentifierOrKey.prototype, \"issuerAndSerialNumber\", void 0);\nOriginatorIdentifierOrKey = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], OriginatorIdentifierOrKey);\nexport { OriginatorIdentifierOrKey };\nexport class KeyAgreeRecipientInfo {\n    constructor(params = {}) {\n        this.version = CMSVersion.v3;\n        this.originator = new OriginatorIdentifierOrKey();\n        this.keyEncryptionAlgorithm = new KeyEncryptionAlgorithmIdentifier();\n        this.recipientEncryptedKeys = new RecipientEncryptedKeys();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], KeyAgreeRecipientInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: OriginatorIdentifierOrKey, context: 0 })\n], KeyAgreeRecipientInfo.prototype, \"originator\", void 0);\n__decorate([\n    AsnProp({ type: OctetString, context: 1, optional: true })\n], KeyAgreeRecipientInfo.prototype, \"ukm\", void 0);\n__decorate([\n    AsnProp({ type: KeyEncryptionAlgorithmIdentifier })\n], KeyAgreeRecipientInfo.prototype, \"keyEncryptionAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: RecipientEncryptedKeys })\n], KeyAgreeRecipientInfo.prototype, \"recipientEncryptedKeys\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { CMSVersion, KeyEncryptionAlgorithmIdentifier } from \"./types\";\nimport { IssuerAndSerialNumber } from \"./issuer_and_serial_number\";\nimport { SubjectKeyIdentifier } from \"@peculiar/asn1-x509\";\nlet RecipientIdentifier = class RecipientIdentifier {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: SubjectKeyIdentifier, context: 0, implicit: true })\n], RecipientIdentifier.prototype, \"subjectKeyIdentifier\", void 0);\n__decorate([\n    AsnProp({ type: IssuerAndSerialNumber })\n], RecipientIdentifier.prototype, \"issuerAndSerialNumber\", void 0);\nRecipientIdentifier = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], RecipientIdentifier);\nexport { RecipientIdentifier };\nexport class KeyTransRecipientInfo {\n    constructor(params = {}) {\n        this.version = CMSVersion.v0;\n        this.rid = new RecipientIdentifier();\n        this.keyEncryptionAlgorithm = new KeyEncryptionAlgorithmIdentifier();\n        this.encryptedKey = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], KeyTransRecipientInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: RecipientIdentifier })\n], KeyTransRecipientInfo.prototype, \"rid\", void 0);\n__decorate([\n    AsnProp({ type: KeyEncryptionAlgorithmIdentifier })\n], KeyTransRecipientInfo.prototype, \"keyEncryptionAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], KeyTransRecipientInfo.prototype, \"encryptedKey\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { OtherKeyAttribute } from \"./other_key_attribute\";\nimport { CMSVersion, KeyEncryptionAlgorithmIdentifier } from \"./types\";\nexport class KEKIdentifier {\n    constructor(params = {}) {\n        this.keyIdentifier = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: OctetString })\n], KEKIdentifier.prototype, \"keyIdentifier\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime, optional: true })\n], KEKIdentifier.prototype, \"date\", void 0);\n__decorate([\n    AsnProp({ type: OtherKeyAttribute, optional: true })\n], KEKIdentifier.prototype, \"other\", void 0);\nexport class KEKRecipientInfo {\n    constructor(params = {}) {\n        this.version = CMSVersion.v4;\n        this.kekid = new KEKIdentifier();\n        this.keyEncryptionAlgorithm = new KeyEncryptionAlgorithmIdentifier();\n        this.encryptedKey = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], KEKRecipientInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: KEKIdentifier })\n], KEKRecipientInfo.prototype, \"kekid\", void 0);\n__decorate([\n    AsnProp({ type: KeyEncryptionAlgorithmIdentifier })\n], KEKRecipientInfo.prototype, \"keyEncryptionAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], KEKRecipientInfo.prototype, \"encryptedKey\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { CMSVersion, KeyDerivationAlgorithmIdentifier, KeyEncryptionAlgorithmIdentifier } from \"./types\";\nexport class PasswordRecipientInfo {\n    constructor(params = {}) {\n        this.version = CMSVersion.v0;\n        this.keyEncryptionAlgorithm = new KeyEncryptionAlgorithmIdentifier();\n        this.encryptedKey = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], PasswordRecipientInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: KeyDerivationAlgorithmIdentifier, context: 0, optional: true })\n], PasswordRecipientInfo.prototype, \"keyDerivationAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: KeyEncryptionAlgorithmIdentifier })\n], PasswordRecipientInfo.prototype, \"keyEncryptionAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], PasswordRecipientInfo.prototype, \"encryptedKey\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { KeyAgreeRecipientInfo } from \"./key_agree_recipient_info\";\nimport { KeyTransRecipientInfo } from \"./key_trans_recipient_info\";\nimport { KEKRecipientInfo } from \"./kek_recipient_info\";\nimport { PasswordRecipientInfo } from \"./password_recipient_info\";\nexport class OtherRecipientInfo {\n    constructor(params = {}) {\n        this.oriType = \"\";\n        this.oriValue = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], OtherRecipientInfo.prototype, \"oriType\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any })\n], OtherRecipientInfo.prototype, \"oriValue\", void 0);\nlet RecipientInfo = class RecipientInfo {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: KeyTransRecipientInfo, optional: true })\n], RecipientInfo.prototype, \"ktri\", void 0);\n__decorate([\n    AsnProp({ type: KeyAgreeRecipientInfo, context: 1, implicit: true, optional: true })\n], RecipientInfo.prototype, \"kari\", void 0);\n__decorate([\n    AsnProp({ type: KEKRecipientInfo, context: 2, implicit: true, optional: true })\n], RecipientInfo.prototype, \"kekri\", void 0);\n__decorate([\n    AsnProp({ type: PasswordRecipientInfo, context: 3, implicit: true, optional: true })\n], RecipientInfo.prototype, \"pwri\", void 0);\n__decorate([\n    AsnProp({ type: OtherRecipientInfo, context: 4, implicit: true, optional: true })\n], RecipientInfo.prototype, \"ori\", void 0);\nRecipientInfo = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], RecipientInfo);\nexport { RecipientInfo };\n","var RecipientInfos_1;\nimport { __decorate } from \"tslib\";\nimport { AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { RecipientInfo } from \"./recipient_info\";\nlet RecipientInfos = RecipientInfos_1 = class RecipientInfos extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, RecipientInfos_1.prototype);\n    }\n};\nRecipientInfos = RecipientInfos_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: RecipientInfo })\n], RecipientInfos);\nexport { RecipientInfos };\n","var RevocationInfoChoices_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnType, AsnTypeTypes, AsnArray } from \"@peculiar/asn1-schema\";\nimport { id_pkix } from \"@peculiar/asn1-x509\";\nexport const id_ri = `${id_pkix}.16`;\nexport const id_ri_ocsp_response = `${id_ri}.2`;\nexport const id_ri_scvp = `${id_ri}.4`;\nexport class OtherRevocationInfoFormat {\n    constructor(params = {}) {\n        this.otherRevInfoFormat = \"\";\n        this.otherRevInfo = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], OtherRevocationInfoFormat.prototype, \"otherRevInfoFormat\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any })\n], OtherRevocationInfoFormat.prototype, \"otherRevInfo\", void 0);\nlet RevocationInfoChoice = class RevocationInfoChoice {\n    constructor(params = {}) {\n        this.other = new OtherRevocationInfoFormat();\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: OtherRevocationInfoFormat, context: 1, implicit: true })\n], RevocationInfoChoice.prototype, \"other\", void 0);\nRevocationInfoChoice = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], RevocationInfoChoice);\nexport { RevocationInfoChoice };\nlet RevocationInfoChoices = RevocationInfoChoices_1 = class RevocationInfoChoices extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, RevocationInfoChoices_1.prototype);\n    }\n};\nRevocationInfoChoices = RevocationInfoChoices_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: RevocationInfoChoice })\n], RevocationInfoChoices);\nexport { RevocationInfoChoices };\n","import { __decorate } from \"tslib\";\nimport { AsnProp } from \"@peculiar/asn1-schema\";\nimport { CertificateSet } from \"./certificate_choices\";\nimport { RevocationInfoChoices } from \"./revocation_info_choice\";\nexport class OriginatorInfo {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: CertificateSet, context: 0, implicit: true, optional: true })\n], OriginatorInfo.prototype, \"certs\", void 0);\n__decorate([\n    AsnProp({ type: RevocationInfoChoices, context: 1, implicit: true, optional: true })\n], OriginatorInfo.prototype, \"crls\", void 0);\n","var UnprotectedAttributes_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { CMSVersion } from \"./types\";\nimport { Attribute } from \"./attribute\";\nimport { RecipientInfos } from \"./recipient_infos\";\nimport { OriginatorInfo } from \"./originator_info\";\nimport { EncryptedContentInfo } from \"./encrypted_content_info\";\nlet UnprotectedAttributes = UnprotectedAttributes_1 = class UnprotectedAttributes extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, UnprotectedAttributes_1.prototype);\n    }\n};\nUnprotectedAttributes = UnprotectedAttributes_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: Attribute })\n], UnprotectedAttributes);\nexport { UnprotectedAttributes };\nexport class EnvelopedData {\n    constructor(params = {}) {\n        this.version = CMSVersion.v0;\n        this.recipientInfos = new RecipientInfos();\n        this.encryptedContentInfo = new EncryptedContentInfo();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], EnvelopedData.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: OriginatorInfo, context: 0, implicit: true, optional: true })\n], EnvelopedData.prototype, \"originatorInfo\", void 0);\n__decorate([\n    AsnProp({ type: RecipientInfos })\n], EnvelopedData.prototype, \"recipientInfos\", void 0);\n__decorate([\n    AsnProp({ type: EncryptedContentInfo })\n], EnvelopedData.prototype, \"encryptedContentInfo\", void 0);\n__decorate([\n    AsnProp({ type: UnprotectedAttributes, context: 1, implicit: true, optional: true })\n], EnvelopedData.prototype, \"unprotectedAttrs\", void 0);\n","export const id_ct_contentInfo = \"1.2.840.113549.1.9.16.1.6\";\nexport const id_data = \"1.2.840.113549.1.7.1\";\nexport const id_signedData = \"1.2.840.113549.1.7.2\";\nexport const id_envelopedData = \"1.2.840.113549.1.7.3\";\nexport const id_digestedData = \"1.2.840.113549.1.7.5\";\nexport const id_encryptedData = \"1.2.840.113549.1.7.6\";\nexport const id_authData = \"1.2.840.113549.1.9.16.1.2\";\n","var DigestAlgorithmIdentifiers_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { CertificateSet } from \"./certificate_choices\";\nimport { CMSVersion, DigestAlgorithmIdentifier } from \"./types\";\nimport { EncapsulatedContentInfo } from \"./encapsulated_content_info\";\nimport { RevocationInfoChoices } from \"./revocation_info_choice\";\nimport { SignerInfos } from \"./signer_info\";\nlet DigestAlgorithmIdentifiers = DigestAlgorithmIdentifiers_1 = class DigestAlgorithmIdentifiers extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, DigestAlgorithmIdentifiers_1.prototype);\n    }\n};\nDigestAlgorithmIdentifiers = DigestAlgorithmIdentifiers_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: DigestAlgorithmIdentifier })\n], DigestAlgorithmIdentifiers);\nexport { DigestAlgorithmIdentifiers };\nexport class SignedData {\n    constructor(params = {}) {\n        this.version = CMSVersion.v0;\n        this.digestAlgorithms = new DigestAlgorithmIdentifiers();\n        this.encapContentInfo = new EncapsulatedContentInfo();\n        this.signerInfos = new SignerInfos();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], SignedData.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: DigestAlgorithmIdentifiers })\n], SignedData.prototype, \"digestAlgorithms\", void 0);\n__decorate([\n    AsnProp({ type: EncapsulatedContentInfo })\n], SignedData.prototype, \"encapContentInfo\", void 0);\n__decorate([\n    AsnProp({ type: CertificateSet, context: 0, implicit: true, optional: true })\n], SignedData.prototype, \"certificates\", void 0);\n__decorate([\n    AsnProp({ type: RevocationInfoChoices, context: 1, implicit: true, optional: true })\n], SignedData.prototype, \"crls\", void 0);\n__decorate([\n    AsnProp({ type: SignerInfos })\n], SignedData.prototype, \"signerInfos\", void 0);\n","export const id_ecPublicKey = \"1.2.840.10045.2.1\";\nexport const id_ecDH = \"1.3.132.1.12\";\nexport const id_ecMQV = \"1.3.132.1.13\";\nexport const id_ecdsaWithSHA1 = \"1.2.840.10045.4.1\";\nexport const id_ecdsaWithSHA224 = \"1.2.840.10045.4.3.1\";\nexport const id_ecdsaWithSHA256 = \"1.2.840.10045.4.3.2\";\nexport const id_ecdsaWithSHA384 = \"1.2.840.10045.4.3.3\";\nexport const id_ecdsaWithSHA512 = \"1.2.840.10045.4.3.4\";\nexport const id_secp192r1 = \"1.2.840.10045.3.1.1\";\nexport const id_sect163k1 = \"1.3.132.0.1\";\nexport const id_sect163r2 = \"1.3.132.0.15\";\nexport const id_secp224r1 = \"1.3.132.0.33\";\nexport const id_sect233k1 = \"1.3.132.0.26\";\nexport const id_sect233r1 = \"1.3.132.0.27\";\nexport const id_secp256r1 = \"1.2.840.10045.3.1.7\";\nexport const id_sect283k1 = \"1.3.132.0.16\";\nexport const id_sect283r1 = \"1.3.132.0.17\";\nexport const id_secp384r1 = \"1.3.132.0.34\";\nexport const id_sect409k1 = \"1.3.132.0.36\";\nexport const id_sect409r1 = \"1.3.132.0.37\";\nexport const id_secp521r1 = \"1.3.132.0.35\";\nexport const id_sect571k1 = \"1.3.132.0.38\";\nexport const id_sect571r1 = \"1.3.132.0.39\";\n","import { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nimport * as oid from \"./object_identifiers\";\nfunction create(algorithm) {\n    return new AlgorithmIdentifier({ algorithm });\n}\nexport const ecdsaWithSHA1 = create(oid.id_ecdsaWithSHA1);\nexport const ecdsaWithSHA224 = create(oid.id_ecdsaWithSHA224);\nexport const ecdsaWithSHA256 = create(oid.id_ecdsaWithSHA256);\nexport const ecdsaWithSHA384 = create(oid.id_ecdsaWithSHA384);\nexport const ecdsaWithSHA512 = create(oid.id_ecdsaWithSHA512);\n","import { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes, AsnProp, AsnPropTypes, OctetString, AsnIntegerArrayBufferConverter, } from \"@peculiar/asn1-schema\";\nlet FieldID = class FieldID {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], FieldID.prototype, \"fieldType\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any })\n], FieldID.prototype, \"parameters\", void 0);\nFieldID = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], FieldID);\nexport { FieldID };\nexport class ECPoint extends OctetString {\n}\nexport class FieldElement extends OctetString {\n}\nlet Curve = class Curve {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.OctetString })\n], Curve.prototype, \"a\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.OctetString })\n], Curve.prototype, \"b\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString, optional: true })\n], Curve.prototype, \"seed\", void 0);\nCurve = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], Curve);\nexport { Curve };\nexport var ECPVer;\n(function (ECPVer) {\n    ECPVer[ECPVer[\"ecpVer1\"] = 1] = \"ecpVer1\";\n})(ECPVer || (ECPVer = {}));\nlet SpecifiedECDomain = class SpecifiedECDomain {\n    constructor(params = {}) {\n        this.version = ECPVer.ecpVer1;\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], SpecifiedECDomain.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: FieldID })\n], SpecifiedECDomain.prototype, \"fieldID\", void 0);\n__decorate([\n    AsnProp({ type: Curve })\n], SpecifiedECDomain.prototype, \"curve\", void 0);\n__decorate([\n    AsnProp({ type: ECPoint })\n], SpecifiedECDomain.prototype, \"base\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], SpecifiedECDomain.prototype, \"order\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, optional: true })\n], SpecifiedECDomain.prototype, \"cofactor\", void 0);\nSpecifiedECDomain = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], SpecifiedECDomain);\nexport { SpecifiedECDomain };\n","import { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes, AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { SpecifiedECDomain } from \"./rfc3279\";\nlet ECParameters = class ECParameters {\n    constructor(params = {}) {\n        Object.assign(this, params);\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], ECParameters.prototype, \"namedCurve\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Null })\n], ECParameters.prototype, \"implicitCurve\", void 0);\n__decorate([\n    AsnProp({ type: SpecifiedECDomain })\n], ECParameters.prototype, \"specifiedCurve\", void 0);\nECParameters = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], ECParameters);\nexport { ECParameters };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { ECParameters } from \"./ec_parameters\";\nexport class ECPrivateKey {\n    constructor(params = {}) {\n        this.version = 1;\n        this.privateKey = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], ECPrivateKey.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], ECPrivateKey.prototype, \"privateKey\", void 0);\n__decorate([\n    AsnProp({ type: ECParameters, context: 0, optional: true })\n], ECPrivateKey.prototype, \"parameters\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString, context: 1, optional: true })\n], ECPrivateKey.prototype, \"publicKey\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nexport class ECDSASigValue {\n    constructor(params = {}) {\n        this.r = new ArrayBuffer(0);\n        this.s = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], ECDSASigValue.prototype, \"r\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], ECDSASigValue.prototype, \"s\", void 0);\n","export const id_pkcs_1 = \"1.2.840.113549.1.1\";\nexport const id_rsaEncryption = `${id_pkcs_1}.1`;\nexport const id_RSAES_OAEP = `${id_pkcs_1}.7`;\nexport const id_pSpecified = `${id_pkcs_1}.9`;\nexport const id_RSASSA_PSS = `${id_pkcs_1}.10`;\nexport const id_md2WithRSAEncryption = `${id_pkcs_1}.2`;\nexport const id_md5WithRSAEncryption = `${id_pkcs_1}.4`;\nexport const id_sha1WithRSAEncryption = `${id_pkcs_1}.5`;\nexport const id_sha224WithRSAEncryption = `${id_pkcs_1}.14`;\nexport const id_ssha224WithRSAEncryption = id_sha224WithRSAEncryption;\nexport const id_sha256WithRSAEncryption = `${id_pkcs_1}.11`;\nexport const id_sha384WithRSAEncryption = `${id_pkcs_1}.12`;\nexport const id_sha512WithRSAEncryption = `${id_pkcs_1}.13`;\nexport const id_sha512_224WithRSAEncryption = `${id_pkcs_1}.15`;\nexport const id_sha512_256WithRSAEncryption = `${id_pkcs_1}.16`;\nexport const id_sha1 = \"1.3.14.3.2.26\";\nexport const id_sha224 = \"2.16.840.1.101.3.4.2.4\";\nexport const id_sha256 = \"2.16.840.1.101.3.4.2.1\";\nexport const id_sha384 = \"2.16.840.1.101.3.4.2.2\";\nexport const id_sha512 = \"2.16.840.1.101.3.4.2.3\";\nexport const id_sha512_224 = \"2.16.840.1.101.3.4.2.5\";\nexport const id_sha512_256 = \"2.16.840.1.101.3.4.2.6\";\nexport const id_md2 = \"1.2.840.113549.2.2\";\nexport const id_md5 = \"1.2.840.113549.2.5\";\nexport const id_mgf1 = `${id_pkcs_1}.8`;\n","import { AsnConvert, AsnOctetStringConverter } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nimport * as oid from \"./object_identifiers\";\nfunction create(algorithm) {\n    return new AlgorithmIdentifier({ algorithm, parameters: null });\n}\nexport const md2 = create(oid.id_md2);\nexport const md4 = create(oid.id_md5);\nexport const sha1 = create(oid.id_sha1);\nexport const sha224 = create(oid.id_sha224);\nexport const sha256 = create(oid.id_sha256);\nexport const sha384 = create(oid.id_sha384);\nexport const sha512 = create(oid.id_sha512);\nexport const sha512_224 = create(oid.id_sha512_224);\nexport const sha512_256 = create(oid.id_sha512_256);\nexport const mgf1SHA1 = new AlgorithmIdentifier({\n    algorithm: oid.id_mgf1,\n    parameters: AsnConvert.serialize(sha1),\n});\nexport const pSpecifiedEmpty = new AlgorithmIdentifier({\n    algorithm: oid.id_pSpecified,\n    parameters: AsnConvert.serialize(AsnOctetStringConverter.toASN(new Uint8Array([0xda, 0x39, 0xa3, 0xee, 0x5e, 0x6b, 0x4b, 0x0d, 0x32, 0x55, 0xbf, 0xef, 0x95, 0x60, 0x18, 0x90, 0xaf, 0xd8, 0x07, 0x09]).buffer)),\n});\nexport const rsaEncryption = create(oid.id_rsaEncryption);\nexport const md2WithRSAEncryption = create(oid.id_md2WithRSAEncryption);\nexport const md5WithRSAEncryption = create(oid.id_md5WithRSAEncryption);\nexport const sha1WithRSAEncryption = create(oid.id_sha1WithRSAEncryption);\nexport const sha224WithRSAEncryption = create(oid.id_sha512_224WithRSAEncryption);\nexport const sha256WithRSAEncryption = create(oid.id_sha512_256WithRSAEncryption);\nexport const sha384WithRSAEncryption = create(oid.id_sha384WithRSAEncryption);\nexport const sha512WithRSAEncryption = create(oid.id_sha512WithRSAEncryption);\nexport const sha512_224WithRSAEncryption = create(oid.id_sha512_224WithRSAEncryption);\nexport const sha512_256WithRSAEncryption = create(oid.id_sha512_256WithRSAEncryption);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnConvert } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nimport { id_mgf1, id_RSAES_OAEP } from \"../object_identifiers\";\nimport { sha1, mgf1SHA1, pSpecifiedEmpty } from \"../algorithms\";\nexport class RsaEsOaepParams {\n    constructor(params = {}) {\n        this.hashAlgorithm = new AlgorithmIdentifier(sha1);\n        this.maskGenAlgorithm = new AlgorithmIdentifier({\n            algorithm: id_mgf1,\n            parameters: AsnConvert.serialize(sha1),\n        });\n        this.pSourceAlgorithm = new AlgorithmIdentifier(pSpecifiedEmpty);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier, context: 0, defaultValue: sha1 })\n], RsaEsOaepParams.prototype, \"hashAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier, context: 1, defaultValue: mgf1SHA1 })\n], RsaEsOaepParams.prototype, \"maskGenAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier, context: 2, defaultValue: pSpecifiedEmpty })\n], RsaEsOaepParams.prototype, \"pSourceAlgorithm\", void 0);\nexport const RSAES_OAEP = new AlgorithmIdentifier({\n    algorithm: id_RSAES_OAEP,\n    parameters: AsnConvert.serialize(new RsaEsOaepParams()),\n});\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnConvert, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nimport { id_mgf1, id_RSASSA_PSS } from \"../object_identifiers\";\nimport { sha1, mgf1SHA1 } from \"../algorithms\";\nexport class RsaSaPssParams {\n    constructor(params = {}) {\n        this.hashAlgorithm = new AlgorithmIdentifier(sha1);\n        this.maskGenAlgorithm = new AlgorithmIdentifier({\n            algorithm: id_mgf1,\n            parameters: AsnConvert.serialize(sha1),\n        });\n        this.saltLength = 20;\n        this.trailerField = 1;\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier, context: 0, defaultValue: sha1 })\n], RsaSaPssParams.prototype, \"hashAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier, context: 1, defaultValue: mgf1SHA1 })\n], RsaSaPssParams.prototype, \"maskGenAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, context: 2, defaultValue: 20 })\n], RsaSaPssParams.prototype, \"saltLength\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, context: 3, defaultValue: 1 })\n], RsaSaPssParams.prototype, \"trailerField\", void 0);\nexport const RSASSA_PSS = new AlgorithmIdentifier({\n    algorithm: id_RSASSA_PSS,\n    parameters: AsnConvert.serialize(new RsaSaPssParams()),\n});\n","import { __decorate } from \"tslib\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nimport { AsnProp, OctetString } from \"@peculiar/asn1-schema\";\nexport class DigestInfo {\n    constructor(params = {}) {\n        this.digestAlgorithm = new AlgorithmIdentifier();\n        this.digest = new OctetString();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], DigestInfo.prototype, \"digestAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], DigestInfo.prototype, \"digest\", void 0);\n","var OtherPrimeInfos_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter, AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nexport class OtherPrimeInfo {\n    constructor(params = {}) {\n        this.prime = new ArrayBuffer(0);\n        this.exponent = new ArrayBuffer(0);\n        this.coefficient = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], OtherPrimeInfo.prototype, \"prime\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], OtherPrimeInfo.prototype, \"exponent\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], OtherPrimeInfo.prototype, \"coefficient\", void 0);\nlet OtherPrimeInfos = OtherPrimeInfos_1 = class OtherPrimeInfos extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, OtherPrimeInfos_1.prototype);\n    }\n};\nOtherPrimeInfos = OtherPrimeInfos_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: OtherPrimeInfo })\n], OtherPrimeInfos);\nexport { OtherPrimeInfos };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nimport { OtherPrimeInfos } from \"./other_prime_info\";\nexport class RSAPrivateKey {\n    constructor(params = {}) {\n        this.version = 0;\n        this.modulus = new ArrayBuffer(0);\n        this.publicExponent = new ArrayBuffer(0);\n        this.privateExponent = new ArrayBuffer(0);\n        this.prime1 = new ArrayBuffer(0);\n        this.prime2 = new ArrayBuffer(0);\n        this.exponent1 = new ArrayBuffer(0);\n        this.exponent2 = new ArrayBuffer(0);\n        this.coefficient = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], RSAPrivateKey.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"modulus\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"publicExponent\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"privateExponent\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"prime1\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"prime2\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"exponent1\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"exponent2\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPrivateKey.prototype, \"coefficient\", void 0);\n__decorate([\n    AsnProp({ type: OtherPrimeInfos, optional: true })\n], RSAPrivateKey.prototype, \"otherPrimeInfos\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnIntegerArrayBufferConverter } from \"@peculiar/asn1-schema\";\nexport class RSAPublicKey {\n    constructor(params = {}) {\n        this.modulus = new ArrayBuffer(0);\n        this.publicExponent = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPublicKey.prototype, \"modulus\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, converter: AsnIntegerArrayBufferConverter })\n], RSAPublicKey.prototype, \"publicExponent\", void 0);\n","var Lifecycle;\n(function (Lifecycle) {\n    Lifecycle[Lifecycle[\"Transient\"] = 0] = \"Transient\";\n    Lifecycle[Lifecycle[\"Singleton\"] = 1] = \"Singleton\";\n    Lifecycle[Lifecycle[\"ResolutionScoped\"] = 2] = \"ResolutionScoped\";\n    Lifecycle[Lifecycle[\"ContainerScoped\"] = 3] = \"ContainerScoped\";\n})(Lifecycle || (Lifecycle = {}));\nexport default Lifecycle;\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __createBinding(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (p !== \"default\" && !exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","export function isClassProvider(provider) {\n    return !!provider.useClass;\n}\n","export function isFactoryProvider(provider) {\n    return !!provider.useFactory;\n}\n","import { __read, __spread } from \"tslib\";\nvar DelayedConstructor = (function () {\n    function DelayedConstructor(wrap) {\n        this.wrap = wrap;\n        this.reflectMethods = [\n            \"get\",\n            \"getPrototypeOf\",\n            \"setPrototypeOf\",\n            \"getOwnPropertyDescriptor\",\n            \"defineProperty\",\n            \"has\",\n            \"set\",\n            \"deleteProperty\",\n            \"apply\",\n            \"construct\",\n            \"ownKeys\"\n        ];\n    }\n    DelayedConstructor.prototype.createProxy = function (createObject) {\n        var _this = this;\n        var target = {};\n        var init = false;\n        var value;\n        var delayedObject = function () {\n            if (!init) {\n                value = createObject(_this.wrap());\n                init = true;\n            }\n            return value;\n        };\n        return new Proxy(target, this.createHandler(delayedObject));\n    };\n    DelayedConstructor.prototype.createHandler = function (delayedObject) {\n        var handler = {};\n        var install = function (name) {\n            handler[name] = function () {\n                var args = [];\n                for (var _i = 0; _i < arguments.length; _i++) {\n                    args[_i] = arguments[_i];\n                }\n                args[0] = delayedObject();\n                var method = Reflect[name];\n                return method.apply(void 0, __spread(args));\n            };\n        };\n        this.reflectMethods.forEach(install);\n        return handler;\n    };\n    return DelayedConstructor;\n}());\nexport { DelayedConstructor };\nexport function delay(wrappedConstructor) {\n    if (typeof wrappedConstructor === \"undefined\") {\n        throw new Error(\"Attempt to `delay` undefined. Constructor must be wrapped in a callback\");\n    }\n    return new DelayedConstructor(wrappedConstructor);\n}\n","import { DelayedConstructor } from \"../lazy-helpers\";\nexport function isNormalToken(token) {\n    return typeof token === \"string\" || typeof token === \"symbol\";\n}\nexport function isTokenDescriptor(descriptor) {\n    return (typeof descriptor === \"object\" &&\n        \"token\" in descriptor &&\n        \"multiple\" in descriptor);\n}\nexport function isTransformDescriptor(descriptor) {\n    return (typeof descriptor === \"object\" &&\n        \"token\" in descriptor &&\n        \"transform\" in descriptor);\n}\nexport function isConstructorToken(token) {\n    return typeof token === \"function\" || token instanceof DelayedConstructor;\n}\n","export function isTokenProvider(provider) {\n    return !!provider.useToken;\n}\n","export function isValueProvider(provider) {\n    return provider.useValue != undefined;\n}\n","var RegistryBase = (function () {\n    function RegistryBase() {\n        this._registryMap = new Map();\n    }\n    RegistryBase.prototype.entries = function () {\n        return this._registryMap.entries();\n    };\n    RegistryBase.prototype.getAll = function (key) {\n        this.ensure(key);\n        return this._registryMap.get(key);\n    };\n    RegistryBase.prototype.get = function (key) {\n        this.ensure(key);\n        var value = this._registryMap.get(key);\n        return value[value.length - 1] || null;\n    };\n    RegistryBase.prototype.set = function (key, value) {\n        this.ensure(key);\n        this._registryMap.get(key).push(value);\n    };\n    RegistryBase.prototype.setAll = function (key, value) {\n        this._registryMap.set(key, value);\n    };\n    RegistryBase.prototype.has = function (key) {\n        this.ensure(key);\n        return this._registryMap.get(key).length > 0;\n    };\n    RegistryBase.prototype.clear = function () {\n        this._registryMap.clear();\n    };\n    RegistryBase.prototype.ensure = function (key) {\n        if (!this._registryMap.has(key)) {\n            this._registryMap.set(key, []);\n        }\n    };\n    return RegistryBase;\n}());\nexport default RegistryBase;\n","import { __extends } from \"tslib\";\nimport RegistryBase from \"./registry-base\";\nvar Registry = (function (_super) {\n    __extends(Registry, _super);\n    function Registry() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return Registry;\n}(RegistryBase));\nexport default Registry;\n","var ResolutionContext = (function () {\n    function ResolutionContext() {\n        this.scopedResolutions = new Map();\n    }\n    return ResolutionContext;\n}());\nexport default ResolutionContext;\n","import { __read, __spread } from \"tslib\";\nfunction formatDependency(params, idx) {\n    if (params === null) {\n        return \"at position #\" + idx;\n    }\n    var argName = params.split(\",\")[idx].trim();\n    return \"\\\"\" + argName + \"\\\" at position #\" + idx;\n}\nfunction composeErrorMessage(msg, e, indent) {\n    if (indent === void 0) { indent = \"    \"; }\n    return __spread([msg], e.message.split(\"\\n\").map(function (l) { return indent + l; })).join(\"\\n\");\n}\nexport function formatErrorCtor(ctor, paramIdx, error) {\n    var _a = __read(ctor.toString().match(/constructor\\(([\\w, ]+)\\)/) || [], 2), _b = _a[1], params = _b === void 0 ? null : _b;\n    var dep = formatDependency(params, paramIdx);\n    return composeErrorMessage(\"Cannot inject the dependency \" + dep + \" of \\\"\" + ctor.name + \"\\\" constructor. Reason:\", error);\n}\n","import { __extends } from \"tslib\";\nimport RegistryBase from \"./registry-base\";\nvar PreResolutionInterceptors = (function (_super) {\n    __extends(PreResolutionInterceptors, _super);\n    function PreResolutionInterceptors() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return PreResolutionInterceptors;\n}(RegistryBase));\nexport { PreResolutionInterceptors };\nvar PostResolutionInterceptors = (function (_super) {\n    __extends(PostResolutionInterceptors, _super);\n    function PostResolutionInterceptors() {\n        return _super !== null && _super.apply(this, arguments) || this;\n    }\n    return PostResolutionInterceptors;\n}(RegistryBase));\nexport { PostResolutionInterceptors };\nvar Interceptors = (function () {\n    function Interceptors() {\n        this.preResolution = new PreResolutionInterceptors();\n        this.postResolution = new PostResolutionInterceptors();\n    }\n    return Interceptors;\n}());\nexport default Interceptors;\n","import { __awaiter, __generator, __read, __spread, __values } from \"tslib\";\nimport { isClassProvider, isFactoryProvider, isNormalToken, isTokenProvider, isValueProvider } from \"./providers\";\nimport { isProvider } from \"./providers/provider\";\nimport { isConstructorToken, isTokenDescriptor, isTransformDescriptor } from \"./providers/injection-token\";\nimport Registry from \"./registry\";\nimport Lifecycle from \"./types/lifecycle\";\nimport ResolutionContext from \"./resolution-context\";\nimport { formatErrorCtor } from \"./error-helpers\";\nimport { DelayedConstructor } from \"./lazy-helpers\";\nimport { isDisposable } from \"./types/disposable\";\nimport Interceptors from \"./interceptors\";\nexport var typeInfo = new Map();\nvar InternalDependencyContainer = (function () {\n    function InternalDependencyContainer(parent) {\n        this.parent = parent;\n        this._registry = new Registry();\n        this.interceptors = new Interceptors();\n        this.disposed = false;\n        this.disposables = new Set();\n    }\n    InternalDependencyContainer.prototype.register = function (token, providerOrConstructor, options) {\n        if (options === void 0) { options = { lifecycle: Lifecycle.Transient }; }\n        this.ensureNotDisposed();\n        var provider;\n        if (!isProvider(providerOrConstructor)) {\n            provider = { useClass: providerOrConstructor };\n        }\n        else {\n            provider = providerOrConstructor;\n        }\n        if (isTokenProvider(provider)) {\n            var path = [token];\n            var tokenProvider = provider;\n            while (tokenProvider != null) {\n                var currentToken = tokenProvider.useToken;\n                if (path.includes(currentToken)) {\n                    throw new Error(\"Token registration cycle detected! \" + __spread(path, [currentToken]).join(\" -> \"));\n                }\n                path.push(currentToken);\n                var registration = this._registry.get(currentToken);\n                if (registration && isTokenProvider(registration.provider)) {\n                    tokenProvider = registration.provider;\n                }\n                else {\n                    tokenProvider = null;\n                }\n            }\n        }\n        if (options.lifecycle === Lifecycle.Singleton ||\n            options.lifecycle == Lifecycle.ContainerScoped ||\n            options.lifecycle == Lifecycle.ResolutionScoped) {\n            if (isValueProvider(provider) || isFactoryProvider(provider)) {\n                throw new Error(\"Cannot use lifecycle \\\"\" + Lifecycle[options.lifecycle] + \"\\\" with ValueProviders or FactoryProviders\");\n            }\n        }\n        this._registry.set(token, { provider: provider, options: options });\n        return this;\n    };\n    InternalDependencyContainer.prototype.registerType = function (from, to) {\n        this.ensureNotDisposed();\n        if (isNormalToken(to)) {\n            return this.register(from, {\n                useToken: to\n            });\n        }\n        return this.register(from, {\n            useClass: to\n        });\n    };\n    InternalDependencyContainer.prototype.registerInstance = function (token, instance) {\n        this.ensureNotDisposed();\n        return this.register(token, {\n            useValue: instance\n        });\n    };\n    InternalDependencyContainer.prototype.registerSingleton = function (from, to) {\n        this.ensureNotDisposed();\n        if (isNormalToken(from)) {\n            if (isNormalToken(to)) {\n                return this.register(from, {\n                    useToken: to\n                }, { lifecycle: Lifecycle.Singleton });\n            }\n            else if (to) {\n                return this.register(from, {\n                    useClass: to\n                }, { lifecycle: Lifecycle.Singleton });\n            }\n            throw new Error('Cannot register a type name as a singleton without a \"to\" token');\n        }\n        var useClass = from;\n        if (to && !isNormalToken(to)) {\n            useClass = to;\n        }\n        return this.register(from, {\n            useClass: useClass\n        }, { lifecycle: Lifecycle.Singleton });\n    };\n    InternalDependencyContainer.prototype.resolve = function (token, context) {\n        if (context === void 0) { context = new ResolutionContext(); }\n        this.ensureNotDisposed();\n        var registration = this.getRegistration(token);\n        if (!registration && isNormalToken(token)) {\n            throw new Error(\"Attempted to resolve unregistered dependency token: \\\"\" + token.toString() + \"\\\"\");\n        }\n        this.executePreResolutionInterceptor(token, \"Single\");\n        if (registration) {\n            var result = this.resolveRegistration(registration, context);\n            this.executePostResolutionInterceptor(token, result, \"Single\");\n            return result;\n        }\n        if (isConstructorToken(token)) {\n            var result = this.construct(token, context);\n            this.executePostResolutionInterceptor(token, result, \"Single\");\n            return result;\n        }\n        throw new Error(\"Attempted to construct an undefined constructor. Could mean a circular dependency problem. Try using `delay` function.\");\n    };\n    InternalDependencyContainer.prototype.executePreResolutionInterceptor = function (token, resolutionType) {\n        var e_1, _a;\n        if (this.interceptors.preResolution.has(token)) {\n            var remainingInterceptors = [];\n            try {\n                for (var _b = __values(this.interceptors.preResolution.getAll(token)), _c = _b.next(); !_c.done; _c = _b.next()) {\n                    var interceptor = _c.value;\n                    if (interceptor.options.frequency != \"Once\") {\n                        remainingInterceptors.push(interceptor);\n                    }\n                    interceptor.callback(token, resolutionType);\n                }\n            }\n            catch (e_1_1) { e_1 = { error: e_1_1 }; }\n            finally {\n                try {\n                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                }\n                finally { if (e_1) throw e_1.error; }\n            }\n            this.interceptors.preResolution.setAll(token, remainingInterceptors);\n        }\n    };\n    InternalDependencyContainer.prototype.executePostResolutionInterceptor = function (token, result, resolutionType) {\n        var e_2, _a;\n        if (this.interceptors.postResolution.has(token)) {\n            var remainingInterceptors = [];\n            try {\n                for (var _b = __values(this.interceptors.postResolution.getAll(token)), _c = _b.next(); !_c.done; _c = _b.next()) {\n                    var interceptor = _c.value;\n                    if (interceptor.options.frequency != \"Once\") {\n                        remainingInterceptors.push(interceptor);\n                    }\n                    interceptor.callback(token, result, resolutionType);\n                }\n            }\n            catch (e_2_1) { e_2 = { error: e_2_1 }; }\n            finally {\n                try {\n                    if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n                }\n                finally { if (e_2) throw e_2.error; }\n            }\n            this.interceptors.postResolution.setAll(token, remainingInterceptors);\n        }\n    };\n    InternalDependencyContainer.prototype.resolveRegistration = function (registration, context) {\n        this.ensureNotDisposed();\n        if (registration.options.lifecycle === Lifecycle.ResolutionScoped &&\n            context.scopedResolutions.has(registration)) {\n            return context.scopedResolutions.get(registration);\n        }\n        var isSingleton = registration.options.lifecycle === Lifecycle.Singleton;\n        var isContainerScoped = registration.options.lifecycle === Lifecycle.ContainerScoped;\n        var returnInstance = isSingleton || isContainerScoped;\n        var resolved;\n        if (isValueProvider(registration.provider)) {\n            resolved = registration.provider.useValue;\n        }\n        else if (isTokenProvider(registration.provider)) {\n            resolved = returnInstance\n                ? registration.instance ||\n                    (registration.instance = this.resolve(registration.provider.useToken, context))\n                : this.resolve(registration.provider.useToken, context);\n        }\n        else if (isClassProvider(registration.provider)) {\n            resolved = returnInstance\n                ? registration.instance ||\n                    (registration.instance = this.construct(registration.provider.useClass, context))\n                : this.construct(registration.provider.useClass, context);\n        }\n        else if (isFactoryProvider(registration.provider)) {\n            resolved = registration.provider.useFactory(this);\n        }\n        else {\n            resolved = this.construct(registration.provider, context);\n        }\n        if (registration.options.lifecycle === Lifecycle.ResolutionScoped) {\n            context.scopedResolutions.set(registration, resolved);\n        }\n        return resolved;\n    };\n    InternalDependencyContainer.prototype.resolveAll = function (token, context) {\n        var _this = this;\n        if (context === void 0) { context = new ResolutionContext(); }\n        this.ensureNotDisposed();\n        var registrations = this.getAllRegistrations(token);\n        if (!registrations && isNormalToken(token)) {\n            throw new Error(\"Attempted to resolve unregistered dependency token: \\\"\" + token.toString() + \"\\\"\");\n        }\n        this.executePreResolutionInterceptor(token, \"All\");\n        if (registrations) {\n            var result_1 = registrations.map(function (item) {\n                return _this.resolveRegistration(item, context);\n            });\n            this.executePostResolutionInterceptor(token, result_1, \"All\");\n            return result_1;\n        }\n        var result = [this.construct(token, context)];\n        this.executePostResolutionInterceptor(token, result, \"All\");\n        return result;\n    };\n    InternalDependencyContainer.prototype.isRegistered = function (token, recursive) {\n        if (recursive === void 0) { recursive = false; }\n        this.ensureNotDisposed();\n        return (this._registry.has(token) ||\n            (recursive &&\n                (this.parent || false) &&\n                this.parent.isRegistered(token, true)));\n    };\n    InternalDependencyContainer.prototype.reset = function () {\n        this.ensureNotDisposed();\n        this._registry.clear();\n        this.interceptors.preResolution.clear();\n        this.interceptors.postResolution.clear();\n    };\n    InternalDependencyContainer.prototype.clearInstances = function () {\n        var e_3, _a;\n        this.ensureNotDisposed();\n        try {\n            for (var _b = __values(this._registry.entries()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var _d = __read(_c.value, 2), token = _d[0], registrations = _d[1];\n                this._registry.setAll(token, registrations\n                    .filter(function (registration) { return !isValueProvider(registration.provider); })\n                    .map(function (registration) {\n                    registration.instance = undefined;\n                    return registration;\n                }));\n            }\n        }\n        catch (e_3_1) { e_3 = { error: e_3_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_3) throw e_3.error; }\n        }\n    };\n    InternalDependencyContainer.prototype.createChildContainer = function () {\n        var e_4, _a;\n        this.ensureNotDisposed();\n        var childContainer = new InternalDependencyContainer(this);\n        try {\n            for (var _b = __values(this._registry.entries()), _c = _b.next(); !_c.done; _c = _b.next()) {\n                var _d = __read(_c.value, 2), token = _d[0], registrations = _d[1];\n                if (registrations.some(function (_a) {\n                    var options = _a.options;\n                    return options.lifecycle === Lifecycle.ContainerScoped;\n                })) {\n                    childContainer._registry.setAll(token, registrations.map(function (registration) {\n                        if (registration.options.lifecycle === Lifecycle.ContainerScoped) {\n                            return {\n                                provider: registration.provider,\n                                options: registration.options\n                            };\n                        }\n                        return registration;\n                    }));\n                }\n            }\n        }\n        catch (e_4_1) { e_4 = { error: e_4_1 }; }\n        finally {\n            try {\n                if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n            }\n            finally { if (e_4) throw e_4.error; }\n        }\n        return childContainer;\n    };\n    InternalDependencyContainer.prototype.beforeResolution = function (token, callback, options) {\n        if (options === void 0) { options = { frequency: \"Always\" }; }\n        this.interceptors.preResolution.set(token, {\n            callback: callback,\n            options: options\n        });\n    };\n    InternalDependencyContainer.prototype.afterResolution = function (token, callback, options) {\n        if (options === void 0) { options = { frequency: \"Always\" }; }\n        this.interceptors.postResolution.set(token, {\n            callback: callback,\n            options: options\n        });\n    };\n    InternalDependencyContainer.prototype.dispose = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var promises;\n            return __generator(this, function (_a) {\n                switch (_a.label) {\n                    case 0:\n                        this.disposed = true;\n                        promises = [];\n                        this.disposables.forEach(function (disposable) {\n                            var maybePromise = disposable.dispose();\n                            if (maybePromise) {\n                                promises.push(maybePromise);\n                            }\n                        });\n                        return [4, Promise.all(promises)];\n                    case 1:\n                        _a.sent();\n                        return [2];\n                }\n            });\n        });\n    };\n    InternalDependencyContainer.prototype.getRegistration = function (token) {\n        if (this.isRegistered(token)) {\n            return this._registry.get(token);\n        }\n        if (this.parent) {\n            return this.parent.getRegistration(token);\n        }\n        return null;\n    };\n    InternalDependencyContainer.prototype.getAllRegistrations = function (token) {\n        if (this.isRegistered(token)) {\n            return this._registry.getAll(token);\n        }\n        if (this.parent) {\n            return this.parent.getAllRegistrations(token);\n        }\n        return null;\n    };\n    InternalDependencyContainer.prototype.construct = function (ctor, context) {\n        var _this = this;\n        if (ctor instanceof DelayedConstructor) {\n            return ctor.createProxy(function (target) {\n                return _this.resolve(target, context);\n            });\n        }\n        var instance = (function () {\n            var paramInfo = typeInfo.get(ctor);\n            if (!paramInfo || paramInfo.length === 0) {\n                if (ctor.length === 0) {\n                    return new ctor();\n                }\n                else {\n                    throw new Error(\"TypeInfo not known for \\\"\" + ctor.name + \"\\\"\");\n                }\n            }\n            var params = paramInfo.map(_this.resolveParams(context, ctor));\n            return new (ctor.bind.apply(ctor, __spread([void 0], params)))();\n        })();\n        if (isDisposable(instance)) {\n            this.disposables.add(instance);\n        }\n        return instance;\n    };\n    InternalDependencyContainer.prototype.resolveParams = function (context, ctor) {\n        var _this = this;\n        return function (param, idx) {\n            var _a, _b, _c;\n            try {\n                if (isTokenDescriptor(param)) {\n                    if (isTransformDescriptor(param)) {\n                        return param.multiple\n                            ? (_a = _this.resolve(param.transform)).transform.apply(_a, __spread([_this.resolveAll(param.token)], param.transformArgs)) : (_b = _this.resolve(param.transform)).transform.apply(_b, __spread([_this.resolve(param.token, context)], param.transformArgs));\n                    }\n                    else {\n                        return param.multiple\n                            ? _this.resolveAll(param.token)\n                            : _this.resolve(param.token, context);\n                    }\n                }\n                else if (isTransformDescriptor(param)) {\n                    return (_c = _this.resolve(param.transform, context)).transform.apply(_c, __spread([_this.resolve(param.token, context)], param.transformArgs));\n                }\n                return _this.resolve(param, context);\n            }\n            catch (e) {\n                throw new Error(formatErrorCtor(ctor, idx, e));\n            }\n        };\n    };\n    InternalDependencyContainer.prototype.ensureNotDisposed = function () {\n        if (this.disposed) {\n            throw new Error(\"This container has been disposed, you cannot interact with a disposed container\");\n        }\n    };\n    return InternalDependencyContainer;\n}());\nexport var instance = new InternalDependencyContainer();\nexport default instance;\n","import { isClassProvider } from \"./class-provider\";\nimport { isValueProvider } from \"./value-provider\";\nimport { isTokenProvider } from \"./token-provider\";\nimport { isFactoryProvider } from \"./factory-provider\";\nexport function isProvider(provider) {\n    return (isClassProvider(provider) ||\n        isValueProvider(provider) ||\n        isTokenProvider(provider) ||\n        isFactoryProvider(provider));\n}\n","export function isDisposable(value) {\n    if (typeof value.dispose !== \"function\")\n        return false;\n    var disposeFun = value.dispose;\n    if (disposeFun.length > 0) {\n        return false;\n    }\n    return true;\n}\n","export var INJECTION_TOKEN_METADATA_KEY = \"injectionTokens\";\nexport function getParamInfo(target) {\n    var params = Reflect.getMetadata(\"design:paramtypes\", target) || [];\n    var injectionTokens = Reflect.getOwnMetadata(INJECTION_TOKEN_METADATA_KEY, target) || {};\n    Object.keys(injectionTokens).forEach(function (key) {\n        params[+key] = injectionTokens[key];\n    });\n    return params;\n}\nexport function defineInjectionTokenMetadata(data, transform) {\n    return function (target, _propertyKey, parameterIndex) {\n        var descriptors = Reflect.getOwnMetadata(INJECTION_TOKEN_METADATA_KEY, target) || {};\n        descriptors[parameterIndex] = transform\n            ? {\n                token: data,\n                transform: transform.transformToken,\n                transformArgs: transform.args || []\n            }\n            : data;\n        Reflect.defineMetadata(INJECTION_TOKEN_METADATA_KEY, descriptors, target);\n    };\n}\n","import { getParamInfo } from \"../reflection-helpers\";\nimport { typeInfo } from \"../dependency-container\";\nfunction injectable() {\n    return function (target) {\n        typeInfo.set(target, getParamInfo(target));\n    };\n}\nexport default injectable;\n","if (typeof Reflect === \"undefined\" || !Reflect.getMetadata) {\n    throw new Error(\"tsyringe requires a reflect polyfill. Please add 'import \\\"reflect-metadata\\\"' to the top of your entry point.\");\n}\nexport { Lifecycle } from \"./types\";\nexport * from \"./decorators\";\nexport * from \"./factories\";\nexport * from \"./providers\";\nexport { delay } from \"./lazy-helpers\";\nexport { instance as container } from \"./dependency-container\";\n","var PKCS12AttrSet_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nexport class PKCS12Attribute {\n    constructor(params = {}) {\n        this.attrId = \"\";\n        this.attrValues = [];\n        Object.assign(params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], PKCS12Attribute.prototype, \"attrId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, repeated: \"set\" })\n], PKCS12Attribute.prototype, \"attrValues\", void 0);\nlet PKCS12AttrSet = PKCS12AttrSet_1 = class PKCS12AttrSet extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, PKCS12AttrSet_1.prototype);\n    }\n};\nPKCS12AttrSet = PKCS12AttrSet_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: PKCS12Attribute })\n], PKCS12AttrSet);\nexport { PKCS12AttrSet };\n","var AuthenticatedSafe_1;\nimport { __decorate } from \"tslib\";\nimport { AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { ContentInfo } from \"@peculiar/asn1-cms\";\nlet AuthenticatedSafe = AuthenticatedSafe_1 = class AuthenticatedSafe extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, AuthenticatedSafe_1.prototype);\n    }\n};\nAuthenticatedSafe = AuthenticatedSafe_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: ContentInfo })\n], AuthenticatedSafe);\nexport { AuthenticatedSafe };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { id_pkcs_9 } from \"./types\";\nexport class CertBag {\n    constructor(params = {}) {\n        this.certId = \"\";\n        this.certValue = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], CertBag.prototype, \"certId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, context: 0 })\n], CertBag.prototype, \"certValue\", void 0);\nexport const id_certTypes = `${id_pkcs_9}.22`;\nexport const id_x509Certificate = `${id_certTypes}.1`;\nexport const id_sdsiCertificate = `${id_certTypes}.2`;\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { id_pkcs_9 } from \"./types\";\nexport class CRLBag {\n    constructor(params = {}) {\n        this.crlId = \"\";\n        this.crltValue = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], CRLBag.prototype, \"crlId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, context: 0 })\n], CRLBag.prototype, \"crltValue\", void 0);\nexport const id_crlTypes = `${id_pkcs_9}.23`;\nexport const id_x509CRL = `${id_crlTypes}.1`;\n","import { __decorate } from \"tslib\";\nimport { AsnProp, OctetString } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nexport class EncryptedData extends OctetString {\n}\nexport class EncryptedPrivateKeyInfo {\n    constructor(params = {}) {\n        this.encryptionAlgorithm = new AlgorithmIdentifier();\n        this.encryptedData = new EncryptedData();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], EncryptedPrivateKeyInfo.prototype, \"encryptionAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: EncryptedData })\n], EncryptedPrivateKeyInfo.prototype, \"encryptedData\", void 0);\n","var Attributes_1;\nimport { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes, AsnArray, AsnType, AsnTypeTypes, OctetString } from \"@peculiar/asn1-schema\";\nimport { AlgorithmIdentifier, Attribute } from \"@peculiar/asn1-x509\";\nexport var Version;\n(function (Version) {\n    Version[Version[\"v1\"] = 0] = \"v1\";\n})(Version || (Version = {}));\nexport class PrivateKey extends OctetString {\n}\nlet Attributes = Attributes_1 = class Attributes extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, Attributes_1.prototype);\n    }\n};\nAttributes = Attributes_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: Attribute })\n], Attributes);\nexport { Attributes };\nexport class PrivateKeyInfo {\n    constructor(params = {}) {\n        this.version = Version.v1;\n        this.privateKeyAlgorithm = new AlgorithmIdentifier();\n        this.privateKey = new PrivateKey();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], PrivateKeyInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], PrivateKeyInfo.prototype, \"privateKeyAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: PrivateKey })\n], PrivateKeyInfo.prototype, \"privateKey\", void 0);\n__decorate([\n    AsnProp({ type: Attributes, implicit: true, context: 0, optional: true })\n], PrivateKeyInfo.prototype, \"attributes\", void 0);\n","import { __decorate } from \"tslib\";\nimport { PrivateKeyInfo } from \"@peculiar/asn1-pkcs8\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nlet KeyBag = class KeyBag extends PrivateKeyInfo {\n};\nKeyBag = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], KeyBag);\nexport { KeyBag };\n","import { __decorate } from \"tslib\";\nimport { EncryptedPrivateKeyInfo } from \"@peculiar/asn1-pkcs8\";\nimport { AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nlet PKCS8ShroudedKeyBag = class PKCS8ShroudedKeyBag extends EncryptedPrivateKeyInfo {\n};\nPKCS8ShroudedKeyBag = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], PKCS8ShroudedKeyBag);\nexport { PKCS8ShroudedKeyBag };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nexport class SecretBag {\n    constructor(params = {}) {\n        this.secretTypeId = \"\";\n        this.secretValue = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], SecretBag.prototype, \"secretTypeId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, context: 0 })\n], SecretBag.prototype, \"secretValue\", void 0);\n","import { __decorate } from \"tslib\";\nimport { DigestInfo } from \"@peculiar/asn1-rsa\";\nimport { AsnProp, AsnPropTypes, OctetString } from \"@peculiar/asn1-schema\";\nexport class MacData {\n    constructor(params = {}) {\n        this.mac = new DigestInfo();\n        this.macSalt = new OctetString();\n        this.iterations = 1;\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: DigestInfo })\n], MacData.prototype, \"mac\", void 0);\n__decorate([\n    AsnProp({ type: OctetString })\n], MacData.prototype, \"macSalt\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer, defaultValue: 1 })\n], MacData.prototype, \"iterations\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { ContentInfo } from \"@peculiar/asn1-cms\";\nimport { MacData } from \"./mac_data\";\nexport class PFX {\n    constructor(params = {}) {\n        this.version = 3;\n        this.authSafe = new ContentInfo();\n        this.macData = new MacData();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], PFX.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: ContentInfo })\n], PFX.prototype, \"authSafe\", void 0);\n__decorate([\n    AsnProp({ type: MacData, optional: true })\n], PFX.prototype, \"macData\", void 0);\n","var SafeContents_1;\nimport { __decorate } from \"tslib\";\nimport { AsnArray, AsnType, AsnTypeTypes, AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { PKCS12Attribute } from \"./attribute\";\nexport class SafeBag {\n    constructor(params = {}) {\n        this.bagId = \"\";\n        this.bagValue = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], SafeBag.prototype, \"bagId\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.Any, context: 0 })\n], SafeBag.prototype, \"bagValue\", void 0);\n__decorate([\n    AsnProp({ type: PKCS12Attribute, repeated: \"set\", optional: true })\n], SafeBag.prototype, \"bagAttributes\", void 0);\nlet SafeContents = SafeContents_1 = class SafeContents extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, SafeContents_1.prototype);\n    }\n};\nSafeContents = SafeContents_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: SafeBag })\n], SafeContents);\nexport { SafeContents };\n","var ExtensionRequest_1, ExtendedCertificateAttributes_1, SMIMECapabilities_1;\nimport { __decorate } from \"tslib\";\nimport { AsnType, AsnTypeTypes, AsnPropTypes, AsnProp, OctetString, AsnArray } from \"@peculiar/asn1-schema\";\nimport * as cms from \"@peculiar/asn1-cms\";\nimport * as pfx from \"@peculiar/asn1-pfx\";\nimport * as pkcs8 from \"@peculiar/asn1-pkcs8\";\nimport * as x509 from \"@peculiar/asn1-x509\";\nimport * as attr from \"@peculiar/asn1-x509-attr\";\nexport const id_pkcs9 = \"1.2.840.113549.1.9\";\nexport const id_pkcs9_mo = `${id_pkcs9}.0`;\nexport const id_pkcs9_oc = `${id_pkcs9}.24`;\nexport const id_pkcs9_at = `${id_pkcs9}.25`;\nexport const id_pkcs9_sx = `${id_pkcs9}.26`;\nexport const id_pkcs9_mr = `${id_pkcs9}.27`;\nexport const id_pkcs9_oc_pkcsEntity = `${id_pkcs9_oc}.1`;\nexport const id_pkcs9_oc_naturalPerson = `${id_pkcs9_oc}.2`;\nexport const id_pkcs9_at_emailAddress = `${id_pkcs9}.1`;\nexport const id_pkcs9_at_unstructuredName = `${id_pkcs9}.2`;\nexport const id_pkcs9_at_contentType = `${id_pkcs9}.3`;\nexport const id_pkcs9_at_messageDigest = `${id_pkcs9}.4`;\nexport const id_pkcs9_at_signingTime = `${id_pkcs9}.5`;\nexport const id_pkcs9_at_counterSignature = `${id_pkcs9}.6`;\nexport const id_pkcs9_at_challengePassword = `${id_pkcs9}.7`;\nexport const id_pkcs9_at_unstructuredAddress = `${id_pkcs9}.8`;\nexport const id_pkcs9_at_extendedCertificateAttributes = `${id_pkcs9}.9`;\nexport const id_pkcs9_at_signingDescription = `${id_pkcs9}.13`;\nexport const id_pkcs9_at_extensionRequest = `${id_pkcs9}.14`;\nexport const id_pkcs9_at_smimeCapabilities = `${id_pkcs9}.15`;\nexport const id_pkcs9_at_friendlyName = `${id_pkcs9}.20`;\nexport const id_pkcs9_at_localKeyId = `${id_pkcs9}.21`;\nexport const id_pkcs9_at_userPKCS12 = `2.16.840.1.113730.3.1.216`;\nexport const id_pkcs9_at_pkcs15Token = `${id_pkcs9_at}.1`;\nexport const id_pkcs9_at_encryptedPrivateKeyInfo = `${id_pkcs9_at}.2`;\nexport const id_pkcs9_at_randomNonce = `${id_pkcs9_at}.3`;\nexport const id_pkcs9_at_sequenceNumber = `${id_pkcs9_at}.4`;\nexport const id_pkcs9_at_pkcs7PDU = `${id_pkcs9_at}.5`;\nexport const id_ietf_at = `1.3.6.1.5.5.7.9`;\nexport const id_pkcs9_at_dateOfBirth = `${id_ietf_at}.1`;\nexport const id_pkcs9_at_placeOfBirth = `${id_ietf_at}.2`;\nexport const id_pkcs9_at_gender = `${id_ietf_at}.3`;\nexport const id_pkcs9_at_countryOfCitizenship = `${id_ietf_at}.4`;\nexport const id_pkcs9_at_countryOfResidence = `${id_ietf_at}.5`;\nexport const id_pkcs9_sx_pkcs9String = `${id_pkcs9_sx}.1`;\nexport const id_pkcs9_sx_signingTime = `${id_pkcs9_sx}.2`;\nexport const id_pkcs9_mr_caseIgnoreMatch = `${id_pkcs9_mr}.1`;\nexport const id_pkcs9_mr_signingTimeMatch = `${id_pkcs9_mr}.2`;\nexport const id_smime = `${id_pkcs9}.16`;\nexport const id_certTypes = `${id_pkcs9}.22`;\nexport const crlTypes = `${id_pkcs9}.23`;\nexport const id_at_pseudonym = `${attr.id_at}.65`;\nlet PKCS9String = class PKCS9String extends x509.DirectoryString {\n    constructor(params = {}) {\n        super(params);\n    }\n    toString() {\n        const o = {};\n        o.toString();\n        return this.ia5String || super.toString();\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String })\n], PKCS9String.prototype, \"ia5String\", void 0);\nPKCS9String = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], PKCS9String);\nexport { PKCS9String };\nlet Pkcs7PDU = class Pkcs7PDU extends cms.ContentInfo {\n};\nPkcs7PDU = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], Pkcs7PDU);\nexport { Pkcs7PDU };\nlet UserPKCS12 = class UserPKCS12 extends pfx.PFX {\n};\nUserPKCS12 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], UserPKCS12);\nexport { UserPKCS12 };\nlet EncryptedPrivateKeyInfo = class EncryptedPrivateKeyInfo extends pkcs8.EncryptedPrivateKeyInfo {\n};\nEncryptedPrivateKeyInfo = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], EncryptedPrivateKeyInfo);\nexport { EncryptedPrivateKeyInfo };\nlet EmailAddress = class EmailAddress {\n    constructor(value = \"\") {\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.IA5String })\n], EmailAddress.prototype, \"value\", void 0);\nEmailAddress = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], EmailAddress);\nexport { EmailAddress };\nlet UnstructuredName = class UnstructuredName extends PKCS9String {\n};\nUnstructuredName = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], UnstructuredName);\nexport { UnstructuredName };\nlet UnstructuredAddress = class UnstructuredAddress extends x509.DirectoryString {\n};\nUnstructuredAddress = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], UnstructuredAddress);\nexport { UnstructuredAddress };\nlet DateOfBirth = class DateOfBirth {\n    constructor(value = new Date()) {\n        this.value = value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.GeneralizedTime })\n], DateOfBirth.prototype, \"value\", void 0);\nDateOfBirth = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], DateOfBirth);\nexport { DateOfBirth };\nlet PlaceOfBirth = class PlaceOfBirth extends x509.DirectoryString {\n};\nPlaceOfBirth = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], PlaceOfBirth);\nexport { PlaceOfBirth };\nlet Gender = class Gender {\n    constructor(value = \"M\") {\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.PrintableString })\n], Gender.prototype, \"value\", void 0);\nGender = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], Gender);\nexport { Gender };\nlet CountryOfCitizenship = class CountryOfCitizenship {\n    constructor(value = \"\") {\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.PrintableString })\n], CountryOfCitizenship.prototype, \"value\", void 0);\nCountryOfCitizenship = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], CountryOfCitizenship);\nexport { CountryOfCitizenship };\nlet CountryOfResidence = class CountryOfResidence extends CountryOfCitizenship {\n};\nCountryOfResidence = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], CountryOfResidence);\nexport { CountryOfResidence };\nlet Pseudonym = class Pseudonym extends x509.DirectoryString {\n};\nPseudonym = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], Pseudonym);\nexport { Pseudonym };\nlet ContentType = class ContentType {\n    constructor(value = \"\") {\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.ObjectIdentifier })\n], ContentType.prototype, \"value\", void 0);\nContentType = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], ContentType);\nexport { ContentType };\nexport class MessageDigest extends OctetString {\n}\nlet SigningTime = class SigningTime extends x509.Time {\n};\nSigningTime = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], SigningTime);\nexport { SigningTime };\nexport class RandomNonce extends OctetString {\n}\nlet SequenceNumber = class SequenceNumber {\n    constructor(value = 0) {\n        this.value = value;\n    }\n    toString() {\n        return this.value.toString();\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], SequenceNumber.prototype, \"value\", void 0);\nSequenceNumber = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], SequenceNumber);\nexport { SequenceNumber };\nlet CounterSignature = class CounterSignature extends cms.SignerInfo {\n};\nCounterSignature = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], CounterSignature);\nexport { CounterSignature };\nlet ChallengePassword = class ChallengePassword extends x509.DirectoryString {\n};\nChallengePassword = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], ChallengePassword);\nexport { ChallengePassword };\nlet ExtensionRequest = ExtensionRequest_1 = class ExtensionRequest extends x509.Extensions {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, ExtensionRequest_1.prototype);\n    }\n};\nExtensionRequest = ExtensionRequest_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], ExtensionRequest);\nexport { ExtensionRequest };\nlet ExtendedCertificateAttributes = ExtendedCertificateAttributes_1 = class ExtendedCertificateAttributes extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, ExtendedCertificateAttributes_1.prototype);\n    }\n};\nExtendedCertificateAttributes = ExtendedCertificateAttributes_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Set, itemType: cms.Attribute })\n], ExtendedCertificateAttributes);\nexport { ExtendedCertificateAttributes };\nlet FriendlyName = class FriendlyName {\n    constructor(value = \"\") {\n        this.value = value;\n    }\n    toString() {\n        return this.value;\n    }\n};\n__decorate([\n    AsnProp({ type: AsnPropTypes.BmpString })\n], FriendlyName.prototype, \"value\", void 0);\nFriendlyName = __decorate([\n    AsnType({ type: AsnTypeTypes.Choice })\n], FriendlyName);\nexport { FriendlyName };\nexport class LocalKeyId extends OctetString {\n}\nexport class SigningDescription extends x509.DirectoryString {\n}\nlet SMIMECapability = class SMIMECapability extends x509.AlgorithmIdentifier {\n};\nSMIMECapability = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence })\n], SMIMECapability);\nexport { SMIMECapability };\nlet SMIMECapabilities = SMIMECapabilities_1 = class SMIMECapabilities extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, SMIMECapabilities_1.prototype);\n    }\n};\nSMIMECapabilities = SMIMECapabilities_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: SMIMECapability })\n], SMIMECapabilities);\nexport { SMIMECapabilities };\n","var Attributes_1;\nimport { __decorate } from \"tslib\";\nimport { AsnArray, AsnType, AsnTypeTypes } from \"@peculiar/asn1-schema\";\nimport { Attribute } from \"@peculiar/asn1-x509\";\nlet Attributes = Attributes_1 = class Attributes extends AsnArray {\n    constructor(items) {\n        super(items);\n        Object.setPrototypeOf(this, Attributes_1.prototype);\n    }\n};\nAttributes = Attributes_1 = __decorate([\n    AsnType({ type: AsnTypeTypes.Sequence, itemType: Attribute })\n], Attributes);\nexport { Attributes };\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { Name, SubjectPublicKeyInfo } from \"@peculiar/asn1-x509\";\nimport { Attributes } from \"./attributes\";\nexport class CertificationRequestInfo {\n    constructor(params = {}) {\n        this.version = 0;\n        this.subject = new Name();\n        this.subjectPKInfo = new SubjectPublicKeyInfo();\n        this.attributes = new Attributes();\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: AsnPropTypes.Integer })\n], CertificationRequestInfo.prototype, \"version\", void 0);\n__decorate([\n    AsnProp({ type: Name })\n], CertificationRequestInfo.prototype, \"subject\", void 0);\n__decorate([\n    AsnProp({ type: SubjectPublicKeyInfo })\n], CertificationRequestInfo.prototype, \"subjectPKInfo\", void 0);\n__decorate([\n    AsnProp({ type: Attributes, implicit: true, context: 0 })\n], CertificationRequestInfo.prototype, \"attributes\", void 0);\n","import { __decorate } from \"tslib\";\nimport { AsnProp, AsnPropTypes } from \"@peculiar/asn1-schema\";\nimport { CertificationRequestInfo } from \"./certification_request_info\";\nimport { AlgorithmIdentifier } from \"@peculiar/asn1-x509\";\nexport class CertificationRequest {\n    constructor(params = {}) {\n        this.certificationRequestInfo = new CertificationRequestInfo();\n        this.signatureAlgorithm = new AlgorithmIdentifier();\n        this.signature = new ArrayBuffer(0);\n        Object.assign(this, params);\n    }\n}\n__decorate([\n    AsnProp({ type: CertificationRequestInfo })\n], CertificationRequest.prototype, \"certificationRequestInfo\", void 0);\n__decorate([\n    AsnProp({ type: AlgorithmIdentifier })\n], CertificationRequest.prototype, \"signatureAlgorithm\", void 0);\n__decorate([\n    AsnProp({ type: AsnPropTypes.BitString })\n], CertificationRequest.prototype, \"signature\", void 0);\n","/*!\n * MIT License\n * \n * Copyright (c) Peculiar Ventures. All rights reserved.\n * \n * Permission is hereby granted, free of charge, to any person obtaining a copy\n * of this software and associated documentation files (the \"Software\"), to deal\n * in the Software without restriction, including without limitation the rights\n * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell\n * copies of the Software, and to permit persons to whom the Software is\n * furnished to do so, subject to the following conditions:\n * \n * The above copyright notice and this permission notice shall be included in all\n * copies or substantial portions of the Software.\n * \n * THE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\n * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\n * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\n * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\n * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE\n * SOFTWARE.\n * \n */\nimport 'reflect-metadata';\nimport { AsnConvert, OctetString, AsnUtf8StringConverter } from '@peculiar/asn1-schema';\nimport * as asn1X509 from '@peculiar/asn1-x509';\nimport { AlgorithmIdentifier, Extension as Extension$1, Name as Name$1, RelativeDistinguishedName, AttributeTypeAndValue, SubjectPublicKeyInfo, BasicConstraints, id_ce_basicConstraints, KeyUsage, id_ce_keyUsage, Attribute as Attribute$1, Version, Extensions, Certificate, RevokedCertificate, Time, id_ce_invalidityDate, InvalidityDate, id_ce_cRLReasons, CRLReason, CertificateList } from '@peculiar/asn1-x509';\nimport { BufferSourceConverter, isEqual, Convert, combine } from 'pvtsutils';\nimport * as asn1Cms from '@peculiar/asn1-cms';\nimport * as asn1Ecc from '@peculiar/asn1-ecc';\nimport { id_ecPublicKey, ECDSASigValue } from '@peculiar/asn1-ecc';\nimport * as asn1Rsa from '@peculiar/asn1-rsa';\nimport { id_RSASSA_PSS, id_rsaEncryption, RSAPublicKey, id_sha512, id_sha384, id_sha256, id_sha1 } from '@peculiar/asn1-rsa';\nimport { __decorate } from 'tslib';\nimport { container, injectable } from 'tsyringe';\nimport * as asnPkcs9 from '@peculiar/asn1-pkcs9';\nimport { id_pkcs9_at_extensionRequest } from '@peculiar/asn1-pkcs9';\nimport { CertificationRequest, CertificationRequestInfo } from '@peculiar/asn1-csr';\n\nconst diAlgorithm = \"crypto.algorithm\";\nclass AlgorithmProvider {\n    getAlgorithms() {\n        return container.resolveAll(diAlgorithm);\n    }\n    toAsnAlgorithm(alg) {\n        ({ ...alg });\n        for (const algorithm of this.getAlgorithms()) {\n            const res = algorithm.toAsnAlgorithm(alg);\n            if (res) {\n                return res;\n            }\n        }\n        if (/^[0-9.]+$/.test(alg.name)) {\n            const res = new AlgorithmIdentifier({\n                algorithm: alg.name,\n            });\n            if (\"parameters\" in alg) {\n                const unknown = alg;\n                res.parameters = unknown.parameters;\n            }\n            return res;\n        }\n        throw new Error(\"Cannot convert WebCrypto algorithm to ASN.1 algorithm\");\n    }\n    toWebAlgorithm(alg) {\n        for (const algorithm of this.getAlgorithms()) {\n            const res = algorithm.toWebAlgorithm(alg);\n            if (res) {\n                return res;\n            }\n        }\n        const unknown = {\n            name: alg.algorithm,\n            parameters: alg.parameters,\n        };\n        return unknown;\n    }\n}\nconst diAlgorithmProvider = \"crypto.algorithmProvider\";\ncontainer.registerSingleton(diAlgorithmProvider, AlgorithmProvider);\n\nvar EcAlgorithm_1;\nconst idVersionOne = \"1.3.36.3.3.2.8.1.1\";\nconst idBrainpoolP160r1 = `${idVersionOne}.1`;\nconst idBrainpoolP160t1 = `${idVersionOne}.2`;\nconst idBrainpoolP192r1 = `${idVersionOne}.3`;\nconst idBrainpoolP192t1 = `${idVersionOne}.4`;\nconst idBrainpoolP224r1 = `${idVersionOne}.5`;\nconst idBrainpoolP224t1 = `${idVersionOne}.6`;\nconst idBrainpoolP256r1 = `${idVersionOne}.7`;\nconst idBrainpoolP256t1 = `${idVersionOne}.8`;\nconst idBrainpoolP320r1 = `${idVersionOne}.9`;\nconst idBrainpoolP320t1 = `${idVersionOne}.10`;\nconst idBrainpoolP384r1 = `${idVersionOne}.11`;\nconst idBrainpoolP384t1 = `${idVersionOne}.12`;\nconst idBrainpoolP512r1 = `${idVersionOne}.13`;\nconst idBrainpoolP512t1 = `${idVersionOne}.14`;\nconst brainpoolP160r1 = \"brainpoolP160r1\";\nconst brainpoolP160t1 = \"brainpoolP160t1\";\nconst brainpoolP192r1 = \"brainpoolP192r1\";\nconst brainpoolP192t1 = \"brainpoolP192t1\";\nconst brainpoolP224r1 = \"brainpoolP224r1\";\nconst brainpoolP224t1 = \"brainpoolP224t1\";\nconst brainpoolP256r1 = \"brainpoolP256r1\";\nconst brainpoolP256t1 = \"brainpoolP256t1\";\nconst brainpoolP320r1 = \"brainpoolP320r1\";\nconst brainpoolP320t1 = \"brainpoolP320t1\";\nconst brainpoolP384r1 = \"brainpoolP384r1\";\nconst brainpoolP384t1 = \"brainpoolP384t1\";\nconst brainpoolP512r1 = \"brainpoolP512r1\";\nconst brainpoolP512t1 = \"brainpoolP512t1\";\nconst ECDSA = \"ECDSA\";\nlet EcAlgorithm = EcAlgorithm_1 = class EcAlgorithm {\n    toAsnAlgorithm(alg) {\n        switch (alg.name.toLowerCase()) {\n            case ECDSA.toLowerCase():\n                if (\"hash\" in alg) {\n                    const hash = typeof alg.hash === \"string\" ? alg.hash : alg.hash.name;\n                    switch (hash.toLowerCase()) {\n                        case \"sha-1\":\n                            return asn1Ecc.ecdsaWithSHA1;\n                        case \"sha-256\":\n                            return asn1Ecc.ecdsaWithSHA256;\n                        case \"sha-384\":\n                            return asn1Ecc.ecdsaWithSHA384;\n                        case \"sha-512\":\n                            return asn1Ecc.ecdsaWithSHA512;\n                    }\n                }\n                else if (\"namedCurve\" in alg) {\n                    let parameters = \"\";\n                    switch (alg.namedCurve) {\n                        case \"P-256\":\n                            parameters = asn1Ecc.id_secp256r1;\n                            break;\n                        case \"K-256\":\n                            parameters = EcAlgorithm_1.SECP256K1;\n                            break;\n                        case \"P-384\":\n                            parameters = asn1Ecc.id_secp384r1;\n                            break;\n                        case \"P-521\":\n                            parameters = asn1Ecc.id_secp521r1;\n                            break;\n                        case brainpoolP160r1:\n                            parameters = idBrainpoolP160r1;\n                            break;\n                        case brainpoolP160t1:\n                            parameters = idBrainpoolP160t1;\n                            break;\n                        case brainpoolP192r1:\n                            parameters = idBrainpoolP192r1;\n                            break;\n                        case brainpoolP192t1:\n                            parameters = idBrainpoolP192t1;\n                            break;\n                        case brainpoolP224r1:\n                            parameters = idBrainpoolP224r1;\n                            break;\n                        case brainpoolP224t1:\n                            parameters = idBrainpoolP224t1;\n                            break;\n                        case brainpoolP256r1:\n                            parameters = idBrainpoolP256r1;\n                            break;\n                        case brainpoolP256t1:\n                            parameters = idBrainpoolP256t1;\n                            break;\n                        case brainpoolP320r1:\n                            parameters = idBrainpoolP320r1;\n                            break;\n                        case brainpoolP320t1:\n                            parameters = idBrainpoolP320t1;\n                            break;\n                        case brainpoolP384r1:\n                            parameters = idBrainpoolP384r1;\n                            break;\n                        case brainpoolP384t1:\n                            parameters = idBrainpoolP384t1;\n                            break;\n                        case brainpoolP512r1:\n                            parameters = idBrainpoolP512r1;\n                            break;\n                        case brainpoolP512t1:\n                            parameters = idBrainpoolP512t1;\n                            break;\n                    }\n                    if (parameters) {\n                        return new AlgorithmIdentifier({\n                            algorithm: asn1Ecc.id_ecPublicKey,\n                            parameters: AsnConvert.serialize(new asn1Ecc.ECParameters({ namedCurve: parameters })),\n                        });\n                    }\n                }\n        }\n        return null;\n    }\n    toWebAlgorithm(alg) {\n        switch (alg.algorithm) {\n            case asn1Ecc.id_ecdsaWithSHA1:\n                return { name: ECDSA, hash: { name: \"SHA-1\" } };\n            case asn1Ecc.id_ecdsaWithSHA256:\n                return { name: ECDSA, hash: { name: \"SHA-256\" } };\n            case asn1Ecc.id_ecdsaWithSHA384:\n                return { name: ECDSA, hash: { name: \"SHA-384\" } };\n            case asn1Ecc.id_ecdsaWithSHA512:\n                return { name: ECDSA, hash: { name: \"SHA-512\" } };\n            case asn1Ecc.id_ecPublicKey: {\n                if (!alg.parameters) {\n                    throw new TypeError(\"Cannot get required parameters from EC algorithm\");\n                }\n                const parameters = AsnConvert.parse(alg.parameters, asn1Ecc.ECParameters);\n                switch (parameters.namedCurve) {\n                    case asn1Ecc.id_secp256r1:\n                        return { name: ECDSA, namedCurve: \"P-256\" };\n                    case EcAlgorithm_1.SECP256K1:\n                        return { name: ECDSA, namedCurve: \"K-256\" };\n                    case asn1Ecc.id_secp384r1:\n                        return { name: ECDSA, namedCurve: \"P-384\" };\n                    case asn1Ecc.id_secp521r1:\n                        return { name: ECDSA, namedCurve: \"P-521\" };\n                    case idBrainpoolP160r1:\n                        return { name: ECDSA, namedCurve: brainpoolP160r1 };\n                    case idBrainpoolP160t1:\n                        return { name: ECDSA, namedCurve: brainpoolP160t1 };\n                    case idBrainpoolP192r1:\n                        return { name: ECDSA, namedCurve: brainpoolP192r1 };\n                    case idBrainpoolP192t1:\n                        return { name: ECDSA, namedCurve: brainpoolP192t1 };\n                    case idBrainpoolP224r1:\n                        return { name: ECDSA, namedCurve: brainpoolP224r1 };\n                    case idBrainpoolP224t1:\n                        return { name: ECDSA, namedCurve: brainpoolP224t1 };\n                    case idBrainpoolP256r1:\n                        return { name: ECDSA, namedCurve: brainpoolP256r1 };\n                    case idBrainpoolP256t1:\n                        return { name: ECDSA, namedCurve: brainpoolP256t1 };\n                    case idBrainpoolP320r1:\n                        return { name: ECDSA, namedCurve: brainpoolP320r1 };\n                    case idBrainpoolP320t1:\n                        return { name: ECDSA, namedCurve: brainpoolP320t1 };\n                    case idBrainpoolP384r1:\n                        return { name: ECDSA, namedCurve: brainpoolP384r1 };\n                    case idBrainpoolP384t1:\n                        return { name: ECDSA, namedCurve: brainpoolP384t1 };\n                    case idBrainpoolP512r1:\n                        return { name: ECDSA, namedCurve: brainpoolP512r1 };\n                    case idBrainpoolP512t1:\n                        return { name: ECDSA, namedCurve: brainpoolP512t1 };\n                }\n            }\n        }\n        return null;\n    }\n};\nEcAlgorithm.SECP256K1 = \"1.3.132.0.10\";\nEcAlgorithm = EcAlgorithm_1 = __decorate([\n    injectable()\n], EcAlgorithm);\ncontainer.registerSingleton(diAlgorithm, EcAlgorithm);\n\nconst NAME = Symbol(\"name\");\nconst VALUE = Symbol(\"value\");\nclass TextObject {\n    constructor(name, items = {}, value = \"\") {\n        this[NAME] = name;\n        this[VALUE] = value;\n        for (const key in items) {\n            this[key] = items[key];\n        }\n    }\n}\nTextObject.NAME = NAME;\nTextObject.VALUE = VALUE;\nclass DefaultAlgorithmSerializer {\n    static toTextObject(alg) {\n        const obj = new TextObject(\"Algorithm Identifier\", {}, OidSerializer.toString(alg.algorithm));\n        if (alg.parameters) {\n            switch (alg.algorithm) {\n                case asn1Ecc.id_ecPublicKey: {\n                    const ecAlg = new EcAlgorithm().toWebAlgorithm(alg);\n                    if (ecAlg && \"namedCurve\" in ecAlg) {\n                        obj[\"Named Curve\"] = ecAlg.namedCurve;\n                    }\n                    else {\n                        obj[\"Parameters\"] = alg.parameters;\n                    }\n                    break;\n                }\n                default:\n                    obj[\"Parameters\"] = alg.parameters;\n            }\n        }\n        return obj;\n    }\n}\nclass OidSerializer {\n    static toString(oid) {\n        const name = this.items[oid];\n        if (name) {\n            return name;\n        }\n        return oid;\n    }\n}\nOidSerializer.items = {\n    [asn1Rsa.id_sha1]: \"sha1\",\n    [asn1Rsa.id_sha224]: \"sha224\",\n    [asn1Rsa.id_sha256]: \"sha256\",\n    [asn1Rsa.id_sha384]: \"sha384\",\n    [asn1Rsa.id_sha512]: \"sha512\",\n    [asn1Rsa.id_rsaEncryption]: \"rsaEncryption\",\n    [asn1Rsa.id_sha1WithRSAEncryption]: \"sha1WithRSAEncryption\",\n    [asn1Rsa.id_sha224WithRSAEncryption]: \"sha224WithRSAEncryption\",\n    [asn1Rsa.id_sha256WithRSAEncryption]: \"sha256WithRSAEncryption\",\n    [asn1Rsa.id_sha384WithRSAEncryption]: \"sha384WithRSAEncryption\",\n    [asn1Rsa.id_sha512WithRSAEncryption]: \"sha512WithRSAEncryption\",\n    [asn1Ecc.id_ecPublicKey]: \"ecPublicKey\",\n    [asn1Ecc.id_ecdsaWithSHA1]: \"ecdsaWithSHA1\",\n    [asn1Ecc.id_ecdsaWithSHA224]: \"ecdsaWithSHA224\",\n    [asn1Ecc.id_ecdsaWithSHA256]: \"ecdsaWithSHA256\",\n    [asn1Ecc.id_ecdsaWithSHA384]: \"ecdsaWithSHA384\",\n    [asn1Ecc.id_ecdsaWithSHA512]: \"ecdsaWithSHA512\",\n    [asn1X509.id_kp_serverAuth]: \"TLS WWW server authentication\",\n    [asn1X509.id_kp_clientAuth]: \"TLS WWW client authentication\",\n    [asn1X509.id_kp_codeSigning]: \"Code Signing\",\n    [asn1X509.id_kp_emailProtection]: \"E-mail Protection\",\n    [asn1X509.id_kp_timeStamping]: \"Time Stamping\",\n    [asn1X509.id_kp_OCSPSigning]: \"OCSP Signing\",\n    [asn1Cms.id_signedData]: \"Signed Data\",\n};\nclass TextConverter {\n    static serialize(obj) {\n        return this.serializeObj(obj).join(\"\\n\");\n    }\n    static pad(deep = 0) {\n        return \"\".padStart(2 * deep, \" \");\n    }\n    static serializeObj(obj, deep = 0) {\n        const res = [];\n        let pad = this.pad(deep++);\n        let value = \"\";\n        const objValue = obj[TextObject.VALUE];\n        if (objValue) {\n            value = ` ${objValue}`;\n        }\n        res.push(`${pad}${obj[TextObject.NAME]}:${value}`);\n        pad = this.pad(deep);\n        for (const key in obj) {\n            if (typeof key === \"symbol\") {\n                continue;\n            }\n            const value = obj[key];\n            const keyValue = key ? `${key}: ` : \"\";\n            if (typeof value === \"string\" ||\n                typeof value === \"number\" ||\n                typeof value === \"boolean\") {\n                res.push(`${pad}${keyValue}${value}`);\n            }\n            else if (value instanceof Date) {\n                res.push(`${pad}${keyValue}${value.toUTCString()}`);\n            }\n            else if (Array.isArray(value)) {\n                for (const obj of value) {\n                    obj[TextObject.NAME] = key;\n                    res.push(...this.serializeObj(obj, deep));\n                }\n            }\n            else if (value instanceof TextObject) {\n                value[TextObject.NAME] = key;\n                res.push(...this.serializeObj(value, deep));\n            }\n            else if (BufferSourceConverter.isBufferSource(value)) {\n                if (key) {\n                    res.push(`${pad}${keyValue}`);\n                    res.push(...this.serializeBufferSource(value, deep + 1));\n                }\n                else {\n                    res.push(...this.serializeBufferSource(value, deep));\n                }\n            }\n            else if (\"toTextObject\" in value) {\n                const obj = value.toTextObject();\n                obj[TextObject.NAME] = key;\n                res.push(...this.serializeObj(obj, deep));\n            }\n            else {\n                throw new TypeError(\"Cannot serialize data in text format. Unsupported type.\");\n            }\n        }\n        return res;\n    }\n    static serializeBufferSource(buffer, deep = 0) {\n        const pad = this.pad(deep);\n        const view = BufferSourceConverter.toUint8Array(buffer);\n        const res = [];\n        for (let i = 0; i < view.length;) {\n            const row = [];\n            for (let j = 0; j < 16 && i < view.length; j++) {\n                if (j === 8) {\n                    row.push(\"\");\n                }\n                const hex = view[i++].toString(16).padStart(2, \"0\");\n                row.push(hex);\n            }\n            res.push(`${pad}${row.join(\" \")}`);\n        }\n        return res;\n    }\n    static serializeAlgorithm(alg) {\n        return this.algorithmSerializer.toTextObject(alg);\n    }\n}\nTextConverter.oidSerializer = OidSerializer;\nTextConverter.algorithmSerializer = DefaultAlgorithmSerializer;\n\nclass AsnData {\n    constructor(...args) {\n        if (args.length === 1) {\n            const asn = args[0];\n            this.rawData = AsnConvert.serialize(asn);\n            this.onInit(asn);\n        }\n        else {\n            const asn = AsnConvert.parse(args[0], args[1]);\n            this.rawData = BufferSourceConverter.toArrayBuffer(args[0]);\n            this.onInit(asn);\n        }\n    }\n    equal(data) {\n        if (data instanceof AsnData) {\n            return isEqual(data.rawData, this.rawData);\n        }\n        return false;\n    }\n    toString(format = \"text\") {\n        switch (format) {\n            case \"asn\":\n                return AsnConvert.toString(this.rawData);\n            case \"text\":\n                return TextConverter.serialize(this.toTextObject());\n            case \"hex\":\n                return Convert.ToHex(this.rawData);\n            case \"base64\":\n                return Convert.ToBase64(this.rawData);\n            case \"base64url\":\n                return Convert.ToBase64Url(this.rawData);\n            default:\n                throw TypeError(\"Argument 'format' is unsupported value\");\n        }\n    }\n    getTextName() {\n        const constructor = this.constructor;\n        return constructor.NAME;\n    }\n    toTextObject() {\n        const obj = this.toTextObjectEmpty();\n        obj[\"\"] = this.rawData;\n        return obj;\n    }\n    toTextObjectEmpty(value) {\n        return new TextObject(this.getTextName(), {}, value);\n    }\n}\nAsnData.NAME = \"ASN\";\n\nclass Extension extends AsnData {\n    constructor(...args) {\n        let raw;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            raw = BufferSourceConverter.toArrayBuffer(args[0]);\n        }\n        else {\n            raw = AsnConvert.serialize(new Extension$1({\n                extnID: args[0],\n                critical: args[1],\n                extnValue: new OctetString(BufferSourceConverter.toArrayBuffer(args[2])),\n            }));\n        }\n        super(raw, Extension$1);\n    }\n    onInit(asn) {\n        this.type = asn.extnID;\n        this.critical = asn.critical;\n        this.value = asn.extnValue.buffer;\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        obj[\"\"] = this.value;\n        return obj;\n    }\n    toTextObjectWithoutValue() {\n        const obj = this.toTextObjectEmpty(this.critical ? \"critical\" : undefined);\n        if (obj[TextObject.NAME] === Extension.NAME) {\n            obj[TextObject.NAME] = OidSerializer.toString(this.type);\n        }\n        return obj;\n    }\n}\n\nvar _a;\nclass CryptoProvider {\n    static isCryptoKeyPair(data) {\n        return data && data.privateKey && data.publicKey;\n    }\n    static isCryptoKey(data) {\n        return data && data.usages && data.type && data.algorithm && data.extractable !== undefined;\n    }\n    constructor() {\n        this.items = new Map();\n        this[_a] = \"CryptoProvider\";\n        if (typeof self !== \"undefined\" && typeof crypto !== \"undefined\") {\n            this.set(CryptoProvider.DEFAULT, crypto);\n        }\n        else if (typeof global !== \"undefined\" && global.crypto && global.crypto.subtle) {\n            this.set(CryptoProvider.DEFAULT, global.crypto);\n        }\n    }\n    clear() {\n        this.items.clear();\n    }\n    delete(key) {\n        return this.items.delete(key);\n    }\n    forEach(callbackfn, thisArg) {\n        return this.items.forEach(callbackfn, thisArg);\n    }\n    has(key) {\n        return this.items.has(key);\n    }\n    get size() {\n        return this.items.size;\n    }\n    entries() {\n        return this.items.entries();\n    }\n    keys() {\n        return this.items.keys();\n    }\n    values() {\n        return this.items.values();\n    }\n    [Symbol.iterator]() {\n        return this.items[Symbol.iterator]();\n    }\n    get(key = CryptoProvider.DEFAULT) {\n        const crypto = this.items.get(key.toLowerCase());\n        if (!crypto) {\n            throw new Error(`Cannot get Crypto by name '${key}'`);\n        }\n        return crypto;\n    }\n    set(key, value) {\n        if (typeof key === \"string\") {\n            if (!value) {\n                throw new TypeError(\"Argument 'value' is required\");\n            }\n            this.items.set(key.toLowerCase(), value);\n        }\n        else {\n            this.items.set(CryptoProvider.DEFAULT, key);\n        }\n        return this;\n    }\n}\n_a = Symbol.toStringTag;\nCryptoProvider.DEFAULT = \"default\";\nconst cryptoProvider = new CryptoProvider();\n\nconst OID_REGEX = /^[0-2](?:\\.[1-9][0-9]*)+$/;\nfunction isOID(id) {\n    return new RegExp(OID_REGEX).test(id);\n}\nclass NameIdentifier {\n    constructor(names = {}) {\n        this.items = {};\n        for (const id in names) {\n            this.register(id, names[id]);\n        }\n    }\n    get(idOrName) {\n        return this.items[idOrName] || null;\n    }\n    findId(idOrName) {\n        if (!isOID(idOrName)) {\n            return this.get(idOrName);\n        }\n        return idOrName;\n    }\n    register(id, name) {\n        this.items[id] = name;\n        this.items[name] = id;\n    }\n}\nconst names = new NameIdentifier();\nnames.register(\"CN\", \"2.5.4.3\");\nnames.register(\"L\", \"2.5.4.7\");\nnames.register(\"ST\", \"2.5.4.8\");\nnames.register(\"O\", \"2.5.4.10\");\nnames.register(\"OU\", \"2.5.4.11\");\nnames.register(\"C\", \"2.5.4.6\");\nnames.register(\"DC\", \"0.9.2342.19200300.100.1.25\");\nnames.register(\"E\", \"1.2.840.113549.1.9.1\");\nnames.register(\"G\", \"2.5.4.42\");\nnames.register(\"I\", \"2.5.4.43\");\nnames.register(\"SN\", \"2.5.4.4\");\nnames.register(\"T\", \"2.5.4.12\");\nfunction replaceUnknownCharacter(text, char) {\n    return `\\\\${Convert.ToHex(Convert.FromUtf8String(char)).toUpperCase()}`;\n}\nfunction escape(data) {\n    return data\n        .replace(/([,+\"\\\\<>;])/g, \"\\\\$1\")\n        .replace(/^([ #])/, \"\\\\$1\")\n        .replace(/([ ]$)/, \"\\\\$1\")\n        .replace(/([\\r\\n\\t])/, replaceUnknownCharacter);\n}\nclass Name {\n    static isASCII(text) {\n        for (let i = 0; i < text.length; i++) {\n            const code = text.charCodeAt(i);\n            if (code > 0xFF) {\n                return false;\n            }\n        }\n        return true;\n    }\n    static isPrintableString(text) {\n        return /^[A-Za-z0-9 '()+,-./:=?]*$/g.test(text);\n    }\n    constructor(data, extraNames = {}) {\n        this.extraNames = new NameIdentifier();\n        this.asn = new Name$1();\n        for (const key in extraNames) {\n            if (Object.prototype.hasOwnProperty.call(extraNames, key)) {\n                const value = extraNames[key];\n                this.extraNames.register(key, value);\n            }\n        }\n        if (typeof data === \"string\") {\n            this.asn = this.fromString(data);\n        }\n        else if (data instanceof Name$1) {\n            this.asn = data;\n        }\n        else if (BufferSourceConverter.isBufferSource(data)) {\n            this.asn = AsnConvert.parse(data, Name$1);\n        }\n        else {\n            this.asn = this.fromJSON(data);\n        }\n    }\n    getField(idOrName) {\n        const id = this.extraNames.findId(idOrName) || names.findId(idOrName);\n        const res = [];\n        for (const name of this.asn) {\n            for (const rdn of name) {\n                if (rdn.type === id) {\n                    res.push(rdn.value.toString());\n                }\n            }\n        }\n        return res;\n    }\n    getName(idOrName) {\n        return this.extraNames.get(idOrName) || names.get(idOrName);\n    }\n    toString() {\n        return this.asn.map(rdn => rdn.map(o => {\n            const type = this.getName(o.type) || o.type;\n            const value = o.value.anyValue\n                ? `#${Convert.ToHex(o.value.anyValue)}`\n                : escape(o.value.toString());\n            return `${type}=${value}`;\n        })\n            .join(\"+\"))\n            .join(\", \");\n    }\n    toJSON() {\n        var _a;\n        const json = [];\n        for (const rdn of this.asn) {\n            const jsonItem = {};\n            for (const attr of rdn) {\n                const type = this.getName(attr.type) || attr.type;\n                (_a = jsonItem[type]) !== null && _a !== void 0 ? _a : (jsonItem[type] = []);\n                jsonItem[type].push(attr.value.anyValue ? `#${Convert.ToHex(attr.value.anyValue)}` : attr.value.toString());\n            }\n            json.push(jsonItem);\n        }\n        return json;\n    }\n    fromString(data) {\n        const asn = new Name$1();\n        const regex = /(\\d\\.[\\d.]*\\d|[A-Za-z]+)=((?:\"\")|(?:\".*?[^\\\\]\")|(?:[^,+].*?(?:[^\\\\][,+]))|(?:))([,+])?/g;\n        let matches = null;\n        let level = \",\";\n        while (matches = regex.exec(`${data},`)) {\n            let [, type, value] = matches;\n            const lastChar = value[value.length - 1];\n            if (lastChar === \",\" || lastChar === \"+\") {\n                value = value.slice(0, value.length - 1);\n                matches[3] = lastChar;\n            }\n            const next = matches[3];\n            type = this.getTypeOid(type);\n            const attr = this.createAttribute(type, value);\n            if (level === \"+\") {\n                asn[asn.length - 1].push(attr);\n            }\n            else {\n                asn.push(new RelativeDistinguishedName([attr]));\n            }\n            level = next;\n        }\n        return asn;\n    }\n    fromJSON(data) {\n        const asn = new Name$1();\n        for (const item of data) {\n            const asnRdn = new RelativeDistinguishedName();\n            for (const type in item) {\n                const typeId = this.getTypeOid(type);\n                const values = item[type];\n                for (const value of values) {\n                    const asnAttr = this.createAttribute(typeId, value);\n                    asnRdn.push(asnAttr);\n                }\n            }\n            asn.push(asnRdn);\n        }\n        return asn;\n    }\n    getTypeOid(type) {\n        if (!/[\\d.]+/.test(type)) {\n            type = this.getName(type) || \"\";\n        }\n        if (!type) {\n            throw new Error(`Cannot get OID for name type '${type}'`);\n        }\n        return type;\n    }\n    createAttribute(type, value) {\n        const attr = new AttributeTypeAndValue({ type });\n        if (typeof value === \"object\") {\n            for (const key in value) {\n                switch (key) {\n                    case \"ia5String\":\n                        attr.value.ia5String = value[key];\n                        break;\n                    case \"utf8String\":\n                        attr.value.utf8String = value[key];\n                        break;\n                    case \"universalString\":\n                        attr.value.universalString = value[key];\n                        break;\n                    case \"bmpString\":\n                        attr.value.bmpString = value[key];\n                        break;\n                    case \"printableString\":\n                        attr.value.printableString = value[key];\n                        break;\n                }\n            }\n        }\n        else if (value[0] === \"#\") {\n            attr.value.anyValue = Convert.FromHex(value.slice(1));\n        }\n        else {\n            const processedValue = this.processStringValue(value);\n            if (type === this.getName(\"E\") || type === this.getName(\"DC\")) {\n                attr.value.ia5String = processedValue;\n            }\n            else {\n                if (Name.isPrintableString(processedValue)) {\n                    attr.value.printableString = processedValue;\n                }\n                else {\n                    attr.value.utf8String = processedValue;\n                }\n            }\n        }\n        return attr;\n    }\n    processStringValue(value) {\n        const quotedMatches = /\"(.*?[^\\\\])?\"/.exec(value);\n        if (quotedMatches) {\n            value = quotedMatches[1];\n        }\n        return value\n            .replace(/\\\\0a/ig, \"\\n\")\n            .replace(/\\\\0d/ig, \"\\r\")\n            .replace(/\\\\0g/ig, \"\\t\")\n            .replace(/\\\\(.)/g, \"$1\");\n    }\n    toArrayBuffer() {\n        return AsnConvert.serialize(this.asn);\n    }\n    async getThumbprint(...args) {\n        var _a;\n        let crypto;\n        let algorithm = \"SHA-1\";\n        if (args.length >= 1 && !((_a = args[0]) === null || _a === void 0 ? void 0 : _a.subtle)) {\n            algorithm = args[0] || algorithm;\n            crypto = args[1] || cryptoProvider.get();\n        }\n        else {\n            crypto = args[0] || cryptoProvider.get();\n        }\n        return await crypto.subtle.digest(algorithm, this.toArrayBuffer());\n    }\n}\n\nconst ERR_GN_CONSTRUCTOR = \"Cannot initialize GeneralName from ASN.1 data.\";\nconst ERR_GN_STRING_FORMAT = `${ERR_GN_CONSTRUCTOR} Unsupported string format in use.`;\nconst ERR_GUID = `${ERR_GN_CONSTRUCTOR} Value doesn't match to GUID regular expression.`;\nconst GUID_REGEX = /^([0-9a-f]{8})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{4})-?([0-9a-f]{12})$/i;\nconst id_GUID = \"1.3.6.1.4.1.311.25.1\";\nconst id_UPN = \"1.3.6.1.4.1.311.20.2.3\";\nconst DNS = \"dns\";\nconst DN = \"dn\";\nconst EMAIL = \"email\";\nconst IP = \"ip\";\nconst URL = \"url\";\nconst GUID = \"guid\";\nconst UPN = \"upn\";\nconst REGISTERED_ID = \"id\";\nclass GeneralName extends AsnData {\n    constructor(...args) {\n        let name;\n        if (args.length === 2) {\n            switch (args[0]) {\n                case DN: {\n                    const derName = new Name(args[1]).toArrayBuffer();\n                    const asnName = AsnConvert.parse(derName, asn1X509.Name);\n                    name = new asn1X509.GeneralName({ directoryName: asnName });\n                    break;\n                }\n                case DNS:\n                    name = new asn1X509.GeneralName({ dNSName: args[1] });\n                    break;\n                case EMAIL:\n                    name = new asn1X509.GeneralName({ rfc822Name: args[1] });\n                    break;\n                case GUID: {\n                    const matches = new RegExp(GUID_REGEX, \"i\").exec(args[1]);\n                    if (!matches) {\n                        throw new Error(\"Cannot parse GUID value. Value doesn't match to regular expression\");\n                    }\n                    const hex = matches\n                        .slice(1)\n                        .map((o, i) => {\n                        if (i < 3) {\n                            return Convert.ToHex(new Uint8Array(Convert.FromHex(o)).reverse());\n                        }\n                        return o;\n                    })\n                        .join(\"\");\n                    name = new asn1X509.GeneralName({\n                        otherName: new asn1X509.OtherName({\n                            typeId: id_GUID,\n                            value: AsnConvert.serialize(new OctetString(Convert.FromHex(hex))),\n                        }),\n                    });\n                    break;\n                }\n                case IP:\n                    name = new asn1X509.GeneralName({ iPAddress: args[1] });\n                    break;\n                case REGISTERED_ID:\n                    name = new asn1X509.GeneralName({ registeredID: args[1] });\n                    break;\n                case UPN: {\n                    name = new asn1X509.GeneralName({\n                        otherName: new asn1X509.OtherName({\n                            typeId: id_UPN,\n                            value: AsnConvert.serialize(AsnUtf8StringConverter.toASN(args[1])),\n                        })\n                    });\n                    break;\n                }\n                case URL:\n                    name = new asn1X509.GeneralName({ uniformResourceIdentifier: args[1] });\n                    break;\n                default:\n                    throw new Error(\"Cannot create GeneralName. Unsupported type of the name\");\n            }\n        }\n        else if (BufferSourceConverter.isBufferSource(args[0])) {\n            name = AsnConvert.parse(args[0], asn1X509.GeneralName);\n        }\n        else {\n            name = args[0];\n        }\n        super(name);\n    }\n    onInit(asn) {\n        if (asn.dNSName != undefined) {\n            this.type = DNS;\n            this.value = asn.dNSName;\n        }\n        else if (asn.rfc822Name != undefined) {\n            this.type = EMAIL;\n            this.value = asn.rfc822Name;\n        }\n        else if (asn.iPAddress != undefined) {\n            this.type = IP;\n            this.value = asn.iPAddress;\n        }\n        else if (asn.uniformResourceIdentifier != undefined) {\n            this.type = URL;\n            this.value = asn.uniformResourceIdentifier;\n        }\n        else if (asn.registeredID != undefined) {\n            this.type = REGISTERED_ID;\n            this.value = asn.registeredID;\n        }\n        else if (asn.directoryName != undefined) {\n            this.type = DN;\n            this.value = new Name(asn.directoryName).toString();\n        }\n        else if (asn.otherName != undefined) {\n            if (asn.otherName.typeId === id_GUID) {\n                this.type = GUID;\n                const guid = AsnConvert.parse(asn.otherName.value, OctetString);\n                const matches = new RegExp(GUID_REGEX, \"i\").exec(Convert.ToHex(guid));\n                if (!matches) {\n                    throw new Error(ERR_GUID);\n                }\n                this.value = matches\n                    .slice(1)\n                    .map((o, i) => {\n                    if (i < 3) {\n                        return Convert.ToHex(new Uint8Array(Convert.FromHex(o)).reverse());\n                    }\n                    return o;\n                })\n                    .join(\"-\");\n            }\n            else if (asn.otherName.typeId === id_UPN) {\n                this.type = UPN;\n                this.value = AsnConvert.parse(asn.otherName.value, asn1X509.DirectoryString).toString();\n            }\n            else {\n                throw new Error(ERR_GN_STRING_FORMAT);\n            }\n        }\n        else {\n            throw new Error(ERR_GN_STRING_FORMAT);\n        }\n    }\n    toJSON() {\n        return {\n            type: this.type,\n            value: this.value,\n        };\n    }\n    toTextObject() {\n        let type;\n        switch (this.type) {\n            case DN:\n            case DNS:\n            case GUID:\n            case IP:\n            case REGISTERED_ID:\n            case UPN:\n            case URL:\n                type = this.type.toUpperCase();\n                break;\n            case EMAIL:\n                type = \"Email\";\n                break;\n            default:\n                throw new Error(\"Unsupported GeneralName type\");\n        }\n        let value = this.value;\n        if (this.type === REGISTERED_ID) {\n            value = OidSerializer.toString(value);\n        }\n        return new TextObject(type, undefined, value);\n    }\n}\nclass GeneralNames extends AsnData {\n    constructor(params) {\n        let names;\n        if (params instanceof asn1X509.GeneralNames) {\n            names = params;\n        }\n        else if (Array.isArray(params)) {\n            const items = [];\n            for (const name of params) {\n                if (name instanceof asn1X509.GeneralName) {\n                    items.push(name);\n                }\n                else {\n                    const asnName = AsnConvert.parse(new GeneralName(name.type, name.value).rawData, asn1X509.GeneralName);\n                    items.push(asnName);\n                }\n            }\n            names = new asn1X509.GeneralNames(items);\n        }\n        else if (BufferSourceConverter.isBufferSource(params)) {\n            names = AsnConvert.parse(params, asn1X509.GeneralNames);\n        }\n        else {\n            throw new Error(\"Cannot initialize GeneralNames. Incorrect incoming arguments\");\n        }\n        super(names);\n    }\n    onInit(asn) {\n        const items = [];\n        for (const asnName of asn) {\n            let name = null;\n            try {\n                name = new GeneralName(asnName);\n            }\n            catch {\n                continue;\n            }\n            items.push(name);\n        }\n        this.items = items;\n    }\n    toJSON() {\n        return this.items.map(o => o.toJSON());\n    }\n    toTextObject() {\n        const res = super.toTextObjectEmpty();\n        for (const name of this.items) {\n            const nameObj = name.toTextObject();\n            let field = res[nameObj[TextObject.NAME]];\n            if (!Array.isArray(field)) {\n                field = [];\n                res[nameObj[TextObject.NAME]] = field;\n            }\n            field.push(nameObj);\n        }\n        return res;\n    }\n}\nGeneralNames.NAME = \"GeneralNames\";\n\nconst rPaddingTag = \"-{5}\";\nconst rEolChars = \"\\\\n\";\nconst rNameTag = `[^${rEolChars}]+`;\nconst rBeginTag = `${rPaddingTag}BEGIN (${rNameTag}(?=${rPaddingTag}))${rPaddingTag}`;\nconst rEndTag = `${rPaddingTag}END \\\\1${rPaddingTag}`;\nconst rEolGroup = \"\\\\n\";\nconst rHeaderKey = `[^:${rEolChars}]+`;\nconst rHeaderValue = `(?:[^${rEolChars}]+${rEolGroup}(?: +[^${rEolChars}]+${rEolGroup})*)`;\nconst rBase64Chars = \"[a-zA-Z0-9=+/]+\";\nconst rBase64 = `(?:${rBase64Chars}${rEolGroup})+`;\nconst rPem = `${rBeginTag}${rEolGroup}(?:((?:${rHeaderKey}: ${rHeaderValue})+))?${rEolGroup}?(${rBase64})${rEndTag}`;\nclass PemConverter {\n    static isPem(data) {\n        return typeof data === \"string\"\n            && new RegExp(rPem, \"g\").test(data);\n    }\n    static decodeWithHeaders(pem) {\n        pem = pem.replace(/\\r/g, \"\");\n        const pattern = new RegExp(rPem, \"g\");\n        const res = [];\n        let matches = null;\n        while (matches = pattern.exec(pem)) {\n            const base64 = matches[3]\n                .replace(new RegExp(`[${rEolChars}]+`, \"g\"), \"\");\n            const pemStruct = {\n                type: matches[1],\n                headers: [],\n                rawData: Convert.FromBase64(base64),\n            };\n            const headersString = matches[2];\n            if (headersString) {\n                const headers = headersString.split(new RegExp(rEolGroup, \"g\"));\n                let lastHeader = null;\n                for (const header of headers) {\n                    const [key, value] = header.split(/:(.*)/);\n                    if (value === undefined) {\n                        if (!lastHeader) {\n                            throw new Error(\"Cannot parse PEM string. Incorrect header value\");\n                        }\n                        lastHeader.value += key.trim();\n                    }\n                    else {\n                        if (lastHeader) {\n                            pemStruct.headers.push(lastHeader);\n                        }\n                        lastHeader = { key, value: value.trim() };\n                    }\n                }\n                if (lastHeader) {\n                    pemStruct.headers.push(lastHeader);\n                }\n            }\n            res.push(pemStruct);\n        }\n        return res;\n    }\n    static decode(pem) {\n        const blocks = this.decodeWithHeaders(pem);\n        return blocks.map(o => o.rawData);\n    }\n    static decodeFirst(pem) {\n        const items = this.decode(pem);\n        if (!items.length) {\n            throw new RangeError(\"PEM string doesn't contain any objects\");\n        }\n        return items[0];\n    }\n    static encode(rawData, tag) {\n        if (Array.isArray(rawData)) {\n            const raws = new Array();\n            if (tag) {\n                rawData.forEach(element => {\n                    if (!BufferSourceConverter.isBufferSource(element)) {\n                        throw new TypeError(\"Cannot encode array of BufferSource in PEM format. Not all items of the array are BufferSource\");\n                    }\n                    raws.push(this.encodeStruct({\n                        type: tag,\n                        rawData: BufferSourceConverter.toArrayBuffer(element),\n                    }));\n                });\n            }\n            else {\n                rawData.forEach(element => {\n                    if (!(\"type\" in element)) {\n                        throw new TypeError(\"Cannot encode array of PemStruct in PEM format. Not all items of the array are PemStrut\");\n                    }\n                    raws.push(this.encodeStruct(element));\n                });\n            }\n            return raws.join(\"\\n\");\n        }\n        else {\n            if (!tag) {\n                throw new Error(\"Required argument 'tag' is missed\");\n            }\n            return this.encodeStruct({\n                type: tag,\n                rawData: BufferSourceConverter.toArrayBuffer(rawData),\n            });\n        }\n    }\n    static encodeStruct(pem) {\n        var _a;\n        const upperCaseType = pem.type.toLocaleUpperCase();\n        const res = [];\n        res.push(`-----BEGIN ${upperCaseType}-----`);\n        if ((_a = pem.headers) === null || _a === void 0 ? void 0 : _a.length) {\n            for (const header of pem.headers) {\n                res.push(`${header.key}: ${header.value}`);\n            }\n            res.push(\"\");\n        }\n        const base64 = Convert.ToBase64(pem.rawData);\n        let sliced;\n        let offset = 0;\n        const rows = Array();\n        while (offset < base64.length) {\n            if (base64.length - offset < 64) {\n                sliced = base64.substring(offset);\n            }\n            else {\n                sliced = base64.substring(offset, offset + 64);\n                offset += 64;\n            }\n            if (sliced.length !== 0) {\n                rows.push(sliced);\n                if (sliced.length < 64) {\n                    break;\n                }\n            }\n            else {\n                break;\n            }\n        }\n        res.push(...rows);\n        res.push(`-----END ${upperCaseType}-----`);\n        return res.join(\"\\n\");\n    }\n}\nPemConverter.CertificateTag = \"CERTIFICATE\";\nPemConverter.CrlTag = \"CRL\";\nPemConverter.CertificateRequestTag = \"CERTIFICATE REQUEST\";\nPemConverter.PublicKeyTag = \"PUBLIC KEY\";\nPemConverter.PrivateKeyTag = \"PRIVATE KEY\";\n\nclass PemData extends AsnData {\n    static isAsnEncoded(data) {\n        return BufferSourceConverter.isBufferSource(data) || typeof data === \"string\";\n    }\n    static toArrayBuffer(raw) {\n        if (typeof raw === \"string\") {\n            if (PemConverter.isPem(raw)) {\n                return PemConverter.decode(raw)[0];\n            }\n            else if (Convert.isHex(raw)) {\n                return Convert.FromHex(raw);\n            }\n            else if (Convert.isBase64(raw)) {\n                return Convert.FromBase64(raw);\n            }\n            else if (Convert.isBase64Url(raw)) {\n                return Convert.FromBase64Url(raw);\n            }\n            else {\n                throw new TypeError(\"Unsupported format of 'raw' argument. Must be one of DER, PEM, HEX, Base64, or Base4Url\");\n            }\n        }\n        else {\n            const stringRaw = Convert.ToBinary(raw);\n            if (PemConverter.isPem(stringRaw)) {\n                return PemConverter.decode(stringRaw)[0];\n            }\n            else if (Convert.isHex(stringRaw)) {\n                return Convert.FromHex(stringRaw);\n            }\n            else if (Convert.isBase64(stringRaw)) {\n                return Convert.FromBase64(stringRaw);\n            }\n            else if (Convert.isBase64Url(stringRaw)) {\n                return Convert.FromBase64Url(stringRaw);\n            }\n            return BufferSourceConverter.toArrayBuffer(raw);\n        }\n    }\n    constructor(...args) {\n        if (PemData.isAsnEncoded(args[0])) {\n            super(PemData.toArrayBuffer(args[0]), args[1]);\n        }\n        else {\n            super(args[0]);\n        }\n    }\n    toString(format = \"pem\") {\n        switch (format) {\n            case \"pem\":\n                return PemConverter.encode(this.rawData, this.tag);\n            default:\n                return super.toString(format);\n        }\n    }\n}\n\nclass PublicKey extends PemData {\n    static async create(data, crypto = cryptoProvider.get()) {\n        if (data instanceof PublicKey) {\n            return data;\n        }\n        else if (CryptoProvider.isCryptoKey(data)) {\n            if (data.type !== \"public\") {\n                throw new TypeError(\"Public key is required\");\n            }\n            const spki = await crypto.subtle.exportKey(\"spki\", data);\n            return new PublicKey(spki);\n        }\n        else if (data.publicKey) {\n            return data.publicKey;\n        }\n        else if (BufferSourceConverter.isBufferSource(data)) {\n            return new PublicKey(data);\n        }\n        else {\n            throw new TypeError(\"Unsupported PublicKeyType\");\n        }\n    }\n    constructor(param) {\n        if (PemData.isAsnEncoded(param)) {\n            super(param, SubjectPublicKeyInfo);\n        }\n        else {\n            super(param);\n        }\n        this.tag = PemConverter.PublicKeyTag;\n    }\n    async export(...args) {\n        let crypto;\n        let keyUsages = [\"verify\"];\n        let algorithm = { hash: \"SHA-256\", ...this.algorithm };\n        if (args.length > 1) {\n            algorithm = args[0] || algorithm;\n            keyUsages = args[1] || keyUsages;\n            crypto = args[2] || cryptoProvider.get();\n        }\n        else {\n            crypto = args[0] || cryptoProvider.get();\n        }\n        let raw = this.rawData;\n        const asnSpki = AsnConvert.parse(this.rawData, SubjectPublicKeyInfo);\n        if (asnSpki.algorithm.algorithm === id_RSASSA_PSS) {\n            raw = convertSpkiToRsaPkcs1(asnSpki, raw);\n        }\n        return crypto.subtle.importKey(\"spki\", raw, algorithm, true, keyUsages);\n    }\n    onInit(asn) {\n        const algProv = container.resolve(diAlgorithmProvider);\n        const algorithm = this.algorithm = algProv.toWebAlgorithm(asn.algorithm);\n        switch (asn.algorithm.algorithm) {\n            case id_rsaEncryption:\n                {\n                    const rsaPublicKey = AsnConvert.parse(asn.subjectPublicKey, RSAPublicKey);\n                    const modulus = BufferSourceConverter.toUint8Array(rsaPublicKey.modulus);\n                    algorithm.publicExponent = BufferSourceConverter.toUint8Array(rsaPublicKey.publicExponent);\n                    algorithm.modulusLength = (!modulus[0] ? modulus.slice(1) : modulus).byteLength << 3;\n                    break;\n                }\n        }\n    }\n    async getThumbprint(...args) {\n        var _a;\n        let crypto;\n        let algorithm = \"SHA-1\";\n        if (args.length >= 1 && !((_a = args[0]) === null || _a === void 0 ? void 0 : _a.subtle)) {\n            algorithm = args[0] || algorithm;\n            crypto = args[1] || cryptoProvider.get();\n        }\n        else {\n            crypto = args[0] || cryptoProvider.get();\n        }\n        return await crypto.subtle.digest(algorithm, this.rawData);\n    }\n    async getKeyIdentifier(...args) {\n        let crypto;\n        let algorithm = \"SHA-1\";\n        if (args.length === 1) {\n            if (typeof args[0] === \"string\") {\n                algorithm = args[0];\n                crypto = cryptoProvider.get();\n            }\n            else {\n                crypto = args[0];\n            }\n        }\n        else if (args.length === 2) {\n            algorithm = args[0];\n            crypto = args[1];\n        }\n        else {\n            crypto = cryptoProvider.get();\n        }\n        const asn = AsnConvert.parse(this.rawData, SubjectPublicKeyInfo);\n        return await crypto.subtle.digest(algorithm, asn.subjectPublicKey);\n    }\n    toTextObject() {\n        const obj = this.toTextObjectEmpty();\n        const asn = AsnConvert.parse(this.rawData, SubjectPublicKeyInfo);\n        obj[\"Algorithm\"] = TextConverter.serializeAlgorithm(asn.algorithm);\n        switch (asn.algorithm.algorithm) {\n            case id_ecPublicKey:\n                obj[\"EC Point\"] = asn.subjectPublicKey;\n                break;\n            case id_rsaEncryption:\n            default:\n                obj[\"Raw Data\"] = asn.subjectPublicKey;\n        }\n        return obj;\n    }\n}\nfunction convertSpkiToRsaPkcs1(asnSpki, raw) {\n    asnSpki.algorithm = new AlgorithmIdentifier({\n        algorithm: id_rsaEncryption,\n        parameters: null,\n    });\n    raw = AsnConvert.serialize(asnSpki);\n    return raw;\n}\n\nclass AuthorityKeyIdentifierExtension extends Extension {\n    static async create(param, critical = false, crypto = cryptoProvider.get()) {\n        if (\"name\" in param && \"serialNumber\" in param) {\n            return new AuthorityKeyIdentifierExtension(param, critical);\n        }\n        const key = await PublicKey.create(param, crypto);\n        const id = await key.getKeyIdentifier(crypto);\n        return new AuthorityKeyIdentifierExtension(Convert.ToHex(id), critical);\n    }\n    constructor(...args) {\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n        }\n        else if (typeof args[0] === \"string\") {\n            const value = new asn1X509.AuthorityKeyIdentifier({ keyIdentifier: new asn1X509.KeyIdentifier(Convert.FromHex(args[0])) });\n            super(asn1X509.id_ce_authorityKeyIdentifier, args[1], AsnConvert.serialize(value));\n        }\n        else {\n            const certId = args[0];\n            const certIdName = certId.name instanceof GeneralNames\n                ? AsnConvert.parse(certId.name.rawData, asn1X509.GeneralNames)\n                : certId.name;\n            const value = new asn1X509.AuthorityKeyIdentifier({\n                authorityCertIssuer: certIdName,\n                authorityCertSerialNumber: Convert.FromHex(certId.serialNumber),\n            });\n            super(asn1X509.id_ce_authorityKeyIdentifier, args[1], AsnConvert.serialize(value));\n        }\n    }\n    onInit(asn) {\n        super.onInit(asn);\n        const aki = AsnConvert.parse(asn.extnValue, asn1X509.AuthorityKeyIdentifier);\n        if (aki.keyIdentifier) {\n            this.keyId = Convert.ToHex(aki.keyIdentifier);\n        }\n        if (aki.authorityCertIssuer || aki.authorityCertSerialNumber) {\n            this.certId = {\n                name: aki.authorityCertIssuer || [],\n                serialNumber: aki.authorityCertSerialNumber ? Convert.ToHex(aki.authorityCertSerialNumber) : \"\",\n            };\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        const asn = AsnConvert.parse(this.value, asn1X509.AuthorityKeyIdentifier);\n        if (asn.authorityCertIssuer) {\n            obj[\"Authority Issuer\"] = new GeneralNames(asn.authorityCertIssuer).toTextObject();\n        }\n        if (asn.authorityCertSerialNumber) {\n            obj[\"Authority Serial Number\"] = asn.authorityCertSerialNumber;\n        }\n        if (asn.keyIdentifier) {\n            obj[\"\"] = asn.keyIdentifier;\n        }\n        return obj;\n    }\n}\nAuthorityKeyIdentifierExtension.NAME = \"Authority Key Identifier\";\n\nclass BasicConstraintsExtension extends Extension {\n    constructor(...args) {\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n            const value = AsnConvert.parse(this.value, BasicConstraints);\n            this.ca = value.cA;\n            this.pathLength = value.pathLenConstraint;\n        }\n        else {\n            const value = new BasicConstraints({\n                cA: args[0],\n                pathLenConstraint: args[1],\n            });\n            super(id_ce_basicConstraints, args[2], AsnConvert.serialize(value));\n            this.ca = args[0];\n            this.pathLength = args[1];\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        if (this.ca) {\n            obj[\"CA\"] = this.ca;\n        }\n        if (this.pathLength !== undefined) {\n            obj[\"Path Length\"] = this.pathLength;\n        }\n        return obj;\n    }\n}\nBasicConstraintsExtension.NAME = \"Basic Constraints\";\n\nvar ExtendedKeyUsage;\n(function (ExtendedKeyUsage) {\n    ExtendedKeyUsage[\"serverAuth\"] = \"1.3.6.1.5.5.7.3.1\";\n    ExtendedKeyUsage[\"clientAuth\"] = \"1.3.6.1.5.5.7.3.2\";\n    ExtendedKeyUsage[\"codeSigning\"] = \"1.3.6.1.5.5.7.3.3\";\n    ExtendedKeyUsage[\"emailProtection\"] = \"1.3.6.1.5.5.7.3.4\";\n    ExtendedKeyUsage[\"timeStamping\"] = \"1.3.6.1.5.5.7.3.8\";\n    ExtendedKeyUsage[\"ocspSigning\"] = \"1.3.6.1.5.5.7.3.9\";\n})(ExtendedKeyUsage || (ExtendedKeyUsage = {}));\nclass ExtendedKeyUsageExtension extends Extension {\n    constructor(...args) {\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n            const value = AsnConvert.parse(this.value, asn1X509.ExtendedKeyUsage);\n            this.usages = value.map(o => o);\n        }\n        else {\n            const value = new asn1X509.ExtendedKeyUsage(args[0]);\n            super(asn1X509.id_ce_extKeyUsage, args[1], AsnConvert.serialize(value));\n            this.usages = args[0];\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        obj[\"\"] = this.usages.map(o => OidSerializer.toString(o)).join(\", \");\n        return obj;\n    }\n}\nExtendedKeyUsageExtension.NAME = \"Extended Key Usages\";\n\nvar KeyUsageFlags;\n(function (KeyUsageFlags) {\n    KeyUsageFlags[KeyUsageFlags[\"digitalSignature\"] = 1] = \"digitalSignature\";\n    KeyUsageFlags[KeyUsageFlags[\"nonRepudiation\"] = 2] = \"nonRepudiation\";\n    KeyUsageFlags[KeyUsageFlags[\"keyEncipherment\"] = 4] = \"keyEncipherment\";\n    KeyUsageFlags[KeyUsageFlags[\"dataEncipherment\"] = 8] = \"dataEncipherment\";\n    KeyUsageFlags[KeyUsageFlags[\"keyAgreement\"] = 16] = \"keyAgreement\";\n    KeyUsageFlags[KeyUsageFlags[\"keyCertSign\"] = 32] = \"keyCertSign\";\n    KeyUsageFlags[KeyUsageFlags[\"cRLSign\"] = 64] = \"cRLSign\";\n    KeyUsageFlags[KeyUsageFlags[\"encipherOnly\"] = 128] = \"encipherOnly\";\n    KeyUsageFlags[KeyUsageFlags[\"decipherOnly\"] = 256] = \"decipherOnly\";\n})(KeyUsageFlags || (KeyUsageFlags = {}));\nclass KeyUsagesExtension extends Extension {\n    constructor(...args) {\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n            const value = AsnConvert.parse(this.value, KeyUsage);\n            this.usages = value.toNumber();\n        }\n        else {\n            const value = new KeyUsage(args[0]);\n            super(id_ce_keyUsage, args[1], AsnConvert.serialize(value));\n            this.usages = args[0];\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        const asn = AsnConvert.parse(this.value, KeyUsage);\n        obj[\"\"] = asn.toJSON().join(\", \");\n        return obj;\n    }\n}\nKeyUsagesExtension.NAME = \"Key Usages\";\n\nclass SubjectKeyIdentifierExtension extends Extension {\n    static async create(publicKey, critical = false, crypto = cryptoProvider.get()) {\n        const key = await PublicKey.create(publicKey, crypto);\n        const id = await key.getKeyIdentifier(crypto);\n        return new SubjectKeyIdentifierExtension(Convert.ToHex(id), critical);\n    }\n    constructor(...args) {\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n            const value = AsnConvert.parse(this.value, asn1X509.SubjectKeyIdentifier);\n            this.keyId = Convert.ToHex(value);\n        }\n        else {\n            const identifier = typeof args[0] === \"string\"\n                ? Convert.FromHex(args[0])\n                : args[0];\n            const value = new asn1X509.SubjectKeyIdentifier(identifier);\n            super(asn1X509.id_ce_subjectKeyIdentifier, args[1], AsnConvert.serialize(value));\n            this.keyId = Convert.ToHex(identifier);\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        const asn = AsnConvert.parse(this.value, asn1X509.SubjectKeyIdentifier);\n        obj[\"\"] = asn;\n        return obj;\n    }\n}\nSubjectKeyIdentifierExtension.NAME = \"Subject Key Identifier\";\n\nclass SubjectAlternativeNameExtension extends Extension {\n    constructor(...args) {\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n        }\n        else {\n            super(asn1X509.id_ce_subjectAltName, args[1], new GeneralNames(args[0] || []).rawData);\n        }\n    }\n    onInit(asn) {\n        super.onInit(asn);\n        const value = AsnConvert.parse(asn.extnValue, asn1X509.SubjectAlternativeName);\n        this.names = new GeneralNames(value);\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        const namesObj = this.names.toTextObject();\n        for (const key in namesObj) {\n            obj[key] = namesObj[key];\n        }\n        return obj;\n    }\n}\nSubjectAlternativeNameExtension.NAME = \"Subject Alternative Name\";\n\nclass ExtensionFactory {\n    static register(id, type) {\n        this.items.set(id, type);\n    }\n    static create(data) {\n        const extension = new Extension(data);\n        const Type = this.items.get(extension.type);\n        if (Type) {\n            return new Type(data);\n        }\n        return extension;\n    }\n}\nExtensionFactory.items = new Map();\n\nclass CertificatePolicyExtension extends Extension {\n    constructor(...args) {\n        var _a;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n            const asnPolicies = AsnConvert.parse(this.value, asn1X509.CertificatePolicies);\n            this.policies = asnPolicies.map(o => o.policyIdentifier);\n        }\n        else {\n            const policies = args[0];\n            const critical = (_a = args[1]) !== null && _a !== void 0 ? _a : false;\n            const value = new asn1X509.CertificatePolicies(policies.map(o => (new asn1X509.PolicyInformation({\n                policyIdentifier: o,\n            }))));\n            super(asn1X509.id_ce_certificatePolicies, critical, AsnConvert.serialize(value));\n            this.policies = policies;\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        obj[\"Policy\"] = this.policies.map(o => new TextObject(\"\", {}, OidSerializer.toString(o)));\n        return obj;\n    }\n}\nCertificatePolicyExtension.NAME = \"Certificate Policies\";\nExtensionFactory.register(asn1X509.id_ce_certificatePolicies, CertificatePolicyExtension);\n\nclass CRLDistributionPointsExtension extends Extension {\n    constructor(...args) {\n        var _a;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n        }\n        else if (Array.isArray(args[0]) && typeof args[0][0] === \"string\") {\n            const urls = args[0];\n            const dps = urls.map(url => {\n                return new asn1X509.DistributionPoint({\n                    distributionPoint: new asn1X509.DistributionPointName({\n                        fullName: [new asn1X509.GeneralName({ uniformResourceIdentifier: url })],\n                    }),\n                });\n            });\n            const value = new asn1X509.CRLDistributionPoints(dps);\n            super(asn1X509.id_ce_cRLDistributionPoints, args[1], AsnConvert.serialize(value));\n        }\n        else {\n            const value = new asn1X509.CRLDistributionPoints(args[0]);\n            super(asn1X509.id_ce_cRLDistributionPoints, args[1], AsnConvert.serialize(value));\n        }\n        (_a = this.distributionPoints) !== null && _a !== void 0 ? _a : (this.distributionPoints = []);\n    }\n    onInit(asn) {\n        super.onInit(asn);\n        const crlExt = AsnConvert.parse(asn.extnValue, asn1X509.CRLDistributionPoints);\n        this.distributionPoints = crlExt;\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        obj[\"Distribution Point\"] = this.distributionPoints.map(dp => {\n            var _a;\n            const dpObj = {};\n            if (dp.distributionPoint) {\n                dpObj[\"\"] = (_a = dp.distributionPoint.fullName) === null || _a === void 0 ? void 0 : _a.map(name => new GeneralName(name).toString()).join(\", \");\n            }\n            if (dp.reasons) {\n                dpObj[\"Reasons\"] = dp.reasons.toString();\n            }\n            if (dp.cRLIssuer) {\n                dpObj[\"CRL Issuer\"] = dp.cRLIssuer.map(issuer => issuer.toString()).join(\", \");\n            }\n            return dpObj;\n        });\n        return obj;\n    }\n}\nCRLDistributionPointsExtension.NAME = \"CRL Distribution Points\";\n\nclass AuthorityInfoAccessExtension extends Extension {\n    constructor(...args) {\n        var _a, _b, _c, _d;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n        }\n        else if (args[0] instanceof asn1X509.AuthorityInfoAccessSyntax) {\n            const value = new asn1X509.AuthorityInfoAccessSyntax(args[0]);\n            super(asn1X509.id_pe_authorityInfoAccess, args[1], AsnConvert.serialize(value));\n        }\n        else {\n            const params = args[0];\n            const value = new asn1X509.AuthorityInfoAccessSyntax();\n            addAccessDescriptions(value, params, asn1X509.id_ad_ocsp, \"ocsp\");\n            addAccessDescriptions(value, params, asn1X509.id_ad_caIssuers, \"caIssuers\");\n            addAccessDescriptions(value, params, asn1X509.id_ad_timeStamping, \"timeStamping\");\n            addAccessDescriptions(value, params, asn1X509.id_ad_caRepository, \"caRepository\");\n            super(asn1X509.id_pe_authorityInfoAccess, args[1], AsnConvert.serialize(value));\n        }\n        (_a = this.ocsp) !== null && _a !== void 0 ? _a : (this.ocsp = []);\n        (_b = this.caIssuers) !== null && _b !== void 0 ? _b : (this.caIssuers = []);\n        (_c = this.timeStamping) !== null && _c !== void 0 ? _c : (this.timeStamping = []);\n        (_d = this.caRepository) !== null && _d !== void 0 ? _d : (this.caRepository = []);\n    }\n    onInit(asn) {\n        super.onInit(asn);\n        this.ocsp = [];\n        this.caIssuers = [];\n        this.timeStamping = [];\n        this.caRepository = [];\n        const aia = AsnConvert.parse(asn.extnValue, asn1X509.AuthorityInfoAccessSyntax);\n        aia.forEach(accessDescription => {\n            switch (accessDescription.accessMethod) {\n                case asn1X509.id_ad_ocsp:\n                    this.ocsp.push(new GeneralName(accessDescription.accessLocation));\n                    break;\n                case asn1X509.id_ad_caIssuers:\n                    this.caIssuers.push(new GeneralName(accessDescription.accessLocation));\n                    break;\n                case asn1X509.id_ad_timeStamping:\n                    this.timeStamping.push(new GeneralName(accessDescription.accessLocation));\n                    break;\n                case asn1X509.id_ad_caRepository:\n                    this.caRepository.push(new GeneralName(accessDescription.accessLocation));\n                    break;\n            }\n        });\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        if (this.ocsp.length) {\n            addUrlsToObject(obj, \"OCSP\", this.ocsp);\n        }\n        if (this.caIssuers.length) {\n            addUrlsToObject(obj, \"CA Issuers\", this.caIssuers);\n        }\n        if (this.timeStamping.length) {\n            addUrlsToObject(obj, \"Time Stamping\", this.timeStamping);\n        }\n        if (this.caRepository.length) {\n            addUrlsToObject(obj, \"CA Repository\", this.caRepository);\n        }\n        return obj;\n    }\n}\nAuthorityInfoAccessExtension.NAME = \"Authority Info Access\";\nfunction addUrlsToObject(obj, key, urls) {\n    if (urls.length === 1) {\n        obj[key] = urls[0].toTextObject();\n    }\n    else {\n        const names = new TextObject(\"\");\n        urls.forEach((name, index) => {\n            const nameObj = name.toTextObject();\n            const indexedKey = `${nameObj[TextObject.NAME]} ${index + 1}`;\n            let field = names[indexedKey];\n            if (!Array.isArray(field)) {\n                field = [];\n                names[indexedKey] = field;\n            }\n            field.push(nameObj);\n        });\n        obj[key] = names;\n    }\n}\nfunction addAccessDescriptions(value, params, method, key) {\n    const items = params[key];\n    if (items) {\n        const array = Array.isArray(items) ? items : [items];\n        array.forEach(url => {\n            if (typeof url === \"string\") {\n                url = new GeneralName(\"url\", url);\n            }\n            value.push(new asn1X509.AccessDescription({\n                accessMethod: method,\n                accessLocation: AsnConvert.parse(url.rawData, asn1X509.GeneralName),\n            }));\n        });\n    }\n}\n\nclass Attribute extends AsnData {\n    constructor(...args) {\n        let raw;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            raw = BufferSourceConverter.toArrayBuffer(args[0]);\n        }\n        else {\n            const type = args[0];\n            const values = Array.isArray(args[1]) ? args[1].map(o => BufferSourceConverter.toArrayBuffer(o)) : [];\n            raw = AsnConvert.serialize(new Attribute$1({ type, values }));\n        }\n        super(raw, Attribute$1);\n    }\n    onInit(asn) {\n        this.type = asn.type;\n        this.values = asn.values;\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        obj[\"Value\"] = this.values.map(o => new TextObject(\"\", { \"\": o }));\n        return obj;\n    }\n    toTextObjectWithoutValue() {\n        const obj = this.toTextObjectEmpty();\n        if (obj[TextObject.NAME] === Attribute.NAME) {\n            obj[TextObject.NAME] = OidSerializer.toString(this.type);\n        }\n        return obj;\n    }\n}\nAttribute.NAME = \"Attribute\";\n\nclass ChallengePasswordAttribute extends Attribute {\n    constructor(...args) {\n        var _a;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n        }\n        else {\n            const value = new asnPkcs9.ChallengePassword({\n                printableString: args[0],\n            });\n            super(asnPkcs9.id_pkcs9_at_challengePassword, [AsnConvert.serialize(value)]);\n        }\n        (_a = this.password) !== null && _a !== void 0 ? _a : (this.password = \"\");\n    }\n    onInit(asn) {\n        super.onInit(asn);\n        if (this.values[0]) {\n            const value = AsnConvert.parse(this.values[0], asnPkcs9.ChallengePassword);\n            this.password = value.toString();\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        obj[TextObject.VALUE] = this.password;\n        return obj;\n    }\n}\nChallengePasswordAttribute.NAME = \"Challenge Password\";\n\nclass ExtensionsAttribute extends Attribute {\n    constructor(...args) {\n        var _a;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            super(args[0]);\n        }\n        else {\n            const extensions = args[0];\n            const value = new asn1X509.Extensions();\n            for (const extension of extensions) {\n                value.push(AsnConvert.parse(extension.rawData, asn1X509.Extension));\n            }\n            super(asnPkcs9.id_pkcs9_at_extensionRequest, [AsnConvert.serialize(value)]);\n        }\n        (_a = this.items) !== null && _a !== void 0 ? _a : (this.items = []);\n    }\n    onInit(asn) {\n        super.onInit(asn);\n        if (this.values[0]) {\n            const value = AsnConvert.parse(this.values[0], asn1X509.Extensions);\n            this.items = value.map(o => ExtensionFactory.create(AsnConvert.serialize(o)));\n        }\n    }\n    toTextObject() {\n        const obj = this.toTextObjectWithoutValue();\n        const extensions = this.items.map(o => o.toTextObject());\n        for (const extension of extensions) {\n            obj[extension[TextObject.NAME]] = extension;\n        }\n        return obj;\n    }\n}\nExtensionsAttribute.NAME = \"Extensions\";\n\nclass AttributeFactory {\n    static register(id, type) {\n        this.items.set(id, type);\n    }\n    static create(data) {\n        const attribute = new Attribute(data);\n        const Type = this.items.get(attribute.type);\n        if (Type) {\n            return new Type(data);\n        }\n        return attribute;\n    }\n}\nAttributeFactory.items = new Map();\n\nconst diAsnSignatureFormatter = \"crypto.signatureFormatter\";\nclass AsnDefaultSignatureFormatter {\n    toAsnSignature(algorithm, signature) {\n        return BufferSourceConverter.toArrayBuffer(signature);\n    }\n    toWebSignature(algorithm, signature) {\n        return BufferSourceConverter.toArrayBuffer(signature);\n    }\n}\n\nvar RsaAlgorithm_1;\nlet RsaAlgorithm = RsaAlgorithm_1 = class RsaAlgorithm {\n    static createPssParams(hash, saltLength) {\n        const hashAlgorithm = RsaAlgorithm_1.getHashAlgorithm(hash);\n        if (!hashAlgorithm) {\n            return null;\n        }\n        return new asn1Rsa.RsaSaPssParams({\n            hashAlgorithm,\n            maskGenAlgorithm: new AlgorithmIdentifier({\n                algorithm: asn1Rsa.id_mgf1,\n                parameters: AsnConvert.serialize(hashAlgorithm),\n            }),\n            saltLength,\n        });\n    }\n    static getHashAlgorithm(alg) {\n        const algProv = container.resolve(diAlgorithmProvider);\n        if (typeof alg === \"string\") {\n            return algProv.toAsnAlgorithm({ name: alg });\n        }\n        if (typeof alg === \"object\" && alg && \"name\" in alg) {\n            return algProv.toAsnAlgorithm(alg);\n        }\n        return null;\n    }\n    toAsnAlgorithm(alg) {\n        switch (alg.name.toLowerCase()) {\n            case \"rsassa-pkcs1-v1_5\":\n                if (\"hash\" in alg) {\n                    let hash;\n                    if (typeof alg.hash === \"string\") {\n                        hash = alg.hash;\n                    }\n                    else if (alg.hash && typeof alg.hash === \"object\"\n                        && \"name\" in alg.hash && typeof alg.hash.name === \"string\") {\n                        hash = alg.hash.name.toUpperCase();\n                    }\n                    else {\n                        throw new Error(\"Cannot get hash algorithm name\");\n                    }\n                    switch (hash.toLowerCase()) {\n                        case \"sha-1\":\n                            return new AlgorithmIdentifier({ algorithm: asn1Rsa.id_sha1WithRSAEncryption, parameters: null });\n                        case \"sha-256\":\n                            return new AlgorithmIdentifier({ algorithm: asn1Rsa.id_sha256WithRSAEncryption, parameters: null });\n                        case \"sha-384\":\n                            return new AlgorithmIdentifier({ algorithm: asn1Rsa.id_sha384WithRSAEncryption, parameters: null });\n                        case \"sha-512\":\n                            return new AlgorithmIdentifier({ algorithm: asn1Rsa.id_sha512WithRSAEncryption, parameters: null });\n                    }\n                }\n                else {\n                    return new AlgorithmIdentifier({ algorithm: asn1Rsa.id_rsaEncryption, parameters: null });\n                }\n                break;\n            case \"rsa-pss\":\n                if (\"hash\" in alg) {\n                    if (!(\"saltLength\" in alg && typeof alg.saltLength === \"number\")) {\n                        throw new Error(\"Cannot get 'saltLength' from 'alg' argument\");\n                    }\n                    const pssParams = RsaAlgorithm_1.createPssParams(alg.hash, alg.saltLength);\n                    if (!pssParams) {\n                        throw new Error(\"Cannot create PSS parameters\");\n                    }\n                    return new AlgorithmIdentifier({ algorithm: asn1Rsa.id_RSASSA_PSS, parameters: AsnConvert.serialize(pssParams) });\n                }\n                else {\n                    return new AlgorithmIdentifier({ algorithm: asn1Rsa.id_RSASSA_PSS, parameters: null });\n                }\n        }\n        return null;\n    }\n    toWebAlgorithm(alg) {\n        switch (alg.algorithm) {\n            case asn1Rsa.id_rsaEncryption:\n                return { name: \"RSASSA-PKCS1-v1_5\" };\n            case asn1Rsa.id_sha1WithRSAEncryption:\n                return { name: \"RSASSA-PKCS1-v1_5\", hash: { name: \"SHA-1\" } };\n            case asn1Rsa.id_sha256WithRSAEncryption:\n                return { name: \"RSASSA-PKCS1-v1_5\", hash: { name: \"SHA-256\" } };\n            case asn1Rsa.id_sha384WithRSAEncryption:\n                return { name: \"RSASSA-PKCS1-v1_5\", hash: { name: \"SHA-384\" } };\n            case asn1Rsa.id_sha512WithRSAEncryption:\n                return { name: \"RSASSA-PKCS1-v1_5\", hash: { name: \"SHA-512\" } };\n            case asn1Rsa.id_RSASSA_PSS:\n                if (alg.parameters) {\n                    const pssParams = AsnConvert.parse(alg.parameters, asn1Rsa.RsaSaPssParams);\n                    const algProv = container.resolve(diAlgorithmProvider);\n                    const hashAlg = algProv.toWebAlgorithm(pssParams.hashAlgorithm);\n                    return {\n                        name: \"RSA-PSS\",\n                        hash: hashAlg,\n                        saltLength: pssParams.saltLength,\n                    };\n                }\n                else {\n                    return { name: \"RSA-PSS\" };\n                }\n        }\n        return null;\n    }\n};\nRsaAlgorithm = RsaAlgorithm_1 = __decorate([\n    injectable()\n], RsaAlgorithm);\ncontainer.registerSingleton(diAlgorithm, RsaAlgorithm);\n\nlet ShaAlgorithm = class ShaAlgorithm {\n    toAsnAlgorithm(alg) {\n        switch (alg.name.toLowerCase()) {\n            case \"sha-1\":\n                return new AlgorithmIdentifier({ algorithm: id_sha1 });\n            case \"sha-256\":\n                return new AlgorithmIdentifier({ algorithm: id_sha256 });\n            case \"sha-384\":\n                return new AlgorithmIdentifier({ algorithm: id_sha384 });\n            case \"sha-512\":\n                return new AlgorithmIdentifier({ algorithm: id_sha512 });\n        }\n        return null;\n    }\n    toWebAlgorithm(alg) {\n        switch (alg.algorithm) {\n            case id_sha1:\n                return { name: \"SHA-1\" };\n            case id_sha256:\n                return { name: \"SHA-256\" };\n            case id_sha384:\n                return { name: \"SHA-384\" };\n            case id_sha512:\n                return { name: \"SHA-512\" };\n        }\n        return null;\n    }\n};\nShaAlgorithm = __decorate([\n    injectable()\n], ShaAlgorithm);\ncontainer.registerSingleton(diAlgorithm, ShaAlgorithm);\n\nclass AsnEcSignatureFormatter {\n    addPadding(pointSize, data) {\n        const bytes = BufferSourceConverter.toUint8Array(data);\n        const res = new Uint8Array(pointSize);\n        res.set(bytes, pointSize - bytes.length);\n        return res;\n    }\n    removePadding(data, positive = false) {\n        let bytes = BufferSourceConverter.toUint8Array(data);\n        for (let i = 0; i < bytes.length; i++) {\n            if (!bytes[i]) {\n                continue;\n            }\n            bytes = bytes.slice(i);\n            break;\n        }\n        if (positive && bytes[0] > 127) {\n            const result = new Uint8Array(bytes.length + 1);\n            result.set(bytes, 1);\n            return result.buffer;\n        }\n        return bytes.buffer;\n    }\n    toAsnSignature(algorithm, signature) {\n        if (algorithm.name === \"ECDSA\") {\n            const namedCurve = algorithm.namedCurve;\n            const pointSize = AsnEcSignatureFormatter.namedCurveSize.get(namedCurve) || AsnEcSignatureFormatter.defaultNamedCurveSize;\n            const ecSignature = new ECDSASigValue();\n            const uint8Signature = BufferSourceConverter.toUint8Array(signature);\n            ecSignature.r = this.removePadding(uint8Signature.slice(0, pointSize), true);\n            ecSignature.s = this.removePadding(uint8Signature.slice(pointSize, pointSize + pointSize), true);\n            return AsnConvert.serialize(ecSignature);\n        }\n        return null;\n    }\n    toWebSignature(algorithm, signature) {\n        if (algorithm.name === \"ECDSA\") {\n            const ecSigValue = AsnConvert.parse(signature, ECDSASigValue);\n            const namedCurve = algorithm.namedCurve;\n            const pointSize = AsnEcSignatureFormatter.namedCurveSize.get(namedCurve) || AsnEcSignatureFormatter.defaultNamedCurveSize;\n            const r = this.addPadding(pointSize, this.removePadding(ecSigValue.r));\n            const s = this.addPadding(pointSize, this.removePadding(ecSigValue.s));\n            return combine(r, s);\n        }\n        return null;\n    }\n}\nAsnEcSignatureFormatter.namedCurveSize = new Map();\nAsnEcSignatureFormatter.defaultNamedCurveSize = 32;\n\nconst idX25519 = \"1.3.101.110\";\nconst idX448 = \"1.3.101.111\";\nconst idEd25519 = \"1.3.101.112\";\nconst idEd448 = \"1.3.101.113\";\nlet EdAlgorithm = class EdAlgorithm {\n    toAsnAlgorithm(alg) {\n        let algorithm = null;\n        switch (alg.name.toLowerCase()) {\n            case \"ed25519\":\n                algorithm = idEd25519;\n                break;\n            case \"x25519\":\n                algorithm = idX25519;\n                break;\n            case \"eddsa\":\n                switch (alg.namedCurve.toLowerCase()) {\n                    case \"ed25519\":\n                        algorithm = idEd25519;\n                        break;\n                    case \"ed448\":\n                        algorithm = idEd448;\n                        break;\n                }\n                break;\n            case \"ecdh-es\":\n                switch (alg.namedCurve.toLowerCase()) {\n                    case \"x25519\":\n                        algorithm = idX25519;\n                        break;\n                    case \"x448\":\n                        algorithm = idX448;\n                        break;\n                }\n        }\n        if (algorithm) {\n            return new AlgorithmIdentifier({\n                algorithm,\n            });\n        }\n        return null;\n    }\n    toWebAlgorithm(alg) {\n        switch (alg.algorithm) {\n            case idEd25519:\n                return { name: \"Ed25519\" };\n            case idEd448:\n                return { name: \"EdDSA\", namedCurve: \"Ed448\" };\n            case idX25519:\n                return { name: \"X25519\" };\n            case idX448:\n                return { name: \"ECDH-ES\", namedCurve: \"X448\" };\n        }\n        return null;\n    }\n};\nEdAlgorithm = __decorate([\n    injectable()\n], EdAlgorithm);\ncontainer.registerSingleton(diAlgorithm, EdAlgorithm);\n\nclass Pkcs10CertificateRequest extends PemData {\n    constructor(param) {\n        if (PemData.isAsnEncoded(param)) {\n            super(param, CertificationRequest);\n        }\n        else {\n            super(param);\n        }\n        this.tag = PemConverter.CertificateRequestTag;\n    }\n    onInit(asn) {\n        this.tbs = AsnConvert.serialize(asn.certificationRequestInfo);\n        this.publicKey = new PublicKey(asn.certificationRequestInfo.subjectPKInfo);\n        const algProv = container.resolve(diAlgorithmProvider);\n        this.signatureAlgorithm = algProv.toWebAlgorithm(asn.signatureAlgorithm);\n        this.signature = asn.signature;\n        this.attributes = asn.certificationRequestInfo.attributes\n            .map(o => AttributeFactory.create(AsnConvert.serialize(o)));\n        const extensions = this.getAttribute(id_pkcs9_at_extensionRequest);\n        this.extensions = [];\n        if (extensions instanceof ExtensionsAttribute) {\n            this.extensions = extensions.items;\n        }\n        this.subjectName = new Name(asn.certificationRequestInfo.subject);\n        this.subject = this.subjectName.toString();\n    }\n    getAttribute(type) {\n        for (const attr of this.attributes) {\n            if (attr.type === type) {\n                return attr;\n            }\n        }\n        return null;\n    }\n    getAttributes(type) {\n        return this.attributes.filter(o => o.type === type);\n    }\n    getExtension(type) {\n        for (const ext of this.extensions) {\n            if (ext.type === type) {\n                return ext;\n            }\n        }\n        return null;\n    }\n    getExtensions(type) {\n        return this.extensions.filter(o => o.type === type);\n    }\n    async verify(crypto = cryptoProvider.get()) {\n        const algorithm = { ...this.publicKey.algorithm, ...this.signatureAlgorithm };\n        const publicKey = await this.publicKey.export(algorithm, [\"verify\"], crypto);\n        const signatureFormatters = container.resolveAll(diAsnSignatureFormatter).reverse();\n        let signature = null;\n        for (const signatureFormatter of signatureFormatters) {\n            signature = signatureFormatter.toWebSignature(algorithm, this.signature);\n            if (signature) {\n                break;\n            }\n        }\n        if (!signature) {\n            throw Error(\"Cannot convert WebCrypto signature value to ASN.1 format\");\n        }\n        const ok = await crypto.subtle.verify(this.signatureAlgorithm, publicKey, signature, this.tbs);\n        return ok;\n    }\n    toTextObject() {\n        const obj = this.toTextObjectEmpty();\n        const req = AsnConvert.parse(this.rawData, CertificationRequest);\n        const tbs = req.certificationRequestInfo;\n        const data = new TextObject(\"\", {\n            \"Version\": `${Version[tbs.version]} (${tbs.version})`,\n            \"Subject\": this.subject,\n            \"Subject Public Key Info\": this.publicKey,\n        });\n        if (this.attributes.length) {\n            const attrs = new TextObject(\"\");\n            for (const ext of this.attributes) {\n                const attrObj = ext.toTextObject();\n                attrs[attrObj[TextObject.NAME]] = attrObj;\n            }\n            data[\"Attributes\"] = attrs;\n        }\n        obj[\"Data\"] = data;\n        obj[\"Signature\"] = new TextObject(\"\", {\n            \"Algorithm\": TextConverter.serializeAlgorithm(req.signatureAlgorithm),\n            \"\": req.signature,\n        });\n        return obj;\n    }\n}\nPkcs10CertificateRequest.NAME = \"PKCS#10 Certificate Request\";\n\nclass Pkcs10CertificateRequestGenerator {\n    static async create(params, crypto = cryptoProvider.get()) {\n        if (!params.keys.privateKey) {\n            throw new Error(\"Bad field 'keys' in 'params' argument. 'privateKey' is empty\");\n        }\n        if (!params.keys.publicKey) {\n            throw new Error(\"Bad field 'keys' in 'params' argument. 'publicKey' is empty\");\n        }\n        const spki = await crypto.subtle.exportKey(\"spki\", params.keys.publicKey);\n        const asnReq = new CertificationRequest({\n            certificationRequestInfo: new CertificationRequestInfo({\n                subjectPKInfo: AsnConvert.parse(spki, SubjectPublicKeyInfo),\n            }),\n        });\n        if (params.name) {\n            const name = params.name instanceof Name\n                ? params.name\n                : new Name(params.name);\n            asnReq.certificationRequestInfo.subject = AsnConvert.parse(name.toArrayBuffer(), Name$1);\n        }\n        if (params.attributes) {\n            for (const o of params.attributes) {\n                asnReq.certificationRequestInfo.attributes.push(AsnConvert.parse(o.rawData, Attribute$1));\n            }\n        }\n        if (params.extensions && params.extensions.length) {\n            const attr = new Attribute$1({ type: id_pkcs9_at_extensionRequest });\n            const extensions = new Extensions();\n            for (const o of params.extensions) {\n                extensions.push(AsnConvert.parse(o.rawData, Extension$1));\n            }\n            attr.values.push(AsnConvert.serialize(extensions));\n            asnReq.certificationRequestInfo.attributes.push(attr);\n        }\n        const signingAlgorithm = { ...params.signingAlgorithm, ...params.keys.privateKey.algorithm };\n        const algProv = container.resolve(diAlgorithmProvider);\n        asnReq.signatureAlgorithm = algProv.toAsnAlgorithm(signingAlgorithm);\n        const tbs = AsnConvert.serialize(asnReq.certificationRequestInfo);\n        const signature = await crypto.subtle.sign(signingAlgorithm, params.keys.privateKey, tbs);\n        const signatureFormatters = container.resolveAll(diAsnSignatureFormatter).reverse();\n        let asnSignature = null;\n        for (const signatureFormatter of signatureFormatters) {\n            asnSignature = signatureFormatter.toAsnSignature(signingAlgorithm, signature);\n            if (asnSignature) {\n                break;\n            }\n        }\n        if (!asnSignature) {\n            throw Error(\"Cannot convert WebCrypto signature value to ASN.1 format\");\n        }\n        asnReq.signature = asnSignature;\n        return new Pkcs10CertificateRequest(AsnConvert.serialize(asnReq));\n    }\n}\n\nclass X509Certificate extends PemData {\n    constructor(param) {\n        if (PemData.isAsnEncoded(param)) {\n            super(param, Certificate);\n        }\n        else {\n            super(param);\n        }\n        this.tag = PemConverter.CertificateTag;\n    }\n    onInit(asn) {\n        const tbs = asn.tbsCertificate;\n        this.tbs = AsnConvert.serialize(tbs);\n        this.serialNumber = Convert.ToHex(tbs.serialNumber);\n        this.subjectName = new Name(tbs.subject);\n        this.subject = new Name(tbs.subject).toString();\n        this.issuerName = new Name(tbs.issuer);\n        this.issuer = this.issuerName.toString();\n        const algProv = container.resolve(diAlgorithmProvider);\n        this.signatureAlgorithm = algProv.toWebAlgorithm(asn.signatureAlgorithm);\n        this.signature = asn.signatureValue;\n        const notBefore = tbs.validity.notBefore.utcTime || tbs.validity.notBefore.generalTime;\n        if (!notBefore) {\n            throw new Error(\"Cannot get 'notBefore' value\");\n        }\n        this.notBefore = notBefore;\n        const notAfter = tbs.validity.notAfter.utcTime || tbs.validity.notAfter.generalTime;\n        if (!notAfter) {\n            throw new Error(\"Cannot get 'notAfter' value\");\n        }\n        this.notAfter = notAfter;\n        this.extensions = [];\n        if (tbs.extensions) {\n            this.extensions = tbs.extensions.map(o => ExtensionFactory.create(AsnConvert.serialize(o)));\n        }\n        this.publicKey = new PublicKey(tbs.subjectPublicKeyInfo);\n    }\n    getExtension(type) {\n        for (const ext of this.extensions) {\n            if (typeof type === \"string\") {\n                if (ext.type === type) {\n                    return ext;\n                }\n            }\n            else {\n                if (ext instanceof type) {\n                    return ext;\n                }\n            }\n        }\n        return null;\n    }\n    getExtensions(type) {\n        return this.extensions.filter(o => {\n            if (typeof type === \"string\") {\n                return o.type === type;\n            }\n            else {\n                return o instanceof type;\n            }\n        });\n    }\n    async verify(params = {}, crypto = cryptoProvider.get()) {\n        let keyAlgorithm;\n        let publicKey;\n        const paramsKey = params.publicKey;\n        try {\n            if (!paramsKey) {\n                keyAlgorithm = { ...this.publicKey.algorithm, ...this.signatureAlgorithm };\n                publicKey = await this.publicKey.export(keyAlgorithm, [\"verify\"], crypto);\n            }\n            else if (\"publicKey\" in paramsKey) {\n                keyAlgorithm = { ...paramsKey.publicKey.algorithm, ...this.signatureAlgorithm };\n                publicKey = await paramsKey.publicKey.export(keyAlgorithm, [\"verify\"], crypto);\n            }\n            else if (paramsKey instanceof PublicKey) {\n                keyAlgorithm = { ...paramsKey.algorithm, ...this.signatureAlgorithm };\n                publicKey = await paramsKey.export(keyAlgorithm, [\"verify\"], crypto);\n            }\n            else if (BufferSourceConverter.isBufferSource(paramsKey)) {\n                const key = new PublicKey(paramsKey);\n                keyAlgorithm = { ...key.algorithm, ...this.signatureAlgorithm };\n                publicKey = await key.export(keyAlgorithm, [\"verify\"], crypto);\n            }\n            else {\n                keyAlgorithm = { ...paramsKey.algorithm, ...this.signatureAlgorithm };\n                publicKey = paramsKey;\n            }\n        }\n        catch (e) {\n            return false;\n        }\n        const signatureFormatters = container.resolveAll(diAsnSignatureFormatter).reverse();\n        let signature = null;\n        for (const signatureFormatter of signatureFormatters) {\n            signature = signatureFormatter.toWebSignature(keyAlgorithm, this.signature);\n            if (signature) {\n                break;\n            }\n        }\n        if (!signature) {\n            throw Error(\"Cannot convert ASN.1 signature value to WebCrypto format\");\n        }\n        const ok = await crypto.subtle.verify(this.signatureAlgorithm, publicKey, signature, this.tbs);\n        if (params.signatureOnly) {\n            return ok;\n        }\n        else {\n            const date = params.date || new Date();\n            const time = date.getTime();\n            return ok && this.notBefore.getTime() < time && time < this.notAfter.getTime();\n        }\n    }\n    async getThumbprint(...args) {\n        let crypto;\n        let algorithm = \"SHA-1\";\n        if (args[0]) {\n            if (!args[0].subtle) {\n                algorithm = args[0] || algorithm;\n                crypto = args[1];\n            }\n            else {\n                crypto = args[0];\n            }\n        }\n        crypto !== null && crypto !== void 0 ? crypto : (crypto = cryptoProvider.get());\n        return await crypto.subtle.digest(algorithm, this.rawData);\n    }\n    async isSelfSigned(crypto = cryptoProvider.get()) {\n        return this.subject === this.issuer && await this.verify({ signatureOnly: true }, crypto);\n    }\n    toTextObject() {\n        const obj = this.toTextObjectEmpty();\n        const cert = AsnConvert.parse(this.rawData, Certificate);\n        const tbs = cert.tbsCertificate;\n        const data = new TextObject(\"\", {\n            \"Version\": `${Version[tbs.version]} (${tbs.version})`,\n            \"Serial Number\": tbs.serialNumber,\n            \"Signature Algorithm\": TextConverter.serializeAlgorithm(tbs.signature),\n            \"Issuer\": this.issuer,\n            \"Validity\": new TextObject(\"\", {\n                \"Not Before\": tbs.validity.notBefore.getTime(),\n                \"Not After\": tbs.validity.notAfter.getTime(),\n            }),\n            \"Subject\": this.subject,\n            \"Subject Public Key Info\": this.publicKey,\n        });\n        if (tbs.issuerUniqueID) {\n            data[\"Issuer Unique ID\"] = tbs.issuerUniqueID;\n        }\n        if (tbs.subjectUniqueID) {\n            data[\"Subject Unique ID\"] = tbs.subjectUniqueID;\n        }\n        if (this.extensions.length) {\n            const extensions = new TextObject(\"\");\n            for (const ext of this.extensions) {\n                const extObj = ext.toTextObject();\n                extensions[extObj[TextObject.NAME]] = extObj;\n            }\n            data[\"Extensions\"] = extensions;\n        }\n        obj[\"Data\"] = data;\n        obj[\"Signature\"] = new TextObject(\"\", {\n            \"Algorithm\": TextConverter.serializeAlgorithm(cert.signatureAlgorithm),\n            \"\": cert.signatureValue,\n        });\n        return obj;\n    }\n}\nX509Certificate.NAME = \"Certificate\";\n\nclass X509Certificates extends Array {\n    constructor(param) {\n        super();\n        if (PemData.isAsnEncoded(param)) {\n            this.import(param);\n        }\n        else if (param instanceof X509Certificate) {\n            this.push(param);\n        }\n        else if (Array.isArray(param)) {\n            for (const item of param) {\n                this.push(item);\n            }\n        }\n    }\n    export(format) {\n        const signedData = new asn1Cms.SignedData();\n        signedData.version = 1;\n        signedData.encapContentInfo.eContentType = asn1Cms.id_data;\n        signedData.encapContentInfo.eContent = new asn1Cms.EncapsulatedContent({\n            single: new OctetString(),\n        });\n        signedData.certificates = new asn1Cms.CertificateSet(this.map(o => new asn1Cms.CertificateChoices({\n            certificate: AsnConvert.parse(o.rawData, Certificate)\n        })));\n        const cms = new asn1Cms.ContentInfo({\n            contentType: asn1Cms.id_signedData,\n            content: AsnConvert.serialize(signedData),\n        });\n        const raw = AsnConvert.serialize(cms);\n        if (format === \"raw\") {\n            return raw;\n        }\n        return this.toString(format);\n    }\n    import(data) {\n        const raw = PemData.toArrayBuffer(data);\n        const cms = AsnConvert.parse(raw, asn1Cms.ContentInfo);\n        if (cms.contentType !== asn1Cms.id_signedData) {\n            throw new TypeError(\"Cannot parse CMS package. Incoming data is not a SignedData object.\");\n        }\n        const signedData = AsnConvert.parse(cms.content, asn1Cms.SignedData);\n        this.clear();\n        for (const item of signedData.certificates || []) {\n            if (item.certificate) {\n                this.push(new X509Certificate(item.certificate));\n            }\n        }\n    }\n    clear() {\n        while (this.pop()) {\n        }\n    }\n    toString(format = \"pem\") {\n        const raw = this.export(\"raw\");\n        switch (format) {\n            case \"pem\":\n                return PemConverter.encode(raw, \"CMS\");\n            case \"pem-chain\":\n                return this\n                    .map(o => o.toString(\"pem\"))\n                    .join(\"\\n\");\n            case \"asn\":\n                return AsnConvert.toString(raw);\n            case \"hex\":\n                return Convert.ToHex(raw);\n            case \"base64\":\n                return Convert.ToBase64(raw);\n            case \"base64url\":\n                return Convert.ToBase64Url(raw);\n            case \"text\":\n                return TextConverter.serialize(this.toTextObject());\n            default:\n                throw TypeError(\"Argument 'format' is unsupported value\");\n        }\n    }\n    toTextObject() {\n        const contentInfo = AsnConvert.parse(this.export(\"raw\"), asn1Cms.ContentInfo);\n        const signedData = AsnConvert.parse(contentInfo.content, asn1Cms.SignedData);\n        const obj = new TextObject(\"X509Certificates\", {\n            \"Content Type\": OidSerializer.toString(contentInfo.contentType),\n            \"Content\": new TextObject(\"\", {\n                \"Version\": `${asn1Cms.CMSVersion[signedData.version]} (${signedData.version})`,\n                \"Certificates\": new TextObject(\"\", { \"Certificate\": this.map(o => o.toTextObject()) }),\n            }),\n        });\n        return obj;\n    }\n}\n\nclass X509ChainBuilder {\n    constructor(params = {}) {\n        this.certificates = [];\n        if (params.certificates) {\n            this.certificates = params.certificates;\n        }\n    }\n    async build(cert, crypto = cryptoProvider.get()) {\n        const chain = new X509Certificates(cert);\n        let current = cert;\n        while (current = await this.findIssuer(current, crypto)) {\n            const thumbprint = await current.getThumbprint(crypto);\n            for (const item of chain) {\n                const thumbprint2 = await item.getThumbprint(crypto);\n                if (isEqual(thumbprint, thumbprint2)) {\n                    throw new Error(\"Cannot build a certificate chain. Circular dependency.\");\n                }\n            }\n            chain.push(current);\n        }\n        return chain;\n    }\n    async findIssuer(cert, crypto = cryptoProvider.get()) {\n        if (!await cert.isSelfSigned(crypto)) {\n            const akiExt = cert.getExtension(asn1X509.id_ce_authorityKeyIdentifier);\n            for (const item of this.certificates) {\n                if (item.subject !== cert.issuer) {\n                    continue;\n                }\n                if (akiExt) {\n                    if (akiExt.keyId) {\n                        const skiExt = item.getExtension(asn1X509.id_ce_subjectKeyIdentifier);\n                        if (skiExt && skiExt.keyId !== akiExt.keyId) {\n                            continue;\n                        }\n                    }\n                    else if (akiExt.certId) {\n                        const sanExt = item.getExtension(asn1X509.id_ce_subjectAltName);\n                        if (sanExt &&\n                            !(akiExt.certId.serialNumber === item.serialNumber && isEqual(AsnConvert.serialize(akiExt.certId.name), AsnConvert.serialize(sanExt)))) {\n                            continue;\n                        }\n                    }\n                }\n                try {\n                    const algorithm = { ...item.publicKey.algorithm, ...cert.signatureAlgorithm };\n                    const publicKey = await item.publicKey.export(algorithm, [\"verify\"], crypto);\n                    const ok = await cert.verify({ publicKey, signatureOnly: true }, crypto);\n                    if (!ok) {\n                        continue;\n                    }\n                }\n                catch (e) {\n                    continue;\n                }\n                return item;\n            }\n        }\n        return null;\n    }\n}\n\nclass X509CertificateGenerator {\n    static async createSelfSigned(params, crypto = cryptoProvider.get()) {\n        if (!params.keys.privateKey) {\n            throw new Error(\"Bad field 'keys' in 'params' argument. 'privateKey' is empty\");\n        }\n        if (!params.keys.publicKey) {\n            throw new Error(\"Bad field 'keys' in 'params' argument. 'publicKey' is empty\");\n        }\n        return this.create({\n            serialNumber: params.serialNumber,\n            subject: params.name,\n            issuer: params.name,\n            notBefore: params.notBefore,\n            notAfter: params.notAfter,\n            publicKey: params.keys.publicKey,\n            signingKey: params.keys.privateKey,\n            signingAlgorithm: params.signingAlgorithm,\n            extensions: params.extensions,\n        }, crypto);\n    }\n    static async create(params, crypto = cryptoProvider.get()) {\n        var _a;\n        let spki;\n        if (params.publicKey instanceof PublicKey) {\n            spki = params.publicKey.rawData;\n        }\n        else if (\"publicKey\" in params.publicKey) {\n            spki = params.publicKey.publicKey.rawData;\n        }\n        else if (BufferSourceConverter.isBufferSource(params.publicKey)) {\n            spki = params.publicKey;\n        }\n        else {\n            spki = await crypto.subtle.exportKey(\"spki\", params.publicKey);\n        }\n        const serialNumber = params.serialNumber\n            ? BufferSourceConverter.toUint8Array(Convert.FromHex(params.serialNumber))\n            : crypto.getRandomValues(new Uint8Array(16));\n        if (serialNumber[0] > 0x7F) {\n            serialNumber[0] &= 0x7F;\n        }\n        if (serialNumber.length > 1 && serialNumber[0] === 0) {\n            serialNumber[1] |= 0x80;\n        }\n        const notBefore = params.notBefore || new Date();\n        const notAfter = params.notAfter || new Date(notBefore.getTime() + 31536000000);\n        const asnX509 = new asn1X509.Certificate({\n            tbsCertificate: new asn1X509.TBSCertificate({\n                version: asn1X509.Version.v3,\n                serialNumber: serialNumber,\n                validity: new asn1X509.Validity({\n                    notBefore,\n                    notAfter,\n                }),\n                extensions: new asn1X509.Extensions(((_a = params.extensions) === null || _a === void 0 ? void 0 : _a.map(o => AsnConvert.parse(o.rawData, asn1X509.Extension))) || []),\n                subjectPublicKeyInfo: AsnConvert.parse(spki, asn1X509.SubjectPublicKeyInfo),\n            }),\n        });\n        if (params.subject) {\n            const name = params.subject instanceof Name\n                ? params.subject\n                : new Name(params.subject);\n            asnX509.tbsCertificate.subject = AsnConvert.parse(name.toArrayBuffer(), asn1X509.Name);\n        }\n        if (params.issuer) {\n            const name = params.issuer instanceof Name\n                ? params.issuer\n                : new Name(params.issuer);\n            asnX509.tbsCertificate.issuer = AsnConvert.parse(name.toArrayBuffer(), asn1X509.Name);\n        }\n        const defaultSigningAlgorithm = {\n            hash: \"SHA-256\",\n        };\n        const signatureAlgorithm = (\"signingKey\" in params)\n            ? { ...defaultSigningAlgorithm, ...params.signingAlgorithm, ...params.signingKey.algorithm }\n            : { ...defaultSigningAlgorithm, ...params.signingAlgorithm };\n        const algProv = container.resolve(diAlgorithmProvider);\n        asnX509.tbsCertificate.signature = asnX509.signatureAlgorithm = algProv.toAsnAlgorithm(signatureAlgorithm);\n        const tbs = AsnConvert.serialize(asnX509.tbsCertificate);\n        const signatureValue = (\"signingKey\" in params)\n            ? await crypto.subtle.sign(signatureAlgorithm, params.signingKey, tbs)\n            : params.signature;\n        const signatureFormatters = container.resolveAll(diAsnSignatureFormatter).reverse();\n        let asnSignature = null;\n        for (const signatureFormatter of signatureFormatters) {\n            asnSignature = signatureFormatter.toAsnSignature(signatureAlgorithm, signatureValue);\n            if (asnSignature) {\n                break;\n            }\n        }\n        if (!asnSignature) {\n            throw Error(\"Cannot convert ASN.1 signature value to WebCrypto format\");\n        }\n        asnX509.signatureValue = asnSignature;\n        return new X509Certificate(AsnConvert.serialize(asnX509));\n    }\n}\n\nvar X509CrlReason;\n(function (X509CrlReason) {\n    X509CrlReason[X509CrlReason[\"unspecified\"] = 0] = \"unspecified\";\n    X509CrlReason[X509CrlReason[\"keyCompromise\"] = 1] = \"keyCompromise\";\n    X509CrlReason[X509CrlReason[\"cACompromise\"] = 2] = \"cACompromise\";\n    X509CrlReason[X509CrlReason[\"affiliationChanged\"] = 3] = \"affiliationChanged\";\n    X509CrlReason[X509CrlReason[\"superseded\"] = 4] = \"superseded\";\n    X509CrlReason[X509CrlReason[\"cessationOfOperation\"] = 5] = \"cessationOfOperation\";\n    X509CrlReason[X509CrlReason[\"certificateHold\"] = 6] = \"certificateHold\";\n    X509CrlReason[X509CrlReason[\"removeFromCRL\"] = 8] = \"removeFromCRL\";\n    X509CrlReason[X509CrlReason[\"privilegeWithdrawn\"] = 9] = \"privilegeWithdrawn\";\n    X509CrlReason[X509CrlReason[\"aACompromise\"] = 10] = \"aACompromise\";\n})(X509CrlReason || (X509CrlReason = {}));\nclass X509CrlEntry extends AsnData {\n    constructor(...args) {\n        let raw;\n        if (BufferSourceConverter.isBufferSource(args[0])) {\n            raw = BufferSourceConverter.toArrayBuffer(args[0]);\n        }\n        else {\n            raw = AsnConvert.serialize(new RevokedCertificate({\n                userCertificate: args[0],\n                revocationDate: new Time(args[1]),\n                crlEntryExtensions: args[2],\n            }));\n        }\n        super(raw, RevokedCertificate);\n    }\n    onInit(asn) {\n        this.serialNumber = Convert.ToHex(asn.userCertificate);\n        this.revocationDate = asn.revocationDate.getTime();\n        this.extensions = [];\n        if (asn.crlEntryExtensions) {\n            this.extensions = asn.crlEntryExtensions.map((o) => {\n                const extension = ExtensionFactory.create(AsnConvert.serialize(o));\n                switch (extension.type) {\n                    case id_ce_cRLReasons:\n                        this.reason = AsnConvert.parse(extension.value, CRLReason).reason;\n                        break;\n                    case id_ce_invalidityDate:\n                        this.invalidity = AsnConvert.parse(extension.value, InvalidityDate).value;\n                        break;\n                }\n                return extension;\n            });\n        }\n    }\n}\n\nclass X509Crl extends PemData {\n    constructor(param) {\n        if (PemData.isAsnEncoded(param)) {\n            super(param, CertificateList);\n        }\n        else {\n            super(param);\n        }\n        this.tag = PemConverter.CrlTag;\n    }\n    onInit(asn) {\n        var _a, _b;\n        const tbs = asn.tbsCertList;\n        this.tbs = AsnConvert.serialize(tbs);\n        this.version = tbs.version;\n        const algProv = container.resolve(diAlgorithmProvider);\n        this.signatureAlgorithm = algProv.toWebAlgorithm(asn.signatureAlgorithm);\n        this.tbsCertListSignatureAlgorithm = tbs.signature;\n        this.certListSignatureAlgorithm = asn.signatureAlgorithm;\n        this.signature = asn.signature;\n        this.issuerName = new Name(tbs.issuer);\n        this.issuer = this.issuerName.toString();\n        const thisUpdate = tbs.thisUpdate.getTime();\n        if (!thisUpdate) {\n            throw new Error(\"Cannot get 'thisUpdate' value\");\n        }\n        this.thisUpdate = thisUpdate;\n        const nextUpdate = (_a = tbs.nextUpdate) === null || _a === void 0 ? void 0 : _a.getTime();\n        this.nextUpdate = nextUpdate;\n        this.entries = ((_b = tbs.revokedCertificates) === null || _b === void 0 ? void 0 : _b.map(o => new X509CrlEntry(AsnConvert.serialize(o)))) || [];\n        this.extensions = [];\n        if (tbs.crlExtensions) {\n            this.extensions = tbs.crlExtensions.map((o) => ExtensionFactory.create(AsnConvert.serialize(o)));\n        }\n    }\n    getExtension(type) {\n        for (const ext of this.extensions) {\n            if (typeof type === \"string\") {\n                if (ext.type === type) {\n                    return ext;\n                }\n            }\n            else {\n                if (ext instanceof type) {\n                    return ext;\n                }\n            }\n        }\n        return null;\n    }\n    getExtensions(type) {\n        return this.extensions.filter((o) => {\n            if (typeof type === \"string\") {\n                return o.type === type;\n            }\n            else {\n                return o instanceof type;\n            }\n        });\n    }\n    async verify(params, crypto = cryptoProvider.get()) {\n        if (!this.certListSignatureAlgorithm.isEqual(this.tbsCertListSignatureAlgorithm)) {\n            throw new Error(\"algorithm identifier in the sequence tbsCertList and CertificateList mismatch\");\n        }\n        let keyAlgorithm;\n        let publicKey;\n        const paramsKey = params.publicKey;\n        try {\n            if (paramsKey instanceof X509Certificate) {\n                keyAlgorithm = {\n                    ...paramsKey.publicKey.algorithm,\n                    ...paramsKey.signatureAlgorithm,\n                };\n                publicKey = await paramsKey.publicKey.export(keyAlgorithm, [\"verify\"]);\n            }\n            else if (paramsKey instanceof PublicKey) {\n                keyAlgorithm = { ...paramsKey.algorithm, ...this.signature };\n                publicKey = await paramsKey.export(keyAlgorithm, [\"verify\"]);\n            }\n            else {\n                keyAlgorithm = { ...paramsKey.algorithm, ...this.signature };\n                publicKey = paramsKey;\n            }\n        }\n        catch (e) {\n            return false;\n        }\n        const signatureFormatters = container.resolveAll(diAsnSignatureFormatter).reverse();\n        let signature = null;\n        for (const signatureFormatter of signatureFormatters) {\n            signature = signatureFormatter.toWebSignature(keyAlgorithm, this.signature);\n            if (signature) {\n                break;\n            }\n        }\n        if (!signature) {\n            throw Error(\"Cannot convert ASN.1 signature value to WebCrypto format\");\n        }\n        return await crypto.subtle.verify(this.signatureAlgorithm, publicKey, signature, this.tbs);\n    }\n    async getThumbprint(...args) {\n        let crypto;\n        let algorithm = \"SHA-1\";\n        if (args[0]) {\n            if (!args[0].subtle) {\n                algorithm = args[0] || algorithm;\n                crypto = args[1];\n            }\n            else {\n                crypto = args[0];\n            }\n        }\n        crypto !== null && crypto !== void 0 ? crypto : (crypto = cryptoProvider.get());\n        return await crypto.subtle.digest(algorithm, this.rawData);\n    }\n    findRevoked(certOrSerialNumber) {\n        const serialNumber = typeof certOrSerialNumber === \"string\" ? certOrSerialNumber : certOrSerialNumber.serialNumber;\n        for (const entry of this.entries) {\n            if (entry.serialNumber === serialNumber) {\n                return entry;\n            }\n        }\n        return null;\n    }\n}\n\nclass X509CrlGenerator {\n    static async create(params, crypto = cryptoProvider.get()) {\n        var _a;\n        const name = params.issuer instanceof Name\n            ? params.issuer\n            : new Name(params.issuer);\n        const asnX509Crl = new asn1X509.CertificateList({\n            tbsCertList: new asn1X509.TBSCertList({\n                version: asn1X509.Version.v2,\n                issuer: AsnConvert.parse(name.toArrayBuffer(), asn1X509.Name),\n                thisUpdate: new Time(params.thisUpdate || new Date()),\n            }),\n        });\n        if (params.nextUpdate) {\n            asnX509Crl.tbsCertList.nextUpdate = new Time(params.nextUpdate);\n        }\n        if (params.extensions && params.extensions.length) {\n            asnX509Crl.tbsCertList.crlExtensions = new asn1X509.Extensions(params.extensions.map(o => AsnConvert.parse(o.rawData, asn1X509.Extension)) || []);\n        }\n        if (params.entries && params.entries.length) {\n            asnX509Crl.tbsCertList.revokedCertificates = [];\n            for (const entry of params.entries) {\n                const userCertificate = PemData.toArrayBuffer(entry.serialNumber);\n                const index = asnX509Crl.tbsCertList.revokedCertificates.findIndex(cert => isEqual(cert.userCertificate, userCertificate));\n                if (index > -1) {\n                    throw new Error(`Certificate serial number ${entry.serialNumber} already exists in tbsCertList`);\n                }\n                const revokedCert = new RevokedCertificate({\n                    userCertificate: userCertificate,\n                    revocationDate: new Time(entry.revocationDate || new Date())\n                });\n                if (\"extensions\" in entry && ((_a = entry.extensions) === null || _a === void 0 ? void 0 : _a.length)) {\n                    revokedCert.crlEntryExtensions = entry.extensions.map(o => AsnConvert.parse(o.rawData, asn1X509.Extension));\n                }\n                else {\n                    revokedCert.crlEntryExtensions = [];\n                }\n                if (!(entry instanceof X509CrlEntry)) {\n                    if (entry.reason) {\n                        revokedCert.crlEntryExtensions.push(new asn1X509.Extension({\n                            extnID: asn1X509.id_ce_cRLReasons,\n                            critical: false,\n                            extnValue: new OctetString(AsnConvert.serialize(new asn1X509.CRLReason(entry.reason))),\n                        }));\n                    }\n                    if (entry.invalidity) {\n                        revokedCert.crlEntryExtensions.push(new asn1X509.Extension({\n                            extnID: asn1X509.id_ce_invalidityDate,\n                            critical: false,\n                            extnValue: new OctetString(AsnConvert.serialize(new asn1X509.InvalidityDate(entry.invalidity))),\n                        }));\n                    }\n                    if (entry.issuer) {\n                        const name = params.issuer instanceof Name\n                            ? params.issuer\n                            : new Name(params.issuer);\n                        revokedCert.crlEntryExtensions.push(new asn1X509.Extension({\n                            extnID: asn1X509.id_ce_certificateIssuer,\n                            critical: false,\n                            extnValue: new OctetString(AsnConvert.serialize(AsnConvert.parse(name.toArrayBuffer(), asn1X509.Name))),\n                        }));\n                    }\n                }\n                asnX509Crl.tbsCertList.revokedCertificates.push(revokedCert);\n            }\n        }\n        const signingAlgorithm = { ...params.signingAlgorithm, ...params.signingKey.algorithm };\n        const algProv = container.resolve(diAlgorithmProvider);\n        asnX509Crl.tbsCertList.signature = asnX509Crl.signatureAlgorithm = algProv.toAsnAlgorithm(signingAlgorithm);\n        const tbs = AsnConvert.serialize(asnX509Crl.tbsCertList);\n        const signature = await crypto.subtle.sign(signingAlgorithm, params.signingKey, tbs);\n        const signatureFormatters = container.resolveAll(diAsnSignatureFormatter).reverse();\n        let asnSignature = null;\n        for (const signatureFormatter of signatureFormatters) {\n            asnSignature = signatureFormatter.toAsnSignature(signingAlgorithm, signature);\n            if (asnSignature) {\n                break;\n            }\n        }\n        if (!asnSignature) {\n            throw Error(\"Cannot convert ASN.1 signature value to WebCrypto format\");\n        }\n        asnX509Crl.signature = asnSignature;\n        return new X509Crl(AsnConvert.serialize(asnX509Crl));\n    }\n}\n\nExtensionFactory.register(asn1X509.id_ce_basicConstraints, BasicConstraintsExtension);\nExtensionFactory.register(asn1X509.id_ce_extKeyUsage, ExtendedKeyUsageExtension);\nExtensionFactory.register(asn1X509.id_ce_keyUsage, KeyUsagesExtension);\nExtensionFactory.register(asn1X509.id_ce_subjectKeyIdentifier, SubjectKeyIdentifierExtension);\nExtensionFactory.register(asn1X509.id_ce_authorityKeyIdentifier, AuthorityKeyIdentifierExtension);\nExtensionFactory.register(asn1X509.id_ce_subjectAltName, SubjectAlternativeNameExtension);\nExtensionFactory.register(asn1X509.id_ce_cRLDistributionPoints, CRLDistributionPointsExtension);\nExtensionFactory.register(asn1X509.id_pe_authorityInfoAccess, AuthorityInfoAccessExtension);\nAttributeFactory.register(asnPkcs9.id_pkcs9_at_challengePassword, ChallengePasswordAttribute);\nAttributeFactory.register(asnPkcs9.id_pkcs9_at_extensionRequest, ExtensionsAttribute);\ncontainer.registerSingleton(diAsnSignatureFormatter, AsnDefaultSignatureFormatter);\ncontainer.registerSingleton(diAsnSignatureFormatter, AsnEcSignatureFormatter);\nAsnEcSignatureFormatter.namedCurveSize.set(\"P-256\", 32);\nAsnEcSignatureFormatter.namedCurveSize.set(\"K-256\", 32);\nAsnEcSignatureFormatter.namedCurveSize.set(\"P-384\", 48);\nAsnEcSignatureFormatter.namedCurveSize.set(\"P-521\", 66);\n\nexport { AlgorithmProvider, AsnData, AsnDefaultSignatureFormatter, AsnEcSignatureFormatter, Attribute, AttributeFactory, AuthorityInfoAccessExtension, AuthorityKeyIdentifierExtension, BasicConstraintsExtension, CRLDistributionPointsExtension, CertificatePolicyExtension, ChallengePasswordAttribute, CryptoProvider, DefaultAlgorithmSerializer, EcAlgorithm, EdAlgorithm, ExtendedKeyUsage, ExtendedKeyUsageExtension, Extension, ExtensionFactory, ExtensionsAttribute, GeneralName, GeneralNames, KeyUsageFlags, KeyUsagesExtension, Name, NameIdentifier, OidSerializer, PemConverter, Pkcs10CertificateRequest, Pkcs10CertificateRequestGenerator, PublicKey, RsaAlgorithm, ShaAlgorithm, SubjectAlternativeNameExtension, SubjectKeyIdentifierExtension, TextConverter, TextObject, X509Certificate, X509CertificateGenerator, X509Certificates, X509ChainBuilder, X509Crl, X509CrlEntry, X509CrlGenerator, X509CrlReason, cryptoProvider, diAlgorithm, diAlgorithmProvider, diAsnSignatureFormatter, idEd25519, idEd448, idX25519, idX448 };\n","'use strict';\n\nconst { isType, isUserType, isDecodeType } = require('lib/util');\nconst BinaryStream = require('lib/binary-stream');\nconst symbols = require('internal/symbols');\nconst Metadata = require('internal/meta');\n\nmodule.exports = {\n  decode,\n  decodeCommon,\n};\n\n/**\n * Decode any data from provided stream using schema.\n * @param {BinaryStream} rstream Read stream to decode.\n * @param {Object} typeOrSchema Builtin data type or schema.\n * @returns {*}\n */\nfunction decode(rstream, typeOrSchema) {\n  let decodeStream = rstream;\n\n  if (Buffer.isBuffer(rstream)) {\n    decodeStream = new BinaryStream();\n    decodeStream.append(rstream);\n  }\n\n  const meta = new Metadata();\n  const value = decodeCommon(decodeStream, typeOrSchema, meta);\n\n  decode.bytes = meta.bytes;\n  Metadata.clean(meta);\n\n  return value;\n}\n\n/**\n * @private\n * @param {BinaryStream|Buffer} rstream\n * @param {Object} typeOrSchema\n * @param {Metadata} meta\n * @returns {*}\n */\nfunction decodeCommon(rstream, typeOrSchema, meta) {\n  if (isType(typeOrSchema)) {\n    const value = typeOrSchema.decode.call(meta, rstream);\n    meta[symbols.bytes] += typeOrSchema.decode.bytes;\n    return value;\n  }\n\n  return decodeSchema(rstream, typeOrSchema, meta);\n}\n\n/**\n * @private\n * @param {BinaryStream} rstream\n * @param {Object} schema\n * @param {Metadata} meta\n * @returns {Object}\n */\nfunction decodeSchema(rstream, schema, meta) {\n  assertSchema(schema);\n\n  const node = Object.create(null);\n\n  if (meta.node === undefined) {\n    meta.node = node;\n    meta.current = node;\n  } else {\n    meta.current = node;\n  }\n\n  const keys = Object.keys(schema);\n\n  for (let i = 0; i < keys.length; i += 1) {\n    const key = keys[i];\n    const type = schema[key];\n\n    if (!isDecodeType(type)) {\n      node[key] = decodeSchema(rstream, type, meta);\n      meta.current = node;\n      continue; // eslint-disable-line no-continue\n    }\n\n    const value = type.decode.call(meta, rstream);\n    meta[symbols.bytes] += type.decode.bytes;\n\n    if (type[symbols.skip] === true) {\n      continue; // eslint-disable-line no-continue\n    }\n\n    node[key] = value;\n  }\n\n  return node;\n}\n\n/**\n * Check if argument is schema.\n * @param {Object} schema\n * @private\n */\nfunction assertSchema(schema) {\n  if (!isUserType(schema)) {\n    throw new TypeError('Argument #2 should be a plain object.');\n  }\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type { HashAlgorithms, SignatureAlgorithms } from \"../../cipher/const\";\n\nexport class Signature {\n  static type = 13;\n  static readonly spec = {\n    type: types.uint16be,\n    data: types.array(\n      { hash: types.uint8, signature: types.uint8 },\n      types.uint16be,\n      \"bytes\",\n    ),\n  };\n\n  public type: number = Signature.type;\n  public data: { hash: HashAlgorithms; signature: SignatureAlgorithms }[] = [];\n\n  constructor(props: Partial<Signature> = {}) {\n    Object.assign(this, props);\n  }\n\n  static createEmpty() {\n    const v = new Signature();\n    return v;\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new Signature(decode(buf, Signature.spec));\n  }\n\n  serialize() {\n    const res = encode(this, Signature.spec).slice();\n    return Buffer.from(res);\n  }\n\n  static fromData(buf: Buffer) {\n    const type = Buffer.alloc(2);\n    type.writeUInt16BE(Signature.type);\n    return Signature.deSerialize(Buffer.concat([type, buf]));\n  }\n\n  get extension() {\n    return {\n      type: this.type,\n      data: this.serialize().slice(2),\n    };\n  }\n}\n","import { Deferred } from \"@scrypted/common/src/deferred\";\nimport { addVideoFilterArguments } from \"@scrypted/common/src/ffmpeg-helpers\";\nimport { connectRTCSignalingClients, legacyGetSignalingSessionOptions } from \"@scrypted/common/src/rtc-signaling\";\nimport { getSpsPps, getSpsPpsVps, MSection } from \"@scrypted/common/src/sdp-utils\";\nimport sdk, { FFmpegInput, FFmpegTranscodeStream, Intercom, MediaObject, MediaStreamDestination, MediaStreamFeedback, RequestMediaStream, RTCAVSignalingSetup, RTCConnectionManagement, RTCInputMediaObjectTrack, RTCOutputMediaObjectTrack, RTCSignalingOptions, RTCSignalingSession, ScryptedInterface, ScryptedMimeTypes } from \"@scrypted/sdk\";\nimport { H264Repacketizer } from \"../../homekit/src/types/camera/h264-packetizer\";\nimport { OpusRepacketizer } from \"../../homekit/src/types/camera/opus-repacketizer\";\nimport { H265Repacketizer } from \"./h265-packetizer\";\nimport { logConnectionState, waitClosed, waitConnected, waitIceConnected } from \"./peerconnection-util\";\nimport { RtpCodecCopy, RtpTrack, RtpTracks, startRtpForwarderProcess } from \"./rtp-forwarders\";\nimport { ScryptedSessionControl } from \"./session-control\";\nimport { getAudioCodec, getFFmpegRtpAudioOutputArguments, optionalVideoCodec, opusAudioCodecOnly, requiredAudioCodecs, requiredVideoCodec } from \"./webrtc-required-codecs\";\nimport { MediaStreamTrack, PeerConfig, RTCPeerConnection, RTCRtpTransceiver, RtpPacket } from \"./werift\";\nimport { WeriftSignalingSession } from \"./werift-signaling-session\";\nimport { logIsLocalIceTransport } from \"./werift-util\";\n\nfunction getDebugModeH264EncoderArgs() {\n    return [\n        '-profile:v', 'baseline',\n        // ultrafast seems to have the lowest latency but forces constrained baseline\n        // so the prior argument is redundant. It actualy seems like decoding non-baseline\n        // on mac, at least, causes inherent latency which can't be flushed from upstream.\n        '-preset', 'ultrafast',\n        '-g', '60',\n        \"-c:v\", \"libx264\",\n        \"-bf\", \"0\",\n        // \"-tune\", \"zerolatency\",\n    ];\n}\n\nconst fullResolutionAllowList = [\n    'Windows',\n    'Macintosh',\n    'iPhone',\n    'iPad',\n    'iOS',\n];\n\nexport async function createTrackForwarder(options: {\n    timeStart: number,\n    isLocalNetwork: boolean, destinationId: string, ipv4: boolean, type: string,\n    requestMediaStream: RequestMediaStream,\n    videoTransceiver: RTCRtpTransceiver, audioTransceiver: RTCRtpTransceiver,\n    maximumCompatibilityMode: boolean, clientOptions: RTCSignalingOptions,\n}) {\n    const {\n        timeStart,\n        isLocalNetwork, destinationId, type,\n        requestMediaStream,\n        videoTransceiver, audioTransceiver,\n        maximumCompatibilityMode,\n        clientOptions,\n    } = options;\n\n    const { sessionSupportsH264High, transcodeWidth, isMediumResolution, width, height } = parseOptions(clientOptions);\n\n    let transcodeBaseline = maximumCompatibilityMode;\n    // const transcodeBaseline = !sessionSupportsH264High || maximumCompatibilityMode;\n    const handlesHighResolution = !isMediumResolution && !transcodeBaseline;\n\n    let requestDestination: MediaStreamDestination;\n    if (transcodeBaseline) {\n        requestDestination = 'medium-resolution';\n    }\n    else if (!isLocalNetwork) {\n        requestDestination = 'remote';\n    }\n\n    const hasH265Support = !!videoTransceiver?.codecs.find(codec => codec.mimeType === 'video/H265');\n\n    const mo = await requestMediaStream({\n        video: {\n            // prefer h264 if available\n            // todo: change this to h265 primary after some time to allow plugins to update to new\n            // alternateCodecs property.\n            codec: 'h264',\n            // allow h265 if supported\n            alternateCodecs: hasH265Support ? ['h265', 'h264'] : undefined,\n            width,\n            height,\n        },\n        audio: {\n            codec: 'opus',\n            alternateCodecs: ['opus', 'pcm_mulaw', 'pcm_alaw'],\n        },\n        adaptive: handlesHighResolution\n            ? {\n                codecSwitch: true,\n                pictureLoss: true,\n            }\n            : undefined,\n        destination: requestDestination,\n        destinationId,\n        tool: !handlesHighResolution ? 'ffmpeg' : 'scrypted',\n    });\n\n    if (!mo)\n        return;\n\n    let hasMediaStreamFeedback = false;\n    try {\n        const mediaStreamFeedback = await sdk.connectRPCObject(await sdk.mediaManager.convertMediaObject<MediaStreamFeedback>(mo, ScryptedMimeTypes.MediaStreamFeedback));\n        if (mediaStreamFeedback) {\n            videoTransceiver.sender.onRtcp.subscribe(rtcp => {\n                mediaStreamFeedback.onRtcp(rtcp.serialize());\n            });\n            hasMediaStreamFeedback = true;\n        }\n    }\n    catch (e) {\n    }\n\n    const console = sdk.deviceManager.getMixinConsole(mo.sourceId);\n    const ffmpegInput = await sdk.mediaManager.convertMediaObjectToJSON<FFmpegInput>(mo, ScryptedMimeTypes.FFmpegInput);\n    const { mediaStreamOptions } = ffmpegInput;\n\n    // this transcode fallback is for low power devices like the echo show that\n    // will crap out if fed a high resolution stream.\n    if (isMediumResolution && !transcodeBaseline) {\n        // don't transcode on cheapo windows laptops with tiny screens\n        // which are capable of handling high resolution streams.\n        // this transcode fallback should only be used on Linux devices.\n        // But it may not report itself as Linux, so do a non-Windows/Mac/iOS check.\n        let found = false;\n        for (const allow of fullResolutionAllowList) {\n            found ||= options?.clientOptions?.userAgent?.includes(allow);\n        }\n        if (!found) {\n            const width = ffmpegInput?.mediaStreamOptions?.video?.width;\n            transcodeBaseline = !width || width > 1280;\n        }\n    }\n\n    console.log('Client Stream Profile', {\n        transcodeBaseline,\n        sessionSupportsH264High,\n        maximumCompatibilityMode,\n        ...clientOptions,\n    });\n\n    const findAndSetCodec = (transceiver: RTCRtpTransceiver, mimeType: string) => {\n        const found = transceiver?.codecs.find(codec => codec.mimeType === mimeType);\n        if (found)\n            transceiver.sender.codec = found;\n        return found;\n    };\n\n    const codecMap = {\n        'audio/PCMU': 'pcm_mulaw',\n        'audio/PCMA': 'pcm_alaw',\n        'audio/opus': 'opus',\n        'video/H264': 'h264',\n        'video/H265': 'h265',\n    };\n\n    const codecReverseMap = {\n        'pcm_mulaw': 'audio/PCMU',\n        'pcm_alaw': 'audio/PCMA',\n        'opus': 'audio/opus',\n        'h264': 'video/H264',\n        'h265': 'video/H265',\n    }\n\n    let willNeedTranscode = mediaStreamOptions?.video?.codec !== 'h264';\n    if (!maximumCompatibilityMode) {\n        if (mediaStreamOptions?.audio?.codec === 'pcm_mulaw') {\n            findAndSetCodec(audioTransceiver, 'audio/PCMU');\n        }\n        else if (mediaStreamOptions?.audio?.codec === 'pcm_alaw') {\n            findAndSetCodec(audioTransceiver, 'audio/PCMA');\n        }\n\n        if (mediaStreamOptions?.video?.codec === 'h265') {\n            if (hasH265Support) {\n                findAndSetCodec(videoTransceiver, 'video/H265');\n                willNeedTranscode = false;\n            }\n        }\n    }\n\n    const { name: audioCodecName } = getAudioCodec(audioTransceiver.sender.codec);\n    let audioCodecCopy = maximumCompatibilityMode ? undefined : audioCodecName;\n\n    const videoTranscodeArguments: string[] = [];\n    const transcode = transcodeBaseline\n        || willNeedTranscode;\n\n    // let videoCodecCopy: RtpCodecCopy = transcode ? undefined : 'h264';\n    const compatibleH264 = !mediaStreamOptions?.video?.h264Info?.reserved30 && !mediaStreamOptions?.video?.h264Info?.reserved31;\n    let videoCodecCopy: RtpCodecCopy;\n    if (!transcode && compatibleH264) {\n        if (mediaStreamOptions?.video?.codec === 'h264')\n            videoCodecCopy = 'h264';\n        else if (mediaStreamOptions?.video?.codec === 'h265')\n            videoCodecCopy = 'h265';\n    }\n\n    if (ffmpegInput.mediaStreamOptions?.oobCodecParameters)\n        videoTranscodeArguments.push(\"-bsf:v\", \"dump_extra\");\n\n    if (transcode) {\n        const conservativeDefaultBitrate = isLocalNetwork ? 1000000 : 500000;\n        const bitrate = maximumCompatibilityMode ? conservativeDefaultBitrate : conservativeDefaultBitrate;\n        videoTranscodeArguments.push(\n            // this seems to cause issues with presets i think.\n            // '-level:v', '4.0',\n            \"-b:v\", bitrate.toString(),\n            \"-bufsize\", (2 * bitrate).toString(),\n            \"-maxrate\", bitrate.toString(),\n            '-r', '15',\n        );\n\n        const scaleFilter = `scale='min(${transcodeWidth},iw)':-2`;\n        addVideoFilterArguments(videoTranscodeArguments, scaleFilter);\n\n        if (transcodeBaseline) {\n            // baseline profile must use libx264, not sure other encoders properly support it.\n            videoTranscodeArguments.push(\n\n                ...getDebugModeH264EncoderArgs(),\n            );\n\n            // unable to find conditions to make this working properly.\n            // encoding results in chop if bitrate is not sufficient.\n            // this may need to be aligned with h264 level?\n            // or no bitrate hint?\n            // videoArgs.push('-tune', 'zerolatency');\n        }\n        else {\n            videoTranscodeArguments.push(...getDebugModeH264EncoderArgs());\n        }\n    }\n    else {\n        videoTranscodeArguments.push('-vcodec', 'copy')\n    }\n\n    const audioTranscodeArguments = getFFmpegRtpAudioOutputArguments(ffmpegInput.mediaStreamOptions?.audio, audioTransceiver.sender.codec, maximumCompatibilityMode);\n\n    let needPacketization = !!videoCodecCopy;\n    if (transcode) {\n        try {\n            const transcodeStream: FFmpegTranscodeStream = await sdk.mediaManager.convertMediaObject(mo, ScryptedMimeTypes.FFmpegTranscodeStream);\n            await transcodeStream({\n                videoTranscodeArguments,\n                audioTranscodeArguments,\n            });\n            videoTranscodeArguments.splice(0, videoTranscodeArguments.length);\n            videoCodecCopy = 'copy';\n            audioCodecCopy = 'copy';\n            // is this really necessary?\n            needPacketization = true;\n        }\n        catch (e) {\n        }\n    }\n\n    if (hasMediaStreamFeedback)\n        needPacketization = false;\n\n    let opusRepacketizer: OpusRepacketizer;\n    let lastPacketTs: number = 0;\n    const audioRtpTrack: RtpTrack = {\n        negotiate: async msection => {\n            if (!audioCodecCopy)\n                return false;\n            if (audioCodecCopy === 'copy')\n                return true;\n            if (msection.codec === 'opus')\n                return msection.rtpmap.clock === 48000;\n            if (msection.codec !== 'pcm_mulaw' && msection.codec !== 'pcm_alaw')\n                return false;\n            // alexa doesn't support these though they're required by webrtc spec...\n            if (msection.codec === 'pcm_mulaw' && !audioTransceiver.codecs.find(codec => codec.mimeType === 'audio/PCMU'))\n                return false;\n            if (msection.codec === 'pcm_alaw' && !audioTransceiver.codecs.find(codec => codec.mimeType === 'audio/PCMA'))\n                return false;\n            return msection.rtpmap.clock === 8000;\n        },\n        // codecCopy: audioCodecCopy,\n        alternateCodecs: ['opus', 'pcm_mulaw', 'pcm_alaw'],\n        onRtp: (buffer, codec) => {\n            if (false && audioTransceiver.sender.codec.mimeType?.toLowerCase() === \"audio/opus\") {\n                // this will use 3 20ms frames, 60ms. seems to work up to 6/120ms\n                if (!opusRepacketizer)\n                    opusRepacketizer = new OpusRepacketizer(3);\n                for (const rtp of opusRepacketizer.repacketize(RtpPacket.deSerialize(buffer))) {\n                    audioTransceiver.sender.sendRtp(rtp);\n                }\n            }\n            else {\n                if (codecMap[audioTransceiver.sender.codec.mimeType] !== codec)\n                    findAndSetCodec(audioTransceiver, codecReverseMap[codec]);\n                const rtp = RtpPacket.deSerialize(buffer);\n                const now = Date.now();\n                rtp.header.marker = now - lastPacketTs > 1000; // set the marker if it's been more than 1s since the last packet\n                rtp.header.payloadType = audioTransceiver.sender.codec.payloadType;\n                // pcm audio can be concatenated.\n                // hikvision seems to send 40ms duration packets, so 25 packets per second.\n                audioTransceiver.sender.sendRtp(rtp.serialize());\n                lastPacketTs = now;\n            }\n        },\n        encoderArguments: [\n            ...audioTranscodeArguments,\n        ],\n        firstPacket: rtp => {\n            const packet = RtpPacket.deSerialize(rtp);\n            audioTransceiver.sender.replaceRTP(packet.header, true);\n        },\n    };\n\n    // ipv4 mtu is 1500\n    // so max usable packet size is 1500 - tcp header - ip header\n    // 1500 - 20 - 20 = 1460.\n    // but set to 1440 just to be safe.\n    // 1/9/2023: bug report from eweber discovered that usable MTU on tmobile is 1424.\n    // additional consideration should be given whether to always enforce ipv6 mtu on\n    // non-local destination?\n    // const videoPacketSize = options.ipv4 ? 1424 : 1300;\n    // 1/9/2023:\n    // 1378 is what homekit requests, regardless of local or remote network.\n    // so setting 1378 as the fixed value seems wise, given apple probably has\n    // better knowledge of network capabilities, and also mirrors\n    // from my cursory research into ipv6, the MTU is no lesser than ipv4, in fact\n    // the min mtu is larger.\n    // 2024/06/20: webrtc MTU is typically 1200 as seen in chrome:\n    // https://groups.google.com/g/discuss-webrtc/c/gH5ysR3SoZI\n    // https://bloggeek.me/webrtcglossary/mtu-size/\n    // apparently this is due to guaranteeing reliability for weird networks.\n    // most of these networks can be correctly configured with an increased MTU (wireguard, tailscale),\n    // but others can not, like iCloud Private Relay.\n    // iCloud Private Relay ends up coming through TURN, as do many other restrictive networks.\n    // so when a turn (aka relay) server is used, a smaller MTU must be used. Otherwise optimistically use\n    // the normal/larger default.\n    // After a bit of fiddling with iCloud Private Relay, 1246 was arrived at as the optimal value.\n    // 2024/06/28: Setting to 1200 due to FirstNet.\n    // After further user testing, FirstNet MTU seems be around 1200, though advertised at 1342.\n    // So using Chrome's 1200 seems best, though crappy.\n    // https://iotdevices.att.com/att-iot/FirstNetMTU.aspx\n    const videoPacketSize = 1200;\n    let repacketizer: H264Repacketizer | H265Repacketizer;\n    let videoSection: MSection;\n\n    const videoRtpTrack: RtpTrack = {\n        codecCopy: videoCodecCopy,\n        alternateCodecs: hasH265Support ? ['h264', 'h265'] : undefined,\n        packetSize: videoPacketSize,\n        onMSection: (v) => videoSection = v,\n        onRtp: (buffer, codec) => {\n            let onRtp: typeof videoRtpTrack.onRtp;\n\n            if (needPacketization && !repacketizer) {\n                if (videoSection.codec === 'h264') {\n                    const spsPps = getSpsPps(videoSection);\n                    // adjust packet size for the rtp packet header (12).\n                    repacketizer = new H264Repacketizer(console, videoPacketSize - 12, {\n                        ...spsPps,\n                    });\n                }\n                else if (videoSection.codec === 'h265') {\n                    const spsPpsVps = getSpsPpsVps(videoSection);\n                    // adjust packet size for the rtp packet header (12).\n                    repacketizer = new H265Repacketizer(console, videoPacketSize - 12, {\n                        ...spsPpsVps,\n                    });\n                }\n\n                onRtp = (buffer, codec) => {\n                    if (codecMap[videoTransceiver.sender.codec.mimeType] !== codec)\n                        findAndSetCodec(videoTransceiver, codecReverseMap[codec]);\n                    const repacketized = repacketizer.repacketize(RtpPacket.deSerialize(buffer));\n                    for (const packet of repacketized) {\n                        videoTransceiver.sender.sendRtp(packet);\n                    }\n                };\n            }\n            else {\n                onRtp = (buffer, codec) => {\n                    if (codecMap[videoTransceiver.sender.codec.mimeType] !== codec)\n                        findAndSetCodec(videoTransceiver, codecReverseMap[codec]);\n                    videoTransceiver.sender.sendRtp(buffer);\n                };\n            }\n\n            videoRtpTrack.onRtp = onRtp;\n            videoRtpTrack.onRtp(buffer, codec);\n        },\n        encoderArguments: [\n            ...videoTranscodeArguments,\n        ],\n        firstPacket: rtp => {\n            console.log('first video packet', Date.now() - timeStart);\n            const packet = RtpPacket.deSerialize(rtp);\n            videoTransceiver.sender.replaceRTP(packet.header, true);\n        },\n    };\n\n    let tracks: RtpTracks;\n    if (ffmpegInput.mediaStreamOptions?.audio === null || !audioTransceiver) {\n        tracks = {\n            video: videoRtpTrack,\n        }\n    }\n    else if (ffmpegInput.mediaStreamOptions?.video === null || !videoTransceiver) {\n        tracks = {\n            audio: audioRtpTrack,\n        }\n    }\n    else {\n        tracks = {\n            video: videoRtpTrack,\n            audio: audioRtpTrack,\n        }\n    }\n\n    return startRtpForwarderProcess(console, ffmpegInput, tracks);\n}\n\n// https://en.wikipedia.org/wiki/Advanced_Video_Coding#Profiles\nconst highProfiles = [\n    100,\n    110,\n    122,\n    244,\n];\nconst highProfilesHex = highProfiles.map(p => p.toString(16));\n\nexport function parseOptions(options: RTCSignalingOptions) {\n    // should really inspect the session description here.\n    // we assume that the camera doesn't output h264 baseline, because\n    // that is awful quality. so check to see if the session has an\n    // explicit list of supported codecs with a passable h264 high on it.\n    let sessionSupportsH264High = !!options?.capabilities?.video?.codecs\n        ?.filter(codec => codec.mimeType.toLowerCase() === 'video/h264')\n        // 42 is baseline profile\n        // 64001f (chrome) or 640c1f (safari) is high profile.\n        // firefox only advertises 42e01f.\n        // nest hub max offers high 640015. this means the level (hex 15) is 2.1,\n        // this corresponds to a resolution of 480p according to the spec?\n        // https://en.wikipedia.org/wiki/Advanced_Video_Coding#Levels\n        // however, the 640x1f indicates a max resolution of 720p, but\n        // desktop browsers can handle 1080p+ fine regardless, since it does\n        // not actually seem to confirm the level. the level is merely a hint\n        // to make a rough guess as to the decoding capability of the client.\n        ?.find(codec => {\n            let sdpFmtpLine = codec.sdpFmtpLine.toLowerCase();\n            for (const hex of highProfilesHex) {\n                if (sdpFmtpLine.includes(`profile-level-id=${hex}`))\n                    return true;\n            }\n            return false;\n        });\n\n\n    // firefox is misleading. special case that to disable transcoding.\n    if (options?.userAgent?.includes('Firefox/'))\n        sessionSupportsH264High = true;\n\n    // Some devices return a `screen width` value that is not a multiple of 2, which is not allowed for the h264 codec.\n    // Convert to a smaller even value.\n    const screenWidthForTranscodeH264 = !options?.screen?.width\n        ? 960\n        : Math.trunc(options?.screen?.width / 2) * 2;\n\n    const transcodeWidth = Math.max(640, Math.min(screenWidthForTranscodeH264, 1280));\n    const devicePixelRatio = options?.screen?.devicePixelRatio || 1;\n    const width = (options?.screen?.width * devicePixelRatio) || undefined;\n    const height = (options?.screen?.height * devicePixelRatio) || undefined;\n    const max = Math.max(width, height);\n    const isMediumResolution = !sessionSupportsH264High || (max && max < 1920);\n\n    return {\n        sessionSupportsH264High,\n        transcodeWidth,\n        isMediumResolution,\n        width: isMediumResolution ? 1280 : width,\n        height: isMediumResolution ? 720 : height,\n    };\n}\n\nclass WebRTCTrack implements RTCOutputMediaObjectTrack, RTCInputMediaObjectTrack {\n    control: ScryptedSessionControl;\n    removed = new Deferred<void>();\n\n    constructor(public connectionManagement: WebRTCConnectionManagement, public video: RTCRtpTransceiver, public audio: RTCRtpTransceiver, intercom: Intercom) {\n        this.control = new ScryptedSessionControl(intercom, audio);\n        this.connectionManagement.activeTracks.add(this);\n    }\n\n    async onStop(): Promise<void> {\n        return this.removed.promise;\n    }\n\n    attachForwarder(f: Awaited<ReturnType<typeof createTrackForwarder>>) {\n        const stopped = this.removed;\n        f.killPromise.then(() => stopped.resolve(undefined)).catch(e => stopped.reject(e));\n    }\n\n    async replace(mediaObject: MediaObject): Promise<void> {\n        const { createTrackForwarder, intercom } = await this.connectionManagement.createTracks(mediaObject);\n\n        this.cleanup(true);\n\n        this.removed = new Deferred();\n        this.control = new ScryptedSessionControl(intercom, this.audio);\n\n        const f = await createTrackForwarder(this.video, this.audio);\n        this.attachForwarder(f);\n        waitClosed(this.connectionManagement.pc).finally(() => f.kill());\n        this.removed.promise.finally(() => f.kill());\n    }\n\n    cleanup(cleanupTrackOnly: boolean) {\n        if (this.removed.finished)\n            return;\n        this.removed.resolve(undefined);\n        this.control.endSession();\n        this.video.sender.onRtcp.allUnsubscribe();\n\n        if (cleanupTrackOnly)\n            return;\n\n        this.connectionManagement.activeTracks.delete(this);\n        this.video.stop();\n        this.audio.stop();\n        this.connectionManagement.pc.removeTrack(this.video.sender);\n        this.connectionManagement.pc.removeTrack(this.audio.sender);\n    }\n\n    async stop(): Promise<void> {\n        return this.cleanup(false);\n    }\n\n    setPlayback(options: { audio: boolean; video: boolean; }): Promise<MediaObject> {\n        return this.control.setPlaybackInternal(options);\n    }\n}\n\nexport class WebRTCConnectionManagement implements RTCConnectionManagement {\n    pc: RTCPeerConnection;\n    private negotiationDeferred = new Deferred<void>();\n    weriftSignalingSession: WeriftSignalingSession;\n    activeTracks = new Set<WebRTCTrack>();\n    closed = false;\n\n    constructor(public console: Console, public clientSession: RTCSignalingSession,\n        public requireOpus: boolean,\n        public maximumCompatibilityMode: boolean,\n        public clientOptions: RTCSignalingOptions,\n        public options: {\n            configuration: RTCConfiguration,\n            weriftConfiguration: Partial<PeerConfig>,\n        }) {\n\n        this.pc = new RTCPeerConnection({\n            // werift supports ice servers, but it seems to fail for some reason.\n            // it does not matter, as we can send the ice servers to the browser instead.\n            // the cameras and alexa targets will also provide externally reachable addresses.\n            codecs: {\n                audio: [\n                    ...(requireOpus ? opusAudioCodecOnly : requiredAudioCodecs),\n                ],\n                video: [\n                    requiredVideoCodec,\n                    optionalVideoCodec,\n                ],\n            },\n            ...options.weriftConfiguration,\n        });\n        logConnectionState(console, this.pc);\n        waitConnected(this.pc)\n            .then(() => logIsLocalIceTransport(this.console, this.pc)).catch(() => { });\n\n        this.weriftSignalingSession = new WeriftSignalingSession(console, this.pc);\n    }\n\n    async probe() {\n    }\n\n    async createTracks(mediaObject: MediaObject) {\n        let requestMediaStream: RequestMediaStream;\n\n        try {\n            requestMediaStream = await sdk.connectRPCObject(await sdk.mediaManager.convertMediaObject(mediaObject, ScryptedMimeTypes.RequestMediaStream));\n        }\n        catch (e) {\n            mediaObject = await sdk.connectRPCObject(mediaObject);\n            requestMediaStream = async () => mediaObject;\n        }\n\n        const wrapped: RequestMediaStream = async options => {\n            if (!requestMediaStream)\n                throw new Error(\"RequestMediaStream can't be called twice\");\n            const rms = requestMediaStream;\n            requestMediaStream = undefined;\n            const mo = rms(options);\n            return sdk.connectRPCObject(mo);\n        }\n\n        let intercom = sdk.systemManager.getDeviceById<Intercom>(mediaObject.sourceId);\n        if (!intercom.interfaces?.includes(ScryptedInterface.Intercom))\n            intercom = undefined;\n\n        const vtrack = new MediaStreamTrack({\n            kind: \"video\",\n        });\n\n        const atrack = new MediaStreamTrack({ kind: \"audio\" });\n        const console = sdk.deviceManager.getMixinConsole(mediaObject.sourceId);\n\n        const timeStart = Date.now();\n\n        return {\n            vtrack,\n            atrack,\n            intercom,\n            createTrackForwarder: async (videoTransceiver: RTCRtpTransceiver, audioTransceiver: RTCRtpTransceiver) => {\n                const ret = await createTrackForwarder({\n                    timeStart,\n                    ...logIsLocalIceTransport(console, this.pc),\n                    requestMediaStream: wrapped,\n                    videoTransceiver,\n                    audioTransceiver,\n                    maximumCompatibilityMode: this.maximumCompatibilityMode,\n                    clientOptions: this.clientOptions,\n                });\n                return ret;\n            },\n        }\n    }\n\n    get negotiation() {\n        if (this.negotiationDeferred.finished)\n            this.negotiationDeferred = new Deferred();\n        return this.negotiationDeferred.promise;\n    }\n\n    async negotiateRTCSignalingSession() {\n        return this.negotiateRTCSignalingSessionInternal({\n            configuration: this.options?.configuration,\n        });\n    }\n\n    async negotiateRTCSignalingSessionInternal(clientSetup: Partial<RTCAVSignalingSetup>, clientOffer?: boolean): Promise<void> {\n        try {\n            if (clientOffer) {\n                await connectRTCSignalingClients(this.console,\n                    this.clientSession, clientSetup,\n                    this.weriftSignalingSession, {});\n            }\n            else {\n                await connectRTCSignalingClients(this.console,\n                    this.weriftSignalingSession, {},\n                    this.clientSession, clientSetup,\n                );\n            }\n            this.negotiationDeferred.resolve(undefined);\n        }\n        catch (e) {\n            this.console.error('negotiation failed', e);\n            this.negotiationDeferred.reject(e);\n            throw e;\n        }\n    }\n\n    async addTrack(mediaObject: MediaObject, options?: {\n        videoMid?: string,\n        audioMid?: string,\n        videoDirection?: 'sendrecv' | 'sendonly' | 'recvonly',\n        audioDirection?: 'sendrecv' | 'sendonly' | 'recvonly',\n    }) {\n        const { atrack, vtrack, createTrackForwarder, intercom } = await this.createTracks(mediaObject);\n\n        // no support for 2 way video yet.\n        const videoDirection = 'sendonly';\n        let audioDirection = options?.audioDirection || 'sendrecv';\n        if (!intercom) {\n            audioDirection = 'sendonly';\n        }\n\n        const videoTransceiver = this.pc.addTransceiver(vtrack, {\n            direction: videoDirection,\n        });\n\n        videoTransceiver.mid = options?.videoMid;\n\n        const audioTransceiver = this.pc.addTransceiver(atrack, {\n            direction: audioDirection,\n        });\n        audioTransceiver.mid = options?.audioMid;\n\n        const ret = new WebRTCTrack(this, videoTransceiver, audioTransceiver, intercom);\n\n        this.negotiation.then(async () => {\n            try {\n                this.console.log('waiting ice connected');\n                if (this.pc.remoteIsBundled)\n                    await waitConnected(this.pc);\n                else\n                    await waitIceConnected(this.pc);\n                if (ret.removed.finished)\n                    return;\n                this.console.log('done waiting ice connected');\n                const f = await createTrackForwarder(videoTransceiver, audioTransceiver);\n                ret.attachForwarder(f);\n                waitClosed(this.pc).finally(() => f?.kill());\n                ret.removed.promise.finally(() => f?.kill());\n            }\n            catch (e) {\n                this.console.error('Error starting playback for WebRTC track.', e);\n                ret.cleanup(false);\n            }\n        });\n\n        return ret;\n    }\n\n    async connectRPCObject(o: any) {\n        // this should never actually be called as the client side should call the getParam version.\n        return sdk.connectRPCObject(o);\n    }\n\n    async close(): Promise<void> {\n        for (const track of this.activeTracks) {\n            track.cleanup(false);\n        }\n        this.activeTracks.clear();\n        this.pc.close();\n    }\n\n    async waitClosed() {\n        await waitClosed(this.pc);\n    }\n\n    async waitConnected() {\n        await waitIceConnected(this.pc);\n        await waitConnected(this.pc);\n    }\n}\n\nexport async function createRTCPeerConnectionSink(\n    clientSignalingSession: RTCSignalingSession,\n    console: Console,\n    audioDirection: 'sendrecv' | 'sendonly' | 'recvonly',\n    mo: MediaObject,\n    requireOpus: boolean,\n    maximumCompatibilityMode: boolean,\n    configuration: RTCConfiguration,\n    weriftConfiguration: Partial<PeerConfig>,\n    clientOffer = true,\n) {\n    const clientOptions = await legacyGetSignalingSessionOptions(clientSignalingSession);\n    // console.log('remote options', clientOptions);\n\n    const connection = new WebRTCConnectionManagement(console, clientSignalingSession, requireOpus, maximumCompatibilityMode, clientOptions, {\n        configuration,\n        weriftConfiguration,\n    });\n\n    const track = await connection.addTrack(mo, {\n        audioDirection,\n    });\n\n    track.control.killed.promise.then(() => {\n        track.cleanup(false);\n        connection.pc.close();\n    });\n\n    const setup: Partial<RTCAVSignalingSetup> = {\n        audio: {\n            direction: audioDirection,\n        },\n        video: {\n            direction: 'recvonly',\n        },\n        configuration,\n    };\n\n    connection.negotiateRTCSignalingSessionInternal(setup, clientOffer);\n\n    return track.control;\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type { Handshake } from \"../../../typings/domain\";\nimport { ProtocolVersion } from \"../../binary\";\nimport { HandshakeType } from \"../../const\";\n\n// 4.2.1.  Denial-of-Service Countermeasures\n\nexport class ServerHelloVerifyRequest implements Handshake {\n  msgType = HandshakeType.hello_verify_request_3;\n  messageSeq?: number;\n  static readonly spec = {\n    serverVersion: ProtocolVersion,\n    cookie: types.buffer(types.uint8),\n  };\n\n  constructor(\n    public serverVersion: { major: number; minor: number },\n    public cookie: Buffer,\n  ) {}\n\n  static createEmpty() {\n    return new ServerHelloVerifyRequest(undefined as any, undefined as any);\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new ServerHelloVerifyRequest(\n      //@ts-ignore\n      ...Object.values(decode(buf, ServerHelloVerifyRequest.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, ServerHelloVerifyRequest.spec).slice();\n    return Buffer.from(res);\n  }\n\n  get version() {\n    return {\n      major: 255 - this.serverVersion.major,\n      minor: 255 - this.serverVersion.minor,\n    };\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","import { randomUUID } from \"crypto\";\n\nimport type { RTCDataChannel } from \"./dataChannel\";\nimport { EventTarget, enumerate } from \"./helper\";\nimport {\n  type Address,\n  Event,\n  type InterfaceAddresses,\n  debug,\n} from \"./imports/common\";\nimport type { CandidatePair, Message, Protocol } from \"./imports/ice\";\nimport {\n  type MediaStream,\n  type MediaStreamTrack,\n  type RTCRtpCodecParameters,\n  type RTCRtpHeaderExtensionParameters,\n  type RTCRtpReceiver,\n  type RTCRtpSender,\n  type RTCRtpTransceiver,\n  RtpRouter,\n  TransceiverManager,\n  type TransceiverOptions,\n  useOPUS,\n  usePCMU,\n  useVP8,\n} from \"./media\";\nimport {\n  type RTCPeerConnectionStats,\n  type RTCStats,\n  RTCStatsReport,\n  generateStatsId,\n  getStatsTimestamp,\n} from \"./media/stats\";\nimport { SctpTransportManager } from \"./sctpManager\";\nimport {\n  type BundlePolicy,\n  type MediaDescription,\n  SessionDescription,\n} from \"./sdp\";\nimport { type RTCSessionDescriptionInit, SDPManager } from \"./sdpManager\";\nimport { SecureTransportManager } from \"./secureTransportManager\";\nimport type { DtlsKeys, RTCDtlsTransport } from \"./transport/dtls\";\nimport type {\n  IceGathererState,\n  RTCIceCandidate,\n  RTCIceCandidateInit,\n  RTCIceConnectionState,\n  RTCIceTransport,\n} from \"./transport/ice\";\nimport type { ConnectionState, Kind, RTCSignalingState } from \"./types/domain\";\nimport type { Callback, CallbackWithValue } from \"./types/util\";\nimport { andDirection, deepMerge } from \"./utils\";\n\nconst log = debug(\"werift:packages/webrtc/src/peerConnection.ts\");\n\nexport class RTCPeerConnection extends EventTarget {\n  readonly cname = randomUUID().toString();\n\n  config: Required<PeerConfig> = generateDefaultPeerConfig();\n  signalingState: RTCSignalingState = \"stable\";\n  negotiationneeded = false;\n  needRestart = false;\n  private readonly router = new RtpRouter();\n  private readonly sdpManager: SDPManager;\n  private readonly transceiverManager: TransceiverManager;\n  private readonly sctpManager: SctpTransportManager;\n  private readonly secureManager: SecureTransportManager;\n  private isClosed = false;\n  private shouldNegotiationneeded = false;\n\n  readonly iceGatheringStateChange = new Event<[IceGathererState]>();\n  readonly iceConnectionStateChange = new Event<[RTCIceConnectionState]>();\n  readonly signalingStateChange = new Event<[RTCSignalingState]>();\n  readonly connectionStateChange = new Event<[ConnectionState]>();\n  readonly onDataChannel = new Event<[RTCDataChannel]>();\n  readonly onRemoteTransceiverAdded = new Event<[RTCRtpTransceiver]>();\n  readonly onTransceiverAdded = new Event<[RTCRtpTransceiver]>();\n  readonly onIceCandidate = new Event<[RTCIceCandidate | undefined]>();\n  readonly onNegotiationneeded = new Event<[]>();\n  readonly onTrack = new Event<[MediaStreamTrack]>();\n\n  ondatachannel?: CallbackWithValue<RTCDataChannelEvent>;\n  onicecandidate?: CallbackWithValue<RTCPeerConnectionIceEvent>;\n  onicecandidateerror?: CallbackWithValue<any>;\n  onicegatheringstatechange?: CallbackWithValue<any>;\n  onnegotiationneeded?: CallbackWithValue<any>;\n  onsignalingstatechange?: CallbackWithValue<any>;\n  ontrack?: CallbackWithValue<RTCTrackEvent>;\n  onconnectionstatechange?: Callback;\n  oniceconnectionstatechange?: Callback;\n\n  constructor(config: Partial<PeerConfig> = {}) {\n    super();\n\n    this.setConfiguration(config);\n\n    this.sdpManager = new SDPManager({\n      cname: this.cname,\n      bundlePolicy: this.config.bundlePolicy,\n    });\n    this.transceiverManager = new TransceiverManager(\n      this.cname,\n      this.config,\n      this.router,\n    );\n    this.transceiverManager.onTransceiverAdded.pipe(this.onTransceiverAdded);\n    this.transceiverManager.onRemoteTransceiverAdded.pipe(\n      this.onRemoteTransceiverAdded,\n    );\n    this.transceiverManager.onTrack.subscribe(\n      ({ track, stream, transceiver }) => {\n        const event: RTCTrackEvent = {\n          track,\n          streams: [stream],\n          transceiver,\n          receiver: transceiver.receiver,\n        };\n        this.onTrack.execute(track);\n        this.emit(\"track\", event);\n        if (this.ontrack) {\n          this.ontrack(event);\n        }\n      },\n    );\n    this.transceiverManager.onNegotiationNeeded.subscribe(() =>\n      this.needNegotiation(),\n    );\n    this.sctpManager = new SctpTransportManager();\n    this.sctpManager.onDataChannel.subscribe((channel) => {\n      this.onDataChannel.execute(channel);\n      const event: RTCDataChannelEvent = { channel };\n      this.ondatachannel?.(event);\n      this.emit(\"datachannel\", event);\n    });\n    this.secureManager = new SecureTransportManager({\n      config: this.config,\n      sctpManager: this.sctpManager,\n      transceiverManager: this.transceiverManager,\n    });\n    this.secureManager.iceGatheringStateChange.pipe(\n      this.iceGatheringStateChange,\n    );\n    this.secureManager.iceConnectionStateChange.subscribe((state) => {\n      if (state === \"closed\") {\n        this.close();\n      }\n      this.iceConnectionStateChange.execute(state);\n    });\n    this.secureManager.connectionStateChange.subscribe((state) => {\n      this.connectionStateChange.execute(state);\n      this.onconnectionstatechange?.();\n      this.emit(\"connectionstatechange\");\n    });\n    this.secureManager.onIceCandidate.subscribe((candidate) => {\n      const iceCandidate = candidate ? candidate.toJSON() : undefined;\n      this.onIceCandidate.execute(iceCandidate);\n      this.onicecandidate?.({ candidate: iceCandidate });\n      this.emit(\"icecandidate\", { candidate: iceCandidate });\n    });\n  }\n\n  get connectionState() {\n    return this.secureManager.connectionState;\n  }\n  get iceConnectionState() {\n    return this.secureManager.iceConnectionState;\n  }\n  get iceGathererState() {\n    return this.secureManager.iceGatheringState;\n  }\n  get iceGatheringState() {\n    return this.secureManager.iceGatheringState;\n  }\n  get dtlsTransports() {\n    return this.secureManager.dtlsTransports;\n  }\n  get sctpTransport() {\n    return this.sctpManager.sctpTransport;\n  }\n  get sctpRemotePort() {\n    return this.sctpManager.sctpRemotePort;\n  }\n  get iceTransports() {\n    return this.secureManager.iceTransports;\n  }\n  get extIdUriMap() {\n    return this.router.extIdUriMap;\n  }\n  get iceGeneration() {\n    return this.iceTransports[0].connection.generation;\n  }\n  get localDescription() {\n    return this.sdpManager.localDescription;\n  }\n  get remoteDescription() {\n    return this.sdpManager.remoteDescription;\n  }\n  get remoteIsBundled() {\n    return this.sdpManager.remoteIsBundled;\n  }\n  /**@private */\n  get _localDescription() {\n    return this.sdpManager._localDescription;\n  }\n  /**@private */\n  get _remoteDescription() {\n    return this.sdpManager._remoteDescription;\n  }\n\n  getTransceivers() {\n    return this.transceiverManager.getTransceivers();\n  }\n\n  getSenders(): RTCRtpSender[] {\n    return this.transceiverManager.getSenders();\n  }\n\n  getReceivers() {\n    return this.transceiverManager.getReceivers();\n  }\n\n  setConfiguration(config: Partial<PeerConfig>) {\n    deepMerge(this.config, config);\n\n    if (this.config.icePortRange) {\n      const [min, max] = this.config.icePortRange;\n      if (min === max) throw new Error(\"should not be same value\");\n      if (min >= max) throw new Error(\"The min must be less than max\");\n    }\n\n    for (const [i, codecParams] of enumerate([\n      ...(this.config.codecs.audio || []),\n      ...(this.config.codecs.video || []),\n    ])) {\n      if (codecParams.payloadType != undefined) {\n        continue;\n      }\n\n      codecParams.payloadType = 96 + i;\n      switch (codecParams.name.toLowerCase()) {\n        case \"rtx\":\n          {\n            codecParams.parameters = `apt=${codecParams.payloadType - 1}`;\n          }\n          break;\n        case \"red\":\n          {\n            if (codecParams.contentType === \"audio\") {\n              const redundant = codecParams.payloadType + 1;\n              codecParams.parameters = `${redundant}/${redundant}`;\n              codecParams.payloadType = 63;\n            }\n          }\n          break;\n      }\n    }\n\n    [\n      ...(this.config.headerExtensions.audio || []),\n      ...(this.config.headerExtensions.video || []),\n    ].forEach((v, i) => {\n      v.id = 1 + i;\n    });\n  }\n\n  getConfiguration() {\n    return this.config;\n  }\n\n  async createOffer({ iceRestart }: { iceRestart?: boolean } = {}) {\n    if (iceRestart || this.needRestart) {\n      this.needRestart = false;\n      this.secureManager.restartIce();\n    }\n\n    await this.secureManager.ensureCerts();\n\n    for (const transceiver of this.transceiverManager.getTransceivers()) {\n      if (transceiver.codecs.length === 0) {\n        this.transceiverManager.assignTransceiverCodecs(transceiver);\n      }\n      if (transceiver.headerExtensions.length === 0) {\n        transceiver.headerExtensions =\n          this.config.headerExtensions[transceiver.kind] ?? [];\n      }\n    }\n\n    const description = this.sdpManager.buildOfferSdp(\n      this.transceiverManager.getTransceivers(),\n      this.sctpTransport,\n    );\n    return description.toJSON();\n  }\n\n  private createSctpTransport() {\n    const sctp = this.sctpManager.createSctpTransport();\n    const dtlsTransport = this.findOrCreateTransport();\n    sctp.setDtlsTransport(dtlsTransport);\n    return sctp;\n  }\n\n  createDataChannel(\n    label: string,\n    options: Partial<{\n      maxPacketLifeTime?: number;\n      protocol: string;\n      maxRetransmits?: number;\n      ordered: boolean;\n      negotiated: boolean;\n      id?: number;\n    }> = {},\n  ): RTCDataChannel {\n    if (!this.sctpTransport) {\n      this.createSctpTransport();\n      this.needNegotiation();\n    }\n\n    const channel = this.sctpManager.createDataChannel(label, options);\n    if (!channel.sctp.dtlsTransport) {\n      const dtlsTransport = this.findOrCreateTransport();\n      channel.sctp.setDtlsTransport(dtlsTransport);\n    }\n    return channel;\n  }\n\n  removeTrack(sender: RTCRtpSender) {\n    if (this.isClosed) {\n      throw new Error(\"peer closed\");\n    }\n    this.transceiverManager.removeTrack(sender);\n    this.needNegotiation();\n  }\n\n  private needNegotiation = async () => {\n    this.shouldNegotiationneeded = true;\n    if (this.negotiationneeded || this.signalingState !== \"stable\") {\n      return;\n    }\n    this.shouldNegotiationneeded = false;\n    setImmediate(() => {\n      this.negotiationneeded = true;\n      this.onNegotiationneeded.execute();\n      if (this.onnegotiationneeded) this.onnegotiationneeded({});\n    });\n  };\n\n  private findOrCreateTransport() {\n    const [existing] = this.iceTransports;\n\n    // Gather ICE candidates for only one track. If the remote endpoint is not bundle-aware, negotiate only one media track.\n    // https://w3c.github.io/webrtc-pc/#rtcbundlepolicy-enum\n    if (\n      this.sdpManager.bundlePolicy === \"max-bundle\" ||\n      (this.sdpManager.bundlePolicy !== \"disable\" && this.remoteIsBundled)\n    ) {\n      if (existing) {\n        return this.dtlsTransports[0];\n      }\n    }\n\n    const dtlsTransport = this.secureManager.createTransport();\n    dtlsTransport.onRtp.subscribe((rtp) => {\n      this.router.routeRtp(rtp);\n    });\n    dtlsTransport.onRtcp.subscribe((rtcp) => {\n      this.router.routeRtcp(rtcp);\n    });\n    const iceTransport = dtlsTransport.iceTransport;\n\n    iceTransport.onNegotiationNeeded.subscribe(() => {\n      this.needNegotiation();\n    });\n    iceTransport.onIceCandidate.subscribe((candidate) => {\n      if (!this.localDescription) {\n        log(\"localDescription not found when ice candidate was gathered\");\n        return;\n      }\n      if (!candidate) {\n        this.sdpManager.setLocal(\n          this._localDescription!,\n          this.transceiverManager.getTransceivers(),\n          this.sctpTransport,\n        );\n        this.onIceCandidate.execute(undefined);\n        if (this.onicecandidate) {\n          this.onicecandidate({ candidate: undefined });\n        }\n        this.emit(\"icecandidate\", { candidate: undefined });\n        return;\n      }\n\n      if (!this._localDescription) {\n        log(\"localDescription not found when ice candidate was gathered\");\n        return;\n      }\n\n      this.secureManager.handleNewIceCandidate({\n        candidate,\n        bundlePolicy: this.sdpManager.bundlePolicy,\n        remoteIsBundled: !!this.sdpManager.remoteIsBundled,\n        media: this._localDescription.media[0],\n        transceiver: this.transceiverManager\n          .getTransceivers()\n          .find((t) => t.dtlsTransport.iceTransport.id === iceTransport.id),\n        sctpTransport:\n          this.sctpTransport?.dtlsTransport.iceTransport.id === iceTransport.id\n            ? this.sctpTransport\n            : undefined,\n      });\n    });\n\n    return dtlsTransport;\n  }\n\n  async setLocalDescription(sessionDescription?: {\n    type: \"offer\" | \"answer\";\n    sdp: string;\n  }): Promise<SessionDescription> {\n    // https://developer.mozilla.org/en-US/docs/Web/API/RTCPeerConnection/setLocalDescription#type\n    const implicitOfferState: RTCSignalingState[] = [\n      \"stable\",\n      \"have-local-offer\",\n      \"have-remote-pranswer\",\n    ];\n    sessionDescription =\n      sessionDescription ??\n      (implicitOfferState.includes(this.signalingState)\n        ? await this.createOffer()\n        : await this.createAnswer());\n\n    // # parse and validate description\n    const description = this.sdpManager.parseSdp({\n      sdp: sessionDescription.sdp,\n      isLocal: true,\n      signalingState: this.signalingState,\n      type: sessionDescription.type,\n    });\n\n    // # update signaling state\n    if (description.type === \"offer\") {\n      this.setSignalingState(\"have-local-offer\");\n    } else if (description.type === \"answer\") {\n      this.setSignalingState(\"stable\");\n    }\n\n    // # assign MID\n    for (const [i, media] of enumerate(description.media)) {\n      const mid = media.rtp.muxId!;\n      this.sdpManager.registerMid(mid);\n      if ([\"audio\", \"video\"].includes(media.kind)) {\n        const transceiver =\n          this.transceiverManager.getTransceiverByMLineIndex(i);\n        if (transceiver) {\n          transceiver.mid = mid;\n        }\n      }\n      if (media.kind === \"application\" && this.sctpTransport) {\n        this.sctpTransport.mid = mid;\n      }\n    }\n\n    // setup ice,dtls role\n    const role = description.media.find((media) => media.dtlsParams)?.dtlsParams\n      ?.role;\n\n    this.secureManager.setLocalRole({\n      type: description.type,\n      role,\n    });\n\n    // # configure direction\n    if ([\"answer\", \"pranswer\"].includes(description.type)) {\n      for (const t of this.transceiverManager.getTransceivers()) {\n        const direction = andDirection(t.direction, t.offerDirection);\n        t.setCurrentDirection(direction);\n      }\n    }\n\n    // for trickle ice\n    this.sdpManager.setLocal(\n      description,\n      this.transceiverManager.getTransceivers(),\n      this.sctpTransport,\n    );\n\n    await this.gatherCandidates().catch((e) => {\n      log(\"gatherCandidates failed\", e);\n    });\n\n    // connect transports\n    if (description.type === \"answer\") {\n      this.connect().catch((err) => {\n        log(\"connect failed\", err);\n        this.secureManager.setConnectionState(\"failed\");\n      });\n    }\n\n    this.sdpManager.setLocal(\n      description,\n      this.transceiverManager.getTransceivers(),\n      this.sctpTransport,\n    );\n\n    if (this.shouldNegotiationneeded) {\n      this.needNegotiation();\n    }\n\n    return description;\n  }\n\n  private async gatherCandidates() {\n    await this.secureManager.gatherCandidates(\n      !!this.sdpManager.remoteIsBundled,\n    );\n  }\n\n  async addIceCandidate(\n    candidateMessage: RTCIceCandidate | RTCIceCandidateInit,\n  ) {\n    const sdp = this.sdpManager.buildOfferSdp(\n      this.transceiverManager.getTransceivers(),\n      this.sctpTransport,\n    );\n    await this.secureManager.addIceCandidate(sdp, candidateMessage);\n  }\n\n  private async connect() {\n    log(\"start connect\");\n\n    const res = await Promise.allSettled(\n      this.dtlsTransports.map(async (dtlsTransport) => {\n        const { iceTransport } = dtlsTransport;\n        if (iceTransport.state === \"connected\") {\n          return;\n        }\n        const checkDtlsConnected = () => dtlsTransport.state === \"connected\";\n\n        if (checkDtlsConnected()) {\n          return;\n        }\n\n        this.secureManager.setConnectionState(\"connecting\");\n\n        await iceTransport.start().catch((err) => {\n          log(\"iceTransport.start failed\", err);\n          throw err;\n        });\n\n        if (checkDtlsConnected()) {\n          return;\n        }\n\n        await dtlsTransport.start().catch((err) => {\n          log(\"dtlsTransport.start failed\", err);\n          throw err;\n        });\n\n        if (\n          this.sctpTransport &&\n          this.sctpTransport.dtlsTransport.id === dtlsTransport.id\n        ) {\n          await this.sctpManager.connectSctp();\n        }\n      }),\n    );\n\n    if (res.find((r) => r.status === \"rejected\")) {\n      this.secureManager.setConnectionState(\"failed\");\n    } else {\n      this.secureManager.setConnectionState(\"connected\");\n    }\n  }\n\n  restartIce() {\n    this.needRestart = true;\n    this.needNegotiation();\n  }\n\n  async setRemoteDescription(sessionDescription: RTCSessionDescriptionInit) {\n    if (sessionDescription instanceof SessionDescription) {\n      sessionDescription = sessionDescription.toSdp();\n    }\n\n    // # parse and validate description\n    const remoteSdp = this.sdpManager.setRemoteDescription(\n      sessionDescription,\n      this.signalingState,\n    );\n\n    let bundleTransport: RTCDtlsTransport | undefined;\n\n    // # apply description\n\n    const matchTransceiverWithMedia = (\n      transceiver: RTCRtpTransceiver,\n      media: MediaDescription,\n    ) =>\n      transceiver.kind === media.kind &&\n      [undefined, media.rtp.muxId].includes(transceiver.mid);\n\n    let transports = remoteSdp.media.map((remoteMedia, i) => {\n      let dtlsTransport: RTCDtlsTransport;\n\n      if ([\"audio\", \"video\"].includes(remoteMedia.kind)) {\n        let transceiver = this.transceiverManager\n          .getTransceivers()\n          .find((t) => matchTransceiverWithMedia(t, remoteMedia));\n        if (!transceiver) {\n          // create remote transceiver\n          transceiver = this.addTransceiver(remoteMedia.kind, {\n            direction: \"recvonly\",\n          });\n          transceiver.mid = remoteMedia.rtp.muxId;\n          this.onRemoteTransceiverAdded.execute(transceiver);\n        } else {\n          if (transceiver.direction === \"inactive\" && transceiver.stopping) {\n            transceiver.stopped = true;\n\n            if (sessionDescription.type === \"answer\") {\n              transceiver.setCurrentDirection(\"inactive\");\n            }\n            return;\n          }\n        }\n\n        if (this.sdpManager.remoteIsBundled) {\n          if (!bundleTransport) {\n            bundleTransport = transceiver.dtlsTransport;\n          } else {\n            transceiver.setDtlsTransport(bundleTransport);\n          }\n        }\n\n        dtlsTransport = transceiver.dtlsTransport;\n\n        this.transceiverManager.setRemoteRTP(\n          transceiver,\n          remoteMedia,\n          remoteSdp.type,\n          i,\n        );\n      } else if (remoteMedia.kind === \"application\") {\n        let sctpTransport = this.sctpTransport;\n        if (!sctpTransport) {\n          sctpTransport = this.createSctpTransport();\n          sctpTransport.mid = remoteMedia.rtp.muxId;\n        }\n\n        if (this.sdpManager.remoteIsBundled) {\n          if (!bundleTransport) {\n            bundleTransport = sctpTransport.dtlsTransport;\n          } else {\n            sctpTransport.setDtlsTransport(bundleTransport);\n          }\n        }\n\n        dtlsTransport = sctpTransport.dtlsTransport;\n\n        this.sctpManager.setRemoteSCTP(remoteMedia, i);\n      } else {\n        throw new Error(\"invalid media kind\");\n      }\n\n      const iceTransport = dtlsTransport.iceTransport;\n\n      if (remoteMedia.iceParams) {\n        const renomination = !!this.sdpManager.inactiveRemoteMedia;\n        iceTransport.setRemoteParams(remoteMedia.iceParams, renomination);\n\n        // One agent full, one lite:  The full agent MUST take the controlling role, and the lite agent MUST take the controlled role\n        // RFC 8445 S6.1.1\n        if (remoteMedia.iceParams?.iceLite) {\n          iceTransport.connection.iceControlling = true;\n        }\n      }\n      if (remoteMedia.dtlsParams) {\n        dtlsTransport.setRemoteParams(remoteMedia.dtlsParams);\n      }\n\n      // # add ICE candidates\n      remoteMedia.iceCandidates.forEach(iceTransport.addRemoteCandidate);\n\n      if (remoteMedia.iceCandidatesComplete) {\n        iceTransport.addRemoteCandidate(undefined);\n      }\n\n      // # set DTLS role\n      if (remoteSdp.type === \"answer\" && remoteMedia.dtlsParams?.role) {\n        dtlsTransport.role =\n          remoteMedia.dtlsParams.role === \"client\" ? \"server\" : \"client\";\n      }\n      return iceTransport;\n    }) as RTCIceTransport[];\n\n    // filter out inactive transports\n    transports = transports.filter((iceTransport) => !!iceTransport);\n\n    const removedTransceivers = this.transceiverManager\n      .getTransceivers()\n      .filter(\n        (t) =>\n          remoteSdp.media.find((m) => matchTransceiverWithMedia(t, m)) ==\n          undefined,\n      );\n\n    if (sessionDescription.type === \"answer\") {\n      for (const transceiver of removedTransceivers) {\n        // todo: handle answer side transceiver removal work.\n        // event should trigger to notify media source to stop.\n        transceiver.stop();\n        transceiver.stopped = true;\n      }\n    }\n\n    if (remoteSdp.type === \"offer\") {\n      this.setSignalingState(\"have-remote-offer\");\n    } else if (remoteSdp.type === \"answer\") {\n      this.setSignalingState(\"stable\");\n    }\n\n    // connect transports\n    if (remoteSdp.type === \"answer\") {\n      log(\"caller start connect\");\n      this.connect().catch((err) => {\n        log(\"connect failed\", err);\n        this.secureManager.setConnectionState(\"failed\");\n      });\n    }\n\n    this.negotiationneeded = false;\n    if (this.shouldNegotiationneeded) {\n      this.needNegotiation();\n    }\n  }\n\n  addTransceiver(\n    trackOrKind: Kind | MediaStreamTrack,\n    options: Partial<TransceiverOptions> = {},\n  ) {\n    const dtlsTransport = this.findOrCreateTransport();\n    const transceiver = this.transceiverManager.addTransceiver(\n      trackOrKind,\n      dtlsTransport,\n      options,\n    );\n\n    this.secureManager.updateIceConnectionState();\n    this.needNegotiation();\n\n    return transceiver;\n  }\n\n  // todo fix\n  addTrack(\n    track: MediaStreamTrack,\n    /**todo impl */\n    ms?: MediaStream,\n  ): RTCRtpSender {\n    if (this.isClosed) {\n      throw new Error(\"is closed\");\n    }\n    const transceiver = this.transceiverManager.addTrack(track, ms);\n    if (!transceiver.dtlsTransport) {\n      const dtlsTransport = this.findOrCreateTransport();\n      transceiver.setDtlsTransport(dtlsTransport);\n    }\n    this.needNegotiation();\n    return transceiver.sender;\n  }\n\n  async createAnswer() {\n    this.assertNotClosed();\n\n    await this.secureManager.ensureCerts();\n\n    const description = this.sdpManager.buildAnswerSdp({\n      transceivers: this.transceiverManager.getTransceivers(),\n      sctpTransport: this.sctpTransport,\n      signalingState: this.signalingState,\n    });\n    return description.toJSON();\n  }\n\n  private assertNotClosed() {\n    if (this.isClosed) {\n      throw new Error(\"RTCPeerConnection is closed\");\n    }\n  }\n\n  private setSignalingState(state: RTCSignalingState) {\n    log(\"signalingStateChange\", state);\n    this.signalingState = state;\n    this.signalingStateChange.execute(state);\n    if (this.onsignalingstatechange) {\n      this.onsignalingstatechange({});\n    }\n  }\n\n  private createPeerConnectionStats(): RTCPeerConnectionStats {\n    const timestamp = getStatsTimestamp();\n    return {\n      type: \"peer-connection\",\n      id: generateStatsId(\"peer-connection\"),\n      timestamp,\n      dataChannelsOpened: this.sctpManager.dataChannelsOpened,\n      dataChannelsClosed: this.sctpManager.dataChannelsClosed,\n    };\n  }\n\n  async getStats(selector?: MediaStreamTrack | null): Promise<RTCStatsReport> {\n    const stats: RTCStats[] = [];\n\n    // Peer connection stats - always included regardless of selector\n    stats.push(this.createPeerConnectionStats());\n\n    // Get stats from transceivers\n    const transceiverStats = await this.transceiverManager.getStats(selector);\n    stats.push(...transceiverStats);\n\n    // Get transport stats - always included regardless of selector\n    const transportStats = await this.secureManager.getStats();\n    stats.push(...transportStats);\n\n    // Get data channel stats - always included regardless of selector\n    if (this.sctpTransport) {\n      const dataChannelStats = await this.sctpManager.getStats();\n      if (dataChannelStats) {\n        stats.push(...dataChannelStats);\n      }\n    }\n\n    return new RTCStatsReport(stats);\n  }\n\n  async close() {\n    if (this.isClosed) return;\n\n    this.isClosed = true;\n    this.setSignalingState(\"closed\");\n\n    this.transceiverManager.close();\n\n    await this.secureManager.close();\n    await this.sctpManager.close();\n\n    this.onDataChannel.allUnsubscribe();\n    this.iceGatheringStateChange.allUnsubscribe();\n    this.iceConnectionStateChange.allUnsubscribe();\n    this.signalingStateChange.allUnsubscribe();\n    this.onTransceiverAdded.allUnsubscribe();\n    this.onRemoteTransceiverAdded.allUnsubscribe();\n    this.onIceCandidate.allUnsubscribe();\n\n    log(\"peerConnection closed\");\n  }\n}\n\nexport interface PeerConfig {\n  codecs: Partial<{\n    /**\n     * When specifying a codec with a fixed payloadType such as PCMU,\n     * it is necessary to set the correct PayloadType in RTCRtpCodecParameters in advance.\n     */\n    audio: RTCRtpCodecParameters[];\n    video: RTCRtpCodecParameters[];\n  }>;\n  headerExtensions: Partial<{\n    audio: RTCRtpHeaderExtensionParameters[];\n    video: RTCRtpHeaderExtensionParameters[];\n  }>;\n  iceTransportPolicy: \"all\" | \"relay\";\n  iceServers: RTCIceServer[];\n  /**Minimum port and Maximum port must not be the same value */\n  icePortRange: [number, number] | undefined;\n  iceInterfaceAddresses: InterfaceAddresses | undefined;\n  /** Add additional host (local) addresses to use for candidate gathering.\n   * Notably, you can include hosts that are normally excluded, such as loopback, tun interfaces, etc.\n   */\n  iceAdditionalHostAddresses: string[] | undefined;\n  iceUseIpv4: boolean;\n  iceUseIpv6: boolean;\n  forceTurnTCP: boolean;\n  /** such as google cloud run */\n  iceUseLinkLocalAddress: boolean | undefined;\n  /** If provided, is called on each STUN request.\n   * Return `true` if a STUN response should be sent, false if it should be skipped. */\n  iceFilterStunResponse:\n    | ((message: Message, addr: Address, protocol: Protocol) => boolean)\n    | undefined;\n  iceFilterCandidatePair: ((pair: CandidatePair) => boolean) | undefined;\n  dtls: Partial<{\n    keys: DtlsKeys;\n  }>;\n  icePasswordPrefix: string | undefined;\n  bundlePolicy: BundlePolicy;\n  debug: Partial<{\n    /**% */\n    inboundPacketLoss: number;\n    /**% */\n    outboundPacketLoss: number;\n    /**ms */\n    receiverReportDelay: number;\n    disableSendNack: boolean;\n    disableRecvRetransmit: boolean;\n  }>;\n  midSuffix: boolean;\n}\n\nexport const findCodecByMimeType = (\n  codecs: RTCRtpCodecParameters[],\n  target: RTCRtpCodecParameters,\n) =>\n  codecs.find(\n    (localCodec) =>\n      localCodec.mimeType.toLowerCase() === target.mimeType.toLowerCase(),\n  )\n    ? target\n    : undefined;\n\nexport type RTCIceServer = {\n  urls: string;\n  username?: string;\n  credential?: string;\n};\n\nfunction generateDefaultPeerConfig(): PeerConfig {\n  return {\n    codecs: {\n      audio: [useOPUS(), usePCMU()],\n      video: [useVP8()],\n    },\n    headerExtensions: {\n      audio: [],\n      video: [],\n    },\n    iceTransportPolicy: \"all\",\n    iceServers: [{ urls: \"stun:stun.l.google.com:19302\" }],\n    icePortRange: undefined,\n    iceInterfaceAddresses: undefined,\n    iceAdditionalHostAddresses: undefined,\n    iceUseIpv4: true,\n    iceUseIpv6: true,\n    iceFilterStunResponse: undefined,\n    iceFilterCandidatePair: undefined,\n    icePasswordPrefix: undefined,\n    iceUseLinkLocalAddress: undefined,\n    dtls: {},\n    bundlePolicy: \"max-compat\",\n    debug: {},\n    midSuffix: false,\n    forceTurnTCP: false,\n  };\n}\nexport const defaultPeerConfig: PeerConfig = generateDefaultPeerConfig();\n\nexport interface RTCTrackEvent {\n  track: MediaStreamTrack;\n  streams: MediaStream[];\n  transceiver: RTCRtpTransceiver;\n  receiver: RTCRtpReceiver;\n}\n\nexport interface RTCDataChannelEvent {\n  channel: RTCDataChannel;\n}\n\nexport interface RTCPeerConnectionIceEvent {\n  candidate?: RTCIceCandidate;\n}\n","// rfc2198\n\nimport { BitStream, debug } from \"../../imports/common\";\n\nconst log = debug(\"packages/rtp/src/rtp/red/packet.ts\");\n\n// 0                   1                    2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3  4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |F|   block PT  |  timestamp offset         |   block length    |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n// 0 1 2 3 4 5 6 7\n// +-+-+-+-+-+-+-+-+\n// |0|   Block PT  |\n// +-+-+-+-+-+-+-+-+\n\nexport class Red {\n  header!: RedHeader;\n  blocks: {\n    block: Buffer;\n    blockPT: number;\n    /**14bit */\n    timestampOffset?: number;\n  }[] = [];\n\n  static deSerialize(bufferOrArrayBuffer: Buffer | ArrayBuffer) {\n    const buf =\n      bufferOrArrayBuffer instanceof ArrayBuffer\n        ? Buffer.from(bufferOrArrayBuffer)\n        : bufferOrArrayBuffer;\n\n    const red = new Red();\n    let offset = 0;\n    [red.header, offset] = RedHeader.deSerialize(buf);\n\n    red.header.fields.forEach(({ blockLength, timestampOffset, blockPT }) => {\n      if (blockLength && timestampOffset) {\n        const block = buf.subarray(offset, offset + blockLength);\n        red.blocks.push({ block, blockPT, timestampOffset });\n        offset += blockLength;\n      } else {\n        const block = buf.subarray(offset);\n        red.blocks.push({ block, blockPT });\n      }\n    });\n\n    return red;\n  }\n\n  serialize() {\n    this.header = new RedHeader();\n\n    for (const { timestampOffset, blockPT, block } of this.blocks) {\n      if (timestampOffset) {\n        this.header.fields.push({\n          fBit: 1,\n          blockPT,\n          blockLength: block.length,\n          timestampOffset,\n        });\n      } else {\n        this.header.fields.push({ fBit: 0, blockPT });\n      }\n    }\n\n    let buf = this.header.serialize();\n    for (const { block } of this.blocks) {\n      buf = Buffer.concat([buf, block]);\n    }\n\n    return buf;\n  }\n}\n\nexport class RedHeader {\n  fields: RedHeaderField[] = [];\n\n  static deSerialize(buf: Buffer) {\n    let offset = 0;\n    const header = new RedHeader();\n\n    for (;;) {\n      const field: RedHeaderField = {} as any;\n      header.fields.push(field);\n\n      const bitStream = new BitStream(buf.subarray(offset));\n      field.fBit = bitStream.readBits(1);\n      field.blockPT = bitStream.readBits(7);\n\n      offset++;\n\n      if (field.fBit === 0) {\n        break;\n      }\n\n      field.timestampOffset = bitStream.readBits(14);\n      field.blockLength = bitStream.readBits(10);\n\n      offset += 3;\n    }\n\n    return [header, offset] as const;\n  }\n\n  serialize() {\n    let buf = Buffer.alloc(0);\n    for (const field of this.fields) {\n      try {\n        if (field.timestampOffset && field.blockLength) {\n          const bitStream = new BitStream(Buffer.alloc(4))\n            .writeBits(1, field.fBit)\n            .writeBits(7, field.blockPT)\n            .writeBits(14, field.timestampOffset)\n            .writeBits(10, field.blockLength);\n          buf = Buffer.concat([buf, bitStream.uint8Array]);\n        } else {\n          const bitStream = new BitStream(Buffer.alloc(1))\n            .writeBits(1, 0)\n            .writeBits(7, field.blockPT);\n          buf = Buffer.concat([buf, bitStream.uint8Array]);\n        }\n      } catch (error: any) {\n        log(error?.message);\n      }\n    }\n    return buf;\n  }\n}\n\ninterface RedHeaderField {\n  /** 10 */\n  fBit: number;\n  blockPT: number;\n  /**14bit */\n  timestampOffset?: number;\n  /**10bit */\n  blockLength?: number;\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sha224 = exports.sha256 = exports.SHA256 = void 0;\n/**\n * SHA2-256 a.k.a. sha256. In JS, it is the fastest hash, even faster than Blake3.\n *\n * To break sha256 using birthday attack, attackers need to try 2^128 hashes.\n * BTC network is doing 2^70 hashes/sec (2^95 hashes/year) as per 2025.\n *\n * Check out [FIPS 180-4](https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf).\n * @module\n */\nconst _md_js_1 = require(\"./_md.js\");\nconst utils_js_1 = require(\"./utils.js\");\n/** Round constants: first 32 bits of fractional parts of the cube roots of the first 64 primes 2..311). */\n// prettier-ignore\nconst SHA256_K = /* @__PURE__ */ new Uint32Array([\n    0x428a2f98, 0x71374491, 0xb5c0fbcf, 0xe9b5dba5, 0x3956c25b, 0x59f111f1, 0x923f82a4, 0xab1c5ed5,\n    0xd807aa98, 0x12835b01, 0x243185be, 0x550c7dc3, 0x72be5d74, 0x80deb1fe, 0x9bdc06a7, 0xc19bf174,\n    0xe49b69c1, 0xefbe4786, 0x0fc19dc6, 0x240ca1cc, 0x2de92c6f, 0x4a7484aa, 0x5cb0a9dc, 0x76f988da,\n    0x983e5152, 0xa831c66d, 0xb00327c8, 0xbf597fc7, 0xc6e00bf3, 0xd5a79147, 0x06ca6351, 0x14292967,\n    0x27b70a85, 0x2e1b2138, 0x4d2c6dfc, 0x53380d13, 0x650a7354, 0x766a0abb, 0x81c2c92e, 0x92722c85,\n    0xa2bfe8a1, 0xa81a664b, 0xc24b8b70, 0xc76c51a3, 0xd192e819, 0xd6990624, 0xf40e3585, 0x106aa070,\n    0x19a4c116, 0x1e376c08, 0x2748774c, 0x34b0bcb5, 0x391c0cb3, 0x4ed8aa4a, 0x5b9cca4f, 0x682e6ff3,\n    0x748f82ee, 0x78a5636f, 0x84c87814, 0x8cc70208, 0x90befffa, 0xa4506ceb, 0xbef9a3f7, 0xc67178f2\n]);\n/** Initial state: first 32 bits of fractional parts of the square roots of the first 8 primes 2..19. */\n// prettier-ignore\nconst SHA256_IV = /* @__PURE__ */ new Uint32Array([\n    0x6a09e667, 0xbb67ae85, 0x3c6ef372, 0xa54ff53a, 0x510e527f, 0x9b05688c, 0x1f83d9ab, 0x5be0cd19\n]);\n/**\n * Temporary buffer, not used to store anything between runs.\n * Named this way because it matches specification.\n */\nconst SHA256_W = /* @__PURE__ */ new Uint32Array(64);\nclass SHA256 extends _md_js_1.HashMD {\n    constructor() {\n        super(64, 32, 8, false);\n        // We cannot use array here since array allows indexing by variable\n        // which means optimizer/compiler cannot use registers.\n        this.A = SHA256_IV[0] | 0;\n        this.B = SHA256_IV[1] | 0;\n        this.C = SHA256_IV[2] | 0;\n        this.D = SHA256_IV[3] | 0;\n        this.E = SHA256_IV[4] | 0;\n        this.F = SHA256_IV[5] | 0;\n        this.G = SHA256_IV[6] | 0;\n        this.H = SHA256_IV[7] | 0;\n    }\n    get() {\n        const { A, B, C, D, E, F, G, H } = this;\n        return [A, B, C, D, E, F, G, H];\n    }\n    // prettier-ignore\n    set(A, B, C, D, E, F, G, H) {\n        this.A = A | 0;\n        this.B = B | 0;\n        this.C = C | 0;\n        this.D = D | 0;\n        this.E = E | 0;\n        this.F = F | 0;\n        this.G = G | 0;\n        this.H = H | 0;\n    }\n    process(view, offset) {\n        // Extend the first 16 words into the remaining 48 words w[16..63] of the message schedule array\n        for (let i = 0; i < 16; i++, offset += 4)\n            SHA256_W[i] = view.getUint32(offset, false);\n        for (let i = 16; i < 64; i++) {\n            const W15 = SHA256_W[i - 15];\n            const W2 = SHA256_W[i - 2];\n            const s0 = (0, utils_js_1.rotr)(W15, 7) ^ (0, utils_js_1.rotr)(W15, 18) ^ (W15 >>> 3);\n            const s1 = (0, utils_js_1.rotr)(W2, 17) ^ (0, utils_js_1.rotr)(W2, 19) ^ (W2 >>> 10);\n            SHA256_W[i] = (s1 + SHA256_W[i - 7] + s0 + SHA256_W[i - 16]) | 0;\n        }\n        // Compression function main loop, 64 rounds\n        let { A, B, C, D, E, F, G, H } = this;\n        for (let i = 0; i < 64; i++) {\n            const sigma1 = (0, utils_js_1.rotr)(E, 6) ^ (0, utils_js_1.rotr)(E, 11) ^ (0, utils_js_1.rotr)(E, 25);\n            const T1 = (H + sigma1 + (0, _md_js_1.Chi)(E, F, G) + SHA256_K[i] + SHA256_W[i]) | 0;\n            const sigma0 = (0, utils_js_1.rotr)(A, 2) ^ (0, utils_js_1.rotr)(A, 13) ^ (0, utils_js_1.rotr)(A, 22);\n            const T2 = (sigma0 + (0, _md_js_1.Maj)(A, B, C)) | 0;\n            H = G;\n            G = F;\n            F = E;\n            E = (D + T1) | 0;\n            D = C;\n            C = B;\n            B = A;\n            A = (T1 + T2) | 0;\n        }\n        // Add the compressed chunk to the current hash value\n        A = (A + this.A) | 0;\n        B = (B + this.B) | 0;\n        C = (C + this.C) | 0;\n        D = (D + this.D) | 0;\n        E = (E + this.E) | 0;\n        F = (F + this.F) | 0;\n        G = (G + this.G) | 0;\n        H = (H + this.H) | 0;\n        this.set(A, B, C, D, E, F, G, H);\n    }\n    roundClean() {\n        SHA256_W.fill(0);\n    }\n    destroy() {\n        this.set(0, 0, 0, 0, 0, 0, 0, 0);\n        this.buffer.fill(0);\n    }\n}\nexports.SHA256 = SHA256;\n/**\n * Constants taken from https://nvlpubs.nist.gov/nistpubs/FIPS/NIST.FIPS.180-4.pdf.\n */\nclass SHA224 extends SHA256 {\n    constructor() {\n        super();\n        this.A = 0xc1059ed8 | 0;\n        this.B = 0x367cd507 | 0;\n        this.C = 0x3070dd17 | 0;\n        this.D = 0xf70e5939 | 0;\n        this.E = 0xffc00b31 | 0;\n        this.F = 0x68581511 | 0;\n        this.G = 0x64f98fa7 | 0;\n        this.H = 0xbefa4fa4 | 0;\n        this.outputLen = 28;\n    }\n}\n/** SHA2-256 hash function */\nexports.sha256 = (0, utils_js_1.wrapConstructor)(() => new SHA256());\n/** SHA2-224 hash function */\nexports.sha224 = (0, utils_js_1.wrapConstructor)(() => new SHA224());\n//# sourceMappingURL=sha256.js.map","import { Int } from \"../../imports/rtp\";\n\n// refer by mediasoup\nexport class CumulativeResult {\n  numPackets = 0;\n  /**byte */\n  totalSize = 0;\n  firstPacketSentAtMs = 0;\n  lastPacketSentAtMs = 0;\n  firstPacketReceivedAtMs = 0;\n  lastPacketReceivedAtMs = 0;\n\n  /**\n   *\n   * @param size byte\n   * @param sentAtMs\n   * @param receivedAtMs\n   */\n  addPacket(size: number, sentAtMs: number, receivedAtMs: number) {\n    if (this.numPackets === 0) {\n      this.firstPacketSentAtMs = sentAtMs;\n      this.firstPacketReceivedAtMs = receivedAtMs;\n      this.lastPacketSentAtMs = sentAtMs;\n      this.lastPacketReceivedAtMs = receivedAtMs;\n    } else {\n      if (sentAtMs < this.firstPacketSentAtMs)\n        this.firstPacketSentAtMs = sentAtMs;\n      if (receivedAtMs < this.firstPacketReceivedAtMs)\n        this.firstPacketReceivedAtMs = receivedAtMs;\n      if (sentAtMs > this.lastPacketSentAtMs)\n        this.lastPacketSentAtMs = sentAtMs;\n      if (receivedAtMs > this.lastPacketReceivedAtMs)\n        this.lastPacketReceivedAtMs = receivedAtMs;\n    }\n\n    this.numPackets++;\n    this.totalSize += size;\n  }\n\n  reset() {\n    this.numPackets = 0;\n    this.totalSize = 0;\n    this.firstPacketSentAtMs = 0;\n    this.lastPacketSentAtMs = 0;\n    this.firstPacketReceivedAtMs = 0;\n    this.lastPacketReceivedAtMs = 0;\n  }\n\n  get receiveBitrate() {\n    const recvIntervalMs =\n      this.lastPacketReceivedAtMs - this.firstPacketReceivedAtMs;\n    const bitrate = (this.totalSize / recvIntervalMs) * 8 * 1000;\n    return Int(bitrate);\n  }\n\n  get sendBitrate() {\n    const sendIntervalMs = this.lastPacketSentAtMs - this.firstPacketSentAtMs;\n    const bitrate = (this.totalSize / sendIntervalMs) * 8 * 1000;\n    return Int(bitrate);\n  }\n}\n","export function startPeriodicGarbageCollection() {\n    if (!globalThis.gc) {\n        console.warn('rpc peer garbage collection not available: global.gc is not exposed.');\n    }\n    let g: typeof globalThis;\n    try {\n        g = globalThis;\n    }\n    catch (e) {\n    }\n\n    // periodically see if new objects were created or finalized,\n    // and collect gc if so.\n    let lastCollection = 0;\n    return setInterval(() => {\n        const now = Date.now();\n        const sinceLastCollection = now - lastCollection;\n        const remotesCreated = RpcPeer.remotesCreated;\n        RpcPeer.remotesCreated = 0;\n        const remotesCollected = RpcPeer.remotesCollected;\n        RpcPeer.remotesCollected = 0;\n        if (remotesCreated || remotesCollected || sinceLastCollection > 5 * 60 * 1000) {\n            lastCollection = now;\n            g?.gc?.();\n        }\n    }, 10000);\n}\n\nexport interface RpcMessage {\n    type: 'apply' | 'result' | 'finalize' | 'param';\n}\n\nexport interface RpcParam extends RpcMessage {\n    type: 'param';\n    id: string;\n    param: string;\n}\n\nexport interface RpcApply extends RpcMessage {\n    type: 'apply';\n    id: string | undefined;\n    proxyId: string;\n    args: any[];\n    method: string;\n    oneway?: boolean;\n}\n\nexport interface RpcResult extends RpcMessage {\n    type: 'result';\n    id: string;\n    throw?: boolean;\n    result?: any;\n}\n\ninterface RpcFinalize extends RpcMessage {\n    type: 'finalize';\n    __local_proxy_id: string;\n    __local_proxy_finalizer_id: string | undefined;\n}\n\ninterface RpcRemoteProxyValue {\n    __remote_proxy_id: string | undefined;\n    __remote_proxy_finalizer_id: string | undefined;\n    __remote_constructor_name: string;\n    __remote_proxy_props: any;\n    __remote_proxy_oneway_methods: string[];\n    __serialized_value?: any;\n}\n\ninterface RpcLocalProxyValue {\n    __local_proxy_id: string;\n}\n\ninterface Deferred {\n    resolve: (value: any) => void;\n    reject: (e: Error) => void;\n    method: string;\n}\n\nexport interface PrimitiveProxyHandler<T extends object> extends ProxyHandler<T> {\n    toPrimitive(): any;\n}\n\nclass RpcProxy implements PrimitiveProxyHandler<any> {\n    static iteratorMethods = new Set([\n        'next',\n        'throw',\n        'return',\n    ]);\n\n    constructor(public peer: RpcPeer,\n        public entry: LocalProxiedEntry,\n        public constructorName: string,\n        public proxyProps: any,\n        public proxyOneWayMethods: string[]) {\n    }\n\n    toPrimitive() {\n        const peer = this.peer;\n        return `RpcProxy-${peer.selfName}:${peer.peerName}: ${this.constructorName}`;\n    }\n\n    get(target: any, p: PropertyKey, receiver: any): any {\n        if (p === Symbol.asyncIterator) {\n            if (!this.proxyProps?.[Symbol.asyncIterator.toString()])\n                return;\n            return () => {\n                return new Proxy(() => { }, this);\n            };\n        }\n        if (RpcProxy.iteratorMethods.has(p?.toString())) {\n            const asyncIteratorMethod = this.proxyProps?.[Symbol.asyncIterator.toString()]?.[p];\n            if (asyncIteratorMethod)\n                return new Proxy(() => asyncIteratorMethod, this);\n        }\n        if (p === RpcPeer.PROPERTY_PROXY_ID)\n            return this.entry.id;\n        if (p === '__proxy_constructor')\n            return this.constructorName;\n        if (p === RpcPeer.PROPERTY_PROXY_PEER)\n            return this.peer;\n        if (p === RpcPeer.PROPERTY_PROXY_PROPERTIES)\n            return this.proxyProps;\n        if (p === RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS)\n            return this.proxyOneWayMethods;\n        if (p === RpcPeer.PROPERTY_JSON_DISABLE_SERIALIZATION || p === RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN)\n            return;\n        if (p === 'then')\n            return;\n        if (p === 'constructor')\n            return;\n        if (this.proxyProps?.[p] !== undefined)\n            return this.proxyProps?.[p];\n        const handled = RpcPeer.handleFunctionInvocations(this, target, p, receiver);\n        if (handled)\n            return handled;\n        return new Proxy(() => p, this);\n    }\n\n    set(target: any, p: string | symbol, value: any, receiver: any): boolean {\n        if (p === RpcPeer.finalizerIdSymbol) {\n            this.entry.finalizerId = value;\n        }\n        else {\n            this.proxyProps ||= {};\n            this.proxyProps[p] = value;\n        }\n\n        return true;\n    }\n\n    apply(target: any, thisArg: any, argArray?: any): any {\n        const method = target() || null;\n        const oneway = this.proxyOneWayMethods?.includes?.(method);\n\n        if (Object.isFrozen(this.peer.pendingResults)) {\n            if (oneway)\n                return Promise.resolve();\n            return Promise.reject(new RPCResultError(this.peer, 'RpcPeer has been killed (apply) ' + target()));\n        }\n\n        // rpc objects can be functions. if the function is a oneway method,\n        // it will have a null in the oneway method list. this is because\n        // undefined is not JSON serializable.\n        const args: any[] = [];\n        const serializationContext: any = {};\n        for (const arg of (argArray || [])) {\n            args.push(this.peer.serialize(arg, serializationContext));\n        }\n\n        const rpcApply: RpcApply = {\n            type: \"apply\",\n            id: undefined,\n            proxyId: this.entry.id,\n            args,\n            method,\n        };\n\n        if (oneway) {\n            rpcApply.oneway = true;\n            // a oneway callable object doesn't need to be in the JSON payload.\n            if (method === null)\n                delete rpcApply.method;\n            this.peer.send(rpcApply, undefined, serializationContext);\n            return Promise.resolve();\n        }\n\n        const pendingResult = this.peer.createPendingResult(method, (id, reject) => {\n            rpcApply.id = id;\n            this.peer.send(rpcApply, reject, serializationContext);\n        });\n\n        const asyncIterator = this.proxyProps?.[Symbol.asyncIterator.toString()];\n        if (!asyncIterator || (method !== asyncIterator.next && method !== asyncIterator.return))\n            return pendingResult;\n\n        return pendingResult\n            .then(value => {\n                if (method === asyncIterator.return) {\n                    return {\n                        done: true,\n                        value: undefined,\n                    }\n                }\n                return ({\n                    value,\n                    done: false,\n                });\n            })\n            .catch(e => {\n                if (e.name === 'StopAsyncIteration') {\n                    return {\n                        done: true,\n                        value: undefined as any,\n                    }\n                }\n                throw e;\n            })\n    }\n}\n\ninterface SerialiedRpcResultError {\n    name: string;\n    stack: string;\n    message: string;\n}\n\n// todo: error constructor adds a \"cause\" variable in Chrome 93, Node v??\nexport class RPCResultError extends Error {\n    constructor(peer: RpcPeer, message: string, public cause?: Error, options?: { name: string, stack: string | undefined }) {\n        super(`${message}\\n${peer.selfName}:${peer.peerName}`);\n\n        if (options?.name) {\n            this.name = options?.name;\n        }\n        if (options?.stack) {\n            this.stack = `${cause?.stack || options.stack}\\n${peer.peerName}:${peer.selfName}`;\n        }\n    }\n}\n\ndeclare class WeakRef<T> {\n    target: T;\n    constructor(target: any);\n    deref(): T;\n}\n\ntry {\n    // @ts-ignore\n    const fr = FinalizationRegistry;\n}\ncatch (e) {\n    (window as any).WeakRef = class WeakRef {\n        target: any;\n        constructor(target: any) {\n            this.target = target;\n        }\n        deref(): any {\n            return this.target;\n        }\n    };\n\n    (window as any).FinalizationRegistry = class FinalizationRegistry {\n        register() {\n        }\n    }\n}\n\nexport interface RpcSerializer {\n    serialize(value: any, serializationContext?: any): any;\n    deserialize(serialized: any, serializationContext?: any): any;\n}\n\ninterface LocalProxiedEntry {\n    id: string;\n    finalizerId: string | undefined;\n}\n\ninterface ErrorType {\n    name: string;\n    message: string;\n    stack?: string;\n}\n\nexport class RpcPeer {\n    params: { [name: string]: any } = {};\n    pendingResults: { [id: string]: Deferred } = {};\n    localProxied = new Map<any, LocalProxiedEntry>();\n    localProxyMap = new Map<string, any>();\n    // @ts-ignore\n    remoteWeakProxies: { [id: string]: WeakRef<any> } = {};\n    // @ts-ignore\n    finalizers = new FinalizationRegistry(entry => this.finalize(entry as LocalProxiedEntry));\n    nameDeserializerMap = new Map<string, RpcSerializer>();\n    onProxyTypeSerialization = new Map<string, (value: any) => void>();\n    onProxySerialization: (value: any) => {\n        proxyId: string;\n        properties: any;\n    };\n    constructorSerializerMap = new Map<any, string>();\n    transportSafeArgumentTypes = RpcPeer.getDefaultTransportSafeArgumentTypes();\n    killed: Promise<string>;\n    killedSafe: Promise<void>;\n    killedDeferred: Deferred;\n    tags: any = {};\n    yieldedAsyncIterators = new Set<AsyncGenerator>();\n\n    static readonly finalizerIdSymbol = Symbol('rpcFinalizerId');\n    static remotesCollected = 0;\n    static remotesCreated = 0;\n    static activeRpcPeer: RpcPeer;\n\n    static isRpcProxy(value: any) {\n        return !!value?.[RpcPeer.PROPERTY_PROXY_ID];\n    }\n\n    static getDefaultTransportSafeArgumentTypes() {\n        const jsonSerializable = new Set<string>();\n        jsonSerializable.add(Number.name);\n        jsonSerializable.add(String.name);\n        jsonSerializable.add(Object.name);\n        jsonSerializable.add(Boolean.name);\n        jsonSerializable.add(Array.name);\n        return jsonSerializable;\n    }\n\n    static handleFunctionInvocations(thiz: PrimitiveProxyHandler<any>, target: any, p: PropertyKey, receiver: any): any {\n        if (p === 'apply') {\n            return (thisArg: any, args: any[]) => {\n                return thiz.apply!(target, thiz, args);\n            }\n        }\n        else if (p === 'call') {\n            return (thisArg: any, ...args: any[]) => {\n                return thiz.apply!(target, thiz, args);\n            }\n        }\n        else if (p === 'toString' || p === Symbol.toPrimitive) {\n            return (thisArg: any, ...args: any[]) => {\n                return thiz.toPrimitive();\n            }\n        }\n    }\n\n    // static setProxyProperties(value: any, properties: any) {\n    //     value[RpcPeer.PROPERTY_PROXY_PROPERTIES] = properties;\n    // }\n\n    // static getProxyProperties(value: any) {\n    //     return value?.[RpcPeer.PROPERTY_PROXY_PROPERTIES];\n    // }\n\n    static getIteratorNext(target: any): string {\n        if (!target[Symbol.asyncIterator])\n            return;\n        const proxyProps = target[this.PROPERTY_PROXY_PROPERTIES]?.[Symbol.asyncIterator.toString()];\n        return proxyProps?.next || 'next';\n    }\n\n    static prepareProxyProperties(value: any) {\n        let props = value?.[RpcPeer.PROPERTY_PROXY_PROPERTIES];\n        if (!value[Symbol.asyncIterator])\n            return props;\n        props ||= {};\n        if (!props[Symbol.asyncIterator.toString()]) {\n            props[Symbol.asyncIterator.toString()] = {\n                next: 'next',\n                throw: 'throw',\n                return: 'return',\n            };\n        }\n        return props;\n    }\n\n    static readonly RANDOM_DIGITS = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n    static readonly RPC_RESULT_ERROR_NAME = 'RPCResultError';\n    static readonly PROPERTY_PROXY_ID = '__proxy_id';\n    static readonly PROPERTY_PROXY_PEER = '__proxy_peer';\n    static readonly PROPERTY_PROXY_ONEWAY_METHODS = '__proxy_oneway_methods';\n    static readonly PROPERTY_JSON_DISABLE_SERIALIZATION = '__json_disable_serialization';\n    static readonly PROPERTY_PROXY_PROPERTIES = '__proxy_props';\n    static readonly PROPERTY_JSON_COPY_SERIALIZE_CHILDREN = '__json_copy_serialize_children';\n    static readonly PROBED_PROPERTIES = new Set<any>([\n        'then',\n        'constructor',\n        '__proxy_id',\n        '__proxy_constructor',\n        RpcPeer.PROPERTY_PROXY_PEER,\n        RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS,\n        RpcPeer.PROPERTY_JSON_DISABLE_SERIALIZATION,\n        RpcPeer.PROPERTY_PROXY_PROPERTIES,\n        RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN,\n    ]);\n\n    constructor(public selfName: string, public peerName: string, public send: (message: RpcMessage, reject?: (e: Error) => void, serializationContext?: any) => void) {\n        this.killed = new Promise<string>((resolve, reject) => {\n            this.killedDeferred = { resolve, reject, method: undefined };\n        }).catch(e => e.message || 'Unknown Error');\n        this.killedSafe = this.killed.then(() => { }).catch(() => { });\n    }\n\n    static isTransportSafe(value: any) {\n        if (!value)\n            return true;\n        return !value[Symbol.asyncIterator]\n            && !value[RpcPeer.PROPERTY_JSON_DISABLE_SERIALIZATION]\n            && this.getDefaultTransportSafeArgumentTypes().has(value.constructor?.name);\n    }\n\n    isTransportSafe(value: any) {\n        if (!value)\n            return true;\n        return !value[Symbol.asyncIterator]\n            && !value[RpcPeer.PROPERTY_JSON_DISABLE_SERIALIZATION]\n            && this.transportSafeArgumentTypes.has(value.constructor?.name);\n    }\n\n    static generateId() {\n        return [...new Array(8)].map(() => RpcPeer.RANDOM_DIGITS.charAt(Math.floor(Math.random() * RpcPeer.RANDOM_DIGITS.length))).join('');\n    }\n\n    createPendingResult(method: string, cb: (id: string, reject: (e: Error) => void) => void): Promise<any> {\n        if (Object.isFrozen(this.pendingResults))\n            return Promise.reject(new RPCResultError(this, 'RpcPeer has been killed (createPendingResult)'));\n\n        const promise = new Promise((resolve, reject) => {\n            const id = RpcPeer.generateId();\n            this.pendingResults[id] = { resolve, reject, method };\n\n            cb(id, e => reject(new RPCResultError(this, e.message, e)));\n        });\n\n        // todo: make this an option so rpc doesn't nuke the process if uncaught?\n        promise.catch(() => { });\n\n        return promise;\n    }\n\n    kill(message?: string) {\n        if (Object.isFrozen(this.pendingResults))\n            return;\n        const error = new RPCResultError(this, message || 'peer was killed');\n        this.killedDeferred.reject(error);\n        for (const result of Object.values(this.pendingResults)) {\n            result.reject(error);\n        }\n        for (const y of this.yieldedAsyncIterators) {\n            y.throw(error).catch(() => { });\n        }\n        this.yieldedAsyncIterators.clear();\n        this.pendingResults = Object.freeze({});\n        this.params = Object.freeze({});\n        this.remoteWeakProxies = Object.freeze({});\n        this.localProxyMap.clear()\n        this.localProxied.clear();\n    }\n\n    // need a name/constructor map due to babel name mangling? fix somehow?\n    addSerializer(ctr: any, name: string, serializer: RpcSerializer) {\n        this.nameDeserializerMap.set(name, serializer);\n        this.constructorSerializerMap.set(ctr, name);\n    }\n\n    finalize(entry: LocalProxiedEntry) {\n        RpcPeer.remotesCollected++;\n\n        delete this.remoteWeakProxies[entry.id];\n        const rpcFinalize: RpcFinalize = {\n            __local_proxy_id: entry.id,\n            __local_proxy_finalizer_id: entry.finalizerId,\n            type: 'finalize',\n        }\n        this.send(rpcFinalize);\n    }\n\n    async getParam(param: string) {\n        return this.createPendingResult('getParam', (id, reject) => {\n            const paramMessage: RpcParam = {\n                id,\n                type: 'param',\n                param,\n            };\n\n            this.send(paramMessage, reject);\n        });\n    }\n\n    createErrorResult(result: RpcResult, e: ErrorType) {\n        result.result = this.serializeError(e);\n        result.throw = true;\n        return result;\n    }\n\n    deserialize(value: any, deserializationContext: any): any {\n        if (!value)\n            return value;\n\n        const copySerializeChildren = value[RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN];\n        if (copySerializeChildren) {\n            if (Array.isArray(copySerializeChildren)) {\n                const array = [];\n                for (const val of copySerializeChildren) {\n                    array.push(this.deserialize(val, deserializationContext));\n                }\n                return array;\n            }\n\n            const ret: any = {};\n            for (const [key, val] of Object.entries(value)) {\n                ret[key] = this.deserialize(val, deserializationContext);\n            }\n            return ret;\n        }\n\n        const { __remote_proxy_id, __remote_proxy_finalizer_id, __local_proxy_id, __remote_constructor_name, __serialized_value, __remote_proxy_props, __remote_proxy_oneway_methods } = value;\n        if (__remote_constructor_name === RpcPeer.RPC_RESULT_ERROR_NAME)\n            return this.deserializeError(__serialized_value);\n\n        if (__remote_proxy_id) {\n            let proxy = this.remoteWeakProxies[__remote_proxy_id]?.deref();\n            if (!proxy)\n                proxy = this.newProxy(__remote_proxy_id, __remote_constructor_name, __remote_proxy_props, __remote_proxy_oneway_methods);\n            proxy[RpcPeer.finalizerIdSymbol] = __remote_proxy_finalizer_id;\n\n            const deserializer = this.nameDeserializerMap.get(__remote_constructor_name);\n            if (deserializer) {\n                return deserializer.deserialize(proxy, deserializationContext);\n            }\n\n            return proxy;\n        }\n\n        if (__local_proxy_id) {\n            const ret = this.localProxyMap.get(__local_proxy_id);\n            if (!ret)\n                throw new RPCResultError(this, `invalid local proxy id ${__local_proxy_id}`);\n            return ret;\n        }\n\n        const deserializer = this.nameDeserializerMap.get(__remote_constructor_name);\n        if (deserializer) {\n            return deserializer.deserialize(__serialized_value, deserializationContext);\n        }\n\n        return value;\n    }\n\n    deserializeError(e: SerialiedRpcResultError): RPCResultError {\n        const { name, stack, message } = e;\n        return new RPCResultError(this, message, undefined, { name, stack });\n    }\n\n    serializeError(e: ErrorType): RpcRemoteProxyValue {\n        const __serialized_value: SerialiedRpcResultError = {\n            stack: e.stack || '[no stack]',\n            name: e.name || '[no name]',\n            message: e.message || '[no message]',\n        }\n        return {\n            // probably not safe to use constructor.name\n            __remote_constructor_name: RpcPeer.RPC_RESULT_ERROR_NAME,\n            __remote_proxy_id: undefined,\n            __remote_proxy_finalizer_id: undefined,\n            __remote_proxy_oneway_methods: undefined,\n            __remote_proxy_props: undefined,\n            __serialized_value,\n        };\n    }\n\n    serialize(value: any, serializationContext: any): any {\n        if (value?.[RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN] === true) {\n            if (Array.isArray(value)) {\n                const array = [];\n                for (const val of value) {\n                    array.push(this.serialize(val, serializationContext));\n                }\n\n                return {\n                    [RpcPeer.PROPERTY_JSON_COPY_SERIALIZE_CHILDREN]: array,\n                };\n            }\n\n            const ret: any = {};\n            for (const [key, val] of Object.entries(value)) {\n                ret[key] = this.serialize(val, serializationContext);\n            }\n            return ret;\n        }\n\n        if (this.isTransportSafe(value)) {\n            return value;\n        }\n\n        let __remote_constructor_name = value.__proxy_constructor || value.constructor?.name?.toString();\n\n        if (value instanceof Error)\n            return this.serializeError(value);\n\n        const serializerMapName = this.constructorSerializerMap.get(value.constructor);\n        if (serializerMapName) {\n            __remote_constructor_name = serializerMapName;\n            const serializer = this.nameDeserializerMap.get(serializerMapName);\n            if (!serializer)\n                throw new Error('serializer not found for ' + serializerMapName);\n            const serialized = serializer.serialize(value, serializationContext);\n            const ret: RpcRemoteProxyValue = {\n                __remote_proxy_id: undefined,\n                __remote_proxy_finalizer_id: undefined,\n                __remote_constructor_name,\n                __remote_proxy_props: RpcPeer.prepareProxyProperties(value),\n                __remote_proxy_oneway_methods: value?.[RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS],\n                __serialized_value: serialized,\n            }\n            return ret;\n        }\n\n        let proxiedEntry = this.localProxied.get(value);\n        if (proxiedEntry) {\n            const {\n                proxyId: __remote_proxy_id,\n                properties: __remote_proxy_props,\n            } = this.onProxySerialization?.(value)\n                || {\n                    proxyId: proxiedEntry.id,\n                    properties: RpcPeer.prepareProxyProperties(value),\n                };\n\n            if (__remote_proxy_id !== proxiedEntry.id)\n                throw new Error('onProxySerialization proxy id mismatch');\n\n            const __remote_proxy_finalizer_id = RpcPeer.generateId();\n            proxiedEntry.finalizerId = __remote_proxy_finalizer_id;\n            const ret: RpcRemoteProxyValue = {\n                __remote_proxy_id,\n                __remote_proxy_finalizer_id,\n                __remote_constructor_name,\n                __remote_proxy_props,\n                __remote_proxy_oneway_methods: value?.[RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS],\n            }\n            return ret;\n        }\n\n        const { __proxy_id, __proxy_peer } = value;\n        if (__proxy_id && __proxy_peer === this) {\n            const ret: RpcLocalProxyValue = {\n                __local_proxy_id: __proxy_id,\n            }\n            return ret;\n        }\n\n        this.onProxyTypeSerialization.get(__remote_constructor_name)?.(value);\n\n        const {\n            proxyId: __remote_proxy_id,\n            properties: __remote_proxy_props,\n        } = this.onProxySerialization?.(value)\n            || {\n                proxyId: RpcPeer.generateId(),\n                properties: RpcPeer.prepareProxyProperties(value),\n            };\n\n        proxiedEntry = {\n            id: __remote_proxy_id,\n            finalizerId: __remote_proxy_id,\n        };\n        this.localProxied.set(value, proxiedEntry);\n        this.localProxyMap.set(__remote_proxy_id, value);\n\n        const ret: RpcRemoteProxyValue = {\n            __remote_proxy_id,\n            __remote_proxy_finalizer_id: __remote_proxy_id,\n            __remote_constructor_name,\n            __remote_proxy_props,\n            __remote_proxy_oneway_methods: value?.[RpcPeer.PROPERTY_PROXY_ONEWAY_METHODS],\n        }\n\n        return ret;\n    }\n\n    newProxy(proxyId: string, proxyConstructorName: string, proxyProps: any, proxyOneWayMethods: string[]) {\n        RpcPeer.remotesCreated++;\n\n        const localProxiedEntry: LocalProxiedEntry = {\n            id: proxyId,\n            finalizerId: undefined,\n        }\n        const rpc = new RpcProxy(this, localProxiedEntry, proxyConstructorName, proxyProps, proxyOneWayMethods);\n        const target = proxyConstructorName === 'Function' || proxyConstructorName === 'AsyncFunction' ? function () { } : rpc;\n        const proxy = new Proxy(target, rpc);\n        // @ts-ignore\n        const weakref = new WeakRef(proxy);\n        this.remoteWeakProxies[proxyId] = weakref;\n        this.finalizers.register(rpc, localProxiedEntry);\n        return proxy;\n    }\n\n    handleMessage(message: RpcMessage, deserializationContext?: any) {\n        try {\n            RpcPeer.activeRpcPeer = this;\n            this.handleMessageInternal(message, deserializationContext);\n        }\n        finally {\n            RpcPeer.activeRpcPeer = undefined;\n        }\n    }\n\n    sendResult(result: RpcResult, serializationContext: any) {\n        this.send(result, e => {\n            // attempt to handle transport serialization failure.\n            this.send(this.createErrorResult(result, e), undefined, serializationContext);\n        }, serializationContext);\n    }\n\n    private async handleMessageInternal(message: RpcMessage, deserializationContext?: any) {\n        if (Object.isFrozen(this.pendingResults))\n            return;\n\n        try {\n            switch (message.type) {\n                case 'param': {\n                    const rpcParam = message as RpcParam;\n                    const serializationContext: any = {};\n                    let result: RpcResult;\n                    try {\n                        result = {\n                            type: 'result',\n                            id: rpcParam.id,\n                            result: this.serialize(this.params[rpcParam.param], serializationContext)\n                        };\n                    }\n                    catch (e) {\n                        // console.error('failure', rpcApply.method, e);\n                        this.createErrorResult(result, e as Error);\n                    }\n\n                    this.sendResult(result, serializationContext);\n                    break;\n                }\n                case 'apply': {\n                    const rpcApply = message as RpcApply;\n                    const result: RpcResult = {\n                        type: 'result',\n                        id: rpcApply.id || '',\n                    };\n                    const serializationContext: any = {};\n\n                    try {\n                        const target = this.localProxyMap.get(rpcApply.proxyId);\n                        if (!target)\n                            throw new Error(`proxy id ${rpcApply.proxyId} not found`);\n\n                        const args = [];\n                        for (const arg of (rpcApply.args || [])) {\n                            args.push(this.deserialize(arg, deserializationContext));\n                        }\n\n                        let value: any;\n                        if (rpcApply.method) {\n                            const method = target[rpcApply.method];\n                            if (!method)\n                                throw new Error(`target ${target?.constructor?.name} does not have method ${rpcApply.method}`);\n\n                            const isIteratorNext = RpcPeer.getIteratorNext(target) === rpcApply.method;\n                            if (isIteratorNext)\n                                this.yieldedAsyncIterators.delete(target);\n                            value = await target[rpcApply.method](...args);\n\n                            if (isIteratorNext) {\n                                if (value.done) {\n                                    const errorType: ErrorType = {\n                                        name: 'StopAsyncIteration',\n                                        message: undefined,\n                                    };\n                                    throw errorType;\n                                }\n                                else {\n                                    if (Object.isFrozen(this.pendingResults)) {\n                                        (target as AsyncGenerator).throw(new RPCResultError(this, 'RpcPeer has been killed (yield)')).catch(() => { });\n                                    }\n                                    else {\n                                        this.yieldedAsyncIterators.add(target);\n                                    }\n                                    value = value.value;\n                                }\n                            }\n                        }\n                        else {\n                            value = await target(...args);\n                        }\n\n                        result.result = this.serialize(value, serializationContext);\n                    }\n                    catch (e) {\n                        // console.error('failure', rpcApply.method, e);\n                        this.createErrorResult(result, e as Error);\n                    }\n\n                    if (!rpcApply.oneway)\n                        this.sendResult(result, serializationContext);\n                    break;\n                }\n                case 'result': {\n                    // console.log(message)\n                    const rpcResult = message as RpcResult;\n                    const deferred = this.pendingResults[rpcResult.id];\n                    delete this.pendingResults[rpcResult.id];\n                    if (!deferred)\n                        throw new Error(`unknown result ${rpcResult.id}`);\n                    const deserialized = this.deserialize(rpcResult.result, deserializationContext);\n                    if (rpcResult.throw)\n                        deferred.reject(deserialized);\n                    else\n                        deferred.resolve(deserialized);\n                    break;\n                }\n                case 'finalize': {\n                    const rpcFinalize = message as RpcFinalize;\n                    const local = this.localProxyMap.get(rpcFinalize.__local_proxy_id);\n                    if (local) {\n                        const localProxiedEntry = this.localProxied.get(local);\n                        // if a finalizer id is specified, it must match.\n                        if (rpcFinalize.__local_proxy_finalizer_id && rpcFinalize.__local_proxy_finalizer_id !== localProxiedEntry?.finalizerId) {\n                            break;\n                        }\n                        this.localProxyMap.delete(rpcFinalize.__local_proxy_id);\n                        this.localProxied.delete(local);\n                    }\n                    break;\n                }\n                default:\n                    throw new Error(`unknown rpc message type ${message.type}`);\n            }\n        }\n        catch (e) {\n            console.error('unhandled rpc error', this.peerName, e);\n            return;\n        }\n    }\n}\n\nexport function getEvalSource() {\n    return `\n    (() => {\n        ${RpcProxy}\n\n        ${RpcPeer}\n\n        ${startPeriodicGarbageCollection}\n\n        return {\n            startPeriodicGarbageCollection,\n            RpcPeer,\n            RpcProxy,\n        };\n    })();\n    `;\n}\n","'use strict';\n\nconst crc32By1 = require('./crc32-by-1');\n\nmodule.exports = crc32;\n\n/**\n * @private\n * @param {Array<number[]>} table Lookup table.\n * @param {Buffer} buf Source data.\n * @param {number} input\n * @param {number} offset\n * @returns {number}\n */\nfunction crc32(table, buf, input, offset) {\n  let pointer = offset;\n  let crc = input;\n\n  for (let i = pointer; i + 4 < buf.length; i += 4) {\n    const byte = buf.readUInt32LE(i) ^ crc;\n\n    crc =\n      table[0][(byte >>> 24) & 0xff] ^\n      table[1][(byte >>> 16) & 0xff] ^\n      table[2][(byte >>> 8) & 0xff] ^\n      table[3][byte & 0xff];\n    pointer += 4;\n  }\n\n  return crc32By1(table, buf, crc, pointer);\n}\n","import type { HashAlgorithms, SignatureAlgorithms } from \"../cipher/const\";\nimport type { SessionTypes } from \"../cipher/suites/abstract\";\nimport { debug } from \"../imports/common\";\nimport type { FragmentedHandshake } from \"../record/message/fragment\";\nimport type { Options } from \"../socket\";\nimport type { Handshake } from \"../typings/domain\";\n\nconst log = debug(\"werift-dtls : packages/dtls/src/context/dtls.ts : log\");\n\nexport class DtlsContext {\n  version = { major: 255 - 1, minor: 255 - 2 };\n\n  lastFlight: Handshake[] = [];\n  lastMessage: Buffer[] = [];\n  recordSequenceNumber = 0;\n  sequenceNumber = 0;\n  epoch = 0;\n  flight = 0;\n  handshakeCache: {\n    [flight: number]: {\n      isLocal: boolean;\n      data: FragmentedHandshake[];\n      flight: number;\n    };\n  } = {};\n  cookie?: Buffer;\n  requestedCertificateTypes: number[] = [];\n  requestedSignatureAlgorithms: {\n    hash: HashAlgorithms;\n    signature: SignatureAlgorithms;\n  }[] = [];\n  remoteExtendedMasterSecret = false;\n\n  constructor(\n    public options: Options,\n    public sessionType: SessionTypes,\n  ) {}\n\n  get sessionId() {\n    return this.cookie ? this.cookie.toString(\"hex\").slice(0, 10) : \"\";\n  }\n\n  get sortedHandshakeCache() {\n    return Object.entries(this.handshakeCache)\n      .sort(([a], [b]) => Number(a) - Number(b))\n      .flatMap(([, { data }]) =>\n        data.sort((a, b) => a.message_seq - b.message_seq),\n      );\n  }\n\n  checkHandshakesExist = (handshakes: number[]) =>\n    !handshakes.find(\n      (type) =>\n        this.sortedHandshakeCache.find((h) => h.msg_type === type) == undefined,\n    );\n\n  bufferHandshakeCache(\n    handshakes: FragmentedHandshake[],\n    isLocal: boolean,\n    flight: number,\n  ) {\n    if (!this.handshakeCache[flight]) {\n      this.handshakeCache[flight] = { data: [], isLocal, flight };\n    }\n\n    const filtered = handshakes.filter((h) => {\n      const exist = this.handshakeCache[flight].data.find(\n        (t) => t.msg_type === h.msg_type,\n      );\n      if (exist) {\n        log(this.sessionId, \"exist\", exist.summary, isLocal, flight);\n        return false;\n      }\n      return true;\n    });\n\n    this.handshakeCache[flight].data = [\n      ...this.handshakeCache[flight].data,\n      ...filtered,\n    ];\n  }\n}\n","module.exports = require(\"worker_threads\");","import { setTimeout } from \"timers/promises\";\n\nimport { uint8Add, uint16Add, uint24 } from \"../../imports/common\";\nimport {\n  type PacketStatus,\n  RecvDelta,\n  RtcpTransportLayerFeedback,\n  RunLengthChunk,\n  type StatusVectorChunk,\n  TransportWideCC,\n  debug,\n} from \"../../imports/rtp\";\nimport type { RTCDtlsTransport } from \"../../transport/dtls\";\nimport { microTime } from \"../../utils\";\n\nconst log = debug(\"werift:packages/webrtc/media/receiver/receiverTwcc\");\n\ntype ExtensionInfo = { tsn: number; timestamp: bigint };\n\nexport class ReceiverTWCC {\n  extensionInfo: {\n    [tsn: number]: ExtensionInfo;\n  } = {};\n  twccRunning = false;\n  /** uint8 */\n  fbPktCount = 0;\n  lastTimestamp?: bigint;\n\n  constructor(\n    private dtlsTransport: RTCDtlsTransport,\n    private rtcpSsrc: number,\n    private mediaSourceSsrc: number,\n  ) {\n    this.runTWCC();\n  }\n\n  handleTWCC(transportSequenceNumber: number) {\n    this.extensionInfo[transportSequenceNumber] = {\n      tsn: transportSequenceNumber,\n      timestamp: microTime(),\n    };\n\n    if (Object.keys(this.extensionInfo).length > 10) {\n      this.sendTWCC();\n    }\n  }\n\n  private async runTWCC() {\n    while (this.twccRunning) {\n      this.sendTWCC();\n      await setTimeout(100);\n    }\n  }\n\n  private sendTWCC() {\n    if (Object.keys(this.extensionInfo).length === 0) return;\n    const extensionsArr = Object.values(this.extensionInfo).sort(\n      (a, b) => a.tsn - b.tsn,\n    );\n\n    const minTSN = extensionsArr[0].tsn;\n    const maxTSN = extensionsArr.slice(-1)[0].tsn;\n\n    const packetChunks: (RunLengthChunk | StatusVectorChunk)[] = [];\n    const baseSequenceNumber = extensionsArr[0].tsn;\n    const packetStatusCount = uint16Add(maxTSN - minTSN, 1);\n    /**micro sec */\n    let referenceTime!: bigint;\n    let lastPacketStatus: { status: PacketStatus; minTSN: number } | undefined;\n    const recvDeltas: RecvDelta[] = [];\n\n    for (let i = minTSN; i <= maxTSN; i++) {\n      /**micro sec */\n      const timestamp = this.extensionInfo[i]?.timestamp;\n\n      if (timestamp) {\n        if (!this.lastTimestamp) {\n          this.lastTimestamp = timestamp;\n        }\n        if (!referenceTime) {\n          referenceTime = this.lastTimestamp;\n        }\n\n        const delta = timestamp - this.lastTimestamp;\n        this.lastTimestamp = timestamp;\n\n        const recvDelta = new RecvDelta({\n          delta: Number(delta),\n        });\n        recvDelta.parseDelta();\n        recvDeltas.push(recvDelta);\n\n        // when status changed\n        if (\n          lastPacketStatus != undefined &&\n          lastPacketStatus.status !== recvDelta.type\n        ) {\n          packetChunks.push(\n            new RunLengthChunk({\n              packetStatus: lastPacketStatus.status,\n              runLength: i - lastPacketStatus.minTSN,\n            }),\n          );\n          lastPacketStatus = { minTSN: i, status: recvDelta.type! };\n        }\n        // last status\n        if (i === maxTSN) {\n          if (lastPacketStatus != undefined) {\n            packetChunks.push(\n              new RunLengthChunk({\n                packetStatus: lastPacketStatus.status,\n                runLength: i - lastPacketStatus.minTSN + 1,\n              }),\n            );\n          } else {\n            packetChunks.push(\n              new RunLengthChunk({\n                packetStatus: recvDelta.type,\n                runLength: 1,\n              }),\n            );\n          }\n        }\n\n        if (lastPacketStatus == undefined) {\n          lastPacketStatus = { minTSN: i, status: recvDelta.type! };\n        }\n      }\n    }\n\n    if (!referenceTime) {\n      return;\n    }\n\n    const packet = new RtcpTransportLayerFeedback({\n      feedback: new TransportWideCC({\n        senderSsrc: this.rtcpSsrc,\n        mediaSourceSsrc: this.mediaSourceSsrc,\n        baseSequenceNumber,\n        packetStatusCount,\n        referenceTime: uint24(Math.floor(Number(referenceTime / 1000n / 64n))),\n        fbPktCount: this.fbPktCount,\n        recvDeltas,\n        packetChunks,\n      }),\n    });\n\n    this.dtlsTransport.sendRtcp([packet]).catch((err) => {\n      log(err);\n    });\n    this.extensionInfo = {};\n    this.fbPktCount = uint8Add(this.fbPktCount, 1);\n  }\n}\n","'use strict';\n\n/**\n * Represent an unexpected end of decode stream.\n */\nmodule.exports = class NotEnoughDataError extends Error {\n  /**\n   * @class NotEnoughDataError\n   * @param {number} expected The number of expected bytes.\n   * @param {number} received The number of received bytes.\n   */\n  constructor(expected, received) {\n    const message = `requested ${expected} bytes but only ${received} available`;\n\n    super(message);\n    this.name = 'NotEnoughDataError';\n  }\n};\n","'use strict'\n\n/*\n * Traditional DNS header OPCODEs (4-bits) defined by IANA in\n * https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml#dns-parameters-5\n */\n\nexports.toString = function (opcode) {\n  switch (opcode) {\n    case 0: return 'QUERY'\n    case 1: return 'IQUERY'\n    case 2: return 'STATUS'\n    case 3: return 'OPCODE_3'\n    case 4: return 'NOTIFY'\n    case 5: return 'UPDATE'\n    case 6: return 'OPCODE_6'\n    case 7: return 'OPCODE_7'\n    case 8: return 'OPCODE_8'\n    case 9: return 'OPCODE_9'\n    case 10: return 'OPCODE_10'\n    case 11: return 'OPCODE_11'\n    case 12: return 'OPCODE_12'\n    case 13: return 'OPCODE_13'\n    case 14: return 'OPCODE_14'\n    case 15: return 'OPCODE_15'\n  }\n  return 'OPCODE_' + opcode\n}\n\nexports.toOpcode = function (code) {\n  switch (code.toUpperCase()) {\n    case 'QUERY': return 0\n    case 'IQUERY': return 1\n    case 'STATUS': return 2\n    case 'OPCODE_3': return 3\n    case 'NOTIFY': return 4\n    case 'UPDATE': return 5\n    case 'OPCODE_6': return 6\n    case 'OPCODE_7': return 7\n    case 'OPCODE_8': return 8\n    case 'OPCODE_9': return 9\n    case 'OPCODE_10': return 10\n    case 'OPCODE_11': return 11\n    case 'OPCODE_12': return 12\n    case 'OPCODE_13': return 13\n    case 'OPCODE_14': return 14\n    case 'OPCODE_15': return 15\n  }\n  return 0\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\n// 7.1.  Change Cipher Spec Protocol\n\nexport class ChangeCipherSpec {\n  static readonly spec = {\n    type: types.uint8,\n  };\n\n  constructor(public type = 1) {}\n\n  static createEmpty() {\n    return new ChangeCipherSpec();\n  }\n\n  static deSerialize(buf: Buffer) {\n    return new ChangeCipherSpec(\n      //@ts-ignore\n      ...Object.values(decode(buf, ChangeCipherSpec.spec)),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, ChangeCipherSpec.spec).slice();\n    return Buffer.from(res);\n  }\n}\n","import {\n  type RemoteInfo,\n  type Socket,\n  type SocketType,\n  createSocket,\n} from \"dgram\";\n\nimport net from \"net\";\n\nimport { type AddressInfo, type Socket as TcpSocket, connect } from \"net\";\nimport { debug } from \"./log\";\nimport {\n  type Address,\n  type InterfaceAddresses,\n  findPort,\n  interfaceAddress,\n  normalizeFamilyNodeV18,\n} from \"./network\";\n\nconst log = debug(\"werift-ice:packages/ice/src/transport.ts\");\n\nexport class UdpTransport implements Transport {\n  readonly type = \"udp\";\n  readonly socket: Socket;\n  rinfo?: Partial<Pick<RemoteInfo, \"address\" | \"port\">>;\n  onData: (data: Buffer, addr: Address) => void = () => {};\n  closed: boolean = false;\n\n  private constructor(\n    private socketType: SocketType,\n    private options: {\n      portRange?: [number, number];\n      interfaceAddresses?: InterfaceAddresses;\n      port?: number;\n    } = {},\n  ) {\n    this.socket = createSocket(socketType);\n    this.socket.on(\"message\", (data, info) => {\n      if (normalizeFamilyNodeV18(info.family) === 6) {\n        [info.address] = info.address.split(\"%\"); // example fe80::1d3a:8751:4ffd:eb80%wlp82s0\n      }\n      this.rinfo = info;\n      try {\n        this.onData(data, [info.address, info.port]);\n      } catch (error) {\n        log(\"onData error\", error);\n      }\n    });\n  }\n\n  static async init(\n    type: SocketType,\n    options: {\n      portRange?: [number, number];\n      port?: number;\n      interfaceAddresses?: InterfaceAddresses;\n    } = {},\n  ) {\n    const transport = new UdpTransport(type, options);\n    await transport.init();\n    return transport;\n  }\n\n  private async init() {\n    const address = interfaceAddress(\n      this.socketType,\n      this.options.interfaceAddresses,\n    );\n    if (this.options.port) {\n      this.socket.bind({ port: this.options.port, address });\n    } else if (this.options.portRange) {\n      const port = await findPort(\n        this.options.portRange[0],\n        this.options.portRange[1],\n        this.socketType,\n        this.options.interfaceAddresses,\n      );\n      this.socket.bind({ port, address });\n    } else {\n      this.socket.bind({ address });\n    }\n    await new Promise((r) => this.socket.once(\"listening\", r));\n  }\n\n  send = async (data: Buffer, addr?: Address) => {\n    if (addr && !net.isIP(addr[0])) {\n      // if address is not resolved, need to use send callback to handle dns failure.\n      return new Promise<void>((r, f) => {\n        this.socket.send(data, addr![1], addr![0], (error) => {\n          if (error) {\n            log(\"send error\", addr, data);\n            f(error);\n          } else {\n            r();\n          }\n        });\n      });\n    } else {\n      addr = addr ?? [this.rinfo?.address!, this.rinfo?.port!];\n      // a preestablished remote address does not need a callback to verify dns.\n      // this is faster because event loop is not used per packet.\n      this.socket.send(data, addr[1], addr[0]);\n    }\n  };\n\n  get address() {\n    return this.socket.address();\n  }\n\n  get host() {\n    return this.socket.address().address;\n  }\n\n  get port() {\n    return this.socket.address().port;\n  }\n\n  close = () =>\n    new Promise<void>((r) => {\n      this.closed = true;\n      this.socket.once(\"close\", r);\n      try {\n        this.socket.close();\n      } catch (error) {\n        r();\n      }\n    });\n}\n\nexport class TcpTransport implements Transport {\n  readonly type = \"tcp\";\n  private connecting!: Promise<void>;\n  private client!: TcpSocket;\n  onData: (data: Buffer, addr: Address) => void = () => {};\n  closed = false;\n\n  private constructor(private addr: Address) {\n    this.connect();\n  }\n\n  private connect() {\n    if (this.closed) {\n      return;\n    }\n\n    if (this.client) {\n      this.client.destroy();\n    }\n    this.connecting = new Promise((r, f) => {\n      try {\n        this.client = connect({ port: this.addr[1], host: this.addr[0] }, r);\n      } catch (error) {\n        f(error);\n      }\n    });\n\n    this.client.on(\"data\", (data) => {\n      const addr = [\n        this.client.remoteAddress!,\n        this.client.remotePort!,\n      ] as Address;\n      this.onData(data, addr);\n    });\n    this.client.on(\"end\", () => {\n      this.connect();\n    });\n    this.client.on(\"error\", (error) => {\n      console.log(\"error\", error);\n    });\n  }\n\n  private async init() {\n    await this.connecting;\n  }\n\n  static async init(addr: Address) {\n    const transport = new TcpTransport(addr);\n    await transport.init();\n    return transport;\n  }\n\n  get address() {\n    return {} as AddressInfo;\n  }\n\n  send = async (data: Buffer, addr?: Address) => {\n    await this.connecting;\n    this.client.write(data, (err) => {\n      if (err) {\n        console.log(\"err\", err);\n      }\n    });\n  };\n\n  close = async () => {\n    this.closed = true;\n    this.client.destroy();\n  };\n}\n\nexport interface Transport {\n  type: string;\n  address: AddressInfo;\n  closed: boolean;\n  onData: (data: Buffer, addr: Address) => void;\n  send: (data: Buffer, addr?: Address) => Promise<void>;\n  close: () => Promise<void>;\n}\n","import { getBit, paddingByte } from \"../../../common/src\";\nimport type { RtpHeader } from \"../rtp/rtp\";\nimport type { DePacketizerBase } from \"./base\";\n\n// RFC 7741 - RTP Payload Format for VP8 Video\n\n//        0 1 2 3 4 5 6 7                      0 1 2 3 4 5 6 7\n//       +-+-+-+-+-+-+-+-+                   +-+-+-+-+-+-+-+-+\n//       |X|R|N|S|R| PID | (REQUIRED)        |X|R|N|S|R| PID | (REQUIRED)\n//       +-+-+-+-+-+-+-+-+                   +-+-+-+-+-+-+-+-+\n//  X:   |I|L|T|K| RSV   | (OPTIONAL)   X:   |I|L|T|K| RSV   | (OPTIONAL)\n//       +-+-+-+-+-+-+-+-+                   +-+-+-+-+-+-+-+-+\n//  I:   |M| PictureID   | (OPTIONAL)   I:   |M| PictureID   | (OPTIONAL)\n//       +-+-+-+-+-+-+-+-+                   +-+-+-+-+-+-+-+-+\n//  L:   |   TL0PICIDX   | (OPTIONAL)        |   PictureID   |\n//       +-+-+-+-+-+-+-+-+                   +-+-+-+-+-+-+-+-+\n//  T/K: |TID|Y| KEYIDX  | (OPTIONAL)   L:   |   TL0PICIDX   | (OPTIONAL)\n//       +-+-+-+-+-+-+-+-+                   +-+-+-+-+-+-+-+-+\n//                                      T/K: |TID|Y| KEYIDX  | (OPTIONAL)\n//                                           +-+-+-+-+-+-+-+-+\n\n// 0 1 2 3 4 5 6 7\n// +-+-+-+-+-+-+-+-+\n// |Size0|H| VER |P|\n// +-+-+-+-+-+-+-+-+\n// |     Size1     |\n// +-+-+-+-+-+-+-+-+\n// |     Size2     |\n// +-+-+-+-+-+-+-+-+\n// | Octets 4..N of|\n// | VP8 payload   |\n// :               :\n// +-+-+-+-+-+-+-+-+\n// | OPTIONAL RTP  |\n// | padding       |\n// :               :\n// +-+-+-+-+-+-+-+-+\n\nexport class Vp8RtpPayload implements DePacketizerBase {\n  xBit!: number;\n  nBit!: number;\n  sBit!: number;\n  pid!: number;\n  iBit?: number;\n  lBit?: number;\n  tBit?: number;\n  kBit?: number;\n  mBit?: number;\n  pictureId?: number;\n  payload!: Buffer;\n  size0 = 0;\n  hBit?: number;\n  ver?: number;\n  pBit?: number;\n  size1 = 0;\n  size2 = 0;\n\n  static deSerialize(buf: Buffer) {\n    const p = new Vp8RtpPayload();\n\n    let offset = 0;\n\n    p.xBit = getBit(buf[offset], 0);\n    p.nBit = getBit(buf[offset], 2);\n    p.sBit = getBit(buf[offset], 3);\n    p.pid = getBit(buf[offset], 5, 3);\n    offset++;\n\n    if (p.xBit) {\n      p.iBit = getBit(buf[offset], 0);\n      p.lBit = getBit(buf[offset], 1);\n      p.tBit = getBit(buf[offset], 2);\n      p.kBit = getBit(buf[offset], 3);\n      offset++;\n    }\n\n    if (p.iBit) {\n      p.mBit = getBit(buf[offset], 0);\n      if (p.mBit) {\n        const _7 = paddingByte(getBit(buf[offset], 1, 7));\n        const _8 = paddingByte(buf[offset + 1]);\n        p.pictureId = Number.parseInt(_7 + _8, 2);\n        offset += 2;\n      } else {\n        p.pictureId = getBit(buf[offset], 1, 7);\n        offset++;\n      }\n    }\n\n    if (p.lBit) {\n      offset++;\n    }\n\n    if (p.lBit || p.kBit) {\n      if (p.tBit) {\n      }\n      if (p.kBit) {\n      }\n      offset++;\n    }\n\n    p.payload = buf.subarray(offset);\n\n    if (p.payloadHeaderExist) {\n      p.size0 = getBit(buf[offset], 0, 3);\n      p.hBit = getBit(buf[offset], 3);\n      p.ver = getBit(buf[offset], 4, 3);\n      p.pBit = getBit(buf[offset], 7);\n      offset++;\n      p.size1 = buf[offset];\n      offset++;\n      p.size2 = buf[offset];\n    }\n\n    return p;\n  }\n\n  static isDetectedFinalPacketInSequence(header: RtpHeader) {\n    return header.marker;\n  }\n\n  get isKeyframe() {\n    return this.pBit === 0;\n  }\n\n  get isPartitionHead() {\n    return this.sBit === 1;\n  }\n\n  get payloadHeaderExist() {\n    return this.sBit === 1 && this.pid === 0;\n  }\n\n  get size() {\n    if (this.payloadHeaderExist) {\n      const size = this.size0 + 8 * this.size1 + 2048 * this.size2;\n      return size;\n    }\n    return 0;\n  }\n}\n","import { DISCARD_HOST, DISCARD_PORT } from \"./const\";\nimport type { RTCRtpTransceiver } from \"./media\";\nimport { RTCRtpSimulcastParameters } from \"./media/parameters\";\nimport type { MediaDirection } from \"./media/rtpTransceiver\";\nimport {\n  type BundlePolicy,\n  GroupDescription,\n  MediaDescription,\n  SessionDescription,\n  SsrcDescription,\n  addSDPHeader,\n} from \"./sdp\";\nimport type { RTCDtlsTransport } from \"./transport/dtls\";\nimport { RTCSctpTransport } from \"./transport/sctp\";\nimport { andDirection } from \"./utils\";\n\nexport class SDPManager {\n  currentLocalDescription?: SessionDescription;\n  currentRemoteDescription?: SessionDescription;\n  pendingLocalDescription?: SessionDescription;\n  pendingRemoteDescription?: SessionDescription;\n  readonly cname: string;\n  readonly midSuffix: boolean;\n  readonly bundlePolicy?: BundlePolicy;\n\n  private seenMid = new Set<string>();\n\n  constructor({\n    cname,\n    midSuffix,\n    bundlePolicy,\n  }: { cname: string; midSuffix?: boolean; bundlePolicy?: BundlePolicy }) {\n    this.cname = cname;\n    this.midSuffix = midSuffix ?? false;\n    this.bundlePolicy = bundlePolicy;\n  }\n\n  get localDescription() {\n    if (!this._localDescription) {\n      return undefined;\n    }\n    return this._localDescription.toJSON();\n  }\n\n  get remoteDescription() {\n    if (!this._remoteDescription) {\n      return undefined;\n    }\n    return this._remoteDescription.toJSON();\n  }\n\n  /**@private */\n  get _localDescription() {\n    return this.pendingLocalDescription || this.currentLocalDescription;\n  }\n\n  /**@private */\n  get _remoteDescription() {\n    return this.pendingRemoteDescription || this.currentRemoteDescription;\n  }\n\n  get inactiveRemoteMedia() {\n    return this._remoteDescription?.media?.find?.(\n      (m) => m.direction === \"inactive\",\n    );\n  }\n\n  /**\n   * MediaDescription\n   */\n  createMediaDescriptionForTransceiver(\n    transceiver: RTCRtpTransceiver,\n    direction: MediaDirection,\n  ): MediaDescription {\n    const media = new MediaDescription(\n      transceiver.kind,\n      9,\n      \"UDP/TLS/RTP/SAVPF\",\n      transceiver.codecs.map((c) => c.payloadType),\n    );\n    media.direction = direction;\n    media.msid = transceiver.msid;\n    media.rtp = {\n      codecs: transceiver.codecs,\n      headerExtensions: transceiver.headerExtensions,\n      muxId: transceiver.mid,\n    };\n    media.rtcpHost = \"0.0.0.0\";\n    media.rtcpPort = 9;\n    media.rtcpMux = true;\n    media.ssrc = [\n      new SsrcDescription({ ssrc: transceiver.sender.ssrc, cname: this.cname }),\n    ];\n\n    if (transceiver.options.simulcast) {\n      media.simulcastParameters = transceiver.options.simulcast.map(\n        (o) => new RTCRtpSimulcastParameters(o),\n      );\n    }\n\n    if (media.rtp.codecs.find((c) => c.name.toLowerCase() === \"rtx\")) {\n      media.ssrc.push(\n        new SsrcDescription({\n          ssrc: transceiver.sender.rtxSsrc,\n          cname: this.cname,\n        }),\n      );\n      media.ssrcGroup = [\n        new GroupDescription(\"FID\", [\n          transceiver.sender.ssrc.toString(),\n          transceiver.sender.rtxSsrc.toString(),\n        ]),\n      ];\n    }\n\n    this.addTransportDescription(media, transceiver.dtlsTransport);\n    return media;\n  }\n\n  /**\n   * MediaDescriptionSCTP\n   */\n  createMediaDescriptionForSctp(sctp: RTCSctpTransport): MediaDescription {\n    const media = new MediaDescription(\n      \"application\",\n      DISCARD_PORT,\n      \"UDP/DTLS/SCTP\",\n      [\"webrtc-datachannel\"],\n    );\n    media.sctpPort = sctp.port;\n    media.rtp.muxId = sctp.mid;\n    media.sctpCapabilities = RTCSctpTransport.getCapabilities();\n\n    this.addTransportDescription(media, sctp.dtlsTransport);\n    return media;\n  }\n\n  /**\n   * MediaDescription\n   */\n  addTransportDescription(\n    media: MediaDescription,\n    dtlsTransport: RTCDtlsTransport,\n  ): void {\n    const iceTransport = dtlsTransport.iceTransport;\n\n    media.iceCandidates = iceTransport.localCandidates;\n    media.iceCandidatesComplete = iceTransport.gatheringState === \"complete\";\n    media.iceParams = iceTransport.localParameters;\n    media.iceOptions = \"trickle\";\n\n    media.host = DISCARD_HOST;\n    media.port = DISCARD_PORT;\n\n    if (media.direction === \"inactive\") {\n      media.port = 0;\n      media.msid = undefined;\n    }\n\n    if (!media.dtlsParams) {\n      media.dtlsParams = dtlsTransport.localParameters;\n      if (!media.dtlsParams.fingerprints) {\n        media.dtlsParams.fingerprints =\n          dtlsTransport.localParameters.fingerprints;\n      }\n    }\n  }\n\n  /**\n   * MID\n   */\n  allocateMid(type: \"dc\" | \"av\" | \"\" = \"\"): string {\n    let mid = \"\";\n    for (let i = 0; ; ) {\n      // rfc9143.html#name-security-considerations\n      // SHOULD be 3 bytes or fewer to allow them to efficiently fit into the MID RTP header extension\n      mid = (i++).toString() + type;\n      if (!this.seenMid.has(mid)) break;\n    }\n    this.seenMid.add(mid);\n    return mid;\n  }\n\n  parseSdp({\n    sdp,\n    isLocal,\n    signalingState,\n    type,\n  }: {\n    sdp: string;\n    isLocal: boolean;\n    signalingState: string;\n    type: \"offer\" | \"answer\";\n  }): SessionDescription {\n    const description = SessionDescription.parse(sdp);\n    this.validateDescription({ description, isLocal, signalingState });\n    description.type = type;\n    return description;\n  }\n\n  private validateDescription({\n    description,\n    isLocal,\n    signalingState,\n  }: {\n    description: SessionDescription;\n    isLocal: boolean;\n    signalingState: string;\n  }) {\n    if (isLocal) {\n      if (description.type === \"offer\") {\n        if (![\"stable\", \"have-local-offer\"].includes(signalingState))\n          throw new Error(\"Cannot handle offer in signaling state\");\n      } else if (description.type === \"answer\") {\n        if (\n          ![\"have-remote-offer\", \"have-local-pranswer\"].includes(signalingState)\n        ) {\n          throw new Error(\"Cannot handle answer in signaling state\");\n        }\n      }\n    } else {\n      if (description.type === \"offer\") {\n        if (![\"stable\", \"have-remote-offer\"].includes(signalingState)) {\n          throw new Error(\"Cannot handle offer in signaling state\");\n        }\n      } else if (description.type === \"answer\") {\n        if (\n          ![\"have-local-offer\", \"have-remote-pranswer\"].includes(signalingState)\n        ) {\n          throw new Error(\"Cannot handle answer in signaling state\");\n        }\n      }\n    }\n  }\n\n  /**\n   * SDP\n   */\n  buildOfferSdp(\n    transceivers: RTCRtpTransceiver[],\n    sctpTransport: RTCSctpTransport | undefined,\n  ): SessionDescription {\n    const description = new SessionDescription();\n    addSDPHeader(\"offer\", description);\n\n    // # handle existing transceivers / sctp\n    const currentMedia = this.currentLocalDescription?.media ?? [];\n\n    currentMedia.forEach((m, i) => {\n      const mid = m.rtp.muxId;\n      if (!mid) {\n        return;\n      }\n      if (m.kind === \"application\") {\n        if (!sctpTransport) {\n          throw new Error(\"sctpTransport not found\");\n        }\n        sctpTransport.mLineIndex = i;\n        description.media.push(\n          this.createMediaDescriptionForSctp(sctpTransport),\n        );\n      } else {\n        const transceiver = transceivers.find((t) => t.mid === mid);\n        if (!transceiver) {\n          if (m.direction === \"inactive\") {\n            description.media.push(m);\n            return;\n          }\n          throw new Error(\"transceiver not found\");\n        }\n        transceiver.mLineIndex = i;\n        description.media.push(\n          this.createMediaDescriptionForTransceiver(\n            transceiver,\n            transceiver.direction,\n          ),\n        );\n      }\n    });\n\n    // # handle new transceivers / sctp\n    for (const transceiver of transceivers.filter(\n      (t) => !description.media.find((m) => m.rtp.muxId === t.mid),\n    )) {\n      if (transceiver.mid == undefined) {\n        transceiver.mid = this.allocateMid(this.midSuffix ? \"av\" : \"\");\n      }\n      const mediaDescription = this.createMediaDescriptionForTransceiver(\n        transceiver,\n        transceiver.direction,\n      );\n      if (transceiver.mLineIndex === undefined) {\n        transceiver.mLineIndex = description.media.length;\n        description.media.push(mediaDescription);\n      } else {\n        description.media[transceiver.mLineIndex] = mediaDescription;\n      }\n    }\n\n    if (\n      sctpTransport &&\n      !description.media.find((m) => m.kind === \"application\")\n    ) {\n      sctpTransport.mLineIndex = description.media.length;\n      if (sctpTransport.mid == undefined) {\n        sctpTransport.mid = this.allocateMid(this.midSuffix ? \"dc\" : \"\");\n      }\n      description.media.push(this.createMediaDescriptionForSctp(sctpTransport));\n    }\n\n    if (this.bundlePolicy !== \"disable\") {\n      const mids = description.media\n        .map((m) => (m.direction !== \"inactive\" ? m.rtp.muxId : undefined))\n        .filter((v) => v) as string[];\n      if (mids.length) {\n        const bundle = new GroupDescription(\"BUNDLE\", mids);\n        description.group.push(bundle);\n      }\n    }\n\n    return description;\n  }\n\n  /**\n   * SDP\n   */\n  buildAnswerSdp({\n    transceivers,\n    sctpTransport,\n    signalingState,\n  }: {\n    transceivers: RTCRtpTransceiver[];\n    sctpTransport: RTCSctpTransport | undefined;\n\n    signalingState: string;\n  }): SessionDescription {\n    if (\n      ![\"have-remote-offer\", \"have-local-pranswer\"].includes(signalingState)\n    ) {\n      throw new Error(\"createAnswer failed\");\n    }\n    if (!this._remoteDescription) {\n      throw new Error(\"wrong state\");\n    }\n\n    const description = new SessionDescription();\n    addSDPHeader(\"answer\", description);\n\n    for (const remoteMedia of this._remoteDescription.media) {\n      let dtlsTransport!: RTCDtlsTransport;\n      let media: MediaDescription;\n\n      if ([\"audio\", \"video\"].includes(remoteMedia.kind)) {\n        const transceiver = transceivers.find(\n          (t) => t.mid === remoteMedia.rtp.muxId,\n        );\n        if (!transceiver) {\n          throw new Error(\n            `Transceiver with mid=${remoteMedia.rtp.muxId} not found`,\n          );\n        }\n        media = this.createMediaDescriptionForTransceiver(\n          transceiver,\n          andDirection(transceiver.direction, transceiver.offerDirection),\n        );\n        dtlsTransport = transceiver.dtlsTransport;\n      } else if (remoteMedia.kind === \"application\") {\n        if (!sctpTransport || !sctpTransport.mid) {\n          throw new Error(\"sctpTransport not found\");\n        }\n        media = this.createMediaDescriptionForSctp(sctpTransport);\n\n        dtlsTransport = sctpTransport.dtlsTransport;\n      } else {\n        throw new Error(\"invalid kind\");\n      }\n\n      // # determine DTLS role, or preserve the currently configured role\n      if (media.dtlsParams) {\n        if (dtlsTransport.role === \"auto\") {\n          media.dtlsParams.role = \"client\";\n        } else {\n          media.dtlsParams.role = dtlsTransport.role;\n        }\n      }\n\n      // Simulcast\n      if (\n        remoteMedia.simulcastParameters &&\n        remoteMedia.simulcastParameters.length > 0\n      ) {\n        media.simulcastParameters = remoteMedia.simulcastParameters.map(\n          (v) => ({\n            ...v,\n            direction: v.direction === \"send\" ? \"recv\" : \"send\",\n          }),\n        );\n      }\n\n      description.media.push(media);\n    }\n\n    if (this.bundlePolicy !== \"disable\") {\n      const bundle = new GroupDescription(\"BUNDLE\", []);\n      for (const media of description.media) {\n        if (media.direction !== \"inactive\") {\n          bundle.items.push(media.rtp.muxId!);\n        }\n      }\n      description.group.push(bundle);\n    }\n\n    return description;\n  }\n\n  setLocalDescription(description: SessionDescription) {\n    this.currentLocalDescription = description;\n    if (description.type === \"answer\") {\n      this.pendingLocalDescription = undefined;\n    } else {\n      this.pendingLocalDescription = description;\n    }\n  }\n\n  setRemoteDescription(\n    sessionDescription: RTCSessionDescriptionInit,\n    signalingState: string,\n  ) {\n    if (\n      !sessionDescription.sdp ||\n      !sessionDescription.type ||\n      sessionDescription.type === \"rollback\" ||\n      sessionDescription.type === \"pranswer\"\n    ) {\n      throw new Error(\"invalid sessionDescription\");\n    }\n\n    // # parse and validate description\n    const remoteSdp = this.parseSdp({\n      sdp: sessionDescription.sdp,\n      isLocal: false,\n      signalingState,\n      type: sessionDescription.type,\n    });\n\n    if (remoteSdp.type === \"answer\") {\n      this.currentRemoteDescription = remoteSdp;\n      this.pendingRemoteDescription = undefined;\n    } else {\n      this.pendingRemoteDescription = remoteSdp;\n    }\n\n    return remoteSdp;\n  }\n\n  registerMid(mid: string): void {\n    this.seenMid.add(mid);\n  }\n\n  get remoteIsBundled() {\n    const remoteSdp = this._remoteDescription;\n    if (!remoteSdp) {\n      return undefined;\n    }\n    const bundle = remoteSdp.group.find(\n      (g) => g.semantic === \"BUNDLE\" && this.bundlePolicy !== \"disable\",\n    );\n    return bundle;\n  }\n\n  /**\n   * \n   */\n  setLocal(\n    description: SessionDescription,\n    transceivers: RTCRtpTransceiver[],\n    sctpTransport?: { dtlsTransport: RTCDtlsTransport; mid?: string },\n  ) {\n    description.media\n      .filter((m) => [\"audio\", \"video\"].includes(m.kind))\n      .forEach((m, i) => {\n        this.addTransportDescription(m, transceivers[i].dtlsTransport);\n      });\n    const sctpMedia = description.media.find((m) => m.kind === \"application\");\n    if (sctpTransport && sctpMedia) {\n      this.addTransportDescription(sctpMedia, sctpTransport.dtlsTransport);\n    }\n\n    this.setLocalDescription(description);\n  }\n}\n\nexport interface RTCSessionDescriptionInit {\n  sdp?: string;\n  type: RTCSdpType;\n}\nexport type RTCSdpType = \"answer\" | \"offer\" | \"pranswer\" | \"rollback\";\n","var packet = require('dns-packet')\nvar dgram = require('dgram')\nvar thunky = require('thunky')\nvar events = require('events')\nvar os = require('os')\n\nvar noop = function () {}\n\nmodule.exports = function (opts) {\n  if (!opts) opts = {}\n\n  var that = new events.EventEmitter()\n  var port = typeof opts.port === 'number' ? opts.port : 5353\n  var type = opts.type || 'udp4'\n  var ip = opts.ip || opts.host || (type === 'udp4' ? '224.0.0.251' : null)\n  var me = {address: ip, port: port}\n  var memberships = {}\n  var destroyed = false\n  var interval = null\n\n  if (type === 'udp6' && (!ip || !opts.interface)) {\n    throw new Error('For IPv6 multicast you must specify `ip` and `interface`')\n  }\n\n  var socket = opts.socket || dgram.createSocket({\n    type: type,\n    reuseAddr: opts.reuseAddr !== false,\n    toString: function () {\n      return type\n    }\n  })\n\n  socket.on('error', function (err) {\n    if (err.code === 'EACCES' || err.code === 'EADDRINUSE') that.emit('error', err)\n    else that.emit('warning', err)\n  })\n\n  socket.on('message', function (message, rinfo) {\n    try {\n      message = packet.decode(message)\n    } catch (err) {\n      that.emit('warning', err)\n      return\n    }\n\n    that.emit('packet', message, rinfo)\n\n    if (message.type === 'query') that.emit('query', message, rinfo)\n    if (message.type === 'response') that.emit('response', message, rinfo)\n  })\n\n  socket.on('listening', function () {\n    if (!port) port = me.port = socket.address().port\n    if (opts.multicast !== false) {\n      that.update()\n      interval = setInterval(that.update, 5000)\n      socket.setMulticastTTL(opts.ttl || 255)\n      socket.setMulticastLoopback(opts.loopback !== false)\n    }\n  })\n\n  var bind = thunky(function (cb) {\n    if (!port || opts.bind === false) return cb(null)\n    socket.once('error', cb)\n    socket.bind(port, opts.bind || opts.interface, function () {\n      socket.removeListener('error', cb)\n      cb(null)\n    })\n  })\n\n  bind(function (err) {\n    if (err) return that.emit('error', err)\n    that.emit('ready')\n  })\n\n  that.send = function (value, rinfo, cb) {\n    if (typeof rinfo === 'function') return that.send(value, null, rinfo)\n    if (!cb) cb = noop\n    if (!rinfo) rinfo = me\n    else if (!rinfo.host && !rinfo.address) rinfo.address = me.address\n\n    bind(onbind)\n\n    function onbind (err) {\n      if (destroyed) return cb()\n      if (err) return cb(err)\n      var message = packet.encode(value)\n      socket.send(message, 0, message.length, rinfo.port, rinfo.address || rinfo.host, cb)\n    }\n  }\n\n  that.response =\n  that.respond = function (res, rinfo, cb) {\n    if (Array.isArray(res)) res = {answers: res}\n\n    res.type = 'response'\n    res.flags = (res.flags || 0) | packet.AUTHORITATIVE_ANSWER\n    that.send(res, rinfo, cb)\n  }\n\n  that.query = function (q, type, rinfo, cb) {\n    if (typeof type === 'function') return that.query(q, null, null, type)\n    if (typeof type === 'object' && type && type.port) return that.query(q, null, type, rinfo)\n    if (typeof rinfo === 'function') return that.query(q, type, null, rinfo)\n    if (!cb) cb = noop\n\n    if (typeof q === 'string') q = [{name: q, type: type || 'ANY'}]\n    if (Array.isArray(q)) q = {type: 'query', questions: q}\n\n    q.type = 'query'\n    that.send(q, rinfo, cb)\n  }\n\n  that.destroy = function (cb) {\n    if (!cb) cb = noop\n    if (destroyed) return process.nextTick(cb)\n    destroyed = true\n    clearInterval(interval)\n\n    // Need to drop memberships by hand and ignore errors.\n    // socket.close() does not cope with errors.\n    for (var iface in memberships) {\n      try {\n        socket.dropMembership(ip, iface)\n      } catch (e) {\n        // eat it\n      }\n    }\n    memberships = {}\n    socket.close(cb)\n  }\n\n  that.update = function () {\n    var ifaces = opts.interface ? [].concat(opts.interface) : allInterfaces()\n    var updated = false\n\n    for (var i = 0; i < ifaces.length; i++) {\n      var addr = ifaces[i]\n      if (memberships[addr]) continue\n\n      try {\n        socket.addMembership(ip, addr)\n        memberships[addr] = true\n        updated = true\n      } catch (err) {\n        that.emit('warning', err)\n      }\n    }\n\n    if (updated) {\n      if (socket.setMulticastInterface) {\n        try {\n          socket.setMulticastInterface(opts.interface || defaultInterface())\n        } catch (err) {\n          that.emit('warning', err)\n        }\n      }\n      that.emit('networkInterface')\n    }\n  }\n\n  return that\n}\n\nfunction defaultInterface () {\n  var networks = os.networkInterfaces()\n  var names = Object.keys(networks)\n\n  for (var i = 0; i < names.length; i++) {\n    var net = networks[names[i]]\n    for (var j = 0; j < net.length; j++) {\n      var iface = net[j]\n      if (isIPv4(iface.family) && !iface.internal) {\n        if (os.platform() === 'darwin' && names[i] === 'en0') return iface.address\n        return '0.0.0.0'\n      }\n    }\n  }\n\n  return '127.0.0.1'\n}\n\nfunction allInterfaces () {\n  var networks = os.networkInterfaces()\n  var names = Object.keys(networks)\n  var res = []\n\n  for (var i = 0; i < names.length; i++) {\n    var net = networks[names[i]]\n    for (var j = 0; j < net.length; j++) {\n      var iface = net[j]\n      if (isIPv4(iface.family)) {\n        res.push(iface.address)\n        // could only addMembership once per interface (https://nodejs.org/api/dgram.html#dgram_socket_addmembership_multicastaddress_multicastinterface)\n        break\n      }\n    }\n  }\n\n  return res\n}\n\nfunction isIPv4 (family) { // for backwards compat\n  return family === 4 || family === 'IPv4'\n}\n","import { BitStream, bufferReader, bufferWriter } from \"../../../common/src\";\nimport type { Extension } from \"./rtp\";\n\nexport const RTP_EXTENSION_URI = {\n  sdesMid: \"urn:ietf:params:rtp-hdrext:sdes:mid\",\n  sdesRTPStreamID: \"urn:ietf:params:rtp-hdrext:sdes:rtp-stream-id\",\n  repairedRtpStreamId: \"urn:ietf:params:rtp-hdrext:sdes:repaired-rtp-stream-id\",\n  transportWideCC:\n    \"http://www.ietf.org/id/draft-holmer-rmcat-transport-wide-cc-extensions-01\",\n  absSendTime: \"http://www.webrtc.org/experiments/rtp-hdrext/abs-send-time\",\n  dependencyDescriptor:\n    \"https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension\",\n  audioLevelIndication: \"urn:ietf:params:rtp-hdrext:ssrc-audio-level\",\n  videoOrientation: \"urn:3gpp:video-orientation\",\n} as const;\n\nexport type TransportWideCCPayload = number;\n\nexport type AudioLevelIndicationPayload = { v: boolean; level: number };\nexport interface videoOrientationPayload {\n  /**\n   Camera: indicates the direction of the camera used for this video stream. It can be used by the MTSI client in\n  receiver to e.g. display the received video differently depending on the source camera.\n  0: Front-facing camera, facing the user. If camera direction is unknown by the sending MTSI client in the terminal\n  then this is the default value used.\n  1: Back-facing camera, facing away from the user. \n */\n  c: number;\n  /**\n   F = Flip: indicates a horizontal (left-right flip) mirror operation on the video as sent on the link.\n  0: No flip operation. If the sending MTSI client in terminal does not know if a horizontal mirror operation is\n  necessary, then this is the default value used.\n  1: Horizontal flip operation \n   */\n  f: number;\n  /**\n   R1, R0 = Rotation: indicates the rotation of the video as transmitted on the link. The receiver should rotate the video to\n  compensate that rotation. E.g. a 90 Counter Clockwise rotation should be compensated by the receiver with a 90\n  Clockwise rotation prior to displaying. \n\n    +----+----+-----------------------------------------------+------------------------------+\n  | R1 | R0 | Rotation of the video as sent on the link     | Rotation on the receiver      |\n  |    |    |                                               | before display                |\n  +----+----+-----------------------------------------------+------------------------------+\n  |  0 |  0 | 0 rotation                                   | None                         |\n  +----+----+-----------------------------------------------+------------------------------+\n  |  0 |  1 | 90 Counter Clockwise (CCW) rotation or 270  | 90 Clockwise (CW) rotation  |\n  |    |    | Clockwise (CW) rotation                       |                              |\n  +----+----+-----------------------------------------------+------------------------------+\n  |  1 |  0 | 180 CCW rotation or 180 CW rotation         | 180 CW rotation             |\n  +----+----+-----------------------------------------------+------------------------------+\n  |  1 |  1 | 270 CCW rotation or 90 CW rotation          | 90 CCW rotation             |\n  +----+----+-----------------------------------------------+------------------------------+\n\n   */\n  r1: number;\n  r0: number;\n}\n\nexport interface Extensions {\n  [uri: string]: any;\n}\n\nexport function rtpHeaderExtensionsParser(\n  extensions: Extension[],\n  extIdUriMap: { [id: number]: string },\n): Extensions {\n  return extensions\n    .map((extension) => {\n      const uri = extIdUriMap[extension.id];\n      if (!uri) {\n        return { uri: \"unknown\", value: extension.payload };\n      }\n      switch (uri) {\n        case RTP_EXTENSION_URI.sdesMid:\n        case RTP_EXTENSION_URI.sdesRTPStreamID:\n        case RTP_EXTENSION_URI.repairedRtpStreamId:\n          return { uri, value: deserializeString(extension.payload) };\n        case RTP_EXTENSION_URI.transportWideCC:\n          return { uri, value: deserializeUint16BE(extension.payload) };\n        case RTP_EXTENSION_URI.absSendTime:\n          return {\n            uri,\n            value: deserializeAbsSendTime(extension.payload),\n          };\n        case RTP_EXTENSION_URI.audioLevelIndication: {\n          return {\n            uri,\n            value: deserializeAudioLevelIndication(extension.payload),\n          };\n        }\n        case RTP_EXTENSION_URI.videoOrientation:\n          return { uri, value: deserializeVideoOrientation(extension.payload) };\n        default:\n          return { uri, value: extension.payload };\n      }\n    })\n    .reduce((acc: { [uri: string]: any }, cur) => {\n      if (cur) acc[cur.uri] = cur.value;\n      return acc;\n    }, {});\n}\n\nexport function serializeSdesMid(id: string) {\n  return Buffer.from(id);\n}\n\nexport function serializeSdesRTPStreamID(id: string) {\n  return Buffer.from(id);\n}\n\nexport function serializeRepairedRtpStreamId(id: string) {\n  return Buffer.from(id);\n}\n\nexport function serializeTransportWideCC(transportSequenceNumber: number) {\n  return bufferWriter([2], [transportSequenceNumber]);\n}\n\nexport function serializeAbsSendTime(ntpTime: bigint) {\n  const buf = Buffer.alloc(3);\n  const time = (ntpTime >> 14n) & 0x00ffffffn;\n  buf.writeUIntBE(Number(time), 0, 3);\n  return buf;\n}\n\nexport function serializeAudioLevelIndication(level: number) {\n  const stream = new BitStream(Buffer.alloc(1));\n  stream.writeBits(1, 1);\n  stream.writeBits(7, level);\n\n  return stream.uint8Array;\n}\n\nexport function deserializeString(buf: Buffer) {\n  return buf.toString();\n}\n\nexport function deserializeUint16BE(buf: Buffer) {\n  return buf.readUInt16BE();\n}\n\nexport function deserializeAbsSendTime(buf: Buffer) {\n  return bufferReader(buf, [3])[0];\n}\n\nexport function deserializeAudioLevelIndication(buf: Buffer) {\n  const stream = new BitStream(buf);\n  const value: AudioLevelIndicationPayload = {\n    v: stream.readBits(1) === 1,\n    level: stream.readBits(7),\n  };\n  return value;\n}\n\nexport function deserializeVideoOrientation(payload: Buffer) {\n  const stream = new BitStream(payload);\n  stream.readBits(4);\n  const value: videoOrientationPayload = {\n    c: stream.readBits(1),\n    f: stream.readBits(1),\n    r1: stream.readBits(1),\n    r0: stream.readBits(1),\n  };\n  return value;\n}\n","'use strict';\n\nconst crc32By4 = require('./crc32-by-4');\n\nmodule.exports = crc32;\n\n/**\n * @private\n * @param {Array<number[]>} table Lookup table.\n * @param {Buffer} buf Source data.\n * @param {number} input\n * @param {number} offset\n * @returns {number}\n */\nfunction crc32(table, buf, input, offset) {\n  let pointer = offset;\n  let crc = input;\n\n  for (let i = pointer; i + 8 < buf.length; i += 8) {\n    const byte1 = buf.readUInt32LE(i) ^ crc;\n    const byte2 = buf.readUInt32LE(i + 4);\n\n    crc =\n      table[0][(byte2 >>> 24) & 0xff] ^\n      table[1][(byte2 >>> 16) & 0xff] ^\n      table[2][(byte2 >>> 8) & 0xff] ^\n      table[3][byte2 & 0xff] ^\n      table[4][(byte1 >>> 24) & 0xff] ^\n      table[5][(byte1 >>> 16) & 0xff] ^\n      table[6][(byte1 >>> 8) & 0xff] ^\n      table[7][byte1 & 0xff];\n    pointer += 8;\n  }\n\n  return crc32By4(table, buf, crc, pointer);\n}\n","import { Readable } from 'stream';\nimport { once } from 'events';\n\nexport async function read16BELengthLoop(readable: Readable, options: {\n  headerLength: number;\n  offset?: number;\n  // optionally skip a header, and pause loop parsing until calee resumes.\n  skipHeader?: (header: Buffer, resumeRead: () => void) => boolean;\n  callback: (header: Buffer, data: Buffer) => void;\n}) {\n  let error: Error;\n  const { skipHeader, callback } = options;\n  const offset = options.offset || 0;\n  const headerLength = options.headerLength || 2;\n\n  readable.on('error', e => error = e);\n\n  let header: Buffer;\n  let length: number;\n  let skipCount = 0;\n  let readCount = 0;\n\n  const resumeRead = () => {\n    readCount++;\n    read();\n  }\n\n  const read = () => {\n    while (true) {\n      if (skipCount !== readCount)\n        return;\n      if (!header) {\n        header = readable.read(headerLength);\n        if (!header)\n          return;\n        if (skipHeader?.(header, resumeRead)) {\n          skipCount++;\n          header = undefined;\n          continue;\n        }\n        length = header.readUInt16BE(offset);\n      }\n      else {\n        const data = readable.read(length);\n        if (!data)\n          return;\n        callback(header, data);\n        header = undefined;\n      }\n    }\n  };\n\n  read();\n  readable.on('readable', read);\n\n  await once(readable, 'end');\n  throw new StreamEndError('read16BELengthLoop');\n}\n\nexport class StreamEndError extends Error {\n  constructor(where: string) {\n    super(`stream ended: ${where}`);\n  }\n}\n\nexport async function readLength(readable: Readable, length: number): Promise<Buffer> {\n  if (readable.readableEnded || readable.destroyed)\n    throw new StreamEndError('readLength start');\n\n  if (!length) {\n    return Buffer.alloc(0);\n  }\n\n  {\n    const ret = readable.read(length);\n    if (ret) {\n      return ret;\n    }\n  }\n\n  return new Promise((resolve, reject) => {\n    const r = () => {\n      const ret = readable.read(length);\n      if (ret) {\n        cleanup();\n        resolve(ret);\n        return;\n      }\n\n      if (readable.readableEnded || readable.destroyed)\n        reject(new StreamEndError('readLength readable'));\n    };\n\n    const e = () => {\n      cleanup();\n      reject(new StreamEndError('readLength end'));\n    };\n\n    const cleanup = () => {\n      readable.removeListener('readable', r);\n      readable.removeListener('end', e);\n    }\n\n    readable.on('readable', r);\n    readable.on('end', e);\n  });\n}\n\nconst CHARCODE_NEWLINE = '\\n'.charCodeAt(0);\n\nexport async function readUntil(readable: Readable, charCode: number) {\n  const queued: Buffer[] = [];\n  while (true) {\n    const available: Buffer = readable.read();\n    if (!available) {\n      await once(readable, 'readable');\n      continue;\n    }\n    const index = available.findIndex(b => b === charCode);\n    if (index === -1) {\n      queued.push(available);\n      continue;\n    }\n\n    const before = available.subarray(0, index);\n    queued.push(before);\n\n    const after = available.subarray(index + 1);\n    readable.unshift(after);\n    return Buffer.concat(queued).toString();\n  }\n}\n\nexport async function readLine(readable: Readable) {\n  return readUntil(readable, CHARCODE_NEWLINE);\n}\n\nexport async function readString(readable: Readable | Promise<Readable>) {\n  const buffer = await readBuffer(readable);\n  return buffer.toString();\n}\n\nexport async function readBuffer(readable: Readable | Promise<Readable>) {\n  const buffers: Buffer[] = [];\n  readable = await readable;\n  readable.on('data', buffer => {\n    buffers.push(buffer);\n  });\n  readable.resume();\n  await once(readable, 'end')\n  return Buffer.concat(buffers);\n}\n","'use strict'\n\nexports.toString = function (type) {\n  switch (type) {\n    // list at\n    // https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml#dns-parameters-11\n    case 1: return 'LLQ'\n    case 2: return 'UL'\n    case 3: return 'NSID'\n    case 5: return 'DAU'\n    case 6: return 'DHU'\n    case 7: return 'N3U'\n    case 8: return 'CLIENT_SUBNET'\n    case 9: return 'EXPIRE'\n    case 10: return 'COOKIE'\n    case 11: return 'TCP_KEEPALIVE'\n    case 12: return 'PADDING'\n    case 13: return 'CHAIN'\n    case 14: return 'KEY_TAG'\n    case 26946: return 'DEVICEID'\n  }\n  if (type < 0) {\n    return null\n  }\n  return `OPTION_${type}`\n}\n\nexports.toCode = function (name) {\n  if (typeof name === 'number') {\n    return name\n  }\n  if (!name) {\n    return -1\n  }\n  switch (name.toUpperCase()) {\n    case 'OPTION_0': return 0\n    case 'LLQ': return 1\n    case 'UL': return 2\n    case 'NSID': return 3\n    case 'OPTION_4': return 4\n    case 'DAU': return 5\n    case 'DHU': return 6\n    case 'N3U': return 7\n    case 'CLIENT_SUBNET': return 8\n    case 'EXPIRE': return 9\n    case 'COOKIE': return 10\n    case 'TCP_KEEPALIVE': return 11\n    case 'PADDING': return 12\n    case 'CHAIN': return 13\n    case 'KEY_TAG': return 14\n    case 'DEVICEID': return 26946\n    case 'OPTION_65535': return 65535\n  }\n  const m = name.match(/_(\\d+)$/)\n  if (m) {\n    return parseInt(m[1], 10)\n  }\n  return -1\n}\n","'use strict';\nconst os = require('os');\nconst tty = require('tty');\nconst hasFlag = require('has-flag');\n\nconst {env} = process;\n\nlet forceColor;\nif (hasFlag('no-color') ||\n\thasFlag('no-colors') ||\n\thasFlag('color=false') ||\n\thasFlag('color=never')) {\n\tforceColor = 0;\n} else if (hasFlag('color') ||\n\thasFlag('colors') ||\n\thasFlag('color=true') ||\n\thasFlag('color=always')) {\n\tforceColor = 1;\n}\n\nif ('FORCE_COLOR' in env) {\n\tif (env.FORCE_COLOR === 'true') {\n\t\tforceColor = 1;\n\t} else if (env.FORCE_COLOR === 'false') {\n\t\tforceColor = 0;\n\t} else {\n\t\tforceColor = env.FORCE_COLOR.length === 0 ? 1 : Math.min(parseInt(env.FORCE_COLOR, 10), 3);\n\t}\n}\n\nfunction translateLevel(level) {\n\tif (level === 0) {\n\t\treturn false;\n\t}\n\n\treturn {\n\t\tlevel,\n\t\thasBasic: true,\n\t\thas256: level >= 2,\n\t\thas16m: level >= 3\n\t};\n}\n\nfunction supportsColor(haveStream, streamIsTTY) {\n\tif (forceColor === 0) {\n\t\treturn 0;\n\t}\n\n\tif (hasFlag('color=16m') ||\n\t\thasFlag('color=full') ||\n\t\thasFlag('color=truecolor')) {\n\t\treturn 3;\n\t}\n\n\tif (hasFlag('color=256')) {\n\t\treturn 2;\n\t}\n\n\tif (haveStream && !streamIsTTY && forceColor === undefined) {\n\t\treturn 0;\n\t}\n\n\tconst min = forceColor || 0;\n\n\tif (env.TERM === 'dumb') {\n\t\treturn min;\n\t}\n\n\tif (process.platform === 'win32') {\n\t\t// Windows 10 build 10586 is the first Windows release that supports 256 colors.\n\t\t// Windows 10 build 14931 is the first release that supports 16m/TrueColor.\n\t\tconst osRelease = os.release().split('.');\n\t\tif (\n\t\t\tNumber(osRelease[0]) >= 10 &&\n\t\t\tNumber(osRelease[2]) >= 10586\n\t\t) {\n\t\t\treturn Number(osRelease[2]) >= 14931 ? 3 : 2;\n\t\t}\n\n\t\treturn 1;\n\t}\n\n\tif ('CI' in env) {\n\t\tif (['TRAVIS', 'CIRCLECI', 'APPVEYOR', 'GITLAB_CI', 'GITHUB_ACTIONS', 'BUILDKITE'].some(sign => sign in env) || env.CI_NAME === 'codeship') {\n\t\t\treturn 1;\n\t\t}\n\n\t\treturn min;\n\t}\n\n\tif ('TEAMCITY_VERSION' in env) {\n\t\treturn /^(9\\.(0*[1-9]\\d*)\\.|\\d{2,}\\.)/.test(env.TEAMCITY_VERSION) ? 1 : 0;\n\t}\n\n\tif (env.COLORTERM === 'truecolor') {\n\t\treturn 3;\n\t}\n\n\tif ('TERM_PROGRAM' in env) {\n\t\tconst version = parseInt((env.TERM_PROGRAM_VERSION || '').split('.')[0], 10);\n\n\t\tswitch (env.TERM_PROGRAM) {\n\t\t\tcase 'iTerm.app':\n\t\t\t\treturn version >= 3 ? 3 : 2;\n\t\t\tcase 'Apple_Terminal':\n\t\t\t\treturn 2;\n\t\t\t// No default\n\t\t}\n\t}\n\n\tif (/-256(color)?$/i.test(env.TERM)) {\n\t\treturn 2;\n\t}\n\n\tif (/^screen|^xterm|^vt100|^vt220|^rxvt|color|ansi|cygwin|linux/i.test(env.TERM)) {\n\t\treturn 1;\n\t}\n\n\tif ('COLORTERM' in env) {\n\t\treturn 1;\n\t}\n\n\treturn min;\n}\n\nfunction getSupportLevel(stream) {\n\tconst level = supportsColor(stream, stream && stream.isTTY);\n\treturn translateLevel(level);\n}\n\nmodule.exports = {\n\tsupportsColor: getSupportLevel,\n\tstdout: translateLevel(supportsColor(true, tty.isatty(1))),\n\tstderr: translateLevel(supportsColor(true, tty.isatty(2)))\n};\n","/**\n * Helpers.\n */\n\nvar s = 1000;\nvar m = s * 60;\nvar h = m * 60;\nvar d = h * 24;\nvar w = d * 7;\nvar y = d * 365.25;\n\n/**\n * Parse or format the given `val`.\n *\n * Options:\n *\n *  - `long` verbose formatting [false]\n *\n * @param {String|Number} val\n * @param {Object} [options]\n * @throws {Error} throw an error if val is not a non-empty string or a number\n * @return {String|Number}\n * @api public\n */\n\nmodule.exports = function (val, options) {\n  options = options || {};\n  var type = typeof val;\n  if (type === 'string' && val.length > 0) {\n    return parse(val);\n  } else if (type === 'number' && isFinite(val)) {\n    return options.long ? fmtLong(val) : fmtShort(val);\n  }\n  throw new Error(\n    'val is not a non-empty string or a valid number. val=' +\n      JSON.stringify(val)\n  );\n};\n\n/**\n * Parse the given `str` and return milliseconds.\n *\n * @param {String} str\n * @return {Number}\n * @api private\n */\n\nfunction parse(str) {\n  str = String(str);\n  if (str.length > 100) {\n    return;\n  }\n  var match = /^(-?(?:\\d+)?\\.?\\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(\n    str\n  );\n  if (!match) {\n    return;\n  }\n  var n = parseFloat(match[1]);\n  var type = (match[2] || 'ms').toLowerCase();\n  switch (type) {\n    case 'years':\n    case 'year':\n    case 'yrs':\n    case 'yr':\n    case 'y':\n      return n * y;\n    case 'weeks':\n    case 'week':\n    case 'w':\n      return n * w;\n    case 'days':\n    case 'day':\n    case 'd':\n      return n * d;\n    case 'hours':\n    case 'hour':\n    case 'hrs':\n    case 'hr':\n    case 'h':\n      return n * h;\n    case 'minutes':\n    case 'minute':\n    case 'mins':\n    case 'min':\n    case 'm':\n      return n * m;\n    case 'seconds':\n    case 'second':\n    case 'secs':\n    case 'sec':\n    case 's':\n      return n * s;\n    case 'milliseconds':\n    case 'millisecond':\n    case 'msecs':\n    case 'msec':\n    case 'ms':\n      return n;\n    default:\n      return undefined;\n  }\n}\n\n/**\n * Short format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtShort(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return Math.round(ms / d) + 'd';\n  }\n  if (msAbs >= h) {\n    return Math.round(ms / h) + 'h';\n  }\n  if (msAbs >= m) {\n    return Math.round(ms / m) + 'm';\n  }\n  if (msAbs >= s) {\n    return Math.round(ms / s) + 's';\n  }\n  return ms + 'ms';\n}\n\n/**\n * Long format for `ms`.\n *\n * @param {Number} ms\n * @return {String}\n * @api private\n */\n\nfunction fmtLong(ms) {\n  var msAbs = Math.abs(ms);\n  if (msAbs >= d) {\n    return plural(ms, msAbs, d, 'day');\n  }\n  if (msAbs >= h) {\n    return plural(ms, msAbs, h, 'hour');\n  }\n  if (msAbs >= m) {\n    return plural(ms, msAbs, m, 'minute');\n  }\n  if (msAbs >= s) {\n    return plural(ms, msAbs, s, 'second');\n  }\n  return ms + ' ms';\n}\n\n/**\n * Pluralization helper.\n */\n\nfunction plural(ms, msAbs, n, name) {\n  var isPlural = msAbs >= n * 1.5;\n  return Math.round(ms / n) + ' ' + name + (isPlural ? 's' : '');\n}\n","// RTP Payload Format For AV1 https://aomediacodec.github.io/av1-rtp-spec/\n\nimport { LEB128 } from \"@minhducsun2002/leb128\";\n\nimport type { RtpHeader } from \"..\";\nimport { BitWriter2, debug, getBit } from \"../imports/common\";\n\nconst log = debug(\"werift-rtp : packages/rtp/src/codec/av1.ts\");\n\n// 4.4 AV1 Aggregation Header\n//  0 1 2 3 4 5 6 7\n// +-+-+-+-+-+-+-+-+\n// |Z|Y| W |N|-|-|-|\n// +-+-+-+-+-+-+-+-+\n\n// RTP payload syntax:\n// 0                   1                   2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |Z|Y|0 0|N|-|-|-|  OBU element 1 size (leb128)  |               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+               |\n// :                                                               :\n// :                      OBU element 1 data                       :\n// :                                                               :\n// |                                                               |\n// |                               +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                               |  OBU element 2 size (leb128)  |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// :                                                               :\n// :                       OBU element 2 data                      :\n// :                                                               :\n// |                                                               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// :                                                               :\n// :                              ...                              :\n// :                                                               :\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |OBU e... N size|                                               |\n// +-+-+-+-+-+-+-+-+       OBU element N data      +-+-+-+-+-+-+-+-+\n// |                                               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n// OBU syntax:\n//     0 1 2 3 4 5 6 7\n//    +-+-+-+-+-+-+-+-+\n//    |0| type  |X|S|-| (REQUIRED)\n//    +-+-+-+-+-+-+-+-+\n// X: | TID |SID|-|-|-| (OPTIONAL)\n//    +-+-+-+-+-+-+-+-+\n//    |1|             |\n//    +-+ OBU payload |\n// S: |1|             | (OPTIONAL, variable length leb128 encoded)\n//    +-+    size     |\n//    |0|             |\n//    +-+-+-+-+-+-+-+-+\n//    |  OBU payload  |\n//    |     ...       |\n\nexport class AV1RtpPayload {\n  /**\n   * RtpStartsWithFragment\n   * MUST be set to 1 if the first OBU element is an OBU fragment that is a continuation of an OBU fragment from the previous packet, and MUST be set to 0 otherwise.\n   */\n  zBit_RtpStartsWithFragment!: number;\n  /**\n   * RtpEndsWithFragment\n   * MUST be set to 1 if the last OBU element is an OBU fragment that will continue in the next packet, and MUST be set to 0 otherwise.\n   */\n  yBit_RtpEndsWithFragment!: number;\n  /**\n   * RtpNumObus\n   * two bit field that describes the number of OBU elements in the packet. This field MUST be set equal to 0 or equal to the number of OBU elements contained in the packet. If set to 0, each OBU element MUST be preceded by a length field.\n   */\n  w_RtpNumObus!: number;\n  /**\n   * RtpStartsNewCodedVideoSequence\n   * MUST be set to 1 if the packet is the first packet of a coded video sequence, and MUST be set to 0 otherwise.\n   */\n  nBit_RtpStartsNewCodedVideoSequence!: number;\n  obu_or_fragment: { data: Buffer; isFragment: boolean }[] = [];\n\n  static deSerialize = (buf: Buffer) => {\n    const p = new AV1RtpPayload();\n\n    let offset = 0;\n\n    p.zBit_RtpStartsWithFragment = getBit(buf[offset], 0);\n    p.yBit_RtpEndsWithFragment = getBit(buf[offset], 1);\n    p.w_RtpNumObus = getBit(buf[offset], 2, 2);\n    p.nBit_RtpStartsNewCodedVideoSequence = getBit(buf[offset], 4);\n    offset++;\n\n    if (p.nBit_RtpStartsNewCodedVideoSequence && p.zBit_RtpStartsWithFragment) {\n      throw new Error();\n    }\n\n    [...Array(p.w_RtpNumObus - 1).keys()].forEach((i) => {\n      const [elementSize, bytes] = leb128decode(buf.subarray(offset));\n\n      const start = offset + bytes;\n      const end = start + elementSize;\n\n      let isFragment = false;\n      if (p.zBit_RtpStartsWithFragment && i === 0) {\n        isFragment = true;\n      }\n      p.obu_or_fragment.push({ data: buf.subarray(start, end), isFragment });\n\n      offset += bytes + elementSize;\n    });\n    let isFragment = false;\n    if (\n      p.yBit_RtpEndsWithFragment ||\n      (p.w_RtpNumObus === 1 && p.zBit_RtpStartsWithFragment)\n    ) {\n      isFragment = true;\n    }\n    p.obu_or_fragment.push({\n      data: buf.subarray(offset),\n      isFragment: isFragment,\n    });\n\n    return p;\n  };\n\n  static isDetectedFinalPacketInSequence(header: RtpHeader) {\n    return header.marker;\n  }\n\n  get isKeyframe() {\n    return this.nBit_RtpStartsNewCodedVideoSequence === 1;\n  }\n\n  static getFrame(payloads: AV1RtpPayload[]) {\n    const frames: Buffer[] = [];\n    const objects = payloads\n      .flatMap((p) => p.obu_or_fragment)\n      .reduce(\n        (\n          acc: Record<number, { data: Buffer; isFragment: boolean }>,\n          cur,\n          i,\n        ) => {\n          acc[i] = cur;\n          return acc;\n        },\n        {},\n      );\n    const length = Object.keys(objects).length;\n\n    for (const i of Object.keys(objects).map(Number)) {\n      const exist = objects[i];\n      if (!exist) continue;\n      const { data, isFragment } = exist;\n      if (isFragment) {\n        let fragments: Buffer[] = [];\n        for (let head = i; head < length; head++) {\n          const target = objects[head];\n          if (target.isFragment) {\n            fragments.push(target.data);\n            delete objects[head];\n          } else {\n            break;\n          }\n        }\n        if (fragments.length <= 1) {\n          log(\"fragment lost, maybe packet lost\");\n          fragments = [];\n        }\n        frames.push(Buffer.concat(fragments));\n      } else {\n        frames.push(data);\n      }\n    }\n    const obus = frames.map((f) => AV1Obu.deSerialize(f));\n    const lastObu = obus.pop()!;\n    return Buffer.concat([\n      ...obus.map((o) => {\n        o.obu_has_size_field = 1;\n        return o.serialize();\n      }),\n      lastObu.serialize(),\n    ]);\n  }\n}\n\nexport class AV1Obu {\n  obu_forbidden_bit!: number;\n  obu_type!: OBU_TYPE;\n  obu_extension_flag!: number;\n  obu_has_size_field!: number;\n  obu_reserved_1bit!: number;\n  payload!: Buffer;\n\n  static deSerialize(buf: Buffer) {\n    const obu = new AV1Obu();\n    let offset = 0;\n    obu.obu_forbidden_bit = getBit(buf[offset], 0);\n    obu.obu_type =\n      OBU_TYPES[getBit(buf[offset], 1, 4) as keyof typeof OBU_TYPES];\n    obu.obu_extension_flag = getBit(buf[offset], 5);\n    obu.obu_has_size_field = getBit(buf[offset], 6);\n    obu.obu_reserved_1bit = getBit(buf[offset], 7);\n    offset++;\n\n    obu.payload = buf.subarray(offset);\n\n    return obu;\n  }\n\n  serialize() {\n    const header = new BitWriter2(8)\n      .set(this.obu_forbidden_bit)\n      .set(OBU_TYPE_IDS[this.obu_type], 4)\n      .set(this.obu_extension_flag)\n      .set(this.obu_has_size_field)\n      .set(this.obu_reserved_1bit).buffer;\n    let obuSize: Uint8Array | Buffer = Buffer.alloc(0);\n    if (this.obu_has_size_field) {\n      obuSize = LEB128.encode(this.payload.length);\n    }\n    return Buffer.concat([header, obuSize, this.payload]);\n  }\n}\n\nexport function leb128decode(buf: Buffer) {\n  let value = 0;\n  let leb128bytes = 0;\n  for (let i = 0; i < 8; i++) {\n    const leb128byte = buf.readUInt8(i);\n    value |= (leb128byte & 0x7f) << (i * 7);\n    leb128bytes++;\n    if (!(leb128byte & 0x80)) {\n      break;\n    }\n  }\n  return [value, leb128bytes];\n}\n\nconst OBU_TYPES = {\n  0: \"Reserved\",\n  1: \"OBU_SEQUENCE_HEADER\",\n  2: \"OBU_TEMPORAL_DELIMITER\",\n  3: \"OBU_FRAME_HEADER\",\n  4: \"OBU_TILE_GROUP\",\n  5: \"OBU_METADATA\",\n  6: \"OBU_FRAME\",\n  7: \"OBU_REDUNDANT_FRAME_HEADER\",\n  8: \"OBU_TILE_LIST\",\n  15: \"OBU_PADDING\",\n} as const;\ntype OBU_TYPE = (typeof OBU_TYPES)[keyof typeof OBU_TYPES];\nconst OBU_TYPE_IDS: Record<OBU_TYPE, number> = Object.entries(OBU_TYPES).reduce(\n  (acc: any, [key, value]) => {\n    acc[value] = Number(key);\n    return acc;\n  },\n  {},\n);\n","import { once } from 'events';\nimport net from 'net';\nimport tls from 'tls';\n\nexport class ListenZeroSingleClientTimeoutError extends Error {\n    constructor() {\n        super('timeout waiting for client')\n    }\n}\n\nexport async function listenZero(server: net.Server, hostname: string) {\n    server.listen(0, hostname || '127.0.0.1');\n    await once(server, 'listening');\n    return (server.address() as net.AddressInfo).port;\n}\n\nexport async function listenZeroSingleClient(hostname: string, options?: net.ServerOpts & { tls?: boolean }, listenTimeout = 30000) {\n    const server = options?.tls ? new tls.Server(options) : new net.Server(options);\n    const port = await listenZero(server, hostname);\n\n    let cancel: () => void;\n    const clientPromise = new Promise<net.Socket>((resolve, reject) => {\n        const timeout = setTimeout(() => {\n            server.close();\n            reject(new ListenZeroSingleClientTimeoutError());\n        }, listenTimeout);\n        cancel = () => {\n            clearTimeout(timeout);\n            server.close();\n        };\n        server.on('connection', client => {\n            cancel();\n            resolve(client);\n        });\n    });\n\n    clientPromise.catch(() => { });\n\n    let host = hostname;\n    if (!host || host === '0.0.0.0')\n        host = '127.0.0.1';\n\n    return {\n        server,\n        cancel,\n        url: `tcp://${host}:${port}`,\n        host,\n        port,\n        clientPromise,\n    }\n}\n","import EventEmitter from \"events\";\n\nexport function enumerate<T>(arr: T[]): [number, T][] {\n  return arr.map((v, i) => [i, v]);\n}\n\nexport function divide(from: string, split: string): [string, string] {\n  const arr = from.split(split);\n  return [arr[0], arr.slice(1).join(split)];\n}\n\nexport class PromiseQueue {\n  queue: { promise: () => Promise<any>; done: () => void }[] = [];\n  running = false;\n\n  push = (promise: () => Promise<any>) =>\n    new Promise<void>((r) => {\n      this.queue.push({ promise, done: r });\n      if (!this.running) this.run();\n    });\n\n  private async run() {\n    const task = this.queue.shift();\n    if (task) {\n      this.running = true;\n      await task.promise();\n      task.done();\n\n      this.run();\n    } else {\n      this.running = false;\n    }\n  }\n}\n\nexport class EventTarget extends EventEmitter {\n  addEventListener = (type: string, listener: (...args: any[]) => void) => {\n    this.addListener(type, listener);\n  };\n\n  removeEventListener = (type: string, listener: (...args: any[]) => void) => {\n    this.removeListener(type, listener);\n  };\n}\n","'use strict';\n\nconst createFunction = require('generate-function');\nconst LinkedList = require('internal/linked-list');\n\n/**\n * An optimised partial implementation of Buffer list from `bl`.\n */\nclass BufferList {\n  /**\n   * @class\n   */\n  constructor() {\n    this.queue = new LinkedList();\n    this.offset = 0;\n  }\n\n  /**\n   * The number of bytes in list.\n   * @returns {number}\n   */\n  get length() {\n    return this.queue.length - this.offset;\n  }\n\n  /**\n   * Adds an additional buffer or BufferList to the internal list.\n   * @param {Buffer|Buffer[]|BufferList|BufferList[]} buf\n   */\n  append(buf) {\n    if (Buffer.isBuffer(buf)) {\n      if (this.offset > 0) {\n        const head = this.queue.shift();\n        this.queue.unshift(head.slice(this.offset));\n\n        this.offset = 0;\n      }\n\n      this.queue.push(buf);\n    } else if (Array.isArray(buf)) {\n      for (let i = 0; i < buf.length; i += 1) {\n        this.append(buf[i]);\n      }\n    } else if (buf instanceof BufferList) {\n      if (this.offset > 0) {\n        const head = this.queue.shift();\n        this.queue.unshift(head.slice(this.offset));\n\n        this.offset = 0;\n      }\n\n      if (buf.offset > 0) {\n        const head = buf.queue.shift();\n        buf.queue.unshift(head.slice(buf.offset));\n\n        buf.offset = 0;\n      }\n\n      let leaf = buf.queue.head;\n\n      while (leaf) {\n        this.queue.push(leaf.buffer);\n        leaf = leaf.next;\n      }\n    }\n  }\n\n  /* eslint-disable consistent-return */\n  /**\n   * Return the byte at the specified index.\n   * @param {number} index Index of the byte in the Buffer list.\n   * @returns {number}\n   */\n  get(index) {\n    let i = index;\n\n    while (i >= this.length) {\n      i -= this.length;\n    }\n\n    while (i < 0) {\n      i += this.length;\n    }\n\n    let leaf = this.queue.head;\n    let { offset } = this;\n\n    while (leaf) {\n      if (leaf.buffer.length - offset > i) {\n        return leaf.buffer[i + offset];\n      }\n\n      i -= leaf.buffer.length - offset;\n      offset = 0;\n      leaf = leaf.next;\n    }\n  }\n  /* eslint-enable consistent-return */\n\n  /**\n   * Returns a new Buffer object containing the bytes within the range specified.\n   * @param {number} start\n   * @param {number} end\n   * @returns {Buffer}\n   */\n  slice(start, end) {\n    /* eslint-disable no-param-reassign */\n    if (typeof start !== 'number') {\n      start = 0;\n    }\n\n    if (typeof end !== 'number') {\n      end = this.length;\n    }\n\n    while (start < 0) {\n      start += this.length;\n    }\n\n    while (end < 0) {\n      end += this.length;\n    }\n\n    end = Math.min(end, this.length);\n\n    if (start >= this.length || end === 0) {\n      return Buffer.alloc(0);\n    }\n\n    const tmpStart = start;\n    start = Math.min(tmpStart, end);\n    end = Math.max(tmpStart, end);\n\n    const subset = this.queue.slice(start + this.offset, end + this.offset);\n\n    // Buffer.concat() doesn't have optimization for count == 1\n    if (subset.count === 1) {\n      return subset.first;\n    }\n\n    let leaf = subset.head;\n    const target = Buffer.allocUnsafe(subset.length);\n    let offset = 0;\n\n    for (let i = 0; i < subset.count; i += 1) {\n      target.set(leaf.buffer, offset);\n      offset += leaf.buffer.length;\n      leaf = leaf.next;\n    }\n\n    return target;\n    /* eslint-enable no-param-reassign */\n  }\n\n  /**\n   * Return a string representation of the buffer.\n   * @param {string} encoding\n   * @param {number} start\n   * @param {number} end\n   * @returns {string}\n   */\n  toString(encoding, start, end) {\n    return this.slice(start, end).toString(encoding);\n  }\n\n  /**\n   * Shift bytes off the start of the list.\n   * @param {number} bytes\n   */\n  consume(bytes) {\n    let remainder = bytes;\n\n    while (this.length > 0) {\n      const firstLength = this.queue.first.length - this.offset;\n\n      if (remainder >= firstLength) {\n        this.queue.shift();\n\n        remainder -= firstLength;\n        this.offset = 0;\n      } else {\n        this.offset += remainder;\n        break;\n      }\n    }\n  }\n\n  /**\n   * Returns the first (least) index of an element\n   * within the list equal to the specified value,\n   * or -1 if none is found.\n   * @param {number} byte\n   * @param {number} [offset]\n   * @returns {number}\n   */\n  indexOf(byte, offset = 0) {\n    /* eslint-disable no-param-reassign */\n    if (!Number.isInteger(byte)) {\n      throw new TypeError('Invalid argument 1');\n    }\n\n    if (byte < 0 || byte > 0xff) {\n      throw new Error('Invalid argument 1');\n    }\n\n    if (!Number.isInteger(offset)) {\n      offset = 0;\n    }\n\n    while (offset >= this.length) {\n      offset -= this.length;\n    }\n\n    while (offset < 0) {\n      offset += this.length;\n    }\n\n    let leaf = this.queue.head;\n    let bias = 0;\n\n    const next = () => {\n      bias += leaf.buffer.length;\n      leaf = leaf.next;\n    };\n\n    while (leaf) {\n      let byteOffset = 0;\n\n      if (leaf === this.queue.head) {\n        byteOffset += this.offset;\n      }\n\n      // `offset` is point to next chunk\n      if (offset >= leaf.buffer.length - byteOffset) {\n        offset -= leaf.buffer.length - byteOffset;\n        next();\n        continue; // eslint-disable-line no-continue\n      }\n\n      // `offset` is point to current chunk\n      if (offset < leaf.buffer.length) {\n        byteOffset += offset;\n      }\n\n      const index = leaf.buffer.indexOf(byte, byteOffset);\n\n      if (index > -1) {\n        return index + bias - this.offset;\n      }\n\n      next();\n\n      if (byteOffset > this.offset) {\n        offset = 0;\n      }\n    }\n\n    return -1;\n    /* eslint-enable no-param-reassign */\n  }\n}\n\nconst fixedReadMethods = {\n  readDoubleBE: 8,\n  readDoubleLE: 8,\n  readFloatBE: 4,\n  readFloatLE: 4,\n  readInt32BE: 4,\n  readInt32LE: 4,\n  readUInt32BE: 4,\n  readUInt32LE: 4,\n  readInt16BE: 2,\n  readInt16LE: 2,\n  readUInt16BE: 2,\n  readUInt16LE: 2,\n  readInt8: 1,\n  readUInt8: 1,\n};\n\nObject.keys(fixedReadMethods).forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function bufferlist_${method}(offset = 0) {\n      const start = offset + this.offset;\n      const head = this.queue.first;\n      const size = ${gen.formats.d(fixedReadMethods[method])};\n      const isFirtsChunkEnough = head.length - start >= size;\n\n      return isFirtsChunkEnough\n        ? head.${method}(start)\n        : this.slice(offset, offset + size).${method}(0)\n    }\n  `);\n\n  BufferList.prototype[method] = gen.toFunction();\n});\n\nconst metaReadMethods = ['readIntBE', 'readIntLE', 'readUIntBE', 'readUIntLE'];\n\nmetaReadMethods.forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function bufferlist_${method}(size, offset = 0) {\n      const start = offset + this.offset;\n      const head = this.queue.first;\n      const isFirtsChunkEnough = head.length - start >= size;\n\n      return isFirtsChunkEnough\n        ? head.${method}(start, size)\n        : this.slice(offset, offset + size).${method}(0, size)\n    }\n  `);\n\n  BufferList.prototype[method] = gen.toFunction();\n});\n\nconst fixedWriteMethods = {\n  writeDoubleBE: 8,\n  writeDoubleLE: 8,\n  writeFloatBE: 4,\n  writeFloatLE: 4,\n  writeInt32BE: 4,\n  writeInt32LE: 4,\n  writeUInt32BE: 4,\n  writeUInt32LE: 4,\n  writeInt16BE: 2,\n  writeInt16LE: 2,\n  writeUInt16BE: 2,\n  writeUInt16LE: 2,\n  writeInt8: 1,\n  writeUInt8: 1,\n};\n\nObject.keys(fixedWriteMethods).forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function bufferlist_${method}(value) {\n      const size = ${gen.formats.d(fixedWriteMethods[method])};\n      const buf = Buffer.allocUnsafe(size);\n      buf.${method}(value, 0);\n      this.append(buf);\n    }\n  `);\n\n  BufferList.prototype[method] = gen.toFunction();\n});\n\nconst metaWriteMethods = [\n  'writeIntBE',\n  'writeIntLE',\n  'writeUIntBE',\n  'writeUIntLE',\n];\n\nmetaWriteMethods.forEach(method => {\n  const gen = createFunction();\n\n  gen(`\n    function bufferlist_${method}(value, size) {\n      const buf = Buffer.allocUnsafe(size);\n      buf.${method}(value, 0, size);\n      this.append(buf);\n    }\n  `);\n\n  BufferList.prototype[method] = gen.toFunction();\n});\n\nmodule.exports = BufferList;\n","import { useNACK, usePLI, useREMB } from \"./extension/rtcpFeedback\";\nimport { RTCRtpCodecParameters } from \"./parameters\";\n\nexport const useH264 = (props: Partial<RTCRtpCodecParameters> = {}) =>\n  new RTCRtpCodecParameters({\n    mimeType: \"video/h264\",\n    clockRate: 90000,\n    rtcpFeedback: [useNACK(), usePLI(), useREMB()],\n    parameters:\n      \"profile-level-id=42e01f;packetization-mode=1;level-asymmetry-allowed=1\",\n    ...props,\n  });\n\nexport const useVP8 = (props: Partial<RTCRtpCodecParameters> = {}) =>\n  new RTCRtpCodecParameters({\n    mimeType: \"video/VP8\",\n    clockRate: 90000,\n    rtcpFeedback: [useNACK(), usePLI(), useREMB()],\n    ...props,\n  });\n\nexport const useVP9 = (props: Partial<RTCRtpCodecParameters> = {}) =>\n  new RTCRtpCodecParameters({\n    mimeType: \"video/VP9\",\n    clockRate: 90000,\n    rtcpFeedback: [useNACK(), usePLI(), useREMB()],\n    ...props,\n  });\n\nexport const useAV1X = (props: Partial<RTCRtpCodecParameters> = {}) =>\n  new RTCRtpCodecParameters({\n    mimeType: \"video/AV1X\",\n    clockRate: 90000,\n    rtcpFeedback: [useNACK(), usePLI(), useREMB()],\n    ...props,\n  });\n\nexport const useOPUS = (props: Partial<RTCRtpCodecParameters> = {}) =>\n  new RTCRtpCodecParameters({\n    mimeType: \"audio/OPUS\",\n    clockRate: 48000,\n    channels: 2,\n    ...props,\n  });\n\nexport const usePCMU = (props: Partial<RTCRtpCodecParameters> = {}) =>\n  new RTCRtpCodecParameters({\n    mimeType: \"audio/PCMU\",\n    clockRate: 8000,\n    channels: 1,\n    payloadType: 0,\n    ...props,\n  });\n\nexport const supportedCodecs = [\n  useAV1X(),\n  useVP9(),\n  useVP8(),\n  useH264(),\n  useOPUS(),\n  usePCMU(),\n].map((codec) => codec.mimeType);\n\nexport const supportedVideoCodecs = supportedCodecs.filter((codec) =>\n  codec.toLowerCase().startsWith(\"video/\"),\n);\n\nexport const supportedAudioCodecs = supportedCodecs.filter((codec) =>\n  codec.toLowerCase().startsWith(\"audio/\"),\n);\n","export function uint8Add(a: number, b: number) {\n  return (a + b) & 0xff;\n}\n\nexport function uint16Add(a: number, b: number) {\n  return (a + b) & 0xffff;\n}\n\nexport function uint32Add(a: number, b: number) {\n  return Number((BigInt(a) + BigInt(b)) & 0xffffffffn);\n}\n\nexport function uint24(v: number) {\n  return v & 0xffffff;\n}\n\n/**Return a > b */\nexport function uint16Gt(a: number, b: number) {\n  const halfMod = 0x8000;\n  return (a < b && b - a > halfMod) || (a > b && a - b < halfMod);\n}\n\n/**Return a >= b */\nexport function uint16Gte(a: number, b: number) {\n  return a === b || uint16Gt(a, b);\n}\n\n/**Return a > b */\nexport function uint32Gt(a: number, b: number) {\n  const halfMod = 0x80000000;\n  return (a < b && b - a > halfMod) || (a > b && a - b < halfMod);\n}\n\n/**Return a >= b */\nexport function uint32Gte(a: number, b: number) {\n  return a === b || uint32Gt(a, b);\n}\n\nexport const int = (n: number) => Number.parseInt(n as any, 10);\n","/* eslint-disable prefer-const */\nimport { createHash } from \"crypto\";\nimport { createSocket } from \"dgram\";\n\nimport { performance } from \"perf_hooks\";\n\nimport {\n  type Address,\n  bufferReader,\n  bufferWriter,\n  debug,\n  randomPort,\n} from \"./imports/common\";\nimport { CipherContext } from \"./imports/dtls\";\n\nimport { Directions, type MediaDirection } from \"./media/rtpTransceiver\";\nimport { MediaStreamTrack } from \"./media/track\";\nimport type { RTCIceServer } from \"./peerConnection\";\n\nconst log = debug(\"werift:packages/webrtc/src/utils.ts\");\n\nexport function fingerprint(file: Buffer, hashName: string) {\n  const upper = (s: string) => s.toUpperCase();\n  const colon = (s: any) => s.match(/(.{2})/g).join(\":\");\n\n  const hash = createHash(hashName).update(file).digest(\"hex\");\n\n  return colon(upper(hash));\n}\n\nexport function isDtls(buf: Buffer) {\n  const firstByte = buf[0];\n  return firstByte > 19 && firstByte < 64;\n}\n\nexport function reverseSimulcastDirection(dir: \"recv\" | \"send\") {\n  if (dir === \"recv\") return \"send\";\n  return \"recv\";\n}\n\nexport const andDirection = (a: MediaDirection, b: MediaDirection) =>\n  Directions[Directions.indexOf(a) & Directions.indexOf(b)];\n\nexport function reverseDirection(dir: MediaDirection): MediaDirection {\n  if (dir === \"sendonly\") return \"recvonly\";\n  if (dir === \"recvonly\") return \"sendonly\";\n  return dir;\n}\n\nexport const milliTime = Date.now;\n\nconst startupTimestampInMicroseconds =\n  BigInt(Date.now()) * 1000n - process.hrtime.bigint() / 1000n;\n\nexport const microTime = () => {\n  return startupTimestampInMicroseconds + process.hrtime.bigint() / 1000n;\n};\n\nexport const timestampSeconds = () => Date.now() / 1000;\n\n/**https://datatracker.ietf.org/doc/html/rfc3550#section-4 */\nexport const ntpTime = () => {\n  const now = performance.timeOrigin + performance.now() - Date.UTC(1900, 0, 1);\n\n  const seconds = now / 1000;\n  const [sec, msec] = seconds.toString().split(\".\").map(Number);\n\n  const buf = bufferWriter([4, 4], [sec, msec]);\n\n  return buf.readBigUInt64BE();\n};\n\n/**\n * https://datatracker.ietf.org/doc/html/rfc3550#section-4\n * @param ntp\n * @returns 32bit\n */\nexport const compactNtp = (ntp: bigint) => {\n  const buf = bufferWriter([8], [ntp]);\n  const [, sec, msec] = bufferReader(buf, [2, 2, 2, 2]);\n  return bufferWriter([2, 2], [sec, msec]).readUInt32BE();\n};\n\nexport function parseIceServers(iceServers: RTCIceServer[]) {\n  const url2Address = (url?: string) => {\n    if (!url) return;\n    const [address, port] = url.split(\":\");\n    return [address, Number.parseInt(port)] as Address;\n  };\n\n  const stunServer = url2Address(\n    iceServers.find(({ urls }) => urls.includes(\"stun:\"))?.urls.slice(5),\n  );\n  const turnServer = url2Address(\n    iceServers.find(({ urls }) => urls.includes(\"turn:\"))?.urls.slice(5),\n  );\n  const { credential, username } =\n    iceServers.find(({ urls }) => urls.includes(\"turn:\")) || {};\n\n  const options = {\n    stunServer,\n    turnServer,\n    turnUsername: username,\n    turnPassword: credential,\n  };\n  log(\"iceOptions\", options);\n  return options;\n}\n\n/**\n *\n * @param signatureHash\n * @param namedCurveAlgorithm necessary when use ecdsa\n */\nexport const createSelfSignedCertificate =\n  CipherContext.createSelfSignedCertificateWithKey;\n\nexport class MediaStreamTrackFactory {\n  static async rtpSource({\n    port,\n    kind,\n    cb,\n  }: {\n    port?: number;\n    kind: \"audio\" | \"video\";\n    cb?: (buf: Buffer) => Buffer;\n  }) {\n    port ??= await randomPort();\n    const track = new MediaStreamTrack({ kind });\n\n    const udp = createSocket(\"udp4\");\n    udp.bind(port);\n    const onMessage = (msg: Buffer) => {\n      if (cb) {\n        msg = cb(msg);\n      }\n      track.writeRtp(msg);\n    };\n    udp.addListener(\"message\", onMessage);\n\n    const dispose = () => {\n      udp.removeListener(\"message\", onMessage);\n      try {\n        udp.close();\n      } catch (error) {}\n    };\n\n    return [track, port, dispose] as const;\n  }\n}\n\n/**\n * Merge two objects. If a property value in the source object is undefined or\n * when casted is equal to undefined (== undefined), then it will not overwrite\n * the value of the property in the destination object.\n */\nexport const deepMerge = <T>(dst: T, src: T) => {\n  if (!dst || typeof dst !== \"object\") {\n    if (src !== null && typeof src === \"object\") {\n      return src;\n    } else {\n      return dst;\n    }\n  }\n\n  if (!src || typeof src !== \"object\") {\n    if (src == undefined) {\n      return dst;\n    }\n    return src;\n  }\n\n  for (const key in src) {\n    if (Object.prototype.hasOwnProperty.call(src, key)) {\n      const sourceValue = src[key];\n\n      if (sourceValue != undefined) {\n        dst[key] = sourceValue;\n      }\n    }\n  }\n  return dst;\n};\n","'use strict'\n\nconst Buffer = require('buffer').Buffer\nconst types = require('./types')\nconst rcodes = require('./rcodes')\nconst opcodes = require('./opcodes')\nconst classes = require('./classes')\nconst optioncodes = require('./optioncodes')\nconst ip = require('@leichtgewicht/ip-codec')\n\nconst QUERY_FLAG = 0\nconst RESPONSE_FLAG = 1 << 15\nconst FLUSH_MASK = 1 << 15\nconst NOT_FLUSH_MASK = ~FLUSH_MASK\nconst QU_MASK = 1 << 15\nconst NOT_QU_MASK = ~QU_MASK\n\nconst name = exports.name = {}\n\nname.encode = function (str, buf, offset, { mail = false } = {}) {\n  if (!buf) buf = Buffer.alloc(name.encodingLength(str))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  // strip leading and trailing .\n  const n = str.replace(/^\\.|\\.$/gm, '')\n  if (n.length) {\n    let list = []\n    if (mail) {\n      let localPart = ''\n      n.split('.').forEach(label => {\n        if (label.endsWith('\\\\')) {\n          localPart += (localPart.length ? '.' : '') + label.slice(0, -1)\n        } else {\n          if (list.length === 0 && localPart.length) {\n            list.push(localPart + '.' + label)\n          } else {\n            list.push(label)\n          }\n        }\n      })\n    } else {\n      list = n.split('.')\n    }\n\n    for (let i = 0; i < list.length; i++) {\n      const len = buf.write(list[i], offset + 1)\n      buf[offset] = len\n      offset += len + 1\n    }\n  }\n\n  buf[offset++] = 0\n\n  name.encode.bytes = offset - oldOffset\n  return buf\n}\n\nname.encode.bytes = 0\n\nname.decode = function (buf, offset, { mail = false } = {}) {\n  if (!offset) offset = 0\n\n  const list = []\n  let oldOffset = offset\n  let totalLength = 0\n  let consumedBytes = 0\n  let jumped = false\n\n  while (true) {\n    if (offset >= buf.length) {\n      throw new Error('Cannot decode name (buffer overflow)')\n    }\n    const len = buf[offset++]\n    consumedBytes += jumped ? 0 : 1\n\n    if (len === 0) {\n      break\n    } else if ((len & 0xc0) === 0) {\n      if (offset + len > buf.length) {\n        throw new Error('Cannot decode name (buffer overflow)')\n      }\n      totalLength += len + 1\n      if (totalLength > 254) {\n        throw new Error('Cannot decode name (name too long)')\n      }\n      let label = buf.toString('utf-8', offset, offset + len)\n      if (mail) {\n        label = label.replace(/\\./g, '\\\\.')\n      }\n      list.push(label)\n      offset += len\n      consumedBytes += jumped ? 0 : len\n    } else if ((len & 0xc0) === 0xc0) {\n      if (offset + 1 > buf.length) {\n        throw new Error('Cannot decode name (buffer overflow)')\n      }\n      const jumpOffset = buf.readUInt16BE(offset - 1) - 0xc000\n      if (jumpOffset >= oldOffset) {\n        // Allow only pointers to prior data. RFC 1035, section 4.1.4 states:\n        // \"[...] an entire domain name or a list of labels at the end of a domain name\n        // is replaced with a pointer to a prior occurance (sic) of the same name.\"\n        throw new Error('Cannot decode name (bad pointer)')\n      }\n      offset = jumpOffset\n      oldOffset = jumpOffset\n      consumedBytes += jumped ? 0 : 1\n      jumped = true\n    } else {\n      throw new Error('Cannot decode name (bad label)')\n    }\n  }\n\n  name.decode.bytes = consumedBytes\n  return list.length === 0 ? '.' : list.join('.')\n}\n\nname.decode.bytes = 0\n\nname.encodingLength = function (n) {\n  if (n === '.' || n === '..') return 1\n  return Buffer.byteLength(n.replace(/^\\.|\\.$/gm, '')) + 2\n}\n\nconst string = {}\n\nstring.encode = function (s, buf, offset) {\n  if (!buf) buf = Buffer.alloc(string.encodingLength(s))\n  if (!offset) offset = 0\n\n  const len = buf.write(s, offset + 1)\n  buf[offset] = len\n  string.encode.bytes = len + 1\n  return buf\n}\n\nstring.encode.bytes = 0\n\nstring.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const len = buf[offset]\n  const s = buf.toString('utf-8', offset + 1, offset + 1 + len)\n  string.decode.bytes = len + 1\n  return s\n}\n\nstring.decode.bytes = 0\n\nstring.encodingLength = function (s) {\n  return Buffer.byteLength(s) + 1\n}\n\nconst header = {}\n\nheader.encode = function (h, buf, offset) {\n  if (!buf) buf = header.encodingLength(h)\n  if (!offset) offset = 0\n\n  const flags = (h.flags || 0) & 32767\n  const type = h.type === 'response' ? RESPONSE_FLAG : QUERY_FLAG\n\n  buf.writeUInt16BE(h.id || 0, offset)\n  buf.writeUInt16BE(flags | type, offset + 2)\n  buf.writeUInt16BE(h.questions.length, offset + 4)\n  buf.writeUInt16BE(h.answers.length, offset + 6)\n  buf.writeUInt16BE(h.authorities.length, offset + 8)\n  buf.writeUInt16BE(h.additionals.length, offset + 10)\n\n  return buf\n}\n\nheader.encode.bytes = 12\n\nheader.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  if (buf.length < 12) throw new Error('Header must be 12 bytes')\n  const flags = buf.readUInt16BE(offset + 2)\n\n  return {\n    id: buf.readUInt16BE(offset),\n    type: flags & RESPONSE_FLAG ? 'response' : 'query',\n    flags: flags & 32767,\n    flag_qr: ((flags >> 15) & 0x1) === 1,\n    opcode: opcodes.toString((flags >> 11) & 0xf),\n    flag_aa: ((flags >> 10) & 0x1) === 1,\n    flag_tc: ((flags >> 9) & 0x1) === 1,\n    flag_rd: ((flags >> 8) & 0x1) === 1,\n    flag_ra: ((flags >> 7) & 0x1) === 1,\n    flag_z: ((flags >> 6) & 0x1) === 1,\n    flag_ad: ((flags >> 5) & 0x1) === 1,\n    flag_cd: ((flags >> 4) & 0x1) === 1,\n    rcode: rcodes.toString(flags & 0xf),\n    questions: new Array(buf.readUInt16BE(offset + 4)),\n    answers: new Array(buf.readUInt16BE(offset + 6)),\n    authorities: new Array(buf.readUInt16BE(offset + 8)),\n    additionals: new Array(buf.readUInt16BE(offset + 10))\n  }\n}\n\nheader.decode.bytes = 12\n\nheader.encodingLength = function () {\n  return 12\n}\n\nconst runknown = exports.unknown = {}\n\nrunknown.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(runknown.encodingLength(data))\n  if (!offset) offset = 0\n\n  buf.writeUInt16BE(data.length, offset)\n  data.copy(buf, offset + 2)\n\n  runknown.encode.bytes = data.length + 2\n  return buf\n}\n\nrunknown.encode.bytes = 0\n\nrunknown.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const len = buf.readUInt16BE(offset)\n  const data = buf.slice(offset + 2, offset + 2 + len)\n  runknown.decode.bytes = len + 2\n  return data\n}\n\nrunknown.decode.bytes = 0\n\nrunknown.encodingLength = function (data) {\n  return data.length + 2\n}\n\nconst rns = exports.ns = {}\n\nrns.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rns.encodingLength(data))\n  if (!offset) offset = 0\n\n  name.encode(data, buf, offset + 2)\n  buf.writeUInt16BE(name.encode.bytes, offset)\n  rns.encode.bytes = name.encode.bytes + 2\n  return buf\n}\n\nrns.encode.bytes = 0\n\nrns.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const len = buf.readUInt16BE(offset)\n  const dd = name.decode(buf, offset + 2)\n\n  rns.decode.bytes = len + 2\n  return dd\n}\n\nrns.decode.bytes = 0\n\nrns.encodingLength = function (data) {\n  return name.encodingLength(data) + 2\n}\n\nconst rsoa = exports.soa = {}\n\nrsoa.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rsoa.encodingLength(data))\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n  offset += 2\n  name.encode(data.mname, buf, offset)\n  offset += name.encode.bytes\n  name.encode(data.rname, buf, offset, { mail: true })\n  offset += name.encode.bytes\n  buf.writeUInt32BE(data.serial || 0, offset)\n  offset += 4\n  buf.writeUInt32BE(data.refresh || 0, offset)\n  offset += 4\n  buf.writeUInt32BE(data.retry || 0, offset)\n  offset += 4\n  buf.writeUInt32BE(data.expire || 0, offset)\n  offset += 4\n  buf.writeUInt32BE(data.minimum || 0, offset)\n  offset += 4\n\n  buf.writeUInt16BE(offset - oldOffset - 2, oldOffset)\n  rsoa.encode.bytes = offset - oldOffset\n  return buf\n}\n\nrsoa.encode.bytes = 0\n\nrsoa.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n\n  const data = {}\n  offset += 2\n  data.mname = name.decode(buf, offset)\n  offset += name.decode.bytes\n  data.rname = name.decode(buf, offset, { mail: true })\n  offset += name.decode.bytes\n  data.serial = buf.readUInt32BE(offset)\n  offset += 4\n  data.refresh = buf.readUInt32BE(offset)\n  offset += 4\n  data.retry = buf.readUInt32BE(offset)\n  offset += 4\n  data.expire = buf.readUInt32BE(offset)\n  offset += 4\n  data.minimum = buf.readUInt32BE(offset)\n  offset += 4\n\n  rsoa.decode.bytes = offset - oldOffset\n  return data\n}\n\nrsoa.decode.bytes = 0\n\nrsoa.encodingLength = function (data) {\n  return 22 + name.encodingLength(data.mname) + name.encodingLength(data.rname)\n}\n\nconst rtxt = exports.txt = {}\n\nrtxt.encode = function (data, buf, offset) {\n  if (!Array.isArray(data)) data = [data]\n  for (let i = 0; i < data.length; i++) {\n    if (typeof data[i] === 'string') {\n      data[i] = Buffer.from(data[i])\n    }\n    if (!Buffer.isBuffer(data[i])) {\n      throw new Error('Must be a Buffer')\n    }\n  }\n\n  if (!buf) buf = Buffer.alloc(rtxt.encodingLength(data))\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n  offset += 2\n\n  data.forEach(function (d) {\n    buf[offset++] = d.length\n    d.copy(buf, offset, 0, d.length)\n    offset += d.length\n  })\n\n  buf.writeUInt16BE(offset - oldOffset - 2, oldOffset)\n  rtxt.encode.bytes = offset - oldOffset\n  return buf\n}\n\nrtxt.encode.bytes = 0\n\nrtxt.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n  let remaining = buf.readUInt16BE(offset)\n  offset += 2\n\n  let data = []\n  while (remaining > 0) {\n    const len = buf[offset++]\n    --remaining\n    if (remaining < len) {\n      throw new Error('Buffer overflow')\n    }\n    data.push(buf.slice(offset, offset + len))\n    offset += len\n    remaining -= len\n  }\n\n  rtxt.decode.bytes = offset - oldOffset\n  return data\n}\n\nrtxt.decode.bytes = 0\n\nrtxt.encodingLength = function (data) {\n  if (!Array.isArray(data)) data = [data]\n  let length = 2\n  data.forEach(function (buf) {\n    if (typeof buf === 'string') {\n      length += Buffer.byteLength(buf) + 1\n    } else {\n      length += buf.length + 1\n    }\n  })\n  return length\n}\n\nconst rnull = exports.null = {}\n\nrnull.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rnull.encodingLength(data))\n  if (!offset) offset = 0\n\n  if (typeof data === 'string') data = Buffer.from(data)\n  if (!data) data = Buffer.alloc(0)\n\n  const oldOffset = offset\n  offset += 2\n\n  const len = data.length\n  data.copy(buf, offset, 0, len)\n  offset += len\n\n  buf.writeUInt16BE(offset - oldOffset - 2, oldOffset)\n  rnull.encode.bytes = offset - oldOffset\n  return buf\n}\n\nrnull.encode.bytes = 0\n\nrnull.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n  const len = buf.readUInt16BE(offset)\n\n  offset += 2\n\n  const data = buf.slice(offset, offset + len)\n  offset += len\n\n  rnull.decode.bytes = offset - oldOffset\n  return data\n}\n\nrnull.decode.bytes = 0\n\nrnull.encodingLength = function (data) {\n  if (!data) return 2\n  return (Buffer.isBuffer(data) ? data.length : Buffer.byteLength(data)) + 2\n}\n\nconst rhinfo = exports.hinfo = {}\n\nrhinfo.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rhinfo.encodingLength(data))\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n  offset += 2\n  string.encode(data.cpu, buf, offset)\n  offset += string.encode.bytes\n  string.encode(data.os, buf, offset)\n  offset += string.encode.bytes\n  buf.writeUInt16BE(offset - oldOffset - 2, oldOffset)\n  rhinfo.encode.bytes = offset - oldOffset\n  return buf\n}\n\nrhinfo.encode.bytes = 0\n\nrhinfo.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n\n  const data = {}\n  offset += 2\n  data.cpu = string.decode(buf, offset)\n  offset += string.decode.bytes\n  data.os = string.decode(buf, offset)\n  offset += string.decode.bytes\n  rhinfo.decode.bytes = offset - oldOffset\n  return data\n}\n\nrhinfo.decode.bytes = 0\n\nrhinfo.encodingLength = function (data) {\n  return string.encodingLength(data.cpu) + string.encodingLength(data.os) + 2\n}\n\nconst rptr = exports.ptr = {}\nconst rcname = exports.cname = rptr\nconst rdname = exports.dname = rptr\n\nrptr.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rptr.encodingLength(data))\n  if (!offset) offset = 0\n\n  name.encode(data, buf, offset + 2)\n  buf.writeUInt16BE(name.encode.bytes, offset)\n  rptr.encode.bytes = name.encode.bytes + 2\n  return buf\n}\n\nrptr.encode.bytes = 0\n\nrptr.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const data = name.decode(buf, offset + 2)\n  rptr.decode.bytes = name.decode.bytes + 2\n  return data\n}\n\nrptr.decode.bytes = 0\n\nrptr.encodingLength = function (data) {\n  return name.encodingLength(data) + 2\n}\n\nconst rsrv = exports.srv = {}\n\nrsrv.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rsrv.encodingLength(data))\n  if (!offset) offset = 0\n\n  buf.writeUInt16BE(data.priority || 0, offset + 2)\n  buf.writeUInt16BE(data.weight || 0, offset + 4)\n  buf.writeUInt16BE(data.port || 0, offset + 6)\n  name.encode(data.target, buf, offset + 8)\n\n  const len = name.encode.bytes + 6\n  buf.writeUInt16BE(len, offset)\n\n  rsrv.encode.bytes = len + 2\n  return buf\n}\n\nrsrv.encode.bytes = 0\n\nrsrv.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const len = buf.readUInt16BE(offset)\n\n  const data = {}\n  data.priority = buf.readUInt16BE(offset + 2)\n  data.weight = buf.readUInt16BE(offset + 4)\n  data.port = buf.readUInt16BE(offset + 6)\n  data.target = name.decode(buf, offset + 8)\n\n  rsrv.decode.bytes = len + 2\n  return data\n}\n\nrsrv.decode.bytes = 0\n\nrsrv.encodingLength = function (data) {\n  return 8 + name.encodingLength(data.target)\n}\n\nconst rcaa = exports.caa = {}\n\nrcaa.ISSUER_CRITICAL = 1 << 7\n\nrcaa.encode = function (data, buf, offset) {\n  const len = rcaa.encodingLength(data)\n\n  if (!buf) buf = Buffer.alloc(rcaa.encodingLength(data))\n  if (!offset) offset = 0\n\n  if (data.issuerCritical) {\n    data.flags = rcaa.ISSUER_CRITICAL\n  }\n\n  buf.writeUInt16BE(len - 2, offset)\n  offset += 2\n  buf.writeUInt8(data.flags || 0, offset)\n  offset += 1\n  string.encode(data.tag, buf, offset)\n  offset += string.encode.bytes\n  buf.write(data.value, offset)\n  offset += Buffer.byteLength(data.value)\n\n  rcaa.encode.bytes = len\n  return buf\n}\n\nrcaa.encode.bytes = 0\n\nrcaa.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const len = buf.readUInt16BE(offset)\n  offset += 2\n\n  const oldOffset = offset\n  const data = {}\n  data.flags = buf.readUInt8(offset)\n  offset += 1\n  data.tag = string.decode(buf, offset)\n  offset += string.decode.bytes\n  data.value = buf.toString('utf-8', offset, oldOffset + len)\n\n  data.issuerCritical = !!(data.flags & rcaa.ISSUER_CRITICAL)\n\n  rcaa.decode.bytes = len + 2\n\n  return data\n}\n\nrcaa.decode.bytes = 0\n\nrcaa.encodingLength = function (data) {\n  return string.encodingLength(data.tag) + string.encodingLength(data.value) + 2\n}\n\nconst rmx = exports.mx = {}\n\nrmx.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rmx.encodingLength(data))\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n  offset += 2\n  buf.writeUInt16BE(data.preference || 0, offset)\n  offset += 2\n  name.encode(data.exchange, buf, offset)\n  offset += name.encode.bytes\n\n  buf.writeUInt16BE(offset - oldOffset - 2, oldOffset)\n  rmx.encode.bytes = offset - oldOffset\n  return buf\n}\n\nrmx.encode.bytes = 0\n\nrmx.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n\n  const data = {}\n  offset += 2\n  data.preference = buf.readUInt16BE(offset)\n  offset += 2\n  data.exchange = name.decode(buf, offset)\n  offset += name.decode.bytes\n\n  rmx.decode.bytes = offset - oldOffset\n  return data\n}\n\nrmx.encodingLength = function (data) {\n  return 4 + name.encodingLength(data.exchange)\n}\n\nconst ra = exports.a = {}\n\nra.encode = function (host, buf, offset) {\n  if (!buf) buf = Buffer.alloc(ra.encodingLength(host))\n  if (!offset) offset = 0\n\n  buf.writeUInt16BE(4, offset)\n  offset += 2\n  ip.v4.encode(host, buf, offset)\n  ra.encode.bytes = 6\n  return buf\n}\n\nra.encode.bytes = 0\n\nra.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  offset += 2\n  const host = ip.v4.decode(buf, offset)\n  ra.decode.bytes = 6\n  return host\n}\n\nra.decode.bytes = 0\n\nra.encodingLength = function () {\n  return 6\n}\n\nconst raaaa = exports.aaaa = {}\n\nraaaa.encode = function (host, buf, offset) {\n  if (!buf) buf = Buffer.alloc(raaaa.encodingLength(host))\n  if (!offset) offset = 0\n\n  buf.writeUInt16BE(16, offset)\n  offset += 2\n  ip.v6.encode(host, buf, offset)\n  raaaa.encode.bytes = 18\n  return buf\n}\n\nraaaa.encode.bytes = 0\n\nraaaa.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  offset += 2\n  const host = ip.v6.decode(buf, offset)\n  raaaa.decode.bytes = 18\n  return host\n}\n\nraaaa.decode.bytes = 0\n\nraaaa.encodingLength = function () {\n  return 18\n}\n\nconst roption = exports.option = {}\n\nroption.encode = function (option, buf, offset) {\n  if (!buf) buf = Buffer.alloc(roption.encodingLength(option))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const code = optioncodes.toCode(option.code)\n  buf.writeUInt16BE(code, offset)\n  offset += 2\n  if (option.data) {\n    buf.writeUInt16BE(option.data.length, offset)\n    offset += 2\n    option.data.copy(buf, offset)\n    offset += option.data.length\n  } else {\n    switch (code) {\n      // case 3: NSID.  No encode makes sense.\n      // case 5,6,7: Not implementable\n      case 8: // ECS\n        // note: do IP math before calling\n        const spl = option.sourcePrefixLength || 0\n        const fam = option.family || ip.familyOf(option.ip)\n        const ipBuf = ip.encode(option.ip, Buffer.alloc)\n        const ipLen = Math.ceil(spl / 8)\n        buf.writeUInt16BE(ipLen + 4, offset)\n        offset += 2\n        buf.writeUInt16BE(fam, offset)\n        offset += 2\n        buf.writeUInt8(spl, offset++)\n        buf.writeUInt8(option.scopePrefixLength || 0, offset++)\n\n        ipBuf.copy(buf, offset, 0, ipLen)\n        offset += ipLen\n        break\n      // case 9: EXPIRE (experimental)\n      // case 10: COOKIE.  No encode makes sense.\n      case 11: // KEEP-ALIVE\n        if (option.timeout) {\n          buf.writeUInt16BE(2, offset)\n          offset += 2\n          buf.writeUInt16BE(option.timeout, offset)\n          offset += 2\n        } else {\n          buf.writeUInt16BE(0, offset)\n          offset += 2\n        }\n        break\n      case 12: // PADDING\n        const len = option.length || 0\n        buf.writeUInt16BE(len, offset)\n        offset += 2\n        buf.fill(0, offset, offset + len)\n        offset += len\n        break\n      // case 13:  CHAIN.  Experimental.\n      case 14: // KEY-TAG\n        const tagsLen = option.tags.length * 2\n        buf.writeUInt16BE(tagsLen, offset)\n        offset += 2\n        for (const tag of option.tags) {\n          buf.writeUInt16BE(tag, offset)\n          offset += 2\n        }\n        break\n      default:\n        throw new Error(`Unknown roption code: ${option.code}`)\n    }\n  }\n\n  roption.encode.bytes = offset - oldOffset\n  return buf\n}\n\nroption.encode.bytes = 0\n\nroption.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const option = {}\n  option.code = buf.readUInt16BE(offset)\n  option.type = optioncodes.toString(option.code)\n  offset += 2\n  const len = buf.readUInt16BE(offset)\n  offset += 2\n  option.data = buf.slice(offset, offset + len)\n  switch (option.code) {\n    // case 3: NSID.  No decode makes sense.\n    case 8: // ECS\n      option.family = buf.readUInt16BE(offset)\n      offset += 2\n      option.sourcePrefixLength = buf.readUInt8(offset++)\n      option.scopePrefixLength = buf.readUInt8(offset++)\n      const padded = Buffer.alloc((option.family === 1) ? 4 : 16)\n      buf.copy(padded, 0, offset, offset + len - 4)\n      option.ip = ip.decode(padded)\n      break\n    // case 12: Padding.  No decode makes sense.\n    case 11: // KEEP-ALIVE\n      if (len > 0) {\n        option.timeout = buf.readUInt16BE(offset)\n        offset += 2\n      }\n      break\n    case 14:\n      option.tags = []\n      for (let i = 0; i < len; i += 2) {\n        option.tags.push(buf.readUInt16BE(offset))\n        offset += 2\n      }\n    // don't worry about default.  caller will use data if desired\n  }\n\n  roption.decode.bytes = len + 4\n  return option\n}\n\nroption.decode.bytes = 0\n\nroption.encodingLength = function (option) {\n  if (option.data) {\n    return option.data.length + 4\n  }\n  const code = optioncodes.toCode(option.code)\n  switch (code) {\n    case 8: // ECS\n      const spl = option.sourcePrefixLength || 0\n      return Math.ceil(spl / 8) + 8\n    case 11: // KEEP-ALIVE\n      return (typeof option.timeout === 'number') ? 6 : 4\n    case 12: // PADDING\n      return option.length + 4\n    case 14: // KEY-TAG\n      return 4 + (option.tags.length * 2)\n  }\n  throw new Error(`Unknown roption code: ${option.code}`)\n}\n\nconst ropt = exports.opt = {}\n\nropt.encode = function (options, buf, offset) {\n  if (!buf) buf = Buffer.alloc(ropt.encodingLength(options))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const rdlen = encodingLengthList(options, roption)\n  buf.writeUInt16BE(rdlen, offset)\n  offset = encodeList(options, roption, buf, offset + 2)\n\n  ropt.encode.bytes = offset - oldOffset\n  return buf\n}\n\nropt.encode.bytes = 0\n\nropt.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const options = []\n  let rdlen = buf.readUInt16BE(offset)\n  offset += 2\n  let o = 0\n  while (rdlen > 0) {\n    options[o++] = roption.decode(buf, offset)\n    offset += roption.decode.bytes\n    rdlen -= roption.decode.bytes\n  }\n  ropt.decode.bytes = offset - oldOffset\n  return options\n}\n\nropt.decode.bytes = 0\n\nropt.encodingLength = function (options) {\n  return 2 + encodingLengthList(options || [], roption)\n}\n\nconst rdnskey = exports.dnskey = {}\n\nrdnskey.PROTOCOL_DNSSEC = 3\nrdnskey.ZONE_KEY = 0x80\nrdnskey.SECURE_ENTRYPOINT = 0x8000\n\nrdnskey.encode = function (key, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rdnskey.encodingLength(key))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const keydata = key.key\n  if (!Buffer.isBuffer(keydata)) {\n    throw new Error('Key must be a Buffer')\n  }\n\n  offset += 2 // Leave space for length\n  buf.writeUInt16BE(key.flags, offset)\n  offset += 2\n  buf.writeUInt8(rdnskey.PROTOCOL_DNSSEC, offset)\n  offset += 1\n  buf.writeUInt8(key.algorithm, offset)\n  offset += 1\n  keydata.copy(buf, offset, 0, keydata.length)\n  offset += keydata.length\n\n  rdnskey.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rdnskey.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrdnskey.encode.bytes = 0\n\nrdnskey.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  var key = {}\n  var length = buf.readUInt16BE(offset)\n  offset += 2\n  key.flags = buf.readUInt16BE(offset)\n  offset += 2\n  if (buf.readUInt8(offset) !== rdnskey.PROTOCOL_DNSSEC) {\n    throw new Error('Protocol must be 3')\n  }\n  offset += 1\n  key.algorithm = buf.readUInt8(offset)\n  offset += 1\n  key.key = buf.slice(offset, oldOffset + length + 2)\n  offset += key.key.length\n  rdnskey.decode.bytes = offset - oldOffset\n  return key\n}\n\nrdnskey.decode.bytes = 0\n\nrdnskey.encodingLength = function (key) {\n  return 6 + Buffer.byteLength(key.key)\n}\n\nconst rrrsig = exports.rrsig = {}\n\nrrrsig.encode = function (sig, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rrrsig.encodingLength(sig))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const signature = sig.signature\n  if (!Buffer.isBuffer(signature)) {\n    throw new Error('Signature must be a Buffer')\n  }\n\n  offset += 2 // Leave space for length\n  buf.writeUInt16BE(types.toType(sig.typeCovered), offset)\n  offset += 2\n  buf.writeUInt8(sig.algorithm, offset)\n  offset += 1\n  buf.writeUInt8(sig.labels, offset)\n  offset += 1\n  buf.writeUInt32BE(sig.originalTTL, offset)\n  offset += 4\n  buf.writeUInt32BE(sig.expiration, offset)\n  offset += 4\n  buf.writeUInt32BE(sig.inception, offset)\n  offset += 4\n  buf.writeUInt16BE(sig.keyTag, offset)\n  offset += 2\n  name.encode(sig.signersName, buf, offset)\n  offset += name.encode.bytes\n  signature.copy(buf, offset, 0, signature.length)\n  offset += signature.length\n\n  rrrsig.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rrrsig.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrrrsig.encode.bytes = 0\n\nrrrsig.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  var sig = {}\n  var length = buf.readUInt16BE(offset)\n  offset += 2\n  sig.typeCovered = types.toString(buf.readUInt16BE(offset))\n  offset += 2\n  sig.algorithm = buf.readUInt8(offset)\n  offset += 1\n  sig.labels = buf.readUInt8(offset)\n  offset += 1\n  sig.originalTTL = buf.readUInt32BE(offset)\n  offset += 4\n  sig.expiration = buf.readUInt32BE(offset)\n  offset += 4\n  sig.inception = buf.readUInt32BE(offset)\n  offset += 4\n  sig.keyTag = buf.readUInt16BE(offset)\n  offset += 2\n  sig.signersName = name.decode(buf, offset)\n  offset += name.decode.bytes\n  sig.signature = buf.slice(offset, oldOffset + length + 2)\n  offset += sig.signature.length\n  rrrsig.decode.bytes = offset - oldOffset\n  return sig\n}\n\nrrrsig.decode.bytes = 0\n\nrrrsig.encodingLength = function (sig) {\n  return 20 +\n    name.encodingLength(sig.signersName) +\n    Buffer.byteLength(sig.signature)\n}\n\nconst rrp = exports.rp = {}\n\nrrp.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rrp.encodingLength(data))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  offset += 2 // Leave space for length\n  name.encode(data.mbox || '.', buf, offset, { mail: true })\n  offset += name.encode.bytes\n  name.encode(data.txt || '.', buf, offset)\n  offset += name.encode.bytes\n  rrp.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rrp.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrrp.encode.bytes = 0\n\nrrp.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const data = {}\n  offset += 2\n  data.mbox = name.decode(buf, offset, { mail: true }) || '.'\n  offset += name.decode.bytes\n  data.txt = name.decode(buf, offset) || '.'\n  offset += name.decode.bytes\n  rrp.decode.bytes = offset - oldOffset\n  return data\n}\n\nrrp.decode.bytes = 0\n\nrrp.encodingLength = function (data) {\n  return 2 + name.encodingLength(data.mbox || '.') + name.encodingLength(data.txt || '.')\n}\n\nconst typebitmap = {}\n\ntypebitmap.encode = function (typelist, buf, offset) {\n  if (!buf) buf = Buffer.alloc(typebitmap.encodingLength(typelist))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  var typesByWindow = []\n  for (var i = 0; i < typelist.length; i++) {\n    var typeid = types.toType(typelist[i])\n    if (typesByWindow[typeid >> 8] === undefined) {\n      typesByWindow[typeid >> 8] = []\n    }\n    typesByWindow[typeid >> 8][(typeid >> 3) & 0x1F] |= 1 << (7 - (typeid & 0x7))\n  }\n\n  for (i = 0; i < typesByWindow.length; i++) {\n    if (typesByWindow[i] !== undefined) {\n      var windowBuf = Buffer.from(typesByWindow[i])\n      buf.writeUInt8(i, offset)\n      offset += 1\n      buf.writeUInt8(windowBuf.length, offset)\n      offset += 1\n      windowBuf.copy(buf, offset)\n      offset += windowBuf.length\n    }\n  }\n\n  typebitmap.encode.bytes = offset - oldOffset\n  return buf\n}\n\ntypebitmap.encode.bytes = 0\n\ntypebitmap.decode = function (buf, offset, length) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  var typelist = []\n  while (offset - oldOffset < length) {\n    var window = buf.readUInt8(offset)\n    offset += 1\n    var windowLength = buf.readUInt8(offset)\n    offset += 1\n    for (var i = 0; i < windowLength; i++) {\n      var b = buf.readUInt8(offset + i)\n      for (var j = 0; j < 8; j++) {\n        if (b & (1 << (7 - j))) {\n          var typeid = types.toString((window << 8) | (i << 3) | j)\n          typelist.push(typeid)\n        }\n      }\n    }\n    offset += windowLength\n  }\n\n  typebitmap.decode.bytes = offset - oldOffset\n  return typelist\n}\n\ntypebitmap.decode.bytes = 0\n\ntypebitmap.encodingLength = function (typelist) {\n  var extents = []\n  for (var i = 0; i < typelist.length; i++) {\n    var typeid = types.toType(typelist[i])\n    extents[typeid >> 8] = Math.max(extents[typeid >> 8] || 0, typeid & 0xFF)\n  }\n\n  var len = 0\n  for (i = 0; i < extents.length; i++) {\n    if (extents[i] !== undefined) {\n      len += 2 + Math.ceil((extents[i] + 1) / 8)\n    }\n  }\n\n  return len\n}\n\nconst rnsec = exports.nsec = {}\n\nrnsec.encode = function (record, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rnsec.encodingLength(record))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  offset += 2 // Leave space for length\n  name.encode(record.nextDomain, buf, offset)\n  offset += name.encode.bytes\n  typebitmap.encode(record.rrtypes, buf, offset)\n  offset += typebitmap.encode.bytes\n\n  rnsec.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rnsec.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrnsec.encode.bytes = 0\n\nrnsec.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  var record = {}\n  var length = buf.readUInt16BE(offset)\n  offset += 2\n  record.nextDomain = name.decode(buf, offset)\n  offset += name.decode.bytes\n  record.rrtypes = typebitmap.decode(buf, offset, length - (offset - oldOffset))\n  offset += typebitmap.decode.bytes\n\n  rnsec.decode.bytes = offset - oldOffset\n  return record\n}\n\nrnsec.decode.bytes = 0\n\nrnsec.encodingLength = function (record) {\n  return 2 +\n    name.encodingLength(record.nextDomain) +\n    typebitmap.encodingLength(record.rrtypes)\n}\n\nconst rnsec3 = exports.nsec3 = {}\n\nrnsec3.encode = function (record, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rnsec3.encodingLength(record))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const salt = record.salt\n  if (!Buffer.isBuffer(salt)) {\n    throw new Error('salt must be a Buffer')\n  }\n\n  const nextDomain = record.nextDomain\n  if (!Buffer.isBuffer(nextDomain)) {\n    throw new Error('nextDomain must be a Buffer')\n  }\n\n  offset += 2 // Leave space for length\n  buf.writeUInt8(record.algorithm, offset)\n  offset += 1\n  buf.writeUInt8(record.flags, offset)\n  offset += 1\n  buf.writeUInt16BE(record.iterations, offset)\n  offset += 2\n  buf.writeUInt8(salt.length, offset)\n  offset += 1\n  salt.copy(buf, offset, 0, salt.length)\n  offset += salt.length\n  buf.writeUInt8(nextDomain.length, offset)\n  offset += 1\n  nextDomain.copy(buf, offset, 0, nextDomain.length)\n  offset += nextDomain.length\n  typebitmap.encode(record.rrtypes, buf, offset)\n  offset += typebitmap.encode.bytes\n\n  rnsec3.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rnsec3.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrnsec3.encode.bytes = 0\n\nrnsec3.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  var record = {}\n  var length = buf.readUInt16BE(offset)\n  offset += 2\n  record.algorithm = buf.readUInt8(offset)\n  offset += 1\n  record.flags = buf.readUInt8(offset)\n  offset += 1\n  record.iterations = buf.readUInt16BE(offset)\n  offset += 2\n  const saltLength = buf.readUInt8(offset)\n  offset += 1\n  record.salt = buf.slice(offset, offset + saltLength)\n  offset += saltLength\n  const hashLength = buf.readUInt8(offset)\n  offset += 1\n  record.nextDomain = buf.slice(offset, offset + hashLength)\n  offset += hashLength\n  record.rrtypes = typebitmap.decode(buf, offset, length - (offset - oldOffset))\n  offset += typebitmap.decode.bytes\n\n  rnsec3.decode.bytes = offset - oldOffset\n  return record\n}\n\nrnsec3.decode.bytes = 0\n\nrnsec3.encodingLength = function (record) {\n  return 8 +\n    record.salt.length +\n    record.nextDomain.length +\n    typebitmap.encodingLength(record.rrtypes)\n}\n\nconst rds = exports.ds = {}\n\nrds.encode = function (digest, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rds.encodingLength(digest))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const digestdata = digest.digest\n  if (!Buffer.isBuffer(digestdata)) {\n    throw new Error('Digest must be a Buffer')\n  }\n\n  offset += 2 // Leave space for length\n  buf.writeUInt16BE(digest.keyTag, offset)\n  offset += 2\n  buf.writeUInt8(digest.algorithm, offset)\n  offset += 1\n  buf.writeUInt8(digest.digestType, offset)\n  offset += 1\n  digestdata.copy(buf, offset, 0, digestdata.length)\n  offset += digestdata.length\n\n  rds.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rds.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrds.encode.bytes = 0\n\nrds.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  var digest = {}\n  var length = buf.readUInt16BE(offset)\n  offset += 2\n  digest.keyTag = buf.readUInt16BE(offset)\n  offset += 2\n  digest.algorithm = buf.readUInt8(offset)\n  offset += 1\n  digest.digestType = buf.readUInt8(offset)\n  offset += 1\n  digest.digest = buf.slice(offset, oldOffset + length + 2)\n  offset += digest.digest.length\n  rds.decode.bytes = offset - oldOffset\n  return digest\n}\n\nrds.decode.bytes = 0\n\nrds.encodingLength = function (digest) {\n  return 6 + Buffer.byteLength(digest.digest)\n}\n\nconst rsshfp = exports.sshfp = {}\n\nrsshfp.getFingerprintLengthForHashType = function getFingerprintLengthForHashType (hashType) {\n  switch (hashType) {\n    case 1: return 20\n    case 2: return 32\n  }\n}\n\nrsshfp.encode = function encode (record, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rsshfp.encodingLength(record))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  offset += 2 // The function call starts with the offset pointer at the RDLENGTH field, not the RDATA one\n  buf[offset] = record.algorithm\n  offset += 1\n  buf[offset] = record.hash\n  offset += 1\n\n  const fingerprintBuf = Buffer.from(record.fingerprint.toUpperCase(), 'hex')\n  if (fingerprintBuf.length !== rsshfp.getFingerprintLengthForHashType(record.hash)) {\n    throw new Error('Invalid fingerprint length')\n  }\n  fingerprintBuf.copy(buf, offset)\n  offset += fingerprintBuf.byteLength\n\n  rsshfp.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rsshfp.encode.bytes - 2, oldOffset)\n\n  return buf\n}\n\nrsshfp.encode.bytes = 0\n\nrsshfp.decode = function decode (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const record = {}\n  offset += 2 // Account for the RDLENGTH field\n  record.algorithm = buf[offset]\n  offset += 1\n  record.hash = buf[offset]\n  offset += 1\n\n  const fingerprintLength = rsshfp.getFingerprintLengthForHashType(record.hash)\n  record.fingerprint = buf.slice(offset, offset + fingerprintLength).toString('hex').toUpperCase()\n  offset += fingerprintLength\n  rsshfp.decode.bytes = offset - oldOffset\n  return record\n}\n\nrsshfp.decode.bytes = 0\n\nrsshfp.encodingLength = function (record) {\n  return 4 + Buffer.from(record.fingerprint, 'hex').byteLength\n}\n\nconst rnaptr = exports.naptr = {}\n\nrnaptr.encode = function (data, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rnaptr.encodingLength(data))\n  if (!offset) offset = 0\n  const oldOffset = offset\n  offset += 2\n  buf.writeUInt16BE(data.order || 0, offset)\n  offset += 2\n  buf.writeUInt16BE(data.preference || 0, offset)\n  offset += 2\n  string.encode(data.flags, buf, offset)\n  offset += string.encode.bytes\n  string.encode(data.services, buf, offset)\n  offset += string.encode.bytes\n  string.encode(data.regexp, buf, offset)\n  offset += string.encode.bytes\n  name.encode(data.replacement, buf, offset)\n  offset += name.encode.bytes\n  rnaptr.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rnaptr.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrnaptr.encode.bytes = 0\n\nrnaptr.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n  const data = {}\n  offset += 2\n  data.order = buf.readUInt16BE(offset)\n  offset += 2\n  data.preference = buf.readUInt16BE(offset)\n  offset += 2\n  data.flags = string.decode(buf, offset)\n  offset += string.decode.bytes\n  data.services = string.decode(buf, offset)\n  offset += string.decode.bytes\n  data.regexp = string.decode(buf, offset)\n  offset += string.decode.bytes\n  data.replacement = name.decode(buf, offset)\n  offset += name.decode.bytes\n  rnaptr.decode.bytes = offset - oldOffset\n  return data\n}\n\nrnaptr.decode.bytes = 0\n\nrnaptr.encodingLength = function (data) {\n  return string.encodingLength(data.flags) +\n    string.encodingLength(data.services) +\n    string.encodingLength(data.regexp) +\n    name.encodingLength(data.replacement) + 6\n}\n\nconst rtlsa = exports.tlsa = {}\n\nrtlsa.encode = function (cert, buf, offset) {\n  if (!buf) buf = Buffer.alloc(rtlsa.encodingLength(cert))\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const certdata = cert.certificate\n  if (!Buffer.isBuffer(certdata)) {\n    throw new Error('Certificate must be a Buffer')\n  }\n\n  offset += 2 // Leave space for length\n  buf.writeUInt8(cert.usage, offset)\n  offset += 1\n  buf.writeUInt8(cert.selector, offset)\n  offset += 1\n  buf.writeUInt8(cert.matchingType, offset)\n  offset += 1\n  certdata.copy(buf, offset, 0, certdata.length)\n  offset += certdata.length\n\n  rtlsa.encode.bytes = offset - oldOffset\n  buf.writeUInt16BE(rtlsa.encode.bytes - 2, oldOffset)\n  return buf\n}\n\nrtlsa.encode.bytes = 0\n\nrtlsa.decode = function (buf, offset) {\n  if (!offset) offset = 0\n  const oldOffset = offset\n\n  const cert = {}\n  const length = buf.readUInt16BE(offset)\n  offset += 2\n  cert.usage = buf.readUInt8(offset)\n  offset += 1\n  cert.selector = buf.readUInt8(offset)\n  offset += 1\n  cert.matchingType = buf.readUInt8(offset)\n  offset += 1\n  cert.certificate = buf.slice(offset, oldOffset + length + 2)\n  offset += cert.certificate.length\n  rtlsa.decode.bytes = offset - oldOffset\n  return cert\n}\n\nrtlsa.decode.bytes = 0\n\nrtlsa.encodingLength = function (cert) {\n  return 5 + Buffer.byteLength(cert.certificate)\n}\n\nconst renc = exports.record = function (type) {\n  switch (type.toUpperCase()) {\n    case 'A': return ra\n    case 'PTR': return rptr\n    case 'CNAME': return rcname\n    case 'DNAME': return rdname\n    case 'TXT': return rtxt\n    case 'NULL': return rnull\n    case 'AAAA': return raaaa\n    case 'SRV': return rsrv\n    case 'HINFO': return rhinfo\n    case 'CAA': return rcaa\n    case 'NS': return rns\n    case 'SOA': return rsoa\n    case 'MX': return rmx\n    case 'OPT': return ropt\n    case 'DNSKEY': return rdnskey\n    case 'RRSIG': return rrrsig\n    case 'RP': return rrp\n    case 'NSEC': return rnsec\n    case 'NSEC3': return rnsec3\n    case 'SSHFP': return rsshfp\n    case 'DS': return rds\n    case 'NAPTR': return rnaptr\n    case 'TLSA': return rtlsa\n  }\n  return runknown\n}\n\nconst answer = exports.answer = {}\n\nanswer.encode = function (a, buf, offset) {\n  if (!buf) buf = Buffer.alloc(answer.encodingLength(a))\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n\n  name.encode(a.name, buf, offset)\n  offset += name.encode.bytes\n\n  buf.writeUInt16BE(types.toType(a.type), offset)\n\n  if (a.type.toUpperCase() === 'OPT') {\n    if (a.name !== '.') {\n      throw new Error('OPT name must be root.')\n    }\n    buf.writeUInt16BE(a.udpPayloadSize || 4096, offset + 2)\n    buf.writeUInt8(a.extendedRcode || 0, offset + 4)\n    buf.writeUInt8(a.ednsVersion || 0, offset + 5)\n    buf.writeUInt16BE(a.flags || 0, offset + 6)\n\n    offset += 8\n    ropt.encode(a.options || [], buf, offset)\n    offset += ropt.encode.bytes\n  } else {\n    let klass = classes.toClass(a.class === undefined ? 'IN' : a.class)\n    if (a.flush) klass |= FLUSH_MASK // the 1st bit of the class is the flush bit\n    buf.writeUInt16BE(klass, offset + 2)\n    buf.writeUInt32BE(a.ttl || 0, offset + 4)\n\n    offset += 8\n    const enc = renc(a.type)\n    enc.encode(a.data, buf, offset)\n    offset += enc.encode.bytes\n  }\n\n  answer.encode.bytes = offset - oldOffset\n  return buf\n}\n\nanswer.encode.bytes = 0\n\nanswer.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const a = {}\n  const oldOffset = offset\n\n  a.name = name.decode(buf, offset)\n  offset += name.decode.bytes\n  a.type = types.toString(buf.readUInt16BE(offset))\n  if (a.type === 'OPT') {\n    a.udpPayloadSize = buf.readUInt16BE(offset + 2)\n    a.extendedRcode = buf.readUInt8(offset + 4)\n    a.ednsVersion = buf.readUInt8(offset + 5)\n    a.flags = buf.readUInt16BE(offset + 6)\n    a.flag_do = ((a.flags >> 15) & 0x1) === 1\n    a.options = ropt.decode(buf, offset + 8)\n    offset += 8 + ropt.decode.bytes\n  } else {\n    const klass = buf.readUInt16BE(offset + 2)\n    a.ttl = buf.readUInt32BE(offset + 4)\n\n    a.class = classes.toString(klass & NOT_FLUSH_MASK)\n    a.flush = !!(klass & FLUSH_MASK)\n\n    const enc = renc(a.type)\n    a.data = enc.decode(buf, offset + 8)\n    offset += 8 + enc.decode.bytes\n  }\n\n  answer.decode.bytes = offset - oldOffset\n  return a\n}\n\nanswer.decode.bytes = 0\n\nanswer.encodingLength = function (a) {\n  const data = (a.data !== null && a.data !== undefined) ? a.data : a.options\n  return name.encodingLength(a.name) + 8 + renc(a.type).encodingLength(data)\n}\n\nconst question = exports.question = {}\n\nquestion.encode = function (q, buf, offset) {\n  if (!buf) buf = Buffer.alloc(question.encodingLength(q))\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n\n  name.encode(q.name, buf, offset)\n  offset += name.encode.bytes\n\n  buf.writeUInt16BE(types.toType(q.type), offset)\n  offset += 2\n\n  buf.writeUInt16BE(classes.toClass(q.class === undefined ? 'IN' : q.class), offset)\n  offset += 2\n\n  question.encode.bytes = offset - oldOffset\n  return q\n}\n\nquestion.encode.bytes = 0\n\nquestion.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n  const q = {}\n\n  q.name = name.decode(buf, offset)\n  offset += name.decode.bytes\n\n  q.type = types.toString(buf.readUInt16BE(offset))\n  offset += 2\n\n  q.class = classes.toString(buf.readUInt16BE(offset))\n  offset += 2\n\n  const qu = !!(q.class & QU_MASK)\n  if (qu) q.class &= NOT_QU_MASK\n\n  question.decode.bytes = offset - oldOffset\n  return q\n}\n\nquestion.decode.bytes = 0\n\nquestion.encodingLength = function (q) {\n  return name.encodingLength(q.name) + 4\n}\n\nexports.AUTHORITATIVE_ANSWER = 1 << 10\nexports.TRUNCATED_RESPONSE = 1 << 9\nexports.RECURSION_DESIRED = 1 << 8\nexports.RECURSION_AVAILABLE = 1 << 7\nexports.AUTHENTIC_DATA = 1 << 5\nexports.CHECKING_DISABLED = 1 << 4\nexports.DNSSEC_OK = 1 << 15\n\nexports.encode = function (result, buf, offset) {\n  const allocing = !buf\n\n  if (allocing) buf = Buffer.alloc(exports.encodingLength(result))\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n\n  if (!result.questions) result.questions = []\n  if (!result.answers) result.answers = []\n  if (!result.authorities) result.authorities = []\n  if (!result.additionals) result.additionals = []\n\n  header.encode(result, buf, offset)\n  offset += header.encode.bytes\n\n  offset = encodeList(result.questions, question, buf, offset)\n  offset = encodeList(result.answers, answer, buf, offset)\n  offset = encodeList(result.authorities, answer, buf, offset)\n  offset = encodeList(result.additionals, answer, buf, offset)\n\n  exports.encode.bytes = offset - oldOffset\n\n  // just a quick sanity check\n  if (allocing && exports.encode.bytes !== buf.length) {\n    return buf.slice(0, exports.encode.bytes)\n  }\n\n  return buf\n}\n\nexports.encode.bytes = 0\n\nexports.decode = function (buf, offset) {\n  if (!offset) offset = 0\n\n  const oldOffset = offset\n  const result = header.decode(buf, offset)\n  offset += header.decode.bytes\n\n  offset = decodeList(result.questions, question, buf, offset)\n  offset = decodeList(result.answers, answer, buf, offset)\n  offset = decodeList(result.authorities, answer, buf, offset)\n  offset = decodeList(result.additionals, answer, buf, offset)\n\n  exports.decode.bytes = offset - oldOffset\n\n  return result\n}\n\nexports.decode.bytes = 0\n\nexports.encodingLength = function (result) {\n  return header.encodingLength(result) +\n    encodingLengthList(result.questions || [], question) +\n    encodingLengthList(result.answers || [], answer) +\n    encodingLengthList(result.authorities || [], answer) +\n    encodingLengthList(result.additionals || [], answer)\n}\n\nexports.streamEncode = function (result) {\n  const buf = exports.encode(result)\n  const sbuf = Buffer.alloc(2)\n  sbuf.writeUInt16BE(buf.byteLength)\n  const combine = Buffer.concat([sbuf, buf])\n  exports.streamEncode.bytes = combine.byteLength\n  return combine\n}\n\nexports.streamEncode.bytes = 0\n\nexports.streamDecode = function (sbuf) {\n  const len = sbuf.readUInt16BE(0)\n  if (sbuf.byteLength < len + 2) {\n    // not enough data\n    return null\n  }\n  const result = exports.decode(sbuf.slice(2))\n  exports.streamDecode.bytes = exports.decode.bytes\n  return result\n}\n\nexports.streamDecode.bytes = 0\n\nfunction encodingLengthList (list, enc) {\n  let len = 0\n  for (let i = 0; i < list.length; i++) len += enc.encodingLength(list[i])\n  return len\n}\n\nfunction encodeList (list, enc, buf, offset) {\n  for (let i = 0; i < list.length; i++) {\n    enc.encode(list[i], buf, offset)\n    offset += enc.encode.bytes\n  }\n  return offset\n}\n\nfunction decodeList (list, enc, buf, offset) {\n  for (let i = 0; i < list.length; i++) {\n    list[i] = enc.decode(buf, offset)\n    offset += enc.decode.bytes\n  }\n  return offset\n}\n","import {\n  BitWriter,\n  bufferReader,\n  bufferWriter,\n  getBit,\n} from \"../../../../common/src\";\n\nexport class ReceiverEstimatedMaxBitrate {\n  static count = 15;\n  length!: number;\n  count = ReceiverEstimatedMaxBitrate.count;\n  senderSsrc!: number;\n  mediaSsrc!: number;\n  readonly uniqueID: string = \"REMB\";\n  ssrcNum: number = 0;\n  brExp!: number;\n  brMantissa!: number;\n  bitrate!: bigint;\n  ssrcFeedbacks: number[] = [];\n\n  constructor(props: Partial<ReceiverEstimatedMaxBitrate> = {}) {\n    Object.assign(this, props);\n  }\n\n  static deSerialize(data: Buffer) {\n    const [senderSsrc, mediaSsrc, uniqueID, ssrcNum, e_m] = bufferReader(\n      data,\n      [4, 4, 4, 1, 1],\n    );\n\n    const brExp = getBit(e_m, 0, 6);\n    const brMantissa = (getBit(e_m, 6, 2) << 16) + (data[14] << 8) + data[15];\n\n    const bitrate =\n      brExp > 46 ? 18446744073709551615n : BigInt(brMantissa) << BigInt(brExp);\n\n    const ssrcFeedbacks: number[] = [];\n    for (let i = 16; i < data.length; i += 4) {\n      const feedback = data.slice(i).readUIntBE(0, 4);\n      ssrcFeedbacks.push(feedback);\n    }\n\n    return new ReceiverEstimatedMaxBitrate({\n      senderSsrc,\n      mediaSsrc,\n      uniqueID: bufferWriter([4], [uniqueID]).toString(),\n      ssrcNum,\n      brExp,\n      brMantissa,\n      ssrcFeedbacks,\n      bitrate,\n    });\n  }\n\n  serialize() {\n    const constant = Buffer.concat([\n      bufferWriter([4, 4], [this.senderSsrc, this.mediaSsrc]),\n      Buffer.from(this.uniqueID),\n      bufferWriter([1], [this.ssrcNum]),\n    ]);\n\n    const writer = new BitWriter(24);\n    writer.set(6, 0, this.brExp).set(18, 6, this.brMantissa);\n    const feedbacks = Buffer.concat(\n      this.ssrcFeedbacks.map((feedback) => bufferWriter([4], [feedback])),\n    );\n\n    const buf = Buffer.concat([\n      constant,\n      bufferWriter([3], [writer.value]),\n      feedbacks,\n    ]);\n    this.length = buf.length / 4;\n    return buf;\n  }\n}\n","module.exports = require(\"util\");","import { createHmac, randomBytes } from \"crypto\";\nimport { jspack } from \"@shinyoshiaki/jspack\";\n\nimport { nextTick } from \"process\";\nimport {\n  AbortChunk,\n  type Chunk,\n  CookieAckChunk,\n  CookieEchoChunk,\n  DataChunk,\n  ErrorChunk,\n  ForwardTsnChunk,\n  HeartbeatAckChunk,\n  HeartbeatChunk,\n  InitAckChunk,\n  InitChunk,\n  ReConfigChunk,\n  ReconfigChunk,\n  SackChunk,\n  ShutdownAckChunk,\n  ShutdownChunk,\n  ShutdownCompleteChunk,\n  parsePacket,\n  serializePacket,\n} from \"./chunk\";\nimport { SCTP_STATE } from \"./const\";\nimport { type Unpacked, createEventsFromList, enumerate } from \"./helper\";\nimport {\n  Event,\n  debug,\n  random32,\n  uint16Add,\n  uint16Gt,\n  uint32Gt,\n  uint32Gte,\n} from \"./imports/common\";\nimport {\n  OutgoingSSNResetRequestParam,\n  RECONFIG_PARAM_BY_TYPES,\n  ReconfigResponseParam,\n  StreamAddOutgoingParam,\n  type StreamParam,\n  reconfigResult,\n} from \"./param\";\nimport type { Transport } from \"./transport\";\n\nconst log = debug(\"werift/sctp/sctp\");\n\n// SSN: Stream Sequence Number\n\n// # local constants\nconst COOKIE_LENGTH = 24;\nconst COOKIE_LIFETIME = 60;\nconst MAX_STREAMS = 65535;\nconst USERDATA_MAX_LENGTH = 1200;\n\n// # protocol constants\nconst SCTP_DATA_LAST_FRAG = 0x01;\nconst SCTP_DATA_FIRST_FRAG = 0x02;\nconst SCTP_DATA_UNORDERED = 0x04;\n\nconst SCTP_MAX_ASSOCIATION_RETRANS = 10;\nconst SCTP_MAX_INIT_RETRANS = 8;\nconst SCTP_RTO_ALPHA = 1 / 8;\nconst SCTP_RTO_BETA = 1 / 4;\nconst SCTP_RTO_INITIAL = 3;\nconst SCTP_RTO_MIN = 1;\nconst SCTP_RTO_MAX = 60;\nconst SCTP_TSN_MODULO = 2 ** 32;\n\nconst RECONFIG_MAX_STREAMS = 135;\n\n// # parameters\nconst SCTP_STATE_COOKIE = 0x0007;\nconst SCTP_SUPPORTED_CHUNK_EXT = 0x8008; //32778\nconst SCTP_PRSCTP_SUPPORTED = 0xc000; //49152\n\nconst SCTPConnectionStates = [\n  \"new\",\n  \"closed\",\n  \"connected\",\n  \"connecting\",\n] as const;\ntype SCTPConnectionState = Unpacked<typeof SCTPConnectionStates>;\n\nexport class SCTP {\n  flush = new Event<[void]>();\n  readonly stateChanged: {\n    [key in SCTPConnectionState]: Event<[]>;\n  } = createEventsFromList(SCTPConnectionStates);\n  readonly onReconfigStreams = new Event<[number[]]>();\n  /**streamId: number, ppId: number, data: Buffer */\n  readonly onReceive = new Event<[number, number, Buffer]>();\n  onSackReceived: () => Promise<void> = async () => {};\n\n  associationState = SCTP_STATE.CLOSED;\n  started = false;\n  state: SCTPConnectionState = \"new\";\n  isServer = true;\n\n  private hmacKey = randomBytes(16);\n  private localPartialReliability = true;\n  private localPort: number;\n  private localVerificationTag = random32();\n\n  remoteExtensions: number[] = [];\n  remotePartialReliability = true;\n  private remotePort?: number;\n  private remoteVerificationTag = 0;\n\n  // inbound\n  private advertisedRwnd = 1024 * 1024; // Receiver Window\n  private inboundStreams: { [key: number]: InboundStream } = {};\n  _inboundStreamsCount = 0;\n  _inboundStreamsMax = MAX_STREAMS;\n  private lastReceivedTsn?: number; // Transmission Sequence Number\n  private sackDuplicates: number[] = [];\n  private sackMisOrdered = new Set<number>();\n  private sackNeeded = false;\n  private sackTimeout: NodeJS.Immediate | undefined;\n\n  // # outbound\n  private cwnd = 3 * USERDATA_MAX_LENGTH; // Congestion Window\n  private fastRecoveryExit?: number;\n  private fastRecoveryTransmit = false;\n  private forwardTsnChunk?: ForwardTsnChunk;\n  private flightSize = 0;\n  outboundQueue: DataChunk[] = [];\n  private outboundStreamSeq: { [streamId: number]: number } = {};\n  _outboundStreamsCount = MAX_STREAMS;\n  /**local transmission sequence number */\n  private localTsn = Number(random32());\n  private lastSackedTsn = tsnMinusOne(this.localTsn);\n  private advancedPeerAckTsn = tsnMinusOne(this.localTsn); // acknowledgement\n  private partialBytesAcked = 0;\n  private sentQueue: DataChunk[] = [];\n\n  // # reconfiguration\n\n  /**TSN. re-configuration request1 */\n  reconfigRequestSeq = this.localTsn;\n  /**incomingre-configuration request. re-configuration request1 */\n  reconfigResponseSeq = 0;\n  reconfigRequest?: OutgoingSSNResetRequestParam;\n  reconfigQueue: number[] = [];\n\n  // rtt calculation\n  private srtt?: number;\n  private rttvar?: number;\n\n  // timers\n  private rto = SCTP_RTO_INITIAL;\n  /**t1 is wait for initAck or cookieAck */\n  private timer1Handle?: any;\n  private timer1Chunk?: Chunk;\n  private timer1Failures = 0;\n  /**t2 is wait for shutdown */\n  private timer2Handle?: any;\n  private timer2Chunk?: Chunk;\n  private timer2Failures = 0;\n  /**t3 is wait for data sack */\n  private timer3Handle?: any;\n  /**Re-configuration Timer */\n  private timerReconfigHandle?: any;\n  private timerReconfigFailures = 0;\n\n  // etc\n  private ssthresh?: number; // slow start threshold\n\n  constructor(\n    public transport: Transport,\n    public port = 5000,\n  ) {\n    this.localPort = this.port;\n    this.transport.onData = (buf) => {\n      this.handleData(buf);\n    };\n  }\n\n  get maxChannels() {\n    if (this._inboundStreamsCount > 0) {\n      return Math.min(this._inboundStreamsCount, this._outboundStreamsCount);\n    }\n    return undefined;\n  }\n\n  static client(transport: Transport, port = 5000) {\n    const sctp = new SCTP(transport, port);\n    sctp.isServer = false;\n    return sctp;\n  }\n\n  static server(transport: Transport, port = 5000) {\n    const sctp = new SCTP(transport, port);\n    sctp.isServer = true;\n    return sctp;\n  }\n\n  // call from dtls transport\n  private async handleData(data: Buffer) {\n    let expectedTag: number;\n\n    const [, , verificationTag, chunks] = parsePacket(data);\n    const initChunk = chunks.filter((v) => v.type === InitChunk.type).length;\n    if (initChunk > 0) {\n      if (chunks.length != 1) {\n        throw new Error();\n      }\n      expectedTag = 0;\n    } else {\n      expectedTag = this.localVerificationTag;\n    }\n\n    if (verificationTag !== expectedTag) {\n      return;\n    }\n\n    for (const chunk of chunks) {\n      await this.receiveChunk(chunk);\n    }\n\n    if (this.sackNeeded) {\n      await this.sendSack();\n    }\n  }\n\n  private async sendSack() {\n    if (this.sackTimeout) return;\n    await new Promise((r) => (this.sackTimeout = setImmediate(r)));\n    this.sackTimeout = undefined;\n    if (!this.sackNeeded) return;\n\n    const gaps: [number, number][] = [];\n    let gapNext: number;\n    [...this.sackMisOrdered].sort().forEach((tsn) => {\n      const pos = (tsn - this.lastReceivedTsn!) % SCTP_TSN_MODULO;\n      if (tsn === gapNext) {\n        gaps[gaps.length - 1][1] = pos;\n      } else {\n        gaps.push([pos, pos]);\n      }\n      gapNext = tsnPlusOne(tsn);\n    });\n    const sack = new SackChunk(0, undefined);\n    sack.cumulativeTsn = this.lastReceivedTsn!;\n    sack.advertisedRwnd = Math.max(0, this.advertisedRwnd);\n    sack.duplicates = [...this.sackDuplicates];\n    sack.gaps = gaps;\n\n    await this.sendChunk(sack).catch((err: Error) => {\n      log(\"send sack failed\", err.message);\n    });\n\n    this.sackDuplicates = [];\n    this.sackNeeded = false;\n  }\n\n  private async receiveChunk(chunk: Chunk) {\n    switch (chunk.type) {\n      case DataChunk.type:\n        {\n          this.receiveDataChunk(chunk as DataChunk);\n        }\n        break;\n      case InitChunk.type:\n        {\n          if (!this.isServer) return;\n          const init = chunk as InitChunk;\n\n          log(\"receive init\", init);\n          this.lastReceivedTsn = tsnMinusOne(init.initialTsn);\n          this.reconfigResponseSeq = tsnMinusOne(init.initialTsn);\n          this.remoteVerificationTag = init.initiateTag;\n          this.ssthresh = init.advertisedRwnd;\n          this.getExtensions(init.params);\n\n          this._inboundStreamsCount = Math.min(\n            init.outboundStreams,\n            this._inboundStreamsMax,\n          );\n          this._outboundStreamsCount = Math.min(\n            this._outboundStreamsCount,\n            init.inboundStreams,\n          );\n\n          const ack = new InitAckChunk();\n          ack.initiateTag = this.localVerificationTag;\n          ack.advertisedRwnd = this.advertisedRwnd;\n          ack.outboundStreams = this._outboundStreamsCount;\n          ack.inboundStreams = this._inboundStreamsCount;\n          ack.initialTsn = this.localTsn;\n          this.setExtensions(ack.params);\n\n          const time = Date.now() / 1000;\n          let cookie = Buffer.from(jspack.Pack(\"!L\", [time]));\n          cookie = Buffer.concat([\n            cookie,\n            createHmac(\"sha1\", this.hmacKey).update(cookie).digest(),\n          ]);\n          ack.params.push([SCTP_STATE_COOKIE, cookie]);\n          log(\"send initAck\", ack);\n          await this.sendChunk(ack).catch((err: Error) => {\n            log(\"send initAck failed\", err.message);\n          });\n        }\n        break;\n      case InitAckChunk.type:\n        {\n          if (this.associationState != SCTP_STATE.COOKIE_WAIT) return;\n\n          const initAck = chunk as InitAckChunk;\n          this.timer1Cancel();\n          this.lastReceivedTsn = tsnMinusOne(initAck.initialTsn);\n          this.reconfigResponseSeq = tsnMinusOne(initAck.initialTsn);\n          this.remoteVerificationTag = initAck.initiateTag;\n          this.ssthresh = initAck.advertisedRwnd;\n          this.getExtensions(initAck.params);\n\n          this._inboundStreamsCount = Math.min(\n            initAck.outboundStreams,\n            this._inboundStreamsMax,\n          );\n          this._outboundStreamsCount = Math.min(\n            this._outboundStreamsCount,\n            initAck.inboundStreams,\n          );\n\n          const echo = new CookieEchoChunk();\n          for (const [k, v] of initAck.params) {\n            if (k === SCTP_STATE_COOKIE) {\n              echo.body = v;\n              break;\n            }\n          }\n          await this.sendChunk(echo).catch((err: Error) => {\n            log(\"send echo failed\", err.message);\n          });\n\n          this.timer1Start(echo);\n          this.setState(SCTP_STATE.COOKIE_ECHOED);\n        }\n        break;\n      case SackChunk.type:\n        {\n          await this.receiveSackChunk(chunk as SackChunk);\n        }\n        break;\n      case HeartbeatChunk.type:\n        {\n          const ack = new HeartbeatAckChunk();\n          ack.params = (chunk as HeartbeatChunk).params;\n          await this.sendChunk(ack).catch((err: Error) => {\n            log(\"send heartbeat ack failed\", err.message);\n          });\n        }\n        break;\n      case AbortChunk.type:\n        {\n          this.setState(SCTP_STATE.CLOSED);\n        }\n        break;\n      case ShutdownChunk.type:\n        {\n          this.timer2Cancel();\n          this.setState(SCTP_STATE.SHUTDOWN_RECEIVED);\n          const ack = new ShutdownAckChunk();\n          await this.sendChunk(ack).catch((err: Error) => {\n            log(\"send shutdown ack failed\", err.message);\n          });\n          this.t2Start(ack);\n          this.setState(SCTP_STATE.SHUTDOWN_SENT);\n        }\n        break;\n      case ErrorChunk.type:\n        {\n          // 3.3.10.  Operation Error (ERROR) (9)\n          // An Operation Error is not considered fatal in and of itself, but may be\n          // used with an ABORT chunk to report a fatal condition.  It has the\n          // following parameters:\n          log(\"ErrorChunk\", (chunk as ErrorChunk).descriptions);\n        }\n        break;\n      case CookieEchoChunk.type:\n        {\n          if (!this.isServer) return;\n          const data = chunk as CookieEchoChunk;\n          const cookie = data.body!;\n          const digest = createHmac(\"sha1\", this.hmacKey)\n            .update(cookie.slice(0, 4))\n            .digest();\n          if (\n            cookie?.length != COOKIE_LENGTH ||\n            !cookie.slice(4).equals(digest)\n          ) {\n            log(\"x State cookie is invalid\");\n            return;\n          }\n          const now = Date.now() / 1000;\n          const stamp = jspack.Unpack(\"!L\", cookie)[0];\n          if (stamp < now - COOKIE_LIFETIME || stamp > now) {\n            const error = new ErrorChunk(0, undefined);\n            error.params.push([\n              ErrorChunk.CODE.StaleCookieError,\n              Buffer.concat([...Array(8)].map(() => Buffer.from(\"\\x00\"))),\n            ]);\n            await this.sendChunk(error).catch((err: Error) => {\n              log(\"send errorChunk failed\", err.message);\n            });\n            return;\n          }\n          const ack = new CookieAckChunk();\n          await this.sendChunk(ack).catch((err: Error) => {\n            log(\"send cookieAck failed\", err.message);\n          });\n          this.setState(SCTP_STATE.ESTABLISHED);\n        }\n        break;\n      case CookieAckChunk.type:\n        {\n          if (this.associationState != SCTP_STATE.COOKIE_ECHOED) return;\n          this.timer1Cancel();\n          this.setState(SCTP_STATE.ESTABLISHED);\n        }\n        break;\n      case ShutdownCompleteChunk.type:\n        {\n          if (this.associationState != SCTP_STATE.SHUTDOWN_ACK_SENT) return;\n          this.timer2Cancel();\n          this.setState(SCTP_STATE.CLOSED);\n        }\n        break;\n      // extensions\n      case ReconfigChunk.type:\n        {\n          if (this.associationState != SCTP_STATE.ESTABLISHED) return;\n          const reconfig = chunk as ReConfigChunk;\n          for (const [type, body] of reconfig.params) {\n            const target = RECONFIG_PARAM_BY_TYPES[type];\n            if (target) {\n              await this.receiveReconfigParam(target.parse(body));\n            }\n          }\n        }\n        break;\n      case ForwardTsnChunk.type:\n        {\n          this.receiveForwardTsnChunk(chunk as ForwardTsnChunk);\n        }\n        break;\n    }\n  }\n\n  private getExtensions(params: [number, Buffer][]) {\n    for (const [k, v] of params) {\n      if (k === SCTP_PRSCTP_SUPPORTED) {\n        this.remotePartialReliability = true;\n      } else if (k === SCTP_SUPPORTED_CHUNK_EXT) {\n        this.remoteExtensions = [...v];\n      }\n    }\n  }\n\n  private async receiveReconfigParam(param: StreamParam) {\n    log(\"receiveReconfigParam\", RECONFIG_PARAM_BY_TYPES[param.type]);\n    switch (param.type) {\n      case OutgoingSSNResetRequestParam.type:\n        {\n          const p = param as OutgoingSSNResetRequestParam;\n\n          // # send response\n          const response = new ReconfigResponseParam(\n            p.requestSequence,\n            reconfigResult.ReconfigResultSuccessPerformed,\n          );\n          this.reconfigResponseSeq = p.requestSequence;\n          await this.sendReconfigParam(response);\n\n          // # mark closed inbound streams\n          await Promise.all(\n            p.streams.map(async (streamId) => {\n              delete this.inboundStreams[streamId];\n              if (this.outboundStreamSeq[streamId]) {\n                // Only add to reconfigQueue if not already present\n                if (!this.reconfigQueue.includes(streamId)) {\n                  this.reconfigQueue.push(streamId);\n                }\n                // await this.sendResetRequest(streamId);\n              }\n            }),\n          );\n          await this.transmitReconfigRequest();\n          // # close data channel\n          this.onReconfigStreams.execute(p.streams);\n        }\n        break;\n      case ReconfigResponseParam.type:\n        {\n          const reset = param as ReconfigResponseParam;\n          if (reset.result !== reconfigResult.ReconfigResultSuccessPerformed) {\n            log(\n              \"OutgoingSSNResetRequestParam failed\",\n              Object.keys(reconfigResult).find(\n                (key) => reconfigResult[key as never] === reset.result,\n              ),\n            );\n          } else if (\n            reset.responseSequence === this.reconfigRequest?.requestSequence\n          ) {\n            const streamIds = this.reconfigRequest.streams.map((streamId) => {\n              delete this.outboundStreamSeq[streamId];\n              return streamId;\n            });\n\n            this.onReconfigStreams.execute(streamIds);\n\n            this.reconfigRequest = undefined;\n            this.timerReconfigCancel();\n            // Reset RTO backoff on successful reconfiguration\n            this.rto = SCTP_RTO_INITIAL;\n            this.timerReconfigFailures = 0;\n            if (this.reconfigQueue.length > 0) {\n              await this.transmitReconfigRequest();\n            }\n          }\n        }\n        break;\n      case StreamAddOutgoingParam.type:\n        {\n          const add = param as StreamAddOutgoingParam;\n          this._inboundStreamsCount += add.newStreams;\n          const res = new ReconfigResponseParam(add.requestSequence, 1);\n          this.reconfigResponseSeq = add.requestSequence;\n          await this.sendReconfigParam(res);\n        }\n        break;\n    }\n  }\n\n  private receiveDataChunk(chunk: DataChunk) {\n    this.sackNeeded = true;\n\n    if (this.markReceived(chunk.tsn)) return;\n\n    const inboundStream = this.getInboundStream(chunk.streamId);\n\n    inboundStream.addChunk(chunk);\n    this.advertisedRwnd -= chunk.userData.length;\n    for (const message of inboundStream.popMessages()) {\n      this.advertisedRwnd += message[2].length;\n      this.receive(...message);\n    }\n  }\n\n  private async receiveSackChunk(chunk: SackChunk) {\n    // \"\"\"\n    // Handle a SACK chunk.\n    // \"\"\"\n\n    if (uint32Gt(this.lastSackedTsn, chunk.cumulativeTsn)) return;\n\n    const receivedTime = Date.now() / 1000;\n    this.lastSackedTsn = chunk.cumulativeTsn;\n    const cwndFullyUtilized = this.flightSize >= this.cwnd;\n    let done = 0,\n      doneBytes = 0;\n\n    // # handle acknowledged data\n    while (\n      this.sentQueue.length > 0 &&\n      uint32Gte(this.lastSackedTsn, this.sentQueue[0].tsn)\n    ) {\n      const sChunk = this.sentQueue.shift()!;\n      done++;\n      if (!sChunk?.acked) {\n        doneBytes += sChunk.bookSize;\n        this.flightSizeDecrease(sChunk);\n      }\n\n      if (done === 1 && sChunk.sentCount === 1) {\n        this.updateRto(receivedTime - sChunk.sentTime!);\n      }\n    }\n    // Furthermore, this exposed an issue I've seen in v8 in other projects: using an array as a queue seems to result in long calls to shift (it does an array copy under the hood?). The problem seems to get worse the more times it shifts. Resetting the queue to empty array mitigates this.\n    if (!this.sentQueue.length) {\n      this.sentQueue = [];\n    }\n\n    // # handle gap blocks\n    let loss = false;\n    if (chunk.gaps.length > 0) {\n      const seen = new Set();\n      let highestSeenTsn: number;\n      chunk.gaps.forEach((gap) => {\n        for (let pos = gap[0]; pos < gap[1] + 1; pos++) {\n          highestSeenTsn = (chunk.cumulativeTsn + pos) % SCTP_TSN_MODULO;\n          seen.add(highestSeenTsn);\n        }\n      });\n\n      let highestNewlyAcked = chunk.cumulativeTsn;\n      for (const sChunk of this.sentQueue) {\n        if (uint32Gt(sChunk.tsn, highestSeenTsn!)) {\n          break;\n        }\n        if (seen.has(sChunk.tsn) && !sChunk.acked) {\n          doneBytes += sChunk.bookSize;\n          sChunk.acked = true;\n          this.flightSizeDecrease(sChunk);\n          highestNewlyAcked = sChunk.tsn;\n        }\n      }\n\n      // # strike missing chunks prior to HTNA\n      for (const sChunk of this.sentQueue) {\n        if (uint32Gt(sChunk.tsn, highestNewlyAcked)) {\n          break;\n        }\n        if (!seen.has(sChunk.tsn)) {\n          sChunk.misses++;\n          if (sChunk.misses === 3) {\n            sChunk.misses = 0;\n            if (!this.maybeAbandon(sChunk)) {\n              sChunk.retransmit = true;\n            }\n            sChunk.acked = false;\n            this.flightSizeDecrease(sChunk);\n            loss = true;\n          }\n        }\n      }\n    }\n\n    // # adjust congestion window\n    if (this.fastRecoveryExit === undefined) {\n      if (done && cwndFullyUtilized) {\n        if (this.cwnd <= this.ssthresh!) {\n          this.cwnd += Math.min(doneBytes, USERDATA_MAX_LENGTH);\n        } else {\n          this.partialBytesAcked += doneBytes;\n          if (this.partialBytesAcked >= this.cwnd) {\n            this.partialBytesAcked -= this.cwnd;\n            this.cwnd += USERDATA_MAX_LENGTH;\n          }\n        }\n      }\n      if (loss) {\n        this.ssthresh = Math.max(\n          Math.floor(this.cwnd / 2),\n          4 * USERDATA_MAX_LENGTH,\n        );\n        this.cwnd = this.ssthresh;\n        this.partialBytesAcked = 0;\n        this.fastRecoveryExit = this.sentQueue[this.sentQueue.length - 1].tsn;\n        this.fastRecoveryTransmit = true;\n      }\n    } else if (uint32Gte(chunk.cumulativeTsn, this.fastRecoveryExit)) {\n      this.fastRecoveryExit = undefined;\n    }\n\n    if (this.sentQueue.length === 0) {\n      this.timer3Cancel();\n    } else if (done > 0) {\n      this.timer3Restart();\n    }\n\n    this.updateAdvancedPeerAckPoint();\n    await this.onSackReceived();\n    await this.transmit();\n  }\n\n  receiveForwardTsnChunk(chunk: ForwardTsnChunk) {\n    this.sackNeeded = true;\n\n    if (uint32Gte(this.lastReceivedTsn!, chunk.cumulativeTsn)) {\n      return;\n    }\n\n    const isObsolete = (x: number) => uint32Gt(x, this.lastReceivedTsn!);\n\n    // # advance cumulative TSN\n    this.lastReceivedTsn = chunk.cumulativeTsn;\n    this.sackMisOrdered = new Set([...this.sackMisOrdered].filter(isObsolete));\n    for (const tsn of [...this.sackMisOrdered].sort()) {\n      if (tsn === tsnPlusOne(this.lastReceivedTsn)) {\n        this.lastReceivedTsn = tsn;\n      } else {\n        break;\n      }\n    }\n\n    // # filter out obsolete entries\n    this.sackDuplicates = this.sackDuplicates.filter(isObsolete);\n    this.sackMisOrdered = new Set([...this.sackMisOrdered].filter(isObsolete));\n\n    // # update reassembly\n    for (const [streamId, streamSeqNum] of chunk.streams) {\n      const inboundStream = this.getInboundStream(streamId);\n\n      // # advance sequence number and perform delivery\n      inboundStream.streamSequenceNumber = uint16Add(streamSeqNum, 1);\n      for (const message of inboundStream.popMessages()) {\n        this.advertisedRwnd += message[2].length;\n        this.receive(...message);\n      }\n    }\n\n    // # prune obsolete chunks\n    Object.values(this.inboundStreams).forEach((inboundStream) => {\n      this.advertisedRwnd += inboundStream.pruneChunks(this.lastReceivedTsn!);\n    });\n  }\n\n  private updateRto(R: number) {\n    if (!this.srtt) {\n      this.rttvar = R / 2;\n      this.srtt = R;\n    } else {\n      this.rttvar =\n        (1 - SCTP_RTO_BETA) * this.rttvar! +\n        SCTP_RTO_BETA * Math.abs(this.srtt - R);\n      this.srtt = (1 - SCTP_RTO_ALPHA) * this.srtt + SCTP_RTO_ALPHA * R;\n    }\n    this.rto = Math.max(\n      SCTP_RTO_MIN,\n      Math.min(this.srtt + 4 * this.rttvar, SCTP_RTO_MAX),\n    );\n  }\n\n  private receive(streamId: number, ppId: number, data: Buffer) {\n    this.onReceive.execute(streamId, ppId, data);\n  }\n\n  private getInboundStream(streamId: number) {\n    if (!this.inboundStreams[streamId]) {\n      this.inboundStreams[streamId] = new InboundStream();\n    }\n    return this.inboundStreams[streamId];\n  }\n\n  private markReceived(tsn: number) {\n    if (uint32Gte(this.lastReceivedTsn!, tsn) || this.sackMisOrdered.has(tsn)) {\n      this.sackDuplicates.push(tsn);\n      return true;\n    }\n\n    this.sackMisOrdered.add(tsn);\n    for (const tsn of [...this.sackMisOrdered].sort()) {\n      if (tsn === tsnPlusOne(this.lastReceivedTsn!)) {\n        this.lastReceivedTsn = tsn;\n      } else {\n        break;\n      }\n    }\n\n    const isObsolete = (x: number) => uint32Gt(x, this.lastReceivedTsn!);\n\n    this.sackDuplicates = this.sackDuplicates.filter(isObsolete);\n    this.sackMisOrdered = new Set([...this.sackMisOrdered].filter(isObsolete));\n\n    return false;\n  }\n\n  send = async (\n    streamId: number,\n    ppId: number,\n    userData: Buffer,\n    {\n      expiry,\n      maxRetransmits,\n      ordered,\n    }: {\n      expiry?: number | undefined;\n      maxRetransmits?: number | undefined;\n      ordered?: boolean;\n    } = { expiry: undefined, maxRetransmits: undefined, ordered: true },\n  ) => {\n    const streamSeqNum = ordered ? this.outboundStreamSeq[streamId] || 0 : 0;\n\n    const fragments = Math.ceil(userData.length / USERDATA_MAX_LENGTH);\n    let pos = 0;\n    const chunks: DataChunk[] = [];\n    for (let fragment = 0; fragment < fragments; fragment++) {\n      const chunk = new DataChunk(0, undefined);\n      chunk.flags = 0;\n      if (!ordered) {\n        chunk.flags = SCTP_DATA_UNORDERED;\n      }\n      if (fragment === 0) {\n        chunk.flags |= SCTP_DATA_FIRST_FRAG;\n      }\n      if (fragment === fragments - 1) {\n        chunk.flags |= SCTP_DATA_LAST_FRAG;\n      }\n      chunk.tsn = this.localTsn;\n      chunk.streamId = streamId;\n      chunk.streamSeqNum = streamSeqNum;\n      chunk.protocol = ppId;\n      chunk.userData = userData.slice(pos, pos + USERDATA_MAX_LENGTH);\n      chunk.bookSize = chunk.userData.length;\n      chunk.expiry = expiry;\n      chunk.maxRetransmits = maxRetransmits;\n\n      pos += USERDATA_MAX_LENGTH;\n      this.localTsn = tsnPlusOne(this.localTsn);\n      chunks.push(chunk);\n    }\n\n    chunks.forEach((chunk) => {\n      this.outboundQueue.push(chunk);\n    });\n\n    if (ordered) {\n      this.outboundStreamSeq[streamId] = uint16Add(streamSeqNum, 1);\n    }\n\n    if (!this.timer3Handle) {\n      await this.transmit();\n    } else {\n      if (this.outboundQueue.length) {\n        await this.flush.asPromise();\n      } else {\n        // unreachable?\n        await new Promise((r) => setImmediate(r));\n      }\n    }\n  };\n\n  private async transmit() {\n    // \"\"\"\n    // Transmit outbound data.\n    // \"\"\"\n\n    // # send FORWARD TSN\n    if (this.forwardTsnChunk) {\n      await this.sendChunk(this.forwardTsnChunk).catch((err: Error) => {\n        log(\"send forwardTsn failed\", err.message);\n      });\n      this.forwardTsnChunk = undefined;\n\n      if (!this.timer3Handle) {\n        this.timer3Start();\n      }\n    }\n\n    const burstSize =\n      this.fastRecoveryExit != undefined\n        ? 2 * USERDATA_MAX_LENGTH\n        : 4 * USERDATA_MAX_LENGTH;\n\n    const cwnd = Math.min(this.flightSize + burstSize, this.cwnd);\n\n    let retransmitEarliest = true;\n    for (const dataChunk of this.sentQueue) {\n      if (dataChunk.retransmit) {\n        if (this.fastRecoveryTransmit) {\n          this.fastRecoveryTransmit = false;\n        } else if (this.flightSize >= cwnd) {\n          return;\n        }\n        this.flightSizeIncrease(dataChunk);\n\n        dataChunk.misses = 0;\n        dataChunk.retransmit = false;\n        dataChunk.sentCount++;\n        await this.sendChunk(dataChunk).catch((err: Error) => {\n          log(\"send data failed\", err.message);\n        });\n\n        if (retransmitEarliest) {\n          this.timer3Restart();\n        }\n      }\n      retransmitEarliest = false;\n    }\n\n    // for performance todo fix\n    while (this.outboundQueue.length > 0) {\n      const chunk = this.outboundQueue.shift();\n      if (!chunk) return;\n\n      this.sentQueue.push(chunk);\n      this.flightSizeIncrease(chunk);\n\n      // # update counters\n      chunk.sentCount++;\n      chunk.sentTime = Date.now() / 1000;\n\n      await this.sendChunk(chunk).catch((err: Error) => {\n        log(\"send data outboundQueue failed\", err.message);\n      });\n      if (!this.timer3Handle) {\n        this.timer3Start();\n      }\n    }\n    // Resetting the queue to empty array mitigates this.\n    this.outboundQueue = [];\n    this.flush.execute();\n  }\n\n  async transmitReconfigRequest() {\n    if (\n      this.reconfigQueue.length > 0 &&\n      this.associationState === SCTP_STATE.ESTABLISHED &&\n      !this.reconfigRequest\n    ) {\n      // Remove duplicate stream IDs from reconfigQueue\n      const uniqueStreams = [...new Set(this.reconfigQueue)];\n      const streams = uniqueStreams.slice(0, RECONFIG_MAX_STREAMS);\n\n      this.reconfigQueue = uniqueStreams.slice(RECONFIG_MAX_STREAMS);\n      const param = new OutgoingSSNResetRequestParam(\n        this.reconfigRequestSeq,\n        this.reconfigResponseSeq,\n        tsnMinusOne(this.localTsn),\n        streams,\n      );\n      this.reconfigRequestSeq = tsnPlusOne(this.reconfigRequestSeq);\n\n      this.reconfigRequest = param;\n      await this.sendReconfigParam(param);\n      this.timerReconfigHandleStart();\n    }\n  }\n\n  async sendReconfigParam(param: StreamParam) {\n    log(\"sendReconfigParam\", param);\n    const chunk = new ReconfigChunk();\n    chunk.params.push([param.type, param.bytes]);\n    await this.sendChunk(chunk).catch((err: Error) => {\n      log(\"send reconfig failed\", err.message);\n    });\n  }\n\n  // https://github.com/pion/sctp/pull/44/files\n  private async sendResetRequest(streamId: number) {\n    log(\"sendResetRequest\", streamId);\n    const chunk = new DataChunk(0, undefined);\n    chunk.streamId = streamId;\n    this.outboundQueue.push(chunk);\n    if (!this.timer3Handle) {\n      await this.transmit();\n    }\n  }\n\n  private flightSizeIncrease(chunk: DataChunk) {\n    this.flightSize += chunk.bookSize;\n  }\n\n  private flightSizeDecrease(chunk: DataChunk) {\n    this.flightSize = Math.max(0, this.flightSize - chunk.bookSize);\n  }\n\n  // # timers\n\n  /**t1 is wait for initAck or cookieAck */\n  private timer1Start(chunk: Chunk) {\n    if (this.timer1Handle) throw new Error();\n    this.timer1Chunk = chunk;\n    this.timer1Failures = 0;\n    this.timer1Handle = setTimeout(this.timer1Expired, this.rto * 1000);\n  }\n\n  private timer1Expired = () => {\n    this.timer1Failures++;\n    this.timer1Handle = undefined;\n    if (this.timer1Failures > SCTP_MAX_INIT_RETRANS) {\n      this.setState(SCTP_STATE.CLOSED);\n    } else {\n      setImmediate(() => {\n        this.sendChunk(this.timer1Chunk!).catch((err: Error) => {\n          log(\"send timer1 chunk failed\", err.message);\n        });\n      });\n      this.timer1Handle = setTimeout(this.timer1Expired, this.rto * 1000);\n    }\n  };\n\n  private timer1Cancel() {\n    if (this.timer1Handle) {\n      clearTimeout(this.timer1Handle);\n      this.timer1Handle = undefined;\n      this.timer1Chunk = undefined;\n    }\n  }\n\n  /**t2 is wait for shutdown */\n  private t2Start(chunk: Chunk) {\n    if (this.timer2Handle) throw new Error();\n    this.timer2Chunk = chunk;\n    this.timer2Failures = 0;\n    this.timer2Handle = setTimeout(this.timer2Expired, this.rto * 1000);\n  }\n\n  private timer2Expired = () => {\n    this.timer2Failures++;\n    this.timer2Handle = undefined;\n    if (this.timer2Failures > SCTP_MAX_ASSOCIATION_RETRANS) {\n      this.setState(SCTP_STATE.CLOSED);\n    } else {\n      setImmediate(() => {\n        this.sendChunk(this.timer2Chunk!).catch((err: Error) => {\n          log(\"send timer2Chunk failed\", err.message);\n        });\n      });\n      this.timer2Handle = setTimeout(this.timer2Expired, this.rto * 1000);\n    }\n  };\n\n  private timer2Cancel() {\n    if (this.timer2Handle) {\n      clearTimeout(this.timer2Handle);\n      this.timer2Handle = undefined;\n      this.timer2Chunk = undefined;\n    }\n  }\n\n  /**t3 is wait for data sack */\n  private timer3Start() {\n    if (this.timer3Handle) throw new Error();\n    this.timer3Handle = setTimeout(this.timer3Expired, this.rto * 1000);\n  }\n\n  private timer3Restart() {\n    this.timer3Cancel();\n    // for performance\n    this.timer3Handle = setTimeout(this.timer3Expired, this.rto);\n  }\n\n  private timer3Expired = () => {\n    this.timer3Handle = undefined;\n\n    // # mark retransmit or abandoned chunks\n    this.sentQueue.forEach((chunk) => {\n      if (!this.maybeAbandon(chunk)) {\n        chunk.retransmit = true;\n      }\n    });\n    this.updateAdvancedPeerAckPoint();\n\n    // # adjust congestion window\n    this.fastRecoveryExit = undefined;\n    this.flightSize = 0;\n    this.partialBytesAcked = 0;\n\n    this.ssthresh = Math.max(\n      Math.floor(this.cwnd / 2),\n      4 * USERDATA_MAX_LENGTH,\n    );\n    this.cwnd = USERDATA_MAX_LENGTH;\n\n    this.transmit();\n  };\n\n  private timer3Cancel() {\n    if (this.timer3Handle) {\n      clearTimeout(this.timer3Handle);\n      this.timer3Handle = undefined;\n    }\n  }\n\n  /**Re-configuration Timer */\n  private timerReconfigHandleStart() {\n    if (this.timerReconfigHandle) return;\n    log(\"timerReconfigHandleStart\", { rto: this.rto });\n    this.timerReconfigFailures = 0;\n    this.timerReconfigHandle = setTimeout(\n      this.timerReconfigHandleExpired,\n      this.rto * 1000,\n    );\n  }\n\n  private timerReconfigHandleExpired = async () => {\n    this.timerReconfigFailures++;\n    // back off\n    this.rto = Math.ceil(this.rto * 1.5);\n\n    if (this.timerReconfigFailures > SCTP_MAX_ASSOCIATION_RETRANS) {\n      log(\"timerReconfigFailures\", this.timerReconfigFailures);\n      this.setState(SCTP_STATE.CLOSED);\n\n      this.timerReconfigHandle = undefined;\n    } else if (this.reconfigRequest) {\n      log(\"timerReconfigHandleExpired\", this.timerReconfigFailures, this.rto);\n      await this.sendReconfigParam(this.reconfigRequest);\n\n      this.timerReconfigHandle = setTimeout(\n        this.timerReconfigHandleExpired,\n        this.rto * 1000,\n      );\n    }\n  };\n\n  private timerReconfigCancel() {\n    if (this.timerReconfigHandle) {\n      log(\"timerReconfigCancel\");\n      clearTimeout(this.timerReconfigHandle);\n      this.timerReconfigHandle = undefined;\n      // Reset failures counter when timer is successfully cancelled\n      this.timerReconfigFailures = 0;\n    }\n  }\n\n  private updateAdvancedPeerAckPoint() {\n    if (uint32Gt(this.lastSackedTsn, this.advancedPeerAckTsn)) {\n      this.advancedPeerAckTsn = this.lastSackedTsn;\n    }\n\n    let done = 0;\n    const streams: { [key: number]: number } = {};\n    while (this.sentQueue.length > 0 && this.sentQueue[0].abandoned) {\n      const chunk = this.sentQueue.shift()!;\n      this.advancedPeerAckTsn = chunk.tsn;\n      done++;\n      if (!(chunk.flags & SCTP_DATA_UNORDERED)) {\n        streams[chunk.streamId] = chunk.streamSeqNum;\n      }\n    }\n    // Resetting the queue to empty array mitigates this.\n    if (!this.sentQueue.length) {\n      this.sentQueue = [];\n    }\n\n    if (done) {\n      this.forwardTsnChunk = new ForwardTsnChunk(0, undefined);\n      this.forwardTsnChunk.cumulativeTsn = this.advancedPeerAckTsn;\n      this.forwardTsnChunk.streams = Object.entries(streams).map(([k, v]) => [\n        Number(k),\n        v,\n      ]);\n    }\n  }\n\n  private maybeAbandon(chunk: DataChunk): boolean {\n    if (chunk.abandoned) return true;\n    const abandon =\n      (!!chunk.maxRetransmits && chunk.maxRetransmits < chunk.sentCount!) ||\n      (!!chunk.expiry && chunk.expiry < Date.now() / 1000);\n    if (!abandon) return false;\n\n    const chunkPos = this.sentQueue.findIndex((v) => v.type === chunk.type);\n    for (let pos = chunkPos; pos >= 0; pos--) {\n      const oChunk = this.sentQueue[pos];\n      oChunk.abandoned = true;\n      oChunk.retransmit = false;\n      if (oChunk.flags & SCTP_DATA_LAST_FRAG) {\n        break;\n      }\n    }\n\n    for (let pos = chunkPos; pos < this.sentQueue.length; pos++) {\n      const oChunk = this.sentQueue[pos];\n      oChunk.abandoned = true;\n      oChunk.retransmit = false;\n      if (oChunk.flags & SCTP_DATA_LAST_FRAG) {\n        break;\n      }\n    }\n\n    return true;\n  }\n\n  static getCapabilities() {\n    return new RTCSctpCapabilities(65536);\n  }\n\n  setRemotePort(port: number) {\n    this.remotePort = port;\n  }\n\n  async start(remotePort?: number) {\n    if (!this.started) {\n      this.started = true;\n      this.setConnectionState(\"connecting\");\n\n      if (remotePort) {\n        this.setRemotePort(remotePort);\n      }\n\n      if (!this.isServer) {\n        await this.init();\n      }\n    }\n  }\n\n  private async init() {\n    const init = new InitChunk();\n    init.initiateTag = this.localVerificationTag;\n    init.advertisedRwnd = this.advertisedRwnd;\n    init.outboundStreams = this._outboundStreamsCount;\n    init.inboundStreams = this._inboundStreamsMax;\n    init.initialTsn = this.localTsn;\n    this.setExtensions(init.params);\n    log(\"send init\", init);\n\n    try {\n      await this.sendChunk(init);\n\n      // # start T1 timer and enter COOKIE-WAIT state\n      this.timer1Start(init);\n      this.setState(SCTP_STATE.COOKIE_WAIT);\n    } catch (error: any) {\n      log(\"send init failed\", error.message);\n    }\n  }\n\n  private setExtensions(params: [number, Buffer][]) {\n    const extensions: number[] = [];\n    if (this.localPartialReliability) {\n      params.push([SCTP_PRSCTP_SUPPORTED, Buffer.from(\"\")]);\n      extensions.push(ForwardTsnChunk.type);\n    }\n\n    extensions.push(ReConfigChunk.type);\n    params.push([SCTP_SUPPORTED_CHUNK_EXT, Buffer.from(extensions)]);\n  }\n\n  async sendChunk(chunk: Chunk) {\n    if (this.state === \"closed\") return;\n    if (this.remotePort === undefined) {\n      throw new Error(\"invalid remote port\");\n    }\n\n    const packet = serializePacket(\n      this.localPort,\n      this.remotePort,\n      this.remoteVerificationTag,\n      chunk,\n    );\n    await this.transport.send(packet);\n  }\n\n  setState(state: SCTP_STATE) {\n    if (state != this.associationState) {\n      this.associationState = state;\n    }\n    if (state === SCTP_STATE.ESTABLISHED) {\n      this.setConnectionState(\"connected\");\n    } else if (state === SCTP_STATE.CLOSED) {\n      this.timer1Cancel();\n      this.timer2Cancel();\n      this.timer3Cancel();\n      this.timerReconfigCancel();\n      this.setConnectionState(\"closed\");\n      this.removeAllListeners();\n    }\n  }\n\n  setConnectionState(state: SCTPConnectionState) {\n    this.state = state;\n    log(\"setConnectionState\", state);\n    this.stateChanged[state].execute();\n  }\n\n  async stop() {\n    if (this.associationState !== SCTP_STATE.CLOSED) {\n      await this.abort();\n    }\n    this.setState(SCTP_STATE.CLOSED);\n    clearTimeout(this.timer1Handle);\n    clearTimeout(this.timer2Handle);\n    clearTimeout(this.timer3Handle);\n    clearTimeout(this.timerReconfigHandle);\n  }\n\n  async abort() {\n    const abort = new AbortChunk();\n    await this.sendChunk(abort).catch((err: Error) => {\n      log(\"send abort failed\", err.message);\n    });\n  }\n\n  private removeAllListeners() {\n    Object.values(this.stateChanged).forEach((v) => v.allUnsubscribe());\n  }\n}\n\nexport class InboundStream {\n  reassembly: DataChunk[] = [];\n  streamSequenceNumber = 0; // SSN\n\n  constructor() {}\n\n  addChunk(chunk: DataChunk) {\n    if (\n      this.reassembly.length === 0 ||\n      uint32Gt(chunk.tsn, this.reassembly[this.reassembly.length - 1].tsn)\n    ) {\n      this.reassembly.push(chunk);\n      return;\n    }\n\n    for (const [i, v] of enumerate(this.reassembly)) {\n      if (v.tsn === chunk.tsn) throw new Error(\"duplicate chunk in reassembly\");\n\n      if (uint32Gt(v.tsn, chunk.tsn)) {\n        this.reassembly.splice(i, 0, chunk);\n        break;\n      }\n    }\n  }\n\n  *popMessages(): Generator<[number, number, Buffer]> {\n    let pos = 0;\n    let startPos: number | undefined;\n    let expectedTsn: number;\n    let ordered: boolean | undefined;\n    while (pos < this.reassembly.length) {\n      const chunk = this.reassembly[pos];\n      if (startPos === undefined) {\n        ordered = !(chunk.flags & SCTP_DATA_UNORDERED);\n        if (!(chunk.flags & SCTP_DATA_FIRST_FRAG)) {\n          if (ordered) {\n            break;\n          } else {\n            pos++;\n            continue;\n          }\n        }\n        if (\n          ordered &&\n          uint16Gt(chunk.streamSeqNum, this.streamSequenceNumber)\n        ) {\n          break;\n        }\n        expectedTsn = chunk.tsn;\n        startPos = pos;\n      } else if (chunk.tsn !== expectedTsn!) {\n        if (ordered!) {\n          break;\n        } else {\n          startPos = undefined;\n          pos++;\n          continue;\n        }\n      }\n\n      if (chunk.flags & SCTP_DATA_LAST_FRAG) {\n        const arr = this.reassembly\n          .slice(startPos, pos + 1)\n          .map((c) => c.userData)\n          .reduce((acc, cur) => {\n            acc.push(cur);\n            acc.push(Buffer.from(\"\"));\n            return acc;\n          }, [] as Buffer[]);\n        arr.pop();\n        const userData = Buffer.concat(arr);\n\n        this.reassembly = [\n          ...this.reassembly.slice(0, startPos),\n          ...this.reassembly.slice(pos + 1),\n        ];\n        if (ordered && chunk.streamSeqNum === this.streamSequenceNumber) {\n          this.streamSequenceNumber = uint16Add(this.streamSequenceNumber, 1);\n        }\n        pos = startPos;\n        yield [chunk.streamId, chunk.protocol, userData];\n      } else {\n        pos++;\n      }\n      expectedTsn = tsnPlusOne(expectedTsn);\n    }\n  }\n\n  pruneChunks(tsn: number) {\n    // \"\"\"\n    // Prune chunks up to the given TSN.\n    // \"\"\"\n\n    let pos = -1,\n      size = 0;\n\n    for (const [i, chunk] of this.reassembly.entries()) {\n      if (uint32Gte(tsn, chunk.tsn)) {\n        pos = i;\n        size += chunk.userData.length;\n      } else {\n        break;\n      }\n    }\n\n    this.reassembly = this.reassembly.slice(pos + 1);\n    return size;\n  }\n}\n\nexport class RTCSctpCapabilities {\n  constructor(public maxMessageSize: number) {}\n}\n\nfunction tsnMinusOne(a: number) {\n  return (a - 1) % SCTP_TSN_MODULO;\n}\n\nfunction tsnPlusOne(a: number) {\n  return (a + 1) % SCTP_TSN_MODULO;\n}\n","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport type { CipherSuites } from \"../../../cipher/const\";\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type {\n  Extension,\n  Handshake,\n  Random,\n  Version,\n} from \"../../../typings/domain\";\nimport { ExtensionList, ProtocolVersion } from \"../../binary\";\nimport { HandshakeType } from \"../../const\";\nimport { DtlsRandom } from \"../../random\";\n\n// 7.4.1.3.  Server Hello\n\nexport class ServerHello implements Handshake {\n  msgType = HandshakeType.server_hello_2;\n  messageSeq?: number;\n  static readonly spec = {\n    serverVersion: ProtocolVersion,\n    random: DtlsRandom.spec,\n    sessionId: types.buffer(types.uint8),\n    cipherSuite: types.uint16be,\n    compressionMethod: types.uint8,\n  };\n\n  constructor(\n    public serverVersion: Version,\n    public random: Random,\n    public sessionId: Buffer,\n    public cipherSuite: CipherSuites,\n    public compressionMethod: number,\n    public extensions: Extension[],\n  ) {}\n\n  static createEmpty() {\n    return new ServerHello(\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n      undefined as any,\n    );\n  }\n\n  static deSerialize(buf: Buffer) {\n    const res = decode(buf, ServerHello.spec);\n    const cls = new ServerHello(\n      //@ts-ignore\n      ...Object.values(res),\n    );\n    const expect = cls.serialize();\n    if (expect.length < buf.length) {\n      return new ServerHello(\n        //@ts-ignore\n        ...Object.values(\n          decode(buf, { ...ServerHello.spec, extensions: ExtensionList }),\n        ),\n      );\n    }\n    return cls;\n  }\n\n  serialize() {\n    const res =\n      this.extensions === undefined\n        ? encode(this, ServerHello.spec).slice()\n        : encode(this, {\n            ...ServerHello.spec,\n            extensions: ExtensionList,\n          }).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","import { SrtcpContext } from \"./context/srtcp\";\nimport { type Config, Session } from \"./session\";\n\nexport class SrtcpSession extends Session<SrtcpContext> {\n  constructor(public config: Config) {\n    super(SrtcpContext);\n\n    this.start(\n      config.keys.localMasterKey,\n      config.keys.localMasterSalt,\n      config.keys.remoteMasterKey,\n      config.keys.remoteMasterSalt,\n      config.profile,\n    );\n  }\n\n  decrypt = (buf: Buffer) => {\n    const [decrypted] = this.remoteContext.decryptRTCP(buf);\n    return decrypted;\n  };\n\n  encrypt(rawRtcp: Buffer) {\n    const enc = this.localContext.encryptRTCP(rawRtcp);\n    return enc;\n  }\n}\n","import { randomUUID } from \"crypto\";\nimport { setTimeout } from \"timers/promises\";\nimport { Event, int } from \"../imports/common\";\n\nimport {\n  type Extensions,\n  PictureLossIndication,\n  RTP_EXTENSION_URI,\n  Red,\n  RedHandler,\n  type RtcpPacket,\n  RtcpPayloadSpecificFeedback,\n  RtcpReceiverInfo,\n  RtcpRrPacket,\n  RtcpSrPacket,\n  type RtpPacket,\n  type TransportWideCCPayload,\n  debug,\n  unwrapRtx,\n} from \"../imports/rtp\";\nimport type { PeerConfig } from \"../peerConnection\";\nimport type { RTCDtlsTransport } from \"../transport/dtls\";\nimport type { Kind } from \"../types/domain\";\nimport { compactNtp, timestampSeconds } from \"../utils\";\nimport type {\n  RTCRtpCodecParameters,\n  RTCRtpReceiveParameters,\n} from \"./parameters\";\nimport { NackHandler } from \"./receiver/nack\";\nimport { ReceiverTWCC } from \"./receiver/receiverTwcc\";\nimport { StreamStatistics } from \"./receiver/statistics\";\n\nimport { codecParametersFromString } from \"../sdp\";\nimport { usePLI, useTWCC } from \"./extension/rtcpFeedback\";\nimport {\n  type RTCInboundRtpStreamStats,\n  type RTCRemoteOutboundRtpStreamStats,\n  type RTCStats,\n  generateStatsId,\n  getStatsTimestamp,\n} from \"./stats\";\nimport { MediaStreamTrack } from \"./track\";\n\nconst log = debug(\"werift:packages/webrtc/src/media/rtpReceiver.ts\");\n\nexport class RTCRtpReceiver {\n  private readonly codecs: { [pt: number]: RTCRtpCodecParameters } = {};\n  private get codecArray() {\n    return Object.values(this.codecs).sort(\n      (a, b) => a.payloadType - b.payloadType,\n    );\n  }\n  private readonly ssrcByRtx: { [rtxSsrc: number]: number } = {};\n  private readonly nack = new NackHandler(this);\n  private readonly audioRedHandler = new RedHandler();\n\n  readonly type = \"receiver\";\n  readonly uuid = randomUUID().toString();\n  readonly tracks: MediaStreamTrack[] = [];\n  readonly trackBySSRC: { [ssrc: string]: MediaStreamTrack } = {};\n  readonly trackByRID: { [rid: string]: MediaStreamTrack } = {};\n  /**last sender Report Timestamp\n   * compactNtp\n   */\n  readonly lastSRtimestamp: { [ssrc: number]: number } = {};\n  /**seconds */\n  readonly receiveLastSRTimestamp: { [ssrc: number]: number } = {};\n  readonly onPacketLost = this.nack.onPacketLost;\n  readonly onRtcp = new Event<[RtcpPacket]>();\n\n  dtlsTransport!: RTCDtlsTransport;\n  sdesMid?: string;\n  latestRid?: string;\n  latestRepairedRid?: string;\n\n  receiverTWCC?: ReceiverTWCC;\n  stopped = false;\n  remoteStreamId?: string;\n  remoteTrackId?: string;\n\n  rtcpRunning = false;\n  private rtcpCancel = new AbortController();\n  private remoteStreams: { [ssrc: number]: StreamStatistics } = {};\n\n  constructor(\n    readonly config: PeerConfig,\n    public kind: Kind,\n    public rtcpSsrc: number,\n  ) {}\n\n  setDtlsTransport(dtls: RTCDtlsTransport) {\n    this.dtlsTransport = dtls;\n  }\n\n  // todo fix\n  get track() {\n    return this.tracks[0] ?? new MediaStreamTrack({ kind: this.kind });\n  }\n\n  get nackEnabled() {\n    return this.codecArray[0]?.rtcpFeedback.find((f) => f.type === \"nack\");\n  }\n\n  get twccEnabled() {\n    return this.codecArray[0]?.rtcpFeedback.find(\n      (f) => f.type === useTWCC().type,\n    );\n  }\n\n  get pliEnabled() {\n    return this.codecArray[0]?.rtcpFeedback.find(\n      (f) => f.type === usePLI().type,\n    );\n  }\n\n  prepareReceive(params: RTCRtpReceiveParameters) {\n    params.codecs.forEach((c) => {\n      this.codecs[c.payloadType] = c;\n    });\n    params.encodings.forEach((e) => {\n      if (e.rtx) {\n        this.ssrcByRtx[e.rtx.ssrc] = e.ssrc;\n      }\n    });\n  }\n\n  /**\n   * setup TWCC if supported\n   */\n  setupTWCC(mediaSourceSsrc: number) {\n    if (this.twccEnabled && !this.receiverTWCC) {\n      this.receiverTWCC = new ReceiverTWCC(\n        this.dtlsTransport,\n        this.rtcpSsrc,\n        mediaSourceSsrc,\n      );\n    }\n  }\n\n  addTrack(track: MediaStreamTrack) {\n    const exist = this.tracks.find((t) => {\n      if (t.rid) {\n        return t.rid === track.rid;\n      }\n      if (t.ssrc) {\n        return t.ssrc === track.ssrc;\n      }\n    });\n    if (exist) {\n      return false;\n    }\n    this.tracks.push(track);\n    if (track.ssrc) {\n      this.trackBySSRC[track.ssrc] = track;\n    }\n    if (track.rid) {\n      this.trackByRID[track.rid] = track;\n    }\n    return true;\n  }\n\n  stop() {\n    this.stopped = true;\n    this.rtcpRunning = false;\n    this.rtcpCancel.abort();\n\n    if (this.receiverTWCC) this.receiverTWCC.twccRunning = false;\n    this.nack.close();\n  }\n\n  async runRtcp() {\n    if (this.rtcpRunning || this.stopped) return;\n    this.rtcpRunning = true;\n\n    try {\n      while (this.rtcpRunning) {\n        await setTimeout(500 + Math.random() * 1000, undefined, {\n          signal: this.rtcpCancel.signal,\n        });\n\n        const reports = Object.entries(this.remoteStreams).map(\n          ([ssrc, stream]) => {\n            let lastSRtimestamp = 0,\n              delaySinceLastSR = 0;\n            if (this.lastSRtimestamp[ssrc]) {\n              lastSRtimestamp = this.lastSRtimestamp[ssrc];\n              const delaySeconds =\n                timestampSeconds() - this.receiveLastSRTimestamp[ssrc];\n              if (delaySeconds > 0 && delaySeconds < 65536) {\n                delaySinceLastSR = int(delaySeconds * 65536);\n              }\n            }\n\n            return new RtcpReceiverInfo({\n              ssrc: Number(ssrc),\n              fractionLost: stream.fraction_lost,\n              packetsLost: stream.packets_lost,\n              highestSequence: stream.max_seq,\n              jitter: stream.jitter,\n              lsr: lastSRtimestamp,\n              dlsr: delaySinceLastSR,\n            });\n          },\n        );\n\n        const packet = new RtcpRrPacket({ ssrc: this.rtcpSsrc, reports });\n\n        try {\n          if (this.config.debug.receiverReportDelay) {\n            await setTimeout(this.config.debug.receiverReportDelay);\n          }\n          await this.dtlsTransport.sendRtcp([packet]);\n        } catch (error) {\n          log(\"sendRtcp failed\", error);\n          await setTimeout(500 + Math.random() * 1000);\n        }\n      }\n    } catch (error) {}\n  }\n\n  async getStats(): Promise<RTCStats[]> {\n    const timestamp = getStatsTimestamp();\n    const stats: RTCStats[] = [];\n\n    if (!this.dtlsTransport) {\n      return stats;\n    }\n\n    const transportId = generateStatsId(\"transport\", this.dtlsTransport.id);\n\n    // Collect stats for each track\n    for (const track of this.tracks) {\n      if (!track.ssrc) continue;\n\n      const streamStats = this.remoteStreams[track.ssrc];\n      if (!streamStats) continue;\n\n      // Inbound RTP stats\n      const inboundRtpStats: RTCInboundRtpStreamStats = {\n        type: \"inbound-rtp\",\n        id: generateStatsId(\"inbound-rtp\", track.ssrc),\n        timestamp,\n        ssrc: track.ssrc,\n        kind: this.kind,\n        transportId,\n        codecId: this.codecs[0]\n          ? generateStatsId(\"codec\", this.codecs[0].payloadType, transportId)\n          : undefined,\n        mid: this.sdesMid,\n        trackIdentifier: track.id,\n        packetsReceived: streamStats.packets_received,\n        packetsLost: streamStats.packets_lost,\n        jitter: streamStats.jitter,\n      };\n      stats.push(inboundRtpStats);\n\n      // Remote outbound RTP stats (if we have SR info)\n      if (this.lastSRtimestamp[track.ssrc]) {\n        const remoteOutboundStats: RTCRemoteOutboundRtpStreamStats = {\n          type: \"remote-outbound-rtp\",\n          id: generateStatsId(\"remote-outbound-rtp\", track.ssrc),\n          timestamp,\n          ssrc: track.ssrc,\n          kind: this.kind,\n          transportId,\n          codecId: inboundRtpStats.codecId,\n          localId: inboundRtpStats.id,\n          remoteTimestamp: this.receiveLastSRTimestamp[track.ssrc] * 1000, // Convert to ms\n        };\n        stats.push(remoteOutboundStats);\n      }\n    }\n\n    return stats;\n  }\n\n  async sendRtcpPLI(mediaSsrc: number) {\n    if (!this.pliEnabled) {\n      log(\"pli not supported\", { mediaSsrc });\n      return;\n    }\n\n    if (this.stopped) {\n      return;\n    }\n\n    log(\"sendRtcpPLI\", { mediaSsrc });\n\n    const packet = new RtcpPayloadSpecificFeedback({\n      feedback: new PictureLossIndication({\n        senderSsrc: this.rtcpSsrc,\n        mediaSsrc,\n      }),\n    });\n    try {\n      await this.dtlsTransport.sendRtcp([packet]);\n    } catch (error) {\n      log(error);\n    }\n  }\n\n  handleRtcpPacket(packet: RtcpPacket) {\n    switch (packet.type) {\n      case RtcpSrPacket.type:\n        {\n          const sr = packet as RtcpSrPacket;\n          this.lastSRtimestamp[sr.ssrc] = compactNtp(\n            sr.senderInfo.ntpTimestamp,\n          );\n          this.receiveLastSRTimestamp[sr.ssrc] = timestampSeconds();\n\n          const track = this.trackBySSRC[packet.ssrc];\n          if (track) {\n            track.onReceiveRtcp.execute(packet);\n          }\n        }\n        break;\n    }\n    this.onRtcp.execute(packet);\n  }\n\n  handleRtpBySsrc = (packet: RtpPacket, extensions: Extensions) => {\n    const track = this.trackBySSRC[packet.header.ssrc];\n\n    this.handleRTP(packet, extensions, track);\n  };\n\n  handleRtpByRid = (packet: RtpPacket, rid: string, extensions: Extensions) => {\n    const track = this.trackByRID[rid];\n    if (!this.trackBySSRC[packet.header.ssrc]) {\n      this.trackBySSRC[packet.header.ssrc] = track;\n    }\n\n    this.handleRTP(packet, extensions, track);\n  };\n\n  private handleRTP(\n    packet: RtpPacket,\n    extensions: Extensions,\n    track?: MediaStreamTrack,\n  ) {\n    if (this.stopped) {\n      return;\n    }\n\n    const codec = this.codecs[packet.header.payloadType];\n    if (!codec) {\n      // log(\"unknown codec \" + packet.header.payloadType);\n      return;\n    }\n\n    this.remoteStreams[packet.header.ssrc] =\n      this.remoteStreams[packet.header.ssrc] ??\n      new StreamStatistics(codec.clockRate);\n    this.remoteStreams[packet.header.ssrc].add(packet);\n\n    if (this.receiverTWCC) {\n      const transportSequenceNumber = extensions[\n        RTP_EXTENSION_URI.transportWideCC\n      ] as TransportWideCCPayload;\n\n      if (!transportSequenceNumber == undefined) {\n        throw new Error(\"undefined\");\n      }\n\n      this.receiverTWCC.handleTWCC(transportSequenceNumber);\n    } else if (this.twccEnabled) {\n      this.setupTWCC(packet.header.ssrc);\n    }\n\n    if (codec.name.toLowerCase() === \"rtx\") {\n      const originalSsrc = this.ssrcByRtx[packet.header.ssrc];\n      const codecParams = codecParametersFromString(codec.parameters ?? \"\");\n      const rtxCodec = this.codecs[codecParams[\"apt\"]];\n      if (packet.payload.length < 2) return;\n\n      packet = unwrapRtx(packet, rtxCodec.payloadType, originalSsrc);\n      track = this.trackBySSRC[originalSsrc];\n    }\n\n    let red: Red | undefined;\n    if (codec.name.toLowerCase() === \"red\") {\n      red = Red.deSerialize(packet.payload);\n      if (\n        !Object.keys(this.codecs).includes(\n          red.header.fields[0].blockPT.toString(),\n        )\n      ) {\n        return;\n      }\n    }\n\n    if (track?.kind === \"video\" && this.nackEnabled) {\n      this.nack.addPacket(packet);\n    }\n\n    if (track) {\n      if (red) {\n        if (track.kind === \"audio\") {\n          const payloads = this.audioRedHandler.push(red, packet);\n          for (const packet of payloads) {\n            track.onReceiveRtp.execute(packet.clone(), extensions);\n          }\n        } else {\n        }\n      } else {\n        track.onReceiveRtp.execute(packet.clone(), extensions);\n      }\n    }\n\n    this.runRtcp();\n  }\n}\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/asn1\n//\n// **License:** MIT\nconst util_1 = require(\"util\");\nconst common_1 = require(\"./common\");\n/**\n * ASN.1 classes.\n */\nvar Class;\n(function (Class) {\n    Class[Class[\"UNIVERSAL\"] = 0] = \"UNIVERSAL\";\n    Class[Class[\"APPLICATION\"] = 64] = \"APPLICATION\";\n    Class[Class[\"CONTEXT_SPECIFIC\"] = 128] = \"CONTEXT_SPECIFIC\";\n    Class[Class[\"PRIVATE\"] = 192] = \"PRIVATE\";\n})(Class = exports.Class || (exports.Class = {}));\n/**\n * ASN.1 types. Not all types are supported by this implementation.\n */\nvar Tag;\n(function (Tag) {\n    Tag[Tag[\"NONE\"] = 0] = \"NONE\";\n    Tag[Tag[\"BOOLEAN\"] = 1] = \"BOOLEAN\";\n    Tag[Tag[\"INTEGER\"] = 2] = \"INTEGER\";\n    Tag[Tag[\"BITSTRING\"] = 3] = \"BITSTRING\";\n    Tag[Tag[\"OCTETSTRING\"] = 4] = \"OCTETSTRING\";\n    Tag[Tag[\"NULL\"] = 5] = \"NULL\";\n    Tag[Tag[\"OID\"] = 6] = \"OID\";\n    // ODESC = 7,\n    // EXTERNAL = 8,\n    // REAL = 9,\n    Tag[Tag[\"ENUMERATED\"] = 10] = \"ENUMERATED\";\n    // EMBEDDED = 11,\n    Tag[Tag[\"UTF8\"] = 12] = \"UTF8\";\n    // ROID = 13,\n    Tag[Tag[\"SEQUENCE\"] = 16] = \"SEQUENCE\";\n    Tag[Tag[\"SET\"] = 17] = \"SET\";\n    Tag[Tag[\"NUMERICSTRING\"] = 18] = \"NUMERICSTRING\";\n    Tag[Tag[\"PRINTABLESTRING\"] = 19] = \"PRINTABLESTRING\";\n    Tag[Tag[\"T61STRING\"] = 20] = \"T61STRING\";\n    Tag[Tag[\"IA5STRING\"] = 22] = \"IA5STRING\";\n    Tag[Tag[\"UTCTIME\"] = 23] = \"UTCTIME\";\n    Tag[Tag[\"GENERALIZEDTIME\"] = 24] = \"GENERALIZEDTIME\";\n    Tag[Tag[\"GENERALSTRING\"] = 27] = \"GENERALSTRING\";\n})(Tag = exports.Tag || (exports.Tag = {}));\n/**\n * BitString is the structure to use when you want an ASN.1 BIT STRING type. A\n * bit string is padded up to the nearest byte in memory and the number of\n * valid bits is recorded. Padding bits will be zero.\n */\nclass BitString {\n    constructor(buf, bitLen) {\n        this.buf = buf;\n        this.bitLen = bitLen;\n    }\n    /**\n     * Returns the value for the given bits offset.\n     * @param i bits offet\n     */\n    at(i) {\n        if (i < 0 || i >= this.bitLen || !Number.isInteger(i)) {\n            return 0;\n        }\n        const x = Math.floor(i / 8);\n        const y = 7 - i % 8;\n        return (this.buf[x] >> y) & 1;\n    }\n    /**\n     * Align buffer\n     */\n    rightAlign() {\n        const shift = 8 - (this.bitLen % 8);\n        if (shift === 8 || this.buf.length === 0) {\n            return this.buf;\n        }\n        const buf = Buffer.alloc(this.buf.length);\n        buf[0] = this.buf[0] >> shift;\n        for (let i = 1; i < this.buf.length; i++) {\n            buf[i] = this.buf[i - 1] << (8 - shift);\n            buf[i] |= this.buf[i] >> shift;\n        }\n        return buf;\n    }\n}\nexports.BitString = BitString;\n/**\n * Implements parsing of DER-encoded ASN.1 data structures,\n * as defined in ITU-T Rec X.690.\n *\n * See also ``A Layman's Guide to a Subset of ASN.1, BER, and DER,''\n * http://luca.ntop.org/Teaching/Appunti/asn1.html.\n *\n * ASN.1 is a syntax for specifying abstract objects and BER, DER, PER, XER etc\n * are different encoding formats for those objects. Here, we'll be dealing\n * with DER, the Distinguished Encoding Rules. DER is used in X.509 because\n * it's fast to parse and, unlike BER, has a unique encoding for every object.\n * When calculating hashes over objects, it's important that the resulting\n * bytes be the same at both ends and DER removes this margin of error.\n * ASN.1 is very complex and this package doesn't attempt to implement\n * everything by any means.\n *\n * DER Encoding of ASN.1 Types:\n * https://msdn.microsoft.com/en-us/library/windows/desktop/bb540792(v=vs.85).aspx\n */\nclass ASN1 {\n    /**\n     * Creates a Tag.BOOLEAN ASN.1 object.\n     * @param val boolean value.\n     */\n    static Bool(val) {\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.BOOLEAN, Buffer.from([val ? 0xff : 0x0]));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.BOOLEAN value from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseBool(buf) {\n        if (!(buf instanceof Buffer) || buf.length !== 1) {\n            throw new Error('ASN1 syntax error: invalid boolean');\n        }\n        switch (buf[0]) {\n            case 0:\n                return false;\n            case 0xff:\n                return true;\n            default:\n                throw new Error('ASN1 syntax error: invalid boolean');\n        }\n    }\n    /**\n     * Creates a Tag.INTEGER ASN.1 object.\n     * @param val integer value or buffer.\n     */\n    static Integer(val) {\n        if (val instanceof Buffer) {\n            const asn = new ASN1(Class.UNIVERSAL, Tag.INTEGER, val);\n            asn._value = val.toString('hex');\n            return asn;\n        }\n        if (!Number.isSafeInteger(val)) {\n            throw new Error('ASN1 syntax error: invalid integer');\n        }\n        let buf;\n        if (val >= -0x80 && val < 0x80) {\n            buf = Buffer.alloc(1);\n            buf.writeInt8(val, 0);\n        }\n        else if (val >= -0x8000 && val < 0x8000) {\n            buf = Buffer.alloc(2);\n            buf.writeIntBE(val, 0, 2);\n        }\n        else if (val >= -0x800000 && val < 0x800000) {\n            buf = Buffer.alloc(3);\n            buf.writeIntBE(val, 0, 3);\n        }\n        else if (val >= -0x80000000 && val < 0x80000000) {\n            buf = Buffer.alloc(4);\n            buf.writeIntBE(val, 0, 4);\n        }\n        else if (val >= -0x8000000000 && val < 0x8000000000) {\n            buf = Buffer.alloc(5);\n            buf.writeIntBE(val, 0, 5);\n        }\n        else if (val >= -0x800000000000 && val < 0x800000000000) {\n            buf = Buffer.alloc(6);\n            buf.writeIntBE(val, 0, 6);\n        }\n        else {\n            throw new Error('ASN1 syntax error: invalid Integer');\n        }\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.INTEGER, buf);\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.INTEGER value from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseInteger(buf) {\n        if (!(buf instanceof Buffer) || buf.length === 0) {\n            throw new Error('ASN1 syntax error: invalid Integer');\n        }\n        // some INTEGER (BigInt) will be 16 bytes, 32 bytes or others.\n        // CertificateSerialNumber ::= INTEGER (>= 16 bytes)\n        if (buf.length > 6) {\n            return buf.toString('hex');\n        }\n        return buf.readIntBE(0, buf.length);\n    }\n    /**\n     * Parse a Tag.INTEGER value as a number from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseIntegerNum(buf) {\n        const value = ASN1.parseInteger(buf);\n        if (typeof value !== 'number') {\n            throw new Error('ASN1 syntax error: invalid Integer number');\n        }\n        return value;\n    }\n    /**\n     * Parse a Tag.INTEGER value as a hex string(for BigInt) from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseIntegerStr(buf) {\n        const value = ASN1.parseInteger(buf);\n        if (typeof value === 'number') {\n            return value.toString(16);\n        }\n        return value;\n    }\n    /**\n     * Creates a Tag.BITSTRING ASN.1 object.\n     * @param val BitString object or buffer.\n     */\n    static BitString(val) {\n        if (val instanceof Buffer) {\n            val = new BitString(val, val.length * 8);\n        }\n        const paddingBits = val.buf.length * 8 - val.bitLen;\n        const buf = Buffer.alloc(val.buf.length + 1);\n        buf.writeInt8(paddingBits, 0);\n        val.buf.copy(buf, 1);\n        return new ASN1(Class.UNIVERSAL, Tag.BITSTRING, buf);\n    }\n    /**\n     * Parse a Tag.BITSTRING value from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseBitString(buf) {\n        if (!(buf instanceof Buffer) || buf.length === 0) {\n            throw new Error('ASN1 syntax error: invalid BitString');\n        }\n        const paddingBits = buf[0];\n        if (paddingBits > 7 ||\n            buf.length === 1 && paddingBits > 0 ||\n            (buf[buf.length - 1] & ((1 << buf[0]) - 1)) !== 0) {\n            throw new Error('ASN1 syntax error: invalid padding bits in BIT STRING');\n        }\n        return new BitString(buf.slice(1), (buf.length - 1) * 8 - paddingBits);\n    }\n    /**\n     * Creates a Tag.NULL ASN.1 object.\n     */\n    static Null() {\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.NULL, Buffer.alloc(0));\n        asn1._value = null;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.NULL value from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseNull(buf) {\n        if (!(buf instanceof Buffer) || buf.length !== 0) {\n            throw new Error('ASN1 syntax error: invalid null');\n        }\n        return null;\n    }\n    /**\n     * Creates an Tag.OID (dot-separated numeric string) ASN.1 object.\n     * @param val dot-separated numeric string.\n     */\n    static OID(val) {\n        const values = val.split('.');\n        if (values.length === 0) {\n            throw new Error('ASN1 syntax error: invalid Object Identifier');\n        }\n        const bytes = [];\n        // first byte is 40 * value1 + value2\n        bytes.push(40 * mustParseInt(values[0]) + mustParseInt(values[1]));\n        // other bytes are each value in base 128 with 8th bit set except for\n        // the last byte for each value\n        const valueBytes = [];\n        for (let i = 2; i < values.length; ++i) {\n            let value = mustParseInt(values[i]);\n            valueBytes.length = 0;\n            valueBytes.push(value & 0x7f);\n            while (value > 0x7f) {\n                value = value >>> 7;\n                valueBytes.unshift((value & 0x7f) | 0x80); // add value bytes in reverse for big endian\n            }\n            bytes.push(...valueBytes);\n        }\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.OID, Buffer.from(bytes));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.OID value from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseOID(buf) {\n        if (!(buf instanceof Buffer) || buf.length === 0) {\n            throw new Error('ASN1 syntax error: invalid OID');\n        }\n        // first byte is 40 * value1 + value2\n        let oid = Math.floor(buf[0] / 40) + '.' + (buf[0] % 40);\n        // other bytes are each value in base 128 with 8th bit set except for\n        // the last byte for each value\n        let high = 0;\n        for (let i = 1; i < buf.length; i++) {\n            // not the last byte for the value\n            if (buf[i] >= 0x80) {\n                high += buf[i] & 0x7F;\n                high = high << 7;\n            }\n            else {\n                oid += '.' + (high + buf[i]);\n                high = 0;\n            }\n        }\n        return oid;\n    }\n    /**\n     * Creates an Tag.UTF8 ASN.1 object.\n     * @param val utf8 string.\n     */\n    static UTF8(val) {\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.UTF8, Buffer.from(val, 'utf8'));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.UTF8 string from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseUTF8(buf) {\n        if (!(buf instanceof Buffer)) {\n            throw new Error('parse ASN1 error: invalid Buffer');\n        }\n        return buf.toString('utf8');\n    }\n    /**\n     * Creates an Tag.NUMERICSTRING ASN.1 object.\n     * @param val numeric string.\n     */\n    static NumericString(val) {\n        if (!isNumericString(val)) {\n            throw new Error('ASN1 syntax error: invalid NumericString');\n        }\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.NUMERICSTRING, Buffer.from(val, 'utf8'));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.UTF8 string from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseNumericString(buf) {\n        if (!(buf instanceof Buffer)) {\n            throw new Error('parse ASN1 error: invalid Buffer');\n        }\n        const str = buf.toString('utf8');\n        if (!isNumericString(str)) {\n            throw new Error('ASN1 syntax error: invalid NumericString');\n        }\n        return str;\n    }\n    /**\n     * Creates an Tag.NUMERICSTRING ASN.1 object.\n     * @param val printable string.\n     */\n    static PrintableString(val) {\n        // TODO, validate\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.PRINTABLESTRING, Buffer.from(val, 'utf8'));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.PRINTABLESTRING string from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parsePrintableString(buf) {\n        if (!(buf instanceof Buffer)) {\n            throw new Error('parse ASN1 error: invalid Buffer');\n        }\n        // TODO, validate\n        return buf.toString('utf8');\n    }\n    /**\n     * Creates an Tag.IA5STRING (ASCII string) ASN.1 object.\n     * @param val ASCII string.\n     */\n    static IA5String(val) {\n        if (!isIA5String(val)) {\n            throw new Error('ASN1 syntax error: invalid IA5String');\n        }\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.IA5STRING, Buffer.from(val, 'utf8'));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.IA5STRING string from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseIA5String(buf) {\n        if (!(buf instanceof Buffer)) {\n            throw new Error('parse ASN1 error: invalid Buffer');\n        }\n        const str = buf.toString('utf8');\n        if (!isIA5String(str)) {\n            throw new Error('ASN1 syntax error: invalid IA5String');\n        }\n        return str;\n    }\n    /**\n     * Creates an Tag.T61STRING (8-bit clean string) ASN.1 object.\n     * @param val 8-bit clean string.\n     */\n    static T61String(val) {\n        // TODO, validate\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.T61STRING, Buffer.from(val, 'utf8'));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.T61STRING string from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseT61String(buf) {\n        if (!(buf instanceof Buffer)) {\n            throw new Error('parse ASN1 error: invalid Buffer');\n        }\n        // TODO, validate\n        return buf.toString('utf8');\n    }\n    /**\n     * Creates an Tag.GENERALSTRING (specified in ISO-2022/ECMA-35) ASN.1 object.\n     * @param val general string.\n     */\n    static GeneralString(val) {\n        // TODO, validate\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.GENERALSTRING, Buffer.from(val, 'utf8'));\n        asn1._value = val;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.GENERALSTRING string from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseGeneralString(buf) {\n        if (!(buf instanceof Buffer)) {\n            throw new Error('parse ASN1 error: invalid Buffer');\n        }\n        // TODO, validate\n        return buf.toString('utf8');\n    }\n    /**\n     * Creates an Tag.UTCTIME ASN.1 object.\n     *\n     * Note: GeneralizedTime has 4 digits for the year and is used for X.509.\n     * dates past 2049. Converting to a GeneralizedTime hasn't been implemented yet.\n     * @param date date value.\n     */\n    static UTCTime(date) {\n        let rval = '';\n        // create format YYMMDDhhmmssZ\n        const format = [];\n        format.push(('' + date.getUTCFullYear()).substr(2));\n        format.push('' + (date.getUTCMonth() + 1));\n        format.push('' + date.getUTCDate());\n        format.push('' + date.getUTCHours());\n        format.push('' + date.getUTCMinutes());\n        format.push('' + date.getUTCSeconds());\n        // ensure 2 digits are used for each format entry\n        for (const s of format) {\n            if (s.length < 2) {\n                rval += '0';\n            }\n            rval += s;\n        }\n        rval += 'Z';\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.UTCTIME, Buffer.from(rval, 'utf8'));\n        asn1._value = date;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.UTCTIME date from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseUTCTime(buf) {\n        if (!(buf instanceof Buffer) || buf.length === 0) {\n            throw new Error('ASN1 syntax error: invalid UTC Time');\n        }\n        const utc = buf.toString('utf8');\n        /* The following formats can be used:\n    \n          YYMMDDhhmmZ\n          YYMMDDhhmm+hh'mm'\n          YYMMDDhhmm-hh'mm'\n          YYMMDDhhmmssZ\n          YYMMDDhhmmss+hh'mm'\n          YYMMDDhhmmss-hh'mm'\n    \n          Where:\n    \n          YY is the least significant two digits of the year\n          MM is the month (01 to 12)\n          DD is the day (01 to 31)\n          hh is the hour (00 to 23)\n          mm are the minutes (00 to 59)\n          ss are the seconds (00 to 59)\n          Z indicates that local time is GMT, + indicates that local time is\n          later than GMT, and - indicates that local time is earlier than GMT\n          hh' is the absolute value of the offset from GMT in hours\n          mm' is the absolute value of the offset from GMT in minutes */\n        const date = new Date();\n        // if YY >= 50 use 19xx, if YY < 50 use 20xx\n        let year = mustParseInt(utc.substr(0, 2));\n        year = (year >= 50) ? 1900 + year : 2000 + year;\n        const MM = mustParseInt(utc.substr(2, 2)) - 1; // use 0-11 for month\n        const DD = mustParseInt(utc.substr(4, 2));\n        const hh = mustParseInt(utc.substr(6, 2));\n        const mm = mustParseInt(utc.substr(8, 2));\n        let ss = 0;\n        let end = 0;\n        // get character after minutes\n        let c = '';\n        // not just YYMMDDhhmmZ\n        if (utc.length > 11) {\n            end = 10;\n            // get character after minutes\n            c = utc.charAt(end);\n            // see if seconds are present\n            if (c !== '+' && c !== '-') {\n                // get seconds\n                ss = mustParseInt(utc.substr(10, 2));\n                end += 2;\n            }\n        }\n        // update date\n        date.setUTCFullYear(year, MM, DD);\n        date.setUTCHours(hh, mm, ss, 0);\n        if (end > 0) {\n            // get +/- after end of time\n            c = utc.charAt(end);\n            if (c === '+' || c === '-') {\n                // get hours+minutes offset\n                const hhoffset = mustParseInt(utc.substr(end + 1, 2));\n                const mmoffset = mustParseInt(utc.substr(end + 4, 2));\n                // calculate offset in milliseconds\n                let offset = hhoffset * 60 + mmoffset;\n                offset *= 60000;\n                // apply offset\n                if (c === '+') {\n                    date.setTime(+date - offset);\n                }\n                else {\n                    date.setTime(+date + offset);\n                }\n            }\n        }\n        return date;\n    }\n    /**\n     * Creates an Tag.GENERALIZEDTIME ASN.1 object.\n     * @param date date value.\n     */\n    static GeneralizedTime(date) {\n        let rval = '';\n        // create format YYYYMMDDHHMMSSZ\n        const format = [];\n        format.push('' + date.getUTCFullYear());\n        format.push('' + (date.getUTCMonth() + 1));\n        format.push('' + date.getUTCDate());\n        format.push('' + date.getUTCHours());\n        format.push('' + date.getUTCMinutes());\n        format.push('' + date.getUTCSeconds());\n        // ensure 2 digits are used for each format entry\n        for (const s of format) {\n            if (s.length < 2) {\n                rval += '0';\n            }\n            rval += s;\n        }\n        rval += 'Z';\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.GENERALIZEDTIME, Buffer.from(rval, 'utf8'));\n        asn1._value = date;\n        return asn1;\n    }\n    /**\n     * Parse a Tag.GENERALIZEDTIME date from ASN.1 object' value.\n     * @param buf the buffer to parse.\n     */\n    static parseGeneralizedTime(buf) {\n        if (!(buf instanceof Buffer) || buf.length === 0) {\n            throw new Error('ASN1 syntax error: invalid Generalized Time');\n        }\n        const gentime = buf.toString('utf8');\n        /* The following formats can be used:\n    \n          YYYYMMDDHHMMSS\n          YYYYMMDDHHMMSS.fff\n          YYYYMMDDHHMMSSZ\n          YYYYMMDDHHMMSS.fffZ\n          YYYYMMDDHHMMSS+hh'mm'\n          YYYYMMDDHHMMSS.fff+hh'mm'\n          YYYYMMDDHHMMSS-hh'mm'\n          YYYYMMDDHHMMSS.fff-hh'mm'\n    \n          Where:\n    \n          YYYY is the year\n          MM is the month (01 to 12)\n          DD is the day (01 to 31)\n          hh is the hour (00 to 23)\n          mm are the minutes (00 to 59)\n          ss are the seconds (00 to 59)\n          .fff is the second fraction, accurate to three decimal places\n          Z indicates that local time is GMT, + indicates that local time is\n          later than GMT, and - indicates that local time is earlier than GMT\n          hh' is the absolute value of the offset from GMT in hours\n          mm' is the absolute value of the offset from GMT in minutes */\n        const date = new Date();\n        const YYYY = mustParseInt(gentime.substr(0, 4));\n        const MM = mustParseInt(gentime.substr(4, 2)) - 1; // use 0-11 for month\n        const DD = mustParseInt(gentime.substr(6, 2));\n        const hh = mustParseInt(gentime.substr(8, 2));\n        const mm = mustParseInt(gentime.substr(10, 2));\n        const ss = mustParseInt(gentime.substr(12, 2));\n        let fff = 0;\n        let offset = 0;\n        let isUTC = false;\n        if (gentime.charAt(gentime.length - 1) === 'Z') {\n            isUTC = true;\n        }\n        const end = gentime.length - 5;\n        const c = gentime.charAt(end);\n        if (c === '+' || c === '-') {\n            // get hours+minutes offset\n            const hhoffset = mustParseInt(gentime.substr(end + 1, 2));\n            const mmoffset = mustParseInt(gentime.substr(end + 4, 2));\n            // calculate offset in milliseconds\n            offset = hhoffset * 60 + mmoffset;\n            offset *= 60000;\n            // apply offset\n            if (c === '+') {\n                offset *= -1;\n            }\n            isUTC = true;\n        }\n        // check for second fraction\n        if (gentime.charAt(14) === '.') {\n            fff = parseFloat(gentime.substr(14)) * 1000;\n        }\n        if (isUTC) {\n            date.setUTCFullYear(YYYY, MM, DD);\n            date.setUTCHours(hh, mm, ss, fff);\n            // apply offset\n            date.setTime(+date + offset);\n        }\n        else {\n            date.setFullYear(YYYY, MM, DD);\n            date.setHours(hh, mm, ss, fff);\n        }\n        return date;\n    }\n    /**\n     * Parse a Tag.UTCTIME date of Tag.GENERALIZEDTIME date from ASN.1 object' value.\n     * @param tag the type.\n     * @param buf the buffer to parse.\n     */\n    static parseTime(tag, buf) {\n        switch (tag) {\n            case Tag.UTCTIME:\n                return ASN1.parseUTCTime(buf);\n            case Tag.GENERALIZEDTIME:\n                return ASN1.parseGeneralizedTime(buf);\n            default:\n                throw new Error('Invalid ASN1 time tag');\n        }\n    }\n    /**\n     * Creates an Tag.SET ASN.1 object.\n     * @param objs an array of ASN.1 objects.\n     */\n    static Set(objs) {\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.SET, Buffer.concat(objs.map((obj) => obj.toDER())));\n        asn1._value = objs;\n        return asn1;\n    }\n    /**\n     * Creates an Tag.SEQUENCE ASN.1 object.\n     * @param objs an array of ASN.1 objects.\n     */\n    static Seq(objs) {\n        const asn1 = new ASN1(Class.UNIVERSAL, Tag.SEQUENCE, Buffer.concat(objs.map((obj) => obj.toDER())));\n        asn1._value = objs;\n        return asn1;\n    }\n    /**\n     * Creates an Class.CONTEXT_SPECIFIC ASN.1 object.\n     *\n     * Note: the tag means nothing with Class.CONTEXT_SPECIFIC\n     * @param tag number.\n     * @param objs an array of ASN.1 objects or a ASN.1 object.\n     * @param isCompound when objs is a array, the isCompound will be set to true.\n     */\n    static Spec(tag, objs, isCompound = true) {\n        const bytes = Array.isArray(objs) ? Buffer.concat(objs.map((obj) => obj.toDER())) : objs.toDER();\n        if (Array.isArray(objs)) {\n            isCompound = true;\n        }\n        const asn1 = new ASN1(Class.CONTEXT_SPECIFIC, tag, bytes, isCompound);\n        asn1._value = objs;\n        return asn1;\n    }\n    /**\n     * Parse a ASN.1 object from a buffer in DER format.\n     *\n     * @param buf the buffer to parse.\n     * @param deepParse deeply parse or not.\n     */\n    static fromDER(buf, deepParse = false) {\n        return ASN1._fromDER(new common_1.BufferVisitor(buf), deepParse);\n    }\n    /**\n     * Parse a ASN.1 object from a buffer in DER format with given class and tag.\n     * If class or tag is not match, it will throw a error.\n     *\n     * @param tagClass expect class to parse.\n     * @param tag expect type to parse.\n     * @param buf the buffer to parse.\n     */\n    static parseDER(buf, tagClass, tag) {\n        const obj = ASN1._fromDER(new common_1.BufferVisitor(buf), false);\n        if (obj.class !== tagClass && obj.tag !== tag) {\n            throw new Error(`invalid ASN.1 DER for class ${tagClass} and tag ${tag}`);\n        }\n        return obj;\n    }\n    /**\n     * Parse a ASN.1 object from a buffer in DER format with given Template object.\n     * If template is not match, it will throw a error.\n     *\n     * @param buf the buffer to parse.\n     * @param tpl expect template to parse.\n     *\n     * @return a Captures object with captured ASN.1 objects\n     */\n    static parseDERWithTemplate(buf, tpl) {\n        const obj = ASN1._fromDER(new common_1.BufferVisitor(buf), true);\n        const captures = {};\n        const err = obj.validate(tpl, captures);\n        if (err != null) {\n            err.data = obj;\n            throw err;\n        }\n        return captures;\n    }\n    static _parseCompound(buf, deepParse) {\n        const values = [];\n        const len = buf.length;\n        const bufv = new common_1.BufferVisitor(buf);\n        let readByteLen = 0;\n        while (readByteLen < len) {\n            const start = bufv.end;\n            values.push(ASN1._fromDER(bufv, deepParse));\n            readByteLen += bufv.end - start;\n        }\n        return values;\n    }\n    // Internal function to parse an asn1 object from a byte buffer in DER format.\n    static _fromDER(bufv, deepParse) {\n        if (!(bufv.buf instanceof Buffer) || bufv.length === 0) {\n            throw new Error('ASN1 syntax error: invalid Generalized Time');\n        }\n        bufv.mustWalk(1, 'Too few bytes to read ASN.1 tag.');\n        const start = bufv.start;\n        const b1 = bufv.buf[start];\n        const tagClass = b1 & 0xc0;\n        const tag = b1 & 0x1f;\n        // value storage\n        const valueLen = getValueLength(bufv);\n        bufv.mustHas(valueLen);\n        if (valueLen !== 0 && tag === Tag.NULL) {\n            throw new Error('invalid value length or NULL tag.');\n        }\n        bufv.mustWalk(valueLen);\n        const isCompound = ((b1 & 0x20) === 0x20);\n        const asn1 = new ASN1(tagClass, tag, bufv.buf.slice(bufv.start, bufv.end), isCompound);\n        if (isCompound && deepParse) {\n            asn1._value = ASN1._parseCompound(asn1.bytes, deepParse);\n        }\n        asn1._der = bufv.buf.slice(start, bufv.end);\n        return asn1;\n    }\n    constructor(tagClass, tag, data, isCompound = false) {\n        this.class = tagClass;\n        this.tag = tag;\n        this.bytes = data;\n        // CONTEXT_SPECIFIC, SEQUENCE, SET, others...\n        this.isCompound = isCompound || tag === Tag.SEQUENCE || tag === Tag.SET;\n        this._value = undefined;\n        this._der = null;\n    }\n    /**\n     * the well parsed value of this ASN.1 object.\n     * It will be boolean, number, string, BitString, Date, array of ASN.1 objects and so on.\n     */\n    get value() {\n        if (this._value === undefined) {\n            this._value = this.valueOf();\n        }\n        return this._value;\n    }\n    /**\n     * the DER format Buffer of this ASN.1 object.\n     */\n    get DER() {\n        if (this._der == null) {\n            this._der = this.toDER();\n        }\n        return this._der;\n    }\n    /**\n     * Expecting it is compound ASN.1 object and returns an array of sub ASN.1 objects.\n     * @param msg error message to throw when it is not compound ASN.1 object.\n     */\n    mustCompound(msg = 'asn1 object value is not compound') {\n        if (!this.isCompound || !Array.isArray(this.value)) {\n            const err = new Error(msg);\n            err.data = this.toJSON();\n            throw err;\n        }\n        return this.value;\n    }\n    /**\n     * Returns true if two ASN.1 objects equally.\n     * @param obj another ASN.1 object.\n     */\n    equals(obj) {\n        if (!(obj instanceof ASN1)) {\n            return false;\n        }\n        if (this.class !== obj.class || this.tag !== obj.tag || this.isCompound !== obj.isCompound) {\n            return false;\n        }\n        if (!this.bytes.equals(obj.bytes)) {\n            return false;\n        }\n        return true;\n    }\n    /**\n     * Converts this ASN.1 object to a buffer of bytes in DER format.\n     */\n    toDER() {\n        // build the first byte\n        let b1 = this.class | this.tag;\n        if (this.isCompound) {\n            b1 |= 0x20;\n        }\n        const valueLenBytes = getValueLengthByte(this.bytes.length);\n        const buf = Buffer.allocUnsafe(2 + valueLenBytes + this.bytes.length);\n        buf.writeInt8(b1, 0);\n        if (valueLenBytes === 0) {\n            buf.writeUInt8(this.bytes.length, 1);\n            this.bytes.copy(buf, 2);\n        }\n        else {\n            buf.writeUInt8(valueLenBytes | 0x80, 1);\n            buf.writeUIntBE(this.bytes.length, 2, valueLenBytes);\n            this.bytes.copy(buf, 2 + valueLenBytes);\n        }\n        return buf;\n    }\n    /**\n     * Parse the value of this ASN.1 object when it is Class.UNIVERSAL.\n     * The value will be boolean, number, string, BitString, Date, array of ASN.1 objects and so on.\n     */\n    valueOf() {\n        if (this.isCompound) {\n            return ASN1._parseCompound(this.bytes, false);\n        }\n        if (this.class !== Class.UNIVERSAL) {\n            return this.bytes;\n        }\n        switch (this.tag) {\n            case Tag.BOOLEAN:\n                return ASN1.parseBool(this.bytes);\n            case Tag.INTEGER:\n                return ASN1.parseInteger(this.bytes);\n            case Tag.BITSTRING:\n                return ASN1.parseBitString(this.bytes);\n            case Tag.NULL:\n                return ASN1.parseNull(this.bytes);\n            case Tag.OID:\n                return ASN1.parseOID(this.bytes);\n            case Tag.UTF8:\n                return ASN1.parseUTF8(this.bytes);\n            case Tag.NUMERICSTRING:\n                return ASN1.parseNumericString(this.bytes);\n            case Tag.PRINTABLESTRING:\n                return ASN1.parsePrintableString(this.bytes);\n            case Tag.T61STRING:\n                return ASN1.parseT61String(this.bytes);\n            case Tag.IA5STRING:\n                return ASN1.parseIA5String(this.bytes);\n            case Tag.GENERALSTRING:\n                return ASN1.parseGeneralString(this.bytes);\n            case Tag.UTCTIME:\n                return ASN1.parseUTCTime(this.bytes);\n            case Tag.GENERALIZEDTIME:\n                return ASN1.parseGeneralizedTime(this.bytes);\n            default:\n                return this.bytes;\n        }\n    }\n    /**\n     * Validates that the given ASN.1 object is at least a super set of the\n     * given ASN.1 structure. Only tag classes and types are checked. An\n     * optional map may also be provided to capture ASN.1 values while the\n     * structure is checked.\n     *\n     * To capture an ASN.1 object, set an object in the validator's 'capture'\n     * parameter to the key to use in the capture map.\n     *\n     * Objects in the validator may set a field 'optional' to true to indicate\n     * that it isn't necessary to pass validation.\n     *\n     * @param tpl Template object to validate.\n     * @param captures Captures object to capture ASN.1 object.\n     */\n    validate(tpl, captures = {}) {\n        if (this.class !== tpl.class) {\n            return new Error(`ASN.1 object validate failure for ${tpl.name} : error class ${Class[this.class]}`);\n        }\n        const tplTags = Array.isArray(tpl.tag) ? tpl.tag : [tpl.tag];\n        if (!tplTags.includes(this.tag)) {\n            return new Error(`ASN.1 object validate failure for ${tpl.name}: error tag ${Tag[this.tag]}`);\n        }\n        if (tpl.capture != null) {\n            captures[tpl.capture] = this;\n        }\n        if (Array.isArray(tpl.value)) {\n            const values = this.mustCompound(`${tpl.name} need compound ASN1 value`);\n            for (let i = 0, j = 0; i < tpl.value.length; i++) {\n                if (values[j] != null) {\n                    const err = values[j].validate(tpl.value[i], captures);\n                    if (err == null) {\n                        j++;\n                    }\n                    else if (tpl.value[i].optional !== true) {\n                        return err;\n                    }\n                }\n                else if (tpl.value[i].optional !== true) {\n                    return new Error(`ASN.1 object validate failure for ${tpl.value[i].name}: not exists`);\n                }\n            }\n        }\n        else if (tpl.value != null) {\n            const buf = this.tag === Tag.BITSTRING ? this.bytes.slice(1) : this.bytes;\n            return ASN1.fromDER(buf).validate(tpl.value, captures);\n        }\n        return null;\n    }\n    /**\n     * Return a friendly JSON object for debuging.\n     */\n    toJSON() {\n        let value = this.value;\n        if (Array.isArray(value)) {\n            value = value.map((val) => val.toJSON());\n        }\n        return {\n            class: Class[this.class],\n            tag: this.class === Class.UNIVERSAL ? Tag[this.tag] : this.tag,\n            value,\n        };\n    }\n    [util_1.inspect.custom](_depth, options) {\n        if (options.depth <= 2) {\n            options.depth = 10;\n        }\n        return `<${this.constructor.name} ${util_1.inspect(this.toJSON(), options)}>`;\n    }\n}\nexports.ASN1 = ASN1;\n// Gets the length of a BER-encoded ASN.1 value.\nfunction getValueLength(bufv) {\n    bufv.mustWalk(1, 'Too few bytes to read ASN.1 value length.');\n    const byte = bufv.buf[bufv.start];\n    // see if the length is \"short form\" or \"long form\" (bit 8 set)\n    if ((byte & 0x80) === 0) {\n        // if byte is 0, means asn1 object of indefinite length\n        return byte;\n    }\n    const byteLen = byte & 0x7f;\n    bufv.mustWalk(byteLen, 'Too few bytes to read ASN.1 value length.');\n    return bufv.buf.readUIntBE(bufv.start, byteLen);\n}\n// Gets the length of a BER-encoded ASN.1 value length's bytes\nfunction getValueLengthByte(valueLen) {\n    if (valueLen <= 127) {\n        return 0;\n    }\n    else if (valueLen <= 0xff) {\n        return 1;\n    }\n    else if (valueLen <= 0xffff) {\n        return 2;\n    }\n    else if (valueLen <= 0xffffff) {\n        return 3;\n    }\n    else if (valueLen <= 0xffffffff) {\n        return 4;\n    }\n    else if (valueLen <= 0xffffffffff) {\n        return 5;\n    }\n    else if (valueLen <= 0xffffffffffff) {\n        return 6;\n    }\n    else {\n        throw new Error('invalid value length');\n    }\n}\nfunction isNumericString(str) {\n    for (const s of str) {\n        const n = s.charCodeAt(0);\n        if (n !== 32 && (n < 48 || n > 57)) { // '0' to '9', and ' '\n            return false;\n        }\n    }\n    return true;\n}\nfunction isIA5String(str) {\n    for (const s of str) {\n        if (s.charCodeAt(0) >= 0x80) {\n            return false;\n        }\n    }\n    return true;\n}\nfunction mustParseInt(str, radix = 10) {\n    const val = parseInt(str, radix);\n    if (Number.isNaN(val)) {\n        throw new Error(`Invalid numeric string \"${str}\" in radix ${radix}.`);\n    }\n    return val;\n}\n//# sourceMappingURL=asn1.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LEB128 = exports.SignedLEB128 = exports.UnsignedLEB128 = void 0;\nvar Mask;\n(function (Mask) {\n    Mask[Mask[\"LOWER_7\"] = 127] = \"LOWER_7\";\n    Mask[Mask[\"UPPER_1\"] = 128] = \"UPPER_1\";\n})(Mask || (Mask = {}));\n/**\n * Check if a given value is a safe integer\n * @param a Value to check\n */\nconst int = (a) => Number.isSafeInteger(a);\n/**\n * Class to work with unsigned LEB128 integers.\n * See [this Wikipedia article](https://en.wikipedia.org/wiki/LEB128#Encoding_format).\n */\nclass UnsignedLEB128 {\n    /**\n     * Decode a Uint8Array into a number.\n     * @param buf Uint8Array containing the representation in LEB128\n     * @param offset Offset to read from\n     */\n    static decode(buf, offset = 0) {\n        const mp = this.$scanForNullBytes(buf, offset);\n        let result = 0, shift = 0;\n        for (let d = 0; d <= mp - offset; d++) {\n            const a = buf[offset + d] & Mask.LOWER_7; /* masking, we only care about lower 7 bits */\n            result |= a << shift; /* shift this value left and add it */\n            shift += (8 - 1);\n        }\n        return result;\n    }\n    /**\n     * Create a LEB128 Uint8Array from a number\n     * @param number Number to convert from\n     */\n    static encode(number) {\n        this.check(number);\n        if (number < 0)\n            throw new Error(`An unsigned number must NOT be negative, ${number} is!`);\n        let out = [], a = number;\n        do {\n            let byte = a & Mask.LOWER_7;\n            // we only care about lower 7 bits\n            a >>= (8 - 1);\n            // shift\n            if (a)\n                byte = byte | Mask.UPPER_1; /* if remaining is truthy (!= 0), set highest bit */\n            out.push(byte);\n        } while (a);\n        return Uint8Array.from(out);\n    }\n    static check(n) {\n        if (!int(n))\n            throw new Error(`${n} is not a safe integer!`);\n    }\n    /**\n     * Return the offset that the byte at which ends the stream\n     * @param buf Uint8Array to scan\n     * @param offset Offset to start scanning\n     * @throws If no byte starting with 0 as the highest bit set\n     */\n    static $scanForNullBytes(buf, offset = 0) {\n        let count = offset, tmp = 0;\n        do {\n            if (count >= buf.byteLength)\n                throw new Error('This is not a LEB128-encoded Uint8Array, no ending found!');\n            tmp = buf.slice(count, count + 1)[0];\n            count++;\n        } while (tmp & Mask.UPPER_1);\n        return count - 1;\n    }\n    /**\n     * Return the relative index that the byte at which ends the stream.\n     *\n     * @example\n     * ```js\n     * getLength(Uint8Array.from([0b1000000, 0b00000000]), 1) // 0\n     * getLength(Uint8Array.from([0b1000000, 0b00000000]), 0) // 1\n     * ```\n     * @param buf Uint8Array to scan\n     * @param offset Offset to start scanning\n     */\n    static getLength(buf, offset = 0) {\n        return this.$scanForNullBytes(buf, offset) - offset;\n    }\n}\nexports.UnsignedLEB128 = UnsignedLEB128;\nclass SignedLEB128 {\n    static $ceil7mul(n) {\n        let a = n;\n        while (a % 7)\n            a++;\n        return a;\n    }\n    static check(n) {\n        if (!int(n))\n            throw new Error(`${n} is not a safe integer!`);\n    }\n    /**\n     * Create a LEB128 Uint8Array from a number\n     * @param number Number to convert from. Must be less than 0.\n     */\n    static encode(number) {\n        this.check(number);\n        if (number >= 0)\n            throw new Error(`A signed number must be negative, ${number} isn't!`);\n        const bitCount = Math.ceil(Math.log2(-number));\n        return UnsignedLEB128.encode((1 << this.$ceil7mul(bitCount)) + number);\n    }\n    /**\n     * Decode a Uint8Array into a (signed) number.\n     * @param buf Uint8Array containing the representation in LEB128\n     * @param offset Offset to read from\n     */\n    static decode(buf, offset = 0) {\n        const r = UnsignedLEB128.decode(buf, offset);\n        const bitCount = Math.ceil(Math.log2(r));\n        const mask = (1 << bitCount);\n        return -(mask - r);\n    }\n}\nexports.SignedLEB128 = SignedLEB128;\nclass LEB128 {\n}\nexports.LEB128 = LEB128;\n/**\n * Create a LEB128 Uint8Array from a number\n * @param number Number to convert from.\n */\nLEB128.encode = (n) => (n >= 0 ? UnsignedLEB128 : SignedLEB128).encode(n);\n/**\n * Decode a Uint8Array into a (signed) number.\n * @param buf Uint8Array containing the representation in LEB128\n * @param offset Offset to read from\n * @param s Whether the output number is negative\n */\nLEB128.decode = (buf, offset = 0, s = false) => (s ? SignedLEB128 : UnsignedLEB128).decode(buf, offset);\n","module.exports = require(\"net\");","const signTypes = {\n  NULL: 0,\n  ECDHE: 1,\n};\n\nconst keyTypes = {\n  NULL: 0,\n  RSA: 1,\n  ECDSA: 2,\n  PSK: 3,\n};\n\nconst kxTypes = {\n  NULL: 0,\n  RSA: 1,\n  ECDHE_RSA: 2,\n  ECDHE_ECDSA: 3,\n  PSK: 4,\n  ECDHE_PSK: 5,\n};\n\n/**\n * This class represent type of key exchange mechanism.\n */\nexport class KeyExchange {\n  id = 0;\n  name?: string;\n  signType?: number;\n  keyType?: number;\n\n  /**\n   * @returns {string}\n   */\n  toString() {\n    return this.name;\n  }\n}\n\n/**\n * Creates `RSA` key exchange.\n * @returns {KeyExchange}\n */\nexport function createRSAKeyExchange() {\n  const exchange = new KeyExchange();\n\n  exchange.id = kxTypes.RSA;\n  exchange.name = \"RSA\";\n\n  exchange.keyType = keyTypes.RSA;\n\n  return exchange;\n}\n\n/**\n * Creates `ECDHE_RSA` key exchange.\n * @returns {KeyExchange}\n */\nexport function createECDHERSAKeyExchange() {\n  const exchange = new KeyExchange();\n\n  exchange.id = kxTypes.ECDHE_RSA;\n  exchange.name = \"ECDHE_RSA\";\n\n  exchange.signType = signTypes.ECDHE;\n  exchange.keyType = keyTypes.RSA;\n\n  return exchange;\n}\n\n/**\n * Creates `ECDHE_ECDSA` key exchange.\n * @returns {KeyExchange}\n */\nexport function createECDHEECDSAKeyExchange() {\n  const exchange = new KeyExchange();\n\n  exchange.id = kxTypes.ECDHE_ECDSA;\n  exchange.name = \"ECDHE_ECDSA\";\n\n  exchange.signType = signTypes.ECDHE;\n  exchange.keyType = keyTypes.ECDSA;\n\n  return exchange;\n}\n\n/**\n * Creates `NULL` key exchange.\n * @returns {KeyExchange}\n */\nexport function createNULLKeyExchange() {\n  const exchange = new KeyExchange();\n\n  exchange.id = kxTypes.NULL;\n  exchange.name = \"NULL\";\n\n  exchange.signType = signTypes.NULL;\n  exchange.keyType = keyTypes.NULL;\n\n  return exchange;\n}\n\n/**\n * Creates `PSK` key exchange.\n * @returns {KeyExchange}\n */\nexport function createPSKKeyExchange() {\n  const exchange = new KeyExchange();\n\n  exchange.id = kxTypes.PSK;\n  exchange.name = \"PSK\";\n\n  exchange.signType = signTypes.NULL;\n  exchange.keyType = keyTypes.PSK;\n\n  return exchange;\n}\n\n/**\n * Creates `ECDHE_PSK` key exchange.\n * @returns {KeyExchange}\n */\nexport function createECDHEPSKKeyExchange() {\n  const exchange = new KeyExchange();\n\n  exchange.id = kxTypes.ECDHE_PSK;\n  exchange.name = \"ECDHE_PSK\";\n\n  exchange.signType = signTypes.ECDHE;\n  exchange.keyType = keyTypes.PSK;\n\n  return exchange;\n}\n","import type { CipherGCMTypes } from \"crypto\";\nimport type { KeyExchange } from \"../key-exchange\";\n\nexport type CipherHeader = {\n  type: number;\n  version: number;\n  epoch: number;\n  sequenceNumber: number;\n};\n\nexport const SessionType = {\n  CLIENT: 1,\n  SERVER: 2,\n} as const;\nexport type SessionTypes = (typeof SessionType)[keyof typeof SessionType];\n\nexport default abstract class AbstractCipher {\n  id = 0;\n  name?: string;\n  hashAlgorithm?: string;\n  verifyDataLength = 12;\n\n  blockAlgorithm?: CipherGCMTypes;\n  kx?: KeyExchange;\n\n  /**\n   * Init cipher.\n   * @abstract\n   */\n  init(...args: any) {\n    throw new Error(\"not implemented\");\n  }\n\n  /**\n   * Encrypts data.\n   * @abstract\n   */\n  encrypt(...args: any): Buffer {\n    throw new Error(\"not implemented\");\n  }\n\n  /**\n   * Decrypts data.\n   * @abstract\n   */\n  decrypt(...args: any): Buffer {\n    throw new Error(\"not implemented\");\n  }\n\n  /**\n   * @returns {string}\n   */\n  toString() {\n    return this.name;\n  }\n}\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/x509\n//\n// **License:** MIT\nconst net_1 = require(\"net\");\n/**\n * Converts IP string into buffer, 4 bytes for IPv4, and 16 bytes for IPv6.\n * It will return null when IP string invalid.\n *\n * ```js\n * console.log(bytesFromIP('::1')) // <Buffer 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 01>\n * ```\n * @param ip IP string to convert\n */\nfunction bytesFromIP(ip) {\n    switch (net_1.isIP(ip)) {\n        case 4:\n            return Buffer.from(ip.split('.').map((val) => parseInt(val, 10)));\n        case 6:\n            const vals = ip.split(':');\n            const buf = Buffer.alloc(16);\n            let offset = 0;\n            if (vals[vals.length - 1] === '') {\n                vals[vals.length - 1] = '0';\n            }\n            for (let i = 0; i < vals.length; i++) {\n                if (vals[i] === '') {\n                    if (i + 1 < vals.length && vals[i + 1] !== '') {\n                        // reset offset for non-zero values\n                        offset = 16 - (vals.length - i - 1) * 2;\n                    }\n                    // skip zero bytes\n                    continue;\n                }\n                buf.writeUInt16BE(parseInt(vals[i], 16), offset);\n                offset += 2;\n            }\n            return buf;\n        default:\n            return null;\n    }\n}\nexports.bytesFromIP = bytesFromIP;\n/**\n * Converts 4-bytes into an IPv4 string representation or 16-bytes into\n * an IPv6 string representation. The bytes must be in network order.\n *\n * ```js\n * console.log(bytesToIP(Buffer.from([0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1]))) // '::1'\n * ```\n * @param bytes buffer to convert\n */\nfunction bytesToIP(bytes) {\n    switch (bytes.length) {\n        case 4:\n            return [bytes[0], bytes[1], bytes[2], bytes[3]].join('.');\n        case 16:\n            const ip = [];\n            let zeroAt = -1;\n            let zeroLen = 0;\n            let maxAt = -1;\n            let maxLen = 0;\n            for (let i = 0; i < bytes.length; i += 2) {\n                const hex = (bytes[i] << 8) | bytes[i + 1];\n                if (hex === 0) {\n                    zeroLen++;\n                    if (zeroAt === -1) {\n                        zeroAt = ip.length;\n                    }\n                    if (zeroLen > maxLen) {\n                        maxLen = zeroLen;\n                        maxAt = zeroAt;\n                    }\n                }\n                else {\n                    zeroAt = -1;\n                    zeroLen = 0;\n                }\n                ip.push(hex.toString(16));\n            }\n            if (maxLen > 0) {\n                let padding = '';\n                const rest = ip.slice(maxAt + maxLen);\n                ip.length = maxAt;\n                if (ip.length === 0) {\n                    padding += ':';\n                }\n                if (rest.length === 0) {\n                    padding += ':';\n                }\n                ip.push(padding, ...rest);\n            }\n            return ip.join(':');\n        default:\n            return '';\n    }\n}\nexports.bytesToIP = bytesToIP;\nconst oids = Object.create(null);\nconst oidReg = /^[0-9.]+$/;\n/**\n * Returns Object Identifier (dot-separated numeric string) that registered by initOID function.\n * It will return empty string if not exists.\n * @param nameOrId OID name or OID\n */\nfunction getOID(nameOrId) {\n    if (oidReg.test(nameOrId) && oids[nameOrId] !== '') {\n        return nameOrId;\n    }\n    return oids[nameOrId] == null ? '' : oids[nameOrId];\n}\nexports.getOID = getOID;\n/**\n * Returns Object Identifier name that registered by initOID function.\n * It will return the argument nameOrId if not exists.\n * @param nameOrId OID name or OID\n */\nfunction getOIDName(nameOrId) {\n    if (!oidReg.test(nameOrId) && oids[nameOrId] !== '') {\n        return nameOrId;\n    }\n    return oids[nameOrId] == null ? nameOrId : oids[nameOrId];\n}\nexports.getOIDName = getOIDName;\n/**\n * Register OID and name\n * @param oid Object Identifier\n * @param name Object Identifier name\n */\nfunction initOID(oid, name) {\n    oids[oid] = name;\n    oids[name] = oid;\n}\n// algorithm OIDs\ninitOID('1.2.840.113549.1.1.1', 'rsaEncryption');\ninitOID('1.2.840.113549.1.1.4', 'md5WithRsaEncryption');\ninitOID('1.2.840.113549.1.1.5', 'sha1WithRsaEncryption');\ninitOID('1.2.840.113549.1.1.8', 'mgf1');\ninitOID('1.2.840.113549.1.1.10', 'RSASSA-PSS');\ninitOID('1.2.840.113549.1.1.11', 'sha256WithRsaEncryption');\ninitOID('1.2.840.113549.1.1.12', 'sha384WithRsaEncryption');\ninitOID('1.2.840.113549.1.1.13', 'sha512WithRsaEncryption');\ninitOID('1.2.840.10045.2.1', 'ecEncryption'); // ECDSA and ECDH Public Key\ninitOID('1.2.840.10045.4.1', 'ecdsaWithSha1');\ninitOID('1.2.840.10045.4.3.2', 'ecdsaWithSha256');\ninitOID('1.2.840.10045.4.3.3', 'ecdsaWithSha384');\ninitOID('1.2.840.10045.4.3.4', 'ecdsaWithSha512');\ninitOID('1.2.840.10040.4.3', 'dsaWithSha1');\ninitOID('2.16.840.1.101.3.4.3.2', 'dsaWithSha256');\ninitOID('1.3.14.3.2.7', 'desCBC');\ninitOID('1.3.14.3.2.26', 'sha1');\ninitOID('2.16.840.1.101.3.4.2.1', 'sha256');\ninitOID('2.16.840.1.101.3.4.2.2', 'sha384');\ninitOID('2.16.840.1.101.3.4.2.3', 'sha512');\ninitOID('1.2.840.113549.2.5', 'md5');\n// Algorithm Identifiers for Ed25519, Ed448, X25519 and X448 for use in the Internet X.509 Public Key Infrastructure\n// https://tools.ietf.org/html/draft-ietf-curdle-pkix-10\ninitOID('1.3.101.110', 'X25519');\ninitOID('1.3.101.111', 'X448');\ninitOID('1.3.101.112', 'Ed25519');\ninitOID('1.3.101.113', 'Ed448');\n// pkcs#7 content types\ninitOID('1.2.840.113549.1.7.1', 'data');\ninitOID('1.2.840.113549.1.7.2', 'signedData');\ninitOID('1.2.840.113549.1.7.3', 'envelopedData');\ninitOID('1.2.840.113549.1.7.4', 'signedAndEnvelopedData');\ninitOID('1.2.840.113549.1.7.5', 'digestedData');\ninitOID('1.2.840.113549.1.7.6', 'encryptedData');\n// pkcs#9 oids\ninitOID('1.2.840.113549.1.9.1', 'emailAddress');\ninitOID('1.2.840.113549.1.9.2', 'unstructuredName');\ninitOID('1.2.840.113549.1.9.3', 'contentType');\ninitOID('1.2.840.113549.1.9.4', 'messageDigest');\ninitOID('1.2.840.113549.1.9.5', 'signingTime');\ninitOID('1.2.840.113549.1.9.6', 'counterSignature');\ninitOID('1.2.840.113549.1.9.7', 'challengePassword');\ninitOID('1.2.840.113549.1.9.8', 'unstructuredAddress');\ninitOID('1.2.840.113549.1.9.14', 'extensionRequest');\ninitOID('1.2.840.113549.1.9.20', 'friendlyName');\ninitOID('1.2.840.113549.1.9.21', 'localKeyId');\ninitOID('1.2.840.113549.1.9.22.1', 'x509Certificate');\n// pkcs#12 safe bags\ninitOID('1.2.840.113549.1.12.10.1.1', 'keyBag');\ninitOID('1.2.840.113549.1.12.10.1.2', 'pkcs8ShroudedKeyBag');\ninitOID('1.2.840.113549.1.12.10.1.3', 'certBag');\ninitOID('1.2.840.113549.1.12.10.1.4', 'crlBag');\ninitOID('1.2.840.113549.1.12.10.1.5', 'secretBag');\ninitOID('1.2.840.113549.1.12.10.1.6', 'safeContentsBag');\n// password-based-encryption for pkcs#12\ninitOID('1.2.840.113549.1.5.13', 'pkcs5PBES2');\ninitOID('1.2.840.113549.1.5.12', 'pkcs5PBKDF2');\n// hmac OIDs\ninitOID('1.2.840.113549.2.7', 'hmacWithSha1');\ninitOID('1.2.840.113549.2.9', 'hmacWithSha256');\ninitOID('1.2.840.113549.2.10', 'hmacWithSha384');\ninitOID('1.2.840.113549.2.11', 'hmacWithSha512');\n// symmetric key algorithm oids\ninitOID('1.2.840.113549.3.7', '3desCBC');\ninitOID('2.16.840.1.101.3.4.1.2', 'aesCBC128');\ninitOID('2.16.840.1.101.3.4.1.42', 'aesCBC256');\n// certificate issuer/subject OIDs\ninitOID('2.5.4.3', 'commonName');\ninitOID('2.5.4.5', 'serialName');\ninitOID('2.5.4.6', 'countryName');\ninitOID('2.5.4.7', 'localityName');\ninitOID('2.5.4.8', 'stateOrProvinceName');\ninitOID('2.5.4.10', 'organizationName');\ninitOID('2.5.4.11', 'organizationalUnitName');\ninitOID('2.5.4.15', 'businessCategory');\n// X.509 extension OIDs\ninitOID('2.16.840.1.113730.1.1', 'nsCertType');\ninitOID('2.5.29.2', 'keyAttributes'); // obsolete, use .37 or .15\ninitOID('2.5.29.4', 'keyUsageRestriction'); // obsolete, use .37 or .15\ninitOID('2.5.29.6', 'subtreesConstraint'); // obsolete, use .30\ninitOID('2.5.29.9', 'subjectDirectoryAttributes');\ninitOID('2.5.29.14', 'subjectKeyIdentifier');\ninitOID('2.5.29.15', 'keyUsage');\ninitOID('2.5.29.16', 'privateKeyUsagePeriod');\ninitOID('2.5.29.17', 'subjectAltName');\ninitOID('2.5.29.18', 'issuerAltName');\ninitOID('2.5.29.19', 'basicConstraints');\ninitOID('2.5.29.20', 'cRLNumber');\ninitOID('2.5.29.21', 'cRLReason');\ninitOID('2.5.29.22', 'expirationDate');\ninitOID('2.5.29.23', 'instructionCode');\ninitOID('2.5.29.24', 'invalidityDate');\ninitOID('2.5.29.27', 'deltaCRLIndicator');\ninitOID('2.5.29.28', 'issuingDistributionPoint');\ninitOID('2.5.29.29', 'certificateIssuer');\ninitOID('2.5.29.30', 'nameConstraints');\ninitOID('2.5.29.31', 'cRLDistributionPoints');\ninitOID('2.5.29.32', 'certificatePolicies');\ninitOID('2.5.29.33', 'policyMappings');\ninitOID('2.5.29.35', 'authorityKeyIdentifier');\ninitOID('2.5.29.36', 'policyConstraints');\ninitOID('2.5.29.37', 'extKeyUsage');\ninitOID('2.5.29.46', 'freshestCRL');\ninitOID('2.5.29.54', 'inhibitAnyPolicy');\n// extKeyUsage purposes\ninitOID('1.3.6.1.4.1.311.60.2.1.2', 'jurisdictionST');\ninitOID('1.3.6.1.4.1.311.60.2.1.3', 'jurisdictionC');\ninitOID('1.3.6.1.4.1.11129.2.4.2', 'timestampList');\ninitOID('1.3.6.1.5.5.7.1.1', 'authorityInfoAccess');\ninitOID('1.3.6.1.5.5.7.3.1', 'serverAuth');\ninitOID('1.3.6.1.5.5.7.3.2', 'clientAuth');\ninitOID('1.3.6.1.5.5.7.3.3', 'codeSigning');\ninitOID('1.3.6.1.5.5.7.3.4', 'emailProtection');\ninitOID('1.3.6.1.5.5.7.3.8', 'timeStamping');\ninitOID('1.3.6.1.5.5.7.48.1', 'authorityInfoAccessOcsp');\ninitOID('1.3.6.1.5.5.7.48.2', 'authorityInfoAccessIssuers');\n//# sourceMappingURL=common.js.map","import type { RtpPacket } from \"@koush/werift-src/packages/rtp/src/rtp/rtp\";\n\n// https://datatracker.ietf.org/doc/html/rfc6716\n\n// INPUT (for single frame sample, see RFC for other 4 code values)\n\n// 0                   1                   2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// | config  |s|0|0|                                               |\n// +-+-+-+-+-+-+-+-+                                               |\n// |                    Compressed frame 1 (N-1 bytes)...          :\n// :                                                               |\n// |                                                               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n\n// OUTPUT\n\n// 0                   1                   2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// | config  |s|1|1|1|p|     M     | Padding length (Optional)     :\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// : N1 (1-2 bytes): N2 (1-2 bytes):     ...       :     N[M-1]    |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                                                               |\n// :               Compressed frame 1 (N1 bytes)...                :\n// |                                                               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                                                               |\n// :               Compressed frame 2 (N2 bytes)...                :\n// |                                                               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                                                               |\n// :                              ...                              :\n// |                                                               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                                                               |\n// :                     Compressed frame M...                     :\n// |                                                               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// :                  Opus Padding (Optional)...                   |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\n\n//                  Figure 6: A CBR Code 3 Packet\n\n// In the VBR case, the (optional) padding length is followed by M-1\n// frame lengths (indicated by \"N1\" to \"N[M-1]\" in Figure 7), each\n// encoded in a one- or two-byte sequence as described above.  The\n// packet MUST contain enough data for the M-1 lengths after removing\n// the (optional) padding, and the sum of these lengths MUST be no\n// larger than the number of bytes remaining in the packet after\n// decoding them [R7].  The compressed data for all M frames follows,\n// each frame consisting of the indicated number of bytes, with the\n// final frame consuming any remaining bytes before the final padding,\n// as illustrated in Figure 6.  The number of header bytes (TOC byte,\n// frame count byte, padding length bytes, and frame length bytes), plus\n// the signaled length of the first M-1 frames themselves, plus the\n// signaled length of the padding MUST be no larger than N, the total\n// size of the packet.\n\nexport class OpusRepacketizer {\n    depacketized: Buffer[] = [];\n    extraPackets = 0;\n\n    // framesPerPacket argument is buggy in that it assumes that the frame durations are always 20.\n    // the frame duration can be determined from the config in the opus header above.\n    // however, frames of duration 20 seems to always be the case from the various test devices.\n    constructor(public framesPerPacket: number) {\n    }\n\n    // repacketize a packet with a single frame into a packet with multiple frames.\n    repacketize(packet: RtpPacket): RtpPacket[] | undefined {\n        const code = packet.payload[0] & 0b00000011;\n        let offset: number;\n\n        // see Frame Length Coding in RFC\n        const decodeFrameLength = () => {\n            let frameLength = packet.payload.readUInt8(offset++);\n            if (frameLength >= 252) {\n                offset++;\n                frameLength += packet.payload.readUInt8(offset) * 4;\n            }\n            return frameLength;\n        }\n        // code 0: cbr, 1 packet\n        // code 1: cbr, 2 packets\n        // code 2: vbr, 2 packets\n        // code 3: cbr/vbr signaled, variable packets\n\n        if (code === 0) {\n            if (this.framesPerPacket === 1 && !this.depacketized.length)\n                return [packet];\n            // depacketize by stripping off the config byte\n            this.depacketized.push(packet.payload.subarray(1));\n        }\n        else if (code === 1) {\n            if (this.framesPerPacket === 2 && !this.depacketized.length)\n                return [packet];\n            // depacketize by dividing the remaining payload into two equal sized frames\n            const remaining = packet.payload.length - 1;\n            if (remaining % 2)\n                throw new Error('expected equal sized opus packets (code 1)');\n            const frameLength = remaining / 2;\n            this.depacketized.push(packet.payload.subarray(1, 1 + frameLength));\n            this.depacketized.push(packet.payload.subarray(1 + frameLength));\n        }\n        else if (code === 2) {\n            if (this.framesPerPacket === 2 && !this.depacketized.length)\n                return [packet];\n            offset = 1;\n            // depacketize by dividing the remaining payload into two inequal sized frames\n            const frameLength = decodeFrameLength();\n            this.depacketized.push(packet.payload.subarray(offset, offset + frameLength));\n            this.depacketized.push(packet.payload.subarray(offset + frameLength));\n        }\n        else if (code === 3) {\n            // code 3 packet will have a frame count and padding indicator, and whether the packets\n            // are equal size or not.\n            const frameCountByte = packet.payload[1];\n            const packetFrameCount = frameCountByte & 0b00111111;\n            const vbr = frameCountByte & 0b10000000;\n            if (this.framesPerPacket === packetFrameCount && !this.depacketized.length)\n                return [packet];\n            const paddingIndicator = frameCountByte & 0b01000000;\n            offset = 2;\n            let padding = 0;\n            if (paddingIndicator) {\n                padding = packet.payload.readUInt8(offset);\n                offset++;\n                if (padding === 255) {\n                    padding = 254 + packet.payload.readUInt8(offset);\n                    offset++;\n                }\n            }\n\n            if (!vbr) {\n                const remaining = packet.payload.length - offset - padding;\n                if (remaining % packetFrameCount)\n                    throw new Error('expected equal sized opus packets (code 3)');\n                const frameLength = remaining / packetFrameCount;\n                for (let i = 0; i < packetFrameCount; i++) {\n                    const start = offset + i * frameLength;\n                    const end = start + frameLength;\n                    this.depacketized.push(packet.payload.subarray(start, end));\n                }\n            }\n            else {\n                const frameLengths: number[] = [];\n                for (let i = 0; i < packetFrameCount - 1; i++) {\n                    const frameLength = decodeFrameLength();\n                    frameLengths.push(frameLength);\n                }\n                for (let i = 0; i < frameLengths.length; i++) {\n                    const frameLength = frameLengths[i];\n                    const start = offset;\n                    offset += frameLength;\n                    this.depacketized.push(packet.payload.subarray(start, offset));\n                }\n                const lastFrameLength = (packet.payload.length - padding) - offset;\n                this.depacketized.push(packet.payload.subarray(offset, offset + lastFrameLength));\n            }\n        }\n\n        if (this.depacketized.length < this.framesPerPacket)\n            return [];\n\n        const ret: RtpPacket[] = [];\n        while (true) {\n            if (this.depacketized.length < this.framesPerPacket)\n                return ret;\n\n            const depacketized = this.depacketized.slice(0, this.framesPerPacket);\n            this.depacketized = this.depacketized.slice(this.framesPerPacket);\n\n            // reuse the config and stereo indicator, but change the code to 3.\n            let toc = packet.payload[0];\n            toc = toc | 0b00000011;  \n            // vbr | padding indicator | packet count\n            let frameCountByte = 0b10000000 | this.framesPerPacket;\n\n            const newHeader: number[] = [toc, frameCountByte];\n\n            // M-1 length bytes\n            newHeader.push(...depacketized.slice(0, -1).map(data => data.length));\n\n            const headerBuffer = Buffer.from(newHeader);\n            const payload = Buffer.concat([headerBuffer, ...depacketized]);\n\n            const newPacket = packet.clone();\n            if (ret.length)\n                this.extraPackets++;\n            newPacket.header.sequenceNumber = (packet.header.sequenceNumber + this.extraPackets + 0x10000) % 0x10000;\n            newPacket.payload = payload;\n            ret.push(newPacket);\n        }\n    }\n}\n","export { randomPort } from \"../../common/src\";\n\nexport * from \"./stun/const\";\nexport * from \"./stun/message\";\nexport * from \"./stun/protocol\";\nexport * from \"./turn/protocol\";\nexport * from \"./candidate\";\nexport * from \"./ice\";\nexport * from \"./types/model\";\nexport * from \"./utils\";\nexport * from \"./iceBase\";\n","import { Event, debug } from \"./imports/common\";\n\nimport { EventTarget } from \"./helper\";\nimport type { RTCSctpTransport } from \"./transport/sctp\";\nimport type { Callback, CallbackWithValue } from \"./types/util\";\n\nconst log = debug(\"werift:packages/webrtc/src/dataChannel.ts\");\n\nexport interface DataChannelStats {\n  messagesSent: number;\n  bytesSent: number;\n  messagesReceived: number;\n  bytesReceived: number;\n}\n\nexport class RTCDataChannel extends EventTarget implements DataChannelStats {\n  readonly stateChange = new Event<[DCState]>();\n  readonly stateChanged = new Event<[DCState]>();\n  readonly onMessage = new Event<[string | Buffer]>();\n  // todo impl\n  readonly error = new Event<[Error]>();\n  readonly bufferedAmountLow = new Event();\n  onopen?: Callback;\n  onclose?: Callback;\n  onclosing?: Callback;\n  onmessage?: CallbackWithValue<MessageEvent>;\n  // todo impl\n  onerror?: CallbackWithValue<RTCErrorEvent>;\n  isCreatedByRemote = false;\n  id: number;\n  readyState: DCState = \"connecting\";\n\n  bufferedAmount = 0;\n  private _bufferedAmountLowThreshold = 0;\n\n  // Statistics\n  messagesSent = 0;\n  bytesSent = 0;\n  messagesReceived = 0;\n  bytesReceived = 0;\n\n  constructor(\n    readonly sctp: RTCSctpTransport,\n    private readonly parameters: RTCDataChannelParameters,\n    public readonly sendOpen = true,\n  ) {\n    super();\n\n    this.id = this.parameters.id;\n\n    if (parameters.negotiated) {\n      if (this.id == undefined || this.id < 0 || this.id > 65534) {\n        throw new Error(\n          \"ID must be in range 0-65534 if data channel is negotiated out-of-band\",\n        );\n      }\n      this.sctp.dataChannelAddNegotiated(this);\n    } else {\n      if (sendOpen) {\n        this.sendOpen = false;\n        this.sctp.dataChannelOpen(this);\n      }\n    }\n  }\n\n  get ordered() {\n    return this.parameters.ordered;\n  }\n\n  get maxRetransmits() {\n    return this.parameters.maxRetransmits;\n  }\n\n  get maxPacketLifeTime() {\n    return this.parameters.maxPacketLifeTime;\n  }\n\n  get label() {\n    return this.parameters.label;\n  }\n\n  get protocol() {\n    return this.parameters.protocol;\n  }\n\n  get negotiated() {\n    return this.parameters.negotiated;\n  }\n\n  get bufferedAmountLowThreshold() {\n    return this._bufferedAmountLowThreshold;\n  }\n\n  set bufferedAmountLowThreshold(value: number) {\n    if (value < 0 || value > 4294967295) {\n      throw new Error(\n        \"bufferedAmountLowThreshold must be in range 0 - 4294967295\",\n      );\n    }\n    this._bufferedAmountLowThreshold = value;\n  }\n\n  setId(id: number) {\n    this.id = id;\n  }\n\n  setReadyState(state: DCState) {\n    if (state !== this.readyState) {\n      this.readyState = state;\n      this.stateChange.execute(state);\n      this.stateChanged.execute(state);\n\n      switch (state) {\n        case \"open\":\n          if (this.onopen) this.onopen();\n          this.emit(\"open\");\n          break;\n        case \"closed\":\n          if (this.onclose) this.onclose();\n          this.emit(\"close\");\n          break;\n        case \"closing\":\n          if (this.onclosing) this.onclosing();\n          break;\n      }\n      log(\"change state\", state);\n    }\n  }\n\n  addBufferedAmount(amount: number) {\n    const crossesThreshold =\n      this.bufferedAmount > this.bufferedAmountLowThreshold &&\n      this.bufferedAmount + amount <= this.bufferedAmountLowThreshold;\n    this.bufferedAmount += amount;\n    if (crossesThreshold) {\n      this.bufferedAmountLow.execute();\n      this.emit(\"bufferedamountlow\");\n    }\n  }\n\n  send(data: Buffer | string) {\n    const size = Buffer.isBuffer(data) ? data.length : Buffer.byteLength(data);\n    this.messagesSent++;\n    this.bytesSent += size;\n    this.sctp.datachannelSend(this, data);\n  }\n\n  close() {\n    this.sctp.dataChannelClose(this);\n  }\n}\n\nexport type DCState = \"open\" | \"closed\" | \"connecting\" | \"closing\";\n\nexport class RTCDataChannelParameters {\n  label = \"\";\n  maxPacketLifeTime?: number; // sec\n  maxRetransmits?: number;\n  ordered = true;\n  protocol = \"\";\n  negotiated = false;\n  id!: number;\n  constructor(props: Partial<RTCDataChannelParameters> = {}) {\n    Object.assign(this, props);\n  }\n}\n\nexport interface MessageEvent {\n  data: string | Buffer;\n}\n\nexport interface RTCErrorEvent {\n  error: any;\n}\n","import { createCipheriv, createDecipheriv, createHmac } from \"crypto\";\n\nimport { CipherAesBase } from \".\";\nimport { RtcpHeader } from \"../../rtcp/header\";\nimport { RtpHeader } from \"../../rtp/rtp\";\n\nexport class CipherAesCtr extends CipherAesBase {\n  readonly authTagLength = 10;\n\n  constructor(\n    srtpSessionKey: Buffer,\n    srtpSessionSalt: Buffer,\n    srtcpSessionKey: Buffer,\n    srtcpSessionSalt: Buffer,\n    private srtpSessionAuthTag: Buffer,\n    private srtcpSessionAuthTag: Buffer,\n  ) {\n    super(srtpSessionKey, srtpSessionSalt, srtcpSessionKey, srtcpSessionSalt);\n  }\n\n  encryptRtp(header: RtpHeader, payload: Buffer, rolloverCounter: number) {\n    const headerBuffer = header.serialize(header.serializeSize);\n\n    const counter = this.generateCounter(\n      header.sequenceNumber,\n      rolloverCounter,\n      header.ssrc,\n      this.srtpSessionSalt,\n    );\n\n    const cipher = createCipheriv(\"aes-128-ctr\", this.srtpSessionKey, counter);\n    const enc = cipher.update(payload);\n\n    const authTag = this.generateSrtpAuthTag(\n      rolloverCounter,\n      headerBuffer,\n      enc,\n    );\n    return Buffer.concat([headerBuffer, enc, authTag]);\n  }\n\n  decryptRtp(cipherText: Buffer, rolloverCounter: number): [Buffer, RtpHeader] {\n    const header = RtpHeader.deSerialize(cipherText);\n\n    const size = cipherText.length - this.authTagLength;\n\n    cipherText = cipherText.subarray(0, cipherText.length - this.authTagLength);\n\n    const counter = this.generateCounter(\n      header.sequenceNumber,\n      rolloverCounter,\n      header.ssrc,\n      this.srtpSessionSalt,\n    );\n    const cipher = createDecipheriv(\n      \"aes-128-ctr\",\n      this.srtpSessionKey,\n      counter,\n    );\n    const payload = cipherText.subarray(header.payloadOffset);\n    const buf = cipher.update(payload);\n\n    const dst = Buffer.concat([\n      cipherText.subarray(0, header.payloadOffset),\n      buf,\n      Buffer.alloc(size - header.payloadOffset - buf.length),\n    ]);\n\n    return [dst, header];\n  }\n\n  encryptRTCP(rtcpPacket: Buffer, srtcpIndex: number): Buffer {\n    let out = Buffer.from(rtcpPacket);\n    const ssrc = out.readUInt32BE(4);\n\n    const counter = this.generateCounter(\n      srtcpIndex & 0xffff,\n      srtcpIndex >> 16,\n      ssrc,\n      this.srtcpSessionSalt,\n    );\n    const cipher = createCipheriv(\"aes-128-ctr\", this.srtcpSessionKey, counter);\n    // Encrypt everything after header\n    const buf = cipher.update(out.slice(8));\n    buf.copy(out, 8);\n    out = Buffer.concat([out, Buffer.alloc(4)]);\n    out.writeUInt32BE(srtcpIndex, out.length - 4);\n    out[out.length - 4] |= 0x80;\n    const authTag = this.generateSrtcpAuthTag(out);\n    out = Buffer.concat([out, authTag]);\n\n    return out;\n  }\n\n  decryptRTCP(encrypted: Buffer): [Buffer, RtcpHeader] {\n    const header = RtcpHeader.deSerialize(encrypted);\n\n    const tailOffset = encrypted.length - (this.authTagLength + srtcpIndexSize);\n    const out = Buffer.from(encrypted).slice(0, tailOffset);\n\n    const isEncrypted = encrypted[tailOffset] >> 7;\n    if (isEncrypted === 0) return [out, header];\n\n    let srtcpIndex = encrypted.readUInt32BE(tailOffset);\n    srtcpIndex &= ~(1 << 31);\n\n    const ssrc = encrypted.readUInt32BE(4);\n\n    // todo impl compare\n    const actualTag = encrypted.subarray(encrypted.length - 10);\n\n    const counter = this.generateCounter(\n      srtcpIndex & 0xffff,\n      srtcpIndex >> 16,\n      ssrc,\n      this.srtcpSessionSalt,\n    );\n    const cipher = createDecipheriv(\n      \"aes-128-ctr\",\n      this.srtcpSessionKey,\n      counter,\n    );\n    const buf = cipher.update(out.subarray(8));\n    buf.copy(out, 8);\n    return [out, header];\n  }\n\n  generateSrtcpAuthTag(buf: Buffer) {\n    const srtcpSessionAuth = createHmac(\"sha1\", this.srtcpSessionAuthTag);\n    return srtcpSessionAuth.update(buf).digest().slice(0, 10);\n  }\n\n  generateCounter(\n    sequenceNumber: number,\n    rolloverCounter: number,\n    ssrc: number,\n    sessionSalt: Buffer,\n  ) {\n    const counter = Buffer.alloc(16);\n    counter.writeUInt32BE(ssrc, 4);\n    counter.writeUInt32BE(rolloverCounter, 8);\n    counter.writeUInt32BE(Number(BigInt(sequenceNumber) << 16n), 12);\n\n    for (let i = 0; i < sessionSalt.length; i++) {\n      counter[i] ^= sessionSalt[i];\n    }\n    return counter;\n  }\n\n  generateSrtpAuthTag(roc: number, ...buffers: Buffer[]) {\n    const srtpSessionAuth = createHmac(\"sha1\", this.srtpSessionAuthTag);\n    const rocRaw = Buffer.alloc(4);\n    rocRaw.writeUInt32BE(roc);\n\n    for (const buf of buffers) {\n      srtpSessionAuth.update(buf);\n    }\n    return srtpSessionAuth.update(rocRaw).digest().subarray(0, 10);\n  }\n}\n\nconst srtcpIndexSize = 4;\n","export enum WEBRTC_PPID {\n  DCEP = 50,\n  STRING = 51,\n  BINARY = 53,\n  STRING_EMPTY = 56,\n  BINARY_EMPTY = 57,\n}\n\nexport enum SCTP_STATE {\n  CLOSED = 1,\n  COOKIE_WAIT = 2,\n  COOKIE_ECHOED = 3,\n  ESTABLISHED = 4,\n  SHUTDOWN_PENDING = 5,\n  SHUTDOWN_SENT = 6,\n  SHUTDOWN_RECEIVED = 7,\n  SHUTDOWN_ACK_SENT = 8,\n}\n","'use strict';\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// **Github:** https://github.com/fidm/asn1\n//\n// **License:** MIT\nvar common_1 = require(\"./common\");\nexports.BufferVisitor = common_1.BufferVisitor;\nvar pem_1 = require(\"./pem\");\nexports.PEM = pem_1.PEM;\nvar asn1_1 = require(\"./asn1\");\nexports.ASN1 = asn1_1.ASN1;\nexports.Class = asn1_1.Class;\nexports.Tag = asn1_1.Tag;\nexports.BitString = asn1_1.BitString;\n//# sourceMappingURL=index.js.map","export * from \"./binary\";\nexport * from \"./number\";\nexport * from \"./promise\";\nexport * from \"./network\";\nexport * from \"./type\";\nexport * from \"./log\";\nexport * from \"./event\";\nexport * from \"./transport\";\n","import {\n  type Extensions,\n  RTP_EXTENSION_URI,\n  ReceiverEstimatedMaxBitrate,\n  type RtcpPacket,\n  RtcpPayloadSpecificFeedback,\n  RtcpRrPacket,\n  RtcpSourceDescriptionPacket,\n  RtcpSrPacket,\n  RtcpTransportLayerFeedback,\n  type RtpPacket,\n  debug,\n  rtpHeaderExtensionsParser,\n} from \"../imports/rtp\";\nimport type {\n  RTCRtpReceiveParameters,\n  RTCRtpSimulcastParameters,\n} from \"./parameters\";\nimport { RTCRtpReceiver } from \"./rtpReceiver\";\nimport type { RTCRtpSender } from \"./rtpSender\";\nimport type { RTCRtpTransceiver } from \"./rtpTransceiver\";\nimport { MediaStreamTrack } from \"./track\";\n\nconst log = debug(\"werift:packages/webrtc/src/media/router.ts\");\n\nexport class RtpRouter {\n  ssrcTable: { [ssrc: number]: RTCRtpReceiver | RTCRtpSender } = {};\n  ridTable: { [rid: string]: RTCRtpReceiver | RTCRtpSender } = {};\n  extIdUriMap: { [id: number]: string } = {};\n\n  constructor() {}\n\n  registerRtpSender(sender: RTCRtpSender) {\n    this.ssrcTable[sender.ssrc] = sender;\n  }\n\n  private registerRtpReceiver(receiver: RTCRtpReceiver, ssrc: number) {\n    log(\"registerRtpReceiver\", ssrc);\n    this.ssrcTable[ssrc] = receiver;\n  }\n\n  registerRtpReceiverBySsrc(\n    transceiver: RTCRtpTransceiver,\n    params: RTCRtpReceiveParameters,\n  ) {\n    log(\"registerRtpReceiverBySsrc\", params);\n\n    params.encodings\n      .filter((e) => e.ssrc != undefined) // todo fix\n      .forEach((encode, i) => {\n        this.registerRtpReceiver(transceiver.receiver, encode.ssrc);\n        transceiver.addTrack(\n          new MediaStreamTrack({\n            ssrc: encode.ssrc,\n            kind: transceiver.kind,\n            id: transceiver.sender.trackId,\n            remote: true,\n            codec: params.codecs[i],\n          }),\n        );\n        if (encode.rtx) {\n          this.registerRtpReceiver(transceiver.receiver, encode.rtx.ssrc);\n        }\n      });\n\n    params.headerExtensions.forEach((extension) => {\n      this.extIdUriMap[extension.id] = extension.uri;\n    });\n  }\n\n  registerRtpReceiverByRid(\n    transceiver: RTCRtpTransceiver,\n    param: RTCRtpSimulcastParameters,\n    params: RTCRtpReceiveParameters,\n  ) {\n    // RTXcodecs/encodings\n    const [codec] = params.codecs;\n\n    log(\"registerRtpReceiverByRid\", param);\n    transceiver.addTrack(\n      new MediaStreamTrack({\n        rid: param.rid,\n        kind: transceiver.kind,\n        id: transceiver.sender.trackId,\n        remote: true,\n        codec,\n      }),\n    );\n    this.ridTable[param.rid] = transceiver.receiver;\n  }\n\n  routeRtp = (packet: RtpPacket) => {\n    const extensions: Extensions = rtpHeaderExtensionsParser(\n      packet.header.extensions,\n      this.extIdUriMap,\n    );\n\n    let rtpReceiver: RTCRtpReceiver | undefined = this.ssrcTable[\n      packet.header.ssrc\n    ] as RTCRtpReceiver;\n\n    const rid = extensions[RTP_EXTENSION_URI.sdesRTPStreamID];\n    if (typeof rid === \"string\") {\n      rtpReceiver = this.ridTable[rid] as RTCRtpReceiver;\n      rtpReceiver.latestRid = rid;\n      rtpReceiver.handleRtpByRid(packet, rid, extensions);\n    } else if (rtpReceiver) {\n      rtpReceiver.handleRtpBySsrc(packet, extensions);\n    } else {\n      // simulcast after send receiver report\n      rtpReceiver = Object.values(this.ridTable)\n        .filter((r): r is RTCRtpReceiver => r instanceof RTCRtpReceiver)\n        .find((r) => r.trackBySSRC[packet.header.ssrc]);\n      if (rtpReceiver) {\n        log(\"simulcast register receiver by ssrc\", packet.header.ssrc);\n        this.registerRtpReceiver(rtpReceiver, packet.header.ssrc);\n        rtpReceiver.handleRtpBySsrc(packet, extensions);\n      } else {\n        // bug\n      }\n    }\n\n    if (!rtpReceiver) {\n      log(\"ssrcReceiver not found\");\n      return;\n    }\n\n    const sdesMid = extensions[RTP_EXTENSION_URI.sdesMid];\n    if (typeof sdesMid === \"string\") {\n      rtpReceiver.sdesMid = sdesMid;\n    }\n\n    const repairedRid = extensions[\n      RTP_EXTENSION_URI.repairedRtpStreamId\n    ] as string;\n    if (typeof repairedRid === \"string\") {\n      rtpReceiver.latestRepairedRid = repairedRid;\n    }\n  };\n\n  routeRtcp = (packet: RtcpPacket) => {\n    const recipients: (RTCRtpReceiver | RTCRtpSender)[] = [];\n\n    switch (packet.type) {\n      case RtcpSrPacket.type:\n        {\n          packet = packet as RtcpSrPacket;\n          recipients.push(this.ssrcTable[packet.ssrc]);\n        }\n        break;\n      case RtcpRrPacket.type:\n        {\n          packet = packet as RtcpRrPacket;\n          packet.reports.forEach((report) => {\n            recipients.push(this.ssrcTable[report.ssrc]);\n          });\n        }\n        break;\n      case RtcpSourceDescriptionPacket.type:\n        {\n          const sdes = packet as RtcpSourceDescriptionPacket;\n          // log(\"sdes\", JSON.stringify(sdes.chunks));\n        }\n        break;\n      case RtcpTransportLayerFeedback.type:\n        {\n          const rtpfb = packet as RtcpTransportLayerFeedback;\n          if (rtpfb.feedback) {\n            recipients.push(this.ssrcTable[rtpfb.feedback.mediaSourceSsrc]);\n          }\n        }\n        break;\n      case RtcpPayloadSpecificFeedback.type:\n        {\n          const psfb = packet as RtcpPayloadSpecificFeedback;\n          switch (psfb.feedback.count) {\n            case ReceiverEstimatedMaxBitrate.count:\n              {\n                const remb = psfb.feedback as ReceiverEstimatedMaxBitrate;\n                recipients.push(this.ssrcTable[remb.ssrcFeedbacks[0]]);\n              }\n              break;\n            default:\n              recipients.push(\n                this.ssrcTable[psfb.feedback.senderSsrc] ||\n                  this.ssrcTable[psfb.feedback.mediaSsrc],\n              );\n          }\n        }\n        break;\n    }\n    recipients\n      .filter((v) => v) // todo simulcast\n      .forEach((recipient) => recipient.handleRtcpPacket(packet));\n  };\n}\n","export enum HandshakeType {\n  hello_request_0 = 0,\n  client_hello_1 = 1,\n  server_hello_2 = 2,\n  hello_verify_request_3 = 3,\n  certificate_11 = 11,\n  server_key_exchange_12 = 12,\n  certificate_request_13 = 13,\n  server_hello_done_14 = 14,\n  certificate_verify_15 = 15,\n  client_key_exchange_16 = 16,\n  finished_20 = 20,\n}\n","'use strict'\n\n/*\n * Traditional DNS header RCODEs (4-bits) defined by IANA in\n * https://www.iana.org/assignments/dns-parameters/dns-parameters.xhtml\n */\n\nexports.toString = function (rcode) {\n  switch (rcode) {\n    case 0: return 'NOERROR'\n    case 1: return 'FORMERR'\n    case 2: return 'SERVFAIL'\n    case 3: return 'NXDOMAIN'\n    case 4: return 'NOTIMP'\n    case 5: return 'REFUSED'\n    case 6: return 'YXDOMAIN'\n    case 7: return 'YXRRSET'\n    case 8: return 'NXRRSET'\n    case 9: return 'NOTAUTH'\n    case 10: return 'NOTZONE'\n    case 11: return 'RCODE_11'\n    case 12: return 'RCODE_12'\n    case 13: return 'RCODE_13'\n    case 14: return 'RCODE_14'\n    case 15: return 'RCODE_15'\n  }\n  return 'RCODE_' + rcode\n}\n\nexports.toRcode = function (code) {\n  switch (code.toUpperCase()) {\n    case 'NOERROR': return 0\n    case 'FORMERR': return 1\n    case 'SERVFAIL': return 2\n    case 'NXDOMAIN': return 3\n    case 'NOTIMP': return 4\n    case 'REFUSED': return 5\n    case 'YXDOMAIN': return 6\n    case 'YXRRSET': return 7\n    case 'NXRRSET': return 8\n    case 'NOTAUTH': return 9\n    case 'NOTZONE': return 10\n    case 'RCODE_11': return 11\n    case 'RCODE_12': return 12\n    case 'RCODE_13': return 13\n    case 'RCODE_14': return 14\n    case 'RCODE_15': return 15\n  }\n  return 0\n}\n","import { SessionType } from \"./cipher/suites/abstract\";\nimport { flight2 } from \"./flight/server/flight2\";\nimport { Flight4 } from \"./flight/server/flight4\";\nimport { Flight6 } from \"./flight/server/flight6\";\nimport { HandshakeType } from \"./handshake/const\";\nimport { ClientHello } from \"./handshake/message/client/hello\";\nimport { debug } from \"./imports/common\";\nimport type { FragmentedHandshake } from \"./record/message/fragment\";\nimport { DtlsSocket, type Options } from \"./socket\";\n\nconst log = debug(\"werift-dtls : packages/dtls/src/server.ts : log\");\n\nexport class DtlsServer extends DtlsSocket {\n  constructor(options: Options) {\n    super(options, SessionType.SERVER);\n    this.onHandleHandshakes = this.handleHandshakes;\n    log(this.dtls.sessionId, \"start server\");\n  }\n\n  private flight6?: Flight6;\n  private handleHandshakes = async (assembled: FragmentedHandshake[]) => {\n    log(\n      this.dtls.sessionId,\n      \"handleHandshakes\",\n      assembled.map((a) => a.msg_type),\n    );\n\n    for (const handshake of assembled) {\n      switch (handshake.msg_type) {\n        // flight1,3\n        case HandshakeType.client_hello_1:\n          {\n            if (this.connected) {\n              this.renegotiation();\n            }\n            const clientHello = ClientHello.deSerialize(handshake.fragment);\n\n            if (clientHello.cookie.length === 0) {\n              log(this.dtls.sessionId, \"send flight2\");\n              flight2(\n                this.transport,\n                this.dtls,\n                this.cipher,\n                this.srtp,\n              )(clientHello);\n            } else if (\n              this.dtls.cookie &&\n              clientHello.cookie.equals(this.dtls.cookie)\n            ) {\n              log(this.dtls.sessionId, \"send flight4\");\n              await new Flight4(\n                this.transport,\n                this.dtls,\n                this.cipher,\n                this.srtp,\n              ).exec(handshake, this.options.certificateRequest);\n            } else {\n              log(\"wrong state\", {\n                dtlsCookie: this.dtls.cookie?.toString(\"hex\").slice(10),\n                helloCookie: clientHello.cookie.toString(\"hex\").slice(10),\n              });\n            }\n          }\n          break;\n        // flight 5\n        case HandshakeType.certificate_11:\n        case HandshakeType.certificate_verify_15:\n        case HandshakeType.client_key_exchange_16:\n          {\n            if (this.connected) return;\n            this.flight6 = new Flight6(this.transport, this.dtls, this.cipher);\n            this.flight6.handleHandshake(handshake);\n          }\n          break;\n        case HandshakeType.finished_20:\n          {\n            await this.waitForReady(() => !!this.flight6);\n            this.flight6?.handleHandshake(handshake);\n\n            await this.waitForReady(() => this.dtls.checkHandshakesExist([16]));\n            await this.flight6?.exec();\n\n            this.connected = true;\n            this.onConnect.execute();\n            log(this.dtls.sessionId, \"dtls connected\");\n          }\n          break;\n      }\n    }\n  };\n}\n","import { RTCRtpTransceiver } from \"./werift\";\nimport { Deferred } from \"@scrypted/common/src/deferred\";\nimport { listenZeroSingleClient } from \"@scrypted/common/src/listen-cluster\";\nimport { RtspServer } from \"@scrypted/common/src/rtsp-server\";\nimport { createSdpInput, parseSdp } from \"@scrypted/common/src/sdp-utils\";\nimport sdk, { FFmpegInput, Intercom, MediaObject, RTCSessionControl } from \"@scrypted/sdk\";\n\nconst { mediaManager } = sdk;\n\nexport class ScryptedSessionControl implements RTCSessionControl {\n    rtspServer: RtspServer;\n    killed = new Deferred<void>();\n\n    constructor(public intercom: Intercom, public audioTransceiver: RTCRtpTransceiver) {\n        this.killed.promise.finally(async () => {\n            this.rtspServer?.client.destroy();\n            try {\n                await this.intercom?.stopIntercom();\n            }\n            catch (e) {\n            }\n        });\n    }\n\n    async setPlayback(options: { audio: boolean; video: boolean; }): Promise<void> {\n        await this.setPlaybackInternal(options);\n    }\n\n    async setPlaybackInternal(options: { audio: boolean; video: boolean; }): Promise<MediaObject> {\n        if (this.killed.finished)\n            return;\n\n        if (!this.intercom)\n            return;\n\n        if (!this.audioTransceiver.receiver.track)\n            await this.audioTransceiver.onTrack.asPromise()\n        const track = this.audioTransceiver.receiver.track;\n\n        track.onReceiveRtp.allUnsubscribe();\n        await this.intercom.stopIntercom();\n\n        if (!options.audio) {\n            return;\n        }\n\n        this.rtspServer?.client.destroy();\n\n        const rtspTcpServer = await listenZeroSingleClient('127.0.0.1');\n\n        const url = rtspTcpServer.url.replace('tcp:', 'rtsp:');\n        const ffmpegInput: FFmpegInput = {\n            container: 'rtsp',\n            url,\n            mediaStreamOptions: {\n                id: undefined,\n                video: null,\n            },\n            inputArguments: [\n                '-analyzeduration', '0',\n                '-probesize', '512',\n                '-rtsp_transport', 'tcp',\n                '-i', url,\n            ],\n        };\n\n\n        const mo = await mediaManager.createFFmpegMediaObject(ffmpegInput);\n        rtspTcpServer.clientPromise.then(async client => {\n            const sdpReturnAudio = [\n                \"v=0\",\n                \"o=- 0 0 IN IP4 127.0.0.1\",\n                \"s=\" + \"WebRTC Audio Talkback\",\n                \"c=IN IP4 127.0.0.1\",\n                \"t=0 0\",\n                \"b=AS:24\",\n\n                // HACK, this may not be opus\n                \"m=audio 0 RTP/AVP 110\",\n                \"a=rtpmap:110 opus/48000/2\",\n                \"a=fmtp:101 minptime=10;useinbandfec=1\",\n\n                // \"m=audio 0 RTP/AVP 0\",\n                // \"a=rtpmap:0 PCMU/8000\",\n\n                // \"m=audio 0 RTP/AVP 8\",\n                // \"a=rtpmap:8 PCMA/8000\",\n            ];\n            let sdp = sdpReturnAudio.join('\\r\\n');\n            sdp = createSdpInput(0, 0, sdp);\n\n\n            const rtspServer = new RtspServer(client, sdp);\n            this.rtspServer = rtspServer;\n            rtspServer.console = console;\n            await rtspServer.handlePlayback();\n            const parsedSdp = parseSdp(rtspServer.sdp);\n            const audioTrack = parsedSdp.msections.find(msection => msection.type === 'audio').control;\n\n            track.onReceiveRtp.subscribe(rtpPacket => {\n                rtpPacket.header.payloadType = 110;\n                rtspServer.sendTrack(audioTrack, rtpPacket.serialize(), false);\n            });\n        });\n\n        await this.intercom.startIntercom(mo);\n        await rtspTcpServer.clientPromise;\n        return mo;\n    }\n\n    async getRefreshAt() {\n    }\n    async extendSession() {\n    }\n\n    async endSession() {\n        this.killed.resolve(undefined);\n    }\n}\n","import { randomBytes } from \"crypto\";\n/* eslint-disable @typescript-eslint/ban-ts-comment */\nimport { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nexport class DtlsRandom {\n  static readonly spec = {\n    gmt_unix_time: types.uint32be,\n    random_bytes: types.buffer(28),\n  };\n\n  constructor(\n    public gmt_unix_time = Math.floor(Date.now() / 1000),\n    public random_bytes = randomBytes(28),\n  ) {}\n\n  static deSerialize(buf: Buffer) {\n    return new DtlsRandom(\n      //@ts-ignore\n      ...Object.values(decode(buf, DtlsRandom.spec)),\n    );\n  }\n\n  static from(spec: typeof DtlsRandom.spec) {\n    //@ts-ignore\n    return new DtlsRandom(...Object.values(spec));\n  }\n\n  serialize() {\n    const res = encode(this, DtlsRandom.spec).slice();\n    return Buffer.from(res);\n  }\n}\n","import { randomUUID } from \"crypto\";\nimport { Candidate, candidateFoundation, candidatePriority } from \"./candidate\";\nimport type { MdnsLookup } from \"./dns/lookup\";\nimport type { Cancelable } from \"./helper\";\nimport {\n  type Address,\n  type Event,\n  type InterfaceAddresses,\n  debug,\n} from \"./imports/common\";\nimport { classes, methods } from \"./stun/const\";\nimport { Message } from \"./stun/message\";\nimport type { Protocol } from \"./types/model\";\n\nconst log = debug(\"werift-ice : packages/ice/src/ice.ts : log\");\n\nexport interface IceConnection {\n  iceControlling: boolean;\n  localUsername: string;\n  localPassword: string;\n  remotePassword: string;\n  remoteUsername: string;\n  remoteIsLite: boolean;\n  checkList: CandidatePair[];\n  localCandidates: Candidate[];\n  remoteCandidates: Candidate[];\n  candidatePairs: CandidatePair[];\n  stunServer?: Address;\n  turnServer?: Address;\n  generation: number;\n  options: IceOptions;\n  remoteCandidatesEnd: boolean;\n  localCandidatesEnd: boolean;\n  state: IceState;\n  lookup?: MdnsLookup;\n  nominated?: CandidatePair;\n\n  readonly onData: Event<[Buffer]>;\n  readonly stateChanged: Event<[IceState]>;\n  readonly onIceCandidate: Event<[Candidate]>;\n\n  restart(): void;\n\n  setRemoteParams(params: {\n    iceLite: boolean;\n    usernameFragment: string;\n    password: string;\n  }): void;\n\n  gatherCandidates(): Promise<void>;\n\n  connect(): Promise<void>;\n\n  close(): Promise<void>;\n\n  addRemoteCandidate(remoteCandidate: Candidate | undefined): Promise<void>;\n\n  send(data: Buffer): Promise<void>;\n\n  getDefaultCandidate(): Candidate | undefined;\n  resetNominatedPair(): void;\n}\n\nexport interface CandidatePairStats {\n  packetsSent: number;\n  packetsReceived: number;\n  bytesSent: number;\n  bytesReceived: number;\n  rtt?: number;\n  totalRoundTripTime: number;\n  roundTripTimeMeasurements: number;\n}\n\nexport class CandidatePair implements CandidatePairStats {\n  readonly id = randomUUID().toString();\n  handle?: Cancelable<void>;\n  nominated = false;\n  remoteNominated = false;\n  // 5.7.4.  Computing States\n  private _state = CandidatePairState.FROZEN;\n  get state() {\n    return this._state;\n  }\n\n  // Statistics tracking\n  packetsSent = 0;\n  packetsReceived = 0;\n  bytesSent = 0;\n  bytesReceived = 0;\n  rtt?: number;\n  totalRoundTripTime = 0;\n  roundTripTimeMeasurements = 0;\n\n  toJSON() {\n    return this.json;\n  }\n\n  get json() {\n    return {\n      protocol: this.protocol.type,\n      localCandidate: this.localCandidate.toSdp(),\n      remoteCandidate: this.remoteCandidate.toSdp(),\n    };\n  }\n\n  constructor(\n    public protocol: Protocol,\n    public remoteCandidate: Candidate,\n    public iceControlling: boolean,\n  ) {}\n\n  updateState(state: CandidatePairState) {\n    this._state = state;\n  }\n\n  get localCandidate() {\n    if (!this.protocol.localCandidate) {\n      throw new Error(\"localCandidate not exist\");\n    }\n    return this.protocol.localCandidate;\n  }\n\n  get remoteAddr(): Address {\n    return [this.remoteCandidate.host, this.remoteCandidate.port];\n  }\n\n  get component() {\n    return this.localCandidate.component;\n  }\n\n  get priority() {\n    return candidatePairPriority(\n      this.localCandidate,\n      this.remoteCandidate,\n      this.iceControlling,\n    );\n  }\n\n  get foundation() {\n    return this.localCandidate.foundation;\n  }\n}\n\nexport const ICE_COMPLETED = 1 as const;\nexport const ICE_FAILED = 2 as const;\n\nexport const CONSENT_INTERVAL = 5;\nexport const CONSENT_FAILURES = 6;\n\nexport enum CandidatePairState {\n  FROZEN = 0,\n  WAITING = 1,\n  IN_PROGRESS = 2,\n  SUCCEEDED = 3,\n  FAILED = 4,\n}\n\nexport type IceState =\n  | \"disconnected\"\n  | \"closed\"\n  | \"completed\"\n  | \"new\"\n  | \"connected\";\n\nexport interface IceOptions {\n  stunServer?: Address;\n  turnServer?: Address;\n  turnUsername?: string;\n  turnPassword?: string;\n  turnTransport?: \"udp\" | \"tcp\";\n  forceTurn?: boolean;\n  localPasswordPrefix?: string;\n  useIpv4: boolean;\n  useIpv6: boolean;\n  useLinkLocalAddress?: boolean;\n  portRange?: [number, number];\n  interfaceAddresses?: InterfaceAddresses;\n  additionalHostAddresses?: string[];\n  filterStunResponse?: (\n    message: Message,\n    addr: Address,\n    protocol: Protocol,\n  ) => boolean;\n  filterCandidatePair?: (pair: CandidatePair) => boolean;\n}\n\nexport const defaultOptions: IceOptions = {\n  useIpv4: true,\n  useIpv6: true,\n};\n\nexport function validateRemoteCandidate(candidate: Candidate) {\n  // \"\"\"\n  // Check the remote candidate is supported.\n  // \"\"\"\n  if (![\"host\", \"relay\", \"srflx\"].includes(candidate.type))\n    throw new Error(`Unexpected candidate type \"${candidate.type}\"`);\n\n  // ipaddress.ip_address(candidate.host)\n  return candidate;\n}\n\nexport function sortCandidatePairs(\n  pairs: {\n    localCandidate: Pick<Candidate, \"priority\">;\n    remoteCandidate: Pick<Candidate, \"priority\">;\n  }[],\n  iceControlling: boolean,\n) {\n  return pairs\n    .sort(\n      (a, b) =>\n        candidatePairPriority(\n          a.localCandidate,\n          a.remoteCandidate,\n          iceControlling,\n        ) -\n        candidatePairPriority(\n          b.localCandidate,\n          b.remoteCandidate,\n          iceControlling,\n        ),\n    )\n    .reverse();\n}\n\n// 5.7.2.  Computing Pair Priority and Ordering Pairs\nexport function candidatePairPriority(\n  local: Pick<Candidate, \"priority\">,\n  remote: Pick<Candidate, \"priority\">,\n  iceControlling: boolean,\n) {\n  const G = (iceControlling && local.priority) || remote.priority;\n  const D = (iceControlling && remote.priority) || local.priority;\n  return (1 << 32) * Math.min(G, D) + 2 * Math.max(G, D) + (G > D ? 1 : 0);\n}\n\nexport async function serverReflexiveCandidate(\n  protocol: Protocol,\n  stunServer: Address,\n) {\n  // \"\"\"\n  // Query STUN server to obtain a server-reflexive candidate.\n  // \"\"\"\n\n  // # perform STUN query\n  const request = new Message(methods.BINDING, classes.REQUEST);\n  try {\n    const [response] = await protocol.request(request, stunServer);\n\n    const localCandidate = protocol.localCandidate;\n    if (!localCandidate) {\n      throw new Error(\"not exist\");\n    }\n\n    const candidate = new Candidate(\n      candidateFoundation(\"srflx\", \"udp\", localCandidate.host),\n      localCandidate.component,\n      localCandidate.transport,\n      candidatePriority(\"srflx\"),\n      response.getAttributeValue(\"XOR-MAPPED-ADDRESS\")[0],\n      response.getAttributeValue(\"XOR-MAPPED-ADDRESS\")[1],\n      \"srflx\",\n      localCandidate.host,\n      localCandidate.port,\n    );\n    return candidate;\n  } catch (error) {\n    // todo fix\n    log(\"error serverReflexiveCandidate\", error);\n  }\n}\n\nexport function validateAddress(addr?: Address): Address | undefined {\n  if (addr && Number.isNaN(addr[1])) {\n    return [addr[0], 443];\n  }\n  return addr;\n}\n","import type { RtpHeader } from \"../rtp/rtp\";\nimport { SrtpContext } from \"./context/srtp\";\nimport { type Config, Session } from \"./session\";\n\nexport class SrtpSession extends Session<SrtpContext> {\n  constructor(public config: Config) {\n    super(SrtpContext);\n    this.start(\n      config.keys.localMasterKey,\n      config.keys.localMasterSalt,\n      config.keys.remoteMasterKey,\n      config.keys.remoteMasterSalt,\n      config.profile,\n    );\n  }\n\n  decrypt = (buf: Buffer) => {\n    const [decrypted] = this.remoteContext.decryptRtp(buf);\n    return decrypted;\n  };\n\n  encrypt(payload: Buffer, header: RtpHeader) {\n    return this.localContext.encryptRtp(payload, header);\n  }\n}\n","import { encode } from \"@shinyoshiaki/binary-data\";\n\nexport function encodeBuffer(obj: object, spec: object) {\n  return Buffer.from(encode(obj, spec).slice());\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ScryptedMimeTypes = exports.ScryptedInterface = exports.MediaPlayerState = exports.SecuritySystemObstruction = exports.SecuritySystemMode = exports.AirQuality = exports.AirPurifierMode = exports.AirPurifierStatus = exports.ChargeState = exports.LockState = exports.PanTiltZoomMovement = exports.ThermostatMode = exports.TemperatureUnit = exports.FanMode = exports.HumidityMode = exports.ScryptedDeviceType = exports.ScryptedInterfaceDescriptors = exports.ScryptedInterfaceMethod = exports.ScryptedInterfaceProperty = exports.DeviceBase = exports.TYPES_VERSION = void 0;\nexports.TYPES_VERSION = \"0.5.48\";\nclass DeviceBase {\n}\nexports.DeviceBase = DeviceBase;\nvar ScryptedInterfaceProperty;\n(function (ScryptedInterfaceProperty) {\n    ScryptedInterfaceProperty[\"id\"] = \"id\";\n    ScryptedInterfaceProperty[\"info\"] = \"info\";\n    ScryptedInterfaceProperty[\"interfaces\"] = \"interfaces\";\n    ScryptedInterfaceProperty[\"mixins\"] = \"mixins\";\n    ScryptedInterfaceProperty[\"name\"] = \"name\";\n    ScryptedInterfaceProperty[\"nativeId\"] = \"nativeId\";\n    ScryptedInterfaceProperty[\"pluginId\"] = \"pluginId\";\n    ScryptedInterfaceProperty[\"providedInterfaces\"] = \"providedInterfaces\";\n    ScryptedInterfaceProperty[\"providedName\"] = \"providedName\";\n    ScryptedInterfaceProperty[\"providedRoom\"] = \"providedRoom\";\n    ScryptedInterfaceProperty[\"providedType\"] = \"providedType\";\n    ScryptedInterfaceProperty[\"providerId\"] = \"providerId\";\n    ScryptedInterfaceProperty[\"room\"] = \"room\";\n    ScryptedInterfaceProperty[\"type\"] = \"type\";\n    ScryptedInterfaceProperty[\"scryptedRuntimeArguments\"] = \"scryptedRuntimeArguments\";\n    ScryptedInterfaceProperty[\"on\"] = \"on\";\n    ScryptedInterfaceProperty[\"brightness\"] = \"brightness\";\n    ScryptedInterfaceProperty[\"colorTemperature\"] = \"colorTemperature\";\n    ScryptedInterfaceProperty[\"rgb\"] = \"rgb\";\n    ScryptedInterfaceProperty[\"hsv\"] = \"hsv\";\n    ScryptedInterfaceProperty[\"buttons\"] = \"buttons\";\n    ScryptedInterfaceProperty[\"sensors\"] = \"sensors\";\n    ScryptedInterfaceProperty[\"running\"] = \"running\";\n    ScryptedInterfaceProperty[\"paused\"] = \"paused\";\n    ScryptedInterfaceProperty[\"docked\"] = \"docked\";\n    ScryptedInterfaceProperty[\"temperatureSetting\"] = \"temperatureSetting\";\n    ScryptedInterfaceProperty[\"temperature\"] = \"temperature\";\n    ScryptedInterfaceProperty[\"temperatureUnit\"] = \"temperatureUnit\";\n    ScryptedInterfaceProperty[\"humidity\"] = \"humidity\";\n    ScryptedInterfaceProperty[\"resolution\"] = \"resolution\";\n    ScryptedInterfaceProperty[\"audioVolumes\"] = \"audioVolumes\";\n    ScryptedInterfaceProperty[\"recordingActive\"] = \"recordingActive\";\n    ScryptedInterfaceProperty[\"ptzCapabilities\"] = \"ptzCapabilities\";\n    ScryptedInterfaceProperty[\"lockState\"] = \"lockState\";\n    ScryptedInterfaceProperty[\"entryOpen\"] = \"entryOpen\";\n    ScryptedInterfaceProperty[\"batteryLevel\"] = \"batteryLevel\";\n    ScryptedInterfaceProperty[\"chargeState\"] = \"chargeState\";\n    ScryptedInterfaceProperty[\"online\"] = \"online\";\n    ScryptedInterfaceProperty[\"fromMimeType\"] = \"fromMimeType\";\n    ScryptedInterfaceProperty[\"toMimeType\"] = \"toMimeType\";\n    ScryptedInterfaceProperty[\"converters\"] = \"converters\";\n    ScryptedInterfaceProperty[\"binaryState\"] = \"binaryState\";\n    ScryptedInterfaceProperty[\"tampered\"] = \"tampered\";\n    ScryptedInterfaceProperty[\"sleeping\"] = \"sleeping\";\n    ScryptedInterfaceProperty[\"powerDetected\"] = \"powerDetected\";\n    ScryptedInterfaceProperty[\"audioDetected\"] = \"audioDetected\";\n    ScryptedInterfaceProperty[\"motionDetected\"] = \"motionDetected\";\n    ScryptedInterfaceProperty[\"ambientLight\"] = \"ambientLight\";\n    ScryptedInterfaceProperty[\"occupied\"] = \"occupied\";\n    ScryptedInterfaceProperty[\"flooded\"] = \"flooded\";\n    ScryptedInterfaceProperty[\"ultraviolet\"] = \"ultraviolet\";\n    ScryptedInterfaceProperty[\"luminance\"] = \"luminance\";\n    ScryptedInterfaceProperty[\"position\"] = \"position\";\n    ScryptedInterfaceProperty[\"securitySystemState\"] = \"securitySystemState\";\n    ScryptedInterfaceProperty[\"pm10Density\"] = \"pm10Density\";\n    ScryptedInterfaceProperty[\"pm25Density\"] = \"pm25Density\";\n    ScryptedInterfaceProperty[\"vocDensity\"] = \"vocDensity\";\n    ScryptedInterfaceProperty[\"noxDensity\"] = \"noxDensity\";\n    ScryptedInterfaceProperty[\"co2ppm\"] = \"co2ppm\";\n    ScryptedInterfaceProperty[\"airQuality\"] = \"airQuality\";\n    ScryptedInterfaceProperty[\"airPurifierState\"] = \"airPurifierState\";\n    ScryptedInterfaceProperty[\"filterChangeIndication\"] = \"filterChangeIndication\";\n    ScryptedInterfaceProperty[\"filterLifeLevel\"] = \"filterLifeLevel\";\n    ScryptedInterfaceProperty[\"humiditySetting\"] = \"humiditySetting\";\n    ScryptedInterfaceProperty[\"fan\"] = \"fan\";\n    ScryptedInterfaceProperty[\"applicationInfo\"] = \"applicationInfo\";\n    ScryptedInterfaceProperty[\"chatCompletionCapabilities\"] = \"chatCompletionCapabilities\";\n    ScryptedInterfaceProperty[\"systemDevice\"] = \"systemDevice\";\n})(ScryptedInterfaceProperty || (exports.ScryptedInterfaceProperty = ScryptedInterfaceProperty = {}));\nvar ScryptedInterfaceMethod;\n(function (ScryptedInterfaceMethod) {\n    ScryptedInterfaceMethod[\"listen\"] = \"listen\";\n    ScryptedInterfaceMethod[\"probe\"] = \"probe\";\n    ScryptedInterfaceMethod[\"setMixins\"] = \"setMixins\";\n    ScryptedInterfaceMethod[\"setName\"] = \"setName\";\n    ScryptedInterfaceMethod[\"setRoom\"] = \"setRoom\";\n    ScryptedInterfaceMethod[\"setType\"] = \"setType\";\n    ScryptedInterfaceMethod[\"getPluginJson\"] = \"getPluginJson\";\n    ScryptedInterfaceMethod[\"turnOff\"] = \"turnOff\";\n    ScryptedInterfaceMethod[\"turnOn\"] = \"turnOn\";\n    ScryptedInterfaceMethod[\"setBrightness\"] = \"setBrightness\";\n    ScryptedInterfaceMethod[\"getTemperatureMaxK\"] = \"getTemperatureMaxK\";\n    ScryptedInterfaceMethod[\"getTemperatureMinK\"] = \"getTemperatureMinK\";\n    ScryptedInterfaceMethod[\"setColorTemperature\"] = \"setColorTemperature\";\n    ScryptedInterfaceMethod[\"setRgb\"] = \"setRgb\";\n    ScryptedInterfaceMethod[\"setHsv\"] = \"setHsv\";\n    ScryptedInterfaceMethod[\"pressButton\"] = \"pressButton\";\n    ScryptedInterfaceMethod[\"sendNotification\"] = \"sendNotification\";\n    ScryptedInterfaceMethod[\"start\"] = \"start\";\n    ScryptedInterfaceMethod[\"stop\"] = \"stop\";\n    ScryptedInterfaceMethod[\"pause\"] = \"pause\";\n    ScryptedInterfaceMethod[\"resume\"] = \"resume\";\n    ScryptedInterfaceMethod[\"dock\"] = \"dock\";\n    ScryptedInterfaceMethod[\"setTemperature\"] = \"setTemperature\";\n    ScryptedInterfaceMethod[\"setTemperatureUnit\"] = \"setTemperatureUnit\";\n    ScryptedInterfaceMethod[\"getPictureOptions\"] = \"getPictureOptions\";\n    ScryptedInterfaceMethod[\"takePicture\"] = \"takePicture\";\n    ScryptedInterfaceMethod[\"getAudioStream\"] = \"getAudioStream\";\n    ScryptedInterfaceMethod[\"setAudioVolumes\"] = \"setAudioVolumes\";\n    ScryptedInterfaceMethod[\"startDisplay\"] = \"startDisplay\";\n    ScryptedInterfaceMethod[\"stopDisplay\"] = \"stopDisplay\";\n    ScryptedInterfaceMethod[\"getVideoStream\"] = \"getVideoStream\";\n    ScryptedInterfaceMethod[\"getVideoStreamOptions\"] = \"getVideoStreamOptions\";\n    ScryptedInterfaceMethod[\"getPrivacyMasks\"] = \"getPrivacyMasks\";\n    ScryptedInterfaceMethod[\"setPrivacyMasks\"] = \"setPrivacyMasks\";\n    ScryptedInterfaceMethod[\"getVideoTextOverlays\"] = \"getVideoTextOverlays\";\n    ScryptedInterfaceMethod[\"setVideoTextOverlay\"] = \"setVideoTextOverlay\";\n    ScryptedInterfaceMethod[\"getRecordingStream\"] = \"getRecordingStream\";\n    ScryptedInterfaceMethod[\"getRecordingStreamCurrentTime\"] = \"getRecordingStreamCurrentTime\";\n    ScryptedInterfaceMethod[\"getRecordingStreamOptions\"] = \"getRecordingStreamOptions\";\n    ScryptedInterfaceMethod[\"getRecordingStreamThumbnail\"] = \"getRecordingStreamThumbnail\";\n    ScryptedInterfaceMethod[\"deleteRecordingStream\"] = \"deleteRecordingStream\";\n    ScryptedInterfaceMethod[\"setRecordingActive\"] = \"setRecordingActive\";\n    ScryptedInterfaceMethod[\"ptzCommand\"] = \"ptzCommand\";\n    ScryptedInterfaceMethod[\"getRecordedEvents\"] = \"getRecordedEvents\";\n    ScryptedInterfaceMethod[\"getVideoClip\"] = \"getVideoClip\";\n    ScryptedInterfaceMethod[\"getVideoClips\"] = \"getVideoClips\";\n    ScryptedInterfaceMethod[\"getVideoClipThumbnail\"] = \"getVideoClipThumbnail\";\n    ScryptedInterfaceMethod[\"removeVideoClips\"] = \"removeVideoClips\";\n    ScryptedInterfaceMethod[\"setVideoStreamOptions\"] = \"setVideoStreamOptions\";\n    ScryptedInterfaceMethod[\"startIntercom\"] = \"startIntercom\";\n    ScryptedInterfaceMethod[\"stopIntercom\"] = \"stopIntercom\";\n    ScryptedInterfaceMethod[\"lock\"] = \"lock\";\n    ScryptedInterfaceMethod[\"unlock\"] = \"unlock\";\n    ScryptedInterfaceMethod[\"addPassword\"] = \"addPassword\";\n    ScryptedInterfaceMethod[\"getPasswords\"] = \"getPasswords\";\n    ScryptedInterfaceMethod[\"removePassword\"] = \"removePassword\";\n    ScryptedInterfaceMethod[\"activate\"] = \"activate\";\n    ScryptedInterfaceMethod[\"deactivate\"] = \"deactivate\";\n    ScryptedInterfaceMethod[\"isReversible\"] = \"isReversible\";\n    ScryptedInterfaceMethod[\"closeEntry\"] = \"closeEntry\";\n    ScryptedInterfaceMethod[\"openEntry\"] = \"openEntry\";\n    ScryptedInterfaceMethod[\"getDevice\"] = \"getDevice\";\n    ScryptedInterfaceMethod[\"releaseDevice\"] = \"releaseDevice\";\n    ScryptedInterfaceMethod[\"adoptDevice\"] = \"adoptDevice\";\n    ScryptedInterfaceMethod[\"discoverDevices\"] = \"discoverDevices\";\n    ScryptedInterfaceMethod[\"createDevice\"] = \"createDevice\";\n    ScryptedInterfaceMethod[\"getCreateDeviceSettings\"] = \"getCreateDeviceSettings\";\n    ScryptedInterfaceMethod[\"reboot\"] = \"reboot\";\n    ScryptedInterfaceMethod[\"getRefreshFrequency\"] = \"getRefreshFrequency\";\n    ScryptedInterfaceMethod[\"refresh\"] = \"refresh\";\n    ScryptedInterfaceMethod[\"getMediaStatus\"] = \"getMediaStatus\";\n    ScryptedInterfaceMethod[\"load\"] = \"load\";\n    ScryptedInterfaceMethod[\"seek\"] = \"seek\";\n    ScryptedInterfaceMethod[\"skipNext\"] = \"skipNext\";\n    ScryptedInterfaceMethod[\"skipPrevious\"] = \"skipPrevious\";\n    ScryptedInterfaceMethod[\"convert\"] = \"convert\";\n    ScryptedInterfaceMethod[\"convertMedia\"] = \"convertMedia\";\n    ScryptedInterfaceMethod[\"getSettings\"] = \"getSettings\";\n    ScryptedInterfaceMethod[\"putSetting\"] = \"putSetting\";\n    ScryptedInterfaceMethod[\"armSecuritySystem\"] = \"armSecuritySystem\";\n    ScryptedInterfaceMethod[\"disarmSecuritySystem\"] = \"disarmSecuritySystem\";\n    ScryptedInterfaceMethod[\"setAirPurifierState\"] = \"setAirPurifierState\";\n    ScryptedInterfaceMethod[\"getReadmeMarkdown\"] = \"getReadmeMarkdown\";\n    ScryptedInterfaceMethod[\"getOauthUrl\"] = \"getOauthUrl\";\n    ScryptedInterfaceMethod[\"onOauthCallback\"] = \"onOauthCallback\";\n    ScryptedInterfaceMethod[\"canMixin\"] = \"canMixin\";\n    ScryptedInterfaceMethod[\"getMixin\"] = \"getMixin\";\n    ScryptedInterfaceMethod[\"releaseMixin\"] = \"releaseMixin\";\n    ScryptedInterfaceMethod[\"onRequest\"] = \"onRequest\";\n    ScryptedInterfaceMethod[\"onConnection\"] = \"onConnection\";\n    ScryptedInterfaceMethod[\"onPush\"] = \"onPush\";\n    ScryptedInterfaceMethod[\"run\"] = \"run\";\n    ScryptedInterfaceMethod[\"eval\"] = \"eval\";\n    ScryptedInterfaceMethod[\"loadScripts\"] = \"loadScripts\";\n    ScryptedInterfaceMethod[\"saveScript\"] = \"saveScript\";\n    ScryptedInterfaceMethod[\"forkInterface\"] = \"forkInterface\";\n    ScryptedInterfaceMethod[\"getDetectionInput\"] = \"getDetectionInput\";\n    ScryptedInterfaceMethod[\"getObjectTypes\"] = \"getObjectTypes\";\n    ScryptedInterfaceMethod[\"detectObjects\"] = \"detectObjects\";\n    ScryptedInterfaceMethod[\"generateObjectDetections\"] = \"generateObjectDetections\";\n    ScryptedInterfaceMethod[\"getDetectionModel\"] = \"getDetectionModel\";\n    ScryptedInterfaceMethod[\"setHumidity\"] = \"setHumidity\";\n    ScryptedInterfaceMethod[\"setFan\"] = \"setFan\";\n    ScryptedInterfaceMethod[\"startRTCSignalingSession\"] = \"startRTCSignalingSession\";\n    ScryptedInterfaceMethod[\"createRTCSignalingSession\"] = \"createRTCSignalingSession\";\n    ScryptedInterfaceMethod[\"getScryptedUserAccessControl\"] = \"getScryptedUserAccessControl\";\n    ScryptedInterfaceMethod[\"generateVideoFrames\"] = \"generateVideoFrames\";\n    ScryptedInterfaceMethod[\"connectStream\"] = \"connectStream\";\n    ScryptedInterfaceMethod[\"getTTYSettings\"] = \"getTTYSettings\";\n    ScryptedInterfaceMethod[\"getChatCompletion\"] = \"getChatCompletion\";\n    ScryptedInterfaceMethod[\"streamChatCompletion\"] = \"streamChatCompletion\";\n    ScryptedInterfaceMethod[\"getTextEmbedding\"] = \"getTextEmbedding\";\n    ScryptedInterfaceMethod[\"getImageEmbedding\"] = \"getImageEmbedding\";\n    ScryptedInterfaceMethod[\"callLLMTool\"] = \"callLLMTool\";\n    ScryptedInterfaceMethod[\"getLLMTools\"] = \"getLLMTools\";\n})(ScryptedInterfaceMethod || (exports.ScryptedInterfaceMethod = ScryptedInterfaceMethod = {}));\nexports.ScryptedInterfaceDescriptors = {\n    \"ScryptedDevice\": {\n        \"name\": \"ScryptedDevice\",\n        \"methods\": [\n            \"listen\",\n            \"probe\",\n            \"setMixins\",\n            \"setName\",\n            \"setRoom\",\n            \"setType\"\n        ],\n        \"properties\": [\n            \"id\",\n            \"info\",\n            \"interfaces\",\n            \"mixins\",\n            \"name\",\n            \"nativeId\",\n            \"pluginId\",\n            \"providedInterfaces\",\n            \"providedName\",\n            \"providedRoom\",\n            \"providedType\",\n            \"providerId\",\n            \"room\",\n            \"type\"\n        ]\n    },\n    \"ScryptedPlugin\": {\n        \"name\": \"ScryptedPlugin\",\n        \"methods\": [\n            \"getPluginJson\"\n        ],\n        \"properties\": []\n    },\n    \"ScryptedPluginRuntime\": {\n        \"name\": \"ScryptedPluginRuntime\",\n        \"methods\": [],\n        \"properties\": [\n            \"scryptedRuntimeArguments\"\n        ]\n    },\n    \"OnOff\": {\n        \"name\": \"OnOff\",\n        \"methods\": [\n            \"turnOff\",\n            \"turnOn\"\n        ],\n        \"properties\": [\n            \"on\"\n        ]\n    },\n    \"Brightness\": {\n        \"name\": \"Brightness\",\n        \"methods\": [\n            \"setBrightness\"\n        ],\n        \"properties\": [\n            \"brightness\"\n        ]\n    },\n    \"ColorSettingTemperature\": {\n        \"name\": \"ColorSettingTemperature\",\n        \"methods\": [\n            \"getTemperatureMaxK\",\n            \"getTemperatureMinK\",\n            \"setColorTemperature\"\n        ],\n        \"properties\": [\n            \"colorTemperature\"\n        ]\n    },\n    \"ColorSettingRgb\": {\n        \"name\": \"ColorSettingRgb\",\n        \"methods\": [\n            \"setRgb\"\n        ],\n        \"properties\": [\n            \"rgb\"\n        ]\n    },\n    \"ColorSettingHsv\": {\n        \"name\": \"ColorSettingHsv\",\n        \"methods\": [\n            \"setHsv\"\n        ],\n        \"properties\": [\n            \"hsv\"\n        ]\n    },\n    \"Buttons\": {\n        \"name\": \"Buttons\",\n        \"methods\": [],\n        \"properties\": [\n            \"buttons\"\n        ]\n    },\n    \"PressButtons\": {\n        \"name\": \"PressButtons\",\n        \"methods\": [\n            \"pressButton\"\n        ],\n        \"properties\": []\n    },\n    \"Sensors\": {\n        \"name\": \"Sensors\",\n        \"methods\": [],\n        \"properties\": [\n            \"sensors\"\n        ]\n    },\n    \"Notifier\": {\n        \"name\": \"Notifier\",\n        \"methods\": [\n            \"sendNotification\"\n        ],\n        \"properties\": []\n    },\n    \"StartStop\": {\n        \"name\": \"StartStop\",\n        \"methods\": [\n            \"start\",\n            \"stop\"\n        ],\n        \"properties\": [\n            \"running\"\n        ]\n    },\n    \"Pause\": {\n        \"name\": \"Pause\",\n        \"methods\": [\n            \"pause\",\n            \"resume\"\n        ],\n        \"properties\": [\n            \"paused\"\n        ]\n    },\n    \"Dock\": {\n        \"name\": \"Dock\",\n        \"methods\": [\n            \"dock\"\n        ],\n        \"properties\": [\n            \"docked\"\n        ]\n    },\n    \"TemperatureSetting\": {\n        \"name\": \"TemperatureSetting\",\n        \"methods\": [\n            \"setTemperature\"\n        ],\n        \"properties\": [\n            \"temperatureSetting\"\n        ]\n    },\n    \"Thermometer\": {\n        \"name\": \"Thermometer\",\n        \"methods\": [\n            \"setTemperatureUnit\"\n        ],\n        \"properties\": [\n            \"temperature\",\n            \"temperatureUnit\"\n        ]\n    },\n    \"HumiditySensor\": {\n        \"name\": \"HumiditySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"humidity\"\n        ]\n    },\n    \"Camera\": {\n        \"name\": \"Camera\",\n        \"methods\": [\n            \"getPictureOptions\",\n            \"takePicture\"\n        ],\n        \"properties\": []\n    },\n    \"Resolution\": {\n        \"name\": \"Resolution\",\n        \"methods\": [],\n        \"properties\": [\n            \"resolution\"\n        ]\n    },\n    \"Microphone\": {\n        \"name\": \"Microphone\",\n        \"methods\": [\n            \"getAudioStream\"\n        ],\n        \"properties\": []\n    },\n    \"AudioVolumeControl\": {\n        \"name\": \"AudioVolumeControl\",\n        \"methods\": [\n            \"setAudioVolumes\"\n        ],\n        \"properties\": [\n            \"audioVolumes\"\n        ]\n    },\n    \"Display\": {\n        \"name\": \"Display\",\n        \"methods\": [\n            \"startDisplay\",\n            \"stopDisplay\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCamera\": {\n        \"name\": \"VideoCamera\",\n        \"methods\": [\n            \"getVideoStream\",\n            \"getVideoStreamOptions\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCameraMask\": {\n        \"name\": \"VideoCameraMask\",\n        \"methods\": [\n            \"getPrivacyMasks\",\n            \"setPrivacyMasks\"\n        ],\n        \"properties\": []\n    },\n    \"VideoTextOverlays\": {\n        \"name\": \"VideoTextOverlays\",\n        \"methods\": [\n            \"getVideoTextOverlays\",\n            \"setVideoTextOverlay\"\n        ],\n        \"properties\": []\n    },\n    \"VideoRecorder\": {\n        \"name\": \"VideoRecorder\",\n        \"methods\": [\n            \"getRecordingStream\",\n            \"getRecordingStreamCurrentTime\",\n            \"getRecordingStreamOptions\",\n            \"getRecordingStreamThumbnail\"\n        ],\n        \"properties\": [\n            \"recordingActive\"\n        ]\n    },\n    \"VideoRecorderManagement\": {\n        \"name\": \"VideoRecorderManagement\",\n        \"methods\": [\n            \"deleteRecordingStream\",\n            \"setRecordingActive\"\n        ],\n        \"properties\": []\n    },\n    \"PanTiltZoom\": {\n        \"name\": \"PanTiltZoom\",\n        \"methods\": [\n            \"ptzCommand\"\n        ],\n        \"properties\": [\n            \"ptzCapabilities\"\n        ]\n    },\n    \"EventRecorder\": {\n        \"name\": \"EventRecorder\",\n        \"methods\": [\n            \"getRecordedEvents\"\n        ],\n        \"properties\": []\n    },\n    \"VideoClips\": {\n        \"name\": \"VideoClips\",\n        \"methods\": [\n            \"getVideoClip\",\n            \"getVideoClips\",\n            \"getVideoClipThumbnail\",\n            \"removeVideoClips\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCameraConfiguration\": {\n        \"name\": \"VideoCameraConfiguration\",\n        \"methods\": [\n            \"setVideoStreamOptions\"\n        ],\n        \"properties\": []\n    },\n    \"Intercom\": {\n        \"name\": \"Intercom\",\n        \"methods\": [\n            \"startIntercom\",\n            \"stopIntercom\"\n        ],\n        \"properties\": []\n    },\n    \"Lock\": {\n        \"name\": \"Lock\",\n        \"methods\": [\n            \"lock\",\n            \"unlock\"\n        ],\n        \"properties\": [\n            \"lockState\"\n        ]\n    },\n    \"PasswordStore\": {\n        \"name\": \"PasswordStore\",\n        \"methods\": [\n            \"addPassword\",\n            \"getPasswords\",\n            \"removePassword\"\n        ],\n        \"properties\": []\n    },\n    \"Scene\": {\n        \"name\": \"Scene\",\n        \"methods\": [\n            \"activate\",\n            \"deactivate\",\n            \"isReversible\"\n        ],\n        \"properties\": []\n    },\n    \"Entry\": {\n        \"name\": \"Entry\",\n        \"methods\": [\n            \"closeEntry\",\n            \"openEntry\"\n        ],\n        \"properties\": []\n    },\n    \"EntrySensor\": {\n        \"name\": \"EntrySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"entryOpen\"\n        ]\n    },\n    \"DeviceProvider\": {\n        \"name\": \"DeviceProvider\",\n        \"methods\": [\n            \"getDevice\",\n            \"releaseDevice\"\n        ],\n        \"properties\": []\n    },\n    \"DeviceDiscovery\": {\n        \"name\": \"DeviceDiscovery\",\n        \"methods\": [\n            \"adoptDevice\",\n            \"discoverDevices\"\n        ],\n        \"properties\": []\n    },\n    \"DeviceCreator\": {\n        \"name\": \"DeviceCreator\",\n        \"methods\": [\n            \"createDevice\",\n            \"getCreateDeviceSettings\"\n        ],\n        \"properties\": []\n    },\n    \"Battery\": {\n        \"name\": \"Battery\",\n        \"methods\": [],\n        \"properties\": [\n            \"batteryLevel\"\n        ]\n    },\n    \"Charger\": {\n        \"name\": \"Charger\",\n        \"methods\": [],\n        \"properties\": [\n            \"chargeState\"\n        ]\n    },\n    \"Reboot\": {\n        \"name\": \"Reboot\",\n        \"methods\": [\n            \"reboot\"\n        ],\n        \"properties\": []\n    },\n    \"Refresh\": {\n        \"name\": \"Refresh\",\n        \"methods\": [\n            \"getRefreshFrequency\",\n            \"refresh\"\n        ],\n        \"properties\": []\n    },\n    \"MediaPlayer\": {\n        \"name\": \"MediaPlayer\",\n        \"methods\": [\n            \"getMediaStatus\",\n            \"load\",\n            \"seek\",\n            \"skipNext\",\n            \"skipPrevious\"\n        ],\n        \"properties\": []\n    },\n    \"Online\": {\n        \"name\": \"Online\",\n        \"methods\": [],\n        \"properties\": [\n            \"online\"\n        ]\n    },\n    \"BufferConverter\": {\n        \"name\": \"BufferConverter\",\n        \"methods\": [\n            \"convert\"\n        ],\n        \"properties\": [\n            \"fromMimeType\",\n            \"toMimeType\"\n        ]\n    },\n    \"MediaConverter\": {\n        \"name\": \"MediaConverter\",\n        \"methods\": [\n            \"convertMedia\"\n        ],\n        \"properties\": [\n            \"converters\"\n        ]\n    },\n    \"Settings\": {\n        \"name\": \"Settings\",\n        \"methods\": [\n            \"getSettings\",\n            \"putSetting\"\n        ],\n        \"properties\": []\n    },\n    \"BinarySensor\": {\n        \"name\": \"BinarySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"binaryState\"\n        ]\n    },\n    \"TamperSensor\": {\n        \"name\": \"TamperSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"tampered\"\n        ]\n    },\n    \"Sleep\": {\n        \"name\": \"Sleep\",\n        \"methods\": [],\n        \"properties\": [\n            \"sleeping\"\n        ]\n    },\n    \"PowerSensor\": {\n        \"name\": \"PowerSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"powerDetected\"\n        ]\n    },\n    \"AudioSensor\": {\n        \"name\": \"AudioSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"audioDetected\"\n        ]\n    },\n    \"MotionSensor\": {\n        \"name\": \"MotionSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"motionDetected\"\n        ]\n    },\n    \"AmbientLightSensor\": {\n        \"name\": \"AmbientLightSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"ambientLight\"\n        ]\n    },\n    \"OccupancySensor\": {\n        \"name\": \"OccupancySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"occupied\"\n        ]\n    },\n    \"FloodSensor\": {\n        \"name\": \"FloodSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"flooded\"\n        ]\n    },\n    \"UltravioletSensor\": {\n        \"name\": \"UltravioletSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"ultraviolet\"\n        ]\n    },\n    \"LuminanceSensor\": {\n        \"name\": \"LuminanceSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"luminance\"\n        ]\n    },\n    \"PositionSensor\": {\n        \"name\": \"PositionSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"position\"\n        ]\n    },\n    \"SecuritySystem\": {\n        \"name\": \"SecuritySystem\",\n        \"methods\": [\n            \"armSecuritySystem\",\n            \"disarmSecuritySystem\"\n        ],\n        \"properties\": [\n            \"securitySystemState\"\n        ]\n    },\n    \"PM10Sensor\": {\n        \"name\": \"PM10Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"pm10Density\"\n        ]\n    },\n    \"PM25Sensor\": {\n        \"name\": \"PM25Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"pm25Density\"\n        ]\n    },\n    \"VOCSensor\": {\n        \"name\": \"VOCSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"vocDensity\"\n        ]\n    },\n    \"NOXSensor\": {\n        \"name\": \"NOXSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"noxDensity\"\n        ]\n    },\n    \"CO2Sensor\": {\n        \"name\": \"CO2Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"co2ppm\"\n        ]\n    },\n    \"AirQualitySensor\": {\n        \"name\": \"AirQualitySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"airQuality\"\n        ]\n    },\n    \"AirPurifier\": {\n        \"name\": \"AirPurifier\",\n        \"methods\": [\n            \"setAirPurifierState\"\n        ],\n        \"properties\": [\n            \"airPurifierState\"\n        ]\n    },\n    \"FilterMaintenance\": {\n        \"name\": \"FilterMaintenance\",\n        \"methods\": [],\n        \"properties\": [\n            \"filterChangeIndication\",\n            \"filterLifeLevel\"\n        ]\n    },\n    \"Readme\": {\n        \"name\": \"Readme\",\n        \"methods\": [\n            \"getReadmeMarkdown\"\n        ],\n        \"properties\": []\n    },\n    \"OauthClient\": {\n        \"name\": \"OauthClient\",\n        \"methods\": [\n            \"getOauthUrl\",\n            \"onOauthCallback\"\n        ],\n        \"properties\": []\n    },\n    \"MixinProvider\": {\n        \"name\": \"MixinProvider\",\n        \"methods\": [\n            \"canMixin\",\n            \"getMixin\",\n            \"releaseMixin\"\n        ],\n        \"properties\": []\n    },\n    \"HttpRequestHandler\": {\n        \"name\": \"HttpRequestHandler\",\n        \"methods\": [\n            \"onRequest\"\n        ],\n        \"properties\": []\n    },\n    \"EngineIOHandler\": {\n        \"name\": \"EngineIOHandler\",\n        \"methods\": [\n            \"onConnection\"\n        ],\n        \"properties\": []\n    },\n    \"PushHandler\": {\n        \"name\": \"PushHandler\",\n        \"methods\": [\n            \"onPush\"\n        ],\n        \"properties\": []\n    },\n    \"Program\": {\n        \"name\": \"Program\",\n        \"methods\": [\n            \"run\"\n        ],\n        \"properties\": []\n    },\n    \"Scriptable\": {\n        \"name\": \"Scriptable\",\n        \"methods\": [\n            \"eval\",\n            \"loadScripts\",\n            \"saveScript\"\n        ],\n        \"properties\": []\n    },\n    \"ClusterForkInterface\": {\n        \"name\": \"ClusterForkInterface\",\n        \"methods\": [\n            \"forkInterface\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetector\": {\n        \"name\": \"ObjectDetector\",\n        \"methods\": [\n            \"getDetectionInput\",\n            \"getObjectTypes\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetection\": {\n        \"name\": \"ObjectDetection\",\n        \"methods\": [\n            \"detectObjects\",\n            \"generateObjectDetections\",\n            \"getDetectionModel\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetectionPreview\": {\n        \"name\": \"ObjectDetectionPreview\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"ObjectDetectionGenerator\": {\n        \"name\": \"ObjectDetectionGenerator\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"HumiditySetting\": {\n        \"name\": \"HumiditySetting\",\n        \"methods\": [\n            \"setHumidity\"\n        ],\n        \"properties\": [\n            \"humiditySetting\"\n        ]\n    },\n    \"Fan\": {\n        \"name\": \"Fan\",\n        \"methods\": [\n            \"setFan\"\n        ],\n        \"properties\": [\n            \"fan\"\n        ]\n    },\n    \"RTCSignalingChannel\": {\n        \"name\": \"RTCSignalingChannel\",\n        \"methods\": [\n            \"startRTCSignalingSession\"\n        ],\n        \"properties\": []\n    },\n    \"RTCSignalingClient\": {\n        \"name\": \"RTCSignalingClient\",\n        \"methods\": [\n            \"createRTCSignalingSession\"\n        ],\n        \"properties\": []\n    },\n    \"LauncherApplication\": {\n        \"name\": \"LauncherApplication\",\n        \"methods\": [],\n        \"properties\": [\n            \"applicationInfo\"\n        ]\n    },\n    \"ScryptedUser\": {\n        \"name\": \"ScryptedUser\",\n        \"methods\": [\n            \"getScryptedUserAccessControl\"\n        ],\n        \"properties\": []\n    },\n    \"VideoFrameGenerator\": {\n        \"name\": \"VideoFrameGenerator\",\n        \"methods\": [\n            \"generateVideoFrames\"\n        ],\n        \"properties\": []\n    },\n    \"StreamService\": {\n        \"name\": \"StreamService\",\n        \"methods\": [\n            \"connectStream\"\n        ],\n        \"properties\": []\n    },\n    \"TTY\": {\n        \"name\": \"TTY\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"TTYSettings\": {\n        \"name\": \"TTYSettings\",\n        \"methods\": [\n            \"getTTYSettings\"\n        ],\n        \"properties\": []\n    },\n    \"ChatCompletion\": {\n        \"name\": \"ChatCompletion\",\n        \"methods\": [\n            \"getChatCompletion\",\n            \"streamChatCompletion\"\n        ],\n        \"properties\": [\n            \"chatCompletionCapabilities\"\n        ]\n    },\n    \"TextEmbedding\": {\n        \"name\": \"TextEmbedding\",\n        \"methods\": [\n            \"getTextEmbedding\"\n        ],\n        \"properties\": []\n    },\n    \"ImageEmbedding\": {\n        \"name\": \"ImageEmbedding\",\n        \"methods\": [\n            \"getImageEmbedding\"\n        ],\n        \"properties\": []\n    },\n    \"LLMTools\": {\n        \"name\": \"LLMTools\",\n        \"methods\": [\n            \"callLLMTool\",\n            \"getLLMTools\"\n        ],\n        \"properties\": []\n    },\n    \"ScryptedSystemDevice\": {\n        \"name\": \"ScryptedSystemDevice\",\n        \"methods\": [],\n        \"properties\": [\n            \"systemDevice\"\n        ]\n    },\n    \"ScryptedDeviceCreator\": {\n        \"name\": \"ScryptedDeviceCreator\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"ScryptedSettings\": {\n        \"name\": \"ScryptedSettings\",\n        \"methods\": [],\n        \"properties\": []\n    }\n};\n/**\n * @category Core Reference\n */\nvar ScryptedDeviceType;\n(function (ScryptedDeviceType) {\n    /**\n     * @deprecated\n     */\n    ScryptedDeviceType[\"Builtin\"] = \"Builtin\";\n    /**\n     * Internal devices will not show up in device lists unless explicitly searched.\n     */\n    ScryptedDeviceType[\"Internal\"] = \"Internal\";\n    ScryptedDeviceType[\"Camera\"] = \"Camera\";\n    ScryptedDeviceType[\"Fan\"] = \"Fan\";\n    ScryptedDeviceType[\"Light\"] = \"Light\";\n    ScryptedDeviceType[\"Switch\"] = \"Switch\";\n    ScryptedDeviceType[\"Outlet\"] = \"Outlet\";\n    ScryptedDeviceType[\"Sensor\"] = \"Sensor\";\n    ScryptedDeviceType[\"Scene\"] = \"Scene\";\n    ScryptedDeviceType[\"Program\"] = \"Program\";\n    ScryptedDeviceType[\"Automation\"] = \"Automation\";\n    ScryptedDeviceType[\"Vacuum\"] = \"Vacuum\";\n    ScryptedDeviceType[\"Notifier\"] = \"Notifier\";\n    ScryptedDeviceType[\"Thermostat\"] = \"Thermostat\";\n    ScryptedDeviceType[\"Lock\"] = \"Lock\";\n    ScryptedDeviceType[\"PasswordControl\"] = \"PasswordControl\";\n    /**\n     * Displays have audio and video output.\n     */\n    ScryptedDeviceType[\"Display\"] = \"Display\";\n    /**\n     * Smart Displays have two way audio and video.\n     */\n    ScryptedDeviceType[\"SmartDisplay\"] = \"SmartDisplay\";\n    ScryptedDeviceType[\"Speaker\"] = \"Speaker\";\n    /**\n     * Smart Speakers have two way audio.\n     */\n    ScryptedDeviceType[\"SmartSpeaker\"] = \"SmartSpeaker\";\n    ScryptedDeviceType[\"RemoteDesktop\"] = \"RemoteDesktop\";\n    ScryptedDeviceType[\"Event\"] = \"Event\";\n    ScryptedDeviceType[\"Entry\"] = \"Entry\";\n    ScryptedDeviceType[\"Garage\"] = \"Garage\";\n    ScryptedDeviceType[\"DeviceProvider\"] = \"DeviceProvider\";\n    ScryptedDeviceType[\"DataSource\"] = \"DataSource\";\n    ScryptedDeviceType[\"API\"] = \"API\";\n    ScryptedDeviceType[\"Buttons\"] = \"Buttons\";\n    ScryptedDeviceType[\"Doorbell\"] = \"Doorbell\";\n    ScryptedDeviceType[\"Irrigation\"] = \"Irrigation\";\n    ScryptedDeviceType[\"Valve\"] = \"Valve\";\n    ScryptedDeviceType[\"Person\"] = \"Person\";\n    ScryptedDeviceType[\"SecuritySystem\"] = \"SecuritySystem\";\n    ScryptedDeviceType[\"WindowCovering\"] = \"WindowCovering\";\n    ScryptedDeviceType[\"Siren\"] = \"Siren\";\n    ScryptedDeviceType[\"AirPurifier\"] = \"AirPurifier\";\n    ScryptedDeviceType[\"Internet\"] = \"Internet\";\n    ScryptedDeviceType[\"Network\"] = \"Network\";\n    ScryptedDeviceType[\"Bridge\"] = \"Bridge\";\n    ScryptedDeviceType[\"LLM\"] = \"LLM\";\n    ScryptedDeviceType[\"Unknown\"] = \"Unknown\";\n})(ScryptedDeviceType || (exports.ScryptedDeviceType = ScryptedDeviceType = {}));\nvar HumidityMode;\n(function (HumidityMode) {\n    HumidityMode[\"Humidify\"] = \"Humidify\";\n    HumidityMode[\"Dehumidify\"] = \"Dehumidify\";\n    HumidityMode[\"Auto\"] = \"Auto\";\n    HumidityMode[\"Off\"] = \"Off\";\n})(HumidityMode || (exports.HumidityMode = HumidityMode = {}));\nvar FanMode;\n(function (FanMode) {\n    FanMode[\"Auto\"] = \"Auto\";\n    FanMode[\"Manual\"] = \"Manual\";\n})(FanMode || (exports.FanMode = FanMode = {}));\nvar TemperatureUnit;\n(function (TemperatureUnit) {\n    TemperatureUnit[\"C\"] = \"C\";\n    TemperatureUnit[\"F\"] = \"F\";\n})(TemperatureUnit || (exports.TemperatureUnit = TemperatureUnit = {}));\nvar ThermostatMode;\n(function (ThermostatMode) {\n    ThermostatMode[\"Off\"] = \"Off\";\n    ThermostatMode[\"Cool\"] = \"Cool\";\n    ThermostatMode[\"Heat\"] = \"Heat\";\n    ThermostatMode[\"HeatCool\"] = \"HeatCool\";\n    ThermostatMode[\"Auto\"] = \"Auto\";\n    ThermostatMode[\"FanOnly\"] = \"FanOnly\";\n    ThermostatMode[\"Purifier\"] = \"Purifier\";\n    ThermostatMode[\"Eco\"] = \"Eco\";\n    ThermostatMode[\"Dry\"] = \"Dry\";\n    ThermostatMode[\"On\"] = \"On\";\n})(ThermostatMode || (exports.ThermostatMode = ThermostatMode = {}));\nvar PanTiltZoomMovement;\n(function (PanTiltZoomMovement) {\n    PanTiltZoomMovement[\"Absolute\"] = \"Absolute\";\n    PanTiltZoomMovement[\"Relative\"] = \"Relative\";\n    PanTiltZoomMovement[\"Continuous\"] = \"Continuous\";\n    PanTiltZoomMovement[\"Preset\"] = \"Preset\";\n    PanTiltZoomMovement[\"Home\"] = \"Home\";\n})(PanTiltZoomMovement || (exports.PanTiltZoomMovement = PanTiltZoomMovement = {}));\nvar LockState;\n(function (LockState) {\n    LockState[\"Locked\"] = \"Locked\";\n    LockState[\"Unlocked\"] = \"Unlocked\";\n    LockState[\"Jammed\"] = \"Jammed\";\n})(LockState || (exports.LockState = LockState = {}));\nvar ChargeState;\n(function (ChargeState) {\n    ChargeState[\"Trickle\"] = \"trickle\";\n    ChargeState[\"Charging\"] = \"charging\";\n    ChargeState[\"NotCharging\"] = \"not-charging\";\n})(ChargeState || (exports.ChargeState = ChargeState = {}));\nvar AirPurifierStatus;\n(function (AirPurifierStatus) {\n    AirPurifierStatus[\"Inactive\"] = \"Inactive\";\n    AirPurifierStatus[\"Idle\"] = \"Idle\";\n    AirPurifierStatus[\"Active\"] = \"Active\";\n    AirPurifierStatus[\"ActiveNightMode\"] = \"ActiveNightMode\";\n})(AirPurifierStatus || (exports.AirPurifierStatus = AirPurifierStatus = {}));\nvar AirPurifierMode;\n(function (AirPurifierMode) {\n    AirPurifierMode[\"Manual\"] = \"Manual\";\n    AirPurifierMode[\"Automatic\"] = \"Automatic\";\n})(AirPurifierMode || (exports.AirPurifierMode = AirPurifierMode = {}));\nvar AirQuality;\n(function (AirQuality) {\n    AirQuality[\"Unknown\"] = \"Unknown\";\n    AirQuality[\"Excellent\"] = \"Excellent\";\n    AirQuality[\"Good\"] = \"Good\";\n    AirQuality[\"Fair\"] = \"Fair\";\n    AirQuality[\"Inferior\"] = \"Inferior\";\n    AirQuality[\"Poor\"] = \"Poor\";\n})(AirQuality || (exports.AirQuality = AirQuality = {}));\nvar SecuritySystemMode;\n(function (SecuritySystemMode) {\n    SecuritySystemMode[\"Disarmed\"] = \"Disarmed\";\n    SecuritySystemMode[\"HomeArmed\"] = \"HomeArmed\";\n    SecuritySystemMode[\"AwayArmed\"] = \"AwayArmed\";\n    SecuritySystemMode[\"NightArmed\"] = \"NightArmed\";\n})(SecuritySystemMode || (exports.SecuritySystemMode = SecuritySystemMode = {}));\nvar SecuritySystemObstruction;\n(function (SecuritySystemObstruction) {\n    SecuritySystemObstruction[\"Sensor\"] = \"Sensor\";\n    SecuritySystemObstruction[\"Occupied\"] = \"Occupied\";\n    SecuritySystemObstruction[\"Time\"] = \"Time\";\n    SecuritySystemObstruction[\"Error\"] = \"Error\";\n})(SecuritySystemObstruction || (exports.SecuritySystemObstruction = SecuritySystemObstruction = {}));\nvar MediaPlayerState;\n(function (MediaPlayerState) {\n    MediaPlayerState[\"Idle\"] = \"Idle\";\n    MediaPlayerState[\"Playing\"] = \"Playing\";\n    MediaPlayerState[\"Paused\"] = \"Paused\";\n    MediaPlayerState[\"Buffering\"] = \"Buffering\";\n})(MediaPlayerState || (exports.MediaPlayerState = MediaPlayerState = {}));\nvar ScryptedInterface;\n(function (ScryptedInterface) {\n    ScryptedInterface[\"ScryptedDevice\"] = \"ScryptedDevice\";\n    ScryptedInterface[\"ScryptedPlugin\"] = \"ScryptedPlugin\";\n    ScryptedInterface[\"ScryptedPluginRuntime\"] = \"ScryptedPluginRuntime\";\n    ScryptedInterface[\"OnOff\"] = \"OnOff\";\n    ScryptedInterface[\"Brightness\"] = \"Brightness\";\n    ScryptedInterface[\"ColorSettingTemperature\"] = \"ColorSettingTemperature\";\n    ScryptedInterface[\"ColorSettingRgb\"] = \"ColorSettingRgb\";\n    ScryptedInterface[\"ColorSettingHsv\"] = \"ColorSettingHsv\";\n    ScryptedInterface[\"Buttons\"] = \"Buttons\";\n    ScryptedInterface[\"PressButtons\"] = \"PressButtons\";\n    ScryptedInterface[\"Sensors\"] = \"Sensors\";\n    ScryptedInterface[\"Notifier\"] = \"Notifier\";\n    ScryptedInterface[\"StartStop\"] = \"StartStop\";\n    ScryptedInterface[\"Pause\"] = \"Pause\";\n    ScryptedInterface[\"Dock\"] = \"Dock\";\n    ScryptedInterface[\"TemperatureSetting\"] = \"TemperatureSetting\";\n    ScryptedInterface[\"Thermometer\"] = \"Thermometer\";\n    ScryptedInterface[\"HumiditySensor\"] = \"HumiditySensor\";\n    ScryptedInterface[\"Camera\"] = \"Camera\";\n    ScryptedInterface[\"Resolution\"] = \"Resolution\";\n    ScryptedInterface[\"Microphone\"] = \"Microphone\";\n    ScryptedInterface[\"AudioVolumeControl\"] = \"AudioVolumeControl\";\n    ScryptedInterface[\"Display\"] = \"Display\";\n    ScryptedInterface[\"VideoCamera\"] = \"VideoCamera\";\n    ScryptedInterface[\"VideoCameraMask\"] = \"VideoCameraMask\";\n    ScryptedInterface[\"VideoTextOverlays\"] = \"VideoTextOverlays\";\n    ScryptedInterface[\"VideoRecorder\"] = \"VideoRecorder\";\n    ScryptedInterface[\"VideoRecorderManagement\"] = \"VideoRecorderManagement\";\n    ScryptedInterface[\"PanTiltZoom\"] = \"PanTiltZoom\";\n    ScryptedInterface[\"EventRecorder\"] = \"EventRecorder\";\n    ScryptedInterface[\"VideoClips\"] = \"VideoClips\";\n    ScryptedInterface[\"VideoCameraConfiguration\"] = \"VideoCameraConfiguration\";\n    ScryptedInterface[\"Intercom\"] = \"Intercom\";\n    ScryptedInterface[\"Lock\"] = \"Lock\";\n    ScryptedInterface[\"PasswordStore\"] = \"PasswordStore\";\n    ScryptedInterface[\"Scene\"] = \"Scene\";\n    ScryptedInterface[\"Entry\"] = \"Entry\";\n    ScryptedInterface[\"EntrySensor\"] = \"EntrySensor\";\n    ScryptedInterface[\"DeviceProvider\"] = \"DeviceProvider\";\n    ScryptedInterface[\"DeviceDiscovery\"] = \"DeviceDiscovery\";\n    ScryptedInterface[\"DeviceCreator\"] = \"DeviceCreator\";\n    ScryptedInterface[\"Battery\"] = \"Battery\";\n    ScryptedInterface[\"Charger\"] = \"Charger\";\n    ScryptedInterface[\"Reboot\"] = \"Reboot\";\n    ScryptedInterface[\"Refresh\"] = \"Refresh\";\n    ScryptedInterface[\"MediaPlayer\"] = \"MediaPlayer\";\n    ScryptedInterface[\"Online\"] = \"Online\";\n    ScryptedInterface[\"BufferConverter\"] = \"BufferConverter\";\n    ScryptedInterface[\"MediaConverter\"] = \"MediaConverter\";\n    ScryptedInterface[\"Settings\"] = \"Settings\";\n    ScryptedInterface[\"BinarySensor\"] = \"BinarySensor\";\n    ScryptedInterface[\"TamperSensor\"] = \"TamperSensor\";\n    ScryptedInterface[\"Sleep\"] = \"Sleep\";\n    ScryptedInterface[\"PowerSensor\"] = \"PowerSensor\";\n    ScryptedInterface[\"AudioSensor\"] = \"AudioSensor\";\n    ScryptedInterface[\"MotionSensor\"] = \"MotionSensor\";\n    ScryptedInterface[\"AmbientLightSensor\"] = \"AmbientLightSensor\";\n    ScryptedInterface[\"OccupancySensor\"] = \"OccupancySensor\";\n    ScryptedInterface[\"FloodSensor\"] = \"FloodSensor\";\n    ScryptedInterface[\"UltravioletSensor\"] = \"UltravioletSensor\";\n    ScryptedInterface[\"LuminanceSensor\"] = \"LuminanceSensor\";\n    ScryptedInterface[\"PositionSensor\"] = \"PositionSensor\";\n    ScryptedInterface[\"SecuritySystem\"] = \"SecuritySystem\";\n    ScryptedInterface[\"PM10Sensor\"] = \"PM10Sensor\";\n    ScryptedInterface[\"PM25Sensor\"] = \"PM25Sensor\";\n    ScryptedInterface[\"VOCSensor\"] = \"VOCSensor\";\n    ScryptedInterface[\"NOXSensor\"] = \"NOXSensor\";\n    ScryptedInterface[\"CO2Sensor\"] = \"CO2Sensor\";\n    ScryptedInterface[\"AirQualitySensor\"] = \"AirQualitySensor\";\n    ScryptedInterface[\"AirPurifier\"] = \"AirPurifier\";\n    ScryptedInterface[\"FilterMaintenance\"] = \"FilterMaintenance\";\n    ScryptedInterface[\"Readme\"] = \"Readme\";\n    ScryptedInterface[\"OauthClient\"] = \"OauthClient\";\n    ScryptedInterface[\"MixinProvider\"] = \"MixinProvider\";\n    ScryptedInterface[\"HttpRequestHandler\"] = \"HttpRequestHandler\";\n    ScryptedInterface[\"EngineIOHandler\"] = \"EngineIOHandler\";\n    ScryptedInterface[\"PushHandler\"] = \"PushHandler\";\n    ScryptedInterface[\"Program\"] = \"Program\";\n    ScryptedInterface[\"Scriptable\"] = \"Scriptable\";\n    ScryptedInterface[\"ClusterForkInterface\"] = \"ClusterForkInterface\";\n    ScryptedInterface[\"ObjectDetector\"] = \"ObjectDetector\";\n    ScryptedInterface[\"ObjectDetection\"] = \"ObjectDetection\";\n    ScryptedInterface[\"ObjectDetectionPreview\"] = \"ObjectDetectionPreview\";\n    ScryptedInterface[\"ObjectDetectionGenerator\"] = \"ObjectDetectionGenerator\";\n    ScryptedInterface[\"HumiditySetting\"] = \"HumiditySetting\";\n    ScryptedInterface[\"Fan\"] = \"Fan\";\n    ScryptedInterface[\"RTCSignalingChannel\"] = \"RTCSignalingChannel\";\n    ScryptedInterface[\"RTCSignalingClient\"] = \"RTCSignalingClient\";\n    ScryptedInterface[\"LauncherApplication\"] = \"LauncherApplication\";\n    ScryptedInterface[\"ScryptedUser\"] = \"ScryptedUser\";\n    ScryptedInterface[\"VideoFrameGenerator\"] = \"VideoFrameGenerator\";\n    ScryptedInterface[\"StreamService\"] = \"StreamService\";\n    ScryptedInterface[\"TTY\"] = \"TTY\";\n    ScryptedInterface[\"TTYSettings\"] = \"TTYSettings\";\n    ScryptedInterface[\"ChatCompletion\"] = \"ChatCompletion\";\n    ScryptedInterface[\"TextEmbedding\"] = \"TextEmbedding\";\n    ScryptedInterface[\"ImageEmbedding\"] = \"ImageEmbedding\";\n    ScryptedInterface[\"LLMTools\"] = \"LLMTools\";\n    ScryptedInterface[\"ScryptedSystemDevice\"] = \"ScryptedSystemDevice\";\n    ScryptedInterface[\"ScryptedDeviceCreator\"] = \"ScryptedDeviceCreator\";\n    ScryptedInterface[\"ScryptedSettings\"] = \"ScryptedSettings\";\n})(ScryptedInterface || (exports.ScryptedInterface = ScryptedInterface = {}));\nvar ScryptedMimeTypes;\n(function (ScryptedMimeTypes) {\n    ScryptedMimeTypes[\"Url\"] = \"text/x-uri\";\n    ScryptedMimeTypes[\"InsecureLocalUrl\"] = \"text/x-insecure-local-uri\";\n    ScryptedMimeTypes[\"LocalUrl\"] = \"text/x-local-uri\";\n    ScryptedMimeTypes[\"ServerId\"] = \"text/x-server-id\";\n    ScryptedMimeTypes[\"PushEndpoint\"] = \"text/x-push-endpoint\";\n    ScryptedMimeTypes[\"SchemePrefix\"] = \"x-scrypted/x-scrypted-scheme-\";\n    ScryptedMimeTypes[\"MediaStreamUrl\"] = \"text/x-media-url\";\n    ScryptedMimeTypes[\"MediaObject\"] = \"x-scrypted/x-scrypted-media-object\";\n    ScryptedMimeTypes[\"RequestMediaObject\"] = \"x-scrypted/x-scrypted-request-media-object\";\n    ScryptedMimeTypes[\"RequestMediaStream\"] = \"x-scrypted/x-scrypted-request-stream\";\n    ScryptedMimeTypes[\"MediaStreamFeedback\"] = \"x-scrypted/x-media-stream-feedback\";\n    ScryptedMimeTypes[\"FFmpegInput\"] = \"x-scrypted/x-ffmpeg-input\";\n    ScryptedMimeTypes[\"FFmpegTranscodeStream\"] = \"x-scrypted/x-ffmpeg-transcode-stream\";\n    ScryptedMimeTypes[\"RTCSignalingChannel\"] = \"x-scrypted/x-scrypted-rtc-signaling-channel\";\n    ScryptedMimeTypes[\"RTCSignalingSession\"] = \"x-scrypted/x-scrypted-rtc-signaling-session\";\n    ScryptedMimeTypes[\"RTCConnectionManagement\"] = \"x-scrypted/x-scrypted-rtc-connection-management\";\n    ScryptedMimeTypes[\"Image\"] = \"x-scrypted/x-scrypted-image\";\n})(ScryptedMimeTypes || (exports.ScryptedMimeTypes = ScryptedMimeTypes = {}));\n//# sourceMappingURL=index.js.map","import { createHmac } from \"crypto\";\nimport { jspack } from \"@shinyoshiaki/jspack\";\nimport crc32 from \"buffer-crc32\";\n\nimport { bufferXor, randomTransactionId } from \"../helper\";\nimport {\n  ATTRIBUTES_BY_NAME,\n  ATTRIBUTES_BY_TYPE,\n  type AttributeKey,\n  type AttributePair,\n  AttributeRepository,\n  packXorAddress,\n  unpackXorAddress,\n} from \"./attributes\";\nimport {\n  COOKIE,\n  FINGERPRINT_LENGTH,\n  FINGERPRINT_XOR,\n  HEADER_LENGTH,\n  INTEGRITY_LENGTH,\n  classes,\n  methods,\n} from \"./const\";\n\nexport function parseMessage(\n  data: Buffer,\n  integrityKey?: Buffer,\n): Message | undefined {\n  if (data.length < HEADER_LENGTH) {\n    return undefined;\n  }\n\n  const length = data.readUint16BE(2);\n\n  if (data.length !== HEADER_LENGTH + length) {\n    return undefined;\n  }\n\n  const messageType = data.readUint16BE(0);\n  const transactionId = Buffer.from(\n    data.slice(HEADER_LENGTH - 12, HEADER_LENGTH),\n  );\n\n  const attributeRepository = new AttributeRepository();\n\n  for (let pos = HEADER_LENGTH; pos <= data.length - 4; ) {\n    const attrType = data.readUInt16BE(pos);\n    const attrLen = data.readUInt16BE(pos + 2);\n    const payload = data.slice(pos + 4, pos + 4 + attrLen);\n    const padLen = 4 * Math.floor((attrLen + 3) / 4) - attrLen;\n    const attributesTypes = Object.keys(ATTRIBUTES_BY_TYPE);\n    if (attributesTypes.includes(attrType.toString())) {\n      const [, attrName, , attrUnpack] = ATTRIBUTES_BY_TYPE[attrType];\n      if (attrUnpack.name === unpackXorAddress.name) {\n        attributeRepository.setAttribute(\n          attrName as AttributeKey,\n          attrUnpack(payload, transactionId),\n        );\n      } else {\n        attributeRepository.setAttribute(\n          attrName as AttributeKey,\n          attrUnpack(payload),\n        );\n      }\n\n      if (attrName === \"FINGERPRINT\") {\n        const fingerprint = messageFingerprint(data.slice(0, pos));\n        const expect = attributeRepository.getAttributeValue(\"FINGERPRINT\");\n        if (expect !== fingerprint) {\n          return undefined;\n        }\n      } else if (attrName === \"MESSAGE-INTEGRITY\") {\n        if (integrityKey) {\n          const integrity = messageIntegrity(data.slice(0, pos), integrityKey);\n          const expect =\n            attributeRepository.getAttributeValue(\"MESSAGE-INTEGRITY\");\n          if (!integrity.equals(expect)) {\n            return undefined;\n          }\n        }\n      }\n    }\n    pos += 4 + attrLen + padLen;\n  }\n\n  const attributes = attributeRepository.getAttributes();\n  attributeRepository.clear();\n\n  return new Message(\n    messageType & 0x3eef,\n    messageType & 0x0110,\n    transactionId,\n    attributes,\n  );\n}\n\nexport class Message extends AttributeRepository {\n  constructor(\n    public messageMethod: methods,\n    public messageClass: classes,\n    public transactionId: Buffer = randomTransactionId(),\n    attributes: AttributePair[] = [],\n  ) {\n    super(attributes);\n  }\n\n  toJSON() {\n    return this.json;\n  }\n\n  get json() {\n    return {\n      messageMethod: methods[this.messageMethod],\n      messageClass: classes[this.messageClass],\n      attributes: this.attributes,\n    };\n  }\n\n  get transactionIdHex() {\n    return this.transactionId.toString(\"hex\");\n  }\n\n  get bytes() {\n    let data = Buffer.from([]);\n    for (const attrName of this.attributesKeys) {\n      const attrValue = this.getAttributeValue(attrName);\n      const [attrType, , attrPack] = ATTRIBUTES_BY_NAME[attrName];\n      const v =\n        attrPack.name === packXorAddress.name\n          ? attrPack(attrValue, this.transactionId)\n          : attrPack(attrValue);\n      const attrLen = v.length;\n      const padLen = 4 * Math.floor((attrLen + 3) / 4) - attrLen;\n      const attrHeader = Buffer.alloc(4);\n      attrHeader.writeUInt16BE(attrType, 0);\n      attrHeader.writeUInt16BE(attrLen, 2);\n      data = Buffer.concat([data, attrHeader, v, Buffer.alloc(padLen, 0)]);\n    }\n    const buf = Buffer.alloc(8);\n    buf.writeUInt16BE(this.messageMethod | this.messageClass, 0);\n    buf.writeUInt16BE(data.length, 2);\n    buf.writeUInt32BE(COOKIE, 4);\n\n    return Buffer.concat([buf, this.transactionId, data]);\n  }\n\n  addMessageIntegrity(key: Buffer) {\n    this.setAttribute(\"MESSAGE-INTEGRITY\", this.messageIntegrity(key));\n    return this;\n  }\n\n  messageIntegrity(key: Buffer) {\n    const checkData = setBodyLength(\n      this.bytes,\n      this.bytes.length - HEADER_LENGTH + INTEGRITY_LENGTH,\n    );\n    return Buffer.from(\n      createHmac(\"sha1\", key).update(checkData).digest(\"hex\"),\n      \"hex\",\n    );\n  }\n\n  addFingerprint() {\n    this.setAttribute(\"FINGERPRINT\", messageFingerprint(this.bytes));\n  }\n}\n\nconst setBodyLength = (data: Buffer, length: number) => {\n  const output = Buffer.alloc(data.length);\n  data.copy(output, 0, 0, 2);\n  output.writeUInt16BE(length, 2);\n  data.copy(output, 4, 4);\n  return output;\n};\n\nfunction messageFingerprint(data: Buffer) {\n  const checkData = setBodyLength(\n    data,\n    data.length - HEADER_LENGTH + FINGERPRINT_LENGTH,\n  );\n  const crc32Buf = crc32(checkData);\n  const xorBuf = Buffer.alloc(4);\n  xorBuf.writeInt32BE(FINGERPRINT_XOR, 0);\n  const fingerprint = bufferXor(crc32Buf, xorBuf);\n  return fingerprint.readUInt32BE(0);\n}\n\nfunction messageIntegrity(data: Buffer, key: Buffer) {\n  const checkData = setBodyLength(\n    data,\n    data.length - HEADER_LENGTH + INTEGRITY_LENGTH,\n  );\n  return Buffer.from(\n    createHmac(\"sha1\", key).update(checkData).digest(\"hex\"),\n    \"hex\",\n  );\n}\n\nexport function paddingLength(length: number) {\n  const rest = length % 4;\n  if (rest === 0) {\n    return 0;\n  } else {\n    return 4 - rest;\n  }\n}\n","module.exports = require(\"fs\");","import { decode, encode, types } from \"@shinyoshiaki/binary-data\";\n\nimport { FragmentedHandshake } from \"../../../record/message/fragment\";\nimport type { Handshake } from \"../../../typings/domain\";\nimport { HandshakeType } from \"../../const\";\n\nexport class ClientKeyExchange implements Handshake {\n  msgType = HandshakeType.client_key_exchange_16;\n  messageSeq?: number;\n\n  static readonly spec = {\n    publicKey: types.buffer(types.uint8),\n  };\n\n  constructor(public publicKey: Buffer) {}\n\n  static createEmpty() {\n    return new ClientKeyExchange(undefined as any);\n  }\n\n  static deSerialize(buf: Buffer) {\n    const res = decode(buf, ClientKeyExchange.spec);\n    return new ClientKeyExchange(\n      //@ts-ignore\n      ...Object.values(res),\n    );\n  }\n\n  serialize() {\n    const res = encode(this, ClientKeyExchange.spec).slice();\n    return Buffer.from(res);\n  }\n\n  toFragment() {\n    const body = this.serialize();\n    return new FragmentedHandshake(\n      this.msgType,\n      body.length,\n      this.messageSeq!,\n      0,\n      body.length,\n      body,\n    );\n  }\n}\n","/*!\n * isobject <https://github.com/jonschlinkert/isobject>\n *\n * Copyright (c) 2014-2017, Jon Schlinkert.\n * Released under the MIT License.\n */\n\n'use strict';\n\nmodule.exports = function isObject(val) {\n  return val != null && typeof val === 'object' && Array.isArray(val) === false;\n};\n","import { jspack } from \"@shinyoshiaki/jspack\";\n\n// This parameter is used by the sender to request the reset of some or\n// all outgoing streams.\n//  0                   1                   2                   3\n//  0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |     Parameter Type = 13       | Parameter Length = 16 + 2 * N |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |           Re-configuration Request Sequence Number            |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |           Re-configuration Response Sequence Number           |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                Sender's Last Assigned TSN                     |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |  Stream Number 1 (optional)   |    Stream Number 2 (optional) |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// /                            ......                             /\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |  Stream Number N-1 (optional) |    Stream Number N (optional) |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\nexport class OutgoingSSNResetRequestParam {\n  static type = 13; // Outgoing SSN Reset Request Parameter\n\n  constructor(\n    public requestSequence: number,\n    public responseSequence: number,\n    public lastTsn: number,\n    public streams: number[],\n  ) {}\n\n  get type() {\n    return OutgoingSSNResetRequestParam.type;\n  }\n\n  get bytes() {\n    const data = Buffer.from(\n      jspack.Pack(\"!LLL\", [\n        this.requestSequence,\n        this.responseSequence,\n        this.lastTsn,\n      ]),\n    );\n\n    return Buffer.concat([\n      data,\n      ...this.streams.map((stream) => Buffer.from(jspack.Pack(\"!H\", [stream]))),\n    ]);\n  }\n\n  static parse(data: Buffer) {\n    const [requestSequence, responseSequence, lastTsn] = jspack.Unpack(\n      \"!LLL\",\n      data,\n    );\n    const stream: number[] = [];\n\n    for (let pos = 12; pos < data.length; pos += 2) {\n      stream.push(jspack.Unpack(\"!H\", data.slice(pos))[0]);\n    }\n\n    return new OutgoingSSNResetRequestParam(\n      requestSequence,\n      responseSequence,\n      lastTsn,\n      stream,\n    );\n  }\n}\n\nexport class StreamAddOutgoingParam {\n  static type = 17; // Add Outgoing Streams Request Parameter\n\n  constructor(\n    public requestSequence: number,\n    public newStreams: number,\n  ) {}\n\n  get type() {\n    return StreamAddOutgoingParam.type;\n  }\n\n  get bytes() {\n    return Buffer.from(\n      jspack.Pack(\"!LHH\", [this.requestSequence, this.newStreams, 0]),\n    );\n  }\n\n  static parse(data: Buffer) {\n    const [requestSequence, newStreams] = jspack.Unpack(\"!LHH\", data);\n    return new StreamAddOutgoingParam(requestSequence, newStreams);\n  }\n}\n\n// This parameter is used by the receiver of a Re-configuration Request\n// Parameter to respond to the request.\n//\n// 0                   1                   2                   3\n// 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |     Parameter Type = 16       |      Parameter Length         |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |         Re-configuration Response Sequence Number             |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                            Result                             |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                   Sender's Next TSN (optional)                |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n// |                  Receiver's Next TSN (optional)               |\n// +-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+\n\nexport const reconfigResult = {\n  ReconfigResultSuccessPerformed: 1,\n  BadSequenceNumber: 5,\n} as const;\ntype ReconfigResult = (typeof reconfigResult)[keyof typeof reconfigResult];\n\nexport class ReconfigResponseParam {\n  static type = 16; // Re-configuration Response Parameter\n  constructor(\n    public responseSequence: number,\n    public result: ReconfigResult,\n  ) {}\n\n  get type() {\n    return ReconfigResponseParam.type;\n  }\n\n  get bytes() {\n    return Buffer.from(\n      jspack.Pack(\"!LL\", [this.responseSequence, this.result]),\n    );\n  }\n\n  static parse(data: Buffer) {\n    const [requestSequence, result] = jspack.Unpack(\"!LL\", data);\n    return new ReconfigResponseParam(requestSequence, result as ReconfigResult);\n  }\n}\n\nexport type StreamParam =\n  | OutgoingSSNResetRequestParam\n  | StreamAddOutgoingParam\n  | ReconfigResponseParam;\n\nexport type StreamParamType =\n  | typeof OutgoingSSNResetRequestParam\n  | typeof StreamAddOutgoingParam\n  | typeof ReconfigResponseParam;\n\nexport const RECONFIG_PARAM_BY_TYPES: { [type: number]: StreamParamType } = {\n  13: OutgoingSSNResetRequestParam, // Outgoing SSN Reset Request Parameter\n  16: ReconfigResponseParam, // Re-configuration Response Parameter\n  17: StreamAddOutgoingParam, // Add Outgoing Streams Request Parameter\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(431);\n"],"names":["isPlainObject","isFunction","value","isObject","module","exports","isType","type","encode","decode","isUserType","isDecodeType","isEncodeType","symbols","Metadata","constructor","this","bytes","node","undefined","current","clone","metadata","meta","clean","jspack","Unpack","randomBytes","a","b","length","TypeError","buffer","Buffer","allocUnsafe","i","arr","sort","reverse","xored","forEach","bits","startIndex","bin","toString","split","Array","fill","s","slice","join","Number","parseInt","dec","map","expectLength","values","createBufferWriter","reduce","acc","cur","buf","alloc","offset","v","size","writeBigUInt64LE","writeUIntLE","read","readBigUInt64BE","readUIntBE","byteOffset","byteLength","bitLength","set","Math","ceil","writeUIntBE","singleBuffer","reuseBuffer","writeBigUInt64BE","_value","Error","value_b","BigInt","size_b","writeInt16BE","writeUInt8","dumpBuffer","data","replace","filter","uint8Array","position","bitsPending","writeBits","bitsConsumed","min","readBits","_readBits","bitBuffer","partial","byte","seekTo","bitPos","publicKey","privateKey","curve","NamedCurveAlgorithm","secp256r1_23","p256PreMasterSecret","x25519_29","from","scalarMult","preMasterSecret","clientRandom","serverRandom","seed","concat","prfPHash","handshakes","sessionHash","hash","label","masterSecret","localRandom","remoteRandom","isClient","prfVerifyData","prfKeyLen","prfIvLen","prfNonceLen","algorithm","secret","keyBlock","stream","createDecode","clientWriteKey","readBuffer","serverWriteKey","clientNonceImplicit","serverNonceImplicit","clientNonce","serverNonce","copy","hmac","createHmac","update","digest","requestedLegth","totalLength","bufs","Ai","output","push","createHash","rtx","payloadType","ssrc","RtpPacket","RtpHeader","marker","header","sequenceNumber","payload","subarray","timestamp","packet","csrc","extensions","Pack","masterKey","masterSalt","profile","srtpSSRCStates","srtcpSSRCStates","diff","srtpSessionKey","generateSessionKey","srtpSessionSalt","generateSessionSalt","srtpSessionAuthTag","generateSessionAuthTag","srtpSessionAuth","srtcpSessionKey","srtcpSessionSalt","srtcpSessionAuthTag","srtcpSessionAuth","ProtectionProfileAes128CmHmacSha1_80","cipher","CipherAesCtr","ProtectionProfileAeadAes128Gcm","CipherAesGcm","sessionKey","labelAndIndexOverKdr","j","block","AES","encrypt","sessionSalt","sessionAuthTag","firstRun","secondRun","getSrtpSsrcState","rolloverCounter","lastSequenceNumber","getSrtcpSsrcState","srtcpIndex","updateRolloverCount","rolloverHasProcessed","MaxROCDisorder","MaxSequenceNumber","generateSrtpAuthTag","roc","rocRaw","writeUInt32BE","index","setIndex","require","equal","keys","isArray","RegExp","source","flags","valueOf","Object","prototype","hasOwnProperty","call","key","decodeCommon","encodeCommon","encodingLengthCommon","condition","result","wstream","context","status","Boolean","skip","rstream","encodingLength","createFunction","createFastStub","write","genread","genwrite","formats","d","toFunction","createFastStubGeneric","doublebe","doublele","floatbe","floatle","int8","uint8","int16be","uint16be","int16le","uint16le","int32be","uint32be","int32le","uint32le","int24be","uint24be","int24le","uint24le","int40be","uint40be","int40le","uint40le","int48be","uint48be","int48le","uint48le","Flight1","Flight","udp","dtls","super","exec","flight","hello","ClientHello","major","minor","DtlsRandom","CipherSuiteList","version","clientVersion","random","packets","createPacket","serialize","transmit","tty","util","init","debug","inspectOpts","log","args","process","stderr","formatWithOptions","formatArgs","namespace","name","useColors","c","color","colorCode","prefix","humanize","hideDate","Date","toISOString","getDate","save","namespaces","env","DEBUG","load","colors","isatty","fd","destroy","deprecate","supportsColor","level","error","test","obj","prop","substring","toLowerCase","_","k","toUpperCase","val","formatters","o","inspect","str","trim","O","streamChunk","naluType","findH264NaluTypeInNalu","chunks","findH265NaluTypeInNalu","options","resolve","container","tcpProtocol","inputArguments","outputArguments","vcodec","acodec","findSyncFrame","streamChunks","prebufferIndex","naluTypes","getStartedH264NaluTypes","has","H264_NAL_TYPE_SPS","H264_NAL_TYPE_IDR","isH265KeyFrameRelatedInSet","getStartedH265NaluTypes","sdp","Promise","r","parse","duplex","width","height","server","RtspServer","handleSetup","rtcp","handleRecord","async","pathToken","url","clientPromise","listenZeroSingleClient","hostname","rtspServerPath","rtspServerPromise","then","client","rtspServer","createServer","checkRequest","method","headers","message","URL","pathname","REQUIRED_WWW_AUTHENTICATE_KEYS","readMessage","currentHeaders","line","readLine","readBody","response","cl","readLength","writeMessage","messageLine","body","console","entries","parseH264NaluType","firstNaluByte","nalu","checkNaluType","H264_NAL_TYPE_STAP_A","pos","naluLength","readUInt16BE","H264_NAL_TYPE_FU_A","fuaType","isFuStart","parseH265NaluType","H265_NAL_TYPE_AGG","Set","getNaluTypesInNalu","fuaRequireStart","fuaRequireEnd","ret","add","stapaType","getNaluTypesInH265Nalu","H265_NAL_TYPE_FU","allowCodecInfo","H265_NAL_TYPE_IDR_N_LP","H265_NAL_TYPE_IDR_W_RADL","H265_NAL_TYPE_CRA_NUT","H265_NAL_TYPE_BLA_N_LP","H265_NAL_TYPE_BLA_W_LP","H265_NAL_TYPE_BLA_W_RADL","H265_NAL_TYPE_VPS","H265_NAL_TYPE_SPS","H265_NAL_TYPE_PPS","parseHeaders","indexOf","getFirstAuthenticateHeader","parseSemicolonDelimited","dict","part","RTSP_FRAME_MAGIC","H264_NAL_TYPE_RESERVED0","H264_NAL_TYPE_RESERVED30","H264_NAL_TYPE_RESERVED31","H264_NAL_TYPE_SEI","H264_NAL_TYPE_PPS","H264_NAL_TYPE_STAP_B","H264_NAL_TYPE_FU_B","H264_NAL_TYPE_MTAP16","H264_NAL_TYPE_MTAP32","H265_NAL_TYPE_SEI_PREFIX","H265_NAL_TYPE_SEI_SUFFIX","RtspStatusError","RtspBase","cseq","needKeepAlive","setupOptions","Map","issuedTeardown","hasGetParameter","u","port","startsWith","connect","rejectUnauthorized","host","on","e","safeTeardown","writeTeardown","sleep","writeRequest","path","fullUrl","includes","contentBase","endsWith","sanitized","username","password","wwwAuthenticate","createAuthorizationHeader","session","handleDataPayload","channel","readUInt8","get","onRtp","readDataPayload","createBadHeader","readLoopLegacy","getParameter","handleStream","unshift","id","readLoop","deferred","Deferred","writeGetParameter","writeOptions","removeListener","h","finished","reject","all","once","BASIC","parseHTTPHeadersQuotedKeyValueSet","authedUrl","decodeURIComponent","computeHash","wwwAuth","strippedUrl","ha1","realm","ha2","nonce","params","uri","request","authenticating","requestTimeout","timeoutPromise","statusLine","codeString","reason","code","publicHeader","describe","Accept","setup","protocol","dgram","createBindZero","closeQuiet","address","assign","Transport","interleaved","sessionDict","timeout","timer","setInterval","clearInterval","transport","match","begin","end","play","start","writePlay","Range","writeRtpPayload","rtp","send","writeUInt16BE","pause","teardown","setupTracks","availableOptions","Socket","setNoDelay","methods","handlePlayback","handleTeardown","destination","track","find","codec","sendUdp","sendTrack","trackId","warn","requestHeaders","respond","get_parameter","setupInterleaved","msection","low","high","control","parseSdp","msections","resolveInterleaved","rtpServer","rtcpServer","createSquentialBindZero","rtpInfo","announce","contentLength","sdpBuffer","record","allow","DtlsClient","DtlsServer","DtlsSocket","_iceControlling","localUsername","randomString","localPassword","remoteIsLite","remotePassword","remoteUsername","checkList","localCandidates","remoteCandidatesEnd","localCandidatesEnd","generation","userHistory","tieBreaker","Int64","Uint64BE","state","_remoteCandidates","nominating","checkListDone","checkListState","PQueue","earlyChecks","earlyChecksDone","localCandidatesStart","protocols","onData","Event","stateChanged","onIceCandidate","queryConsent","queryConsentHandle","cancelable","__","onCancel","failures","canceled","cancelEvent","AbortController","CONSENT_FAILURES","abort","iceControlling","setTimeout","CONSENT_INTERVAL","signal","nominated","buildRequest","nominate","remoteAddr","setState","activePair","sendData","packetsSent","bytesSent","checkStart","pair","toJSON","updateState","CandidatePairState","IN_PROGRESS","localCandidate","ufrag","startTime","performance","now","addr","rtt","totalRoundTripTime","roundTripTimeMeasurements","exc","JSON","stringify","getAttributeValue","attributesKeys","switchRole","awaitable","FAILED","checkComplete","remoteNominated","SUCCEEDED","pairRemoteCandidate","remoteCandidate","tryPair","defaultOptions","stunServer","turnServer","validateAddress","restart","localPasswordPrefix","lookup","close","resetNominatedPair","setRemoteParams","iceLite","usernameFragment","gatherCandidates","getHostAddresses","useIpv4","useIpv6","useLinkLocalAddress","interfaceAddresses","filteredAddresses","check","additionalHostAddresses","candidatePromises","getCandidatePromises","allSettled","appendLocalCandidate","candidate","execute","ensureProtocol","onRequestReceived","subscribe","msg","messageMethod","BINDING","respondError","txUsername","decodeTxUsername","filterStunResponse","Message","classes","RESPONSE","transactionId","setAttribute","addMessageIntegrity","addFingerprint","sendStun","catch","checkIncoming","onDataReceived","packetsReceived","bytesReceived","addresses","localStunPromises","localIp","StunProtocol","connectionMade","isIPv4","portRange","candidateAddress","getExtraInfo","Candidate","candidateFoundation","candidatePriority","pairLocalProtocol","localPromise","l","stunCandidatePromises","protocolPromise","f","serverReflexiveCandidate","clearTimeout","turnUsername","turnPassword","turnCandidatePromise","createStunOverTurnClient","turnTransport","turn","relayedAddress","relatedAddress","mappedAddress","forceTurn","remoteCandidates","sortCheckList","unfreezeInitial","earlyCheck","schedulingChecks","res","ICE_FAILED","handle","ICE_COMPLETED","firstPair","FROZEN","WAITING","seenFoundations","foundation","component","put","addRemoteCandidate","MdnsLookup","validateRemoteCandidate","getDefaultCandidate","candidates","priority","candidatePairs","sortCandidatePairs","findPair","p","list","target","addPair","CandidatePair","canPairWith","filterCandidatePair","encodeTxUsername","REQUEST","errorCode","ERROR","defineProperty","util_1","crypto_1","asn1_1","common_1","pki_1","shortNames","create","CN","getOID","commonName","C","countryName","L","localityName","ST","stateOrProvinceName","organizationName","OU","organizationalUnitName","E","emailAddress","x509CertificateValidator","class","Class","UNIVERSAL","tag","Tag","SEQUENCE","capture","CONTEXT_SPECIFIC","NONE","optional","INTEGER","OID","OCTETSTRING","UTCTIME","GENERALIZEDTIME","publicKeyValidator","BOOLEAN","BITSTRING","DistinguishedName","attributes","uniqueId","getFieldValue","serialName","getHash","hasher","attr","oid","getField","shortName","addField","fillMissingFields","setAttrs","attrs","Certificate","fromPEMs","certs","pems","PEM","pem","procType","ASN1","fromDER","fromPEM","captures","err","validate","raw","DER","certVersion","parseIntegerNum","serialNumber","parseIntegerStr","certSerialNumber","signatureOID","parseOID","certSignatureOID","signatureAlgorithm","getOIDName","infoSignatureOID","certinfoSignatureOID","signature","parseBitString","certSignature","validFrom","parseTime","certValidityNotBefore","validTo","certValidityNotAfter","issuer","RDNAttributesAsArray","certIssuer","certIssuerUniqueId","subject","certSubject","certSubjectUniqueId","subjectKeyIdentifier","authorityKeyIdentifier","ocspServer","issuingCertificateURL","isCA","maxPathLen","basicConstraintsValid","keyUsage","dnsNames","emailAddresses","ipAddresses","uris","certExtensions","exts","mustCompound","ext","certificateExtensionFromAsn1","certificateExtensionsFromAsn1","authorityInfoAccessOcsp","authorityInfoAccessIssuers","altNames","item","dnsName","email","ip","PublicKey","publicKeyInfo","publicKeyRaw","toDER","tbsCertificate","getExtension","checkSignature","child","isIssuer","agl","getHashAgl","verify","parent","equals","verifySubjectKeyIdentifier","getFingerprint","toJSONify","custom","_depth","depth","critical","parseBool","ev","b2","b3","at","digitalSignature","nonRepudiation","keyEncipherment","dataEncipherment","keyAgreement","keyCertSign","cRLSign","encipherOnly","decipherOnly","decodeExtKeyUsage","vals","parseInteger","decodeExtBasicConstraints","decodeExtExtKeyUsage","objsign","reserved","sslCA","emailCA","objCA","decodeExtNsCertType","decodeExtAltName","parseDERWithTemplate","subjectKeyIdentifierValidator","decodeExtSubjectKeyIdentifier","authorityKeyIdentifierValidator","decodeExtAuthorityKeyIdentifier","authorityInfoAccessValidator","decodeExtAuthorityInfoAccess","gn","bytesToIP","rdn","rval","valueTag","ipCodec","buff","v4","v6","sizeOf","familyOf","string","v4Regex","v6Regex","isFormat","Uint8Array","max","n","charCodeAt","hexN","decN","prevColon","useDec","default","dataChannelsOpened","dataChannelsClosed","dataChannels","onDataChannel","createSctpTransport","sctp","RTCSctpTransport","mid","sctpTransport","createDataChannel","settings","ordered","negotiated","maxPacketLifeTime","maxRetransmits","parameters","RTCDataChannelParameters","RTCDataChannel","stateChange","splice","connectSctp","sctpRemotePort","connected","asPromise","setRemoteSCTP","remoteMedia","mLineIndex","sctpPort","setRemotePort","muxId","stop","allUnsubscribe","getStats","getStatsTimestamp","stats","channelStats","generateStatsId","dataChannelIdentifier","readyState","messagesSent","messagesReceived","webpackEmptyContext","req","exit","delayProcessExit","createRTCPeerConnectionSource","nativeId","mixinId","mediaStreamOptions","startRTCSignalingSession","maximumCompatibilityMode","pcClose","finally","createConnection","clientSession","requireOpus","clientOptions","banned","weriftConfiguration","iceFilterCandidatePair","wasBanned","ipv4Ban","isV4Format","cleanup","promise","connection","WebRTCConnectionManagement","pc","waitClosed","dc","serializer","createDataChannelSerializer","rpcPeer","RpcPeer","sendMessage","setupRpcPeer","onmessage","event","connectRPCObject","mediaManager","systemManager","deviceManager","delayWorkerExit","rr","worker","terminate","defaultPeerConfig","headerExtensions","video","audio","WebRTCMixin","SettingsMixinDeviceBase","plugin","storageSettings","StorageSettings","startIntercom","media","webrtcIntercom","mixinDeviceInterfaces","ScryptedInterface","Intercom","mixinDevice","RTCSignalingClient","ScryptedDeviceType","Speaker","SmartSpeaker","RTCSignalingChannel","RTCPeerConnection","atrack","MediaStreamTrack","kind","audioTransceiver","addTransceiver","weriftSignalingSession","WeriftSignalingSession","forwarder","createTrackForwarder","timeStart","videoTransceiver","isLocalNetwork","destinationId","ipv4","requestMediaStream","kill","killPromise","endSession","createRTCSignalingSession","createRTCPeerConnectionSink","getRTCConfiguration","getWeriftConfiguration","stopIntercom","legacyGetSignalingSessionOptions","proxy","device","getDeviceById","hasIntercom","mo","createMediaObject","getVideoStream","ScryptedMimeTypes","RequestMediaStream","sourceId","disableTurn","requiresAnswer","getMixinSettings","getSettings","putMixinSetting","putSetting","createVideoStreamOptions","getRTCMediaStreamOptions","VideoCamera","createTrackedFork","fork","getIntercom","mediaObject","__json_copy_serialize_children","getVideoStreamOptions","WebRTCPlugin","AutoenableMixinProvider","iceInterfaceAddresses","title","description","choices","defaultValue","group","useTurnServer","activeConnections","readonly","onGet","combobox","multiple","debugLog","rtcConfiguration","zygote","createZygote","converters","RTCSignalingSession","RTCConnectionManagement","FFmpegInput","onDevicesChanged","devices","shouldUnshiftMixin","convertToSignalingChannel","fromMimeType","toMimeType","getMixinConsole","convertMediaObjectToJSON","ffmpegInput","isBuffer","createFFmpegMediaObject","intercom","interfaces","audioDirection","OnDemandSignalingChannel","rms","convertToRTCConnectionManagement","configuration","negotiateRTCSignalingSession","waitConnected","convertToFFmpegInput","mediaStreamUrl","convertMedia","canMixin","Settings","Microphone","Camera","Doorbell","Display","SmartDisplay","getMixin","mixinDeviceState","groupKey","mixinProviderNativeId","releaseMixin","release","getCreateDeviceSettings","createDevice","onDeviceDiscovered","getDevice","WebRTCCamera","releaseDevice","iceServers","turnServers","stunServers","weriftStunServers","weriftTurnServers","iceAdditionalHostAddresses","iceUseIpv4","iceUseIpv6","endpointManager","getLocalAddresses","ni","networkInterfaces","flat","la","isV6Only","isV6Format","localHasV6","remoteHasV6","getOptions","createLocalDescription","sendIceCandidate","sdpMid","sdpMLineIndex","offer","createOffer","setLocalDescription","createRawResponse","remoteDescription","answer","createAnswer","setRemoteDescription","addIceCandidate","RTCIceCandidate","Flight6","handleHandshake","handshake","bufferHandshakeCache","msg_type","HandshakeType","certificate_11","deSerialize","fragment","certificate_verify_15","CertificateVerify","client_key_exchange_16","ClientKeyExchange","finished_20","Finished","handler","handlers","msgType","sessionId","lastMessage","messages","sendChangeCipherSpec","sendFinished","changeCipherSpec","ChangeCipherSpec","createEmpty","createPlaintext","ContentType","recordSequenceNumber","cache","sortedHandshakeCache","localVerifyData","verifyData","finish","epoch","encryptPacket","remoteKeyPair","namedCurve","localKeyPair","prfPreMasterSecret","extendedMasterSecret","remoteExtendedMasterSecret","prfExtendedMasterSecret","prfMasterSecret","createCipher","cipherSuite","summary","rp","cacheDuration","t","TimeoutError","isTimedOut","func","debounce","keyStr","delete","rtpTracks","killDeferred","killGuard","old","readUint8","rtspClient","rtspClientHooked","rtspMode","onRtspClient","rtspClientForceTcp","videoCodec","codecCopy","audioCodec","ffmpegPath","getFFmpegPath","isRtsp","rtspSdp","sdpDeferred","videoSectionDeferred","audioSectionDeferred","onMSection","rtpVideoCodec","rtpAudioCodec","allowAudioTranscoderExit","desiredCodec","checkCodec","RtspClient","optionsResponse","parsedSdp","videoSection","alternateCodec","alternateCodecs","section","delivery","createPacketDelivery","setupRtspClient","audioSections","audioSection","negotiate","newSdp","audioSdp","addTrackControls","replaceSectionPort","toSdp","audioControl","firstPacket","adts","clientIsTcp","ffmpegArgs","encoderArguments","safePrintFFmpegArguments","cp","spawn","stdio","ffmpegLogInitialOutput","safeKillFFmpeg","audioPipe","audioClient","ffmpegDestination","srtp","reportTranscodedSections","bind","setRecvBufferSize","createTrackForwarders","useRtp","rtspServerDeferred","URLSearchParams","rtcpPort","packetSize","crytoSuite","attachTrackDgram","useUdp","serverPort","firstVideoPacket","firstAudioPacket","rtspSample","transcodeSdp","nextTick","resolvedSdp","parsed","sdpContents","killed","original","deliver","rtspHeader","sequenceNumbers","red","base","blocks","blockPT","timestampOffset","uint16Add","uint32Add","shift","lifetime","transportType","createTurnClient","StunOverTurnProtocol","DEFAULT_ALLOCATION_LIFETIME","disposer","EventDisposer","handleStunMessage","parseMessage","messageClass","transaction","transactions","transactionIdHex","responseReceived","integrityKey","Transaction","run","dispose","TurnProtocol","channelNumber","channelByAddr","addrByChannel","channelRefreshAt","tcpBuffer","permissionByAddr","creatingPermission","refresh","exp","refreshHandle","delay","REFRESH","requestWithRetry","channelRefreshTime","dataReceived","ALLOCATE","handleChannelData","handleSTUNMessage","datagramReceived","isChannelData","bufferReader","paddingLength","fullLength","closed","padding","createPermission","peerAddress","CREATE_PERMISSION","TransactionFailed","makeIntegrityKey","randomTransactionId","getChannel","getPermission","indicate","SEND","INDICATION","number","channelBinding","int","channelBind","CHANNEL_BIND","UdpTransport","TcpTransport","ServerKeyExchange","ellipticCurveType","publicKeyLength","hashAlgorithm","signatureLength","server_key_exchange_12","spec","encodeBuffer","toFragment","FragmentedHandshake","messageSeq","types","ctx","sessionType","onConnect","onError","onClose","SrtpContext","bufferFragmentedHandshakes","udpOnMessage","parsePacket","parsePlainText","handleFragmentHandshake","assembled","assemble","onHandleHandshakes","applicationData","alert","waitForReady","pkt","DtlsContext","CipherContext","cert","signatureHash","TransportContext","setupExtensions","socket","renegotiation","srtpProfiles","useSrtp","UseSRTP","extension","EllipticCurves","NamedCurveAlgorithmList","Signature","signatures","ExtendedMasterSecret","renegotiationIndication","RenegotiationIndication","fragment_length","last","fragment_offset","extractSessionKeys","keyLength","saltLength","keyingMaterial","exportKeyingMaterial","clientKey","serverKey","clientSalt","serverSalt","SessionType","CLIENT","localKey","localSalt","remoteKey","remoteSalt","isInteger","count","p256Keypair","box","keyPair","secretKey","WeriftError","props","nodeIpAddress","logger","isLinkLocalAddress","info","normalizeFamilyNodeV18","family","costlyNetworks","banNetworks","nic","word","details","isLoopback","localeCompare","flatMap","entry","url2Address","RTCRtpHeaderExtensionParameters","RTP_EXTENSION_URI","sdesMid","sdesRTPStreamID","repairedRtpStreamId","transportWideCC","absSendTime","dependencyDescriptor","audioLevelIndication","videoOrientation","HMAC","_assert_js_1","utils_js_1","Hash","_key","destroyed","ahash","toBytes","iHash","blockLen","outputLen","pad","oHash","aexists","digestInto","out","abytes","_cloneInto","to","getPrototypeOf","Transform","BufferList","NotEnoughDataError","kbuffer","Symbol","BinaryStream","append","consume","encoding","assertSize","writeBuffer","chunk","fixedReadMethods","readDoubleBE","readDoubleLE","readFloatBE","readFloatLE","readInt32BE","readInt32LE","readUInt32BE","readUInt32LE","readInt16BE","readInt16LE","readUInt16LE","readInt8","gen","outputCodecParameters","encoder","sampleRate","getAudioCodec","clockRate","channels","requiredVideoCodec","RTCRtpCodecParameters","mimeType","rtcpFeedback","parameter","optionalVideoCodec","requiredAudioCodecs","opusAudioCodecOnly","profiles","mki","profileLength","fromData","head","CipherAesBase","aeadAuthTagLen","rtpIvWriter","rtcpIvWriter","aadWriter","encryptRtp","hdr","serializeSize","iv","rtpInitializationVector","createCipheriv","setAAD","enc","final","authTag","getAuthTag","decryptRtp","cipherText","dst","growBufferSize","payloadOffset","createDecipheriv","encryptRTCP","rtcpPacket","addPos","srtcpIndexSize","rtcpInitializationVector","aad","rtcpAdditionalAuthenticatedData","decryptRTCP","encrypted","RtcpHeader","aadPos","rtcpEncryptionFlag","ExtensionProfiles","OneByte","TwoByte","paddingSize","csrcLength","extensionProfile","rawPacket","currOffset","v_p_x_cc","getBit","csrcOffset","m_pt","extensionLength","extId","len","extSize","floor","BitWriter","extHeaderPos","startExtensionsPos","extLen","roundedExtSize","trunc","clear","sourcePort","destinationPort","verificationTag","checkSum","expect","chunkType","chunkFlags","chunkLength","chunkBody","ChunkClass","CHUNK_BY_TYPE","padL","checksum","checkSumBuf","writeUInt32LE","Chunk","_body","BaseInitChunk","initiateTag","advertisedRwnd","outboundStreams","inboundStreams","initialTsn","decodeParams","encodeParams","InitChunk","InitAckChunk","ReConfigChunk","ForwardTsnChunk","streams","cumulativeTsn","seq","streamBuffer","DataChunk","tsn","streamId","streamSeqNum","userData","abandoned","acked","misses","retransmit","sentCount","bookSize","CookieEchoChunk","CookieAckChunk","BaseParamsChunk","AbortChunk","ErrorChunk","descriptions","CODE","num","InvalidStreamIdentifier","MissingMandatoryParameter","StaleCookieError","OutofResource","UnresolvableAddress","UnrecognizedChunkType","InvalidMandatoryParameter","UnrecognizedParameters","NoUserData","CookieReceivedWhileShuttingDown","RestartofanAssociationwithNewAddresses","UserInitiatedAbort","ProtocolViolation","HeartbeatChunk","HeartbeatAckChunk","ReconfigChunk","SackChunk","gaps","duplicates","nbGaps","nbDuplicates","gap","gapBuffer","tsnBuffer","ShutdownChunk","ShutdownAckChunk","ShutdownCompleteChunk","CHUNK_CLASSES","m","paramHeader","x","y","queue","wait","ex","complete","typeOrSchema","encodingLengthSchema","schema","findMatchingSRTPProfile","remote","local","flight2","clientHello","curves","signatureHashAlgorithm","srtpProfile","versions","suites","cipherSuites","suite","SignatureAlgorithm","ecdsa_3","CipherSuite","TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256_49195","rsa_1","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256_49199","generateKeyPair","cookie","helloVerifyReq","ServerHelloVerifyRequest","fragments","createFragments","videoArgs","videoFilter","filterName","filterIndex","findIndex","tweetnacl_1","privateKeyValidator","rsaPublicKeyValidator","rsaPrivateKeyValidator","EdDSAPrivateKeyOIDs","publicKeyOID","algo","_pkcs8","_keyRaw","_finalKey","_finalPEM","Seq","Null","BitString","addVerifier","fn","_verifiers","keyRaw","verifier","sum","createVerify","toPEM","toASN1","PrivateKey","privateKeyVersion","privateKeyOID","_publicKeyRaw","parseDER","keypair","sign","fromSeed","addSigner","_signers","signer","createSign","RSAPublicKey","fromPublicKey","_pkcs1","modulus","publicKeyModulus","exponent","publicKeyExponent","toPublicKeyPEM","trimLeadingZeroByte","RSAPrivateKey","fromPrivateKey","publicExponent","privateKeyPublicExponent","privateExponent","privateKeyPrivateExponent","privateKeyModulus","prime1","privateKeyPrime1","prime2","privateKeyPrime2","exponent1","privateKeyExponent1","exponent2","privateKeyExponent2","coefficient","privateKeyCoefficient","toPrivateKeyPEM","hex","detached","ownKeys","__createBinding","k2","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","enumerable","__setModuleDefault","__importStar","getOwnPropertyNames","ar","mod","_1","hasValue","setting","rawGet","getItem","storage","hide","getItemInternal","deviceFilter","onPut","mapPut","mapGet","oldValue","putSettingInternal","noStore","removeItem","setItem","onDeviceEvent","rawDevice","readDefaultValue","parseFloat","isNaN","json","parseValue","persistedDefaultValue","priv","p256","utils","randomPrivateKey","pub","getPublicKey","getSharedSecret","fragmentLength","DtlsPlaintext","plain","recordLayerHeader","contentType","decryptPacket","Alert","AlertDesc","lastFlight","wNAF","constTimeNegate","hasPrecomputes","elm","getW","unsafeLadder","ZERO","_0n","_1n","double","precomputeWindow","W","windows","windowSize","calcWOpts","points","window","precomputes","BASE","mask","maxNumber","shiftBy","wbits","offset1","offset2","abs","cond1","cond2","wNAFUnsafe","curr","negate","getPrecomputes","P","transform","comp","pointPrecomputes","wNAFCached","wNAFCachedUnsafe","prev","setWindowSize","validateW","pointWindowSizes","pippenger","fieldN","scalars","validateMSMPoints","validateMSMScalars","zero","bitLen","MASK","buckets","lastBits","BITS","scalar","resI","sumI","precomputeMSMUnsafe","tableSize","tables","validateBasic","modular_js_1","validateField","Fp","validateObject","Gx","Gy","nBitLength","nByteLength","freeze","nLength","ORDER","neg","isSafeInteger","field","isValid","WeakMap","majorVersion","minorVersion","contentLen","protocolVersion","computeMACHeader","MACHeader","byteSwapIfBE","isLE","isBytes","ArrayBuffer","isView","u8","u32","Uint32Array","createView","DataView","rotr","rotl","byteSwap","byteSwap32","bytesToHex","hexes","hexToBytes","hl","al","array","ai","hi","n1","asciiToBase16","n2","char","asyncLoop","iters","tick","cb","ts","utf8ToBytes","concatBytes","arrays","checkOpts","defaults","opts","wrapConstructor","hashCons","hashC","tmp","wrapConstructorWithOpts","wrapXOFConstructorWithOpts","bytesLength","crypto","getRandomValues","padStart","asciis","_0","_9","A","F","ch","TextEncoder","object","encodeSchema","assertSchema","GenericNack","lost","senderSsrc","mediaSourceSsrc","RtcpTransportLayerFeedbackType","pid","blp","ssrcPair","bufferWriter","fci","headPid","isObjectObject","ctor","prot","toWerift","stun","creds","credential","urls","googleStunServer","SCTP_STATE","WEBRTC_PPID","SCTP","MixinDeviceBase","settingsGroup","settingsGroupKey","onMixinEvent","settingsPromise","mixinSettingsPromise","allSettings","mixinSettings","getDeviceState","ScryptedDeviceBase","pendingClient","__proxy_props","distance","cacheSize","build","Red","redundantPayloads","presentPayload","pop","redundant","Max14Uint","Flight5","server_hello_2","ServerHello","certificate_request_13","ServerCertificateRequest","server_hello_done_14","ServerHelloDone","needCertificate","requestedCertificateTypes","sendCertificate","sendClientKeyExchange","sendCertificateVerify","certificate","localCert","clientKeyExchange","signed","signatureData","signatureScheme","SignatureScheme","ecdsa_secp256r1_sha256","rsa_pkcs1_sha256","certificateVerify","remoteCertificate","certificateList","certificateTypes","requestedSignatureAlgorithms","createTable","polynom","table","crc","createSlicedTable","candidateType","candidateTransport","baseAddress","localPref","typePref","relatedPort","tcptype","fromSdp","kwargs","il","other","rawRtcp","QUOTE","EQUAL","SEPARATOR","KEYVALUE_REGEXP","contents","authorizedKeys","requiredKeys","valuesToNormalize","matches","partPosition","rest","parsedValues","valuePosition","normalizedName","strippedValue","_checkRequiredKeys","buildHTTPHeadersQuotedKeyValueSet","TransactionError","attribute","TransportWideCC","packetChunks","recvDeltas","mediaSsrc","baseSequenceNumber","packetStatusCount","referenceTime","fbPktCount","packetStatusPos","processedPacketNum","iPacketStatus","PacketChunk","TypeTCCRunLengthChunk","packetStatus","RunLengthChunk","packetNumberToProcess","runLength","PacketStatus","TypeTCCPacketReceivedSmallDelta","TypeTCCPacketReceivedLargeDelta","RecvDelta","TypeTCCStatusVectorChunk","StatusVectorChunk","symbolSize","symbolList","recvDeltaPos","delta","constBuf","deltas","packetResults","currentSequenceNumber","results","deltaIdx","currentReceivedAtMs","recvDelta","received","receivedAtMs","BitWriter2","PacketResult","range","writer","parseDelta","BufferSerializer","deserialize","serialized","bufferSerializer","serializationContext","buffers","currentResult","currentFork","getResult","next","done","maxWorkers","cpus","createAsyncQueue","forks","doWork","take","exited","controller","addEventListener","queueFork","submit","v2","dequeue","retransmissions","timeoutDelay","RETRY_RTO","ended","tries","onResponse","retry","cancel","triesMax","TransactionTimeout","RETRY_MAX","Vp9RtpPayload","pDiff","n_g","pgT","pgU","pgP_Diff","parseRtpPayload","iBit","pBit","lBit","fBit","bBit","eBit","vBit","zBit","_7","paddingByte","_8","pictureId","tid","sid","tl0PicIdx","n_s","g","isDetectedFinalPacketInSequence","isKeyframe","isPartitionHead","Flight3","verifyReq","handshakeCache","__exportStar","__importDefault","sdk","fs_1","index_1","DeviceBase","_storage","getDeviceStorage","_log","getDeviceLogger","_console","getDeviceConsole","getMediaObjectConsole","_lazyLoadDeviceState","_deviceState","eventInterface","eventData","_listeners","mixinStorageSuffix","__rpcproxy_traps_all_properties","createDeviceState","mixinStorageKey","getMixinStorage","manageListener","listener","_createGetState","_createSetState","ScryptedInterfaceProperty","loaded","SCRYPTED_SDK_ES_MODULE","SCRYPTED_SDK_MODULE","cjsModule","SCRYPTED_SDK_CJS_MODULE","sdkModule","getScryptedStatic","runtimeAPI","pluginRuntimeAPI","pluginHostAPI","descriptors","ScryptedInterfaceDescriptors","customDescriptors","readFileSync","interfaceDescriptors","setScryptedInterfaceDescriptors","TYPES_VERSION","mdnsInstance","setMaxListeners","answers","query","lookupEval","worker_thread","global","parentPort","postMessage","dnsLookup","thread","Worker","eval","cached","exitListener","exitCode","threadMessageListener","createCurve","curveDef","defHash","weierstrass_js_1","weierstrass","hmac_1","utils_1","msgs","flag","argv","terminatorPosition","createDebug","prevTime","namespacesCache","enabledCache","enableOverride","enabled","self","ms","coerce","format","formatter","apply","selectColor","extend","delimiter","newDebug","matchesTemplate","search","template","searchIndex","templateIndex","starIndex","matchIndex","stack","disable","names","skips","enable","ns","ProtocolVersion","autoIncludeToken","hasEnabledMixin","pluginsComponent","getComponent","listen","eventSource","eventDetails","ScryptedDevice","property","maybeEnableMixin","getSystemState","shouldEnableMixin","checkHasEnabledMixin","mixins","plugins","setMixins","setHasEnabledMixin","RtcpSrPacket","reports","senderInfo","report","RtcpSenderInfo","RtcpReceiverInfo","ntpTimestamp","ntpTime2Sec","rtpTimestamp","packetCount","octetCount","ntp","ntpSec","ntpMsec","HashMD","setBigUint64","Chi","Maj","view","_32n","_u32_max","wh","wl","setUint32","padOffset","dataView","roundClean","aoutput","oview","outLen","stdin","forever","SCRYPTED_FFMPEG_NOISY","filtered","stdout","redactNext","arg","ASN11Cert","noop","callback","arguments","isError","RtcpTransportLayerFeedback","feedback","COUNTER_MAX","congestionScore","_congestionScore","onCongestionScore","availableBitrate","_availableBitrate","onAvailableBitrate","congestion","onCongestion","congestionCounter","cumulativeResult","CumulativeResult","sentInfos","receiveTWCC","elapsedMs","milliTime","firstPacketSentAtMs","reset","wideSeq","addPacket","sendingAtMs","numPackets","sendBitrate","receiveBitrate","maxBonus","Int","bonus","rtpPacketSent","sentInfo","os","toBuffer","sections","v4Buffer","ipv4Regex","ipv6Regex","_normalizeFamily","fromPrefixLen","prefixlen","cidr","cidrString","cidrParts","subnet","networkAddress","toLong","maskBuffer","maskLength","octet","numberOfAddresses","fromLong","firstAddress","lastAddress","broadcastAddress","subnetMask","subnetMaskLength","numHosts","contains","cidrSubnet","not","or","isEqual","isPrivate","ipl","normalizeToLong","isPublic","loopback","parts","NaN","some","lastC","__nwjs","navigator","userAgent","document","documentElement","style","WebkitAppearance","firebug","exception","localStorage","localstorage","warned","NAL_TYPE_STAP_A","NAL_TYPE_FU_A","NAL_TYPE_NON_IDR","NAL_TYPE_IDR","NAL_TYPE_SEI","NAL_TYPE_SPS","NAL_TYPE_PPS","NAL_TYPE_DELIMITER","NAL_HEADER_SIZE","LENGTH_FIELD_SIZE","STAP_A_HEADER_SIZE","depacketizeStapA","lastPos","naluSize","splitH264NaluStartCode","previous","maybeAddSlice","maxPacketSize","codecInfo","jitterBuffer","JitterBuffer","extraPackets","setMaxPacketSize","fuaMax","fuaMin","round","ensureCodecInfo","sps","pps","updateSps","updatePps","updateSei","sei","shouldFilter","nalType","packetizeFuA","noStart","noEnd","fnri","originalNalType","isFuEnd","isFuMiddle","originalNalHeader","fuIndicator","fuHeaderMiddle","fuHeaderStart","fuHeaderEnd","fuHeader","packages","packageSize","packetizeOneStapA","datas","counter","availableSize","stapHeader","packed","packetizeStapA","fuas","flushPendingFuA","pendingFuA","first","hasFuStart","hasFuEnd","getDefragmentedPendingFua","originalFragments","splits","splitNaluType","maybeSendStapACodecInfo","fua","defragmented","createRtpPackets","nalus","hadMarker","packetized","stapa","agg","aggregates","fuaOptions","repacketize","dejittered","repacketizeOne","isNextSequenceNumber","retain","hasSps","hasPps","depacketized","expand_message_xmd","expand_message_xof","hash_to_field","isogenyMap","COEFF","xNum","xDen","yNum","yDen","mul","div","createHasher","Point","mapToCurve","def","hashToCurve","DST","u0","fromAffine","u1","clearCofactor","assertValidity","encodeToCurve","encodeDST","os2ip","bytesToNumberBE","i2osp","anum","strxor","lenInBytes","H","b_in_bytes","r_in_bytes","ell","DST_prime","Z_pad","l_i_b_str","b_0","dkLen","expand","_DST","log2p","len_in_bytes","prb","elm_offset","tv","Flight4","certificateRequest","sendServerHello","sendServerKeyExchange","sendCertificateRequest","sendServerHelloDone","serverHello","generateKeySignature","keyExchange","CurveType","named_curve_3","nextFlight","retransmitCount","RetransmitCount","Extension","ExtensionList","ClientCertificateType","SignatureHashAlgorithm","resolvePromise","iceConnectionState","waitPeerIceConnectionClosed","offerClient","offerSetup","answerClient","answerSetup","offerOptions","answerOptions","disableTrickle","requiresOffer","answerQueue","createCandidateQueue","offerQueue","queueSendCandidate","flush","getUserAgent","isPeerConnectionClosed","createOptions","capabilities","RTCRtpReceiver","getCapabilities","codecs","screen","devicePixelRatio","getPacketsLost","stat","packetsLost","ready","candidateQueue","ls","logSendCandidate","pcDeferred","dcDeferred","micEnabled","setMicrophone","microphone","mic","mediaDevices","getUserMedia","replaceTrack","getTracks","getTransceivers","sender","createPeerConnection","onPeerConnection","connectionState","datachannel","binaryType","getUserMediaSafariHack","direction","camera","addTrack","gatheringPromise","onicecandidate","onicegatheringstatechange","iceGatheringState","toDescription","localDescription","offerToReceiveAudio","offerToReceiveVideo","currentLocalDescription","SrtcpContext","Context","maxSRTCPIndex","sequenceNumberDistance","s1","s2","rolloverDistance","nextSequenceNumber","increment","adjust","maxRtpTimestamp","jitterSize","pending","flushPending","afterSequenceNumber","sd","packetDistance","bindUdp","socketType","attempts","createBindUdp","usePort","createSocket","ListenZeroSingleClientTimeoutError","listenZero","EventTarget","uuid","randomUUID","onReceiveRtp","onReceiveRtcp","onSourceChanged","stopped","muted","emit","writeRtp","tracks","getAudioTracks","getVideoTracks","Reflect","root","globalThis","Function","functionThis","indirectEvalThis","exporter","makeExporter","hasOwn","supportsSymbol","toPrimitiveSymbol","toPrimitive","iteratorSymbol","iterator","supportsCreate","supportsProto","__proto__","downLevel","HashMap","MakeDictionary","functionPrototype","_Map","CreateMapPolyfill","_Set","CreateSetPolyfill","_WeakMap","CreateWeakMapPolyfill","registrySymbol","for","metadataRegistry","GetOrCreateMetadataRegistry","metadataProvider","CreateMetadataProvider","decorate","decorators","propertyKey","IsUndefined","IsArray","IsConstructor","DecorateConstructor","IsObject","IsNull","DecorateProperty","ToPropertyKey","metadataKey","metadataValue","decorator","IsPropertyKey","OrdinaryDefineOwnMetadata","defineMetadata","hasMetadata","OrdinaryHasMetadata","hasOwnMetadata","OrdinaryHasOwnMetadata","getMetadata","OrdinaryGetMetadata","getOwnMetadata","OrdinaryGetOwnMetadata","getMetadataKeys","OrdinaryMetadataKeys","getOwnMetadataKeys","OrdinaryOwnMetadataKeys","deleteMetadata","provider","GetMetadataProvider","OrdinaryDeleteMetadata","decorated","descriptor","MetadataKey","OrdinaryGetPrototypeOf","ToBoolean","MetadataValue","parentKeys","_i","ownKeys_1","_a","parentKeys_1","Type","IsSymbol","ToPrimitive","input","PreferredType","hint","exoticToPrim","GetMethod","OrdinaryToPrimitive","toString_1","IsCallable","toString_2","argument","ToString","SameValueZero","V","GetIterator","IteratorValue","iterResult","IteratorStep","IteratorClose","proto","prototypeProto","CreateMetadataRegistry","fallback","second","CreateFallbackProvider","targetProviderMap","registry","registerProvider","getProvider","setProvider","isExtensible","getProviderNoCache","isProviderFor","providerMap","hasProvider","existingProvider","targetMetadata","GetOrCreateMetadataMap","Create","createdTargetMetadata","metadataMap","nextValue","reflect","metadataOwner","metadataPropertySet","registeredProvider","cacheSentinel","arraySentinel","MapIterator","selector","_index","_keys","_values","_selector","throw","return","_cacheKey","_cacheIndex","_find","getKey","getValue","getEntry","insert","_map","UUID_SIZE","rootKey","CreateUniqueKey","GetOrCreateWeakMapTable","CreateUUID","FillRandomBytes","GenRandomBytes","msCrypto","factory","H264RtpPayload","h264","naluHeader","nri","nalUnitType","nalUnitPayloadType","NalUnitType","stap_a","packaging","stap_aHeaderSize","stap_aNALULengthSize","fu_a","fu","bitStream","BitStream","annex_bNALUStartCode","idrSlice","fu_b","stap_b","mtap16","mtap24","RtcpPayloadSpecificFeedback","FullIntraRequest","PictureLossIndication","ReceiverEstimatedMaxBitrate","AP_HEADER_SIZE","getNalType","isKeyFrame","depacketizeAP","splitH265NaluStartCode","sentMarker","fuMax","fuMin","vps","updateVps","updateSeiPrefix","seiPrefix","updateSeiSuffix","seiSuffix","packetizeFU","layerId","fuNalHeader","packetizeOneAP","apHeader","NAL_TYPE_AP","lengthField","packetizeAP","fus","flushPendingFU","pendingFU","getDefragmentedPendingFu","maybeSendAPCodecInfo","ap","fuOptions","hasVps","_codecs","dtlsTransport","receiver","_direction","onTrack","usedForSender","stopping","setDtlsTransport","setDirection","SenderDirections","_currentDirection","currentDirection","setCurrentDirection","msid","getPayloadType","getCodecStats","transportId","codecStats","sdpFmtpLine","Inactive","Sendonly","Recvonly","Sendrecv","Directions","running","failed","task","iceGather","renominating","onStateChange","onNegotiationNeeded","candidateToIce","role","gatheringState","localParameters","gather","remoteParameters","renomination","waitStart","candidateStats","ice","candidateFromIce","pairs","pairStats","localCandidateId","remoteCandidateId","currentRoundTripTime","IceTransportStates","IceGathererStates","IceCandidate","tcpType","onGatheringStateChange","Connection","RTCIceParameters","isThis","candidateToSdp","fromJSON","candidateFromSdp","notImplemented","bitMask","abool","numberToHexUnpadded","hexToNumber","bytesToNumberLE","numberToBytesBE","numberToBytesLE","numberToVarBytesBE","ensureBytes","expectedLength","equalBytes","inRange","aInRange","bitGet","bitSet","createHmacDrbg","hashLen","qByteLen","hmacFn","u8n","reseed","u8fr","sl","pred","validators","optValidators","checkField","fieldName","isOptional","checkVal","validatorFns","String","memoized","computed","_2n","isPosBig","bigint","function","boolean","stringOrUint8Array","whenTypes","when","probalyValue","secp256r1","sha256_1","_shortw_utils_js_1","hash_to_curve_js_1","Fp256","Field","CURVE_A","CURVE_B","lowS","sha256","mapSWU","mapToCurveSimpleSWU","B","Z","htf","ProjectivePoint","getObjectSummary","trackOrKind","rtxSsrc","onReady","onRtcp","onPictureLossIndication","onGenericNack","senderBWE","SenderBandwidthEstimator","rtxSequenceNumber","random16","_redDistance","redEncoder","RedEncoder","receiverEstimatedMaxBitrate","seqOffset","rtpCache","dtlsDisposer","rtcpRunning","rtcpCancel","registerTrack","unSubscribe","redDistance","prepareSend","cname","rtpStreamId","codecParams","codecParametersFromString","rtxPayloadType","redRedundantPayloadType","disposeTrack","sendRtp","replaceRTP","rid","runRtcp","lastSRtimestamp","compactNtp","lastSentSRTimestamp","timestampSeconds","RtcpSourceDescriptionPacket","SourceDescriptionChunk","items","SourceDescriptionItem","text","sendRtcp","discontinuity","ntpTime","originalHeaderExtensions","serializeSdesMid","serializeSdesRTPStreamID","serializeRepairedRtpStreamId","transportSequenceNumber","serializeTransportWideCC","serializeAbsSendTime","exist","rtpPayload","millitime","sentAtMs","handleRtcpPacket","RtcpRrPacket","lsr","dlsr","seqNum","wrapRtx","bitrate","getParameters","encodings","setParameters","outboundRtpStats","codecId","mediaSourceStats","trackIdentifier","remoteInboundStats","localId","roundTripTime","HashAlgorithm","sha256_4","RTCP_HEADER_SIZE","v_p_rc","packAddress","IPV4_PROTOCOL","IPV6_PROTOCOL","unpackErrorCode","unpackAddress","cookieBuffer","xorAddress","xPad","xData","unpackXorAddress","packErrorCode","packXorAddress","COOKIE","packUnsigned","unpackUnsigned","packUnsigned64","Int64BE","unpackUnsigned64","packString","unpackString","packBytes","unpackBytes","ATTRIBUTES","getAttributes","ATTRIBUTES_BY_TYPE","ATTRIBUTES_BY_NAME","origin","msidSemantic","GroupDescription","param","divide","FMTP_INT_PARAMETERS","joint","SessionDescription","time","extMapAllowMixed","dtlsFingerprints","sessionLines","mediaGroups","lines","groupLines","ipAddressFromSdp","parseAttr","fingerprint","RTCDtlsFingerprint","iceOptions","icePassword","iceUsernameFragment","parseGroup","dtlsRole","DTLS_SETUP_ROLE","bundle","semantic","mediaLines","fmt","fmtInt","currentMedia","MediaDescription","dtlsParams","RTCDtlsParameters","iceParams","iceCandidates","iceCandidatesComplete","extUri","fingerprints","sctpCapabilities","RTCSctpCapabilities","rtcpHost","rtcpMux","formatId","formatDesc","clock","sctpMap","ssrcStr","ssrcDesc","ssrcAttr","ssrcValue","ssrcInfo","SsrcDescription","SSRC_INFO_ATTRS","ssrcGroup","simulcastParameters","RTCRtpSimulcastParameters","pt","feedbackType","feedbackParam","RTCRtcpFeedback","webrtcTrackId","ipAddressToSdp","RTCSessionDescription","DTLS_ROLE_SETUP","maxMessageSize","recv","dest","checkArray","checkArraySizeType","checkArraySize","requiredSize","havingSize","lengthType","isLengthInBytes","isnum","istype","isfunc","expectedSize","lengthContext","lengthBytes","before","decodeBytes","decodeCount","OpusRtpPayload","opus","createCodecPrivate","samplingFrequency","bufferWriterLE","nacl","gf","Float64Array","randombytes","gf0","gf1","_121665","D","D2","X","Y","I","ts64","vn","xi","yi","crypto_verify_16","crypto_verify_32","crypto_core_salsa20","inp","j0","j1","j2","j3","j4","j5","j6","j7","j8","j9","j10","j11","j12","j13","j14","j15","x0","x1","x2","x3","x4","x5","x6","x7","x8","x9","x10","x11","x12","x13","x14","x15","core_salsa20","crypto_core_hsalsa20","core_hsalsa20","sigma","crypto_stream_salsa20_xor","cpos","mpos","z","crypto_stream_salsa20","crypto_stream","sn","crypto_stream_xor","poly1305","t0","t1","t2","t3","t4","t5","t6","t7","Uint16Array","leftover","fin","crypto_onetimeauth","outpos","crypto_onetimeauth_verify","hpos","crypto_secretbox","crypto_secretbox_open","set25519","car25519","sel25519","q","pack25519","neq25519","par25519","unpack25519","M","t8","t9","t10","t11","t12","t13","t14","t15","t16","t17","t18","t19","t20","t21","t22","t23","t24","t25","t26","t27","t28","t29","t30","b0","b1","b4","b5","b6","b7","b8","b9","b10","b11","b12","b13","b14","b15","S","inv25519","pow2523","crypto_scalarmult","x32","x16","crypto_scalarmult_base","crypto_box_keypair","crypto_box_beforenm","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","hibit","h0","h1","h2","h3","h4","h5","h6","h7","h8","h9","r0","r1","r2","r3","r4","r5","r6","r7","r8","r9","mac","macpos","want","crypto_box_afternm","crypto_box_open_afternm","K","crypto_hashblocks_hl","hh","bh0","bh1","bh2","bh3","bh4","bh5","bh6","bh7","bl0","bl1","bl2","bl3","bl4","bl5","bl6","bl7","th","tl","Int32Array","ah0","ah1","ah2","ah3","ah4","ah5","ah6","ah7","al0","al1","al2","al3","al4","al5","al6","al7","crypto_hash","cswap","pack","tx","ty","zi","scalarmult","scalarbase","crypto_sign_keypair","pk","sk","seeded","modL","carry","crypto_sign","sm","smlen","crypto_sign_open","chk","den","den2","den4","den6","unpackneg","crypto_secretbox_BOXZEROBYTES","crypto_sign_BYTES","crypto_sign_PUBLICKEYBYTES","crypto_sign_SECRETKEYBYTES","checkLengths","checkArrayTypes","lowlevel","crypto_box","crypto_box_open","crypto_secretbox_KEYBYTES","crypto_secretbox_NONCEBYTES","crypto_secretbox_ZEROBYTES","crypto_scalarmult_BYTES","crypto_scalarmult_SCALARBYTES","crypto_box_PUBLICKEYBYTES","crypto_box_SECRETKEYBYTES","crypto_box_BEFORENMBYTES","crypto_box_NONCEBYTES","crypto_box_ZEROBYTES","crypto_box_BOXZEROBYTES","crypto_sign_SEEDBYTES","crypto_hash_BYTES","secretbox","open","nonceLength","overheadLength","scalarLength","groupElementLength","checkBoxLengths","after","fromSecretKey","secretKeyLength","sharedKeyLength","signedMsg","mlen","sig","seedLength","hashLength","setPRNG","validParts","RTCStatsReport","mux","browser","nc","webcrypto","FINGERPRINT_LENGTH","FINGERPRINT_XOR","HEADER_LENGTH","INTEGRITY_LENGTH","AttributeKeys","el","bBE","_DeArray","_EnArray","_DeChar","fromCharCode","_EnChar","_DeInt","rv","lsb","nsb","bSigned","pow","_EnInt","_DeString","_EnString","_De754","nBits","mLen","eLen","eBias","eMax","Infinity","_En754","LN2","rt","_DeInt64","rvi","_EnInt64","_sPattern","_lenLut","_elLut","en","de","_UnpackSeries","fxn","_PackSeries","charAt","re","PackTo","CalcLength","statePromise","isPeerIceConnectionClosed","connectionStateChange","iceConnectionStateChange","connectPromise","iceConnectPromise","any","iceGatheringStateChange","signalingStateChange","signalingState","isLocalIceTransport","additionalPrivate","iceTransports","sameNetwork","localAddress","nif","glow","firstByte","trackCount","findTrackByType","directions","getSections","returnTrack","controlString","dir","parseMLinePayloadTypes","mline","payloadTypes","parseMLine","audioPort","videoPort","regex","outputSdp","fmtpPrefix","fmtp","parseMSection","spspps","afmtp","parseFmtp","fmtpLine","firstSpace","paramLine","parseRtpMap","rtpmap","mlineType","ffmpegEncoder","rawCodec","acontrol","artpmap","rawRtpmaps","rtpmaps","checkDirection","pemStart","pemEnd","pemEndOfLine","getHeader","setHeader","rVal","compressionMethods","client_hello_1","selfName","peerName","readable","createRpcDuplexSerializer","onDisconnected","queuePending","hadPending","remaining","chunkSize","chunkData","createRpcSerializer","sendMessageBuffer","sendMessageFinish","pendingSerializationContext","peer","addSerializer","SidebandBufferSerializer","constructorSerializerMap","onMessageBuffer","onMessageFinish","messageSerializationContext","handleMessage","createSocketSend","socketSend","need","sub","klass","toClass","encodeNullString","writeInt8","decodeNullString","bytesWithNull","encodeFixedString","decodeFixedString","encodeSizePrefixedString","decodeSizePrefixedString","encodingLengthSizePrefixedString","encodeCallback","checkLengthType","checkLength","decodeCallback","isEncoding","fir","ssrcs","bytesFromIP","x509_1","generator","enqueue","EndError","endDeferred","waiting","queued","dequeued","qi","removeEventListener","endPromise","pipe","RTCDtlsTransport","config","iceTransport","localCertificate","srtpStarted","dataReceiver","outboundPacketLoss","getFingerprints","SetupCertificate","localCertificatePromise","certPem","keyPem","createSelfSignedCertificateWithKey","RTCCertificate","createIceTransport","inboundPacketLoss","startSrtp","updateSrtpSession","localMasterKey","localMasterSalt","remoteMasterKey","remoteMasterSalt","SrtpSession","srtcp","SrtcpSession","isMedia","isRtcp","decrypt","rtcpPackets","RtcpPacketConverter","transportStats","dtlsState","iceState","selectedCandidatePairId","localCertificateId","remoteCertificateId","certStats","fingerprintAlgorithm","base64Certificate","iceStats","DtlsStates","privateKeyPem","IceTransport","isDtls","newEstSeqNum","_lost","onPacketLost","retryCount","sendNack","lostSeqNumbers","nack","rtcpSsrc","updateRetryCount","getLost","setLost","nackLoop","removeLost","pruneLost","UNDEFINED","BUFFER","UINT8ARRAY","ARRAYBUFFER","BIT32","bigendian","unsigned","posH","posL","pos0","pos1","pos2","pos3","fromPositive","fromPositiveBE","fromPositiveLE","fromNegative","fromNegativeBE","fromNegativeLE","isName","_isInt64","toNumber","radix","readInt32","toArray","toArrayBuffer","raddix","that","newArray","isValidBuffer","chr","writeInt32","fromString","fromArray","arrbuf","destbuf","destoff","srcbuf","srcoff","nodeName","isNegativeLE","pow2","power","modulo","invert","tonelliShanks","FpSqrt","FIELD_FIELDS","BYTES","FpPow","FpInvertBatch","FpDiv","lhs","rhs","inv","FpLegendre","FpIsSquare","legendre","eql","ONE","redef","sqrtP","is0","isOdd","sqr","sqrN","addN","subN","mulN","sqrt","invertBatch","lst","cmov","fromBytes","FpSqrtOdd","FpSqrtEven","hashToPrivateScalar","groupOrder","minLen","getFieldBytesLength","getMinHashLength","mapHashToField","fieldOrder","fieldLen","reduced","_3n","_4n","_5n","_8n","legendreC","Q","p1div4","Q1div2","ge","c1","nv","nums","lastMultiplied","inverted","reduceRight","order","legendreConst","_nBitLength","anumber","lengths","instance","checkFinished","fractionLost","highestSequence","jitter","SignalingStates","ConnectionStates","BufferVisitor","walk","steps","mustHas","requested","available","mustWalk","checkBuffer","isNull","promiseStack","eventId","onerror","onended","queuingSubscribe","off","watch","timeLimit","returnTrigger","returnListener","_disposer","AEADCipher","ivLength","authTagLength","nonceImplicitLength","nonceExplicitLength","prfEncryptionKeys","writeKey","explicitNonce","additionalBuffer","encodeAdditionalBuffer","blockAlgorithm","plaintextLength","headPart","finalPart","dataLength","writeUintBE","decipher","setAuthTag","Profiles","TLS_RSA_WITH_AES_128_GCM_SHA256","createAEADCipher","RSA_KEY_EXCHANGE","AEAD_AES_128_GCM","TLS_RSA_WITH_AES_256_GCM_SHA384","AEAD_AES_256_GCM","TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256","ECDHE_RSA_KEY_EXCHANGE","TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384","TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256","ECDHE_ECDSA_KEY_EXCHANGE","TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384","TLS_PSK_WITH_AES_128_GCM_SHA256","PSK_KEY_EXCHANGE","TLS_PSK_WITH_AES_256_GCM_SHA384","TLS_ECDHE_PSK_WITH_AES_128_GCM_SHA256","ECDHE_PSK_KEY_EXCHANGE","TLS_ECDHE_PSK_WITH_AES_256_GCM_SHA384","TLS_ECDHE_PSK_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305_SHA256","TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305_SHA256","TLS_PSK_WITH_CHACHA20_POLY1305_SHA256","K_LEN","N_MIN","N_MAX","P_MAX","A_MAX","C_MAX","createRSAKeyExchange","createECDHERSAKeyExchange","createECDHEECDSAKeyExchange","createPSKKeyExchange","createECDHEPSKKeyExchange","kx","constants","sessionControl","peerConnection","ignoreDeferred","sc","ignorePromise","audioTrack","videoTrack","doSetup","bundlePolicy","getWeriftIceServers","logConnectionState","remoteIsBundled","waitIceConnected","logIsLocalIceTransport","ensurePeerConnection","gotAudio","gotVideo","setupAudioTranscevier","transciever","setupVideoTransceiver","transceiver","firSequenceNumber","pictureLossInterval","sendRtcpPLI","onTransceiverAdded","handleRtspSetup","createSdpInput","destroyProcess","ic","isPeerConnectionAlive","lastPacketTs","startRtpForwarderProcess","getFFmpegRtpAudioOutputArguments","setPlayback","MediaStreamUrl","tool","transceiverManager","sctpManager","setupCertificate","dtlsTransports","createTransport","existing","iceGatherer","RTCIceGatherer","parseIceServers","iceTransportPolicy","icePortRange","iceFilterStunResponse","icePasswordPrefix","forceTurnTCP","iceUseLinkLocalAddress","updateIceGatheringState","RTCIceTransport","updateIceConnectionState","handleNewIceCandidate","candidateMessage","getTransportByMid","getTransportByMLineIndex","restartIce","setLocalRole","allMatch","newState","anyMatch","setConnectionState","ensureCerts","SRTP_PROFILE","SRTP_AEAD_AES_128_GCM","SRTP_AES128_CM_HMAC_SHA1_80","crc32By8","CRC32C_LOOKUP","bool","numbers","select","kschema","createEncodeStream","readableObjectMode","writableObjectMode","transformEncode","createDecodeStream","bufOrSchema","transformDecode","commit","createEncode","DATA_CHANNEL_ACK","DATA_CHANNEL_OPEN","DATA_CHANNEL_RELIABLE","DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT","DATA_CHANNEL_PARTIAL_RELIABLE_TIMED","DATA_CHANNEL_RELIABLE_UNORDERED","DATA_CHANNEL_PARTIAL_RELIABLE_REXMIT_UNORDERED","DATA_CHANNEL_PARTIAL_RELIABLE_TIMED_UNORDERED","WEBRTC_DCEP","WEBRTC_STRING","WEBRTC_BINARY","WEBRTC_STRING_EMPTY","WEBRTC_BINARY_EMPTY","DISCARD_HOST","DISCARD_PORT","MEDIA_KINDS","DIRECTIONS","auto","ReceiverDirection","authorities","DERErr","weierstrassPoints","CURVE","curve_js_1","ut","bits2int","bits2int_modN","validateOpts","CURVE_ORDER","compressedLen","uncompressedLen","modN","invN","normPrivateKeyToScalar","weierstrassEquation","isWithinCurveOrder","_c","point","isCompressed","toAffine","cat","hasEvenY","tail","y2","sqrtError","suffix","numToNByteStr","isBiggerThanHalfOrder","slcNum","recovery","fromCompact","toSig","addRecoveryBit","recoverPublicKey","msgHash","rec","radj","R","fromHex","ir","u2","multiplyAndAddUnsafe","hasHighS","normalizeS","toDERRawBytes","toDERHex","hexFromSig","toCompactRawBytes","toCompactHex","isValidPrivateKey","precompute","_setWindowSize","multiply","isProbPub","ORDER_MASK","int2octets","prepSig","defaultSigOpts","prehash","extraEntropy","ent","validateSigVerOpts","h1int","seedArgs","k2sig","kBytes","ik","normS","defaultVerOpts","toRawBytes","privateA","publicB","privKey","drbg","sg","isHex","isObj","_sig","derError","Err","is","SWUFpSqrtRatio","sqrtRatio","tv1","tv2","tv3","tv4","tv5","tv6","e1","b2n","h2b","_tlv","dataLen","lenLen","_int","tlv","seqBytes","seqLeftBytes","rBytes","rLeftBytes","sBytes","sLeftBytes","allowedPrivateKeyLengths","wrapPrivateKey","isTorsionFree","allowInfinityPoint","endo","beta","splitScalar","validatePointOpts","Fn","_isCompressed","N","assertPrjPoint","toAffineMemo","iz","px","py","pz","ax","ay","zz","assertValidMemo","left","right","normalizeZ","toInv","msm","wnaf","X1","Y1","Z1","X2","Y2","Z2","U1","U2","X3","Y3","Z3","subtract","multiplyUnsafe","k1neg","k1","k2neg","k1p","k2p","fake","f1p","f2p","G","cofactor","toHex","_bits","_2n_pow_c1_1","_2n_pow_c1","c2","c3","c4","c5","c6","c7","isQR","tvv5","y1","LinkedList","isEmpty","leaf","offsetStart","offsetEnd","ContextCls","localContext","remoteContext","frameFragmentBuffer","basicCodecParser","Depacketizer","partitions","sequence","AV1RtpPayload","getFrame","Vp8RtpPayload","depacketizerCodecs","isProperty","INDENT_START","INDENT_END","RESERVED","RESERVED_MAP","genfun","indent","vars","spaces","pushLine","scope","sym","isVariable","src","bundled","dataChannelQueue","eventDisposer","datachannelReceive","ppId","channelType","reliability","labelLength","protocolLength","isCreatedByRemote","setReadyState","dataChannelFlush","onMessage","datachannelSend","addBufferedAmount","associationState","ESTABLISHED","BridgeDtls","onReceive","onReconfigStreams","ids","CLOSED","onSackReceived","isServer","channelByLabel","dataChannelAddNegotiated","dataChannelOpen","outboundQueue","dataChannelId","setId","expiry","remotePort","dataChannelClose","reconfigQueue","transmitReconfigRequest","queueItem","getPadding","cycles","packets_received","jitter_q4","expected_prior","received_prior","inOrder","max_seq","uint16Gt","base_seq","arrival","last_timestamp","last_arrival","fraction_lost","expected_interval","packets_expected","received_interval","lost_interval","packets_lost","checkInt","checkInts","arrayish","coerceArray","createArray","copyArray","sourceArray","targetArray","targetStart","sourceStart","sourceEnd","Hex","convertUtf8","encodeURI","substr","convertHex","numberOfRounds","rcon","Si","T1","T2","T3","T4","T5","T6","T7","T8","U3","U4","convertToInt32","_prepare","rounds","_Ke","_Kd","roundKeyCount","KC","tk","tt","rconpointer","plaintext","ciphertext","ModeOfOperationECB","_aes","ModeOfOperationCBC","_lastCipherblock","ModeOfOperationCFB","segmentSize","_shiftRegister","xorSegment","ModeOfOperationOFB","_lastPrecipher","_lastPrecipherIndex","Counter","initialValue","_counter","setValue","setBytes","MAX_SAFE_INTEGER","ModeOfOperationCTR","_remainingCounter","_remainingCounterIndex","aesjs","ModeOfOperation","ecb","cbc","cfb","ofb","ctr","utf8","pkcs7","padder","strip","_arrayTest","message_seq","maxFragmentLength","combined","findAllFragments","reference","random32","elapsed","between","getDefaultExportFromCjs","CRC_TABLE","ensureBuffer","_crc32","crc32","writeInt32BE","bufferizeInt","toType","AUTHORIZED_WWW_AUTHENTICATE_KEYS","parseWWWAuthenticateRest","buildWWWAuthenticateRest","parseAuthorizationRest","decodeHash","buildAuthorizationRest","passwordParts","REQUIRED_AUTHORIZATION_KEYS","YError","wrappedErrors","captureStackTrace","wrap","wrappedErrorIsACode","_looksLikeAYErrorCode","cast","_looksLikeAYError","bump","randomPort","setImmediate","interfaceAddress","router","transceivers","onRemoteTransceiverAdded","getSenders","getReceivers","getTransceiverByMLineIndex","pushTransceiver","replaceTransceiver","RTCRtpSender","newTransceiver","RTCRtpTransceiver","registerRtpSender","inactiveTransceiverIndex","inactiveTransceiver","emptyTrackSenderTransceiver","notSendTransceiver","removeTrack","assignTransceiverCodecs","codecCandidate","getLocalRtpParams","getRemoteRtpParams","apt","RTCRtpRtxParameters","RTCRtpCodingParameters","setRemoteRTP","remoteCodec","localCodecs","existCodec","findCodecByMimeType","mediaDirection","reverseDirection","offerDirection","localParams","remotePrams","registerRtpReceiverByRid","prepareReceive","registerRtpReceiverBySsrc","remoteStreamId","remoteTrackId","MediaStream","setupTWCC","includeTransceiverStats","senderStats","receiverStats","handleHandshakes","hello_verify_request_3","flight5","targets","checkHandshakesExist","x509","cryptoProvider","parseX509","prfVerifyDataClient","prfVerifyDataServer","localPrivateKey","SERVER","valueKeySignature","sec","serverParams","namedCurveAlgorithm","signatureAlgorithmName","alg","modulusLength","subtle","generateKey","X509CertificateGenerator","createSelfSigned","notBefore","notAfter","signingAlgorithm","PemConverter","exportKey","useFIR","useNACK","usePLI","useREMB","useTWCC","transactionsKeys","BufferSourceConverter","isArrayBuffer","toUint8Array","toView","isArrayBufferView","isBufferSource","aView","bView","STRING_TYPE","HEX_REGEX","BASE64_REGEX","BASE64URL_REGEX","Utf8Converter","unescape","encodeURIComponent","uintArray","encodedString","escape","Utf16Converter","littleEndian","arrayBuffer","getUint16","setUint16","Convert","isBase64","isBase64Url","ToUtf8String","ToBinary","ToHex","ToBase64","ToBase64Url","FromString","FromUtf8String","FromBinary","FromHex","FromBase64","FromBase64Url","btoa","binary","base64","formatted","formatString","atob","base64url","Base64Padding","DEFAULT_UTF8_ENCODING","stringLength","resultView","hexString","ToUtf16String","FromUtf16String","padCount","bytes1","bytes2","utilFromBase","inputBuffer","inputBase","utilToBase","internalReserved","internalValue","biggest","retBuf","retView","basis","utilConcatView","views","outputLength","prevLength","utilDecodeTC","valueHex","condition1","condition2","warnings","bigIntBuffer","bigIntView","bigInt","smallIntBuffer","smallIntView","padNumber","inputNumber","dif","assertBigInt","baseBlock","inputOffset","inputLength","ViewWriter","powers2","digitsString","NAME","VALUE_HEX_VIEW","IS_HEX_ONLY","ID_BLOCK","TAG_CLASS","TAG_NUMBER","IS_CONSTRUCTED","FROM_BER","TO_BER","LOCAL","EMPTY_STRING","EMPTY_BUFFER","EMPTY_VIEW","END_OF_CONTENT_NAME","OCTET_STRING_NAME","BIT_STRING_NAME","HexBlock","BaseClass","isHexOnly","valueHexView","fromBER","endLength","blockLength","toBER","sizeOnly","LocalBaseBlock","valueBeforeDecode","valueBeforeDecodeView","blockName","ValueBlock","LocalIdentificationBlock","idBlock","_b","_d","tagClass","tagNumber","isConstructed","firstOctet","encodedBuf","encodedView","curView","inputView","intBuffer","tagNumberMask","intTagNumberBuffer","tagNumberBufferMaxLength","tempBufferView","LocalLengthBlock","lenBlock","isIndefiniteForm","longFormUsed","lenOffset","lengthBufferView","typeStore","BaseBlock","primitiveSchema","valueBlockType","valueBlock","resultOffset","_writer","prepareIndefiniteForm","idBlockBuf","valueBlockBuf","lenBlockBuf","onAsciiEncoding","inputBuffer1","inputBuffer2","view1","view2","Constructed","BaseStringBlock","stringValueBlockType","fromBuffer","LocalPrimitiveValueBlock","_a$w","_a$v","_a$u","_a$t","_a$s","_a$r","_a$q","_a$p","_a$o","_a$n","_a$m","_a$l","_a$k","_a$j","_a$i","_a$h","_a$g","_a$f","_a$e","_a$d","_a$c","_a$b","_a$a","_a$9","_a$8","_a$7","_a$6","_a$5","_a$4","_a$3","_a$2","_a$1","AsnPropTypes","Primitive","localFromBER","incomingOffset","returnObject","newASN1Type","EndOfContent","Integer","OctetString","ObjectIdentifier","Enumerated","Utf8String","RelativeObjectIdentifier","TIME","Sequence","NumericString","PrintableString","TeletexString","VideotexString","IA5String","UTCTime","GeneralizedTime","GraphicString","VisibleString","GeneralString","UniversalString","CharacterString","BmpString","DATE","TimeOfDay","DateTime","Duration","newObject","inputObject","newType","localChangeType","LocalConstructedValueBlock","currentOffset","indefiniteLength","LocalEndOfContentValueBlock","override","LocalBooleanValueBlock","LocalOctetStringValueBlock","currentBlockName","asn","content","LocalBitStringValueBlock","unusedBits","bitsStr","viewAdd","firstView","secondView","firstViewCopy","firstViewCopyLength","secondViewCopy","secondViewCopyLength","power2","digits","newValue","viewSub","LocalIntegerValueBlock","_valueDec","setValueHex","valueDec","modValue","tempBuf","tempView","updatedView","firstBit","currentByte","bitNumber","asn1View","byteNumber","toBigInt","fromBigInt","bigIntValue","secondInt","convertToDER","integer","convertFromDER","LocalSidValueBlock","isFirstSid","valueBigInt","sidValue","LocalObjectIdentifierValueBlock","sidBlock","retBuffers","valueBuf","plus","parsedSID","sidStr","sidArray","LocalRelativeSidValueBlock","LocalRelativeObjectIdentifierValueBlock","LocalStringValueBlock","LocalSimpleStringValueBlock","LocalSimpleStringBlock","inputString","strLen","LocalUtf8StringValueBlock","LocalBmpStringValueBlock","LocalUniversalStringValueBlock","copyBuffer","valueView","strLength","codeBuf","codeView","valueDate","year","month","day","hour","minute","fromDate","inputDate","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","toDate","UTC","parserArray","outputArray","millisecond","getUTCMilliseconds","parser","isUTC","timeString","dateTimeString","fractionPart","hourDifference","minuteDifference","multiplier","differencePosition","differenceString","fractionPointPosition","fractionPartCheck","fractionResult","tempDate","getUTCDay","Any","Choice","Repeated","RawData","compareSchema","inputData","inputSchema","verified","_result","encodedId","schemaView","admission","maxLength","_optional","arrayRoot","asn1","verifySchema","AsnTypeTypes","fromNumber","fromASN","toASN","toSchema","octetSize","octets","AsnAnyConverter","AsnIntegerConverter","AsnEnumeratedConverter","AsnIntegerArrayBufferConverter","AsnBitStringConverter","AsnObjectIdentifierConverter","AsnBooleanConverter","AsnOctetStringConverter","AsnConstructedOctetStringConverter","createStringConverter","Asn1Type","AsnUtf8StringConverter","AsnBmpStringConverter","AsnUniversalStringConverter","AsnNumericStringConverter","AsnPrintableStringConverter","AsnTeletexStringConverter","AsnVideotexStringConverter","AsnIA5StringConverter","AsnGraphicStringConverter","AsnVisibleStringConverter","AsnGeneralStringConverter","AsnCharacterStringConverter","AsnUTCTimeConverter","AsnGeneralizedTimeConverter","AsnNullConverter","isConvertible","isTypeOfArray","isArrayEqual","schemaStorage","checkSchema","createDefault","parentSchema","findParentSchema","useNames","asn1Value","asn1Item","Asn1TypeName","repeated","implicit","Container","isRepeated","AsnType","AsnProp","copyOptions","converter","defaultConverter","AsnSchemaValidationError","schemas","AsnParser","asn1Parsed","asn1Schema","targetSchema","asn1ComparedSchema","itemType","element","asn1SchemaValue","schemaItem","schemaItemType","newItem","newItemAsn","AsnSerializer","asnSchema","toAsnItem","objProp","AsnArray","AsnConvert","__decorate","SuppressedError","IpConverter","parseIPv4","parseIPv6","expandIPv6","missing","formatIPv6","compressIPv6","longestZeroStart","longestZeroLength","currentZeroStart","currentZeroLength","parseCIDR","prefixStr","decodeIP","half","addrBytes","maskBytes","every","prefixLen","bitsLeft","RelativeDistinguishedName_1","RDNSequence_1","Name_1","DirectoryString","bmpString","printableString","teletexString","universalString","utf8String","AttributeValue","ia5String","anyValue","AttributeTypeAndValue","RelativeDistinguishedName","setPrototypeOf","RDNSequence","AsnIpConverter","OtherName","typeId","EDIPartyName","partyName","id_kp","id_ad","id_ad_ocsp","id_ad_caIssuers","id_ad_timeStamping","id_ad_caRepository","AuthorityInfoAccessSyntax_1","id_pe_authorityInfoAccess","AccessDescription","accessMethod","accessLocation","AuthorityInfoAccessSyntax","id_ce_authorityKeyIdentifier","KeyIdentifier","AuthorityKeyIdentifier","id_ce_basicConstraints","BasicConstraints","cA","GeneralNames_1","CertificateIssuer_1","id_ce_certificateIssuer","CertificateIssuer","CertificatePolicies_1","id_ce_certificatePolicies","DisplayText","visibleString","NoticeReference","organization","noticeNumbers","UserNotice","Qualifier","PolicyQualifierInfo","policyQualifierId","qualifier","PolicyInformation","policyIdentifier","CertificatePolicies","CRLNumber","BaseCRLNumber","CRLDistributionPoints_1","id_ce_cRLDistributionPoints","ReasonFlags","Reason","aACompromise","affiliationChanged","cACompromise","certificateHold","cessationOfOperation","keyCompromise","privilegeWithdrawn","superseded","unused","DistributionPointName","DistributionPoint","CRLDistributionPoints","FreshestCRL_1","FreshestCRL","IssuingDistributionPoint","onlyContainsUserCerts","ONLY","onlyContainsCACerts","indirectCRL","onlyContainsAttributeCerts","id_ce_cRLReasons","CRLReasons","CRLReason","unspecified","ExtendedKeyUsage_1","id_ce_extKeyUsage","ExtendedKeyUsage","id_kp_serverAuth","id_kp_clientAuth","id_kp_codeSigning","id_kp_emailProtection","id_kp_timeStamping","id_kp_OCSPSigning","InhibitAnyPolicy","id_ce_invalidityDate","InvalidityDate","IssueAlternativeName_1","IssueAlternativeName","id_ce_keyUsage","KeyUsageFlags","GeneralSubtrees_1","KeyUsage","GeneralSubtree","minimum","GeneralSubtrees","NameConstraints","PolicyConstraints","PolicyMappings_1","PolicyMapping","issuerDomainPolicy","subjectDomainPolicy","PolicyMappings","SubjectAlternativeName_1","id_ce_subjectAltName","SubjectAlternativeName","SubjectDirectoryAttributes_1","SubjectDirectoryAttributes","id_ce_subjectKeyIdentifier","SubjectKeyIdentifier","PrivateKeyUsagePeriod","EntrustInfoFlags","SubjectInfoAccessSyntax_1","EntrustInfo","pKIXCertificate","newExtensions","keyUpdateAllowed","EntrustVersionInfo","entrustVers","entrustInfoFlags","SubjectInfoAccessSyntax","AlgorithmIdentifier","SubjectPublicKeyInfo","subjectPublicKey","Time","date","generalTime","utcTime","getTime","Validity","Extensions_1","extnID","CRITICAL","extnValue","Extensions","Version","TBSCertificate","v1","validity","subjectPublicKeyInfo","signatureValue","RevokedCertificate","userCertificate","revocationDate","TBSCertList","thisUpdate","CertificateList","tbsCertList","IssuerAndSerialNumber","SignerIdentifier","CMSVersion","DigestAlgorithmIdentifier","SignatureAlgorithmIdentifier","KeyEncryptionAlgorithmIdentifier","ContentEncryptionAlgorithmIdentifier","MessageAuthenticationCodeAlgorithm","KeyDerivationAlgorithmIdentifier","Attribute","attrType","attrValues","SignerInfos_1","SignerInfo","v0","digestAlgorithm","SignerInfos","SigningTime","CounterSignature","ACClearAttrs","acIssuer","acSerial","AttrSpec_1","AttrSpec","AAControls","permitUnSpecified","IssuerSerial","serial","issuerUID","DigestedObjectType","ObjectDigestInfo","digestedObjectType","objectDigest","V2Form","AttCertIssuer","AttCertValidityPeriod","notBeforeTime","notAfterTime","Holder","AttCertVersion","ClassListFlags","AttributeCertificateInfo","holder","attrCertValidityPeriod","AttributeCertificate","acinfo","ClassList","SecurityCategory","Clearance","policyId","classList","unclassified","IetfAttrSyntaxValueChoices","IetfAttrSyntax","Targets_1","TargetCert","targetCertificate","Target","Targets","ProxyInfo_1","ProxyInfo","RoleSyntax","SvceAuthInfo","service","ident","CertificateSet_1","OtherCertificateFormat","otherCertFormat","otherCert","CertificateChoices","CertificateSet","ContentInfo","EncapsulatedContent","EncapsulatedContentInfo","eContentType","EncryptedContent","EncryptedContentInfo","contentEncryptionAlgorithm","OtherKeyAttribute","keyAttrId","RecipientEncryptedKeys_1","RecipientKeyIdentifier","KeyAgreeRecipientIdentifier","RecipientEncryptedKey","encryptedKey","RecipientEncryptedKeys","OriginatorPublicKey","OriginatorIdentifierOrKey","KeyAgreeRecipientInfo","v3","originator","keyEncryptionAlgorithm","recipientEncryptedKeys","RecipientIdentifier","KeyTransRecipientInfo","KEKIdentifier","keyIdentifier","KEKRecipientInfo","kekid","PasswordRecipientInfo","OtherRecipientInfo","oriType","oriValue","RecipientInfo","RecipientInfos_1","RecipientInfos","RevocationInfoChoices_1","OtherRevocationInfoFormat","otherRevInfoFormat","otherRevInfo","RevocationInfoChoice","RevocationInfoChoices","OriginatorInfo","UnprotectedAttributes_1","UnprotectedAttributes","EnvelopedData","recipientInfos","encryptedContentInfo","id_signedData","DigestAlgorithmIdentifiers_1","DigestAlgorithmIdentifiers","SignedData","digestAlgorithms","encapContentInfo","signerInfos","id_ecPublicKey","id_ecdsaWithSHA1","id_ecdsaWithSHA224","id_ecdsaWithSHA256","id_ecdsaWithSHA384","id_ecdsaWithSHA512","id_secp256r1","id_secp384r1","id_secp521r1","ecdsaWithSHA1","ecdsaWithSHA256","ecdsaWithSHA384","ecdsaWithSHA512","FieldID","Curve","ECPVer","SpecifiedECDomain","ecpVer1","ECParameters","ECPrivateKey","ECDSASigValue","id_pkcs_1","id_rsaEncryption","id_RSAES_OAEP","id_pSpecified","id_RSASSA_PSS","id_md2WithRSAEncryption","id_md5WithRSAEncryption","id_sha1WithRSAEncryption","id_sha224WithRSAEncryption","id_sha256WithRSAEncryption","id_sha384WithRSAEncryption","id_sha512WithRSAEncryption","id_sha512_224WithRSAEncryption","id_sha512_256WithRSAEncryption","id_sha1","id_sha224","id_sha256","id_sha384","id_sha512","id_mgf1","sha1","mgf1SHA1","pSpecifiedEmpty","RsaEsOaepParams","maskGenAlgorithm","pSourceAlgorithm","RsaSaPssParams","trailerField","DigestInfo","OtherPrimeInfos_1","OtherPrimeInfo","prime","OtherPrimeInfos","Lifecycle","thisArg","_arguments","fulfilled","step","rejected","sent","trys","ops","verb","op","isClassProvider","useClass","isFactoryProvider","useFactory","DelayedConstructor","reflectMethods","createProxy","createObject","_this","Proxy","createHandler","delayedObject","isNormalToken","token","isTokenProvider","useToken","isValueProvider","useValue","RegistryBase","_registryMap","getAll","ensure","setAll","_super","Registry","scopedResolutions","paramIdx","dep","idx","formatDependency","PreResolutionInterceptors","PostResolutionInterceptors","preResolution","postResolution","typeInfo","InternalDependencyContainer","_registry","interceptors","disposed","disposables","register","providerOrConstructor","lifecycle","Transient","ensureNotDisposed","isProvider","tokenProvider","currentToken","registration","Singleton","ContainerScoped","ResolutionScoped","registerType","registerInstance","registerSingleton","getRegistration","executePreResolutionInterceptor","resolveRegistration","executePostResolutionInterceptor","isConstructorToken","construct","resolutionType","e_1","remainingInterceptors","interceptor","frequency","e_1_1","e_2","e_2_1","resolved","isSingleton","isContainerScoped","returnInstance","resolveAll","registrations","getAllRegistrations","result_1","isRegistered","recursive","clearInstances","e_3","e_3_1","createChildContainer","e_4","childContainer","e_4_1","beforeResolution","afterResolution","promises","disposable","maybePromise","paramInfo","resolveParams","transformArgs","INJECTION_TOKEN_METADATA_KEY","injectionTokens","PKCS12AttrSet_1","PKCS12Attribute","attrId","PKCS12AttrSet","AuthenticatedSafe_1","AuthenticatedSafe","CertBag","certId","certValue","CRLBag","crlId","crltValue","EncryptedData","encryptionAlgorithm","encryptedData","Attributes_1","Attributes","PrivateKeyInfo","privateKeyAlgorithm","KeyBag","PKCS8ShroudedKeyBag","SecretBag","secretTypeId","secretValue","MacData","macSalt","iterations","PFX","authSafe","macData","SafeContents_1","SafeBag","bagId","bagValue","SafeContents","ExtensionRequest_1","ExtendedCertificateAttributes_1","SMIMECapabilities_1","id_pkcs9","id_pkcs9_at_challengePassword","id_pkcs9_at_extensionRequest","PKCS9String","Pkcs7PDU","UserPKCS12","EncryptedPrivateKeyInfo","EmailAddress","UnstructuredName","UnstructuredAddress","DateOfBirth","PlaceOfBirth","Gender","CountryOfCitizenship","CountryOfResidence","Pseudonym","SequenceNumber","ChallengePassword","ExtensionRequest","ExtendedCertificateAttributes","FriendlyName","SMIMECapability","SMIMECapabilities","CertificationRequestInfo","subjectPKInfo","CertificationRequest","certificationRequestInfo","diAlgorithm","AlgorithmProvider","getAlgorithms","toAsnAlgorithm","unknown","toWebAlgorithm","diAlgorithmProvider","EcAlgorithm_1","idVersionOne","idBrainpoolP160r1","idBrainpoolP160t1","idBrainpoolP192r1","idBrainpoolP192t1","idBrainpoolP224r1","idBrainpoolP224t1","idBrainpoolP256r1","idBrainpoolP256t1","idBrainpoolP320r1","idBrainpoolP320t1","idBrainpoolP384r1","idBrainpoolP384t1","idBrainpoolP512r1","idBrainpoolP512t1","brainpoolP160r1","brainpoolP160t1","brainpoolP192r1","brainpoolP192t1","brainpoolP224r1","brainpoolP224t1","brainpoolP256r1","brainpoolP256t1","brainpoolP320r1","brainpoolP320t1","brainpoolP384r1","brainpoolP384t1","brainpoolP512r1","brainpoolP512t1","ECDSA","EcAlgorithm","SECP256K1","VALUE","TextObject","DefaultAlgorithmSerializer","toTextObject","OidSerializer","ecAlg","TextConverter","serializeObj","deep","objValue","keyValue","toUTCString","serializeBufferSource","row","serializeAlgorithm","algorithmSerializer","oidSerializer","AsnData","rawData","onInit","getTextName","toTextObjectEmpty","toTextObjectWithoutValue","CryptoProvider","isCryptoKeyPair","isCryptoKey","usages","extractable","DEFAULT","callbackfn","toStringTag","OID_REGEX","NameIdentifier","idOrName","findId","replaceUnknownCharacter","Name","isASCII","isPrintableString","extraNames","getName","jsonItem","lastChar","getTypeOid","createAttribute","asnRdn","asnAttr","processedValue","processStringValue","quotedMatches","getThumbprint","ERR_GN_CONSTRUCTOR","ERR_GN_STRING_FORMAT","ERR_GUID","GUID_REGEX","id_GUID","id_UPN","DNS","DN","EMAIL","IP","GUID","UPN","REGISTERED_ID","GeneralName","derName","asnName","directoryName","dNSName","rfc822Name","otherName","iPAddress","registeredID","uniformResourceIdentifier","guid","GeneralNames","nameObj","rPaddingTag","rEolChars","rEolGroup","rPem","isPem","decodeWithHeaders","pattern","pemStruct","headersString","lastHeader","decodeFirst","RangeError","raws","encodeStruct","upperCaseType","toLocaleUpperCase","sliced","rows","CertificateTag","CrlTag","CertificateRequestTag","PublicKeyTag","PrivateKeyTag","PemData","isAsnEncoded","stringRaw","spki","keyUsages","asnSpki","convertSpkiToRsaPkcs1","importKey","algProv","rsaPublicKey","getKeyIdentifier","AuthorityKeyIdentifierExtension","certIdName","authorityCertIssuer","authorityCertSerialNumber","aki","keyId","BasicConstraintsExtension","ca","pathLength","pathLenConstraint","ExtendedKeyUsageExtension","KeyUsagesExtension","SubjectKeyIdentifierExtension","identifier","SubjectAlternativeNameExtension","namesObj","ExtensionFactory","CertificatePolicyExtension","asnPolicies","policies","CRLDistributionPointsExtension","dps","distributionPoint","fullName","distributionPoints","crlExt","dp","dpObj","reasons","cRLIssuer","AuthorityInfoAccessExtension","addAccessDescriptions","ocsp","caIssuers","timeStamping","caRepository","accessDescription","addUrlsToObject","indexedKey","ChallengePasswordAttribute","ExtensionsAttribute","AttributeFactory","diAsnSignatureFormatter","AsnDefaultSignatureFormatter","toAsnSignature","toWebSignature","RsaAlgorithm_1","RsaAlgorithm","createPssParams","getHashAlgorithm","pssParams","ShaAlgorithm","AsnEcSignatureFormatter","addPadding","pointSize","removePadding","positive","namedCurveSize","defaultNamedCurveSize","ecSignature","uint8Signature","ecSigValue","totalByteLength","currentPos","item2","combine","idX25519","idX448","idEd25519","idEd448","EdAlgorithm","Pkcs10CertificateRequest","tbs","getAttribute","subjectName","getExtensions","export","signatureFormatters","signatureFormatter","attrObj","Pkcs10CertificateRequestGenerator","asnReq","asnSignature","X509Certificate","issuerName","keyAlgorithm","paramsKey","ok","signatureOnly","isSelfSigned","issuerUniqueID","subjectUniqueID","extObj","X509Certificates","import","signedData","eContent","single","certificates","cms","contentInfo","X509ChainBuilder","chain","findIssuer","thumbprint","akiExt","skiExt","sanExt","signingKey","asnX509","defaultSigningAlgorithm","X509CrlReason","X509CrlEntry","crlEntryExtensions","invalidity","X509Crl","tbsCertListSignatureAlgorithm","certListSignatureAlgorithm","nextUpdate","revokedCertificates","crlExtensions","findRevoked","certOrSerialNumber","X509CrlGenerator","asnX509Crl","revokedCert","decodeSchema","decodeStream","clientSignalingSession","clientOffer","negotiateRTCSignalingSessionInternal","fullResolutionAllowList","sessionSupportsH264High","transcodeWidth","isMediumResolution","parseOptions","transcodeBaseline","handlesHighResolution","requestDestination","hasH265Support","adaptive","codecSwitch","pictureLoss","hasMediaStreamFeedback","mediaStreamFeedback","convertMediaObject","MediaStreamFeedback","found","findAndSetCodec","codecMap","codecReverseMap","willNeedTranscode","audioCodecName","audioCodecCopy","videoTranscodeArguments","transcode","videoCodecCopy","h264Info","reserved30","reserved31","oobCodecParameters","conservativeDefaultBitrate","scaleFilter","addVideoFilterArguments","audioTranscodeArguments","needPacketization","transcodeStream","FFmpegTranscodeStream","audioRtpTrack","videoPacketSize","repacketizer","videoRtpTrack","spsPps","getSpsPps","H264Repacketizer","spsPpsVps","getSpsPpsVps","H265Repacketizer","repacketized","highProfilesHex","screenWidthForTranscodeH264","WebRTCTrack","connectionManagement","removed","ScryptedSessionControl","activeTracks","onStop","attachForwarder","createTracks","cleanupTrackOnly","setPlaybackInternal","negotiationDeferred","probe","wrapped","vtrack","negotiation","clientSetup","connectRTCSignalingClients","videoMid","audioMid","serverVersion","generateDefaultPeerConfig","negotiationneeded","needRestart","RtpRouter","isClosed","shouldNegotiationneeded","onNegotiationneeded","needNegotiation","onnegotiationneeded","setConfiguration","sdpManager","SDPManager","TransceiverManager","ontrack","SctpTransportManager","ondatachannel","secureManager","SecureTransportManager","onconnectionstatechange","iceCandidate","iceGathererState","extIdUriMap","iceGeneration","_localDescription","_remoteDescription","deepMerge","enumerate","getConfiguration","iceRestart","buildOfferSdp","findOrCreateTransport","routeRtp","routeRtcp","setLocal","sessionDescription","isLocal","setSignalingState","registerMid","andDirection","checkDtlsConnected","remoteSdp","bundleTransport","matchTransceiverWithMedia","transports","inactiveRemoteMedia","removedTransceivers","assertNotClosed","buildAnswerSdp","onsignalingstatechange","createPeerConnectionStats","transceiverStats","dataChannelStats","useOPUS","usePCMU","useVP8","midSuffix","localCodec","bufferOrArrayBuffer","RedHeader","fields","sha224","SHA256","_md_js_1","SHA256_K","SHA256_IV","SHA256_W","getUint32","W15","W2","s0","SHA224","totalSize","lastPacketSentAtMs","firstPacketReceivedAtMs","lastPacketReceivedAtMs","recvIntervalMs","sendIntervalMs","startPeriodicGarbageCollection","gc","lastCollection","sinceLastCollection","remotesCreated","remotesCollected","RpcProxy","constructorName","proxyProps","proxyOneWayMethods","asyncIterator","iteratorMethods","asyncIteratorMethod","PROPERTY_PROXY_ID","PROPERTY_PROXY_PEER","PROPERTY_PROXY_PROPERTIES","PROPERTY_PROXY_ONEWAY_METHODS","PROPERTY_JSON_DISABLE_SERIALIZATION","PROPERTY_JSON_COPY_SERIALIZE_CHILDREN","handled","handleFunctionInvocations","finalizerIdSymbol","finalizerId","argArray","oneway","isFrozen","pendingResults","RPCResultError","rpcApply","proxyId","pendingResult","createPendingResult","cause","WeakRef","deref","FinalizationRegistry","isRpcProxy","getDefaultTransportSafeArgumentTypes","jsonSerializable","thiz","getIteratorNext","prepareProxyProperties","localProxied","localProxyMap","remoteWeakProxies","finalizers","finalize","nameDeserializerMap","onProxyTypeSerialization","transportSafeArgumentTypes","tags","yieldedAsyncIterators","killedDeferred","killedSafe","isTransportSafe","generateId","RANDOM_DIGITS","rpcFinalize","__local_proxy_id","__local_proxy_finalizer_id","getParam","paramMessage","createErrorResult","serializeError","deserializationContext","copySerializeChildren","__remote_proxy_id","__remote_proxy_finalizer_id","__remote_constructor_name","__serialized_value","__remote_proxy_props","__remote_proxy_oneway_methods","RPC_RESULT_ERROR_NAME","deserializeError","newProxy","deserializer","__proxy_constructor","serializerMapName","proxiedEntry","properties","onProxySerialization","__proxy_id","__proxy_peer","proxyConstructorName","localProxiedEntry","rpc","weakref","activeRpcPeer","handleMessageInternal","sendResult","rpcParam","isIteratorNext","rpcResult","deserialized","PROBED_PROPERTIES","crc32By1","pointer","extensionInfo","twccRunning","runTWCC","handleTWCC","microTime","sendTWCC","extensionsArr","minTSN","maxTSN","lastPacketStatus","lastTimestamp","uint24","uint8Add","expected","opcode","toOpcode","isIP","rinfo","findPort","connecting","remoteAddress","size0","size1","size2","xBit","nBit","sBit","tBit","kBit","mBit","payloadHeaderExist","hBit","ver","seenMid","pendingLocalDescription","pendingRemoteDescription","currentRemoteDescription","createMediaDescriptionForTransceiver","simulcast","addTransportDescription","createMediaDescriptionForSctp","allocateMid","validateDescription","addSDPHeader","mediaDescription","mids","sctpMedia","thunky","events","EventEmitter","me","memberships","interval","interface","reuseAddr","multicast","setMulticastTTL","ttl","setMulticastLoopback","AUTHORITATIVE_ANSWER","questions","iface","dropMembership","ifaces","networks","net","allInterfaces","updated","addMembership","setMulticastInterface","internal","platform","defaultInterface","deserializeString","deserializeUint16BE","deserializeAbsSendTime","deserializeAudioLevelIndication","deserializeVideoOrientation","crc32By4","byte1","byte2","skipHeader","headerLength","skipCount","readCount","resumeRead","StreamEndError","readableEnded","readUntil","CHARCODE_NEWLINE","where","charCode","resume","toCode","hasFlag","forceColor","translateLevel","hasBasic","has256","has16m","haveStream","streamIsTTY","TERM","osRelease","CI_NAME","TEAMCITY_VERSION","COLORTERM","TERM_PROGRAM_VERSION","TERM_PROGRAM","FORCE_COLOR","isTTY","w","plural","msAbs","isPlural","isFinite","long","fmtLong","fmtShort","obu_or_fragment","nBit_RtpStartsNewCodedVideoSequence","payloads","frames","objects","isFragment","obus","AV1Obu","lastObu","obu_has_size_field","zBit_RtpStartsWithFragment","yBit_RtpEndsWithFragment","w_RtpNumObus","elementSize","leb128decode","obu","obu_forbidden_bit","obu_type","OBU_TYPES","obu_extension_flag","obu_reserved_1bit","OBU_TYPE_IDS","obuSize","LEB128","leb128bytes","leb128byte","listenTimeout","tls","Server","addListener","tmpStart","subset","remainder","firstLength","bias","fixedWriteMethods","writeDoubleBE","writeDoubleLE","writeFloatBE","writeFloatLE","writeInt32LE","writeInt16LE","writeUInt16LE","useH264","useVP9","useAV1X","supportedCodecs","supportedVideoCodecs","supportedAudioCodecs","uint32Gt","halfMod","file","hashName","colon","startupTimestampInMicroseconds","hrtime","seconds","timeOrigin","msec","createSelfSignedCertificate","rtpSource","sourceValue","rcodes","opcodes","optioncodes","FLUSH_MASK","mail","oldOffset","localPart","consumedBytes","jumped","jumpOffset","additionals","flag_qr","flag_aa","flag_tc","flag_rd","flag_ra","flag_z","flag_ad","flag_cd","rcode","runknown","rns","dd","rsoa","soa","mname","rname","expire","rtxt","txt","rnull","rhinfo","hinfo","cpu","rptr","ptr","rcname","rdname","dname","rsrv","srv","weight","rcaa","caa","ISSUER_CRITICAL","issuerCritical","rmx","mx","preference","exchange","ra","raaaa","aaaa","roption","option","spl","sourcePrefixLength","fam","ipBuf","ipLen","scopePrefixLength","tagsLen","padded","ropt","opt","rdlen","encodingLengthList","encodeList","rdnskey","dnskey","PROTOCOL_DNSSEC","ZONE_KEY","SECURE_ENTRYPOINT","keydata","rrrsig","rrsig","typeCovered","labels","originalTTL","expiration","inception","keyTag","signersName","rrp","mbox","typebitmap","typelist","typesByWindow","typeid","windowBuf","windowLength","extents","rnsec","nsec","nextDomain","rrtypes","rnsec3","nsec3","salt","rds","ds","digestdata","digestType","rsshfp","sshfp","getFingerprintLengthForHashType","hashType","fingerprintBuf","fingerprintLength","rnaptr","naptr","services","regexp","replacement","rtlsa","tlsa","certdata","usage","matchingType","renc","udpPayloadSize","extendedRcode","ednsVersion","flag_do","question","decodeList","TRUNCATED_RESPONSE","RECURSION_DESIRED","RECURSION_AVAILABLE","AUTHENTIC_DATA","CHECKING_DISABLED","DNSSEC_OK","allocing","streamEncode","sbuf","streamDecode","uniqueID","ssrcNum","ssrcFeedbacks","e_m","brExp","brMantissa","constant","feedbacks","USERDATA_MAX_LENGTH","SCTP_RTO_ALPHA","SCTP_TSN_MODULO","SCTPConnectionStates","createEventsFromList","started","hmacKey","localPartialReliability","localVerificationTag","remoteExtensions","remotePartialReliability","remoteVerificationTag","_inboundStreamsCount","_inboundStreamsMax","sackDuplicates","sackMisOrdered","sackNeeded","cwnd","fastRecoveryTransmit","flightSize","outboundStreamSeq","_outboundStreamsCount","localTsn","lastSackedTsn","tsnMinusOne","advancedPeerAckTsn","partialBytesAcked","sentQueue","reconfigRequestSeq","reconfigResponseSeq","rto","timer1Failures","timer2Failures","timerReconfigFailures","tsnPlusOne","timer3Handle","timer1Expired","timer1Handle","sendChunk","timer1Chunk","timer2Expired","timer2Handle","timer2Chunk","timer3Expired","maybeAbandon","updateAdvancedPeerAckPoint","fastRecoveryExit","ssthresh","timerReconfigHandleExpired","timerReconfigHandle","reconfigRequest","sendReconfigParam","localPort","handleData","maxChannels","expectedTag","receiveChunk","sendSack","sackTimeout","gapNext","lastReceivedTsn","sack","receiveDataChunk","ack","setExtensions","COOKIE_WAIT","initAck","timer1Cancel","echo","timer1Start","COOKIE_ECHOED","receiveSackChunk","timer2Cancel","SHUTDOWN_RECEIVED","t2Start","SHUTDOWN_SENT","stamp","SHUTDOWN_ACK_SENT","reconfig","RECONFIG_PARAM_BY_TYPES","receiveReconfigParam","receiveForwardTsnChunk","OutgoingSSNResetRequestParam","ReconfigResponseParam","requestSequence","reconfigResult","ReconfigResultSuccessPerformed","responseSequence","streamIds","timerReconfigCancel","StreamAddOutgoingParam","newStreams","markReceived","inboundStream","getInboundStream","addChunk","popMessages","receive","receivedTime","cwndFullyUtilized","doneBytes","uint32Gte","sChunk","flightSizeDecrease","updateRto","sentTime","loss","seen","highestSeenTsn","highestNewlyAcked","timer3Cancel","timer3Restart","isObsolete","streamSequenceNumber","pruneChunks","srtt","rttvar","InboundStream","forwardTsnChunk","timer3Start","burstSize","retransmitEarliest","dataChunk","flightSizeIncrease","uniqueStreams","timerReconfigHandleStart","sendResetRequest","chunkPos","oChunk","serializePacket","removeAllListeners","reassembly","startPos","expectedTsn","compressionMethod","cls","Session","decrypted","codecArray","ssrcByRtx","NackHandler","audioRedHandler","RedHandler","trackBySSRC","trackByRID","receiveLastSRTimestamp","remoteStreams","handleRtpBySsrc","handleRTP","handleRtpByRid","nackEnabled","twccEnabled","pliEnabled","receiverTWCC","ReceiverTWCC","delaySinceLastSR","delaySeconds","receiverReportDelay","streamStats","inboundRtpStats","remoteOutboundStats","remoteTimestamp","sr","StreamStatistics","originalSsrc","rtxCodec","unwrapRtx","rightAlign","Bool","writeIntBE","readIntBE","paddingBits","NULL","parseNull","mustParseInt","valueBytes","UTF8","parseUTF8","isNumericString","NUMERICSTRING","parseNumericString","PRINTABLESTRING","parsePrintableString","isIA5String","IA5STRING","parseIA5String","T61String","T61STRING","parseT61String","GENERALSTRING","parseGeneralString","parseUTCTime","utc","MM","DD","mm","ss","setUTCFullYear","setUTCHours","setTime","parseGeneralizedTime","gentime","YYYY","fff","setFullYear","setHours","objs","SET","Spec","isCompound","deepParse","_fromDER","tpl","_parseCompound","bufv","readByteLen","valueLen","byteLen","getValueLength","_der","valueLenBytes","getValueLengthByte","Mask","SignedLEB128","UnsignedLEB128","mp","$scanForNullBytes","LOWER_7","UPPER_1","getLength","$ceil7mul","bitCount","log2","KeyExchange","kxTypes","RSA","keyType","keyTypes","ECDHE_RSA","signType","signTypes","ECDHE","ECDHE_ECDSA","PSK","ECDHE_PSK","verifyDataLength","net_1","zeroAt","zeroLen","maxAt","maxLen","oids","oidReg","initOID","nameOrId","framesPerPacket","decodeFrameLength","frameLength","frameCountByte","packetFrameCount","vbr","frameLengths","lastFrameLength","toc","newHeader","headerBuffer","newPacket","sendOpen","bufferedAmountLow","bufferedAmount","_bufferedAmountLowThreshold","bufferedAmountLowThreshold","onopen","onclose","onclosing","amount","crossesThreshold","generateCounter","generateSrtcpAuthTag","tailOffset","pem_1","ssrcTable","ridTable","rtpHeaderExtensionsParser","rtpReceiver","latestRid","registerRtpReceiver","repairedRid","latestRepairedRid","recipients","rtpfb","psfb","remb","recipient","toRcode","dtlsCookie","helloCookie","flight6","rtspTcpServer","rtpPacket","getRefreshAt","extendSession","gmt_unix_time","random_bytes","candidatePairPriority","_state","MediaPlayerState","SecuritySystemObstruction","SecuritySystemMode","AirQuality","AirPurifierMode","AirPurifierStatus","ChargeState","LockState","PanTiltZoomMovement","ThermostatMode","TemperatureUnit","FanMode","HumidityMode","ScryptedInterfaceMethod","readUint16BE","messageType","attributeRepository","AttributeRepository","attrLen","padLen","attrName","attrUnpack","messageFingerprint","integrity","messageIntegrity","attrValue","attrPack","attrHeader","checkData","setBodyLength","crc32Buf","xorBuf","bufferXor","lastTsn","BadSequenceNumber","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","definition","__webpack_exports__"],"sourceRoot":""}
{"version":3,"file":"main.nodejs.js","mappings":"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","sources":["../webpack/runtime/create fake namespace object","../../eufy-security-client/dist/index.js","../../eufy-security-client/dist/types/commands.js","../external node-commonjs \"buffer\"","../../../node_modules/tslog/cjs/interfaces.js","../../eufy-stream-server/dist/stream-server.js","../../eufy-security-client/dist/server/events.js","../../eufy-security-client/dist/api-manager.js","../../../node_modules/ws/index.js","../../eufy-stream-server/dist/connection-manager.js","../../eufy-security-client/dist/server/index.js","../../../node_modules/ws/lib/sender.js","../../../node_modules/tslog/cjs/prettyLogStyles.js","../../eufy-security-client/dist/server/responses.js","../../eufy-security-client/dist/device/constants.js","../../../node_modules/ws/lib/stream.js","../../eufy-security-client/dist/common/index.js","../../eufy-security-client/dist/device/responses.js","../../eufy-security-client/dist/station/commands.js","../../../node_modules/ws/lib/receiver.js","../../../node_modules/ws/lib/extension.js","../../eufy-security-client/dist/device/properties.js","../../eufy-security-client/dist/server/commands.js","../external node-commonjs \"stream\"","../../../node_modules/tslog/cjs/internal/environment.js","../../eufy-security-client/dist/types/events.js","../../eufy-security-client/dist/types/schema.js","../external node-commonjs \"zlib\"","../../eufy-security-client/dist/server/properties.js","../external node-commonjs \"module\"","../../eufy-security-client/dist/station/constants.js","../../eufy-security-client/dist/utils/websocket-message-processor.js","../../../node_modules/ws/lib/subprotocol.js","../node_modules/@scrypted/sdk/dist/src|sync","../../../node_modules/ws/lib/validation.js","../../../node_modules/ws/lib/constants.js","../../eufy-security-client/dist/driver/commands.js","../../eufy-security-client/dist/device/events.js","../node_modules/@scrypted/sdk/dist/types/gen/index.js","../../../node_modules/ws/lib/event-target.js","../external node-commonjs \"events\"","../external node-commonjs \"tls\"","../../eufy-stream-server/dist/h264-parser.js","../../eufy-security-client/dist/driver/events.js","../../eufy-security-client/dist/api-manager-commands.js","../../eufy-security-client/dist/device/commands.js","../../eufy-security-client/dist/station/events.js","../external node-commonjs \"child_process\"","../../eufy-stream-server/dist/index.js","../../eufy-security-client/dist/device/index.js","../../../node_modules/ws/lib/limiter.js","../../eufy-security-client/dist/common/responses.js","../../eufy-security-client/dist/eufy-security-client.js","../../../node_modules/tslog/cjs/internal/stackTrace.js","../../eufy-security-client/dist/server/constants.js","../../../node_modules/tslib/tslib.es6.mjs","../../eufy-security-client/dist/driver/constants.js","../external node-commonjs \"https\"","../../../node_modules/ws/lib/websocket-server.js","../../eufy-security-client/dist/types/shared.js","../../../node_modules/tslog/cjs/internal/jsonStringifyRecursive.js","../../../node_modules/tslog/cjs/internal/util.inspect.polyfill.js","../../eufy-security-client/dist/driver/index.js","../../../node_modules/tslog/cjs/BaseLogger.js","../../../node_modules/tslog/cjs/formatNumberAddZeros.js","../../eufy-security-client/dist/websocket-types.js","../../../node_modules/tslog/cjs/formatTemplate.js","../../../node_modules/ws/lib/permessage-deflate.js","../external node-commonjs \"crypto\"","../external node-commonjs \"url\"","../../../node_modules/tslog/cjs/index.js","../../../node_modules/ws/lib/websocket.js","../../../node_modules/ws/lib/buffer-util.js","../node_modules/@scrypted/sdk/dist/src/index.js","../../../node_modules/tslog/cjs/internal/errorUtils.js","../../eufy-security-client/dist/driver/properties.js","../external node-commonjs \"http\"","../../eufy-security-client/dist/client-state.js","../../../node_modules/tslog/cjs/internal/metaFormatting.js","../../eufy-security-client/dist/station/properties.js","../external node-commonjs \"net\"","../../eufy-security-client/dist/common/constants.js","../../eufy-security-client/dist/driver/responses.js","../../../node_modules/tslog/cjs/urlToObj.js","../../eufy-security-client/dist/station/responses.js","../../eufy-security-client/dist/utils/device-detection.js","../../eufy-security-client/dist/station/index.js","../../eufy-security-client/dist/authentication-manager.js","../../eufy-security-client/dist/websocket-client.js","../external node-commonjs \"fs\"","../webpack/bootstrap","../webpack/runtime/compat get default export","../webpack/runtime/define property getters","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object","../../../node_modules/tslog/esm/prettyLogStyles.js","../../../node_modules/tslog/esm/formatTemplate.js","../../../node_modules/tslog/esm/formatNumberAddZeros.js","../../../node_modules/tslog/esm/internal/metaFormatting.js","../../../node_modules/tslog/esm/internal/errorUtils.js","../../../node_modules/tslog/esm/internal/jsonStringifyRecursive.js","../../../node_modules/tslog/esm/internal/util.inspect.polyfill.js","../../../node_modules/tslog/esm/internal/stackTrace.js","../../../node_modules/tslog/esm/internal/environment.js","../../../node_modules/tslog/esm/BaseLogger.js","../../../node_modules/tslog/esm/urlToObj.js","../../../node_modules/tslog/esm/index.js","../src/utils/property-mapper.ts","../src/services/device/device-settings-service.ts","../src/services/device/device-state-service.ts","../src/services/device/refresh-service.ts","../src/utils/ffmpeg-utils.ts","../src/services/device/snapshot-service.ts","../src/services/device/stream-service.ts","../src/services/video/video-clips-service.ts","../src/services/control/ptz-control-service.ts","../src/services/control/light-control-service.ts","../src/eufy-device.ts","../src/utils/device-utils.ts","../src/utils/scrypted-device-detection.ts","../src/eufy-station.ts","../src/utils/memory-manager.ts","../src/eufy-provider.ts","../src/main.ts"],"sourcesContent":["var getProto = Object.getPrototypeOf ? (obj) => (Object.getPrototypeOf(obj)) : (obj) => (obj.__proto__);\nvar leafPrototypes;\n// create a fake namespace object\n// mode & 1: value is a module id, require it\n// mode & 2: merge all properties of value into the ns\n// mode & 4: return value when already ns object\n// mode & 16: return value when it's Promise-like\n// mode & 8|1: behave like require\n__webpack_require__.t = function(value, mode) {\n\tif(mode & 1) value = this(value);\n\tif(mode & 8) return value;\n\tif(typeof value === 'object' && value) {\n\t\tif((mode & 4) && value.__esModule) return value;\n\t\tif((mode & 16) && typeof value.then === 'function') return value;\n\t}\n\tvar ns = Object.create(null);\n\t__webpack_require__.r(ns);\n\tvar def = {};\n\tleafPrototypes = leafPrototypes || [null, getProto({}), getProto([]), getProto(getProto)];\n\tfor(var current = mode & 2 && value; (typeof current == 'object' || typeof current == 'function') && !~leafPrototypes.indexOf(current); current = getProto(current)) {\n\t\tObject.getOwnPropertyNames(current).forEach((key) => (def[key] = () => (value[key])));\n\t}\n\tdef['default'] = () => (value);\n\t__webpack_require__.d(ns, def);\n\treturn ns;\n};","\"use strict\";\n/**\n * Eufy Security WebSocket Client - Public API\n *\n * This is the main entry point for the Eufy Security WebSocket Client library.\n * It provides a clean, strongly typed interface for interacting with the\n * eufy-security-ws container through WebSocket connections.\n *\n * Exports all main API classes, types, and utilities for external use.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MESSAGE_TYPES = exports.WebSocketMessageProcessor = exports.AuthenticationManager = exports.AUTH_STATE = exports.ConnectionState = exports.ClientStateManager = exports.EufySecurityClient = exports.WebSocketClient = exports.EufyWebSocketClient = void 0;\nconst tslib_1 = require(\"tslib\");\n// ================= MAIN CLIENT =================\nvar api_manager_1 = require(\"./api-manager\");\nObject.defineProperty(exports, \"EufyWebSocketClient\", { enumerable: true, get: function () { return api_manager_1.ApiManager; } });\nvar websocket_client_1 = require(\"./websocket-client\");\nObject.defineProperty(exports, \"WebSocketClient\", { enumerable: true, get: function () { return websocket_client_1.WebSocketClient; } });\nvar eufy_security_client_1 = require(\"./eufy-security-client\");\nObject.defineProperty(exports, \"EufySecurityClient\", { enumerable: true, get: function () { return eufy_security_client_1.EufySecurityClient; } });\n// ================= STATE MANAGEMENT =================\nvar client_state_1 = require(\"./client-state\");\nObject.defineProperty(exports, \"ClientStateManager\", { enumerable: true, get: function () { return client_state_1.ClientStateManager; } });\nObject.defineProperty(exports, \"ConnectionState\", { enumerable: true, get: function () { return client_state_1.ConnectionState; } });\n// ================= COMMON =================\ntslib_1.__exportStar(require(\"./common\"), exports);\n// ================= DEVICE =================\ntslib_1.__exportStar(require(\"./device\"), exports);\n// ================= DRIVER =================\ntslib_1.__exportStar(require(\"./driver\"), exports);\n// ================= SERVER =================\ntslib_1.__exportStar(require(\"./server\"), exports);\n// ================= STATION =================\ntslib_1.__exportStar(require(\"./station\"), exports);\n// ================= TYPES =================\ntslib_1.__exportStar(require(\"./types/events\"), exports);\ntslib_1.__exportStar(require(\"./types/schema\"), exports);\ntslib_1.__exportStar(require(\"./types/shared\"), exports);\n// ================= AUTHENTICATION =================\nvar authentication_manager_1 = require(\"./authentication-manager\");\nObject.defineProperty(exports, \"AUTH_STATE\", { enumerable: true, get: function () { return authentication_manager_1.AUTH_STATE; } });\nObject.defineProperty(exports, \"AuthenticationManager\", { enumerable: true, get: function () { return authentication_manager_1.AuthenticationManager; } });\n// ================= UTILITIES =================\nvar websocket_message_processor_1 = require(\"./utils/websocket-message-processor\");\nObject.defineProperty(exports, \"WebSocketMessageProcessor\", { enumerable: true, get: function () { return websocket_message_processor_1.WebSocketMessageProcessor; } });\ntslib_1.__exportStar(require(\"./utils/device-detection\"), exports);\n// ================= WEBSOCKET TYPES =================\nvar websocket_types_1 = require(\"./websocket-types\");\nObject.defineProperty(exports, \"MESSAGE_TYPES\", { enumerable: true, get: function () { return websocket_types_1.MESSAGE_TYPES; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\n/**\n * Command base types and helpers for Eufy Security WebSocket Client.\n *\n * Provides base command interfaces, command/response mapping types, and helpers for all command sources.\n * These types ensure type safety across all command operations and provide compile-time validation.\n *\n * @public\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.isSupportedCommand = isSupportedCommand;\nconst constants_1 = require(\"../common/constants\");\n/**\n * Type guard to check if a command string is a supported command type\n *\n * @param command - Command string to validate\n * @returns true if the command is supported, false otherwise\n *\n * @example\n * ```typescript\n * if (isSupportedCommand(userInput)) {\n *   // userInput is now typed as SupportedCommandType\n *   await client.sendCommand(userInput, params);\n * }\n * ```\n *\n * @public\n */\nfunction isSupportedCommand(command) {\n    const allSupportedCommands = [\n        ...Object.values(constants_1.DEVICE_COMMANDS),\n        ...Object.values(constants_1.STATION_COMMANDS),\n        ...Object.values(constants_1.DRIVER_COMMANDS),\n        ...Object.values(constants_1.SERVER_COMMANDS),\n    ];\n    return allSupportedCommands.includes(command);\n}\n//# sourceMappingURL=commands.js.map","module.exports = require(\"buffer\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n","\"use strict\";\n/**\n * Simple TCP Stream Server - Raw H.264 streaming server\n *\n * This is a simplified version of the legacy eufy-stream-server that focuses\n * exclusively on streaming raw H.264 video data over TCP connections.\n * All audio processing, MP4 fragmentation, and complex error recovery\n * have been removed for simplicity.\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || (function () {\n    var ownKeys = function(o) {\n        ownKeys = Object.getOwnPropertyNames || function (o) {\n            var ar = [];\n            for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n            return ar;\n        };\n        return ownKeys(o);\n    };\n    return function (mod) {\n        if (mod && mod.__esModule) return mod;\n        var result = {};\n        if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n        __setModuleDefault(result, mod);\n        return result;\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StreamServer = void 0;\nconst net = __importStar(require(\"net\"));\nconst events_1 = require(\"events\");\nconst tslog_1 = require(\"tslog\");\nconst connection_manager_1 = require(\"./connection-manager\");\nconst h264_parser_1 = require(\"./h264-parser\");\nconst eufy_security_client_1 = require(\"@caplaz/eufy-security-client\");\n/**\n * Simple TCP streaming server for raw H.264 video data\n *\n * This server accepts TCP connections and streams raw H.264 video data\n * to all connected clients. It provides basic connection management,\n * NAL unit parsing, and key frame detection.\n *\n * @example\n * ```typescript\n * const server = new StreamServer({\n *   port: 8080,\n *   debug: true,\n *   wsClient: eufyWebSocketClient,\n *   serialNumber: 'device123'\n * });\n *\n * server.start().then(() => {\n *   console.log('Server started and listening for video data');\n * });\n * ```\n */\nclass StreamServer extends events_1.EventEmitter {\n    constructor(options) {\n        super();\n        this.isActive = false;\n        // Stream state management\n        this.livestreamIntendedState = false;\n        this.livestreamActualState = false;\n        // Video metadata from first frame\n        this.videoMetadata = null;\n        this.metadataReceived = false;\n        // Client activity monitoring for battery optimization\n        this.lastClientActivity = 0;\n        this.ACTIVITY_TIMEOUT = 30000; // 30 seconds of no activity\n        // Statistics\n        this.stats = {\n            framesProcessed: 0,\n            bytesTransferred: 0,\n            lastFrameTime: null,\n        };\n        // Snapshot capture state\n        this.snapshotResolvers = [];\n        // SPS/PPS cache for new client initialization\n        // These are the critical headers that FFmpeg needs to parse the H.264 stream\n        this.cachedSPS = null;\n        this.cachedPPS = null;\n        this.options = {\n            port: options.port ?? 8080,\n            host: options.host ?? \"0.0.0.0\",\n            maxConnections: options.maxConnections ?? 10,\n            debug: options.debug ?? false,\n            logger: options.logger,\n            wsClient: options.wsClient,\n            serialNumber: options.serialNumber,\n        };\n        // Use external logger if provided, otherwise create internal tslog Logger\n        // Note: When external logger is provided, it controls its own debug level\n        this.logger =\n            options.logger ??\n                new tslog_1.Logger({\n                    name: \"StreamServer\",\n                    minLevel: 3, // info level - external loggers control their own debug level\n                });\n        this.connectionManager = new connection_manager_1.ConnectionManager(this.logger);\n        this.h264Parser = new h264_parser_1.H264Parser(this.logger);\n        this.setupEventHandlers();\n        this.setupWebSocketListener();\n    }\n    /**\n     * Setup event handlers for connection manager\n     */\n    setupEventHandlers() {\n        this.connectionManager.on(\"clientConnected\", async (connectionId, connectionInfo) => {\n            const previousCount = this.connectionManager.getActiveConnectionCount() - 1;\n            this.logger.info(`Client connected: ${connectionId} from ${connectionInfo.remoteAddress}:${connectionInfo.remotePort}`);\n            this.emit(\"clientConnected\", connectionId, connectionInfo);\n            // Send cached SPS/PPS headers immediately so FFmpeg can parse the stream\n            this.sendCachedHeaders(connectionId);\n            // Start livestream when first client connects\n            if (previousCount === 0) {\n                this.livestreamIntendedState = true;\n                this.lastClientActivity = Date.now();\n                this.startActivityMonitoring();\n                await this.ensureLivestreamState();\n            }\n        });\n        this.connectionManager.on(\"clientDisconnected\", async (connectionId) => {\n            const previousCount = this.connectionManager.getActiveConnectionCount() + 1;\n            this.logger.info(`Client disconnected: ${connectionId}`);\n            this.emit(\"clientDisconnected\", connectionId);\n            // Stop livestream when last client disconnects\n            if (previousCount === 1) {\n                this.livestreamIntendedState = false;\n                this.stopActivityMonitoring();\n                await this.ensureLivestreamState();\n            }\n        });\n    }\n    /**\n     * Send cached SPS/PPS headers to a specific client\n     * This ensures new clients can immediately decode the stream\n     * @param connectionId - The connection ID to send headers to\n     */\n    sendCachedHeaders(connectionId) {\n        if (!this.cachedSPS && !this.cachedPPS) {\n            this.logger.debug(`No cached SPS/PPS headers available for client ${connectionId}`);\n            return;\n        }\n        if (this.cachedSPS) {\n            this.logger.debug(`Sending cached SPS header (${this.cachedSPS.length} bytes) to ${connectionId}`);\n            this.connectionManager.sendToClient(connectionId, this.cachedSPS);\n        }\n        if (this.cachedPPS) {\n            this.logger.debug(`Sending cached PPS header (${this.cachedPPS.length} bytes) to ${connectionId}`);\n            this.connectionManager.sendToClient(connectionId, this.cachedPPS);\n        }\n    }\n    /**\n     * Start monitoring client activity to detect idle connections\n     */\n    startActivityMonitoring() {\n        this.stopActivityMonitoring(); // Clear any existing interval\n        this.activityCheckInterval = setInterval(() => {\n            const now = Date.now();\n            const timeSinceActivity = now - this.lastClientActivity;\n            // Clean up any stale connections first\n            this.cleanupStaleConnections();\n            const activeClients = this.connectionManager.getActiveConnectionCount();\n            if (timeSinceActivity > this.ACTIVITY_TIMEOUT && activeClients === 0) {\n                this.logger.info(` No client activity for ${Math.round(timeSinceActivity / 1000)}s and no active clients, stopping camera stream`);\n                this.livestreamIntendedState = false;\n                this.stopActivityMonitoring();\n                this.ensureLivestreamState();\n            }\n            else if (activeClients === 0 && this.livestreamIntendedState) {\n                this.logger.debug(`No active clients but stream is intended to run - waiting for connections`);\n            }\n        }, 5000); // Check every 5 seconds\n        this.logger.debug(\"Started client activity monitoring\");\n    }\n    /**\n     * Stop monitoring client activity\n     */\n    stopActivityMonitoring() {\n        if (this.activityCheckInterval) {\n            clearInterval(this.activityCheckInterval);\n            this.activityCheckInterval = undefined;\n            this.logger.debug(\"Stopped client activity monitoring\");\n        }\n    }\n    /**\n     * Clean up stale TCP connections that may not be actively used\n     */\n    cleanupStaleConnections() {\n        const connectionStats = this.connectionManager.getConnectionStats();\n        const now = Date.now();\n        let cleanedCount = 0;\n        for (const [connectionId, info] of Object.entries(connectionStats)) {\n            const connectionAge = now - info.connectedAt.getTime();\n            // Clean up connections that are older than 5 minutes and have no recent activity\n            if (connectionAge > 5 * 60 * 1000) {\n                // 5 minutes\n                this.logger.info(`Cleaning up stale connection: ${connectionId} (age: ${Math.round(connectionAge / 1000)}s)`);\n                // Note: The connection manager will handle the actual cleanup when we emit the disconnect event\n                // For now, we'll just log this - the connection manager handles cleanup on actual disconnects\n                cleanedCount++;\n            }\n        }\n        if (cleanedCount > 0) {\n            this.logger.debug(`Identified ${cleanedCount} stale connections for cleanup`);\n        }\n    }\n    /**\n     * Setup WebSocket event listener for video data\n     */\n    setupWebSocketListener() {\n        this.logger.info(`Setting up WebSocket listener for device: ${this.options.serialNumber}`);\n        // Listen for livestream video data events\n        this.eventRemover = this.options.wsClient.addEventListener(eufy_security_client_1.DEVICE_EVENTS.LIVESTREAM_VIDEO_DATA, (event) => {\n            // Filter events by device serial number\n            if (event.serialNumber !== this.options.serialNumber) {\n                return;\n            }\n            // Log that we received a video data event (first few only to avoid spam)\n            if (this.stats.framesProcessed < 3) {\n                this.logger.debug(`Received video data event for ${event.serialNumber}: ${event.buffer.data.length} bytes, metadata present: ${!!event.metadata}`);\n                if (event.metadata) {\n                    this.logger.debug(`Video metadata: codec=${event.metadata.videoCodec}, ${event.metadata.videoWidth}x${event.metadata.videoHeight} @ ${event.metadata.videoFPS}fps`);\n                }\n            }\n            // Capture video metadata from first frame\n            if (!this.metadataReceived && event.metadata) {\n                this.videoMetadata = {\n                    videoCodec: event.metadata.videoCodec,\n                    videoFPS: event.metadata.videoFPS,\n                    videoWidth: event.metadata.videoWidth,\n                    videoHeight: event.metadata.videoHeight,\n                };\n                this.metadataReceived = true;\n                this.logger.info(` Captured video metadata: ${this.videoMetadata.videoWidth}x${this.videoMetadata.videoHeight} @ ${this.videoMetadata.videoFPS}fps, codec: ${this.videoMetadata.videoCodec}`);\n                this.emit(\"metadataReceived\", this.videoMetadata);\n            }\n            // Mark livestream as actually running when we receive data\n            if (!this.livestreamActualState) {\n                this.livestreamActualState = true;\n                this.logger.info(\" Livestream confirmed active - receiving video data\");\n            }\n            // Log video data events based on client activity\n            const activeClients = this.connectionManager.getActiveConnectionCount();\n            if (activeClients > 0) {\n                this.logger.debug(`Received video data event for ${event.serialNumber}: ${event.buffer.data.length} bytes (${activeClients} active clients)`);\n            }\n            else {\n                // Log less frequently when no clients - only every 10th frame\n                if (this.stats.framesProcessed % 10 === 0) {\n                    this.logger.debug(`Received video data event for ${event.serialNumber}: ${event.buffer.data.length} bytes (no active clients, frame ${this.stats.framesProcessed})`);\n                }\n            }\n            // Convert JSONBuffer to Buffer if needed\n            const videoBuffer = Buffer.isBuffer(event.buffer.data)\n                ? event.buffer.data\n                : Buffer.from(event.buffer.data);\n            // Stream the video data\n            this.streamVideo(videoBuffer, Date.now(), undefined);\n        }, {\n            source: \"device\",\n            serialNumber: this.options.serialNumber,\n        });\n        this.logger.info(`WebSocket listener setup complete for device: ${this.options.serialNumber}`);\n    }\n    /**\n     * Ensure the livestream is in the correct state with retry logic\n     */\n    async ensureLivestreamState() {\n        // Clear any existing timeout\n        if (this.startStopTimeout) {\n            clearTimeout(this.startStopTimeout);\n            this.startStopTimeout = undefined;\n        }\n        const maxRetries = 3;\n        const retryDelay = 5000; // 5 seconds\n        for (let attempt = 1; attempt <= maxRetries; attempt++) {\n            try {\n                // First, check the actual livestream status from the device\n                let actualStreamingStatus = false;\n                try {\n                    const statusResponse = await this.options.wsClient.commands\n                        .device(this.options.serialNumber)\n                        .isLivestreaming();\n                    actualStreamingStatus = statusResponse.livestreaming;\n                    this.logger.debug(`Current device livestream status: ${actualStreamingStatus}`);\n                }\n                catch (error) {\n                    this.logger.warn(\"Failed to check livestream status, continuing with command:\", error.message || error);\n                }\n                if (this.livestreamIntendedState && !actualStreamingStatus) {\n                    // Need to start livestream\n                    this.logger.info(` Starting livestream (attempt ${attempt}/${maxRetries})`);\n                    await this.options.wsClient.commands\n                        .device(this.options.serialNumber)\n                        .startLivestream();\n                    this.logger.info(\" Livestream start command sent successfully\");\n                    // Set timeout to check if it actually started\n                    this.startStopTimeout = setTimeout(() => {\n                        if (this.livestreamIntendedState && !this.livestreamActualState) {\n                            this.logger.warn(\" Livestream start timeout - no video data received, will retry\");\n                            this.ensureLivestreamState();\n                        }\n                    }, 30000); // 30 seconds to receive first video data\n                }\n                else if (this.livestreamIntendedState && actualStreamingStatus) {\n                    // Stream is already running and we want it running - all good\n                    this.logger.debug(\"Livestream already running as desired\");\n                }\n                else if (!this.livestreamIntendedState && actualStreamingStatus) {\n                    // Need to stop livestream\n                    this.logger.info(` Stopping livestream (attempt ${attempt}/${maxRetries})`);\n                    await this.options.wsClient.commands\n                        .device(this.options.serialNumber)\n                        .stopLivestream();\n                    this.logger.info(\" Livestream stop command sent successfully\");\n                    this.livestreamActualState = false;\n                }\n                else {\n                    // Stream is not running and we don't want it running - all good\n                    this.logger.debug(\"Livestream already stopped as desired\");\n                }\n                // Success - break out of retry loop\n                break;\n            }\n            catch (error) {\n                this.logger.warn(` Livestream command failed (attempt ${attempt}/${maxRetries}):`, error.message || error);\n                if (attempt === maxRetries) {\n                    this.logger.error(` Failed to set livestream state after ${maxRetries} attempts`);\n                    this.emit(\"streamError\", error);\n                }\n                else {\n                    // Wait before retrying\n                    this.logger.info(` Retrying in ${retryDelay / 1000} seconds...`);\n                    await new Promise((resolve) => setTimeout(resolve, retryDelay));\n                }\n            }\n        }\n    }\n    /**\n     * Start the TCP server\n     */\n    async start() {\n        if (this.isActive) {\n            throw new Error(\"Server is already running\");\n        }\n        return new Promise((resolve, reject) => {\n            this.server = net.createServer();\n            this.server.on(\"connection\", (socket) => {\n                this.connectionManager.handleConnection(socket);\n            });\n            this.server.on(\"error\", (error) => {\n                this.logger.error(\"Server error:\", error);\n                this.emit(\"error\", error);\n                reject(error);\n            });\n            this.server.listen(this.options.port, this.options.host, () => {\n                this.isActive = true;\n                this.startTime = new Date();\n                this.logger.info(` Stream server started on ${this.options.host}:${this.options.port}`);\n                this.emit(\"started\");\n                resolve();\n            });\n        });\n    }\n    /**\n     * Stop the TCP server\n     */\n    async stop() {\n        if (!this.isActive) {\n            return;\n        }\n        // Clear any pending timeouts\n        if (this.startStopTimeout) {\n            clearTimeout(this.startStopTimeout);\n            this.startStopTimeout = undefined;\n        }\n        // Stop activity monitoring\n        this.stopActivityMonitoring();\n        // Stop livestream if there are active clients\n        const activeClients = this.connectionManager.getActiveConnectionCount();\n        if (activeClients > 0) {\n            this.livestreamIntendedState = false;\n            await this.ensureLivestreamState();\n        }\n        // Clean up WebSocket event listener\n        if (this.eventRemover) {\n            this.eventRemover();\n            this.eventRemover = undefined;\n            this.logger.debug(\"WebSocket event listener removed\");\n        }\n        return new Promise((resolve) => {\n            this.connectionManager.close();\n            if (this.server) {\n                this.server.close(() => {\n                    this.isActive = false;\n                    this.logger.info(\" Stream server stopped\");\n                    this.emit(\"stopped\");\n                    resolve();\n                });\n            }\n            else {\n                this.isActive = false;\n                resolve();\n            }\n        });\n    }\n    /**\n     * Stream raw H.264 video data to all connected clients\n     *\n     * @param data - Raw H.264 video data buffer\n     * @param timestamp - Optional timestamp in milliseconds\n     * @param isKeyFrame - Optional flag indicating if this is a key frame\n     * @returns Promise<boolean> - True if data was successfully processed\n     */\n    async streamVideo(data, timestamp, isKeyFrame) {\n        if (!data || data.length === 0) {\n            this.logger.warn(\"Cannot stream empty video data\");\n            return false;\n        }\n        try {\n            // Validate H.264 data structure\n            if (!this.h264Parser.validateH264Data(data)) {\n                this.logger.warn(\"Invalid H.264 data structure\");\n                return false;\n            }\n            // Detect key frame if not explicitly provided\n            if (isKeyFrame === undefined) {\n                isKeyFrame = this.h264Parser.isKeyFrame(data);\n            }\n            // Log NAL unit information for debugging\n            const nalUnits = this.h264Parser.extractNALUnits(data);\n            const nalInfo = nalUnits\n                .map((nal) => `${this.h264Parser.getNALTypeName(nal.type)}(${nal.type})`)\n                .join(\", \");\n            this.logger.debug(`Processing H.264 data: ${data.length} bytes, NALs: [${nalInfo}], keyFrame: ${isKeyFrame}`);\n            // Cache SPS/PPS NAL units for new client initialization\n            // Type 7 = SPS (Sequence Parameter Set), Type 8 = PPS (Picture Parameter Set)\n            nalUnits.forEach((nal) => {\n                if (nal.type === 7) {\n                    // SPS\n                    this.cachedSPS = data; // Cache the entire buffer containing SPS\n                    this.logger.debug(`Cached SPS header (${data.length} bytes)`);\n                }\n                else if (nal.type === 8) {\n                    // PPS\n                    this.cachedPPS = data; // Cache the entire buffer containing PPS\n                    this.logger.debug(`Cached PPS header (${data.length} bytes)`);\n                }\n            });\n            // Resolve any pending snapshot requests with keyframe data\n            // This happens BEFORE checking if server is active, so snapshots work without TCP server\n            let snapshotsHandled = false;\n            if (isKeyFrame && this.snapshotResolvers.length > 0) {\n                this.logger.debug(`Resolving ${this.snapshotResolvers.length} snapshot request(s) with keyframe data`);\n                const resolvers = [...this.snapshotResolvers];\n                this.snapshotResolvers = [];\n                resolvers.forEach(({ resolve }) => resolve(data));\n                snapshotsHandled = true;\n            }\n            // If server is not active, we've already handled snapshot resolution above\n            // Return success only if snapshots were handled, otherwise return false\n            if (!this.isActive) {\n                if (snapshotsHandled) {\n                    this.stats.framesProcessed++;\n                    return true; // Return true because snapshot was handled successfully\n                }\n                else {\n                    return false; // Server not active and no snapshots to handle\n                }\n            }\n            // Broadcast to all connected clients\n            const success = this.connectionManager.broadcast(data);\n            // Update client activity timestamp when data is successfully sent\n            if (success) {\n                this.lastClientActivity = Date.now();\n            }\n            // Update statistics\n            this.stats.framesProcessed++;\n            this.stats.bytesTransferred += data.length;\n            this.stats.lastFrameTime = new Date();\n            // Log frame streaming activity\n            const activeClients = this.connectionManager.getActiveConnectionCount();\n            if (activeClients > 0) {\n                this.logger.debug(`Streamed video frame: ${data.length} bytes to ${activeClients} clients`);\n            }\n            else {\n                this.logger.debug(`Processed video frame: ${data.length} bytes (no active clients)`);\n            }\n            // Emit event\n            this.emit(\"videoStreamed\", {\n                data,\n                timestamp,\n                isKeyFrame,\n            });\n            return true;\n        }\n        catch (error) {\n            this.logger.error(\"Failed to stream video data:\", error);\n            this.emit(\"streamError\", error);\n            return false;\n        }\n    }\n    /**\n     * Get video metadata from the first received frame\n     */\n    getVideoMetadata() {\n        return this.videoMetadata;\n    }\n    /**\n     * Wait for video metadata to be received\n     */\n    async waitForVideoMetadata(timeoutMs = 10000) {\n        if (this.videoMetadata) {\n            this.logger.debug(\"Video metadata already available\");\n            return this.videoMetadata;\n        }\n        this.logger.debug(`Waiting for video metadata (timeout: ${timeoutMs}ms)...`);\n        return new Promise((resolve, reject) => {\n            const timeout = setTimeout(() => {\n                this.logger.warn(`Timeout waiting for video metadata (${timeoutMs}ms). Livestream state: ${this.livestreamActualState}, intended: ${this.livestreamIntendedState}`);\n                reject(new Error(`Timeout waiting for video metadata (${timeoutMs}ms)`));\n            }, timeoutMs);\n            this.once(\"metadataReceived\", (metadata) => {\n                clearTimeout(timeout);\n                this.logger.debug(\"Video metadata received successfully\");\n                resolve(metadata);\n            });\n        });\n    }\n    /**\n     * Check if server is running\n     */\n    isRunning() {\n        return this.isActive;\n    }\n    /**\n     * Get server statistics\n     */\n    getStats() {\n        const connectionStats = this.connectionManager.getConnectionStats();\n        return {\n            isActive: this.isActive,\n            port: this.options.port,\n            uptime: this.startTime ? Date.now() - this.startTime.getTime() : 0,\n            connections: {\n                active: this.connectionManager.getActiveConnectionCount(),\n                total: Object.keys(connectionStats).length,\n                connections: connectionStats,\n            },\n            streaming: {\n                framesProcessed: this.stats.framesProcessed,\n                bytesTransferred: this.stats.bytesTransferred,\n                lastFrameTime: this.stats.lastFrameTime,\n            },\n        };\n    }\n    /**\n     * Get the actual port the server is listening on\n     */\n    getPort() {\n        if (this.server) {\n            const address = this.server.address();\n            if (address && typeof address === \"object\") {\n                return address.port;\n            }\n        }\n        return undefined;\n    }\n    /**\n     * Get number of active connections\n     */\n    getActiveConnectionCount() {\n        return this.connectionManager.getActiveConnectionCount();\n    }\n    /**\n     * Reset statistics\n     */\n    resetStats() {\n        this.stats = {\n            framesProcessed: 0,\n            bytesTransferred: 0,\n            lastFrameTime: null,\n        };\n    }\n    /**\n     * Capture a single snapshot frame from the stream.\n     * Starts the livestream if not already running, waits for a keyframe,\n     * captures the frame, and stops the stream.\n     *\n     * @param timeoutMs - Maximum time to wait for a snapshot (default: 15000ms)\n     * @returns Promise<Buffer> - Raw H.264 keyframe data\n     */\n    async captureSnapshot(timeoutMs = 15000) {\n        this.logger.info(\" Capturing snapshot...\");\n        const wasStreamRunning = this.livestreamIntendedState;\n        try {\n            // Start livestream if not already running or being started\n            if (!this.livestreamIntendedState) {\n                this.logger.debug(\"Starting livestream for snapshot capture\");\n                this.livestreamIntendedState = true;\n                await this.ensureLivestreamState();\n            }\n            else {\n                this.logger.debug(\"Livestream already intended/running, waiting for keyframe\");\n            }\n            // Wait for a keyframe\n            const snapshotBuffer = await new Promise((resolve, reject) => {\n                const timeoutHandle = setTimeout(() => {\n                    // Remove this resolver from the list\n                    this.snapshotResolvers = this.snapshotResolvers.filter((r) => r.resolve !== resolve);\n                    reject(new Error(`Snapshot capture timed out after ${timeoutMs}ms - no keyframe received`));\n                }, timeoutMs);\n                // Add resolver to the queue\n                this.snapshotResolvers.push({\n                    resolve: (buffer) => {\n                        clearTimeout(timeoutHandle);\n                        resolve(buffer);\n                    },\n                    reject: (error) => {\n                        clearTimeout(timeoutHandle);\n                        reject(error);\n                    },\n                    timestamp: Date.now(),\n                });\n                this.logger.debug(`Waiting for next keyframe (timeout: ${timeoutMs}ms)...`);\n            });\n            this.logger.info(` Snapshot captured: ${snapshotBuffer.length} bytes (keyframe)`);\n            return snapshotBuffer;\n        }\n        finally {\n            // Stop livestream if it wasn't running before\n            if (!wasStreamRunning) {\n                this.logger.debug(\"Stopping livestream after snapshot capture (was not running before)\");\n                this.livestreamIntendedState = false;\n                // Don't await here to avoid blocking the snapshot return\n                this.ensureLivestreamState().catch((error) => {\n                    this.logger.warn(`Failed to stop livestream after snapshot: ${error}`);\n                });\n            }\n        }\n    }\n}\nexports.StreamServer = StreamServer;\n//# sourceMappingURL=stream-server.js.map","\"use strict\";\n/**\n * Server level events for Eufy WebSocket API\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=events.js.map","\"use strict\";\n/**\n * Eufy Security WebSocket API Manager\n *\n * High-level API manager that provides a complete interface to the eufy-security-ws\n * WebSocket API. This class handles connection lifecycle, event management, command execution,\n * driver connection, state management, and error handling for Eufy devices.\n *\n * Acts as the main entry point for interacting with Eufy devices through the WebSocket container,\n * providing a clean abstraction over the raw WebSocket protocol.\n *\n * @example Basic Usage\n * ```typescript\n * const client = new ApiManager(\"ws://localhost:3000\");\n * await client.connect();\n * await client.connectDriver();\n * await client.startListening();\n *\n * // Listen for device events\n * client.addEventListener(\"motion_detected\", (event) => {\n *   console.log(\"Motion detected on device:\", event.serialNumber);\n * });\n *\n * // Send commands\n * const devices = await client.sendCommand(\"server.get_devices\");\n * ```\n *\n * @public\n * @since 1.0.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ApiManager = void 0;\nconst websocket_client_1 = require(\"./websocket-client\");\nconst client_state_1 = require(\"./client-state\");\nconst constants_1 = require(\"./server/constants\");\nconst constants_2 = require(\"./driver/constants\");\nconst commands_1 = require(\"./types/commands\");\n// Import enhanced command API\nconst api_manager_commands_1 = require(\"./api-manager-commands\");\n/**\n * High-Level API Manager for Eufy Security WebSocket API\n *\n * Main interface for interacting with the eufy-security-ws container. Provides\n * a complete API for managing connections, handling events, and executing commands\n * with proper state management and error handling.\n *\n * The API Manager automatically handles:\n * - WebSocket connection establishment and management\n * - Schema version negotiation with the server\n * - Driver connection and initialization\n * - Event listener registration and dispatching\n * - Command execution with type safety\n * - Connection state tracking and error recovery\n *\n * This class is the recommended entry point for all Eufy WebSocket API operations.\n */\nclass ApiManager {\n    /**\n     * Create a new API Manager instance\n     *\n     * Initializes the WebSocket client, state manager, and sets up all necessary\n     * event handlers for proper API operation. The client will be ready to connect\n     * after construction.\n     *\n     * @param wsUrl - WebSocket server URL (e.g., 'ws://localhost:3000')\n     * @param logger - Logger instance for logging\n     */\n    constructor(wsUrl, logger) {\n        this.logger = logger;\n        // Schema configuration\n        this.CLIENT_MIN_SCHEMA = 13;\n        this.CLIENT_PREFERRED_SCHEMA = 21;\n        // Event listeners\n        this.eventListeners = new Map();\n        this.listenerIdCounter = 0;\n        // Error handlers\n        this.errorHandlers = [];\n        // CAPTCHA/MFA state\n        this.pendingCaptcha = null;\n        this.pendingMfa = null;\n        this.stateManager = new client_state_1.ClientStateManager(logger);\n        this.client = new websocket_client_1.WebSocketClient(wsUrl, this.stateManager, logger);\n        this.setupEventHandlers();\n    }\n    // ================= STATE MANAGEMENT =================\n    /**\n     * Get current client state snapshot\n     *\n     * @returns Current state including connection status, schema info, and counters\n     */\n    getState() {\n        return this.stateManager.getState();\n    }\n    /**\n     * Subscribe to client state changes\n     *\n     * @param callback - Function to call when state changes occur\n     * @returns Unsubscribe function to remove the listener\n     */\n    onStateChange(callback) {\n        return this.stateManager.onStateChange(callback);\n    }\n    /**\n     * Enhanced command API with more elegant fluent interface\n     *\n     * Provides builder pattern and method-based command execution:\n     * - api.commands.device(\"12345\").getProperties()\n     * - api.commands.driver().connect()\n     * - api.commands.command(DEVICE_COMMANDS.GET_PROPERTIES, { serialNumber: \"12345\" })\n     */\n    get commands() {\n        if (!this._enhancedCommands) {\n            this._enhancedCommands = new api_manager_commands_1.EnhancedCommandAPI(this);\n        }\n        return this._enhancedCommands;\n    }\n    // ================= EVENT LISTENERS =================\n    /**\n     * Register an event listener for WebSocket events\n     *\n     * Allows registration of event handlers with optional filtering by event source\n     * and device serial number. Useful for listening to specific device events\n     * or filtering events by type.\n     *\n     * @param eventType - Type of event to listen for (strongly typed event identifier)\n     * @param eventCallback - Callback function to invoke when matching events occur\n     * @param options - Optional filter criteria\n     * @param options.source - Only process events from this source (server, driver, device, station)\n     * @param options.serialNumber - Only process events from this device serial number\n     * @returns Function to call to remove this event listener\n     */\n    addEventListener(eventType, eventCallback, options) {\n        const listenerId = `listener_${eventType}_${++this.listenerIdCounter}`;\n        const listener = {\n            id: listenerId,\n            eventType: eventType,\n            eventCallback: eventCallback,\n            source: options?.source,\n            serialNumber: options?.serialNumber,\n        };\n        this.eventListeners.set(listenerId, listener);\n        this.stateManager.setEventListenerCount(this.eventListeners.size);\n        // Return a function that removes this specific listener\n        return () => {\n            const removed = this.eventListeners.delete(listenerId);\n            if (removed) {\n                this.stateManager.setEventListenerCount(this.eventListeners.size);\n            }\n            return removed;\n        };\n    }\n    /**\n     * Remove a specific event listener by ID\n     *\n     * @deprecated Use the function returned by addEventListener() instead.\n     * The new function-based API is more ergonomic and less error-prone.\n     *\n     * @param listenerId - Unique listener ID returned by addEventListener\n     * @returns true if listener was found and removed, false otherwise\n     */\n    removeEventListener(listenerId) {\n        const removed = this.eventListeners.delete(listenerId);\n        if (removed) {\n            this.stateManager.setEventListenerCount(this.eventListeners.size);\n        }\n        return removed;\n    }\n    /**\n     * Remove all event listeners of a specific type\n     *\n     * Removes all registered listeners that match the specified event type.\n     * Uses strongly typed event identifiers for precise filtering.\n     *\n     * @param eventType - Type of events to stop listening for (strongly typed event identifier)\n     * @returns Number of listeners removed\n     */\n    removeEventListenersByType(eventType) {\n        let removedCount = 0;\n        for (const [id, listener] of this.eventListeners) {\n            if (listener.eventType === eventType) {\n                this.eventListeners.delete(id);\n                removedCount++;\n            }\n        }\n        this.stateManager.setEventListenerCount(this.eventListeners.size);\n        return removedCount;\n    }\n    /**\n     * Remove all event listeners for multiple event types\n     *\n     * Efficiently removes all listeners for the specified event types.\n     * Useful for cleanup or when switching contexts.\n     *\n     * @param eventTypes - Array of event types to remove listeners for\n     * @returns Number of listeners removed\n     */\n    removeEventListenersByTypes(eventTypes) {\n        let removedCount = 0;\n        const eventTypeSet = new Set(eventTypes);\n        for (const [id, listener] of this.eventListeners) {\n            if (eventTypeSet.has(listener.eventType)) {\n                this.eventListeners.delete(id);\n                removedCount++;\n            }\n        }\n        this.stateManager.setEventListenerCount(this.eventListeners.size);\n        return removedCount;\n    }\n    /**\n     * Remove all event listeners for a particular serial number and source\n     *\n     * @param serialNumber - Device or station serial number to remove listeners for\n     * @param source - (Optional) Event source to filter (e.g., 'device', 'station')\n     * @returns Number of listeners removed\n     */\n    removeEventListenersBySerialNumber(serialNumber, source) {\n        let removedCount = 0;\n        for (const [id, listener] of this.eventListeners) {\n            if (listener.serialNumber === serialNumber &&\n                (!source || listener.source === source)) {\n                this.eventListeners.delete(id);\n                removedCount++;\n            }\n        }\n        this.stateManager.setEventListenerCount(this.eventListeners.size);\n        return removedCount;\n    }\n    /**\n     * Remove all registered event listeners\n     *\n     * @returns Number of listeners removed\n     */\n    removeAllEventListeners() {\n        const count = this.eventListeners.size;\n        this.eventListeners.clear();\n        this.stateManager.setEventListenerCount(0);\n        return count;\n    }\n    /**\n     * Get all registered event listeners (for debugging/monitoring)\n     *\n     * Returns a snapshot of currently registered listeners for debugging purposes.\n     * The returned array contains read-only information about listeners.\n     *\n     * @returns Array of listener information (without callback functions)\n     */\n    getEventListeners() {\n        return Array.from(this.eventListeners.values()).map((listener) => ({\n            id: listener.id,\n            eventType: listener.eventType,\n            source: listener.source,\n            serialNumber: listener.serialNumber,\n        }));\n    }\n    // ================= CONNECTION MANAGEMENT =================\n    /**\n     * Establish connection to the WebSocket server\n     *\n     * Initiates connection to the server and automatically handles schema negotiation.\n     * The connection process includes version negotiation and API schema setup.\n     *\n     * @throws Error if connection fails or schema negotiation fails\n     */\n    async connect() {\n        try {\n            await this.client.connect();\n        }\n        catch (error) {\n            this.stateManager.setError(error);\n            throw error;\n        }\n    }\n    /**\n     * Disconnect from the WebSocket server\n     *\n     * Gracefully closes the WebSocket connection and resets driver connection state.\n     */\n    disconnect() {\n        this.client.disconnect();\n    }\n    /**\n     * Check if client is fully connected and ready for API calls\n     *\n     * @returns true if WebSocket is connected and schema negotiation is complete\n     */\n    isConnected() {\n        return this.stateManager.isReady();\n    }\n    /**\n     * Check if driver connection is established\n     *\n     * @returns true if driver.connect command has been successfully executed\n     */\n    isDriverConnected() {\n        return this.stateManager.getState().driverConnected;\n    }\n    /**\n     * Get current schema compatibility information\n     *\n     * @returns Schema negotiation details or null if not yet negotiated\n     */\n    getSchemaInfo() {\n        return this.stateManager.getState().schemaInfo;\n    }\n    /**\n     * Execute a typed command with parameters and get typed response\n     *\n     * Sends a command to the WebSocket API with full type safety. Commands are\n     * validated against supported command types and proper parameter types are\n     * enforced at compile time. Includes automatic retry with exponential backoff.\n     *\n     * @param command - Command constant (e.g., DEVICE_COMMANDS.GET_PROPERTIES)\n     * @param params - Command parameters (type-checked based on command)\n     * @returns Promise resolving to typed response data\n     * @throws {Error} Client not ready error\n     * @throws {Error} Unsupported command error\n     * @throws {Error} Server error or timeout after retries\n     *\n     * @example\n     * ```typescript\n     * // Get device properties\n     * const properties = await client.sendCommand(DEVICE_COMMANDS.GET_PROPERTIES, {\n     *   serialNumber: \"T8210N20123456789\"\n     * });\n     *\n     * // Commands without parameters\n     * await client.sendCommand(DRIVER_COMMANDS.CONNECT);\n     * ```\n     */\n    async sendCommand(command, params = {}) {\n        if (command !== constants_1.SERVER_COMMANDS.SET_API_SCHEMA &&\n            !this.stateManager.isReady()) {\n            throw new Error(\"Client not ready. Cannot send commands.\");\n        }\n        if (!(0, commands_1.isSupportedCommand)(command)) {\n            throw new Error(`Unsupported command: ${command}`);\n        }\n        const fullCommand = {\n            messageId: this.generateMessageId(command),\n            command,\n            ...params,\n        };\n        // Retry configuration\n        const MAX_RETRIES = 3;\n        const BASE_DELAY = 250; // milliseconds\n        let lastError;\n        for (let attempt = 1; attempt <= MAX_RETRIES; attempt++) {\n            try {\n                const response = await this.client.sendMessage(fullCommand);\n                return response;\n            }\n            catch (error) {\n                lastError = error;\n                if (this.logger) {\n                    this.logger.info(`sendCommand failed (attempt ${attempt}/${MAX_RETRIES}) for command: ${command}`, error);\n                }\n                // Exponential backoff with jitter for retries\n                if (attempt < MAX_RETRIES) {\n                    const delay = BASE_DELAY * Math.pow(2, attempt - 1);\n                    const jitter = Math.random() * 0.1 * delay; // 10% jitter\n                    await new Promise((resolve) => setTimeout(resolve, delay + jitter));\n                }\n            }\n        }\n        throw (lastError ||\n            new Error(`sendCommand failed for command: ${command} after ${MAX_RETRIES} attempts`));\n    }\n    /**\n     * Connect to the Eufy driver\n     *\n     * Establishes connection to the Eufy cloud driver, which enables real-time\n     * event streaming and fresh data from Eufy's cloud services. Many basic\n     * device and station commands may work without driver connection using\n     * cached data, but this is required for live events and cloud-based operations.\n     *\n     * @throws Error if client not ready or driver connection fails\n     */\n    async connectDriver() {\n        if (!this.stateManager.isReady()) {\n            throw new Error(\"Client not ready. Cannot connect driver.\");\n        }\n        await this.sendCommand(constants_2.DRIVER_COMMANDS.CONNECT);\n        this.stateManager.setDriverConnected(true);\n    }\n    /**\n     * Start listening for real-time events\n     *\n     * Activates real-time event streaming from the server. Events will be\n     * dispatched to registered event listeners. This should be called after\n     * driver connection is established. Also updates driver connection state\n     * based on the server response.\n     *\n     * @returns Promise resolving to server response with listening status\n     * @throws Error if client not ready or command fails\n     */\n    async startListening() {\n        if (!this.stateManager.isReady()) {\n            throw new Error(\"Client not ready. Cannot start listening.\");\n        }\n        const result = await this.sendCommand(constants_1.SERVER_COMMANDS.START_LISTENING);\n        const driverConnected = result.state.driver.connected;\n        if (this.logger) {\n            this.logger.info(`startListening response: driver connected = ${driverConnected}`);\n        }\n        this.stateManager.setDriverConnected(driverConnected);\n        return result;\n    }\n    // ================= PRIVATE METHODS =================\n    /**\n     * Set up all WebSocket event handlers\n     *\n     * Configures the WebSocket client with handlers for connection events,\n     * version negotiation, and real-time event processing.\n     */\n    setupEventHandlers() {\n        this.client.onConnected(() => {\n            // Connection established, waiting for version message\n        });\n        this.client.onDisconnected(() => {\n            this.stateManager.setDriverConnected(false);\n        });\n        this.client.onVersionMessage(async (message) => {\n            try {\n                await this.handleVersionMessage(message);\n            }\n            catch (error) {\n                // Re-trigger the error through the error handler system\n                this.stateManager.setError(error);\n                this.errorHandlers.forEach((handler) => {\n                    try {\n                        handler(error);\n                    }\n                    catch (handlerError) {\n                        this.logger.error(\"Error in error handler:\", handlerError);\n                    }\n                });\n            }\n        });\n        this.client.onEventMessage((message) => {\n            this.handleEventMessage(message);\n        });\n        this.client.onError((error) => {\n            this.stateManager.setError(error);\n            // Call all registered error handlers\n            this.errorHandlers.forEach((handler) => {\n                try {\n                    handler(error);\n                }\n                catch (handlerError) {\n                    // Prevent handler errors from breaking the error flow\n                    this.logger.error(\"Error in error handler:\", handlerError);\n                }\n            });\n        });\n    }\n    /**\n     * Handle server version message and perform schema negotiation\n     *\n     * Processes the server's version information and negotiates a compatible\n     * API schema version. Uses minimum required schema (13) and preferred\n     * schema (21). Sets up the API schema and marks schema setup as complete.\n     *\n     * @param versionMessage - Version message from server containing schema info.\n     * @throws Error if schema incompatibility is detected.\n     */\n    async handleVersionMessage(versionMessage) {\n        const serverMinSchema = versionMessage.minSchemaVersion;\n        const serverMaxSchema = versionMessage.maxSchemaVersion;\n        // Check if server supports our minimum schema requirement\n        const isCompatible = serverMaxSchema >= this.CLIENT_MIN_SCHEMA;\n        // Determine which schema to use:\n        // 1. Try preferred schema if supported by server\n        // 2. Fall back to highest schema supported by both (capped at server max)\n        // 3. Ensure it's at least our minimum requirement\n        const negotiatedSchema = isCompatible\n            ? this.CLIENT_PREFERRED_SCHEMA >= serverMinSchema &&\n                this.CLIENT_PREFERRED_SCHEMA <= serverMaxSchema\n                ? this.CLIENT_PREFERRED_SCHEMA\n                : Math.max(this.CLIENT_MIN_SCHEMA, serverMaxSchema)\n            : 0; // Will cause compatibility error below\n        const schemaInfo = {\n            clientMinSchema: this.CLIENT_MIN_SCHEMA,\n            clientPreferredSchema: this.CLIENT_PREFERRED_SCHEMA,\n            serverMinSchema,\n            serverMaxSchema,\n            negotiatedSchema,\n            isCompatible,\n        };\n        this.stateManager.setSchemaInfo(schemaInfo);\n        if (!isCompatible) {\n            const error = new Error(`Schema incompatibility: Server supports ${serverMinSchema}-${serverMaxSchema}, ` +\n                `Client requires minimum ${this.CLIENT_MIN_SCHEMA} (preferred ${this.CLIENT_PREFERRED_SCHEMA})`);\n            this.stateManager.setError(error);\n            throw error;\n        }\n        // Use preferred schema if supported, otherwise use negotiated\n        const targetSchema = this.CLIENT_PREFERRED_SCHEMA >= serverMinSchema &&\n            this.CLIENT_PREFERRED_SCHEMA <= serverMaxSchema\n            ? this.CLIENT_PREFERRED_SCHEMA\n            : negotiatedSchema;\n        try {\n            await this.sendCommand(constants_1.SERVER_COMMANDS.SET_API_SCHEMA, {\n                schemaVersion: targetSchema,\n            });\n            schemaInfo.negotiatedSchema = targetSchema;\n            this.stateManager.setSchemaInfo(schemaInfo);\n            this.stateManager.setSchemaSetupComplete(true);\n        }\n        catch (error) {\n            this.stateManager.setError(error);\n            throw error;\n        }\n    }\n    /**\n     * Process incoming event messages and dispatch to listeners\n     *\n     * Routes event messages to registered event listeners based on filtering\n     * criteria (source and serial number). Handles errors in individual\n     * listeners without affecting others.\n     *\n     * @param message - Event message from server\n     */\n    /**\n     * Handle incoming event messages and dispatch to registered listeners\n     *\n     * Processes event messages from the WebSocket connection and dispatches them\n     * to registered event listeners with proper filtering by event type, source,\n     * and serial number. Optimized for performance with early filtering and\n     * efficient iteration.\n     *\n     * @param message - Event message from WebSocket\n     * @private\n     */\n    handleEventMessage(message) {\n        const eventPayload = message.event;\n        const eventType = eventPayload?.event;\n        // Handle driver connection state events internally first\n        this.handleDriverConnectionStateEvents(eventPayload);\n        // Early exit if no listeners registered\n        if (this.eventListeners.size === 0) {\n            return;\n        }\n        // Performance optimization: filter listeners by event type first\n        const matchingListeners = [];\n        for (const listener of this.eventListeners.values()) {\n            if (listener.eventType === eventType) {\n                matchingListeners.push(listener);\n            }\n        }\n        // Early exit if no listeners for this event type\n        if (matchingListeners.length === 0) {\n            return;\n        }\n        // Apply additional filters and dispatch\n        for (const listener of matchingListeners) {\n            try {\n                // Apply filtering based on source if specified\n                if (listener.source && eventPayload?.source !== listener.source) {\n                    continue;\n                }\n                // Apply filtering based on serialNumber if specified\n                if (listener.serialNumber &&\n                    (!eventPayload ||\n                        !(\"serialNumber\" in eventPayload) ||\n                        eventPayload.serialNumber !== listener.serialNumber)) {\n                    continue;\n                }\n                listener.eventCallback(eventPayload);\n            }\n            catch (error) {\n                // Log error but don't break other listeners\n                if (this.logger) {\n                    this.logger.error(\"Error in event listener:\", error);\n                }\n                else {\n                    // Fallback to console if no logger available\n                    console.error(\"Error in event listener:\", error);\n                }\n            }\n        }\n    }\n    /**\n     * Handle driver connection state events internally\n     *\n     * Listens for driver connected/disconnected events and updates the state manager\n     * accordingly. This ensures that driver connection state is managed centrally\n     * in the API manager without requiring external event handling.\n     *\n     * @param eventPayload - Event payload from the WebSocket event message\n     */\n    handleDriverConnectionStateEvents(eventPayload) {\n        if (!eventPayload ||\n            typeof eventPayload !== \"object\" ||\n            !eventPayload.source ||\n            !eventPayload.event) {\n            return;\n        }\n        // Check if this is a driver event\n        if (eventPayload.source === \"driver\") {\n            switch (eventPayload.event) {\n                case constants_2.DRIVER_EVENTS.CONNECTED:\n                    if (this.logger) {\n                        this.logger.info(\"Driver connected event received, updating state to connected\");\n                    }\n                    this.stateManager.setDriverConnected(true);\n                    break;\n                case constants_2.DRIVER_EVENTS.DISCONNECTED:\n                    if (this.logger) {\n                        this.logger.info(\"Driver disconnected event received, updating state to disconnected\");\n                    }\n                    this.stateManager.setDriverConnected(false);\n                    break;\n                case constants_2.DRIVER_EVENTS.CAPTCHA_REQUEST:\n                    if (this.logger) {\n                        this.logger.info(\"CAPTCHA request event received\");\n                    }\n                    // Handle CAPTCHA request - this will be caught by the connect flow\n                    this.handleCaptchaRequest(eventPayload);\n                    break;\n                case constants_2.DRIVER_EVENTS.VERIFY_CODE:\n                    if (this.logger) {\n                        this.logger.info(\"MFA verification code request event received\");\n                    }\n                    // Handle MFA request - this will be caught by the connect flow\n                    this.handleMfaRequest(eventPayload);\n                    break;\n            }\n        }\n    }\n    /**\n     * Handle CAPTCHA request event\n     *\n     * Called when the server requests CAPTCHA authentication. Extracts the CAPTCHA\n     * information and stores it for later retrieval by the CLI.\n     *\n     * @param eventPayload - CAPTCHA request event payload\n     */\n    handleCaptchaRequest(eventPayload) {\n        const captchaId = eventPayload.captchaId;\n        const captcha = eventPayload.captcha;\n        if (this.logger) {\n            this.logger.info(`CAPTCHA required - ID: ${captchaId}`);\n        }\n        // Store CAPTCHA info for later retrieval\n        this.pendingCaptcha = { captchaId, captcha };\n        // Don't throw here - let the CLI check for pending CAPTCHA after operations\n    }\n    /**\n     * Handle MFA verification code request event\n     *\n     * Called when the server requests MFA verification. Stores the information\n     * for later retrieval by the CLI.\n     *\n     * @param eventPayload - MFA request event payload\n     */\n    handleMfaRequest(eventPayload) {\n        const methods = eventPayload.methods || [];\n        if (this.logger) {\n            this.logger.info(`MFA verification required - methods: ${methods.join(\", \")}`);\n        }\n        // Store MFA info for later retrieval\n        this.pendingMfa = { methods };\n        // Don't throw here - let the CLI check for pending MFA after operations\n    }\n    /**\n     * Generate unique message ID for command correlation\n     *\n     * Creates a unique identifier for each command message to enable proper\n     * request-response correlation in the WebSocket protocol.\n     *\n     * @param command - Command type being sent.\n     * @returns Unique message identifier.\n     */\n    generateMessageId(command) {\n        return `${command}_${Date.now()}_${Math.random().toString(36).substr(2, 9)}`;\n    }\n    // ================= LOGGING =================\n    /**\n     * Get pending CAPTCHA information\n     *\n     * Returns CAPTCHA information from the last CAPTCHA request event.\n     * This is used by the CLI to display CAPTCHA information to the user.\n     *\n     * @returns CAPTCHA information or null if no CAPTCHA is pending\n     */\n    getPendingCaptcha() {\n        return this.pendingCaptcha;\n    }\n    /**\n     * Clear pending CAPTCHA information\n     *\n     * Clears any stored CAPTCHA information after it has been used.\n     */\n    clearPendingCaptcha() {\n        this.pendingCaptcha = null;\n    }\n    /**\n     * Get pending MFA information\n     *\n     * Returns MFA information from the last MFA request event.\n     * This is used by the CLI to display MFA information to the user.\n     *\n     * @returns MFA information or null if no MFA is pending\n     */\n    getPendingMfa() {\n        return this.pendingMfa;\n    }\n    /**\n     * Clear pending MFA information\n     *\n     * Clears any stored MFA information after it has been used.\n     */\n    clearPendingMfa() {\n        this.pendingMfa = null;\n    }\n    /**\n     * Register error handler for WebSocket and API errors\n     *\n     * @param handler - Callback function to handle errors\n     */\n    onError(handler) {\n        this.errorHandlers.push(handler);\n    }\n}\nexports.ApiManager = ApiManager;\n//# sourceMappingURL=api-manager.js.map","'use strict';\n\nconst WebSocket = require('./lib/websocket');\n\nWebSocket.createWebSocketStream = require('./lib/stream');\nWebSocket.Server = require('./lib/websocket-server');\nWebSocket.Receiver = require('./lib/receiver');\nWebSocket.Sender = require('./lib/sender');\n\nWebSocket.WebSocket = WebSocket;\nWebSocket.WebSocketServer = WebSocket.Server;\n\nmodule.exports = WebSocket;\n","\"use strict\";\n/**\n * Connection Manager - Simple TCP client connection management\n *\n * Manages TCP client connections for the stream server, handling connection\n * lifecycle, data broadcasting, and connection limits. Emits events for\n * connection state changes.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ConnectionManager = void 0;\nconst events_1 = require(\"events\");\n/**\n * Simple connection manager for TCP clients\n *\n * Handles incoming TCP socket connections, manages connection lifecycle,\n * broadcasts data to all connected clients, and enforces connection limits.\n *\n * @fires clientConnected - Emitted when a new client connects\n * @fires clientDisconnected - Emitted when a client disconnects\n *\n * @example\n * ```typescript\n * const manager = new ConnectionManager(logger);\n *\n * manager.on('clientConnected', (id, info) => {\n *   console.log(`Client ${id} connected from ${info.remoteAddress}`);\n * });\n *\n * server.on('connection', (socket) => {\n *   manager.handleConnection(socket);\n * });\n * ```\n */\nclass ConnectionManager extends events_1.EventEmitter {\n    /**\n     * Creates a new ConnectionManager instance\n     *\n     * @param logger - Logger instance compatible with tslog's Logger<ILogObj> interface\n     */\n    constructor(logger) {\n        super();\n        this.connections = new Map();\n        this.connectionInfo = new Map();\n        this.connectionCounter = 0;\n        this.maxConnections = 10;\n        this.logger = logger;\n    }\n    /**\n     * Handle a new incoming TCP client connection\n     *\n     * Accepts the socket connection, assigns a unique ID, configures socket options\n     * (no-delay, keep-alive), and sets up event handlers. Rejects connections if\n     * the maximum connection limit is reached.\n     *\n     * @param socket - TCP socket from incoming connection\n     * @fires clientConnected - Emitted with (connectionId, connectionInfo) when client connects\n     *\n     * @example\n     * ```typescript\n     * server.on('connection', (socket) => {\n     *   manager.handleConnection(socket);\n     * });\n     * ```\n     */\n    handleConnection(socket) {\n        if (this.connections.size >= this.maxConnections) {\n            this.logger.warn(`Connection limit reached (${this.maxConnections}), rejecting connection`);\n            socket.end();\n            return;\n        }\n        const connectionId = `conn_${++this.connectionCounter}`;\n        const remoteAddress = socket.remoteAddress || \"unknown\";\n        const remotePort = socket.remotePort || 0;\n        // Store connection\n        this.connections.set(connectionId, socket);\n        // Store connection info\n        const connectionInfo = {\n            id: connectionId,\n            remoteAddress,\n            remotePort,\n            connectedAt: new Date(),\n            bytesWritten: 0,\n            isActive: true,\n        };\n        this.connectionInfo.set(connectionId, connectionInfo);\n        this.logger.info(`Client connected: ${connectionId} from ${remoteAddress}:${remotePort}`);\n        // Set up socket event handlers\n        socket.on(\"close\", () => {\n            this.handleDisconnection(connectionId);\n        });\n        socket.on(\"error\", (error) => {\n            this.logger.error(`Socket error for ${connectionId}:`, error);\n            this.handleDisconnection(connectionId);\n        });\n        // Configure socket\n        socket.setNoDelay(true);\n        socket.setKeepAlive(true, 30000);\n        this.emit(\"clientConnected\", connectionId, connectionInfo);\n    }\n    /**\n     * Handle client disconnection and cleanup\n     *\n     * Removes event listeners, destroys the socket, and cleans up connection\n     * tracking data. Called automatically when socket closes or errors.\n     *\n     * @param connectionId - Unique identifier of the connection to close\n     * @fires clientDisconnected - Emitted with connectionId when client disconnects\n     * @private\n     */\n    handleDisconnection(connectionId) {\n        const socket = this.connections.get(connectionId);\n        const info = this.connectionInfo.get(connectionId);\n        if (socket) {\n            socket.removeAllListeners();\n            socket.destroy();\n            this.connections.delete(connectionId);\n        }\n        if (info) {\n            info.isActive = false;\n            this.connectionInfo.delete(connectionId);\n        }\n        this.logger.info(`Client disconnected: ${connectionId}`);\n        this.emit(\"clientDisconnected\", connectionId);\n    }\n    /**\n     * Send data to a specific client\n     *\n     * Sends the provided data buffer to a single client connection.\n     * Automatically handles disconnection if the write fails or socket is not writable.\n     * Updates bytes written statistics for successful writes.\n     *\n     * @param connectionId - The ID of the client to send data to\n     * @param data - Data buffer to send to the client\n     * @returns true if data was successfully sent, false otherwise\n     *\n     * @example\n     * ```typescript\n     * const success = manager.sendToClient('conn_1', cachedHeaderBuffer);\n     * if (!success) {\n     *   console.log('Failed to send data to client');\n     * }\n     * ```\n     */\n    sendToClient(connectionId, data) {\n        const socket = this.connections.get(connectionId);\n        if (!socket) {\n            this.logger.warn(`Cannot send to ${connectionId}: connection not found`);\n            return false;\n        }\n        try {\n            if (socket.writable) {\n                socket.write(data);\n                // Update bytes written\n                const info = this.connectionInfo.get(connectionId);\n                if (info) {\n                    info.bytesWritten += data.length;\n                }\n                this.logger.debug(`Sent ${data.length} bytes to ${connectionId}`);\n                return true;\n            }\n            else {\n                this.logger.warn(`Socket not writable for ${connectionId}`);\n                this.handleDisconnection(connectionId);\n                return false;\n            }\n        }\n        catch (error) {\n            this.logger.error(`Failed to write to ${connectionId}:`, error);\n            this.handleDisconnection(connectionId);\n            return false;\n        }\n    }\n    /**\n     * Broadcast data to all connected clients\n     *\n     * Sends the provided data buffer to all active client connections.\n     * Automatically handles disconnection for failed writes or non-writable sockets.\n     * Updates bytes written statistics for each successful write.\n     *\n     * @param data - Data buffer to broadcast to all clients\n     * @returns true if data was successfully sent to at least one client, false if no active clients\n     *\n     * @example\n     * ```typescript\n     * const success = manager.broadcast(videoDataBuffer);\n     * if (!success) {\n     *   console.log('No clients connected to receive data');\n     * }\n     * ```\n     */\n    broadcast(data) {\n        if (this.connections.size === 0) {\n            return false;\n        }\n        let successCount = 0;\n        const totalConnections = this.connections.size;\n        for (const [connectionId, socket] of this.connections) {\n            try {\n                if (socket.writable) {\n                    socket.write(data);\n                    // Update bytes written\n                    const info = this.connectionInfo.get(connectionId);\n                    if (info) {\n                        info.bytesWritten += data.length;\n                    }\n                    successCount++;\n                }\n                else {\n                    this.logger.warn(`Socket not writable for ${connectionId}`);\n                    this.handleDisconnection(connectionId);\n                }\n            }\n            catch (error) {\n                this.logger.error(`Failed to write to ${connectionId}:`, error);\n                this.handleDisconnection(connectionId);\n            }\n        }\n        this.logger.debug(`Broadcast to ${successCount}/${totalConnections} clients: ${data.length} bytes`);\n        return successCount > 0;\n    }\n    /**\n     * Get the number of currently active connections\n     *\n     * @returns Count of active client connections\n     */\n    getActiveConnectionCount() {\n        return this.connections.size;\n    }\n    /**\n     * Get detailed statistics for all connections\n     *\n     * Returns information about all current connections including connection times,\n     * bytes written, and connection status.\n     *\n     * @returns Record mapping connection IDs to their detailed information\n     *\n     * @example\n     * ```typescript\n     * const stats = manager.getConnectionStats();\n     * for (const [id, info] of Object.entries(stats)) {\n     *   console.log(`${id}: ${info.bytesWritten} bytes sent`);\n     * }\n     * ```\n     */\n    getConnectionStats() {\n        const stats = {};\n        for (const [id, info] of this.connectionInfo) {\n            stats[id] = { ...info };\n        }\n        return stats;\n    }\n    /**\n     * Close all connections and cleanup resources\n     *\n     * Closes all active client connections, removes all event listeners,\n     * and clears connection tracking data. Should be called during server shutdown.\n     *\n     * @example\n     * ```typescript\n     * // During server shutdown\n     * manager.close();\n     * console.log('All connections closed');\n     * ```\n     */\n    close() {\n        this.logger.info(`Closing ${this.connections.size} connections`);\n        for (const [connectionId, socket] of this.connections) {\n            try {\n                socket.removeAllListeners();\n                socket.destroy();\n            }\n            catch (error) {\n                this.logger.error(`Error closing connection ${connectionId}:`, error);\n            }\n        }\n        this.connections.clear();\n        this.connectionInfo.clear();\n        this.removeAllListeners();\n    }\n}\nexports.ConnectionManager = ConnectionManager;\n//# sourceMappingURL=connection-manager.js.map","\"use strict\";\n/**\n * Server module exports\n *\n * Provides all server-related constants, commands, events, and responses for the Eufy Security WebSocket Client.\n * This barrel file re-exports all server-related modules for easy import.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\ntslib_1.__exportStar(require(\"./constants\"), exports);\ntslib_1.__exportStar(require(\"./commands\"), exports);\ntslib_1.__exportStar(require(\"./events\"), exports);\ntslib_1.__exportStar(require(\"./properties\"), exports);\ntslib_1.__exportStar(require(\"./responses\"), exports);\n//# sourceMappingURL=index.js.map","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex\" }] */\n\n'use strict';\n\nconst { Duplex } = require('stream');\nconst { randomFillSync } = require('crypto');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst { EMPTY_BUFFER, kWebSocket, NOOP } = require('./constants');\nconst { isBlob, isValidStatusCode } = require('./validation');\nconst { mask: applyMask, toBuffer } = require('./buffer-util');\n\nconst kByteLength = Symbol('kByteLength');\nconst maskBuffer = Buffer.alloc(4);\nconst RANDOM_POOL_SIZE = 8 * 1024;\nlet randomPool;\nlet randomPoolPointer = RANDOM_POOL_SIZE;\n\nconst DEFAULT = 0;\nconst DEFLATING = 1;\nconst GET_BLOB_DATA = 2;\n\n/**\n * HyBi Sender implementation.\n */\nclass Sender {\n  /**\n   * Creates a Sender instance.\n   *\n   * @param {Duplex} socket The connection socket\n   * @param {Object} [extensions] An object containing the negotiated extensions\n   * @param {Function} [generateMask] The function used to generate the masking\n   *     key\n   */\n  constructor(socket, extensions, generateMask) {\n    this._extensions = extensions || {};\n\n    if (generateMask) {\n      this._generateMask = generateMask;\n      this._maskBuffer = Buffer.alloc(4);\n    }\n\n    this._socket = socket;\n\n    this._firstFragment = true;\n    this._compress = false;\n\n    this._bufferedBytes = 0;\n    this._queue = [];\n    this._state = DEFAULT;\n    this.onerror = NOOP;\n    this[kWebSocket] = undefined;\n  }\n\n  /**\n   * Frames a piece of data according to the HyBi WebSocket protocol.\n   *\n   * @param {(Buffer|String)} data The data to frame\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @return {(Buffer|String)[]} The framed data\n   * @public\n   */\n  static frame(data, options) {\n    let mask;\n    let merge = false;\n    let offset = 2;\n    let skipMasking = false;\n\n    if (options.mask) {\n      mask = options.maskBuffer || maskBuffer;\n\n      if (options.generateMask) {\n        options.generateMask(mask);\n      } else {\n        if (randomPoolPointer === RANDOM_POOL_SIZE) {\n          /* istanbul ignore else  */\n          if (randomPool === undefined) {\n            //\n            // This is lazily initialized because server-sent frames must not\n            // be masked so it may never be used.\n            //\n            randomPool = Buffer.alloc(RANDOM_POOL_SIZE);\n          }\n\n          randomFillSync(randomPool, 0, RANDOM_POOL_SIZE);\n          randomPoolPointer = 0;\n        }\n\n        mask[0] = randomPool[randomPoolPointer++];\n        mask[1] = randomPool[randomPoolPointer++];\n        mask[2] = randomPool[randomPoolPointer++];\n        mask[3] = randomPool[randomPoolPointer++];\n      }\n\n      skipMasking = (mask[0] | mask[1] | mask[2] | mask[3]) === 0;\n      offset = 6;\n    }\n\n    let dataLength;\n\n    if (typeof data === 'string') {\n      if (\n        (!options.mask || skipMasking) &&\n        options[kByteLength] !== undefined\n      ) {\n        dataLength = options[kByteLength];\n      } else {\n        data = Buffer.from(data);\n        dataLength = data.length;\n      }\n    } else {\n      dataLength = data.length;\n      merge = options.mask && options.readOnly && !skipMasking;\n    }\n\n    let payloadLength = dataLength;\n\n    if (dataLength >= 65536) {\n      offset += 8;\n      payloadLength = 127;\n    } else if (dataLength > 125) {\n      offset += 2;\n      payloadLength = 126;\n    }\n\n    const target = Buffer.allocUnsafe(merge ? dataLength + offset : offset);\n\n    target[0] = options.fin ? options.opcode | 0x80 : options.opcode;\n    if (options.rsv1) target[0] |= 0x40;\n\n    target[1] = payloadLength;\n\n    if (payloadLength === 126) {\n      target.writeUInt16BE(dataLength, 2);\n    } else if (payloadLength === 127) {\n      target[2] = target[3] = 0;\n      target.writeUIntBE(dataLength, 4, 6);\n    }\n\n    if (!options.mask) return [target, data];\n\n    target[1] |= 0x80;\n    target[offset - 4] = mask[0];\n    target[offset - 3] = mask[1];\n    target[offset - 2] = mask[2];\n    target[offset - 1] = mask[3];\n\n    if (skipMasking) return [target, data];\n\n    if (merge) {\n      applyMask(data, mask, target, offset, dataLength);\n      return [target];\n    }\n\n    applyMask(data, mask, data, 0, dataLength);\n    return [target, data];\n  }\n\n  /**\n   * Sends a close message to the other peer.\n   *\n   * @param {Number} [code] The status code component of the body\n   * @param {(String|Buffer)} [data] The message component of the body\n   * @param {Boolean} [mask=false] Specifies whether or not to mask the message\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  close(code, data, mask, cb) {\n    let buf;\n\n    if (code === undefined) {\n      buf = EMPTY_BUFFER;\n    } else if (typeof code !== 'number' || !isValidStatusCode(code)) {\n      throw new TypeError('First argument must be a valid error code number');\n    } else if (data === undefined || !data.length) {\n      buf = Buffer.allocUnsafe(2);\n      buf.writeUInt16BE(code, 0);\n    } else {\n      const length = Buffer.byteLength(data);\n\n      if (length > 123) {\n        throw new RangeError('The message must not be greater than 123 bytes');\n      }\n\n      buf = Buffer.allocUnsafe(2 + length);\n      buf.writeUInt16BE(code, 0);\n\n      if (typeof data === 'string') {\n        buf.write(data, 2);\n      } else {\n        buf.set(data, 2);\n      }\n    }\n\n    const options = {\n      [kByteLength]: buf.length,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x08,\n      readOnly: false,\n      rsv1: false\n    };\n\n    if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, buf, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(buf, options), cb);\n    }\n  }\n\n  /**\n   * Sends a ping message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  ping(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x09,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a pong message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Boolean} [mask=false] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  pong(data, mask, cb) {\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (byteLength > 125) {\n      throw new RangeError('The data size must not be greater than 125 bytes');\n    }\n\n    const options = {\n      [kByteLength]: byteLength,\n      fin: true,\n      generateMask: this._generateMask,\n      mask,\n      maskBuffer: this._maskBuffer,\n      opcode: 0x0a,\n      readOnly,\n      rsv1: false\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, false, options, cb]);\n      } else {\n        this.getBlobData(data, false, options, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, false, options, cb]);\n    } else {\n      this.sendFrame(Sender.frame(data, options), cb);\n    }\n  }\n\n  /**\n   * Sends a data message to the other peer.\n   *\n   * @param {*} data The message to send\n   * @param {Object} options Options object\n   * @param {Boolean} [options.binary=false] Specifies whether `data` is binary\n   *     or text\n   * @param {Boolean} [options.compress=false] Specifies whether or not to\n   *     compress `data`\n   * @param {Boolean} [options.fin=false] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Function} [cb] Callback\n   * @public\n   */\n  send(data, options, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n    let opcode = options.binary ? 2 : 1;\n    let rsv1 = options.compress;\n\n    let byteLength;\n    let readOnly;\n\n    if (typeof data === 'string') {\n      byteLength = Buffer.byteLength(data);\n      readOnly = false;\n    } else if (isBlob(data)) {\n      byteLength = data.size;\n      readOnly = false;\n    } else {\n      data = toBuffer(data);\n      byteLength = data.length;\n      readOnly = toBuffer.readOnly;\n    }\n\n    if (this._firstFragment) {\n      this._firstFragment = false;\n      if (\n        rsv1 &&\n        perMessageDeflate &&\n        perMessageDeflate.params[\n          perMessageDeflate._isServer\n            ? 'server_no_context_takeover'\n            : 'client_no_context_takeover'\n        ]\n      ) {\n        rsv1 = byteLength >= perMessageDeflate._threshold;\n      }\n      this._compress = rsv1;\n    } else {\n      rsv1 = false;\n      opcode = 0;\n    }\n\n    if (options.fin) this._firstFragment = true;\n\n    const opts = {\n      [kByteLength]: byteLength,\n      fin: options.fin,\n      generateMask: this._generateMask,\n      mask: options.mask,\n      maskBuffer: this._maskBuffer,\n      opcode,\n      readOnly,\n      rsv1\n    };\n\n    if (isBlob(data)) {\n      if (this._state !== DEFAULT) {\n        this.enqueue([this.getBlobData, data, this._compress, opts, cb]);\n      } else {\n        this.getBlobData(data, this._compress, opts, cb);\n      }\n    } else if (this._state !== DEFAULT) {\n      this.enqueue([this.dispatch, data, this._compress, opts, cb]);\n    } else {\n      this.dispatch(data, this._compress, opts, cb);\n    }\n  }\n\n  /**\n   * Gets the contents of a blob as binary data.\n   *\n   * @param {Blob} blob The blob\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     the data\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  getBlobData(blob, compress, options, cb) {\n    this._bufferedBytes += options[kByteLength];\n    this._state = GET_BLOB_DATA;\n\n    blob\n      .arrayBuffer()\n      .then((arrayBuffer) => {\n        if (this._socket.destroyed) {\n          const err = new Error(\n            'The socket was closed while the blob was being read'\n          );\n\n          //\n          // `callCallbacks` is called in the next tick to ensure that errors\n          // that might be thrown in the callbacks behave like errors thrown\n          // outside the promise chain.\n          //\n          process.nextTick(callCallbacks, this, err, cb);\n          return;\n        }\n\n        this._bufferedBytes -= options[kByteLength];\n        const data = toBuffer(arrayBuffer);\n\n        if (!compress) {\n          this._state = DEFAULT;\n          this.sendFrame(Sender.frame(data, options), cb);\n          this.dequeue();\n        } else {\n          this.dispatch(data, compress, options, cb);\n        }\n      })\n      .catch((err) => {\n        //\n        // `onError` is called in the next tick for the same reason that\n        // `callCallbacks` above is.\n        //\n        process.nextTick(onError, this, err, cb);\n      });\n  }\n\n  /**\n   * Dispatches a message.\n   *\n   * @param {(Buffer|String)} data The message to send\n   * @param {Boolean} [compress=false] Specifies whether or not to compress\n   *     `data`\n   * @param {Object} options Options object\n   * @param {Boolean} [options.fin=false] Specifies whether or not to set the\n   *     FIN bit\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Boolean} [options.mask=false] Specifies whether or not to mask\n   *     `data`\n   * @param {Buffer} [options.maskBuffer] The buffer used to store the masking\n   *     key\n   * @param {Number} options.opcode The opcode\n   * @param {Boolean} [options.readOnly=false] Specifies whether `data` can be\n   *     modified\n   * @param {Boolean} [options.rsv1=false] Specifies whether or not to set the\n   *     RSV1 bit\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  dispatch(data, compress, options, cb) {\n    if (!compress) {\n      this.sendFrame(Sender.frame(data, options), cb);\n      return;\n    }\n\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    this._bufferedBytes += options[kByteLength];\n    this._state = DEFLATING;\n    perMessageDeflate.compress(data, options.fin, (_, buf) => {\n      if (this._socket.destroyed) {\n        const err = new Error(\n          'The socket was closed while data was being compressed'\n        );\n\n        callCallbacks(this, err, cb);\n        return;\n      }\n\n      this._bufferedBytes -= options[kByteLength];\n      this._state = DEFAULT;\n      options.readOnly = false;\n      this.sendFrame(Sender.frame(buf, options), cb);\n      this.dequeue();\n    });\n  }\n\n  /**\n   * Executes queued send operations.\n   *\n   * @private\n   */\n  dequeue() {\n    while (this._state === DEFAULT && this._queue.length) {\n      const params = this._queue.shift();\n\n      this._bufferedBytes -= params[3][kByteLength];\n      Reflect.apply(params[0], this, params.slice(1));\n    }\n  }\n\n  /**\n   * Enqueues a send operation.\n   *\n   * @param {Array} params Send operation parameters.\n   * @private\n   */\n  enqueue(params) {\n    this._bufferedBytes += params[3][kByteLength];\n    this._queue.push(params);\n  }\n\n  /**\n   * Sends a frame.\n   *\n   * @param {(Buffer | String)[]} list The frame to send\n   * @param {Function} [cb] Callback\n   * @private\n   */\n  sendFrame(list, cb) {\n    if (list.length === 2) {\n      this._socket.cork();\n      this._socket.write(list[0]);\n      this._socket.write(list[1], cb);\n      this._socket.uncork();\n    } else {\n      this._socket.write(list[0], cb);\n    }\n  }\n}\n\nmodule.exports = Sender;\n\n/**\n * Calls queued callbacks with an error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error to call the callbacks with\n * @param {Function} [cb] The first callback\n * @private\n */\nfunction callCallbacks(sender, err, cb) {\n  if (typeof cb === 'function') cb(err);\n\n  for (let i = 0; i < sender._queue.length; i++) {\n    const params = sender._queue[i];\n    const callback = params[params.length - 1];\n\n    if (typeof callback === 'function') callback(err);\n  }\n}\n\n/**\n * Handles a `Sender` error.\n *\n * @param {Sender} sender The `Sender` instance\n * @param {Error} err The error\n * @param {Function} [cb] The first pending callback\n * @private\n */\nfunction onError(sender, err, cb) {\n  callCallbacks(sender, err, cb);\n  sender.onerror(err);\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.prettyLogStyles = void 0;\nexports.prettyLogStyles = {\n    reset: [0, 0],\n    bold: [1, 22],\n    dim: [2, 22],\n    italic: [3, 23],\n    underline: [4, 24],\n    overline: [53, 55],\n    inverse: [7, 27],\n    hidden: [8, 28],\n    strikethrough: [9, 29],\n    black: [30, 39],\n    red: [31, 39],\n    green: [32, 39],\n    yellow: [33, 39],\n    blue: [34, 39],\n    magenta: [35, 39],\n    cyan: [36, 39],\n    white: [37, 39],\n    blackBright: [90, 39],\n    redBright: [91, 39],\n    greenBright: [92, 39],\n    yellowBright: [93, 39],\n    blueBright: [94, 39],\n    magentaBright: [95, 39],\n    cyanBright: [96, 39],\n    whiteBright: [97, 39],\n    bgBlack: [40, 49],\n    bgRed: [41, 49],\n    bgGreen: [42, 49],\n    bgYellow: [43, 49],\n    bgBlue: [44, 49],\n    bgMagenta: [45, 49],\n    bgCyan: [46, 49],\n    bgWhite: [47, 49],\n    bgBlackBright: [100, 49],\n    bgRedBright: [101, 49],\n    bgGreenBright: [102, 49],\n    bgYellowBright: [103, 49],\n    bgBlueBright: [104, 49],\n    bgMagentaBright: [105, 49],\n    bgCyanBright: [106, 49],\n    bgWhiteBright: [107, 49],\n};\n","\"use strict\";\n/**\n * Response types for server-level commands in the Eufy WebSocket API\n *\n * Defines all response types for server commands, based on the API documentation.\n * Server responses are direct WebSocket protocol responses, not BaseApiResponse wrappers.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// ================= COMMAND-RESPONSE MAPPING =================\nconst constants_1 = require(\"./constants\");\n//# sourceMappingURL=responses.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.PanTiltDirection = exports.WatermarkMode = exports.VideoQuality = exports.SoundDetectionType = exports.MotionDetectionType = exports.LockStatus = exports.ContinuousRecordingType = exports.NotificationType = exports.ChargingStatus = exports.PowerWorkingMode = exports.DeviceType = exports.DEVICE_EVENTS = exports.DEVICE_COMMANDS = void 0;\n/**\n * Device level command constants for Eufy WebSocket API\n *\n * Contains all device command string constants and enums for device operations, streaming, alarm, and camera control.\n */\nexports.DEVICE_COMMANDS = {\n    // Properties\n    GET_PROPERTIES_METADATA: \"device.get_properties_metadata\",\n    GET_PROPERTIES: \"device.get_properties\",\n    SET_PROPERTY: \"device.set_property\",\n    HAS_PROPERTY: \"device.has_property\",\n    GET_COMMANDS: \"device.get_commands\",\n    HAS_COMMAND: \"device.has_command\",\n    // Streaming\n    START_LIVESTREAM: \"device.start_livestream\",\n    STOP_LIVESTREAM: \"device.stop_livestream\",\n    IS_LIVESTREAMING: \"device.is_livestreaming\",\n    START_RTSP_LIVESTREAM: \"device.start_rtsp_livestream\",\n    STOP_RTSP_LIVESTREAM: \"device.stop_rtsp_livestream\",\n    IS_RTSP_LIVESTREAMING: \"device.is_rtsp_livestreaming\",\n    // Download\n    START_DOWNLOAD: \"device.start_download\",\n    CANCEL_DOWNLOAD: \"device.cancel_download\",\n    IS_DOWNLOADING: \"device.is_downloading\",\n    // Alarm\n    TRIGGER_ALARM: \"device.trigger_alarm\",\n    RESET_ALARM: \"device.reset_alarm\",\n    // Camera control\n    PAN_AND_TILT: \"device.pan_and_tilt\",\n    CALIBRATE: \"device.calibrate\",\n    QUICK_RESPONSE: \"device.quick_response\",\n    GET_VOICES: \"device.get_voices\",\n    // Talkback\n    START_TALKBACK: \"device.start_talkback\",\n    STOP_TALKBACK: \"device.stop_talkback\",\n    IS_TALKBACK_ONGOING: \"device.is_talkback_ongoing\",\n    TALKBACK_AUDIO_DATA: \"device.talkback_audio_data\",\n    // Lock control\n    CALIBRATE_LOCK: \"device.calibrate_lock\",\n    UNLOCK: \"device.unlock\",\n    // Sensor\n    SNOOZE: \"device.snooze\",\n    // User management\n    ADD_USER: \"device.add_user\",\n    DELETE_USER: \"device.delete_user\",\n    GET_USERS: \"device.get_users\",\n    UPDATE_USER: \"device.update_user\",\n    UPDATE_USER_PASSCODE: \"device.update_user_passcode\",\n    UPDATE_USER_SCHEDULE: \"device.update_user_schedule\",\n    VERIFY_PIN: \"device.verify_pin\",\n    // Device control\n    OPEN: \"device.open\",\n    SET_STATUS_LED: \"device.set_status_led\",\n    SET_AUTO_NIGHT_VISION: \"device.set_auto_night_vision\",\n    SET_MOTION_DETECTION: \"device.set_motion_detection\",\n    SET_SOUND_DETECTION: \"device.set_sound_detection\",\n    SET_PET_DETECTION: \"device.set_pet_detection\",\n    SET_RTSP_STREAM: \"device.set_rtsp_stream\",\n    SET_ANTI_THEFT_DETECTION: \"device.set_anti_theft_detection\",\n    SET_WATERMARK: \"device.set_watermark\",\n    ENABLE_DEVICE: \"device.enable_device\",\n    LOCK_DEVICE: \"device.lock_device\",\n};\n/**\n * Device event constants\n */\nexports.DEVICE_EVENTS = {\n    DEVICE_ADDED: \"device added\",\n    DEVICE_REMOVED: \"device removed\",\n    PROPERTY_CHANGED: \"property changed\",\n    COMMAND_RESULT: \"command result\",\n    // Streaming events\n    LIVESTREAM_STARTED: \"livestream started\",\n    LIVESTREAM_STOPPED: \"livestream stopped\",\n    LIVESTREAM_VIDEO_DATA: \"livestream video data\",\n    LIVESTREAM_AUDIO_DATA: \"livestream audio data\",\n    GOT_RTSP_URL: \"got rtsp url\",\n    // Download events\n    DOWNLOAD_STARTED: \"download started\",\n    DOWNLOAD_FINISHED: \"download finished\",\n    DOWNLOAD_VIDEO_DATA: \"download video data\",\n    DOWNLOAD_AUDIO_DATA: \"download audio data\",\n    // Detection events\n    MOTION_DETECTED: \"motion detected\",\n    PERSON_DETECTED: \"person detected\",\n    STRANGER_PERSON_DETECTED: \"stranger person detected\",\n    CRYING_DETECTED: \"crying detected\",\n    SOUND_DETECTED: \"sound detected\",\n    PET_DETECTED: \"pet detected\",\n    VEHICLE_DETECTED: \"vehicle detected\",\n    DOG_DETECTED: \"dog detected\",\n    DOG_LICK_DETECTED: \"dog lick detected\",\n    DOG_POOP_DETECTED: \"dog poop detected\",\n    RADAR_MOTION_DETECTED: \"radar motion detected\",\n    // Doorbell and sensor events\n    RINGS: \"rings\",\n    SENSOR_OPEN: \"sensor open\",\n    // Package events\n    PACKAGE_DELIVERED: \"package delivered\",\n    PACKAGE_STRANDED: \"package stranded\",\n    PACKAGE_TAKEN: \"package taken\",\n    SOMEONE_LOITERING: \"someone loitering\",\n    // Security events\n    LOCKED: \"locked\",\n    WRONG_TRY_PROTECT_ALARM: \"wrong try-protect alarm\",\n    LONG_TIME_NOT_CLOSE: \"long time not close\",\n    LOW_BATTERY: \"low battery\",\n    JAMMED: \"jammed\",\n    ALARM_911: \"alarm 911\",\n    SHAKE_ALARM: \"shake alarm\",\n    TAMPERING: \"tampering\",\n    LOW_TEMPERATURE: \"low temperature\",\n    HIGH_TEMPERATURE: \"high temperature\",\n    PIN_INCORRECT: \"pin incorrect\",\n    LID_STUCK: \"lid stuck\",\n    BATTERY_FULLY_CHARGED: \"battery fully charged\",\n    // Talkback events\n    TALKBACK_STARTED: \"talkback started\",\n    TALKBACK_STOPPED: \"talkback stopped\",\n    // User management events\n    USER_ADDED: \"user added\",\n    USER_DELETED: \"user deleted\",\n    USER_ERROR: \"user error\",\n    USER_USERNAME_UPDATED: \"user username updated\",\n    USER_SCHEDULE_UPDATED: \"user schedule updated\",\n    USER_PASSCODE_UPDATED: \"user passcode updated\",\n    PIN_VERIFIED: \"pin verified\",\n};\n/**\n * Enum values extracted from eufy-security-client upstream for type safety.\n * Source: https://github.com/bropat/eufy-security-client\n */\n/**\n * Device type enum - corresponds to the `type` property in DeviceProperties\n * Source: eufy-security-client/src/http/types.ts\n */\nvar DeviceType;\n(function (DeviceType) {\n    DeviceType[DeviceType[\"STATION\"] = 0] = \"STATION\";\n    DeviceType[DeviceType[\"CAMERA\"] = 1] = \"CAMERA\";\n    DeviceType[DeviceType[\"SENSOR\"] = 2] = \"SENSOR\";\n    DeviceType[DeviceType[\"FLOODLIGHT\"] = 3] = \"FLOODLIGHT\";\n    DeviceType[DeviceType[\"CAMERA_E\"] = 4] = \"CAMERA_E\";\n    DeviceType[DeviceType[\"DOORBELL\"] = 5] = \"DOORBELL\";\n    DeviceType[DeviceType[\"BATTERY_DOORBELL\"] = 7] = \"BATTERY_DOORBELL\";\n    DeviceType[DeviceType[\"CAMERA2C\"] = 8] = \"CAMERA2C\";\n    DeviceType[DeviceType[\"CAMERA2\"] = 9] = \"CAMERA2\";\n    DeviceType[DeviceType[\"MOTION_SENSOR\"] = 10] = \"MOTION_SENSOR\";\n    DeviceType[DeviceType[\"KEYPAD\"] = 11] = \"KEYPAD\";\n    DeviceType[DeviceType[\"CAMERA2_PRO\"] = 14] = \"CAMERA2_PRO\";\n    DeviceType[DeviceType[\"CAMERA2C_PRO\"] = 15] = \"CAMERA2C_PRO\";\n    DeviceType[DeviceType[\"BATTERY_DOORBELL_2\"] = 16] = \"BATTERY_DOORBELL_2\";\n    DeviceType[DeviceType[\"HB3\"] = 18] = \"HB3\";\n    DeviceType[DeviceType[\"CAMERA3\"] = 19] = \"CAMERA3\";\n    DeviceType[DeviceType[\"CAMERA3C\"] = 23] = \"CAMERA3C\";\n    DeviceType[DeviceType[\"PROFESSIONAL_247\"] = 24] = \"PROFESSIONAL_247\";\n    DeviceType[DeviceType[\"MINIBASE_CHIME\"] = 25] = \"MINIBASE_CHIME\";\n    DeviceType[DeviceType[\"CAMERA3_PRO\"] = 26] = \"CAMERA3_PRO\";\n    DeviceType[DeviceType[\"INDOOR_CAMERA\"] = 30] = \"INDOOR_CAMERA\";\n    DeviceType[DeviceType[\"INDOOR_PT_CAMERA\"] = 31] = \"INDOOR_PT_CAMERA\";\n    DeviceType[DeviceType[\"SOLO_CAMERA\"] = 32] = \"SOLO_CAMERA\";\n    DeviceType[DeviceType[\"SOLO_CAMERA_PRO\"] = 33] = \"SOLO_CAMERA_PRO\";\n    DeviceType[DeviceType[\"INDOOR_CAMERA_1080\"] = 34] = \"INDOOR_CAMERA_1080\";\n    DeviceType[DeviceType[\"INDOOR_PT_CAMERA_1080\"] = 35] = \"INDOOR_PT_CAMERA_1080\";\n    DeviceType[DeviceType[\"FLOODLIGHT_CAMERA_8422\"] = 37] = \"FLOODLIGHT_CAMERA_8422\";\n    DeviceType[DeviceType[\"FLOODLIGHT_CAMERA_8423\"] = 38] = \"FLOODLIGHT_CAMERA_8423\";\n    DeviceType[DeviceType[\"FLOODLIGHT_CAMERA_8424\"] = 39] = \"FLOODLIGHT_CAMERA_8424\";\n    DeviceType[DeviceType[\"INDOOR_OUTDOOR_CAMERA_1080P_NO_LIGHT\"] = 44] = \"INDOOR_OUTDOOR_CAMERA_1080P_NO_LIGHT\";\n    DeviceType[DeviceType[\"INDOOR_OUTDOOR_CAMERA_2K\"] = 45] = \"INDOOR_OUTDOOR_CAMERA_2K\";\n    DeviceType[DeviceType[\"INDOOR_OUTDOOR_CAMERA_1080P\"] = 46] = \"INDOOR_OUTDOOR_CAMERA_1080P\";\n    DeviceType[DeviceType[\"FLOODLIGHT_CAMERA_8425\"] = 47] = \"FLOODLIGHT_CAMERA_8425\";\n    DeviceType[DeviceType[\"OUTDOOR_PT_CAMERA\"] = 48] = \"OUTDOOR_PT_CAMERA\";\n    DeviceType[DeviceType[\"LOCK_BLE\"] = 50] = \"LOCK_BLE\";\n    DeviceType[DeviceType[\"LOCK_WIFI\"] = 51] = \"LOCK_WIFI\";\n    DeviceType[DeviceType[\"LOCK_BLE_NO_FINGER\"] = 52] = \"LOCK_BLE_NO_FINGER\";\n    DeviceType[DeviceType[\"LOCK_WIFI_NO_FINGER\"] = 53] = \"LOCK_WIFI_NO_FINGER\";\n    DeviceType[DeviceType[\"LOCK_8503\"] = 54] = \"LOCK_8503\";\n    DeviceType[DeviceType[\"LOCK_8530\"] = 55] = \"LOCK_8530\";\n    DeviceType[DeviceType[\"LOCK_85A3\"] = 56] = \"LOCK_85A3\";\n    DeviceType[DeviceType[\"LOCK_8592\"] = 57] = \"LOCK_8592\";\n    DeviceType[DeviceType[\"LOCK_8504\"] = 58] = \"LOCK_8504\";\n    DeviceType[DeviceType[\"SOLO_CAMERA_SPOTLIGHT_1080\"] = 60] = \"SOLO_CAMERA_SPOTLIGHT_1080\";\n    DeviceType[DeviceType[\"SOLO_CAMERA_SPOTLIGHT_2K\"] = 61] = \"SOLO_CAMERA_SPOTLIGHT_2K\";\n    DeviceType[DeviceType[\"SOLO_CAMERA_SPOTLIGHT_SOLAR\"] = 62] = \"SOLO_CAMERA_SPOTLIGHT_SOLAR\";\n    DeviceType[DeviceType[\"SOLO_CAMERA_SOLAR\"] = 63] = \"SOLO_CAMERA_SOLAR\";\n    DeviceType[DeviceType[\"SOLO_CAMERA_C210\"] = 64] = \"SOLO_CAMERA_C210\";\n    DeviceType[DeviceType[\"FLOODLIGHT_CAMERA_8426\"] = 87] = \"FLOODLIGHT_CAMERA_8426\";\n    DeviceType[DeviceType[\"SOLO_CAMERA_E30\"] = 88] = \"SOLO_CAMERA_E30\";\n    DeviceType[DeviceType[\"SMART_DROP\"] = 90] = \"SMART_DROP\";\n    DeviceType[DeviceType[\"BATTERY_DOORBELL_PLUS\"] = 91] = \"BATTERY_DOORBELL_PLUS\";\n    DeviceType[DeviceType[\"DOORBELL_SOLO\"] = 93] = \"DOORBELL_SOLO\";\n    DeviceType[DeviceType[\"BATTERY_DOORBELL_PLUS_E340\"] = 94] = \"BATTERY_DOORBELL_PLUS_E340\";\n    DeviceType[DeviceType[\"BATTERY_DOORBELL_C30\"] = 95] = \"BATTERY_DOORBELL_C30\";\n    DeviceType[DeviceType[\"BATTERY_DOORBELL_C31\"] = 96] = \"BATTERY_DOORBELL_C31\";\n    DeviceType[DeviceType[\"INDOOR_COST_DOWN_CAMERA\"] = 100] = \"INDOOR_COST_DOWN_CAMERA\";\n    DeviceType[DeviceType[\"CAMERA_GUN\"] = 101] = \"CAMERA_GUN\";\n    DeviceType[DeviceType[\"CAMERA_SNAIL\"] = 102] = \"CAMERA_SNAIL\";\n    DeviceType[DeviceType[\"INDOOR_PT_CAMERA_S350\"] = 104] = \"INDOOR_PT_CAMERA_S350\";\n    DeviceType[DeviceType[\"INDOOR_PT_CAMERA_E30\"] = 105] = \"INDOOR_PT_CAMERA_E30\";\n    DeviceType[DeviceType[\"CAMERA_FG\"] = 110] = \"CAMERA_FG\";\n    DeviceType[DeviceType[\"CAMERA_GARAGE_T8453_COMMON\"] = 131] = \"CAMERA_GARAGE_T8453_COMMON\";\n    DeviceType[DeviceType[\"CAMERA_GARAGE_T8452\"] = 132] = \"CAMERA_GARAGE_T8452\";\n    DeviceType[DeviceType[\"CAMERA_GARAGE_T8453\"] = 133] = \"CAMERA_GARAGE_T8453\";\n    DeviceType[DeviceType[\"SMART_SAFE_7400\"] = 140] = \"SMART_SAFE_7400\";\n    DeviceType[DeviceType[\"SMART_SAFE_7401\"] = 141] = \"SMART_SAFE_7401\";\n    DeviceType[DeviceType[\"SMART_SAFE_7402\"] = 142] = \"SMART_SAFE_7402\";\n    DeviceType[DeviceType[\"SMART_SAFE_7403\"] = 143] = \"SMART_SAFE_7403\";\n    DeviceType[DeviceType[\"WALL_LIGHT_CAM\"] = 151] = \"WALL_LIGHT_CAM\";\n    DeviceType[DeviceType[\"SMART_TRACK_LINK\"] = 157] = \"SMART_TRACK_LINK\";\n    DeviceType[DeviceType[\"SMART_TRACK_CARD\"] = 159] = \"SMART_TRACK_CARD\";\n    DeviceType[DeviceType[\"LOCK_8502\"] = 180] = \"LOCK_8502\";\n    DeviceType[DeviceType[\"LOCK_8506\"] = 184] = \"LOCK_8506\";\n    DeviceType[DeviceType[\"WALL_LIGHT_CAM_81A0\"] = 10005] = \"WALL_LIGHT_CAM_81A0\";\n    DeviceType[DeviceType[\"INDOOR_PT_CAMERA_C220\"] = 10008] = \"INDOOR_PT_CAMERA_C220\";\n    DeviceType[DeviceType[\"INDOOR_PT_CAMERA_C210\"] = 10009] = \"INDOOR_PT_CAMERA_C210\";\n})(DeviceType || (exports.DeviceType = DeviceType = {}));\n/**\n * Power working mode enum - corresponds to the `powerWorkingMode` property\n * Represents different power management modes for battery devices\n */\nvar PowerWorkingMode;\n(function (PowerWorkingMode) {\n    PowerWorkingMode[PowerWorkingMode[\"BATTERY_POWERED\"] = 0] = \"BATTERY_POWERED\";\n    PowerWorkingMode[PowerWorkingMode[\"SOLAR_POWERED\"] = 1] = \"SOLAR_POWERED\";\n    PowerWorkingMode[PowerWorkingMode[\"PLUGGED_IN\"] = 2] = \"PLUGGED_IN\";\n})(PowerWorkingMode || (exports.PowerWorkingMode = PowerWorkingMode = {}));\n/**\n * Charging status enum - corresponds to the `chargingStatus` property\n * Indicates the current charging state of battery devices\n */\nvar ChargingStatus;\n(function (ChargingStatus) {\n    ChargingStatus[ChargingStatus[\"NOT_CHARGING\"] = 0] = \"NOT_CHARGING\";\n    ChargingStatus[ChargingStatus[\"CHARGING\"] = 1] = \"CHARGING\";\n})(ChargingStatus || (exports.ChargingStatus = ChargingStatus = {}));\n/**\n * Notification type enum - corresponds to the `notificationType` property\n * Defines different notification display modes\n */\nvar NotificationType;\n(function (NotificationType) {\n    NotificationType[NotificationType[\"MOST_EFFICIENT\"] = 1] = \"MOST_EFFICIENT\";\n    NotificationType[NotificationType[\"INCLUDE_THUMBNAIL\"] = 2] = \"INCLUDE_THUMBNAIL\";\n    NotificationType[NotificationType[\"FULL_EFFECT\"] = 3] = \"FULL_EFFECT\";\n})(NotificationType || (exports.NotificationType = NotificationType = {}));\n/**\n * Continuous recording type enum - corresponds to the `continuousRecordingType` property\n * Defines recording behavior for continuous recording mode\n */\nvar ContinuousRecordingType;\n(function (ContinuousRecordingType) {\n    ContinuousRecordingType[ContinuousRecordingType[\"ALWAYS\"] = 0] = \"ALWAYS\";\n    ContinuousRecordingType[ContinuousRecordingType[\"ONLY_DURING_EVENTS\"] = 1] = \"ONLY_DURING_EVENTS\";\n})(ContinuousRecordingType || (exports.ContinuousRecordingType = ContinuousRecordingType = {}));\n/**\n * Lock status enum - may correspond to the `lockStatus` property\n * Represents different lock states (values may vary by device)\n */\nvar LockStatus;\n(function (LockStatus) {\n    LockStatus[LockStatus[\"UNKNOWN\"] = 0] = \"UNKNOWN\";\n    LockStatus[LockStatus[\"UNLOCKED\"] = 1] = \"UNLOCKED\";\n    LockStatus[LockStatus[\"LOCKED\"] = 2] = \"LOCKED\";\n    LockStatus[LockStatus[\"MECHANICAL_ANOMALY\"] = 3] = \"MECHANICAL_ANOMALY\";\n    LockStatus[LockStatus[\"LOCKED_COMPLETED\"] = 4] = \"LOCKED_COMPLETED\";\n    LockStatus[LockStatus[\"UNLOCK_COMPLETED\"] = 5] = \"UNLOCK_COMPLETED\";\n})(LockStatus || (exports.LockStatus = LockStatus = {}));\n/**\n * Motion detection type enum - corresponds to `motionDetectionType` property\n * Defines what types of motion to detect\n */\nvar MotionDetectionType;\n(function (MotionDetectionType) {\n    MotionDetectionType[MotionDetectionType[\"HUMAN_ONLY\"] = 0] = \"HUMAN_ONLY\";\n    MotionDetectionType[MotionDetectionType[\"ALL_MOTIONS\"] = 1] = \"ALL_MOTIONS\";\n    MotionDetectionType[MotionDetectionType[\"HUMAN_AND_PET\"] = 2] = \"HUMAN_AND_PET\";\n})(MotionDetectionType || (exports.MotionDetectionType = MotionDetectionType = {}));\n/**\n * Sound detection type enum - corresponds to `soundDetectionType` property\n * Defines what types of sound to detect\n */\nvar SoundDetectionType;\n(function (SoundDetectionType) {\n    SoundDetectionType[SoundDetectionType[\"ALL_SOUNDS\"] = 0] = \"ALL_SOUNDS\";\n    SoundDetectionType[SoundDetectionType[\"HUMAN_VOICE\"] = 1] = \"HUMAN_VOICE\";\n    SoundDetectionType[SoundDetectionType[\"CRYING\"] = 2] = \"CRYING\";\n})(SoundDetectionType || (exports.SoundDetectionType = SoundDetectionType = {}));\n/**\n * Video streaming quality enum - for video quality properties\n */\nvar VideoQuality;\n(function (VideoQuality) {\n    VideoQuality[VideoQuality[\"LOW\"] = 0] = \"LOW\";\n    VideoQuality[VideoQuality[\"MEDIUM\"] = 1] = \"MEDIUM\";\n    VideoQuality[VideoQuality[\"HIGH\"] = 2] = \"HIGH\";\n    VideoQuality[VideoQuality[\"ULTRA\"] = 3] = \"ULTRA\";\n})(VideoQuality || (exports.VideoQuality = VideoQuality = {}));\n/**\n * Watermark mode enum - corresponds to `watermark` property\n * Note: Different device types may use different value mappings\n */\nvar WatermarkMode;\n(function (WatermarkMode) {\n    WatermarkMode[WatermarkMode[\"OFF\"] = 0] = \"OFF\";\n    WatermarkMode[WatermarkMode[\"TIMESTAMP\"] = 1] = \"TIMESTAMP\";\n    WatermarkMode[WatermarkMode[\"TIMESTAMP_AND_LOGO\"] = 2] = \"TIMESTAMP_AND_LOGO\";\n})(WatermarkMode || (exports.WatermarkMode = WatermarkMode = {}));\n/**\n * Pan/tilt direction enum for camera movement\n */\nvar PanTiltDirection;\n(function (PanTiltDirection) {\n    PanTiltDirection[PanTiltDirection[\"ROTATE360\"] = 0] = \"ROTATE360\";\n    PanTiltDirection[PanTiltDirection[\"LEFT\"] = 1] = \"LEFT\";\n    PanTiltDirection[PanTiltDirection[\"RIGHT\"] = 2] = \"RIGHT\";\n    PanTiltDirection[PanTiltDirection[\"UP\"] = 3] = \"UP\";\n    PanTiltDirection[PanTiltDirection[\"DOWN\"] = 4] = \"DOWN\";\n})(PanTiltDirection || (exports.PanTiltDirection = PanTiltDirection = {}));\n//# sourceMappingURL=constants.js.map","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^WebSocket$\" }] */\n'use strict';\n\nconst WebSocket = require('./websocket');\nconst { Duplex } = require('stream');\n\n/**\n * Emits the `'close'` event on a stream.\n *\n * @param {Duplex} stream The stream.\n * @private\n */\nfunction emitClose(stream) {\n  stream.emit('close');\n}\n\n/**\n * The listener of the `'end'` event.\n *\n * @private\n */\nfunction duplexOnEnd() {\n  if (!this.destroyed && this._writableState.finished) {\n    this.destroy();\n  }\n}\n\n/**\n * The listener of the `'error'` event.\n *\n * @param {Error} err The error\n * @private\n */\nfunction duplexOnError(err) {\n  this.removeListener('error', duplexOnError);\n  this.destroy();\n  if (this.listenerCount('error') === 0) {\n    // Do not suppress the throwing behavior.\n    this.emit('error', err);\n  }\n}\n\n/**\n * Wraps a `WebSocket` in a duplex stream.\n *\n * @param {WebSocket} ws The `WebSocket` to wrap\n * @param {Object} [options] The options for the `Duplex` constructor\n * @return {Duplex} The duplex stream\n * @public\n */\nfunction createWebSocketStream(ws, options) {\n  let terminateOnDestroy = true;\n\n  const duplex = new Duplex({\n    ...options,\n    autoDestroy: false,\n    emitClose: false,\n    objectMode: false,\n    writableObjectMode: false\n  });\n\n  ws.on('message', function message(msg, isBinary) {\n    const data =\n      !isBinary && duplex._readableState.objectMode ? msg.toString() : msg;\n\n    if (!duplex.push(data)) ws.pause();\n  });\n\n  ws.once('error', function error(err) {\n    if (duplex.destroyed) return;\n\n    // Prevent `ws.terminate()` from being called by `duplex._destroy()`.\n    //\n    // - If the `'error'` event is emitted before the `'open'` event, then\n    //   `ws.terminate()` is a noop as no socket is assigned.\n    // - Otherwise, the error is re-emitted by the listener of the `'error'`\n    //   event of the `Receiver` object. The listener already closes the\n    //   connection by calling `ws.close()`. This allows a close frame to be\n    //   sent to the other peer. If `ws.terminate()` is called right after this,\n    //   then the close frame might not be sent.\n    terminateOnDestroy = false;\n    duplex.destroy(err);\n  });\n\n  ws.once('close', function close() {\n    if (duplex.destroyed) return;\n\n    duplex.push(null);\n  });\n\n  duplex._destroy = function (err, callback) {\n    if (ws.readyState === ws.CLOSED) {\n      callback(err);\n      process.nextTick(emitClose, duplex);\n      return;\n    }\n\n    let called = false;\n\n    ws.once('error', function error(err) {\n      called = true;\n      callback(err);\n    });\n\n    ws.once('close', function close() {\n      if (!called) callback(err);\n      process.nextTick(emitClose, duplex);\n    });\n\n    if (terminateOnDestroy) ws.terminate();\n  };\n\n  duplex._final = function (callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._final(callback);\n      });\n      return;\n    }\n\n    // If the value of the `_socket` property is `null` it means that `ws` is a\n    // client websocket and the handshake failed. In fact, when this happens, a\n    // socket is never assigned to the websocket. Wait for the `'error'` event\n    // that will be emitted by the websocket.\n    if (ws._socket === null) return;\n\n    if (ws._socket._writableState.finished) {\n      callback();\n      if (duplex._readableState.endEmitted) duplex.destroy();\n    } else {\n      ws._socket.once('finish', function finish() {\n        // `duplex` is not destroyed here because the `'end'` event will be\n        // emitted on `duplex` after this `'finish'` event. The EOF signaling\n        // `null` chunk is, in fact, pushed when the websocket emits `'close'`.\n        callback();\n      });\n      ws.close();\n    }\n  };\n\n  duplex._read = function () {\n    if (ws.isPaused) ws.resume();\n  };\n\n  duplex._write = function (chunk, encoding, callback) {\n    if (ws.readyState === ws.CONNECTING) {\n      ws.once('open', function open() {\n        duplex._write(chunk, encoding, callback);\n      });\n      return;\n    }\n\n    ws.send(chunk, callback);\n  };\n\n  duplex.on('end', duplexOnEnd);\n  duplex.on('error', duplexOnError);\n  return duplex;\n}\n\nmodule.exports = createWebSocketStream;\n","\"use strict\";\n/**\n * Common exports for the Eufy WebSocket Client\n *\n * Provides a single entry point for all shared constants, types, and responses for easy import.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\n// ================= CONSTANTS =================\n// ================= TYPES =================\n// Deprecated: use imports from ./types/ instead of ./common/types or ./types\n// ================= RESPONSES =================\ntslib_1.__exportStar(require(\"./constants\"), exports);\ntslib_1.__exportStar(require(\"./responses\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\n/**\n * Response types for device-level commands\n * Based on API documentation in eufy-security-ws/docs/api_cmds.md\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// ================= COMMAND-RESPONSE MAPPING =================\nconst constants_1 = require(\"./constants\");\n//# sourceMappingURL=responses.js.map","\"use strict\";\n/**\n * Station command types and interfaces for Eufy stations\n *\n * Defines all command interfaces for station-level operations in the Eufy Security WebSocket API.\n * Includes property, connection, alarm, and database commands.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=commands.js.map","'use strict';\n\nconst { Writable } = require('stream');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  kStatusCode,\n  kWebSocket\n} = require('./constants');\nconst { concat, toArrayBuffer, unmask } = require('./buffer-util');\nconst { isValidStatusCode, isValidUTF8 } = require('./validation');\n\nconst FastBuffer = Buffer[Symbol.species];\n\nconst GET_INFO = 0;\nconst GET_PAYLOAD_LENGTH_16 = 1;\nconst GET_PAYLOAD_LENGTH_64 = 2;\nconst GET_MASK = 3;\nconst GET_DATA = 4;\nconst INFLATING = 5;\nconst DEFER_EVENT = 6;\n\n/**\n * HyBi Receiver implementation.\n *\n * @extends Writable\n */\nclass Receiver extends Writable {\n  /**\n   * Creates a Receiver instance.\n   *\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {String} [options.binaryType=nodebuffer] The type for binary data\n   * @param {Object} [options.extensions] An object containing the negotiated\n   *     extensions\n   * @param {Boolean} [options.isServer=false] Specifies whether to operate in\n   *     client or server mode\n   * @param {Number} [options.maxPayload=0] The maximum allowed message length\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   */\n  constructor(options = {}) {\n    super();\n\n    this._allowSynchronousEvents =\n      options.allowSynchronousEvents !== undefined\n        ? options.allowSynchronousEvents\n        : true;\n    this._binaryType = options.binaryType || BINARY_TYPES[0];\n    this._extensions = options.extensions || {};\n    this._isServer = !!options.isServer;\n    this._maxPayload = options.maxPayload | 0;\n    this._skipUTF8Validation = !!options.skipUTF8Validation;\n    this[kWebSocket] = undefined;\n\n    this._bufferedBytes = 0;\n    this._buffers = [];\n\n    this._compressed = false;\n    this._payloadLength = 0;\n    this._mask = undefined;\n    this._fragmented = 0;\n    this._masked = false;\n    this._fin = false;\n    this._opcode = 0;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragments = [];\n\n    this._errored = false;\n    this._loop = false;\n    this._state = GET_INFO;\n  }\n\n  /**\n   * Implements `Writable.prototype._write()`.\n   *\n   * @param {Buffer} chunk The chunk of data to write\n   * @param {String} encoding The character encoding of `chunk`\n   * @param {Function} cb Callback\n   * @private\n   */\n  _write(chunk, encoding, cb) {\n    if (this._opcode === 0x08 && this._state == GET_INFO) return cb();\n\n    this._bufferedBytes += chunk.length;\n    this._buffers.push(chunk);\n    this.startLoop(cb);\n  }\n\n  /**\n   * Consumes `n` bytes from the buffered data.\n   *\n   * @param {Number} n The number of bytes to consume\n   * @return {Buffer} The consumed bytes\n   * @private\n   */\n  consume(n) {\n    this._bufferedBytes -= n;\n\n    if (n === this._buffers[0].length) return this._buffers.shift();\n\n    if (n < this._buffers[0].length) {\n      const buf = this._buffers[0];\n      this._buffers[0] = new FastBuffer(\n        buf.buffer,\n        buf.byteOffset + n,\n        buf.length - n\n      );\n\n      return new FastBuffer(buf.buffer, buf.byteOffset, n);\n    }\n\n    const dst = Buffer.allocUnsafe(n);\n\n    do {\n      const buf = this._buffers[0];\n      const offset = dst.length - n;\n\n      if (n >= buf.length) {\n        dst.set(this._buffers.shift(), offset);\n      } else {\n        dst.set(new Uint8Array(buf.buffer, buf.byteOffset, n), offset);\n        this._buffers[0] = new FastBuffer(\n          buf.buffer,\n          buf.byteOffset + n,\n          buf.length - n\n        );\n      }\n\n      n -= buf.length;\n    } while (n > 0);\n\n    return dst;\n  }\n\n  /**\n   * Starts the parsing loop.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  startLoop(cb) {\n    this._loop = true;\n\n    do {\n      switch (this._state) {\n        case GET_INFO:\n          this.getInfo(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_16:\n          this.getPayloadLength16(cb);\n          break;\n        case GET_PAYLOAD_LENGTH_64:\n          this.getPayloadLength64(cb);\n          break;\n        case GET_MASK:\n          this.getMask();\n          break;\n        case GET_DATA:\n          this.getData(cb);\n          break;\n        case INFLATING:\n        case DEFER_EVENT:\n          this._loop = false;\n          return;\n      }\n    } while (this._loop);\n\n    if (!this._errored) cb();\n  }\n\n  /**\n   * Reads the first two bytes of a frame.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getInfo(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(2);\n\n    if ((buf[0] & 0x30) !== 0x00) {\n      const error = this.createError(\n        RangeError,\n        'RSV2 and RSV3 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_2_3'\n      );\n\n      cb(error);\n      return;\n    }\n\n    const compressed = (buf[0] & 0x40) === 0x40;\n\n    if (compressed && !this._extensions[PerMessageDeflate.extensionName]) {\n      const error = this.createError(\n        RangeError,\n        'RSV1 must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_RSV_1'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._fin = (buf[0] & 0x80) === 0x80;\n    this._opcode = buf[0] & 0x0f;\n    this._payloadLength = buf[1] & 0x7f;\n\n    if (this._opcode === 0x00) {\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (!this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          'invalid opcode 0',\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._opcode = this._fragmented;\n    } else if (this._opcode === 0x01 || this._opcode === 0x02) {\n      if (this._fragmented) {\n        const error = this.createError(\n          RangeError,\n          `invalid opcode ${this._opcode}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_OPCODE'\n        );\n\n        cb(error);\n        return;\n      }\n\n      this._compressed = compressed;\n    } else if (this._opcode > 0x07 && this._opcode < 0x0b) {\n      if (!this._fin) {\n        const error = this.createError(\n          RangeError,\n          'FIN must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_FIN'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (compressed) {\n        const error = this.createError(\n          RangeError,\n          'RSV1 must be clear',\n          true,\n          1002,\n          'WS_ERR_UNEXPECTED_RSV_1'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (\n        this._payloadLength > 0x7d ||\n        (this._opcode === 0x08 && this._payloadLength === 1)\n      ) {\n        const error = this.createError(\n          RangeError,\n          `invalid payload length ${this._payloadLength}`,\n          true,\n          1002,\n          'WS_ERR_INVALID_CONTROL_PAYLOAD_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    } else {\n      const error = this.createError(\n        RangeError,\n        `invalid opcode ${this._opcode}`,\n        true,\n        1002,\n        'WS_ERR_INVALID_OPCODE'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (!this._fin && !this._fragmented) this._fragmented = this._opcode;\n    this._masked = (buf[1] & 0x80) === 0x80;\n\n    if (this._isServer) {\n      if (!this._masked) {\n        const error = this.createError(\n          RangeError,\n          'MASK must be set',\n          true,\n          1002,\n          'WS_ERR_EXPECTED_MASK'\n        );\n\n        cb(error);\n        return;\n      }\n    } else if (this._masked) {\n      const error = this.createError(\n        RangeError,\n        'MASK must be clear',\n        true,\n        1002,\n        'WS_ERR_UNEXPECTED_MASK'\n      );\n\n      cb(error);\n      return;\n    }\n\n    if (this._payloadLength === 126) this._state = GET_PAYLOAD_LENGTH_16;\n    else if (this._payloadLength === 127) this._state = GET_PAYLOAD_LENGTH_64;\n    else this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+16).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength16(cb) {\n    if (this._bufferedBytes < 2) {\n      this._loop = false;\n      return;\n    }\n\n    this._payloadLength = this.consume(2).readUInt16BE(0);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Gets extended payload length (7+64).\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getPayloadLength64(cb) {\n    if (this._bufferedBytes < 8) {\n      this._loop = false;\n      return;\n    }\n\n    const buf = this.consume(8);\n    const num = buf.readUInt32BE(0);\n\n    //\n    // The maximum safe integer in JavaScript is 2^53 - 1. An error is returned\n    // if payload length is greater than this number.\n    //\n    if (num > Math.pow(2, 53 - 32) - 1) {\n      const error = this.createError(\n        RangeError,\n        'Unsupported WebSocket frame: payload length > 2^53 - 1',\n        false,\n        1009,\n        'WS_ERR_UNSUPPORTED_DATA_PAYLOAD_LENGTH'\n      );\n\n      cb(error);\n      return;\n    }\n\n    this._payloadLength = num * Math.pow(2, 32) + buf.readUInt32BE(4);\n    this.haveLength(cb);\n  }\n\n  /**\n   * Payload length has been read.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  haveLength(cb) {\n    if (this._payloadLength && this._opcode < 0x08) {\n      this._totalPayloadLength += this._payloadLength;\n      if (this._totalPayloadLength > this._maxPayload && this._maxPayload > 0) {\n        const error = this.createError(\n          RangeError,\n          'Max payload size exceeded',\n          false,\n          1009,\n          'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n        );\n\n        cb(error);\n        return;\n      }\n    }\n\n    if (this._masked) this._state = GET_MASK;\n    else this._state = GET_DATA;\n  }\n\n  /**\n   * Reads mask bytes.\n   *\n   * @private\n   */\n  getMask() {\n    if (this._bufferedBytes < 4) {\n      this._loop = false;\n      return;\n    }\n\n    this._mask = this.consume(4);\n    this._state = GET_DATA;\n  }\n\n  /**\n   * Reads data bytes.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  getData(cb) {\n    let data = EMPTY_BUFFER;\n\n    if (this._payloadLength) {\n      if (this._bufferedBytes < this._payloadLength) {\n        this._loop = false;\n        return;\n      }\n\n      data = this.consume(this._payloadLength);\n\n      if (\n        this._masked &&\n        (this._mask[0] | this._mask[1] | this._mask[2] | this._mask[3]) !== 0\n      ) {\n        unmask(data, this._mask);\n      }\n    }\n\n    if (this._opcode > 0x07) {\n      this.controlMessage(data, cb);\n      return;\n    }\n\n    if (this._compressed) {\n      this._state = INFLATING;\n      this.decompress(data, cb);\n      return;\n    }\n\n    if (data.length) {\n      //\n      // This message is not compressed so its length is the sum of the payload\n      // length of all fragments.\n      //\n      this._messageLength = this._totalPayloadLength;\n      this._fragments.push(data);\n    }\n\n    this.dataMessage(cb);\n  }\n\n  /**\n   * Decompresses data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Function} cb Callback\n   * @private\n   */\n  decompress(data, cb) {\n    const perMessageDeflate = this._extensions[PerMessageDeflate.extensionName];\n\n    perMessageDeflate.decompress(data, this._fin, (err, buf) => {\n      if (err) return cb(err);\n\n      if (buf.length) {\n        this._messageLength += buf.length;\n        if (this._messageLength > this._maxPayload && this._maxPayload > 0) {\n          const error = this.createError(\n            RangeError,\n            'Max payload size exceeded',\n            false,\n            1009,\n            'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._fragments.push(buf);\n      }\n\n      this.dataMessage(cb);\n      if (this._state === GET_INFO) this.startLoop(cb);\n    });\n  }\n\n  /**\n   * Handles a data message.\n   *\n   * @param {Function} cb Callback\n   * @private\n   */\n  dataMessage(cb) {\n    if (!this._fin) {\n      this._state = GET_INFO;\n      return;\n    }\n\n    const messageLength = this._messageLength;\n    const fragments = this._fragments;\n\n    this._totalPayloadLength = 0;\n    this._messageLength = 0;\n    this._fragmented = 0;\n    this._fragments = [];\n\n    if (this._opcode === 2) {\n      let data;\n\n      if (this._binaryType === 'nodebuffer') {\n        data = concat(fragments, messageLength);\n      } else if (this._binaryType === 'arraybuffer') {\n        data = toArrayBuffer(concat(fragments, messageLength));\n      } else if (this._binaryType === 'blob') {\n        data = new Blob(fragments);\n      } else {\n        data = fragments;\n      }\n\n      if (this._allowSynchronousEvents) {\n        this.emit('message', data, true);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', data, true);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    } else {\n      const buf = concat(fragments, messageLength);\n\n      if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n        const error = this.createError(\n          Error,\n          'invalid UTF-8 sequence',\n          true,\n          1007,\n          'WS_ERR_INVALID_UTF8'\n        );\n\n        cb(error);\n        return;\n      }\n\n      if (this._state === INFLATING || this._allowSynchronousEvents) {\n        this.emit('message', buf, false);\n        this._state = GET_INFO;\n      } else {\n        this._state = DEFER_EVENT;\n        setImmediate(() => {\n          this.emit('message', buf, false);\n          this._state = GET_INFO;\n          this.startLoop(cb);\n        });\n      }\n    }\n  }\n\n  /**\n   * Handles a control message.\n   *\n   * @param {Buffer} data Data to handle\n   * @return {(Error|RangeError|undefined)} A possible error\n   * @private\n   */\n  controlMessage(data, cb) {\n    if (this._opcode === 0x08) {\n      if (data.length === 0) {\n        this._loop = false;\n        this.emit('conclude', 1005, EMPTY_BUFFER);\n        this.end();\n      } else {\n        const code = data.readUInt16BE(0);\n\n        if (!isValidStatusCode(code)) {\n          const error = this.createError(\n            RangeError,\n            `invalid status code ${code}`,\n            true,\n            1002,\n            'WS_ERR_INVALID_CLOSE_CODE'\n          );\n\n          cb(error);\n          return;\n        }\n\n        const buf = new FastBuffer(\n          data.buffer,\n          data.byteOffset + 2,\n          data.length - 2\n        );\n\n        if (!this._skipUTF8Validation && !isValidUTF8(buf)) {\n          const error = this.createError(\n            Error,\n            'invalid UTF-8 sequence',\n            true,\n            1007,\n            'WS_ERR_INVALID_UTF8'\n          );\n\n          cb(error);\n          return;\n        }\n\n        this._loop = false;\n        this.emit('conclude', code, buf);\n        this.end();\n      }\n\n      this._state = GET_INFO;\n      return;\n    }\n\n    if (this._allowSynchronousEvents) {\n      this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n      this._state = GET_INFO;\n    } else {\n      this._state = DEFER_EVENT;\n      setImmediate(() => {\n        this.emit(this._opcode === 0x09 ? 'ping' : 'pong', data);\n        this._state = GET_INFO;\n        this.startLoop(cb);\n      });\n    }\n  }\n\n  /**\n   * Builds an error object.\n   *\n   * @param {function(new:Error|RangeError)} ErrorCtor The error constructor\n   * @param {String} message The error message\n   * @param {Boolean} prefix Specifies whether or not to add a default prefix to\n   *     `message`\n   * @param {Number} statusCode The status code\n   * @param {String} errorCode The exposed error code\n   * @return {(Error|RangeError)} The error\n   * @private\n   */\n  createError(ErrorCtor, message, prefix, statusCode, errorCode) {\n    this._loop = false;\n    this._errored = true;\n\n    const err = new ErrorCtor(\n      prefix ? `Invalid WebSocket frame: ${message}` : message\n    );\n\n    Error.captureStackTrace(err, this.createError);\n    err.code = errorCode;\n    err[kStatusCode] = statusCode;\n    return err;\n  }\n}\n\nmodule.exports = Receiver;\n","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Adds an offer to the map of extension offers or a parameter to the map of\n * parameters.\n *\n * @param {Object} dest The map of extension offers or parameters\n * @param {String} name The extension or parameter name\n * @param {(Object|Boolean|String)} elem The extension parameters or the\n *     parameter value\n * @private\n */\nfunction push(dest, name, elem) {\n  if (dest[name] === undefined) dest[name] = [elem];\n  else dest[name].push(elem);\n}\n\n/**\n * Parses the `Sec-WebSocket-Extensions` header into an object.\n *\n * @param {String} header The field value of the header\n * @return {Object} The parsed object\n * @public\n */\nfunction parse(header) {\n  const offers = Object.create(null);\n  let params = Object.create(null);\n  let mustUnescape = false;\n  let isEscaping = false;\n  let inQuotes = false;\n  let extensionName;\n  let paramName;\n  let start = -1;\n  let code = -1;\n  let end = -1;\n  let i = 0;\n\n  for (; i < header.length; i++) {\n    code = header.charCodeAt(i);\n\n    if (extensionName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (\n        i !== 0 &&\n        (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n      ) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b /* ';' */ || code === 0x2c /* ',' */) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        const name = header.slice(start, end);\n        if (code === 0x2c) {\n          push(offers, name, params);\n          params = Object.create(null);\n        } else {\n          extensionName = name;\n        }\n\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else if (paramName === undefined) {\n      if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (code === 0x20 || code === 0x09) {\n        if (end === -1 && start !== -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        push(params, header.slice(start, end), true);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        start = end = -1;\n      } else if (code === 0x3d /* '=' */ && start !== -1 && end === -1) {\n        paramName = header.slice(start, i);\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    } else {\n      //\n      // The value of a quoted-string after unescaping must conform to the\n      // token ABNF, so only token characters are valid.\n      // Ref: https://tools.ietf.org/html/rfc6455#section-9.1\n      //\n      if (isEscaping) {\n        if (tokenChars[code] !== 1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n        if (start === -1) start = i;\n        else if (!mustUnescape) mustUnescape = true;\n        isEscaping = false;\n      } else if (inQuotes) {\n        if (tokenChars[code] === 1) {\n          if (start === -1) start = i;\n        } else if (code === 0x22 /* '\"' */ && start !== -1) {\n          inQuotes = false;\n          end = i;\n        } else if (code === 0x5c /* '\\' */) {\n          isEscaping = true;\n        } else {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n      } else if (code === 0x22 && header.charCodeAt(i - 1) === 0x3d) {\n        inQuotes = true;\n      } else if (end === -1 && tokenChars[code] === 1) {\n        if (start === -1) start = i;\n      } else if (start !== -1 && (code === 0x20 || code === 0x09)) {\n        if (end === -1) end = i;\n      } else if (code === 0x3b || code === 0x2c) {\n        if (start === -1) {\n          throw new SyntaxError(`Unexpected character at index ${i}`);\n        }\n\n        if (end === -1) end = i;\n        let value = header.slice(start, end);\n        if (mustUnescape) {\n          value = value.replace(/\\\\/g, '');\n          mustUnescape = false;\n        }\n        push(params, paramName, value);\n        if (code === 0x2c) {\n          push(offers, extensionName, params);\n          params = Object.create(null);\n          extensionName = undefined;\n        }\n\n        paramName = undefined;\n        start = end = -1;\n      } else {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n    }\n  }\n\n  if (start === -1 || inQuotes || code === 0x20 || code === 0x09) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  if (end === -1) end = i;\n  const token = header.slice(start, end);\n  if (extensionName === undefined) {\n    push(offers, token, params);\n  } else {\n    if (paramName === undefined) {\n      push(params, token, true);\n    } else if (mustUnescape) {\n      push(params, paramName, token.replace(/\\\\/g, ''));\n    } else {\n      push(params, paramName, token);\n    }\n    push(offers, extensionName, params);\n  }\n\n  return offers;\n}\n\n/**\n * Builds the `Sec-WebSocket-Extensions` header field value.\n *\n * @param {Object} extensions The map of extensions and parameters to format\n * @return {String} A string representing the given object\n * @public\n */\nfunction format(extensions) {\n  return Object.keys(extensions)\n    .map((extension) => {\n      let configurations = extensions[extension];\n      if (!Array.isArray(configurations)) configurations = [configurations];\n      return configurations\n        .map((params) => {\n          return [extension]\n            .concat(\n              Object.keys(params).map((k) => {\n                let values = params[k];\n                if (!Array.isArray(values)) values = [values];\n                return values\n                  .map((v) => (v === true ? k : `${k}=${v}`))\n                  .join('; ');\n              })\n            )\n            .join('; ');\n        })\n        .join(', ');\n    })\n    .join(', ');\n}\n\nmodule.exports = { format, parse };\n","\"use strict\";\n/**\n * Unified device properties interface for Eufy devices\n *\n * Contains all possible device properties from all schema versions, including battery, network, and feature-specific fields.\n * Used for type safety and property mapping throughout the client and plugin.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=properties.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=commands.js.map","module.exports = require(\"stream\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.safeGetCwd = safeGetCwd;\nexports.isBrowserEnvironment = isBrowserEnvironment;\nexports.consoleSupportsCssStyling = consoleSupportsCssStyling;\nfunction safeGetCwd() {\n    try {\n        const nodeProcess = globalThis?.process;\n        if (typeof nodeProcess?.cwd === \"function\") {\n            return nodeProcess.cwd();\n        }\n    }\n    catch {\n    }\n    try {\n        const deno = globalThis?.[\"Deno\"];\n        if (typeof deno?.cwd === \"function\") {\n            return deno.cwd();\n        }\n    }\n    catch {\n    }\n    return undefined;\n}\nfunction isBrowserEnvironment() {\n    return typeof window !== \"undefined\" && typeof document !== \"undefined\";\n}\nfunction consoleSupportsCssStyling() {\n    if (!isBrowserEnvironment()) {\n        return false;\n    }\n    const navigatorObj = globalThis?.navigator;\n    const userAgent = navigatorObj?.userAgent ?? \"\";\n    if (/firefox/i.test(userAgent)) {\n        return true;\n    }\n    const windowObj = globalThis;\n    if (windowObj?.CSS?.supports?.(\"color\", \"#000\")) {\n        return true;\n    }\n    return /safari/i.test(userAgent) && !/chrome/i.test(userAgent);\n}\n","\"use strict\";\n/**\n * Event type unions and helpers for Eufy Security WebSocket Client.\n *\n * Provides type unions and helpers for all event types and payloads across device, driver, server, and station.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=events.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// Already contains SchemaCompatibilityInfo from types.ts\n//# sourceMappingURL=schema.js.map","module.exports = require(\"zlib\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=properties.js.map","module.exports = require(\"module\");","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.GuardMode = exports.AlarmMode = exports.AlarmEvent = exports.STATION_EVENTS = exports.STATION_COMMANDS = void 0;\n/**\n * Station level command constants for Eufy WebSocket API\n *\n * Contains all station command string constants and enums for station operations, alarm, and database control.\n */\nexports.STATION_COMMANDS = {\n    REBOOT: \"station.reboot\",\n    IS_CONNECTED: \"station.is_connected\",\n    CONNECT: \"station.connect\",\n    DISCONNECT: \"station.disconnect\",\n    GET_PROPERTIES_METADATA: \"station.get_properties_metadata\",\n    GET_PROPERTIES: \"station.get_properties\",\n    SET_PROPERTY: \"station.set_property\",\n    TRIGGER_ALARM: \"station.trigger_alarm\",\n    RESET_ALARM: \"station.reset_alarm\",\n    SET_GUARD_MODE: \"station.set_guard_mode\",\n    GET_COMMANDS: \"station.get_commands\",\n    HAS_COMMAND: \"station.has_command\",\n    HAS_PROPERTY: \"station.has_property\",\n    CHIME: \"station.chime\",\n    DOWNLOAD_IMAGE: \"station.download_image\",\n    DATABASE_QUERY_LATEST_INFO: \"station.database_query_latest_info\",\n    DATABASE_QUERY_LOCAL: \"station.database_query_local\",\n    DATABASE_COUNT_BY_DATE: \"station.database_count_by_date\",\n    DATABASE_DELETE: \"station.database_delete\",\n};\n/**\n * Station event constants\n */\nexports.STATION_EVENTS = {\n    STATION_ADDED: \"station added\",\n    STATION_REMOVED: \"station removed\",\n    CONNECTED: \"connected\",\n    DISCONNECTED: \"disconnected\",\n    PROPERTY_CHANGED: \"property changed\",\n    ALARM_EVENT: \"alarm event\",\n    ALARM_DELAY_EVENT: \"alarm delay event\",\n    ALARM_ARMED_EVENT: \"alarm armed event\",\n    ALARM_ARM_DELAY_EVENT: \"alarm arm delay event\",\n    GUARD_MODE_CHANGED: \"guard mode changed\",\n    CURRENT_MODE_CHANGED: \"current mode changed\",\n    IMAGE_DOWNLOADED: \"image downloaded\",\n    DATABASE_QUERY_LATEST: \"database query latest\",\n    DATABASE_QUERY_LOCAL: \"database query local\",\n    DATABASE_COUNT_BY_DATE: \"database count by date\",\n    DATABASE_DELETE: \"database delete\",\n    COMMAND_RESULT: \"command result\",\n};\nvar AlarmEvent;\n(function (AlarmEvent) {\n    AlarmEvent[AlarmEvent[\"HUB_STOP\"] = 0] = \"HUB_STOP\";\n    AlarmEvent[AlarmEvent[\"DEV_STOP\"] = 1] = \"DEV_STOP\";\n    AlarmEvent[AlarmEvent[\"GSENSOR\"] = 2] = \"GSENSOR\";\n    AlarmEvent[AlarmEvent[\"PIR\"] = 3] = \"PIR\";\n    AlarmEvent[AlarmEvent[\"APP\"] = 4] = \"APP\";\n    AlarmEvent[AlarmEvent[\"HOT\"] = 5] = \"HOT\";\n    AlarmEvent[AlarmEvent[\"DOOR\"] = 6] = \"DOOR\";\n    AlarmEvent[AlarmEvent[\"CAMERA_PIR\"] = 7] = \"CAMERA_PIR\";\n    AlarmEvent[AlarmEvent[\"MOTION_SENSOR\"] = 8] = \"MOTION_SENSOR\";\n    AlarmEvent[AlarmEvent[\"CAMERA_GSENSOR\"] = 9] = \"CAMERA_GSENSOR\";\n    AlarmEvent[AlarmEvent[\"CAMERA_APP\"] = 10] = \"CAMERA_APP\";\n    AlarmEvent[AlarmEvent[\"CAMERA_LINKAGE\"] = 11] = \"CAMERA_LINKAGE\";\n    AlarmEvent[AlarmEvent[\"HUB_KEYPAD\"] = 13] = \"HUB_KEYPAD\";\n    AlarmEvent[AlarmEvent[\"HUB_STOP_BY_KEYPAD\"] = 15] = \"HUB_STOP_BY_KEYPAD\";\n    AlarmEvent[AlarmEvent[\"HUB_STOP_BY_APP\"] = 16] = \"HUB_STOP_BY_APP\";\n    AlarmEvent[AlarmEvent[\"HUB_STOP_BY_HAND\"] = 17] = \"HUB_STOP_BY_HAND\";\n    AlarmEvent[AlarmEvent[\"APP_LIGHT\"] = 22] = \"APP_LIGHT\";\n    AlarmEvent[AlarmEvent[\"APP_LIGHT_SOUND\"] = 23] = \"APP_LIGHT_SOUND\";\n    AlarmEvent[AlarmEvent[\"MOTION_APP_LIGHT\"] = 24] = \"MOTION_APP_LIGHT\";\n    AlarmEvent[AlarmEvent[\"MOTION_APP_LIGHT_ALARM\"] = 25] = \"MOTION_APP_LIGHT_ALARM\";\n})(AlarmEvent || (exports.AlarmEvent = AlarmEvent = {}));\nvar AlarmMode;\n(function (AlarmMode) {\n    AlarmMode[AlarmMode[\"AWAY\"] = 0] = \"AWAY\";\n    AlarmMode[AlarmMode[\"HOME\"] = 1] = \"HOME\";\n    AlarmMode[AlarmMode[\"CUSTOM1\"] = 3] = \"CUSTOM1\";\n    AlarmMode[AlarmMode[\"CUSTOM2\"] = 4] = \"CUSTOM2\";\n    AlarmMode[AlarmMode[\"CUSTOM3\"] = 5] = \"CUSTOM3\";\n    AlarmMode[AlarmMode[\"DISARMED\"] = 63] = \"DISARMED\";\n})(AlarmMode || (exports.AlarmMode = AlarmMode = {}));\nvar GuardMode;\n(function (GuardMode) {\n    GuardMode[GuardMode[\"UNKNOWN\"] = -1] = \"UNKNOWN\";\n    GuardMode[GuardMode[\"AWAY\"] = 0] = \"AWAY\";\n    GuardMode[GuardMode[\"HOME\"] = 1] = \"HOME\";\n    GuardMode[GuardMode[\"DISARMED\"] = 63] = \"DISARMED\";\n    GuardMode[GuardMode[\"SCHEDULE\"] = 2] = \"SCHEDULE\";\n    GuardMode[GuardMode[\"GEO\"] = 47] = \"GEO\";\n    GuardMode[GuardMode[\"CUSTOM1\"] = 3] = \"CUSTOM1\";\n    GuardMode[GuardMode[\"CUSTOM2\"] = 4] = \"CUSTOM2\";\n    GuardMode[GuardMode[\"CUSTOM3\"] = 5] = \"CUSTOM3\";\n    GuardMode[GuardMode[\"OFF\"] = 6] = \"OFF\";\n})(GuardMode || (exports.GuardMode = GuardMode = {}));\n//# sourceMappingURL=constants.js.map","\"use strict\";\n/**\n * Simple WebSocket Message Processor\n *\n * Fixes the root cause of P2P stability issues by adding proper message validation,\n * rate limiting, and structure checks to prevent infinite loops and parsing errors.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketMessageProcessor = void 0;\nconst constants_1 = require(\"../device/constants\");\nconst websocket_types_1 = require(\"../websocket-types\");\n/**\n * Rate limiter for message processing\n */\nclass MessageRateLimiter {\n    constructor(maxMessages = 100, windowMs = 1000) {\n        this.messageCount = 0;\n        this.windowStart = Date.now();\n        this.maxMessages = maxMessages;\n        this.windowMs = windowMs;\n    }\n    canProcess() {\n        const now = Date.now();\n        // Reset window if expired\n        if (now - this.windowStart >= this.windowMs) {\n            this.messageCount = 0;\n            this.windowStart = now;\n        }\n        // Check if under limit\n        if (this.messageCount < this.maxMessages) {\n            this.messageCount++;\n            return true;\n        }\n        return false;\n    }\n    getStats() {\n        return {\n            messageCount: this.messageCount,\n            windowStart: this.windowStart,\n            maxMessages: this.maxMessages,\n            windowMs: this.windowMs,\n        };\n    }\n}\n/**\n * Simple message processor that fixes WebSocket parsing issues\n */\nclass WebSocketMessageProcessor {\n    constructor(logger, config = {}) {\n        this.processedMessages = 0;\n        this.invalidMessages = 0;\n        this.rateLimitedMessages = 0;\n        this.logger = logger;\n        this.maxMessageSize = config.maxMessageSize ?? 500000; // 500KB default to handle video data\n        this.rateLimiter = new MessageRateLimiter(config.maxMessagesPerSecond ?? 100, config.rateLimitWindowMs ?? 1000);\n    }\n    /**\n     * Process a raw WebSocket message with validation and rate limiting\n     */\n    processMessage(data) {\n        // Rate limiting check\n        if (!this.rateLimiter.canProcess()) {\n            this.rateLimitedMessages++;\n            this.logger?.warn(\"Message rate limit exceeded, dropping message\");\n            return { valid: false, error: \"Rate limit exceeded\" };\n        }\n        // Basic data validation\n        if (!data) {\n            this.invalidMessages++;\n            return { valid: false, error: \"Empty message data\" };\n        }\n        // Convert to string if buffer\n        let messageStr;\n        try {\n            messageStr = data.toString();\n        }\n        catch (error) {\n            this.invalidMessages++;\n            return { valid: false, error: \"Failed to convert message to string\" };\n        }\n        // Smart message size filtering - allow important message types to be larger\n        if (messageStr.length > this.maxMessageSize) {\n            // Try to extract message type for smart filtering\n            let messageType = \"unknown\";\n            let allowLargeMessage = false;\n            try {\n                // First check for livestream data using string matching (more reliable for large messages)\n                const isLivestreamData = messageStr.includes(`\"${constants_1.DEVICE_EVENTS.LIVESTREAM_VIDEO_DATA}\"`) ||\n                    messageStr.includes(`\"${constants_1.DEVICE_EVENTS.LIVESTREAM_AUDIO_DATA}\"`);\n                if (isLivestreamData) {\n                    messageType = \"livestream-data\";\n                    allowLargeMessage = true;\n                }\n                else {\n                    // Try to parse a preview for other message types\n                    const preview = JSON.parse(messageStr.substring(0, 1000)); // Parse first 1KB\n                    messageType = preview.type || preview.event?.event || \"no-type\";\n                    // Allow large messages for other important types\n                    const allowedLargeTypes = [websocket_types_1.MESSAGE_TYPES.EVENT, websocket_types_1.MESSAGE_TYPES.RESULT];\n                    allowLargeMessage = allowedLargeTypes.some((type) => messageType.includes(type) ||\n                        messageStr.includes(`\"type\":\"${type}\"`));\n                }\n            }\n            catch (e) {\n                // If we can't parse even the beginning, check if it's livestream data by string matching\n                const isLivestreamData = messageStr.includes(`\"${constants_1.DEVICE_EVENTS.LIVESTREAM_VIDEO_DATA}\"`) ||\n                    messageStr.includes(`\"${constants_1.DEVICE_EVENTS.LIVESTREAM_AUDIO_DATA}\"`);\n                if (isLivestreamData) {\n                    messageType = \"livestream-data\";\n                    allowLargeMessage = true;\n                }\n                else {\n                    // Also check for EVENT and RESULT types using string matching\n                    const isEventMessage = messageStr.includes(`\"type\":\"${websocket_types_1.MESSAGE_TYPES.EVENT}\"`);\n                    const isResultMessage = messageStr.includes(`\"type\":\"${websocket_types_1.MESSAGE_TYPES.RESULT}\"`);\n                    if (isEventMessage) {\n                        messageType = \"event\";\n                        allowLargeMessage = true;\n                    }\n                    else if (isResultMessage) {\n                        messageType = \"result\";\n                        allowLargeMessage = true;\n                    }\n                    else {\n                        messageType = \"parse-error\";\n                        allowLargeMessage = false;\n                    }\n                }\n            }\n            if (!allowLargeMessage) {\n                this.invalidMessages++;\n                this.logger?.warn(`Message too large and not streaming data: ${messageStr.length} bytes, ` +\n                    `type: ${messageType}, preview: ${messageStr.substring(0, 100)}...`);\n                return { valid: false, error: \"Message too large\" };\n            }\n            else {\n                // Log but allow the message\n                this.logger?.debug(`Large message allowed for streaming: ${messageStr.length} bytes, type: ${messageType}`);\n            }\n        }\n        // JSON parsing with validation\n        let parsedMessage;\n        try {\n            parsedMessage = JSON.parse(messageStr);\n        }\n        catch (error) {\n            this.invalidMessages++;\n            this.logger?.warn(\"Invalid JSON message:\", messageStr.substring(0, 100));\n            return { valid: false, error: \"Invalid JSON\" };\n        }\n        // Message structure validation\n        const validation = this.validateMessageStructure(parsedMessage);\n        if (!validation.valid) {\n            this.invalidMessages++;\n            return { valid: false, error: validation.error };\n        }\n        this.processedMessages++;\n        return { valid: true, message: parsedMessage };\n    }\n    /**\n     * Validate basic message structure\n     */\n    validateMessageStructure(message) {\n        // Must be an object\n        if (typeof message !== \"object\" || message === null) {\n            return { valid: false, error: \"Message must be an object\" };\n        }\n        // Must have a type field\n        if (!message.type || typeof message.type !== \"string\") {\n            return { valid: false, error: \"Message must have a string type field\" };\n        }\n        // Type should be reasonable length\n        if (message.type.length > 50) {\n            return { valid: false, error: \"Message type too long\" };\n        }\n        // If messageId exists, it should be a string\n        if (message.messageId && typeof message.messageId !== \"string\") {\n            return { valid: false, error: \"MessageId must be a string\" };\n        }\n        // Basic circular reference check\n        try {\n            JSON.stringify(message);\n        }\n        catch (error) {\n            return { valid: false, error: \"Message contains circular references\" };\n        }\n        return { valid: true };\n    }\n    /**\n     * Get processing statistics\n     */\n    getStats() {\n        return {\n            processedMessages: this.processedMessages,\n            invalidMessages: this.invalidMessages,\n            rateLimitedMessages: this.rateLimitedMessages,\n            rateLimiter: this.rateLimiter.getStats(),\n        };\n    }\n    /**\n     * Reset statistics\n     */\n    resetStats() {\n        this.processedMessages = 0;\n        this.invalidMessages = 0;\n        this.rateLimitedMessages = 0;\n    }\n}\nexports.WebSocketMessageProcessor = WebSocketMessageProcessor;\n//# sourceMappingURL=websocket-message-processor.js.map","'use strict';\n\nconst { tokenChars } = require('./validation');\n\n/**\n * Parses the `Sec-WebSocket-Protocol` header into a set of subprotocol names.\n *\n * @param {String} header The field value of the header\n * @return {Set} The subprotocol names\n * @public\n */\nfunction parse(header) {\n  const protocols = new Set();\n  let start = -1;\n  let end = -1;\n  let i = 0;\n\n  for (i; i < header.length; i++) {\n    const code = header.charCodeAt(i);\n\n    if (end === -1 && tokenChars[code] === 1) {\n      if (start === -1) start = i;\n    } else if (\n      i !== 0 &&\n      (code === 0x20 /* ' ' */ || code === 0x09) /* '\\t' */\n    ) {\n      if (end === -1 && start !== -1) end = i;\n    } else if (code === 0x2c /* ',' */) {\n      if (start === -1) {\n        throw new SyntaxError(`Unexpected character at index ${i}`);\n      }\n\n      if (end === -1) end = i;\n\n      const protocol = header.slice(start, end);\n\n      if (protocols.has(protocol)) {\n        throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n      }\n\n      protocols.add(protocol);\n      start = end = -1;\n    } else {\n      throw new SyntaxError(`Unexpected character at index ${i}`);\n    }\n  }\n\n  if (start === -1 || end !== -1) {\n    throw new SyntaxError('Unexpected end of input');\n  }\n\n  const protocol = header.slice(start, i);\n\n  if (protocols.has(protocol)) {\n    throw new SyntaxError(`The \"${protocol}\" subprotocol is duplicated`);\n  }\n\n  protocols.add(protocol);\n  return protocols;\n}\n\nmodule.exports = { parse };\n","function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = () => ([]);\nwebpackEmptyContext.resolve = webpackEmptyContext;\nwebpackEmptyContext.id = 3891;\nmodule.exports = webpackEmptyContext;","'use strict';\n\nconst { isUtf8 } = require('buffer');\n\nconst { hasBlob } = require('./constants');\n\n//\n// Allowed token characters:\n//\n// '!', '#', '$', '%', '&', ''', '*', '+', '-',\n// '.', 0-9, A-Z, '^', '_', '`', a-z, '|', '~'\n//\n// tokenChars[32] === 0 // ' '\n// tokenChars[33] === 1 // '!'\n// tokenChars[34] === 0 // '\"'\n// ...\n//\n// prettier-ignore\nconst tokenChars = [\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 0 - 15\n  0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, // 16 - 31\n  0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 1, 0, // 32 - 47\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, // 48 - 63\n  0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 64 - 79\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, // 80 - 95\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, // 96 - 111\n  1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 0 // 112 - 127\n];\n\n/**\n * Checks if a status code is allowed in a close frame.\n *\n * @param {Number} code The status code\n * @return {Boolean} `true` if the status code is valid, else `false`\n * @public\n */\nfunction isValidStatusCode(code) {\n  return (\n    (code >= 1000 &&\n      code <= 1014 &&\n      code !== 1004 &&\n      code !== 1005 &&\n      code !== 1006) ||\n    (code >= 3000 && code <= 4999)\n  );\n}\n\n/**\n * Checks if a given buffer contains only correct UTF-8.\n * Ported from https://www.cl.cam.ac.uk/%7Emgk25/ucs/utf8_check.c by\n * Markus Kuhn.\n *\n * @param {Buffer} buf The buffer to check\n * @return {Boolean} `true` if `buf` contains only correct UTF-8, else `false`\n * @public\n */\nfunction _isValidUTF8(buf) {\n  const len = buf.length;\n  let i = 0;\n\n  while (i < len) {\n    if ((buf[i] & 0x80) === 0) {\n      // 0xxxxxxx\n      i++;\n    } else if ((buf[i] & 0xe0) === 0xc0) {\n      // 110xxxxx 10xxxxxx\n      if (\n        i + 1 === len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i] & 0xfe) === 0xc0 // Overlong\n      ) {\n        return false;\n      }\n\n      i += 2;\n    } else if ((buf[i] & 0xf0) === 0xe0) {\n      // 1110xxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 2 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xe0 && (buf[i + 1] & 0xe0) === 0x80) || // Overlong\n        (buf[i] === 0xed && (buf[i + 1] & 0xe0) === 0xa0) // Surrogate (U+D800 - U+DFFF)\n      ) {\n        return false;\n      }\n\n      i += 3;\n    } else if ((buf[i] & 0xf8) === 0xf0) {\n      // 11110xxx 10xxxxxx 10xxxxxx 10xxxxxx\n      if (\n        i + 3 >= len ||\n        (buf[i + 1] & 0xc0) !== 0x80 ||\n        (buf[i + 2] & 0xc0) !== 0x80 ||\n        (buf[i + 3] & 0xc0) !== 0x80 ||\n        (buf[i] === 0xf0 && (buf[i + 1] & 0xf0) === 0x80) || // Overlong\n        (buf[i] === 0xf4 && buf[i + 1] > 0x8f) ||\n        buf[i] > 0xf4 // > U+10FFFF\n      ) {\n        return false;\n      }\n\n      i += 4;\n    } else {\n      return false;\n    }\n  }\n\n  return true;\n}\n\n/**\n * Determines whether a value is a `Blob`.\n *\n * @param {*} value The value to be tested\n * @return {Boolean} `true` if `value` is a `Blob`, else `false`\n * @private\n */\nfunction isBlob(value) {\n  return (\n    hasBlob &&\n    typeof value === 'object' &&\n    typeof value.arrayBuffer === 'function' &&\n    typeof value.type === 'string' &&\n    typeof value.stream === 'function' &&\n    (value[Symbol.toStringTag] === 'Blob' ||\n      value[Symbol.toStringTag] === 'File')\n  );\n}\n\nmodule.exports = {\n  isBlob,\n  isValidStatusCode,\n  isValidUTF8: _isValidUTF8,\n  tokenChars\n};\n\nif (isUtf8) {\n  module.exports.isValidUTF8 = function (buf) {\n    return buf.length < 24 ? _isValidUTF8(buf) : isUtf8(buf);\n  };\n} /* istanbul ignore else  */ else if (!process.env.WS_NO_UTF_8_VALIDATE) {\n  try {\n    const isValidUTF8 = require('utf-8-validate');\n\n    module.exports.isValidUTF8 = function (buf) {\n      return buf.length < 32 ? _isValidUTF8(buf) : isValidUTF8(buf);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","'use strict';\n\nconst BINARY_TYPES = ['nodebuffer', 'arraybuffer', 'fragments'];\nconst hasBlob = typeof Blob !== 'undefined';\n\nif (hasBlob) BINARY_TYPES.push('blob');\n\nmodule.exports = {\n  BINARY_TYPES,\n  EMPTY_BUFFER: Buffer.alloc(0),\n  GUID: '258EAFA5-E914-47DA-95CA-C5AB0DC85B11',\n  hasBlob,\n  kForOnEventAttribute: Symbol('kIsForOnEventAttribute'),\n  kListener: Symbol('kListener'),\n  kStatusCode: Symbol('status-code'),\n  kWebSocket: Symbol('websocket'),\n  NOOP: () => {}\n};\n","\"use strict\";\n/**\n * Driver command types and interfaces for Eufy driver\n *\n * Defines all command interfaces for driver-level operations in the Eufy Security WebSocket API.\n * Includes authentication, connection, event, and log commands.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=commands.js.map","\"use strict\";\n/**\n * Eufy WebSocket API Device Events\n *\n * Contains TypeScript interfaces for device-level event payloads in the Eufy Security WebSocket API.\n * Uses official types from the upstream eufy-security-client repository where possible.\n *\n * See: eufy-security-ws/docs/api_events.md for event schema details.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=events.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ScryptedMimeTypes = exports.ScryptedInterface = exports.MediaPlayerState = exports.SecuritySystemObstruction = exports.SecuritySystemMode = exports.AirQuality = exports.AirPurifierMode = exports.AirPurifierStatus = exports.ChargeState = exports.LockState = exports.PanTiltZoomMovement = exports.ThermostatMode = exports.TemperatureUnit = exports.FanMode = exports.HumidityMode = exports.ScryptedDeviceType = exports.ScryptedInterfaceDescriptors = exports.ScryptedInterfaceMethod = exports.ScryptedInterfaceProperty = exports.DeviceBase = exports.TYPES_VERSION = void 0;\nexports.TYPES_VERSION = \"0.5.44\";\nclass DeviceBase {\n}\nexports.DeviceBase = DeviceBase;\nvar ScryptedInterfaceProperty;\n(function (ScryptedInterfaceProperty) {\n    ScryptedInterfaceProperty[\"id\"] = \"id\";\n    ScryptedInterfaceProperty[\"info\"] = \"info\";\n    ScryptedInterfaceProperty[\"interfaces\"] = \"interfaces\";\n    ScryptedInterfaceProperty[\"mixins\"] = \"mixins\";\n    ScryptedInterfaceProperty[\"name\"] = \"name\";\n    ScryptedInterfaceProperty[\"nativeId\"] = \"nativeId\";\n    ScryptedInterfaceProperty[\"pluginId\"] = \"pluginId\";\n    ScryptedInterfaceProperty[\"providedInterfaces\"] = \"providedInterfaces\";\n    ScryptedInterfaceProperty[\"providedName\"] = \"providedName\";\n    ScryptedInterfaceProperty[\"providedRoom\"] = \"providedRoom\";\n    ScryptedInterfaceProperty[\"providedType\"] = \"providedType\";\n    ScryptedInterfaceProperty[\"providerId\"] = \"providerId\";\n    ScryptedInterfaceProperty[\"room\"] = \"room\";\n    ScryptedInterfaceProperty[\"type\"] = \"type\";\n    ScryptedInterfaceProperty[\"scryptedRuntimeArguments\"] = \"scryptedRuntimeArguments\";\n    ScryptedInterfaceProperty[\"on\"] = \"on\";\n    ScryptedInterfaceProperty[\"brightness\"] = \"brightness\";\n    ScryptedInterfaceProperty[\"colorTemperature\"] = \"colorTemperature\";\n    ScryptedInterfaceProperty[\"rgb\"] = \"rgb\";\n    ScryptedInterfaceProperty[\"hsv\"] = \"hsv\";\n    ScryptedInterfaceProperty[\"buttons\"] = \"buttons\";\n    ScryptedInterfaceProperty[\"sensors\"] = \"sensors\";\n    ScryptedInterfaceProperty[\"running\"] = \"running\";\n    ScryptedInterfaceProperty[\"paused\"] = \"paused\";\n    ScryptedInterfaceProperty[\"docked\"] = \"docked\";\n    ScryptedInterfaceProperty[\"temperatureSetting\"] = \"temperatureSetting\";\n    ScryptedInterfaceProperty[\"temperature\"] = \"temperature\";\n    ScryptedInterfaceProperty[\"temperatureUnit\"] = \"temperatureUnit\";\n    ScryptedInterfaceProperty[\"humidity\"] = \"humidity\";\n    ScryptedInterfaceProperty[\"resolution\"] = \"resolution\";\n    ScryptedInterfaceProperty[\"audioVolumes\"] = \"audioVolumes\";\n    ScryptedInterfaceProperty[\"recordingActive\"] = \"recordingActive\";\n    ScryptedInterfaceProperty[\"ptzCapabilities\"] = \"ptzCapabilities\";\n    ScryptedInterfaceProperty[\"lockState\"] = \"lockState\";\n    ScryptedInterfaceProperty[\"entryOpen\"] = \"entryOpen\";\n    ScryptedInterfaceProperty[\"batteryLevel\"] = \"batteryLevel\";\n    ScryptedInterfaceProperty[\"chargeState\"] = \"chargeState\";\n    ScryptedInterfaceProperty[\"online\"] = \"online\";\n    ScryptedInterfaceProperty[\"fromMimeType\"] = \"fromMimeType\";\n    ScryptedInterfaceProperty[\"toMimeType\"] = \"toMimeType\";\n    ScryptedInterfaceProperty[\"converters\"] = \"converters\";\n    ScryptedInterfaceProperty[\"binaryState\"] = \"binaryState\";\n    ScryptedInterfaceProperty[\"tampered\"] = \"tampered\";\n    ScryptedInterfaceProperty[\"sleeping\"] = \"sleeping\";\n    ScryptedInterfaceProperty[\"powerDetected\"] = \"powerDetected\";\n    ScryptedInterfaceProperty[\"audioDetected\"] = \"audioDetected\";\n    ScryptedInterfaceProperty[\"motionDetected\"] = \"motionDetected\";\n    ScryptedInterfaceProperty[\"ambientLight\"] = \"ambientLight\";\n    ScryptedInterfaceProperty[\"occupied\"] = \"occupied\";\n    ScryptedInterfaceProperty[\"flooded\"] = \"flooded\";\n    ScryptedInterfaceProperty[\"ultraviolet\"] = \"ultraviolet\";\n    ScryptedInterfaceProperty[\"luminance\"] = \"luminance\";\n    ScryptedInterfaceProperty[\"position\"] = \"position\";\n    ScryptedInterfaceProperty[\"securitySystemState\"] = \"securitySystemState\";\n    ScryptedInterfaceProperty[\"pm10Density\"] = \"pm10Density\";\n    ScryptedInterfaceProperty[\"pm25Density\"] = \"pm25Density\";\n    ScryptedInterfaceProperty[\"vocDensity\"] = \"vocDensity\";\n    ScryptedInterfaceProperty[\"noxDensity\"] = \"noxDensity\";\n    ScryptedInterfaceProperty[\"co2ppm\"] = \"co2ppm\";\n    ScryptedInterfaceProperty[\"airQuality\"] = \"airQuality\";\n    ScryptedInterfaceProperty[\"airPurifierState\"] = \"airPurifierState\";\n    ScryptedInterfaceProperty[\"filterChangeIndication\"] = \"filterChangeIndication\";\n    ScryptedInterfaceProperty[\"filterLifeLevel\"] = \"filterLifeLevel\";\n    ScryptedInterfaceProperty[\"humiditySetting\"] = \"humiditySetting\";\n    ScryptedInterfaceProperty[\"fan\"] = \"fan\";\n    ScryptedInterfaceProperty[\"applicationInfo\"] = \"applicationInfo\";\n    ScryptedInterfaceProperty[\"chatCompletionCapabilities\"] = \"chatCompletionCapabilities\";\n    ScryptedInterfaceProperty[\"systemDevice\"] = \"systemDevice\";\n})(ScryptedInterfaceProperty || (exports.ScryptedInterfaceProperty = ScryptedInterfaceProperty = {}));\nvar ScryptedInterfaceMethod;\n(function (ScryptedInterfaceMethod) {\n    ScryptedInterfaceMethod[\"listen\"] = \"listen\";\n    ScryptedInterfaceMethod[\"probe\"] = \"probe\";\n    ScryptedInterfaceMethod[\"setMixins\"] = \"setMixins\";\n    ScryptedInterfaceMethod[\"setName\"] = \"setName\";\n    ScryptedInterfaceMethod[\"setRoom\"] = \"setRoom\";\n    ScryptedInterfaceMethod[\"setType\"] = \"setType\";\n    ScryptedInterfaceMethod[\"getPluginJson\"] = \"getPluginJson\";\n    ScryptedInterfaceMethod[\"turnOff\"] = \"turnOff\";\n    ScryptedInterfaceMethod[\"turnOn\"] = \"turnOn\";\n    ScryptedInterfaceMethod[\"setBrightness\"] = \"setBrightness\";\n    ScryptedInterfaceMethod[\"getTemperatureMaxK\"] = \"getTemperatureMaxK\";\n    ScryptedInterfaceMethod[\"getTemperatureMinK\"] = \"getTemperatureMinK\";\n    ScryptedInterfaceMethod[\"setColorTemperature\"] = \"setColorTemperature\";\n    ScryptedInterfaceMethod[\"setRgb\"] = \"setRgb\";\n    ScryptedInterfaceMethod[\"setHsv\"] = \"setHsv\";\n    ScryptedInterfaceMethod[\"pressButton\"] = \"pressButton\";\n    ScryptedInterfaceMethod[\"sendNotification\"] = \"sendNotification\";\n    ScryptedInterfaceMethod[\"start\"] = \"start\";\n    ScryptedInterfaceMethod[\"stop\"] = \"stop\";\n    ScryptedInterfaceMethod[\"pause\"] = \"pause\";\n    ScryptedInterfaceMethod[\"resume\"] = \"resume\";\n    ScryptedInterfaceMethod[\"dock\"] = \"dock\";\n    ScryptedInterfaceMethod[\"setTemperature\"] = \"setTemperature\";\n    ScryptedInterfaceMethod[\"setTemperatureUnit\"] = \"setTemperatureUnit\";\n    ScryptedInterfaceMethod[\"getPictureOptions\"] = \"getPictureOptions\";\n    ScryptedInterfaceMethod[\"takePicture\"] = \"takePicture\";\n    ScryptedInterfaceMethod[\"getAudioStream\"] = \"getAudioStream\";\n    ScryptedInterfaceMethod[\"setAudioVolumes\"] = \"setAudioVolumes\";\n    ScryptedInterfaceMethod[\"startDisplay\"] = \"startDisplay\";\n    ScryptedInterfaceMethod[\"stopDisplay\"] = \"stopDisplay\";\n    ScryptedInterfaceMethod[\"getVideoStream\"] = \"getVideoStream\";\n    ScryptedInterfaceMethod[\"getVideoStreamOptions\"] = \"getVideoStreamOptions\";\n    ScryptedInterfaceMethod[\"getPrivacyMasks\"] = \"getPrivacyMasks\";\n    ScryptedInterfaceMethod[\"setPrivacyMasks\"] = \"setPrivacyMasks\";\n    ScryptedInterfaceMethod[\"getVideoTextOverlays\"] = \"getVideoTextOverlays\";\n    ScryptedInterfaceMethod[\"setVideoTextOverlay\"] = \"setVideoTextOverlay\";\n    ScryptedInterfaceMethod[\"getRecordingStream\"] = \"getRecordingStream\";\n    ScryptedInterfaceMethod[\"getRecordingStreamCurrentTime\"] = \"getRecordingStreamCurrentTime\";\n    ScryptedInterfaceMethod[\"getRecordingStreamOptions\"] = \"getRecordingStreamOptions\";\n    ScryptedInterfaceMethod[\"getRecordingStreamThumbnail\"] = \"getRecordingStreamThumbnail\";\n    ScryptedInterfaceMethod[\"deleteRecordingStream\"] = \"deleteRecordingStream\";\n    ScryptedInterfaceMethod[\"setRecordingActive\"] = \"setRecordingActive\";\n    ScryptedInterfaceMethod[\"ptzCommand\"] = \"ptzCommand\";\n    ScryptedInterfaceMethod[\"getRecordedEvents\"] = \"getRecordedEvents\";\n    ScryptedInterfaceMethod[\"getVideoClip\"] = \"getVideoClip\";\n    ScryptedInterfaceMethod[\"getVideoClips\"] = \"getVideoClips\";\n    ScryptedInterfaceMethod[\"getVideoClipThumbnail\"] = \"getVideoClipThumbnail\";\n    ScryptedInterfaceMethod[\"removeVideoClips\"] = \"removeVideoClips\";\n    ScryptedInterfaceMethod[\"setVideoStreamOptions\"] = \"setVideoStreamOptions\";\n    ScryptedInterfaceMethod[\"startIntercom\"] = \"startIntercom\";\n    ScryptedInterfaceMethod[\"stopIntercom\"] = \"stopIntercom\";\n    ScryptedInterfaceMethod[\"lock\"] = \"lock\";\n    ScryptedInterfaceMethod[\"unlock\"] = \"unlock\";\n    ScryptedInterfaceMethod[\"addPassword\"] = \"addPassword\";\n    ScryptedInterfaceMethod[\"getPasswords\"] = \"getPasswords\";\n    ScryptedInterfaceMethod[\"removePassword\"] = \"removePassword\";\n    ScryptedInterfaceMethod[\"activate\"] = \"activate\";\n    ScryptedInterfaceMethod[\"deactivate\"] = \"deactivate\";\n    ScryptedInterfaceMethod[\"isReversible\"] = \"isReversible\";\n    ScryptedInterfaceMethod[\"closeEntry\"] = \"closeEntry\";\n    ScryptedInterfaceMethod[\"openEntry\"] = \"openEntry\";\n    ScryptedInterfaceMethod[\"getDevice\"] = \"getDevice\";\n    ScryptedInterfaceMethod[\"releaseDevice\"] = \"releaseDevice\";\n    ScryptedInterfaceMethod[\"adoptDevice\"] = \"adoptDevice\";\n    ScryptedInterfaceMethod[\"discoverDevices\"] = \"discoverDevices\";\n    ScryptedInterfaceMethod[\"createDevice\"] = \"createDevice\";\n    ScryptedInterfaceMethod[\"getCreateDeviceSettings\"] = \"getCreateDeviceSettings\";\n    ScryptedInterfaceMethod[\"reboot\"] = \"reboot\";\n    ScryptedInterfaceMethod[\"getRefreshFrequency\"] = \"getRefreshFrequency\";\n    ScryptedInterfaceMethod[\"refresh\"] = \"refresh\";\n    ScryptedInterfaceMethod[\"getMediaStatus\"] = \"getMediaStatus\";\n    ScryptedInterfaceMethod[\"load\"] = \"load\";\n    ScryptedInterfaceMethod[\"seek\"] = \"seek\";\n    ScryptedInterfaceMethod[\"skipNext\"] = \"skipNext\";\n    ScryptedInterfaceMethod[\"skipPrevious\"] = \"skipPrevious\";\n    ScryptedInterfaceMethod[\"convert\"] = \"convert\";\n    ScryptedInterfaceMethod[\"convertMedia\"] = \"convertMedia\";\n    ScryptedInterfaceMethod[\"getSettings\"] = \"getSettings\";\n    ScryptedInterfaceMethod[\"putSetting\"] = \"putSetting\";\n    ScryptedInterfaceMethod[\"armSecuritySystem\"] = \"armSecuritySystem\";\n    ScryptedInterfaceMethod[\"disarmSecuritySystem\"] = \"disarmSecuritySystem\";\n    ScryptedInterfaceMethod[\"setAirPurifierState\"] = \"setAirPurifierState\";\n    ScryptedInterfaceMethod[\"getReadmeMarkdown\"] = \"getReadmeMarkdown\";\n    ScryptedInterfaceMethod[\"getOauthUrl\"] = \"getOauthUrl\";\n    ScryptedInterfaceMethod[\"onOauthCallback\"] = \"onOauthCallback\";\n    ScryptedInterfaceMethod[\"canMixin\"] = \"canMixin\";\n    ScryptedInterfaceMethod[\"getMixin\"] = \"getMixin\";\n    ScryptedInterfaceMethod[\"releaseMixin\"] = \"releaseMixin\";\n    ScryptedInterfaceMethod[\"onRequest\"] = \"onRequest\";\n    ScryptedInterfaceMethod[\"onConnection\"] = \"onConnection\";\n    ScryptedInterfaceMethod[\"onPush\"] = \"onPush\";\n    ScryptedInterfaceMethod[\"run\"] = \"run\";\n    ScryptedInterfaceMethod[\"eval\"] = \"eval\";\n    ScryptedInterfaceMethod[\"loadScripts\"] = \"loadScripts\";\n    ScryptedInterfaceMethod[\"saveScript\"] = \"saveScript\";\n    ScryptedInterfaceMethod[\"forkInterface\"] = \"forkInterface\";\n    ScryptedInterfaceMethod[\"getDetectionInput\"] = \"getDetectionInput\";\n    ScryptedInterfaceMethod[\"getObjectTypes\"] = \"getObjectTypes\";\n    ScryptedInterfaceMethod[\"detectObjects\"] = \"detectObjects\";\n    ScryptedInterfaceMethod[\"generateObjectDetections\"] = \"generateObjectDetections\";\n    ScryptedInterfaceMethod[\"getDetectionModel\"] = \"getDetectionModel\";\n    ScryptedInterfaceMethod[\"setHumidity\"] = \"setHumidity\";\n    ScryptedInterfaceMethod[\"setFan\"] = \"setFan\";\n    ScryptedInterfaceMethod[\"startRTCSignalingSession\"] = \"startRTCSignalingSession\";\n    ScryptedInterfaceMethod[\"createRTCSignalingSession\"] = \"createRTCSignalingSession\";\n    ScryptedInterfaceMethod[\"getScryptedUserAccessControl\"] = \"getScryptedUserAccessControl\";\n    ScryptedInterfaceMethod[\"generateVideoFrames\"] = \"generateVideoFrames\";\n    ScryptedInterfaceMethod[\"connectStream\"] = \"connectStream\";\n    ScryptedInterfaceMethod[\"getTTYSettings\"] = \"getTTYSettings\";\n    ScryptedInterfaceMethod[\"getChatCompletion\"] = \"getChatCompletion\";\n    ScryptedInterfaceMethod[\"streamChatCompletion\"] = \"streamChatCompletion\";\n    ScryptedInterfaceMethod[\"getTextEmbedding\"] = \"getTextEmbedding\";\n    ScryptedInterfaceMethod[\"getImageEmbedding\"] = \"getImageEmbedding\";\n    ScryptedInterfaceMethod[\"callLLMTool\"] = \"callLLMTool\";\n    ScryptedInterfaceMethod[\"getLLMTools\"] = \"getLLMTools\";\n})(ScryptedInterfaceMethod || (exports.ScryptedInterfaceMethod = ScryptedInterfaceMethod = {}));\nexports.ScryptedInterfaceDescriptors = {\n    \"ScryptedDevice\": {\n        \"name\": \"ScryptedDevice\",\n        \"methods\": [\n            \"listen\",\n            \"probe\",\n            \"setMixins\",\n            \"setName\",\n            \"setRoom\",\n            \"setType\"\n        ],\n        \"properties\": [\n            \"id\",\n            \"info\",\n            \"interfaces\",\n            \"mixins\",\n            \"name\",\n            \"nativeId\",\n            \"pluginId\",\n            \"providedInterfaces\",\n            \"providedName\",\n            \"providedRoom\",\n            \"providedType\",\n            \"providerId\",\n            \"room\",\n            \"type\"\n        ]\n    },\n    \"ScryptedPlugin\": {\n        \"name\": \"ScryptedPlugin\",\n        \"methods\": [\n            \"getPluginJson\"\n        ],\n        \"properties\": []\n    },\n    \"ScryptedPluginRuntime\": {\n        \"name\": \"ScryptedPluginRuntime\",\n        \"methods\": [],\n        \"properties\": [\n            \"scryptedRuntimeArguments\"\n        ]\n    },\n    \"OnOff\": {\n        \"name\": \"OnOff\",\n        \"methods\": [\n            \"turnOff\",\n            \"turnOn\"\n        ],\n        \"properties\": [\n            \"on\"\n        ]\n    },\n    \"Brightness\": {\n        \"name\": \"Brightness\",\n        \"methods\": [\n            \"setBrightness\"\n        ],\n        \"properties\": [\n            \"brightness\"\n        ]\n    },\n    \"ColorSettingTemperature\": {\n        \"name\": \"ColorSettingTemperature\",\n        \"methods\": [\n            \"getTemperatureMaxK\",\n            \"getTemperatureMinK\",\n            \"setColorTemperature\"\n        ],\n        \"properties\": [\n            \"colorTemperature\"\n        ]\n    },\n    \"ColorSettingRgb\": {\n        \"name\": \"ColorSettingRgb\",\n        \"methods\": [\n            \"setRgb\"\n        ],\n        \"properties\": [\n            \"rgb\"\n        ]\n    },\n    \"ColorSettingHsv\": {\n        \"name\": \"ColorSettingHsv\",\n        \"methods\": [\n            \"setHsv\"\n        ],\n        \"properties\": [\n            \"hsv\"\n        ]\n    },\n    \"Buttons\": {\n        \"name\": \"Buttons\",\n        \"methods\": [],\n        \"properties\": [\n            \"buttons\"\n        ]\n    },\n    \"PressButtons\": {\n        \"name\": \"PressButtons\",\n        \"methods\": [\n            \"pressButton\"\n        ],\n        \"properties\": []\n    },\n    \"Sensors\": {\n        \"name\": \"Sensors\",\n        \"methods\": [],\n        \"properties\": [\n            \"sensors\"\n        ]\n    },\n    \"Notifier\": {\n        \"name\": \"Notifier\",\n        \"methods\": [\n            \"sendNotification\"\n        ],\n        \"properties\": []\n    },\n    \"StartStop\": {\n        \"name\": \"StartStop\",\n        \"methods\": [\n            \"start\",\n            \"stop\"\n        ],\n        \"properties\": [\n            \"running\"\n        ]\n    },\n    \"Pause\": {\n        \"name\": \"Pause\",\n        \"methods\": [\n            \"pause\",\n            \"resume\"\n        ],\n        \"properties\": [\n            \"paused\"\n        ]\n    },\n    \"Dock\": {\n        \"name\": \"Dock\",\n        \"methods\": [\n            \"dock\"\n        ],\n        \"properties\": [\n            \"docked\"\n        ]\n    },\n    \"TemperatureSetting\": {\n        \"name\": \"TemperatureSetting\",\n        \"methods\": [\n            \"setTemperature\"\n        ],\n        \"properties\": [\n            \"temperatureSetting\"\n        ]\n    },\n    \"Thermometer\": {\n        \"name\": \"Thermometer\",\n        \"methods\": [\n            \"setTemperatureUnit\"\n        ],\n        \"properties\": [\n            \"temperature\",\n            \"temperatureUnit\"\n        ]\n    },\n    \"HumiditySensor\": {\n        \"name\": \"HumiditySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"humidity\"\n        ]\n    },\n    \"Camera\": {\n        \"name\": \"Camera\",\n        \"methods\": [\n            \"getPictureOptions\",\n            \"takePicture\"\n        ],\n        \"properties\": []\n    },\n    \"Resolution\": {\n        \"name\": \"Resolution\",\n        \"methods\": [],\n        \"properties\": [\n            \"resolution\"\n        ]\n    },\n    \"Microphone\": {\n        \"name\": \"Microphone\",\n        \"methods\": [\n            \"getAudioStream\"\n        ],\n        \"properties\": []\n    },\n    \"AudioVolumeControl\": {\n        \"name\": \"AudioVolumeControl\",\n        \"methods\": [\n            \"setAudioVolumes\"\n        ],\n        \"properties\": [\n            \"audioVolumes\"\n        ]\n    },\n    \"Display\": {\n        \"name\": \"Display\",\n        \"methods\": [\n            \"startDisplay\",\n            \"stopDisplay\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCamera\": {\n        \"name\": \"VideoCamera\",\n        \"methods\": [\n            \"getVideoStream\",\n            \"getVideoStreamOptions\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCameraMask\": {\n        \"name\": \"VideoCameraMask\",\n        \"methods\": [\n            \"getPrivacyMasks\",\n            \"setPrivacyMasks\"\n        ],\n        \"properties\": []\n    },\n    \"VideoTextOverlays\": {\n        \"name\": \"VideoTextOverlays\",\n        \"methods\": [\n            \"getVideoTextOverlays\",\n            \"setVideoTextOverlay\"\n        ],\n        \"properties\": []\n    },\n    \"VideoRecorder\": {\n        \"name\": \"VideoRecorder\",\n        \"methods\": [\n            \"getRecordingStream\",\n            \"getRecordingStreamCurrentTime\",\n            \"getRecordingStreamOptions\",\n            \"getRecordingStreamThumbnail\"\n        ],\n        \"properties\": [\n            \"recordingActive\"\n        ]\n    },\n    \"VideoRecorderManagement\": {\n        \"name\": \"VideoRecorderManagement\",\n        \"methods\": [\n            \"deleteRecordingStream\",\n            \"setRecordingActive\"\n        ],\n        \"properties\": []\n    },\n    \"PanTiltZoom\": {\n        \"name\": \"PanTiltZoom\",\n        \"methods\": [\n            \"ptzCommand\"\n        ],\n        \"properties\": [\n            \"ptzCapabilities\"\n        ]\n    },\n    \"EventRecorder\": {\n        \"name\": \"EventRecorder\",\n        \"methods\": [\n            \"getRecordedEvents\"\n        ],\n        \"properties\": []\n    },\n    \"VideoClips\": {\n        \"name\": \"VideoClips\",\n        \"methods\": [\n            \"getVideoClip\",\n            \"getVideoClips\",\n            \"getVideoClipThumbnail\",\n            \"removeVideoClips\"\n        ],\n        \"properties\": []\n    },\n    \"VideoCameraConfiguration\": {\n        \"name\": \"VideoCameraConfiguration\",\n        \"methods\": [\n            \"setVideoStreamOptions\"\n        ],\n        \"properties\": []\n    },\n    \"Intercom\": {\n        \"name\": \"Intercom\",\n        \"methods\": [\n            \"startIntercom\",\n            \"stopIntercom\"\n        ],\n        \"properties\": []\n    },\n    \"Lock\": {\n        \"name\": \"Lock\",\n        \"methods\": [\n            \"lock\",\n            \"unlock\"\n        ],\n        \"properties\": [\n            \"lockState\"\n        ]\n    },\n    \"PasswordStore\": {\n        \"name\": \"PasswordStore\",\n        \"methods\": [\n            \"addPassword\",\n            \"getPasswords\",\n            \"removePassword\"\n        ],\n        \"properties\": []\n    },\n    \"Scene\": {\n        \"name\": \"Scene\",\n        \"methods\": [\n            \"activate\",\n            \"deactivate\",\n            \"isReversible\"\n        ],\n        \"properties\": []\n    },\n    \"Entry\": {\n        \"name\": \"Entry\",\n        \"methods\": [\n            \"closeEntry\",\n            \"openEntry\"\n        ],\n        \"properties\": []\n    },\n    \"EntrySensor\": {\n        \"name\": \"EntrySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"entryOpen\"\n        ]\n    },\n    \"DeviceProvider\": {\n        \"name\": \"DeviceProvider\",\n        \"methods\": [\n            \"getDevice\",\n            \"releaseDevice\"\n        ],\n        \"properties\": []\n    },\n    \"DeviceDiscovery\": {\n        \"name\": \"DeviceDiscovery\",\n        \"methods\": [\n            \"adoptDevice\",\n            \"discoverDevices\"\n        ],\n        \"properties\": []\n    },\n    \"DeviceCreator\": {\n        \"name\": \"DeviceCreator\",\n        \"methods\": [\n            \"createDevice\",\n            \"getCreateDeviceSettings\"\n        ],\n        \"properties\": []\n    },\n    \"Battery\": {\n        \"name\": \"Battery\",\n        \"methods\": [],\n        \"properties\": [\n            \"batteryLevel\"\n        ]\n    },\n    \"Charger\": {\n        \"name\": \"Charger\",\n        \"methods\": [],\n        \"properties\": [\n            \"chargeState\"\n        ]\n    },\n    \"Reboot\": {\n        \"name\": \"Reboot\",\n        \"methods\": [\n            \"reboot\"\n        ],\n        \"properties\": []\n    },\n    \"Refresh\": {\n        \"name\": \"Refresh\",\n        \"methods\": [\n            \"getRefreshFrequency\",\n            \"refresh\"\n        ],\n        \"properties\": []\n    },\n    \"MediaPlayer\": {\n        \"name\": \"MediaPlayer\",\n        \"methods\": [\n            \"getMediaStatus\",\n            \"load\",\n            \"seek\",\n            \"skipNext\",\n            \"skipPrevious\"\n        ],\n        \"properties\": []\n    },\n    \"Online\": {\n        \"name\": \"Online\",\n        \"methods\": [],\n        \"properties\": [\n            \"online\"\n        ]\n    },\n    \"BufferConverter\": {\n        \"name\": \"BufferConverter\",\n        \"methods\": [\n            \"convert\"\n        ],\n        \"properties\": [\n            \"fromMimeType\",\n            \"toMimeType\"\n        ]\n    },\n    \"MediaConverter\": {\n        \"name\": \"MediaConverter\",\n        \"methods\": [\n            \"convertMedia\"\n        ],\n        \"properties\": [\n            \"converters\"\n        ]\n    },\n    \"Settings\": {\n        \"name\": \"Settings\",\n        \"methods\": [\n            \"getSettings\",\n            \"putSetting\"\n        ],\n        \"properties\": []\n    },\n    \"BinarySensor\": {\n        \"name\": \"BinarySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"binaryState\"\n        ]\n    },\n    \"TamperSensor\": {\n        \"name\": \"TamperSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"tampered\"\n        ]\n    },\n    \"Sleep\": {\n        \"name\": \"Sleep\",\n        \"methods\": [],\n        \"properties\": [\n            \"sleeping\"\n        ]\n    },\n    \"PowerSensor\": {\n        \"name\": \"PowerSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"powerDetected\"\n        ]\n    },\n    \"AudioSensor\": {\n        \"name\": \"AudioSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"audioDetected\"\n        ]\n    },\n    \"MotionSensor\": {\n        \"name\": \"MotionSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"motionDetected\"\n        ]\n    },\n    \"AmbientLightSensor\": {\n        \"name\": \"AmbientLightSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"ambientLight\"\n        ]\n    },\n    \"OccupancySensor\": {\n        \"name\": \"OccupancySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"occupied\"\n        ]\n    },\n    \"FloodSensor\": {\n        \"name\": \"FloodSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"flooded\"\n        ]\n    },\n    \"UltravioletSensor\": {\n        \"name\": \"UltravioletSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"ultraviolet\"\n        ]\n    },\n    \"LuminanceSensor\": {\n        \"name\": \"LuminanceSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"luminance\"\n        ]\n    },\n    \"PositionSensor\": {\n        \"name\": \"PositionSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"position\"\n        ]\n    },\n    \"SecuritySystem\": {\n        \"name\": \"SecuritySystem\",\n        \"methods\": [\n            \"armSecuritySystem\",\n            \"disarmSecuritySystem\"\n        ],\n        \"properties\": [\n            \"securitySystemState\"\n        ]\n    },\n    \"PM10Sensor\": {\n        \"name\": \"PM10Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"pm10Density\"\n        ]\n    },\n    \"PM25Sensor\": {\n        \"name\": \"PM25Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"pm25Density\"\n        ]\n    },\n    \"VOCSensor\": {\n        \"name\": \"VOCSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"vocDensity\"\n        ]\n    },\n    \"NOXSensor\": {\n        \"name\": \"NOXSensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"noxDensity\"\n        ]\n    },\n    \"CO2Sensor\": {\n        \"name\": \"CO2Sensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"co2ppm\"\n        ]\n    },\n    \"AirQualitySensor\": {\n        \"name\": \"AirQualitySensor\",\n        \"methods\": [],\n        \"properties\": [\n            \"airQuality\"\n        ]\n    },\n    \"AirPurifier\": {\n        \"name\": \"AirPurifier\",\n        \"methods\": [\n            \"setAirPurifierState\"\n        ],\n        \"properties\": [\n            \"airPurifierState\"\n        ]\n    },\n    \"FilterMaintenance\": {\n        \"name\": \"FilterMaintenance\",\n        \"methods\": [],\n        \"properties\": [\n            \"filterChangeIndication\",\n            \"filterLifeLevel\"\n        ]\n    },\n    \"Readme\": {\n        \"name\": \"Readme\",\n        \"methods\": [\n            \"getReadmeMarkdown\"\n        ],\n        \"properties\": []\n    },\n    \"OauthClient\": {\n        \"name\": \"OauthClient\",\n        \"methods\": [\n            \"getOauthUrl\",\n            \"onOauthCallback\"\n        ],\n        \"properties\": []\n    },\n    \"MixinProvider\": {\n        \"name\": \"MixinProvider\",\n        \"methods\": [\n            \"canMixin\",\n            \"getMixin\",\n            \"releaseMixin\"\n        ],\n        \"properties\": []\n    },\n    \"HttpRequestHandler\": {\n        \"name\": \"HttpRequestHandler\",\n        \"methods\": [\n            \"onRequest\"\n        ],\n        \"properties\": []\n    },\n    \"EngineIOHandler\": {\n        \"name\": \"EngineIOHandler\",\n        \"methods\": [\n            \"onConnection\"\n        ],\n        \"properties\": []\n    },\n    \"PushHandler\": {\n        \"name\": \"PushHandler\",\n        \"methods\": [\n            \"onPush\"\n        ],\n        \"properties\": []\n    },\n    \"Program\": {\n        \"name\": \"Program\",\n        \"methods\": [\n            \"run\"\n        ],\n        \"properties\": []\n    },\n    \"Scriptable\": {\n        \"name\": \"Scriptable\",\n        \"methods\": [\n            \"eval\",\n            \"loadScripts\",\n            \"saveScript\"\n        ],\n        \"properties\": []\n    },\n    \"ClusterForkInterface\": {\n        \"name\": \"ClusterForkInterface\",\n        \"methods\": [\n            \"forkInterface\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetector\": {\n        \"name\": \"ObjectDetector\",\n        \"methods\": [\n            \"getDetectionInput\",\n            \"getObjectTypes\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetection\": {\n        \"name\": \"ObjectDetection\",\n        \"methods\": [\n            \"detectObjects\",\n            \"generateObjectDetections\",\n            \"getDetectionModel\"\n        ],\n        \"properties\": []\n    },\n    \"ObjectDetectionPreview\": {\n        \"name\": \"ObjectDetectionPreview\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"ObjectDetectionGenerator\": {\n        \"name\": \"ObjectDetectionGenerator\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"HumiditySetting\": {\n        \"name\": \"HumiditySetting\",\n        \"methods\": [\n            \"setHumidity\"\n        ],\n        \"properties\": [\n            \"humiditySetting\"\n        ]\n    },\n    \"Fan\": {\n        \"name\": \"Fan\",\n        \"methods\": [\n            \"setFan\"\n        ],\n        \"properties\": [\n            \"fan\"\n        ]\n    },\n    \"RTCSignalingChannel\": {\n        \"name\": \"RTCSignalingChannel\",\n        \"methods\": [\n            \"startRTCSignalingSession\"\n        ],\n        \"properties\": []\n    },\n    \"RTCSignalingClient\": {\n        \"name\": \"RTCSignalingClient\",\n        \"methods\": [\n            \"createRTCSignalingSession\"\n        ],\n        \"properties\": []\n    },\n    \"LauncherApplication\": {\n        \"name\": \"LauncherApplication\",\n        \"methods\": [],\n        \"properties\": [\n            \"applicationInfo\"\n        ]\n    },\n    \"ScryptedUser\": {\n        \"name\": \"ScryptedUser\",\n        \"methods\": [\n            \"getScryptedUserAccessControl\"\n        ],\n        \"properties\": []\n    },\n    \"VideoFrameGenerator\": {\n        \"name\": \"VideoFrameGenerator\",\n        \"methods\": [\n            \"generateVideoFrames\"\n        ],\n        \"properties\": []\n    },\n    \"StreamService\": {\n        \"name\": \"StreamService\",\n        \"methods\": [\n            \"connectStream\"\n        ],\n        \"properties\": []\n    },\n    \"TTY\": {\n        \"name\": \"TTY\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"TTYSettings\": {\n        \"name\": \"TTYSettings\",\n        \"methods\": [\n            \"getTTYSettings\"\n        ],\n        \"properties\": []\n    },\n    \"ChatCompletion\": {\n        \"name\": \"ChatCompletion\",\n        \"methods\": [\n            \"getChatCompletion\",\n            \"streamChatCompletion\"\n        ],\n        \"properties\": [\n            \"chatCompletionCapabilities\"\n        ]\n    },\n    \"TextEmbedding\": {\n        \"name\": \"TextEmbedding\",\n        \"methods\": [\n            \"getTextEmbedding\"\n        ],\n        \"properties\": []\n    },\n    \"ImageEmbedding\": {\n        \"name\": \"ImageEmbedding\",\n        \"methods\": [\n            \"getImageEmbedding\"\n        ],\n        \"properties\": []\n    },\n    \"LLMTools\": {\n        \"name\": \"LLMTools\",\n        \"methods\": [\n            \"callLLMTool\",\n            \"getLLMTools\"\n        ],\n        \"properties\": []\n    },\n    \"ScryptedSystemDevice\": {\n        \"name\": \"ScryptedSystemDevice\",\n        \"methods\": [],\n        \"properties\": [\n            \"systemDevice\"\n        ]\n    },\n    \"ScryptedDeviceCreator\": {\n        \"name\": \"ScryptedDeviceCreator\",\n        \"methods\": [],\n        \"properties\": []\n    },\n    \"ScryptedSettings\": {\n        \"name\": \"ScryptedSettings\",\n        \"methods\": [],\n        \"properties\": []\n    }\n};\n/**\n * @category Core Reference\n */\nvar ScryptedDeviceType;\n(function (ScryptedDeviceType) {\n    /**\n     * @deprecated\n     */\n    ScryptedDeviceType[\"Builtin\"] = \"Builtin\";\n    /**\n     * Internal devices will not show up in device lists unless explicitly searched.\n     */\n    ScryptedDeviceType[\"Internal\"] = \"Internal\";\n    ScryptedDeviceType[\"Camera\"] = \"Camera\";\n    ScryptedDeviceType[\"Fan\"] = \"Fan\";\n    ScryptedDeviceType[\"Light\"] = \"Light\";\n    ScryptedDeviceType[\"Switch\"] = \"Switch\";\n    ScryptedDeviceType[\"Outlet\"] = \"Outlet\";\n    ScryptedDeviceType[\"Sensor\"] = \"Sensor\";\n    ScryptedDeviceType[\"Scene\"] = \"Scene\";\n    ScryptedDeviceType[\"Program\"] = \"Program\";\n    ScryptedDeviceType[\"Automation\"] = \"Automation\";\n    ScryptedDeviceType[\"Vacuum\"] = \"Vacuum\";\n    ScryptedDeviceType[\"Notifier\"] = \"Notifier\";\n    ScryptedDeviceType[\"Thermostat\"] = \"Thermostat\";\n    ScryptedDeviceType[\"Lock\"] = \"Lock\";\n    ScryptedDeviceType[\"PasswordControl\"] = \"PasswordControl\";\n    /**\n     * Displays have audio and video output.\n     */\n    ScryptedDeviceType[\"Display\"] = \"Display\";\n    /**\n     * Smart Displays have two way audio and video.\n     */\n    ScryptedDeviceType[\"SmartDisplay\"] = \"SmartDisplay\";\n    ScryptedDeviceType[\"Speaker\"] = \"Speaker\";\n    /**\n     * Smart Speakers have two way audio.\n     */\n    ScryptedDeviceType[\"SmartSpeaker\"] = \"SmartSpeaker\";\n    ScryptedDeviceType[\"RemoteDesktop\"] = \"RemoteDesktop\";\n    ScryptedDeviceType[\"Event\"] = \"Event\";\n    ScryptedDeviceType[\"Entry\"] = \"Entry\";\n    ScryptedDeviceType[\"Garage\"] = \"Garage\";\n    ScryptedDeviceType[\"DeviceProvider\"] = \"DeviceProvider\";\n    ScryptedDeviceType[\"DataSource\"] = \"DataSource\";\n    ScryptedDeviceType[\"API\"] = \"API\";\n    ScryptedDeviceType[\"Doorbell\"] = \"Doorbell\";\n    ScryptedDeviceType[\"Irrigation\"] = \"Irrigation\";\n    ScryptedDeviceType[\"Valve\"] = \"Valve\";\n    ScryptedDeviceType[\"Person\"] = \"Person\";\n    ScryptedDeviceType[\"SecuritySystem\"] = \"SecuritySystem\";\n    ScryptedDeviceType[\"WindowCovering\"] = \"WindowCovering\";\n    ScryptedDeviceType[\"Siren\"] = \"Siren\";\n    ScryptedDeviceType[\"AirPurifier\"] = \"AirPurifier\";\n    ScryptedDeviceType[\"Internet\"] = \"Internet\";\n    ScryptedDeviceType[\"Network\"] = \"Network\";\n    ScryptedDeviceType[\"Bridge\"] = \"Bridge\";\n    ScryptedDeviceType[\"LLM\"] = \"LLM\";\n    ScryptedDeviceType[\"Unknown\"] = \"Unknown\";\n})(ScryptedDeviceType || (exports.ScryptedDeviceType = ScryptedDeviceType = {}));\nvar HumidityMode;\n(function (HumidityMode) {\n    HumidityMode[\"Humidify\"] = \"Humidify\";\n    HumidityMode[\"Dehumidify\"] = \"Dehumidify\";\n    HumidityMode[\"Auto\"] = \"Auto\";\n    HumidityMode[\"Off\"] = \"Off\";\n})(HumidityMode || (exports.HumidityMode = HumidityMode = {}));\nvar FanMode;\n(function (FanMode) {\n    FanMode[\"Auto\"] = \"Auto\";\n    FanMode[\"Manual\"] = \"Manual\";\n})(FanMode || (exports.FanMode = FanMode = {}));\nvar TemperatureUnit;\n(function (TemperatureUnit) {\n    TemperatureUnit[\"C\"] = \"C\";\n    TemperatureUnit[\"F\"] = \"F\";\n})(TemperatureUnit || (exports.TemperatureUnit = TemperatureUnit = {}));\nvar ThermostatMode;\n(function (ThermostatMode) {\n    ThermostatMode[\"Off\"] = \"Off\";\n    ThermostatMode[\"Cool\"] = \"Cool\";\n    ThermostatMode[\"Heat\"] = \"Heat\";\n    ThermostatMode[\"HeatCool\"] = \"HeatCool\";\n    ThermostatMode[\"Auto\"] = \"Auto\";\n    ThermostatMode[\"FanOnly\"] = \"FanOnly\";\n    ThermostatMode[\"Purifier\"] = \"Purifier\";\n    ThermostatMode[\"Eco\"] = \"Eco\";\n    ThermostatMode[\"Dry\"] = \"Dry\";\n    ThermostatMode[\"On\"] = \"On\";\n})(ThermostatMode || (exports.ThermostatMode = ThermostatMode = {}));\nvar PanTiltZoomMovement;\n(function (PanTiltZoomMovement) {\n    PanTiltZoomMovement[\"Absolute\"] = \"Absolute\";\n    PanTiltZoomMovement[\"Relative\"] = \"Relative\";\n    PanTiltZoomMovement[\"Continuous\"] = \"Continuous\";\n    PanTiltZoomMovement[\"Preset\"] = \"Preset\";\n    PanTiltZoomMovement[\"Home\"] = \"Home\";\n})(PanTiltZoomMovement || (exports.PanTiltZoomMovement = PanTiltZoomMovement = {}));\nvar LockState;\n(function (LockState) {\n    LockState[\"Locked\"] = \"Locked\";\n    LockState[\"Unlocked\"] = \"Unlocked\";\n    LockState[\"Jammed\"] = \"Jammed\";\n})(LockState || (exports.LockState = LockState = {}));\nvar ChargeState;\n(function (ChargeState) {\n    ChargeState[\"Trickle\"] = \"trickle\";\n    ChargeState[\"Charging\"] = \"charging\";\n    ChargeState[\"NotCharging\"] = \"not-charging\";\n})(ChargeState || (exports.ChargeState = ChargeState = {}));\nvar AirPurifierStatus;\n(function (AirPurifierStatus) {\n    AirPurifierStatus[\"Inactive\"] = \"Inactive\";\n    AirPurifierStatus[\"Idle\"] = \"Idle\";\n    AirPurifierStatus[\"Active\"] = \"Active\";\n    AirPurifierStatus[\"ActiveNightMode\"] = \"ActiveNightMode\";\n})(AirPurifierStatus || (exports.AirPurifierStatus = AirPurifierStatus = {}));\nvar AirPurifierMode;\n(function (AirPurifierMode) {\n    AirPurifierMode[\"Manual\"] = \"Manual\";\n    AirPurifierMode[\"Automatic\"] = \"Automatic\";\n})(AirPurifierMode || (exports.AirPurifierMode = AirPurifierMode = {}));\nvar AirQuality;\n(function (AirQuality) {\n    AirQuality[\"Unknown\"] = \"Unknown\";\n    AirQuality[\"Excellent\"] = \"Excellent\";\n    AirQuality[\"Good\"] = \"Good\";\n    AirQuality[\"Fair\"] = \"Fair\";\n    AirQuality[\"Inferior\"] = \"Inferior\";\n    AirQuality[\"Poor\"] = \"Poor\";\n})(AirQuality || (exports.AirQuality = AirQuality = {}));\nvar SecuritySystemMode;\n(function (SecuritySystemMode) {\n    SecuritySystemMode[\"Disarmed\"] = \"Disarmed\";\n    SecuritySystemMode[\"HomeArmed\"] = \"HomeArmed\";\n    SecuritySystemMode[\"AwayArmed\"] = \"AwayArmed\";\n    SecuritySystemMode[\"NightArmed\"] = \"NightArmed\";\n})(SecuritySystemMode || (exports.SecuritySystemMode = SecuritySystemMode = {}));\nvar SecuritySystemObstruction;\n(function (SecuritySystemObstruction) {\n    SecuritySystemObstruction[\"Sensor\"] = \"Sensor\";\n    SecuritySystemObstruction[\"Occupied\"] = \"Occupied\";\n    SecuritySystemObstruction[\"Time\"] = \"Time\";\n    SecuritySystemObstruction[\"Error\"] = \"Error\";\n})(SecuritySystemObstruction || (exports.SecuritySystemObstruction = SecuritySystemObstruction = {}));\nvar MediaPlayerState;\n(function (MediaPlayerState) {\n    MediaPlayerState[\"Idle\"] = \"Idle\";\n    MediaPlayerState[\"Playing\"] = \"Playing\";\n    MediaPlayerState[\"Paused\"] = \"Paused\";\n    MediaPlayerState[\"Buffering\"] = \"Buffering\";\n})(MediaPlayerState || (exports.MediaPlayerState = MediaPlayerState = {}));\nvar ScryptedInterface;\n(function (ScryptedInterface) {\n    ScryptedInterface[\"ScryptedDevice\"] = \"ScryptedDevice\";\n    ScryptedInterface[\"ScryptedPlugin\"] = \"ScryptedPlugin\";\n    ScryptedInterface[\"ScryptedPluginRuntime\"] = \"ScryptedPluginRuntime\";\n    ScryptedInterface[\"OnOff\"] = \"OnOff\";\n    ScryptedInterface[\"Brightness\"] = \"Brightness\";\n    ScryptedInterface[\"ColorSettingTemperature\"] = \"ColorSettingTemperature\";\n    ScryptedInterface[\"ColorSettingRgb\"] = \"ColorSettingRgb\";\n    ScryptedInterface[\"ColorSettingHsv\"] = \"ColorSettingHsv\";\n    ScryptedInterface[\"Buttons\"] = \"Buttons\";\n    ScryptedInterface[\"PressButtons\"] = \"PressButtons\";\n    ScryptedInterface[\"Sensors\"] = \"Sensors\";\n    ScryptedInterface[\"Notifier\"] = \"Notifier\";\n    ScryptedInterface[\"StartStop\"] = \"StartStop\";\n    ScryptedInterface[\"Pause\"] = \"Pause\";\n    ScryptedInterface[\"Dock\"] = \"Dock\";\n    ScryptedInterface[\"TemperatureSetting\"] = \"TemperatureSetting\";\n    ScryptedInterface[\"Thermometer\"] = \"Thermometer\";\n    ScryptedInterface[\"HumiditySensor\"] = \"HumiditySensor\";\n    ScryptedInterface[\"Camera\"] = \"Camera\";\n    ScryptedInterface[\"Resolution\"] = \"Resolution\";\n    ScryptedInterface[\"Microphone\"] = \"Microphone\";\n    ScryptedInterface[\"AudioVolumeControl\"] = \"AudioVolumeControl\";\n    ScryptedInterface[\"Display\"] = \"Display\";\n    ScryptedInterface[\"VideoCamera\"] = \"VideoCamera\";\n    ScryptedInterface[\"VideoCameraMask\"] = \"VideoCameraMask\";\n    ScryptedInterface[\"VideoTextOverlays\"] = \"VideoTextOverlays\";\n    ScryptedInterface[\"VideoRecorder\"] = \"VideoRecorder\";\n    ScryptedInterface[\"VideoRecorderManagement\"] = \"VideoRecorderManagement\";\n    ScryptedInterface[\"PanTiltZoom\"] = \"PanTiltZoom\";\n    ScryptedInterface[\"EventRecorder\"] = \"EventRecorder\";\n    ScryptedInterface[\"VideoClips\"] = \"VideoClips\";\n    ScryptedInterface[\"VideoCameraConfiguration\"] = \"VideoCameraConfiguration\";\n    ScryptedInterface[\"Intercom\"] = \"Intercom\";\n    ScryptedInterface[\"Lock\"] = \"Lock\";\n    ScryptedInterface[\"PasswordStore\"] = \"PasswordStore\";\n    ScryptedInterface[\"Scene\"] = \"Scene\";\n    ScryptedInterface[\"Entry\"] = \"Entry\";\n    ScryptedInterface[\"EntrySensor\"] = \"EntrySensor\";\n    ScryptedInterface[\"DeviceProvider\"] = \"DeviceProvider\";\n    ScryptedInterface[\"DeviceDiscovery\"] = \"DeviceDiscovery\";\n    ScryptedInterface[\"DeviceCreator\"] = \"DeviceCreator\";\n    ScryptedInterface[\"Battery\"] = \"Battery\";\n    ScryptedInterface[\"Charger\"] = \"Charger\";\n    ScryptedInterface[\"Reboot\"] = \"Reboot\";\n    ScryptedInterface[\"Refresh\"] = \"Refresh\";\n    ScryptedInterface[\"MediaPlayer\"] = \"MediaPlayer\";\n    ScryptedInterface[\"Online\"] = \"Online\";\n    ScryptedInterface[\"BufferConverter\"] = \"BufferConverter\";\n    ScryptedInterface[\"MediaConverter\"] = \"MediaConverter\";\n    ScryptedInterface[\"Settings\"] = \"Settings\";\n    ScryptedInterface[\"BinarySensor\"] = \"BinarySensor\";\n    ScryptedInterface[\"TamperSensor\"] = \"TamperSensor\";\n    ScryptedInterface[\"Sleep\"] = \"Sleep\";\n    ScryptedInterface[\"PowerSensor\"] = \"PowerSensor\";\n    ScryptedInterface[\"AudioSensor\"] = \"AudioSensor\";\n    ScryptedInterface[\"MotionSensor\"] = \"MotionSensor\";\n    ScryptedInterface[\"AmbientLightSensor\"] = \"AmbientLightSensor\";\n    ScryptedInterface[\"OccupancySensor\"] = \"OccupancySensor\";\n    ScryptedInterface[\"FloodSensor\"] = \"FloodSensor\";\n    ScryptedInterface[\"UltravioletSensor\"] = \"UltravioletSensor\";\n    ScryptedInterface[\"LuminanceSensor\"] = \"LuminanceSensor\";\n    ScryptedInterface[\"PositionSensor\"] = \"PositionSensor\";\n    ScryptedInterface[\"SecuritySystem\"] = \"SecuritySystem\";\n    ScryptedInterface[\"PM10Sensor\"] = \"PM10Sensor\";\n    ScryptedInterface[\"PM25Sensor\"] = \"PM25Sensor\";\n    ScryptedInterface[\"VOCSensor\"] = \"VOCSensor\";\n    ScryptedInterface[\"NOXSensor\"] = \"NOXSensor\";\n    ScryptedInterface[\"CO2Sensor\"] = \"CO2Sensor\";\n    ScryptedInterface[\"AirQualitySensor\"] = \"AirQualitySensor\";\n    ScryptedInterface[\"AirPurifier\"] = \"AirPurifier\";\n    ScryptedInterface[\"FilterMaintenance\"] = \"FilterMaintenance\";\n    ScryptedInterface[\"Readme\"] = \"Readme\";\n    ScryptedInterface[\"OauthClient\"] = \"OauthClient\";\n    ScryptedInterface[\"MixinProvider\"] = \"MixinProvider\";\n    ScryptedInterface[\"HttpRequestHandler\"] = \"HttpRequestHandler\";\n    ScryptedInterface[\"EngineIOHandler\"] = \"EngineIOHandler\";\n    ScryptedInterface[\"PushHandler\"] = \"PushHandler\";\n    ScryptedInterface[\"Program\"] = \"Program\";\n    ScryptedInterface[\"Scriptable\"] = \"Scriptable\";\n    ScryptedInterface[\"ClusterForkInterface\"] = \"ClusterForkInterface\";\n    ScryptedInterface[\"ObjectDetector\"] = \"ObjectDetector\";\n    ScryptedInterface[\"ObjectDetection\"] = \"ObjectDetection\";\n    ScryptedInterface[\"ObjectDetectionPreview\"] = \"ObjectDetectionPreview\";\n    ScryptedInterface[\"ObjectDetectionGenerator\"] = \"ObjectDetectionGenerator\";\n    ScryptedInterface[\"HumiditySetting\"] = \"HumiditySetting\";\n    ScryptedInterface[\"Fan\"] = \"Fan\";\n    ScryptedInterface[\"RTCSignalingChannel\"] = \"RTCSignalingChannel\";\n    ScryptedInterface[\"RTCSignalingClient\"] = \"RTCSignalingClient\";\n    ScryptedInterface[\"LauncherApplication\"] = \"LauncherApplication\";\n    ScryptedInterface[\"ScryptedUser\"] = \"ScryptedUser\";\n    ScryptedInterface[\"VideoFrameGenerator\"] = \"VideoFrameGenerator\";\n    ScryptedInterface[\"StreamService\"] = \"StreamService\";\n    ScryptedInterface[\"TTY\"] = \"TTY\";\n    ScryptedInterface[\"TTYSettings\"] = \"TTYSettings\";\n    ScryptedInterface[\"ChatCompletion\"] = \"ChatCompletion\";\n    ScryptedInterface[\"TextEmbedding\"] = \"TextEmbedding\";\n    ScryptedInterface[\"ImageEmbedding\"] = \"ImageEmbedding\";\n    ScryptedInterface[\"LLMTools\"] = \"LLMTools\";\n    ScryptedInterface[\"ScryptedSystemDevice\"] = \"ScryptedSystemDevice\";\n    ScryptedInterface[\"ScryptedDeviceCreator\"] = \"ScryptedDeviceCreator\";\n    ScryptedInterface[\"ScryptedSettings\"] = \"ScryptedSettings\";\n})(ScryptedInterface || (exports.ScryptedInterface = ScryptedInterface = {}));\nvar ScryptedMimeTypes;\n(function (ScryptedMimeTypes) {\n    ScryptedMimeTypes[\"Url\"] = \"text/x-uri\";\n    ScryptedMimeTypes[\"InsecureLocalUrl\"] = \"text/x-insecure-local-uri\";\n    ScryptedMimeTypes[\"LocalUrl\"] = \"text/x-local-uri\";\n    ScryptedMimeTypes[\"ServerId\"] = \"text/x-server-id\";\n    ScryptedMimeTypes[\"PushEndpoint\"] = \"text/x-push-endpoint\";\n    ScryptedMimeTypes[\"SchemePrefix\"] = \"x-scrypted/x-scrypted-scheme-\";\n    ScryptedMimeTypes[\"MediaStreamUrl\"] = \"text/x-media-url\";\n    ScryptedMimeTypes[\"MediaObject\"] = \"x-scrypted/x-scrypted-media-object\";\n    ScryptedMimeTypes[\"RequestMediaObject\"] = \"x-scrypted/x-scrypted-request-media-object\";\n    ScryptedMimeTypes[\"RequestMediaStream\"] = \"x-scrypted/x-scrypted-request-stream\";\n    ScryptedMimeTypes[\"MediaStreamFeedback\"] = \"x-scrypted/x-media-stream-feedback\";\n    ScryptedMimeTypes[\"FFmpegInput\"] = \"x-scrypted/x-ffmpeg-input\";\n    ScryptedMimeTypes[\"FFmpegTranscodeStream\"] = \"x-scrypted/x-ffmpeg-transcode-stream\";\n    ScryptedMimeTypes[\"RTCSignalingChannel\"] = \"x-scrypted/x-scrypted-rtc-signaling-channel\";\n    ScryptedMimeTypes[\"RTCSignalingSession\"] = \"x-scrypted/x-scrypted-rtc-signaling-session\";\n    ScryptedMimeTypes[\"RTCConnectionManagement\"] = \"x-scrypted/x-scrypted-rtc-connection-management\";\n    ScryptedMimeTypes[\"Image\"] = \"x-scrypted/x-scrypted-image\";\n})(ScryptedMimeTypes || (exports.ScryptedMimeTypes = ScryptedMimeTypes = {}));\n//# sourceMappingURL=index.js.map","'use strict';\n\nconst { kForOnEventAttribute, kListener } = require('./constants');\n\nconst kCode = Symbol('kCode');\nconst kData = Symbol('kData');\nconst kError = Symbol('kError');\nconst kMessage = Symbol('kMessage');\nconst kReason = Symbol('kReason');\nconst kTarget = Symbol('kTarget');\nconst kType = Symbol('kType');\nconst kWasClean = Symbol('kWasClean');\n\n/**\n * Class representing an event.\n */\nclass Event {\n  /**\n   * Create a new `Event`.\n   *\n   * @param {String} type The name of the event\n   * @throws {TypeError} If the `type` argument is not specified\n   */\n  constructor(type) {\n    this[kTarget] = null;\n    this[kType] = type;\n  }\n\n  /**\n   * @type {*}\n   */\n  get target() {\n    return this[kTarget];\n  }\n\n  /**\n   * @type {String}\n   */\n  get type() {\n    return this[kType];\n  }\n}\n\nObject.defineProperty(Event.prototype, 'target', { enumerable: true });\nObject.defineProperty(Event.prototype, 'type', { enumerable: true });\n\n/**\n * Class representing a close event.\n *\n * @extends Event\n */\nclass CloseEvent extends Event {\n  /**\n   * Create a new `CloseEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {Number} [options.code=0] The status code explaining why the\n   *     connection was closed\n   * @param {String} [options.reason=''] A human-readable string explaining why\n   *     the connection was closed\n   * @param {Boolean} [options.wasClean=false] Indicates whether or not the\n   *     connection was cleanly closed\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kCode] = options.code === undefined ? 0 : options.code;\n    this[kReason] = options.reason === undefined ? '' : options.reason;\n    this[kWasClean] = options.wasClean === undefined ? false : options.wasClean;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get code() {\n    return this[kCode];\n  }\n\n  /**\n   * @type {String}\n   */\n  get reason() {\n    return this[kReason];\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get wasClean() {\n    return this[kWasClean];\n  }\n}\n\nObject.defineProperty(CloseEvent.prototype, 'code', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'reason', { enumerable: true });\nObject.defineProperty(CloseEvent.prototype, 'wasClean', { enumerable: true });\n\n/**\n * Class representing an error event.\n *\n * @extends Event\n */\nclass ErrorEvent extends Event {\n  /**\n   * Create a new `ErrorEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.error=null] The error that generated this event\n   * @param {String} [options.message=''] The error message\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kError] = options.error === undefined ? null : options.error;\n    this[kMessage] = options.message === undefined ? '' : options.message;\n  }\n\n  /**\n   * @type {*}\n   */\n  get error() {\n    return this[kError];\n  }\n\n  /**\n   * @type {String}\n   */\n  get message() {\n    return this[kMessage];\n  }\n}\n\nObject.defineProperty(ErrorEvent.prototype, 'error', { enumerable: true });\nObject.defineProperty(ErrorEvent.prototype, 'message', { enumerable: true });\n\n/**\n * Class representing a message event.\n *\n * @extends Event\n */\nclass MessageEvent extends Event {\n  /**\n   * Create a new `MessageEvent`.\n   *\n   * @param {String} type The name of the event\n   * @param {Object} [options] A dictionary object that allows for setting\n   *     attributes via object members of the same name\n   * @param {*} [options.data=null] The message content\n   */\n  constructor(type, options = {}) {\n    super(type);\n\n    this[kData] = options.data === undefined ? null : options.data;\n  }\n\n  /**\n   * @type {*}\n   */\n  get data() {\n    return this[kData];\n  }\n}\n\nObject.defineProperty(MessageEvent.prototype, 'data', { enumerable: true });\n\n/**\n * This provides methods for emulating the `EventTarget` interface. It's not\n * meant to be used directly.\n *\n * @mixin\n */\nconst EventTarget = {\n  /**\n   * Register an event listener.\n   *\n   * @param {String} type A string representing the event type to listen for\n   * @param {(Function|Object)} handler The listener to add\n   * @param {Object} [options] An options object specifies characteristics about\n   *     the event listener\n   * @param {Boolean} [options.once=false] A `Boolean` indicating that the\n   *     listener should be invoked at most once after being added. If `true`,\n   *     the listener would be automatically removed when invoked.\n   * @public\n   */\n  addEventListener(type, handler, options = {}) {\n    for (const listener of this.listeners(type)) {\n      if (\n        !options[kForOnEventAttribute] &&\n        listener[kListener] === handler &&\n        !listener[kForOnEventAttribute]\n      ) {\n        return;\n      }\n    }\n\n    let wrapper;\n\n    if (type === 'message') {\n      wrapper = function onMessage(data, isBinary) {\n        const event = new MessageEvent('message', {\n          data: isBinary ? data : data.toString()\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'close') {\n      wrapper = function onClose(code, message) {\n        const event = new CloseEvent('close', {\n          code,\n          reason: message.toString(),\n          wasClean: this._closeFrameReceived && this._closeFrameSent\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'error') {\n      wrapper = function onError(error) {\n        const event = new ErrorEvent('error', {\n          error,\n          message: error.message\n        });\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else if (type === 'open') {\n      wrapper = function onOpen() {\n        const event = new Event('open');\n\n        event[kTarget] = this;\n        callListener(handler, this, event);\n      };\n    } else {\n      return;\n    }\n\n    wrapper[kForOnEventAttribute] = !!options[kForOnEventAttribute];\n    wrapper[kListener] = handler;\n\n    if (options.once) {\n      this.once(type, wrapper);\n    } else {\n      this.on(type, wrapper);\n    }\n  },\n\n  /**\n   * Remove an event listener.\n   *\n   * @param {String} type A string representing the event type to remove\n   * @param {(Function|Object)} handler The listener to remove\n   * @public\n   */\n  removeEventListener(type, handler) {\n    for (const listener of this.listeners(type)) {\n      if (listener[kListener] === handler && !listener[kForOnEventAttribute]) {\n        this.removeListener(type, listener);\n        break;\n      }\n    }\n  }\n};\n\nmodule.exports = {\n  CloseEvent,\n  ErrorEvent,\n  Event,\n  EventTarget,\n  MessageEvent\n};\n\n/**\n * Call an event listener\n *\n * @param {(Function|Object)} listener The listener to call\n * @param {*} thisArg The value to use as `this`` when calling the listener\n * @param {Event} event The event to pass to the listener\n * @private\n */\nfunction callListener(listener, thisArg, event) {\n  if (typeof listener === 'object' && listener.handleEvent) {\n    listener.handleEvent.call(listener, event);\n  } else {\n    listener.call(thisArg, event);\n  }\n}\n","module.exports = require(\"events\");","module.exports = require(\"tls\");","\"use strict\";\n/**\n * H.264 Parser - Simple NAL unit parsing for raw H.264 streams\n *\n * This parser provides essential H.264 parsing capabilities including NAL unit\n * extraction, keyframe detection, and basic validation. It's designed for\n * streaming scenarios where full H.264 parsing is not required.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.H264Parser = void 0;\n/**\n * Simple H.264 parser for extracting NAL units and basic metadata\n *\n * Provides methods for parsing H.264 stream data, identifying NAL units,\n * detecting keyframes, and validating data structure integrity.\n *\n * @example\n * ```typescript\n * const parser = new H264Parser(logger);\n * const nalUnits = parser.extractNALUnits(h264Buffer);\n * const isKeyFrame = parser.isKeyFrame(h264Buffer);\n * ```\n */\nclass H264Parser {\n    /**\n     * Creates a new H264Parser instance\n     *\n     * @param logger - Logger instance compatible with tslog's Logger<ILogObj> interface\n     */\n    constructor(logger) {\n        this.logger = logger;\n    }\n    /**\n     * Extract NAL units from raw H.264 data\n     *\n     * Scans the H.264 data buffer for start codes (0x000001 or 0x00000001)\n     * and extracts all NAL units with their type information and keyframe status.\n     *\n     * @param data - Raw H.264 data buffer\n     * @returns Array of extracted NAL units with type and keyframe information\n     *\n     * @example\n     * ```typescript\n     * const nalUnits = parser.extractNALUnits(h264Buffer);\n     * console.log(`Found ${nalUnits.length} NAL units`);\n     * nalUnits.forEach(nal => {\n     *   console.log(`Type: ${nal.type}, KeyFrame: ${nal.isKeyFrame}`);\n     * });\n     * ```\n     */\n    extractNALUnits(data) {\n        const nalUnits = [];\n        let offset = 0;\n        if (data.length < 4) {\n            return nalUnits;\n        }\n        while (offset < data.length) {\n            // Find start code (0x00000001 or 0x000001)\n            const startCodeInfo = this.findStartCode(data, offset);\n            if (!startCodeInfo) {\n                break;\n            }\n            const { position, length } = startCodeInfo;\n            const nalStart = position + length;\n            if (nalStart >= data.length) {\n                break;\n            }\n            // Find next start code or end of data\n            let nalEnd = data.length;\n            const nextStartCode = this.findStartCode(data, nalStart);\n            if (nextStartCode) {\n                nalEnd = nextStartCode.position;\n            }\n            // Extract NAL unit\n            if (nalStart < nalEnd) {\n                const nalData = data.subarray(nalStart, nalEnd);\n                if (nalData.length > 0) {\n                    const nalType = nalData[0] & 0x1f;\n                    const isKeyFrame = this.isKeyFrameNAL(nalType);\n                    nalUnits.push({\n                        type: nalType,\n                        data: nalData,\n                        isKeyFrame,\n                    });\n                }\n            }\n            offset = nalEnd;\n        }\n        return nalUnits;\n    }\n    /**\n     * Find H.264 start code in data buffer\n     *\n     * Searches for 4-byte (0x00000001) or 3-byte (0x000001) start codes\n     * that mark the beginning of NAL units in H.264 streams.\n     *\n     * @param data - Buffer to search for start codes\n     * @param startOffset - Offset position to begin searching from\n     * @returns Object with position and length of start code, or null if not found\n     * @private\n     */\n    findStartCode(data, startOffset) {\n        for (let i = startOffset; i <= data.length - 3; i++) {\n            // Check for 4-byte start code (0x00000001)\n            if (i <= data.length - 4 &&\n                data[i] === 0x00 &&\n                data[i + 1] === 0x00 &&\n                data[i + 2] === 0x00 &&\n                data[i + 3] === 0x01) {\n                return { position: i, length: 4 };\n            }\n            // Check for 3-byte start code (0x000001)\n            if (data[i] === 0x00 && data[i + 1] === 0x00 && data[i + 2] === 0x01) {\n                return { position: i, length: 3 };\n            }\n        }\n        return null;\n    }\n    /**\n     * Check if NAL unit type represents a key frame component\n     *\n     * Key frames contain:\n     * - Type 5: IDR slice (Instantaneous Decoder Refresh) - the actual keyframe\n     * - Type 7: SPS (Sequence Parameter Set) - decoder initialization\n     * - Type 8: PPS (Picture Parameter Set) - picture parameters\n     *\n     * @param nalType - NAL unit type number (0-31)\n     * @returns true if NAL type is part of a keyframe\n     * @private\n     */\n    isKeyFrameNAL(nalType) {\n        // NAL unit types that contain key frame data:\n        // 5 = IDR slice (Instantaneous Decoder Refresh)\n        // 7 = SPS (Sequence Parameter Set)\n        // 8 = PPS (Picture Parameter Set)\n        return nalType === 5 || nalType === 7 || nalType === 8;\n    }\n    /**\n     * Check if H.264 data buffer contains a keyframe\n     *\n     * A keyframe (I-frame/IDR frame) is a self-contained frame that doesn't\n     * depend on other frames. Essential for stream initialization and seeking.\n     *\n     * @param data - Raw H.264 data buffer\n     * @returns true if data contains keyframe NAL units (IDR, SPS, or PPS)\n     *\n     * @example\n     * ```typescript\n     * if (parser.isKeyFrame(videoData)) {\n     *   console.log('Keyframe detected - safe to start decoding');\n     * }\n     * ```\n     */\n    isKeyFrame(data) {\n        const nalUnits = this.extractNALUnits(data);\n        return nalUnits.some((nal) => nal.isKeyFrame);\n    }\n    /**\n     * Validate H.264 data structure integrity\n     *\n     * Performs basic validation to ensure data contains valid H.264 structure:\n     * - Minimum length check (at least 4 bytes for start code)\n     * - Presence of valid start code\n     * - At least one extractable NAL unit\n     *\n     * @param data - Buffer to validate as H.264 data\n     * @returns true if data appears to be valid H.264, false otherwise\n     *\n     * @example\n     * ```typescript\n     * if (!parser.validateH264Data(buffer)) {\n     *   console.error('Invalid H.264 data received');\n     *   return;\n     * }\n     * ```\n     */\n    validateH264Data(data) {\n        if (data.length < 4) {\n            return false;\n        }\n        // Check for valid start code\n        const hasStartCode = this.findStartCode(data, 0) !== null;\n        if (!hasStartCode) {\n            return false;\n        }\n        // Check for at least one valid NAL unit\n        const nalUnits = this.extractNALUnits(data);\n        return nalUnits.length > 0;\n    }\n    /**\n     * Get human-readable name for NAL unit type\n     *\n     * Converts numeric NAL type to descriptive string for logging and debugging.\n     * Returns \"Unknown(type)\" for unrecognized types.\n     *\n     * @param type - NAL unit type number (0-31)\n     * @returns Human-readable NAL type name\n     *\n     * @example\n     * ```typescript\n     * const nalUnits = parser.extractNALUnits(data);\n     * nalUnits.forEach(nal => {\n     *   console.log(`NAL Unit: ${parser.getNALTypeName(nal.type)}`);\n     * });\n     * ```\n     */\n    getNALTypeName(type) {\n        const names = {\n            1: \"P-slice\",\n            2: \"B-slice\",\n            3: \"I-slice\",\n            5: \"IDR-slice\",\n            6: \"SEI\",\n            7: \"SPS\",\n            8: \"PPS\",\n            9: \"AUD\",\n            14: \"Data Partitioning\",\n        };\n        return names[type] || `Unknown(${type})`;\n    }\n}\nexports.H264Parser = H264Parser;\n//# sourceMappingURL=h264-parser.js.map","\"use strict\";\n/**\n * Eufy WebSocket API Driver Events\n *\n * Contains TypeScript interfaces for driver-level event payloads in the Eufy Security WebSocket API.\n *\n * See: eufy-security-ws/docs/api_events.md for event schema details.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=events.js.map","\"use strict\";\n/**\n * Enhanced Command API with more elegant type-safe command execution\n *\n * This approach provides several elegant improvements to the current sendCommand implementation:\n *\n * 1. **Overloaded Methods**: Method overloads for better type inference without params\n * 2. **Command Builders**: Fluent builder pattern for complex commands\n * 3. **Smart Defaults**: Intelligent parameter handling with sensible defaults\n * 4. **Enhanced Type Safety**: Better generic constraints and inference\n * 5. **Command Grouping**: Logical organization of related commands\n * 6. **Performance Optimization**: Efficient method dispatch and minimal overhead\n *\n * @example Basic Usage\n * ```typescript\n * // Enhanced command execution\n * await api.commands.device(\"12345\").getProperties();\n * await api.commands.driver().connect();\n * await api.commands.server().startListening();\n *\n * // Direct command execution with automatic parameter inference\n * await api.commands.command(DEVICE_COMMANDS.GET_PROPERTIES, { serialNumber: \"12345\" });\n * await api.commands.command(DRIVER_COMMANDS.CONNECT); // No params needed\n * ```\n *\n * @public\n * @since 1.0.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ServerCommandBuilder = exports.DriverCommandBuilder = exports.StationCommandBuilder = exports.DeviceCommandBuilder = exports.EnhancedCommandAPI = void 0;\n// Import actual command constants\nconst constants_1 = require(\"./device/constants\");\nconst constants_2 = require(\"./station/constants\");\nconst constants_3 = require(\"./driver/constants\");\nconst constants_4 = require(\"./server/constants\");\n/**\n * Enhanced command API for Eufy Security WebSocket API\n *\n * Provides a fluent interface for building and executing commands with improved\n * type safety and developer experience. Supports both direct command execution\n * and builder pattern for complex operations.\n *\n * @public\n * @since 1.0.0\n */\nclass EnhancedCommandAPI {\n    /**\n     * Creates a new EnhancedCommandAPI instance\n     *\n     * @param apiManager - API manager instance for command execution\n     */\n    constructor(apiManager) {\n        this.apiManager = apiManager;\n    }\n    /**\n     * Enhanced sendCommand with automatic parameter handling\n     *\n     * Usage examples:\n     * - await api.command(DEVICE_COMMANDS.GET_PROPERTIES, { serialNumber: \"12345\" })\n     * - await api.command(DRIVER_COMMANDS.CONNECT) // No params needed\n     * - await api.command(DEVICE_COMMANDS.SET_PROPERTY, { serialNumber: \"12345\", name: \"enabled\", value: true })\n     */\n    async command(command, ...args) {\n        const params = (args[0] || {});\n        return this.apiManager.sendCommand(command, params);\n    }\n    /**\n     * Device command builder for more elegant device operations\n     *\n     * Usage: await api.device(\"12345\").getProperties()\n     *        await api.device(\"12345\").setProperty(\"enabled\", true)\n     */\n    device(serialNumber) {\n        return new DeviceCommandBuilder(serialNumber, this);\n    }\n    /**\n     * Station command builder for more elegant station operations\n     *\n     * Usage: await api.station(\"12345\").getProperties()\n     *        await api.station(\"12345\").setGuardMode(\"home\")\n     */\n    station(serialNumber) {\n        return new StationCommandBuilder(serialNumber, this);\n    }\n    /**\n     * Driver command builder for driver operations\n     *\n     * Usage: await api.driver().connect()\n     *        await api.driver().isConnected()\n     */\n    driver() {\n        return new DriverCommandBuilder(this);\n    }\n    /**\n     * Server command builder for server operations\n     *\n     * Usage: await api.server().startListening()\n     *        await api.server().setApiSchema(21)\n     */\n    server() {\n        return new ServerCommandBuilder(this);\n    }\n}\nexports.EnhancedCommandAPI = EnhancedCommandAPI;\n/**\n * Device command builder with fluent interface\n *\n * Provides a convenient way to execute device-specific commands with automatic\n * serial number injection and type safety.\n *\n * @public\n */\nclass DeviceCommandBuilder {\n    /**\n     * Creates a new DeviceCommandBuilder instance\n     *\n     * @param serialNumber - Device serial number for all commands\n     * @param api - Enhanced command API instance\n     */\n    constructor(serialNumber, api) {\n        this.serialNumber = serialNumber;\n        this.api = api;\n    }\n    /**\n     * Get all properties for this device\n     *\n     * @returns Promise resolving to device properties object\n     *\n     * @example\n     * ```typescript\n     * const properties = await api.device(\"T8210N20123456789\").getProperties();\n     * console.log('Device name:', properties.name);\n     * ```\n     */\n    async getProperties() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.GET_PROPERTIES, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Get device properties metadata\n     */\n    async getPropertiesMetadata() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.GET_PROPERTIES_METADATA, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Check if the device has a specific property\n     */\n    async hasProperty(propertyName) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.HAS_PROPERTY, {\n            serialNumber: this.serialNumber,\n            propertyName,\n        });\n    }\n    /**\n     * Check if the device supports a specific command\n     */\n    async hasCommand(commandName) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.HAS_COMMAND, {\n            serialNumber: this.serialNumber,\n            commandName,\n        });\n    }\n    /**\n     * Get a list of commands supported by the device\n     */\n    async getCommands() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.GET_COMMANDS, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    // Streaming operations\n    /**\n     * Check if the device is currently livestreaming\n     */\n    async isLivestreaming() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.IS_LIVESTREAMING, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Start livestreaming from the device\n     *\n     * @returns Promise resolving when livestream starts successfully\n     * @throws {Error} If device doesn't support livestreaming or command fails\n     *\n     * @example\n     * ```typescript\n     * await api.device(\"T8210N20123456789\").startLivestream();\n     * console.log('Livestream started');\n     * ```\n     */\n    async startLivestream() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.START_LIVESTREAM, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Stop livestreaming on the device\n     *\n     * @returns Promise resolving when livestream stops successfully\n     *\n     * @example\n     * ```typescript\n     * await api.device(\"T8210N20123456789\").stopLivestream();\n     * console.log('Livestream stopped');\n     * ```\n     */\n    async stopLivestream() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.STOP_LIVESTREAM, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    // RTSP streaming\n    /**\n     * Check if RTSP livestreaming is active\n     */\n    async isRtspLivestreaming() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.IS_RTSP_LIVESTREAMING, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Start RTSP livestreaming\n     */\n    async startRtspLivestream() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.START_RTSP_LIVESTREAM, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Stop RTSP livestreaming\n     */\n    async stopRtspLivestream() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.STOP_RTSP_LIVESTREAM, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    // Download operations\n    /**\n     * Check if the device is currently downloading\n     */\n    async isDownloading() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.IS_DOWNLOADING, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Start downloading with the device\n     */\n    async startDownload(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.START_DOWNLOAD, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Cancel an ongoing download\n     */\n    async cancelDownload() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.CANCEL_DOWNLOAD, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    // Control operations\n    /**\n     * Trigger the device alarm\n     */\n    async triggerAlarm(params) {\n        // Ensure 'seconds' is always a number (default to 0 if not provided)\n        const seconds = params && typeof params['seconds'] === 'number' ? params['seconds'] : 0;\n        return this.api.command(constants_1.DEVICE_COMMANDS.TRIGGER_ALARM, {\n            serialNumber: this.serialNumber,\n            seconds,\n            ...params,\n        });\n    }\n    /**\n     * Reset the device alarm\n     */\n    async resetAlarm() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.RESET_ALARM, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Pan and tilt the device camera\n     */\n    async panAndTilt(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.PAN_AND_TILT, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Calibrate the device\n     */\n    async calibrate() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.CALIBRATE, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    // Property operations with type safety\n    /**\n     * Set a property on the device\n     */\n    async setProperty(name, value) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_PROPERTY, {\n            serialNumber: this.serialNumber,\n            name,\n            value,\n        });\n    }\n    // Communication\n    /**\n     * Send a quick response from the device\n     */\n    async quickResponse(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.QUICK_RESPONSE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Get the list of voices supported by the device\n     */\n    async getVoices() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.GET_VOICES, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Start the talkback feature\n     */\n    async startTalkback() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.START_TALKBACK, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Stop the talkback feature\n     */\n    async stopTalkback() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.STOP_TALKBACK, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Check if a talkback session is ongoing\n     */\n    async isTalkbackOngoing() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.IS_TALKBACK_ONGOING, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    // Lock operations\n    /**\n     * Calibrate the lock mechanism\n     */\n    async calibrateLock() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.CALIBRATE_LOCK, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Unlock the device\n     */\n    async unlock() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.UNLOCK, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Snooze the device (temporary disable)\n     */\n    async snooze(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SNOOZE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    // User management\n    /**\n     * Add a new user to the device\n     */\n    async addUser(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.ADD_USER, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Delete a user from the device\n     */\n    async deleteUser(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.DELETE_USER, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Get the list of users configured on the device\n     */\n    async getUsers() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.GET_USERS, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Update user information\n     */\n    async updateUser(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.UPDATE_USER, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Update a user's passcode\n     */\n    async updateUserPasscode(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.UPDATE_USER_PASSCODE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Update a user's schedule\n     */\n    async updateUserSchedule(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.UPDATE_USER_SCHEDULE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Verify a user's PIN\n     */\n    async verifyPin(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.VERIFY_PIN, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    // Device control settings\n    /**\n     * Open the device (wake up from sleep)\n     */\n    async open() {\n        return this.api.command(constants_1.DEVICE_COMMANDS.OPEN, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Set the status LED behavior\n     */\n    async setStatusLed(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_STATUS_LED, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Configure auto night vision settings\n     */\n    async setAutoNightVision(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_AUTO_NIGHT_VISION, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Configure motion detection settings\n     */\n    async setMotionDetection(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_MOTION_DETECTION, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Configure sound detection settings\n     */\n    async setSoundDetection(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_SOUND_DETECTION, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Configure pet detection settings\n     */\n    async setPetDetection(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_PET_DETECTION, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Configure RTSP stream settings\n     */\n    async setRtspStream(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_RTSP_STREAM, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Configure anti-theft detection settings\n     */\n    async setAntiTheftDetection(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_ANTI_THEFT_DETECTION, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Configure watermark settings for the device\n     */\n    async setWatermark(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.SET_WATERMARK, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Enable or activate the device\n     */\n    async enableDevice(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.ENABLE_DEVICE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Lock the device (secure it)\n     */\n    async lockDevice(params) {\n        return this.api.command(constants_1.DEVICE_COMMANDS.LOCK_DEVICE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n}\nexports.DeviceCommandBuilder = DeviceCommandBuilder;\n/**\n * Station command builder with fluent interface\n */\nclass StationCommandBuilder {\n    constructor(serialNumber, api) {\n        this.serialNumber = serialNumber;\n        this.api = api;\n    }\n    /**\n     * Get station properties\n     */\n    async getProperties() {\n        return this.api.command(constants_2.STATION_COMMANDS.GET_PROPERTIES, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Get station properties metadata\n     */\n    async getPropertiesMetadata() {\n        return this.api.command(constants_2.STATION_COMMANDS.GET_PROPERTIES_METADATA, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Check if the station has a specific property\n     */\n    async hasProperty(propertyName) {\n        return this.api.command(constants_2.STATION_COMMANDS.HAS_PROPERTY, {\n            serialNumber: this.serialNumber,\n            propertyName,\n        });\n    }\n    /**\n     * Check if the station supports a specific command\n     */\n    async hasCommand(commandName) {\n        return this.api.command(constants_2.STATION_COMMANDS.HAS_COMMAND, {\n            serialNumber: this.serialNumber,\n            commandName,\n        });\n    }\n    /**\n     * Get a list of commands supported by the station\n     */\n    async getCommands() {\n        return this.api.command(constants_2.STATION_COMMANDS.GET_COMMANDS, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Check if the station is connected\n     */\n    async isConnected() {\n        return this.api.command(constants_2.STATION_COMMANDS.IS_CONNECTED, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Connect the station\n     */\n    async connect() {\n        return this.api.command(constants_2.STATION_COMMANDS.CONNECT, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Disconnect the station\n     */\n    async disconnect() {\n        return this.api.command(constants_2.STATION_COMMANDS.DISCONNECT, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Set a property on the station\n     */\n    async setProperty(name, value) {\n        return this.api.command(constants_2.STATION_COMMANDS.SET_PROPERTY, {\n            serialNumber: this.serialNumber,\n            name,\n            value,\n        });\n    }\n    /**\n     * Trigger the station alarm\n     */\n    async triggerAlarm(params) {\n        // Ensure 'seconds' is always a number (default to 0 if not provided)\n        const seconds = params && typeof params['seconds'] === 'number' ? params['seconds'] : 0;\n        return this.api.command(constants_2.STATION_COMMANDS.TRIGGER_ALARM, {\n            serialNumber: this.serialNumber,\n            seconds,\n            ...params,\n        });\n    }\n    /**\n     * Reset the station alarm\n     */\n    async resetAlarm() {\n        return this.api.command(constants_2.STATION_COMMANDS.RESET_ALARM, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Reboot the station\n     */\n    async reboot() {\n        return this.api.command(constants_2.STATION_COMMANDS.REBOOT, {\n            serialNumber: this.serialNumber,\n        });\n    }\n    /**\n     * Activate the station chime\n     */\n    async chime(params) {\n        return this.api.command(constants_2.STATION_COMMANDS.CHIME, {\n            ...params,\n        });\n    }\n    /**\n     * Download an image from the station\n     */\n    async downloadImage(params) {\n        return this.api.command(constants_2.STATION_COMMANDS.DOWNLOAD_IMAGE, {\n            ...params,\n        });\n    }\n    /**\n     * Query the latest information from the station's database\n     */\n    async databaseQueryLatestInfo(params) {\n        return this.api.command(constants_2.STATION_COMMANDS.DATABASE_QUERY_LATEST_INFO, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Query local data from the station's database\n     */\n    async databaseQueryLocal(params) {\n        return this.api.command(constants_2.STATION_COMMANDS.DATABASE_QUERY_LOCAL, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Count database entries by date\n     */\n    async databaseCountByDate(params) {\n        return this.api.command(constants_2.STATION_COMMANDS.DATABASE_COUNT_BY_DATE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n    /**\n     * Delete entries from the station's database\n     */\n    async databaseDelete(params) {\n        return this.api.command(constants_2.STATION_COMMANDS.DATABASE_DELETE, {\n            serialNumber: this.serialNumber,\n            ...params,\n        });\n    }\n}\nexports.StationCommandBuilder = StationCommandBuilder;\n/**\n * Driver command builder with fluent interface\n */\nclass DriverCommandBuilder {\n    constructor(api) {\n        this.api = api;\n    }\n    /**\n     * Connect the driver\n     */\n    async connect() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.CONNECT);\n    }\n    /**\n     * Disconnect the driver\n     */\n    async disconnect() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.DISCONNECT);\n    }\n    /**\n     * Check if the driver is connected\n     */\n    async isConnected() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.IS_CONNECTED);\n    }\n    /**\n     * Check if the push service is connected\n     */\n    async isPushConnected() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.IS_PUSH_CONNECTED);\n    }\n    /**\n     * Check if the MQTT service is connected\n     */\n    async isMqttConnected() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.IS_MQTT_CONNECTED);\n    }\n    /**\n     * Set the verification code for the driver\n     */\n    async setVerifyCode(params) {\n        return this.api.command(constants_3.DRIVER_COMMANDS.SET_VERIFY_CODE, params);\n    }\n    /**\n     * Set the captcha for the driver\n     */\n    async setCaptcha(params) {\n        return this.api.command(constants_3.DRIVER_COMMANDS.SET_CAPTCHA, params);\n    }\n    /**\n     * Refresh the poll data\n     */\n    async pollRefresh() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.POLL_REFRESH);\n    }\n    /**\n     * Get video event data\n     */\n    async getVideoEvents(params) {\n        return this.api.command(constants_3.DRIVER_COMMANDS.GET_VIDEO_EVENTS, params);\n    }\n    /**\n     * Get alarm event data\n     */\n    async getAlarmEvents(params) {\n        return this.api.command(constants_3.DRIVER_COMMANDS.GET_ALARM_EVENTS, params);\n    }\n    /**\n     * Get history event data\n     */\n    async getHistoryEvents(params) {\n        return this.api.command(constants_3.DRIVER_COMMANDS.GET_HISTORY_EVENTS, params);\n    }\n    /**\n     * Set the log level for the driver\n     */\n    async setLogLevel(params) {\n        return this.api.command(constants_3.DRIVER_COMMANDS.SET_LOG_LEVEL, params);\n    }\n    /**\n     * Get the current log level\n     */\n    async getLogLevel() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.GET_LOG_LEVEL);\n    }\n    /**\n     * Start listening to logs\n     */\n    async startListeningLogs() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.START_LISTENING_LOGS);\n    }\n    /**\n     * Stop listening to logs\n     */\n    async stopListeningLogs() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.STOP_LISTENING_LOGS);\n    }\n    /**\n     * Check if log listening is active\n     */\n    async isListeningLogs() {\n        return this.api.command(constants_3.DRIVER_COMMANDS.IS_LISTENING_LOGS);\n    }\n}\nexports.DriverCommandBuilder = DriverCommandBuilder;\n/**\n * Server command builder with fluent interface\n */\nclass ServerCommandBuilder {\n    constructor(api) {\n        this.api = api;\n    }\n    /**\n     * Start the server listening for connections\n     */\n    async startListening() {\n        return this.api.command(constants_4.SERVER_COMMANDS.START_LISTENING);\n    }\n    /**\n     * Set the API schema version for the server\n     */\n    async setApiSchema(schemaVersion) {\n        return this.api.command(constants_4.SERVER_COMMANDS.SET_API_SCHEMA, { schemaVersion });\n    }\n}\nexports.ServerCommandBuilder = ServerCommandBuilder;\n//# sourceMappingURL=api-manager-commands.js.map","\"use strict\";\n/**\n * Device command types and interfaces for Eufy devices\n *\n * Defines all command interfaces for device-level operations in the Eufy Security WebSocket API.\n * Includes property, streaming, alarm, camera control, and talkback commands.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=commands.js.map","\"use strict\";\n/**\n * Eufy WebSocket API Station Events\n *\n * Contains TypeScript interfaces for station-level event payloads in the Eufy Security WebSocket API.\n *\n * See: eufy-security-ws/docs/api_events.md for event schema details.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=events.js.map","module.exports = require(\"child_process\");","\"use strict\";\n/**\n * Eufy Stream Server - Simplified TCP streaming server for raw H.264 video\n *\n * This package provides a simple TCP streaming server specifically designed\n * for streaming raw H.264 video data from Eufy security cameras. It removes\n * all the complexity of audio processing, MP4 fragmentation, and advanced\n * error recovery from the original implementation.\n *\n * @example\n * ```typescript\n * import { StreamServer } from 'eufy-stream-server';\n *\n * const server = new StreamServer({\n *   port: 8080,\n *   debug: true\n * });\n *\n * await server.start();\n *\n * // Stream H.264 video data\n * server.streamVideo(h264Buffer, timestamp, isKeyFrame);\n * ```\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.H264Parser = exports.ConnectionManager = exports.StreamServer = void 0;\nvar stream_server_1 = require(\"./stream-server\");\nObject.defineProperty(exports, \"StreamServer\", { enumerable: true, get: function () { return stream_server_1.StreamServer; } });\nvar connection_manager_1 = require(\"./connection-manager\");\nObject.defineProperty(exports, \"ConnectionManager\", { enumerable: true, get: function () { return connection_manager_1.ConnectionManager; } });\nvar h264_parser_1 = require(\"./h264-parser\");\nObject.defineProperty(exports, \"H264Parser\", { enumerable: true, get: function () { return h264_parser_1.H264Parser; } });\n//# sourceMappingURL=index.js.map","\"use strict\";\n/**\n * Device module exports\n *\n * Provides all device-related constants, commands, events, and responses for the Eufy Security WebSocket Client.\n * This barrel file re-exports all device-related modules for easy import.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\ntslib_1.__exportStar(require(\"./constants\"), exports);\ntslib_1.__exportStar(require(\"./commands\"), exports);\ntslib_1.__exportStar(require(\"./events\"), exports);\ntslib_1.__exportStar(require(\"./properties\"), exports);\ntslib_1.__exportStar(require(\"./responses\"), exports);\n//# sourceMappingURL=index.js.map","'use strict';\n\nconst kDone = Symbol('kDone');\nconst kRun = Symbol('kRun');\n\n/**\n * A very simple job queue with adjustable concurrency. Adapted from\n * https://github.com/STRML/async-limiter\n */\nclass Limiter {\n  /**\n   * Creates a new `Limiter`.\n   *\n   * @param {Number} [concurrency=Infinity] The maximum number of jobs allowed\n   *     to run concurrently\n   */\n  constructor(concurrency) {\n    this[kDone] = () => {\n      this.pending--;\n      this[kRun]();\n    };\n    this.concurrency = concurrency || Infinity;\n    this.jobs = [];\n    this.pending = 0;\n  }\n\n  /**\n   * Adds a job to the queue.\n   *\n   * @param {Function} job The job to run\n   * @public\n   */\n  add(job) {\n    this.jobs.push(job);\n    this[kRun]();\n  }\n\n  /**\n   * Removes a job from the queue and runs it if possible.\n   *\n   * @private\n   */\n  [kRun]() {\n    if (this.pending === this.concurrency) return;\n\n    if (this.jobs.length) {\n      const job = this.jobs.shift();\n\n      this.pending++;\n      job(this[kDone]);\n    }\n  }\n}\n\nmodule.exports = Limiter;\n","\"use strict\";\n/**\n * Common response types used across all command sources in the Eufy WebSocket API\n *\n * Defines standard success, error, and base response types for device, station, driver, and server operations.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=responses.js.map","\"use strict\";\n/**\n * Eufy Security Client - High-level client interface for CLI usage\n *\n * This class provides a simplified interface for CLI applications to interact\n * with the Eufy Security WebSocket API. It wraps the ApiManager and provides\n * methods that match the expected CLI interface.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.EufySecurityClient = void 0;\nconst api_manager_1 = require(\"./api-manager\");\nconst constants_1 = require(\"./device/constants\");\nconst device_detection_1 = require(\"./utils/device-detection\");\nconst tslog_1 = require(\"tslog\");\nconst events_1 = require(\"events\");\n/**\n * High-level Eufy Security Client for CLI applications\n */\nclass EufySecurityClient extends events_1.EventEmitter {\n    /**\n     * Creates a new EufySecurityClient instance\n     *\n     * @param config - Configuration object containing WebSocket URL and optional logger\n     *\n     * @example\n     * ```typescript\n     * const client = new EufySecurityClient({\n     *   wsUrl: \"ws://localhost:3000\"\n     * });\n     *\n     * // With custom logger\n     * const client = new EufySecurityClient({\n     *   wsUrl: \"ws://localhost:3000\",\n     *   logger: customLogger\n     * });\n     * ```\n     */\n    constructor(config) {\n        super();\n        this.devices = new Map();\n        this.isConnectedFlag = false;\n        this.eventListenerCleanup = [];\n        // Use external logger if provided, otherwise create internal tslog logger\n        this.logger =\n            config.logger ??\n                new tslog_1.Logger({\n                    name: \"EufySecurityClient\",\n                    minLevel: 3, // Info level\n                });\n        // Create the API manager\n        this.apiManager = new api_manager_1.ApiManager(config.wsUrl, this.logger);\n        // Set up event handlers\n        this.setupEventHandlers();\n    }\n    /**\n     * Wait for the client to be ready (schema negotiation complete)\n     *\n     * @private\n     * @param timeoutMs - Maximum time to wait in milliseconds (default: 10000)\n     * @throws {Error} When timeout is reached before client becomes ready\n     */\n    async waitForReady(timeoutMs = 10000) {\n        const startTime = Date.now();\n        while (!this.apiManager.isConnected()) {\n            if (Date.now() - startTime > timeoutMs) {\n                throw new Error(\"Timeout waiting for client to be ready\");\n            }\n            // Wait 100ms before checking again\n            await new Promise((resolve) => setTimeout(resolve, 100));\n        }\n    }\n    /**\n     * Connect to the WebSocket server and initialize the client\n     *\n     * Establishes WebSocket connection, performs schema negotiation, connects to the driver,\n     * starts listening for events, and loads available devices.\n     *\n     * @throws {Error} If connection, schema negotiation, or driver connection fails\n     *\n     * @example\n     * ```typescript\n     * await client.connect();\n     * console.log('Client connected and ready');\n     * ```\n     */\n    async connect() {\n        try {\n            // Connect to WebSocket\n            await this.apiManager.connect();\n            // Wait for client to be ready (schema negotiation complete)\n            await this.waitForReady();\n            // Connect to driver\n            await this.apiManager.connectDriver();\n            // Start listening for events\n            await this.apiManager.startListening();\n            // Load devices\n            await this.loadDevices();\n            this.isConnectedFlag = true;\n        }\n        catch (error) {\n            this.logger.error(\"Failed to connect:\", error);\n            throw error;\n        }\n    }\n    /**\n     * Disconnect from the WebSocket server and cleanup resources\n     *\n     * Gracefully closes the WebSocket connection, removes all event listeners,\n     * clears device cache, and resets internal state to prevent memory leaks.\n     *\n     * @example\n     * ```typescript\n     * await client.disconnect();\n     * console.log('Client disconnected and cleaned up');\n     * ```\n     */\n    async disconnect() {\n        this.isConnectedFlag = false;\n        // Clean up all API manager event listeners\n        this.logger.debug(`Cleaning up ${this.eventListenerCleanup.length} event listeners`);\n        this.eventListenerCleanup.forEach((cleanup) => {\n            try {\n                cleanup();\n            }\n            catch (error) {\n                this.logger.warn(\"Error during event listener cleanup:\", error);\n            }\n        });\n        this.eventListenerCleanup = [];\n        // Remove all EventEmitter listeners (streamData, streamStarted, etc.)\n        this.removeAllListeners();\n        // Clear device cache\n        this.devices.clear();\n        // Disconnect from API manager\n        this.apiManager.disconnect();\n        this.logger.info(\"Client disconnected and all resources cleaned up\");\n    }\n    /**\n     * Check if client is connected and ready for operations\n     *\n     * @returns true if WebSocket is connected and client is ready for API calls\n     *\n     * @example\n     * ```typescript\n     * if (client.isConnected()) {\n     *   const devices = await client.getDevices();\n     * }\n     * ```\n     */\n    isConnected() {\n        return this.isConnectedFlag && this.apiManager.isConnected();\n    }\n    /**\n     * Connect to the Eufy driver\n     *\n     * Establishes connection to the Eufy cloud driver. This is called automatically\n     * by connect(), but can be called separately for more granular control.\n     *\n     * @throws {Error} If client not ready or driver connection fails\n     *\n     * @example\n     * ```typescript\n     * await client.connectDriver();\n     * console.log('Driver connected');\n     * ```\n     */\n    async connectDriver() {\n        if (!this.apiManager.isConnected()) {\n            throw new Error(\"Client not connected. Call connect() first.\");\n        }\n        await this.apiManager.connectDriver();\n    }\n    /**\n     * Get all available devices from the connected Eufy account\n     *\n     * @returns Promise resolving to array of device information objects\n     * @throws {Error} If client is not connected\n     *\n     * @example\n     * ```typescript\n     * const devices = await client.getDevices();\n     * devices.forEach(device => {\n     *   console.log(`Device: ${device.name} (${device.serialNumber})`);\n     * });\n     * ```\n     */\n    async getDevices() {\n        if (!this.isConnected()) {\n            throw new Error(\"Client not connected. Call connect() first.\");\n        }\n        return Array.from(this.devices.values());\n    }\n    /**\n     * Start live streaming from a specific device\n     *\n     * @param deviceSerial - Serial number of the device to start streaming from\n     * @throws {Error} If client is not connected or device is not found\n     *\n     * @example\n     * ```typescript\n     * await client.startStream(\"T8210N20123456789\");\n     *\n     * // Listen for stream data\n     * client.on('streamData', (data) => {\n     *   console.log(`Received ${data.type} data: ${data.buffer.length} bytes`);\n     * });\n     * ```\n     */\n    async startStream(deviceSerial) {\n        if (!this.isConnected()) {\n            throw new Error(\"Client not connected. Call connect() first.\");\n        }\n        const device = this.devices.get(deviceSerial);\n        if (!device) {\n            throw new Error(`Device not found: ${deviceSerial}`);\n        }\n        try {\n            const deviceCommand = this.apiManager.commands.device(deviceSerial);\n            await deviceCommand.startLivestream();\n            this.logger.info(`Started stream for device: ${deviceSerial}`);\n        }\n        catch (error) {\n            this.logger.error(`Failed to start stream for device ${deviceSerial}:`, error);\n            throw error;\n        }\n    }\n    /**\n     * Stop live streaming from a specific device\n     *\n     * @param deviceSerial - Serial number of the device to stop streaming from\n     * @throws {Error} If client is not connected or device is not found\n     *\n     * @example\n     * ```typescript\n     * await client.stopStream(\"T8210N20123456789\");\n     * console.log('Streaming stopped');\n     * ```\n     */\n    async stopStream(deviceSerial) {\n        if (!this.isConnected()) {\n            throw new Error(\"Client not connected. Call connect() first.\");\n        }\n        const device = this.devices.get(deviceSerial);\n        if (!device) {\n            throw new Error(`Device not found: ${deviceSerial}`);\n        }\n        try {\n            // First check if device is actually streaming\n            const deviceCommand = this.apiManager.commands.device(deviceSerial);\n            const streamingStatus = await deviceCommand.isLivestreaming();\n            if (!streamingStatus.livestreaming) {\n                this.logger.debug(`Device ${deviceSerial} is not currently streaming`);\n                return;\n            }\n            // Only stop if actually streaming\n            await deviceCommand.stopLivestream();\n            this.logger.info(`Stopped stream for device: ${deviceSerial}`);\n        }\n        catch (error) {\n            this.logger.error(`Failed to stop stream for device ${deviceSerial}:`, error);\n            throw error;\n        }\n    }\n    /**\n     * Get pending CAPTCHA information\n     *\n     * Returns CAPTCHA information from the last CAPTCHA request event.\n     * This is used by the CLI to display CAPTCHA information to the user.\n     *\n     * @returns CAPTCHA information or null if no CAPTCHA is pending\n     */\n    getPendingCaptcha() {\n        return this.apiManager.getPendingCaptcha();\n    }\n    /**\n     * Clear pending CAPTCHA information\n     *\n     * Clears any stored CAPTCHA information after it has been used.\n     */\n    clearPendingCaptcha() {\n        this.apiManager.clearPendingCaptcha();\n    }\n    /**\n     * Get pending MFA information\n     *\n     * Returns MFA information from the last MFA request event.\n     * This is used by the CLI to display MFA information to the user.\n     *\n     * @returns MFA information or null if no MFA is pending\n     */\n    getPendingMfa() {\n        return this.apiManager.getPendingMfa();\n    }\n    /**\n     * Clear pending MFA information\n     *\n     * Clears any stored MFA information after it has been used.\n     */\n    clearPendingMfa() {\n        this.apiManager.clearPendingMfa();\n    }\n    /**\n     * Enhanced command API with more elegant fluent interface\n     */\n    get commands() {\n        return this.apiManager.commands;\n    }\n    // Private methods\n    /**\n     * Set up event handlers for API manager events\n     *\n     * Configures listeners for device events, stream events, and data events.\n     * Transforms API manager events into client-friendly events.\n     * Stores cleanup functions for proper resource management.\n     *\n     * @private\n     */\n    setupEventHandlers() {\n        // Listen for device events to populate device list\n        this.eventListenerCleanup.push(this.apiManager.addEventListener(\"device added\", (event) => {\n            this.addDevice(event);\n        }));\n        this.eventListenerCleanup.push(this.apiManager.addEventListener(\"device removed\", (event) => {\n            // The event structure may vary, so we'll handle it safely\n            const serialNumber = event.serialNumber || event.device?.serialNumber;\n            if (serialNumber) {\n                this.removeDevice(serialNumber);\n            }\n        }));\n        // Forward stream events\n        this.eventListenerCleanup.push(this.apiManager.addEventListener(\"livestream started\", (event) => {\n            this.logger.info(\" Livestream started event received:\", event);\n            // Emit as streamStarted for compatibility\n            super.emit(\"streamStarted\", event);\n        }));\n        this.eventListenerCleanup.push(this.apiManager.addEventListener(\"livestream stopped\", (event) => {\n            this.logger.info(\" Livestream stopped event received:\", event);\n            // Emit as streamStopped for compatibility\n            super.emit(\"streamStopped\", event);\n        }));\n        this.eventListenerCleanup.push(this.apiManager.addEventListener(constants_1.DEVICE_EVENTS.LIVESTREAM_VIDEO_DATA, (event) => {\n            const bufferSize = event.buffer?.data?.length || 0;\n            this.logger.debug(` Video data received: ${bufferSize} bytes from device ${event.serialNumber}`);\n            // Convert JSONBuffer to Buffer for compatibility\n            const buffer = event.buffer\n                ? Buffer.from(event.buffer.data)\n                : Buffer.alloc(0);\n            // Emit as streamData for compatibility, including video metadata\n            super.emit(\"streamData\", {\n                type: \"video\",\n                buffer: buffer,\n                deviceSerial: event.serialNumber,\n                metadata: event.metadata, // Pass through video metadata with dimensions\n            });\n        }));\n        this.eventListenerCleanup.push(this.apiManager.addEventListener(constants_1.DEVICE_EVENTS.LIVESTREAM_AUDIO_DATA, (event) => {\n            const bufferSize = event.buffer?.data?.length || 0;\n            this.logger.debug(` Audio data received: ${bufferSize} bytes from device ${event.serialNumber}`);\n            // Convert JSONBuffer to Buffer for compatibility\n            const buffer = event.buffer\n                ? Buffer.from(event.buffer.data)\n                : Buffer.alloc(0);\n            // Emit as streamData for compatibility\n            super.emit(\"streamData\", {\n                type: \"audio\",\n                buffer: buffer,\n                deviceSerial: event.serialNumber,\n            });\n        }));\n    }\n    /**\n     * Load and cache device information from the server\n     *\n     * Retrieves device list from server response and fetches detailed properties\n     * for each device. Handles errors gracefully by adding devices with minimal info.\n     *\n     * @private\n     * @throws {Error} If server communication fails\n     */\n    async loadDevices() {\n        try {\n            // Get the start_listening response which should contain device list\n            const startListeningResult = await this.apiManager.commands\n                .server()\n                .startListening();\n            this.logger.info(\"Start listening result:\", JSON.stringify(startListeningResult, null, 2));\n            if (startListeningResult?.state?.devices) {\n                const deviceSerials = startListeningResult.state.devices;\n                this.logger.info(`Found ${deviceSerials.length} device(s):`, deviceSerials);\n                // For each device serial, get the device properties\n                for (const serialNumber of deviceSerials) {\n                    try {\n                        const deviceCommand = this.apiManager.commands.device(serialNumber);\n                        const deviceProps = await deviceCommand.getProperties();\n                        // Log only the keys to avoid massive binary data output\n                        this.logger.info(`Device ${serialNumber} property keys:`, Object.keys(deviceProps || {}));\n                        if (deviceProps?.properties) {\n                            this.logger.info(`Device ${serialNumber} nested property keys:`, Object.keys(deviceProps.properties).slice(0, 20) // Show first 20 keys\n                            );\n                        }\n                        // Extract properties from the nested structure\n                        const props = deviceProps?.properties || {};\n                        // Create device info from properties\n                        const deviceInfo = {\n                            name: props?.name ||\n                                props?.deviceName ||\n                                `Device ${serialNumber}`,\n                            serialNumber: serialNumber,\n                            type: this.getDeviceTypeName(props?.type || props?.deviceType || 0),\n                            stationSerial: props?.stationSerial ||\n                                props?.station_sn ||\n                                \"\",\n                            model: props?.model ||\n                                props?.deviceModel ||\n                                \"Unknown\",\n                            hardwareVersion: props?.hardwareVersion ||\n                                props?.main_hw_version ||\n                                \"Unknown\",\n                            softwareVersion: props?.softwareVersion ||\n                                props?.main_sw_version ||\n                                \"Unknown\",\n                        };\n                        this.devices.set(serialNumber, deviceInfo);\n                        this.logger.info(`Added device: ${deviceInfo.name} (${deviceInfo.serialNumber})`);\n                    }\n                    catch (deviceError) {\n                        this.logger.warn(`Failed to get properties for device ${serialNumber}:`, deviceError);\n                        // Add device with minimal info\n                        const device = {\n                            name: `Device ${serialNumber}`,\n                            serialNumber: serialNumber,\n                            type: \"Unknown\",\n                            stationSerial: \"\",\n                            model: \"Unknown\",\n                            hardwareVersion: \"Unknown\",\n                            softwareVersion: \"Unknown\",\n                        };\n                        this.devices.set(serialNumber, device);\n                        this.logger.info(`Added device with minimal info: ${device.name} (${device.serialNumber})`);\n                    }\n                }\n            }\n            else {\n                this.logger.warn(\"No devices found in start_listening response\");\n            }\n            this.logger.info(`Device loading completed. Total devices: ${this.devices.size}`);\n        }\n        catch (error) {\n            this.logger.error(\"Failed to load devices:\", error);\n            throw error;\n        }\n    }\n    /**\n     * Add a device to the internal device cache\n     *\n     * @private\n     * @param deviceData - Device data from server event\n     */\n    addDevice(deviceData) {\n        const device = {\n            name: deviceData.name || \"Unknown Device\",\n            serialNumber: deviceData.serialNumber,\n            type: this.getDeviceTypeName(deviceData.type),\n            stationSerial: deviceData.stationSerial,\n            model: deviceData.model,\n            hardwareVersion: deviceData.hardwareVersion,\n            softwareVersion: deviceData.softwareVersion,\n        };\n        this.devices.set(device.serialNumber, device);\n        this.logger.debug(`Added device: ${device.name} (${device.serialNumber})`);\n    }\n    /**\n     * Remove a device from the internal device cache\n     *\n     * @private\n     * @param serialNumber - Serial number of device to remove\n     */\n    removeDevice(serialNumber) {\n        if (this.devices.has(serialNumber)) {\n            const device = this.devices.get(serialNumber);\n            this.devices.delete(serialNumber);\n            this.logger.debug(`Removed device: ${device?.name} (${serialNumber})`);\n        }\n    }\n    /**\n     * Convert device type number to human-readable name\n     *\n     * @private\n     * @param type - Numeric device type from server\n     * @returns Human-readable device type name\n     */\n    getDeviceTypeName(type) {\n        return (0, device_detection_1.getDeviceTypeName)(type);\n    }\n}\nexports.EufySecurityClient = EufySecurityClient;\n//# sourceMappingURL=eufy-security-client.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.splitStackLines = splitStackLines;\nexports.sanitizeStackLines = sanitizeStackLines;\nexports.toStackFrames = toStackFrames;\nexports.findFirstExternalFrameIndex = findFirstExternalFrameIndex;\nexports.getFrameAt = getFrameAt;\nexports.getCleanStackLines = getCleanStackLines;\nexports.buildStackTrace = buildStackTrace;\nexports.isIgnorableFrame = isIgnorableFrame;\nexports.clampIndex = clampIndex;\nexports.pickCallerStackFrame = pickCallerStackFrame;\nexports.getDefaultIgnorePatterns = getDefaultIgnorePatterns;\nconst DEFAULT_IGNORE_PATTERNS = [\n    /(?:^|[\\\\/])node_modules[\\\\/].*tslog/i,\n    /(?:^|[\\\\/])deps[\\\\/].*tslog/i,\n    /tslog[\\\\/]+src[\\\\/]+internal[\\\\/]/i,\n    /tslog[\\\\/]+src[\\\\/]BaseLogger/i,\n    /tslog[\\\\/]+src[\\\\/]index/i,\n];\nfunction splitStackLines(error) {\n    const stack = typeof error?.stack === \"string\" ? error.stack : undefined;\n    if (stack == null || stack.length === 0) {\n        return [];\n    }\n    return stack.split(\"\\n\").map((line) => line.trimEnd());\n}\nfunction sanitizeStackLines(lines) {\n    return lines.filter((line) => line.length > 0 && !/^\\s*Error\\b/.test(line));\n}\nfunction toStackFrames(lines, parseLine) {\n    const frames = [];\n    for (const line of lines) {\n        const frame = parseLine(line);\n        if (frame != null) {\n            frames.push(frame);\n        }\n    }\n    return frames;\n}\nfunction findFirstExternalFrameIndex(frames, ignorePatterns = DEFAULT_IGNORE_PATTERNS) {\n    for (let index = 0; index < frames.length; index += 1) {\n        const frame = frames[index];\n        const filePathCandidate = frame.filePath ?? \"\";\n        const fullPathCandidate = frame.fullFilePath ?? \"\";\n        if (!ignorePatterns.some((pattern) => pattern.test(filePathCandidate) || pattern.test(fullPathCandidate))) {\n            return index;\n        }\n    }\n    return 0;\n}\nfunction getFrameAt(frames, index) {\n    if (index < 0 || index >= frames.length) {\n        return undefined;\n    }\n    return frames[index];\n}\nfunction getCleanStackLines(error) {\n    return sanitizeStackLines(splitStackLines(error));\n}\nfunction buildStackTrace(error, parseLine) {\n    return toStackFrames(getCleanStackLines(error), parseLine);\n}\nfunction isIgnorableFrame(frame, ignorePatterns) {\n    const filePathCandidate = frame.filePath ?? \"\";\n    const fullPathCandidate = frame.fullFilePath ?? \"\";\n    return ignorePatterns.some((pattern) => pattern.test(filePathCandidate) || pattern.test(fullPathCandidate));\n}\nfunction clampIndex(index, maxExclusive) {\n    if (index < 0) {\n        return 0;\n    }\n    if (index >= maxExclusive) {\n        return Math.max(0, maxExclusive - 1);\n    }\n    return index;\n}\nfunction pickCallerStackFrame(error, parseLine, options = {}) {\n    const lines = getCleanStackLines(error);\n    const frames = toStackFrames(lines, parseLine);\n    if (frames.length === 0) {\n        return undefined;\n    }\n    const ignorePatterns = options.ignorePatterns ?? DEFAULT_IGNORE_PATTERNS;\n    const autoIndex = findFirstExternalFrameIndex(frames, ignorePatterns);\n    const resolvedIndex = options.stackDepthLevel != null ? options.stackDepthLevel : autoIndex;\n    return getFrameAt(frames, clampIndex(resolvedIndex, frames.length));\n}\nfunction getDefaultIgnorePatterns() {\n    return [...DEFAULT_IGNORE_PATTERNS];\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.SERVER_EVENTS = exports.SERVER_COMMANDS = void 0;\n/**\n * Server level command constants for Eufy WebSocket API\n *\n * Contains all server command string constants and enums for server operations and events.\n */\nexports.SERVER_COMMANDS = {\n    START_LISTENING: \"start_listening\",\n    SET_API_SCHEMA: \"set_api_schema\",\n};\n/**\n * Server event constants\n */\nexports.SERVER_EVENTS = {\n    SHUTDOWN: \"shutdown\",\n};\n//# sourceMappingURL=constants.js.map","/******************************************************************************\nCopyright (c) Microsoft Corporation.\n\nPermission to use, copy, modify, and/or distribute this software for any\npurpose with or without fee is hereby granted.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\nPERFORMANCE OF THIS SOFTWARE.\n***************************************************************************** */\n/* global Reflect, Promise, SuppressedError, Symbol, Iterator */\n\nvar extendStatics = function(d, b) {\n  extendStatics = Object.setPrototypeOf ||\n      ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n      function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n  return extendStatics(d, b);\n};\n\nexport function __extends(d, b) {\n  if (typeof b !== \"function\" && b !== null)\n      throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n  extendStatics(d, b);\n  function __() { this.constructor = d; }\n  d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n}\n\nexport var __assign = function() {\n  __assign = Object.assign || function __assign(t) {\n      for (var s, i = 1, n = arguments.length; i < n; i++) {\n          s = arguments[i];\n          for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n      }\n      return t;\n  }\n  return __assign.apply(this, arguments);\n}\n\nexport function __rest(s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n      t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n      for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n          if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n              t[p[i]] = s[p[i]];\n      }\n  return t;\n}\n\nexport function __decorate(decorators, target, key, desc) {\n  var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n  if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n  else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n  return c > 3 && r && Object.defineProperty(target, key, r), r;\n}\n\nexport function __param(paramIndex, decorator) {\n  return function (target, key) { decorator(target, key, paramIndex); }\n}\n\nexport function __esDecorate(ctor, descriptorIn, decorators, contextIn, initializers, extraInitializers) {\n  function accept(f) { if (f !== void 0 && typeof f !== \"function\") throw new TypeError(\"Function expected\"); return f; }\n  var kind = contextIn.kind, key = kind === \"getter\" ? \"get\" : kind === \"setter\" ? \"set\" : \"value\";\n  var target = !descriptorIn && ctor ? contextIn[\"static\"] ? ctor : ctor.prototype : null;\n  var descriptor = descriptorIn || (target ? Object.getOwnPropertyDescriptor(target, contextIn.name) : {});\n  var _, done = false;\n  for (var i = decorators.length - 1; i >= 0; i--) {\n      var context = {};\n      for (var p in contextIn) context[p] = p === \"access\" ? {} : contextIn[p];\n      for (var p in contextIn.access) context.access[p] = contextIn.access[p];\n      context.addInitializer = function (f) { if (done) throw new TypeError(\"Cannot add initializers after decoration has completed\"); extraInitializers.push(accept(f || null)); };\n      var result = (0, decorators[i])(kind === \"accessor\" ? { get: descriptor.get, set: descriptor.set } : descriptor[key], context);\n      if (kind === \"accessor\") {\n          if (result === void 0) continue;\n          if (result === null || typeof result !== \"object\") throw new TypeError(\"Object expected\");\n          if (_ = accept(result.get)) descriptor.get = _;\n          if (_ = accept(result.set)) descriptor.set = _;\n          if (_ = accept(result.init)) initializers.unshift(_);\n      }\n      else if (_ = accept(result)) {\n          if (kind === \"field\") initializers.unshift(_);\n          else descriptor[key] = _;\n      }\n  }\n  if (target) Object.defineProperty(target, contextIn.name, descriptor);\n  done = true;\n};\n\nexport function __runInitializers(thisArg, initializers, value) {\n  var useValue = arguments.length > 2;\n  for (var i = 0; i < initializers.length; i++) {\n      value = useValue ? initializers[i].call(thisArg, value) : initializers[i].call(thisArg);\n  }\n  return useValue ? value : void 0;\n};\n\nexport function __propKey(x) {\n  return typeof x === \"symbol\" ? x : \"\".concat(x);\n};\n\nexport function __setFunctionName(f, name, prefix) {\n  if (typeof name === \"symbol\") name = name.description ? \"[\".concat(name.description, \"]\") : \"\";\n  return Object.defineProperty(f, \"name\", { configurable: true, value: prefix ? \"\".concat(prefix, \" \", name) : name });\n};\n\nexport function __metadata(metadataKey, metadataValue) {\n  if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\n}\n\nexport function __awaiter(thisArg, _arguments, P, generator) {\n  function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n  return new (P || (P = Promise))(function (resolve, reject) {\n      function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n      function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n      function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n      step((generator = generator.apply(thisArg, _arguments || [])).next());\n  });\n}\n\nexport function __generator(thisArg, body) {\n  var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g = Object.create((typeof Iterator === \"function\" ? Iterator : Object).prototype);\n  return g.next = verb(0), g[\"throw\"] = verb(1), g[\"return\"] = verb(2), typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n  function verb(n) { return function (v) { return step([n, v]); }; }\n  function step(op) {\n      if (f) throw new TypeError(\"Generator is already executing.\");\n      while (g && (g = 0, op[0] && (_ = 0)), _) try {\n          if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n          if (y = 0, t) op = [op[0] & 2, t.value];\n          switch (op[0]) {\n              case 0: case 1: t = op; break;\n              case 4: _.label++; return { value: op[1], done: false };\n              case 5: _.label++; y = op[1]; op = [0]; continue;\n              case 7: op = _.ops.pop(); _.trys.pop(); continue;\n              default:\n                  if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                  if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                  if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                  if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                  if (t[2]) _.ops.pop();\n                  _.trys.pop(); continue;\n          }\n          op = body.call(thisArg, _);\n      } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n      if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n  }\n}\n\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  var desc = Object.getOwnPropertyDescriptor(m, k);\n  if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n  }\n  Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nexport function __exportStar(m, o) {\n  for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\n}\n\nexport function __values(o) {\n  var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\n  if (m) return m.call(o);\n  if (o && typeof o.length === \"number\") return {\n      next: function () {\n          if (o && i >= o.length) o = void 0;\n          return { value: o && o[i++], done: !o };\n      }\n  };\n  throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\n}\n\nexport function __read(o, n) {\n  var m = typeof Symbol === \"function\" && o[Symbol.iterator];\n  if (!m) return o;\n  var i = m.call(o), r, ar = [], e;\n  try {\n      while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\n  }\n  catch (error) { e = { error: error }; }\n  finally {\n      try {\n          if (r && !r.done && (m = i[\"return\"])) m.call(i);\n      }\n      finally { if (e) throw e.error; }\n  }\n  return ar;\n}\n\n/** @deprecated */\nexport function __spread() {\n  for (var ar = [], i = 0; i < arguments.length; i++)\n      ar = ar.concat(__read(arguments[i]));\n  return ar;\n}\n\n/** @deprecated */\nexport function __spreadArrays() {\n  for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\n  for (var r = Array(s), k = 0, i = 0; i < il; i++)\n      for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\n          r[k] = a[j];\n  return r;\n}\n\nexport function __spreadArray(to, from, pack) {\n  if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n      if (ar || !(i in from)) {\n          if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n          ar[i] = from[i];\n      }\n  }\n  return to.concat(ar || Array.prototype.slice.call(from));\n}\n\nexport function __await(v) {\n  return this instanceof __await ? (this.v = v, this) : new __await(v);\n}\n\nexport function __asyncGenerator(thisArg, _arguments, generator) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var g = generator.apply(thisArg, _arguments || []), i, q = [];\n  return i = Object.create((typeof AsyncIterator === \"function\" ? AsyncIterator : Object).prototype), verb(\"next\"), verb(\"throw\"), verb(\"return\", awaitReturn), i[Symbol.asyncIterator] = function () { return this; }, i;\n  function awaitReturn(f) { return function (v) { return Promise.resolve(v).then(f, reject); }; }\n  function verb(n, f) { if (g[n]) { i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; if (f) i[n] = f(i[n]); } }\n  function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\n  function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\n  function fulfill(value) { resume(\"next\", value); }\n  function reject(value) { resume(\"throw\", value); }\n  function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\n}\n\nexport function __asyncDelegator(o) {\n  var i, p;\n  return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\n  function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: false } : f ? f(v) : v; } : f; }\n}\n\nexport function __asyncValues(o) {\n  if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\n  var m = o[Symbol.asyncIterator], i;\n  return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\n  function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\n  function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\n}\n\nexport function __makeTemplateObject(cooked, raw) {\n  if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\n  return cooked;\n};\n\nvar __setModuleDefault = Object.create ? (function(o, v) {\n  Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n  o[\"default\"] = v;\n};\n\nvar ownKeys = function(o) {\n  ownKeys = Object.getOwnPropertyNames || function (o) {\n    var ar = [];\n    for (var k in o) if (Object.prototype.hasOwnProperty.call(o, k)) ar[ar.length] = k;\n    return ar;\n  };\n  return ownKeys(o);\n};\n\nexport function __importStar(mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k = ownKeys(mod), i = 0; i < k.length; i++) if (k[i] !== \"default\") __createBinding(result, mod, k[i]);\n  __setModuleDefault(result, mod);\n  return result;\n}\n\nexport function __importDefault(mod) {\n  return (mod && mod.__esModule) ? mod : { default: mod };\n}\n\nexport function __classPrivateFieldGet(receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n}\n\nexport function __classPrivateFieldSet(receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n}\n\nexport function __classPrivateFieldIn(state, receiver) {\n  if (receiver === null || (typeof receiver !== \"object\" && typeof receiver !== \"function\")) throw new TypeError(\"Cannot use 'in' operator on non-object\");\n  return typeof state === \"function\" ? receiver === state : state.has(receiver);\n}\n\nexport function __addDisposableResource(env, value, async) {\n  if (value !== null && value !== void 0) {\n    if (typeof value !== \"object\" && typeof value !== \"function\") throw new TypeError(\"Object expected.\");\n    var dispose, inner;\n    if (async) {\n      if (!Symbol.asyncDispose) throw new TypeError(\"Symbol.asyncDispose is not defined.\");\n      dispose = value[Symbol.asyncDispose];\n    }\n    if (dispose === void 0) {\n      if (!Symbol.dispose) throw new TypeError(\"Symbol.dispose is not defined.\");\n      dispose = value[Symbol.dispose];\n      if (async) inner = dispose;\n    }\n    if (typeof dispose !== \"function\") throw new TypeError(\"Object not disposable.\");\n    if (inner) dispose = function() { try { inner.call(this); } catch (e) { return Promise.reject(e); } };\n    env.stack.push({ value: value, dispose: dispose, async: async });\n  }\n  else if (async) {\n    env.stack.push({ async: true });\n  }\n  return value;\n}\n\nvar _SuppressedError = typeof SuppressedError === \"function\" ? SuppressedError : function (error, suppressed, message) {\n  var e = new Error(message);\n  return e.name = \"SuppressedError\", e.error = error, e.suppressed = suppressed, e;\n};\n\nexport function __disposeResources(env) {\n  function fail(e) {\n    env.error = env.hasError ? new _SuppressedError(e, env.error, \"An error was suppressed during disposal.\") : e;\n    env.hasError = true;\n  }\n  var r, s = 0;\n  function next() {\n    while (r = env.stack.pop()) {\n      try {\n        if (!r.async && s === 1) return s = 0, env.stack.push(r), Promise.resolve().then(next);\n        if (r.dispose) {\n          var result = r.dispose.call(r.value);\n          if (r.async) return s |= 2, Promise.resolve(result).then(next, function(e) { fail(e); return next(); });\n        }\n        else s |= 1;\n      }\n      catch (e) {\n        fail(e);\n      }\n    }\n    if (s === 1) return env.hasError ? Promise.reject(env.error) : Promise.resolve();\n    if (env.hasError) throw env.error;\n  }\n  return next();\n}\n\nexport function __rewriteRelativeImportExtension(path, preserveJsx) {\n  if (typeof path === \"string\" && /^\\.\\.?\\//.test(path)) {\n      return path.replace(/\\.(tsx)$|((?:\\.d)?)((?:\\.[^./]+?)?)\\.([cm]?)ts$/i, function (m, tsx, d, ext, cm) {\n          return tsx ? preserveJsx ? \".jsx\" : \".js\" : d && (!ext || !cm) ? m : (d + ext + \".\" + cm.toLowerCase() + \"js\");\n      });\n  }\n  return path;\n}\n\nexport default {\n  __extends,\n  __assign,\n  __rest,\n  __decorate,\n  __param,\n  __esDecorate,\n  __runInitializers,\n  __propKey,\n  __setFunctionName,\n  __metadata,\n  __awaiter,\n  __generator,\n  __createBinding,\n  __exportStar,\n  __values,\n  __read,\n  __spread,\n  __spreadArrays,\n  __spreadArray,\n  __await,\n  __asyncGenerator,\n  __asyncDelegator,\n  __asyncValues,\n  __makeTemplateObject,\n  __importStar,\n  __importDefault,\n  __classPrivateFieldGet,\n  __classPrivateFieldSet,\n  __classPrivateFieldIn,\n  __addDisposableResource,\n  __disposeResources,\n  __rewriteRelativeImportExtension,\n};\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.StorageType = exports.DRIVER_EVENTS = exports.DRIVER_COMMANDS = void 0;\n/**\n * Driver level command constants for Eufy WebSocket API\n *\n * Contains all driver command string constants and enums for driver operations and events.\n */\nexports.DRIVER_COMMANDS = {\n    SET_VERIFY_CODE: \"driver.set_verify_code\",\n    SET_CAPTCHA: \"driver.set_captcha\",\n    POLL_REFRESH: \"driver.poll_refresh\",\n    IS_CONNECTED: \"driver.is_connected\",\n    IS_PUSH_CONNECTED: \"driver.is_push_connected\",\n    CONNECT: \"driver.connect\",\n    DISCONNECT: \"driver.disconnect\",\n    GET_VIDEO_EVENTS: \"driver.get_video_events\",\n    GET_ALARM_EVENTS: \"driver.get_alarm_events\",\n    GET_HISTORY_EVENTS: \"driver.get_history_events\",\n    IS_MQTT_CONNECTED: \"driver.is_mqtt_connected\",\n    SET_LOG_LEVEL: \"driver.set_log_level\",\n    GET_LOG_LEVEL: \"driver.get_log_level\",\n    START_LISTENING_LOGS: \"driver.start_listening_logs\",\n    STOP_LISTENING_LOGS: \"driver.stop_listening_logs\",\n    IS_LISTENING_LOGS: \"driver.is_listening_logs\",\n};\n/**\n * Driver event constants\n */\nexports.DRIVER_EVENTS = {\n    VERIFY_CODE: \"verify code\",\n    CAPTCHA_REQUEST: \"captcha request\",\n    CONNECTED: \"connected\",\n    DISCONNECTED: \"disconnected\",\n    PUSH_CONNECTED: \"push connected\",\n    PUSH_DISCONNECTED: \"push disconnected\",\n    MQTT_CONNECTED: \"mqtt connected\",\n    MQTT_DISCONNECTED: \"mqtt disconnected\",\n    LOG_LEVEL_CHANGED: \"log level changed\",\n    LOGGING: \"logging\",\n    CONNECTION_ERROR: \"connection error\",\n};\nvar StorageType;\n(function (StorageType) {\n    StorageType[StorageType[\"NONE\"] = 0] = \"NONE\";\n    StorageType[StorageType[\"LOCAL\"] = 1] = \"LOCAL\";\n    StorageType[StorageType[\"CLOUD\"] = 2] = \"CLOUD\";\n    StorageType[StorageType[\"LOCAL_AND_CLOUD\"] = 3] = \"LOCAL_AND_CLOUD\";\n})(StorageType || (exports.StorageType = StorageType = {}));\n//# sourceMappingURL=constants.js.map","module.exports = require(\"https\");","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst http = require('http');\nconst { Duplex } = require('stream');\nconst { createHash } = require('crypto');\n\nconst extension = require('./extension');\nconst PerMessageDeflate = require('./permessage-deflate');\nconst subprotocol = require('./subprotocol');\nconst WebSocket = require('./websocket');\nconst { GUID, kWebSocket } = require('./constants');\n\nconst keyRegex = /^[+/0-9A-Za-z]{22}==$/;\n\nconst RUNNING = 0;\nconst CLOSING = 1;\nconst CLOSED = 2;\n\n/**\n * Class representing a WebSocket server.\n *\n * @extends EventEmitter\n */\nclass WebSocketServer extends EventEmitter {\n  /**\n   * Create a `WebSocketServer` instance.\n   *\n   * @param {Object} options Configuration options\n   * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n   *     automatically send a pong in response to a ping\n   * @param {Number} [options.backlog=511] The maximum length of the queue of\n   *     pending connections\n   * @param {Boolean} [options.clientTracking=true] Specifies whether or not to\n   *     track clients\n   * @param {Function} [options.handleProtocols] A hook to handle protocols\n   * @param {String} [options.host] The hostname where to bind the server\n   * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n   *     size\n   * @param {Boolean} [options.noServer=false] Enable no server mode\n   * @param {String} [options.path] Accept only connections matching this path\n   * @param {(Boolean|Object)} [options.perMessageDeflate=false] Enable/disable\n   *     permessage-deflate\n   * @param {Number} [options.port] The port where to bind the server\n   * @param {(http.Server|https.Server)} [options.server] A pre-created HTTP/S\n   *     server to use\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @param {Function} [options.verifyClient] A hook to reject connections\n   * @param {Function} [options.WebSocket=WebSocket] Specifies the `WebSocket`\n   *     class to use. It must be the `WebSocket` class or class that extends it\n   * @param {Function} [callback] A listener for the `listening` event\n   */\n  constructor(options, callback) {\n    super();\n\n    options = {\n      allowSynchronousEvents: true,\n      autoPong: true,\n      maxPayload: 100 * 1024 * 1024,\n      skipUTF8Validation: false,\n      perMessageDeflate: false,\n      handleProtocols: null,\n      clientTracking: true,\n      verifyClient: null,\n      noServer: false,\n      backlog: null, // use default (511 as implemented in net.js)\n      server: null,\n      host: null,\n      path: null,\n      port: null,\n      WebSocket,\n      ...options\n    };\n\n    if (\n      (options.port == null && !options.server && !options.noServer) ||\n      (options.port != null && (options.server || options.noServer)) ||\n      (options.server && options.noServer)\n    ) {\n      throw new TypeError(\n        'One and only one of the \"port\", \"server\", or \"noServer\" options ' +\n          'must be specified'\n      );\n    }\n\n    if (options.port != null) {\n      this._server = http.createServer((req, res) => {\n        const body = http.STATUS_CODES[426];\n\n        res.writeHead(426, {\n          'Content-Length': body.length,\n          'Content-Type': 'text/plain'\n        });\n        res.end(body);\n      });\n      this._server.listen(\n        options.port,\n        options.host,\n        options.backlog,\n        callback\n      );\n    } else if (options.server) {\n      this._server = options.server;\n    }\n\n    if (this._server) {\n      const emitConnection = this.emit.bind(this, 'connection');\n\n      this._removeListeners = addListeners(this._server, {\n        listening: this.emit.bind(this, 'listening'),\n        error: this.emit.bind(this, 'error'),\n        upgrade: (req, socket, head) => {\n          this.handleUpgrade(req, socket, head, emitConnection);\n        }\n      });\n    }\n\n    if (options.perMessageDeflate === true) options.perMessageDeflate = {};\n    if (options.clientTracking) {\n      this.clients = new Set();\n      this._shouldEmitClose = false;\n    }\n\n    this.options = options;\n    this._state = RUNNING;\n  }\n\n  /**\n   * Returns the bound address, the address family name, and port of the server\n   * as reported by the operating system if listening on an IP socket.\n   * If the server is listening on a pipe or UNIX domain socket, the name is\n   * returned as a string.\n   *\n   * @return {(Object|String|null)} The address of the server\n   * @public\n   */\n  address() {\n    if (this.options.noServer) {\n      throw new Error('The server is operating in \"noServer\" mode');\n    }\n\n    if (!this._server) return null;\n    return this._server.address();\n  }\n\n  /**\n   * Stop the server from accepting new connections and emit the `'close'` event\n   * when all existing connections are closed.\n   *\n   * @param {Function} [cb] A one-time listener for the `'close'` event\n   * @public\n   */\n  close(cb) {\n    if (this._state === CLOSED) {\n      if (cb) {\n        this.once('close', () => {\n          cb(new Error('The server is not running'));\n        });\n      }\n\n      process.nextTick(emitClose, this);\n      return;\n    }\n\n    if (cb) this.once('close', cb);\n\n    if (this._state === CLOSING) return;\n    this._state = CLOSING;\n\n    if (this.options.noServer || this.options.server) {\n      if (this._server) {\n        this._removeListeners();\n        this._removeListeners = this._server = null;\n      }\n\n      if (this.clients) {\n        if (!this.clients.size) {\n          process.nextTick(emitClose, this);\n        } else {\n          this._shouldEmitClose = true;\n        }\n      } else {\n        process.nextTick(emitClose, this);\n      }\n    } else {\n      const server = this._server;\n\n      this._removeListeners();\n      this._removeListeners = this._server = null;\n\n      //\n      // The HTTP/S server was created internally. Close it, and rely on its\n      // `'close'` event.\n      //\n      server.close(() => {\n        emitClose(this);\n      });\n    }\n  }\n\n  /**\n   * See if a given request should be handled by this server instance.\n   *\n   * @param {http.IncomingMessage} req Request object to inspect\n   * @return {Boolean} `true` if the request is valid, else `false`\n   * @public\n   */\n  shouldHandle(req) {\n    if (this.options.path) {\n      const index = req.url.indexOf('?');\n      const pathname = index !== -1 ? req.url.slice(0, index) : req.url;\n\n      if (pathname !== this.options.path) return false;\n    }\n\n    return true;\n  }\n\n  /**\n   * Handle a HTTP Upgrade request.\n   *\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @public\n   */\n  handleUpgrade(req, socket, head, cb) {\n    socket.on('error', socketOnError);\n\n    const key = req.headers['sec-websocket-key'];\n    const upgrade = req.headers.upgrade;\n    const version = +req.headers['sec-websocket-version'];\n\n    if (req.method !== 'GET') {\n      const message = 'Invalid HTTP method';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 405, message);\n      return;\n    }\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      const message = 'Invalid Upgrade header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (key === undefined || !keyRegex.test(key)) {\n      const message = 'Missing or invalid Sec-WebSocket-Key header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n      return;\n    }\n\n    if (version !== 13 && version !== 8) {\n      const message = 'Missing or invalid Sec-WebSocket-Version header';\n      abortHandshakeOrEmitwsClientError(this, req, socket, 400, message, {\n        'Sec-WebSocket-Version': '13, 8'\n      });\n      return;\n    }\n\n    if (!this.shouldHandle(req)) {\n      abortHandshake(socket, 400);\n      return;\n    }\n\n    const secWebSocketProtocol = req.headers['sec-websocket-protocol'];\n    let protocols = new Set();\n\n    if (secWebSocketProtocol !== undefined) {\n      try {\n        protocols = subprotocol.parse(secWebSocketProtocol);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Protocol header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    const secWebSocketExtensions = req.headers['sec-websocket-extensions'];\n    const extensions = {};\n\n    if (\n      this.options.perMessageDeflate &&\n      secWebSocketExtensions !== undefined\n    ) {\n      const perMessageDeflate = new PerMessageDeflate(\n        this.options.perMessageDeflate,\n        true,\n        this.options.maxPayload\n      );\n\n      try {\n        const offers = extension.parse(secWebSocketExtensions);\n\n        if (offers[PerMessageDeflate.extensionName]) {\n          perMessageDeflate.accept(offers[PerMessageDeflate.extensionName]);\n          extensions[PerMessageDeflate.extensionName] = perMessageDeflate;\n        }\n      } catch (err) {\n        const message =\n          'Invalid or unacceptable Sec-WebSocket-Extensions header';\n        abortHandshakeOrEmitwsClientError(this, req, socket, 400, message);\n        return;\n      }\n    }\n\n    //\n    // Optionally call external client verification handler.\n    //\n    if (this.options.verifyClient) {\n      const info = {\n        origin:\n          req.headers[`${version === 8 ? 'sec-websocket-origin' : 'origin'}`],\n        secure: !!(req.socket.authorized || req.socket.encrypted),\n        req\n      };\n\n      if (this.options.verifyClient.length === 2) {\n        this.options.verifyClient(info, (verified, code, message, headers) => {\n          if (!verified) {\n            return abortHandshake(socket, code || 401, message, headers);\n          }\n\n          this.completeUpgrade(\n            extensions,\n            key,\n            protocols,\n            req,\n            socket,\n            head,\n            cb\n          );\n        });\n        return;\n      }\n\n      if (!this.options.verifyClient(info)) return abortHandshake(socket, 401);\n    }\n\n    this.completeUpgrade(extensions, key, protocols, req, socket, head, cb);\n  }\n\n  /**\n   * Upgrade the connection to WebSocket.\n   *\n   * @param {Object} extensions The accepted extensions\n   * @param {String} key The value of the `Sec-WebSocket-Key` header\n   * @param {Set} protocols The subprotocols\n   * @param {http.IncomingMessage} req The request object\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Function} cb Callback\n   * @throws {Error} If called more than once with the same socket\n   * @private\n   */\n  completeUpgrade(extensions, key, protocols, req, socket, head, cb) {\n    //\n    // Destroy the socket if the client has already sent a FIN packet.\n    //\n    if (!socket.readable || !socket.writable) return socket.destroy();\n\n    if (socket[kWebSocket]) {\n      throw new Error(\n        'server.handleUpgrade() was called more than once with the same ' +\n          'socket, possibly due to a misconfiguration'\n      );\n    }\n\n    if (this._state > RUNNING) return abortHandshake(socket, 503);\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    const headers = [\n      'HTTP/1.1 101 Switching Protocols',\n      'Upgrade: websocket',\n      'Connection: Upgrade',\n      `Sec-WebSocket-Accept: ${digest}`\n    ];\n\n    const ws = new this.options.WebSocket(null, undefined, this.options);\n\n    if (protocols.size) {\n      //\n      // Optionally call external protocol selection handler.\n      //\n      const protocol = this.options.handleProtocols\n        ? this.options.handleProtocols(protocols, req)\n        : protocols.values().next().value;\n\n      if (protocol) {\n        headers.push(`Sec-WebSocket-Protocol: ${protocol}`);\n        ws._protocol = protocol;\n      }\n    }\n\n    if (extensions[PerMessageDeflate.extensionName]) {\n      const params = extensions[PerMessageDeflate.extensionName].params;\n      const value = extension.format({\n        [PerMessageDeflate.extensionName]: [params]\n      });\n      headers.push(`Sec-WebSocket-Extensions: ${value}`);\n      ws._extensions = extensions;\n    }\n\n    //\n    // Allow external modification/inspection of handshake headers.\n    //\n    this.emit('headers', headers, req);\n\n    socket.write(headers.concat('\\r\\n').join('\\r\\n'));\n    socket.removeListener('error', socketOnError);\n\n    ws.setSocket(socket, head, {\n      allowSynchronousEvents: this.options.allowSynchronousEvents,\n      maxPayload: this.options.maxPayload,\n      skipUTF8Validation: this.options.skipUTF8Validation\n    });\n\n    if (this.clients) {\n      this.clients.add(ws);\n      ws.on('close', () => {\n        this.clients.delete(ws);\n\n        if (this._shouldEmitClose && !this.clients.size) {\n          process.nextTick(emitClose, this);\n        }\n      });\n    }\n\n    cb(ws, req);\n  }\n}\n\nmodule.exports = WebSocketServer;\n\n/**\n * Add event listeners on an `EventEmitter` using a map of <event, listener>\n * pairs.\n *\n * @param {EventEmitter} server The event emitter\n * @param {Object.<String, Function>} map The listeners to add\n * @return {Function} A function that will remove the added listeners when\n *     called\n * @private\n */\nfunction addListeners(server, map) {\n  for (const event of Object.keys(map)) server.on(event, map[event]);\n\n  return function removeListeners() {\n    for (const event of Object.keys(map)) {\n      server.removeListener(event, map[event]);\n    }\n  };\n}\n\n/**\n * Emit a `'close'` event on an `EventEmitter`.\n *\n * @param {EventEmitter} server The event emitter\n * @private\n */\nfunction emitClose(server) {\n  server._state = CLOSED;\n  server.emit('close');\n}\n\n/**\n * Handle socket errors.\n *\n * @private\n */\nfunction socketOnError() {\n  this.destroy();\n}\n\n/**\n * Close the connection when preconditions are not fulfilled.\n *\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} [message] The HTTP response body\n * @param {Object} [headers] Additional HTTP response headers\n * @private\n */\nfunction abortHandshake(socket, code, message, headers) {\n  //\n  // The socket is writable unless the user destroyed or ended it before calling\n  // `server.handleUpgrade()` or in the `verifyClient` function, which is a user\n  // error. Handling this does not make much sense as the worst that can happen\n  // is that some of the data written by the user might be discarded due to the\n  // call to `socket.end()` below, which triggers an `'error'` event that in\n  // turn causes the socket to be destroyed.\n  //\n  message = message || http.STATUS_CODES[code];\n  headers = {\n    Connection: 'close',\n    'Content-Type': 'text/html',\n    'Content-Length': Buffer.byteLength(message),\n    ...headers\n  };\n\n  socket.once('finish', socket.destroy);\n\n  socket.end(\n    `HTTP/1.1 ${code} ${http.STATUS_CODES[code]}\\r\\n` +\n      Object.keys(headers)\n        .map((h) => `${h}: ${headers[h]}`)\n        .join('\\r\\n') +\n      '\\r\\n\\r\\n' +\n      message\n  );\n}\n\n/**\n * Emit a `'wsClientError'` event on a `WebSocketServer` if there is at least\n * one listener for it, otherwise call `abortHandshake()`.\n *\n * @param {WebSocketServer} server The WebSocket server\n * @param {http.IncomingMessage} req The request object\n * @param {Duplex} socket The socket of the upgrade request\n * @param {Number} code The HTTP response status code\n * @param {String} message The HTTP response body\n * @param {Object} [headers] The HTTP response headers\n * @private\n */\nfunction abortHandshakeOrEmitwsClientError(\n  server,\n  req,\n  socket,\n  code,\n  message,\n  headers\n) {\n  if (server.listenerCount('wsClientError')) {\n    const err = new Error(message);\n    Error.captureStackTrace(err, abortHandshakeOrEmitwsClientError);\n\n    server.emit('wsClientError', err, socket, req);\n  } else {\n    abortHandshake(socket, code, message, headers);\n  }\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=shared.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.jsonStringifyRecursive = jsonStringifyRecursive;\nfunction jsonStringifyRecursive(obj) {\n    const cache = new Set();\n    return JSON.stringify(obj, (key, value) => {\n        if (typeof value === \"object\" && value !== null) {\n            if (cache.has(value)) {\n                return \"[Circular]\";\n            }\n            cache.add(value);\n        }\n        if (typeof value === \"bigint\") {\n            return `${value}`;\n        }\n        if (typeof value === \"undefined\") {\n            return \"[undefined]\";\n        }\n        return value;\n    });\n}\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.inspect = inspect;\nexports.formatValue = formatValue;\nexports.formatWithOptions = formatWithOptions;\nconst prettyLogStyles_js_1 = require(\"../prettyLogStyles.js\");\nconst jsonStringifyRecursive_js_1 = require(\"./jsonStringifyRecursive.js\");\nfunction inspect(obj, opts) {\n    const ctx = {\n        seen: [],\n        stylize: stylizeNoColor,\n    };\n    if (opts != null) {\n        _extend(ctx, opts);\n    }\n    if (isUndefined(ctx.showHidden))\n        ctx.showHidden = false;\n    if (isUndefined(ctx.depth))\n        ctx.depth = 2;\n    if (isUndefined(ctx.colors))\n        ctx.colors = true;\n    if (isUndefined(ctx.customInspect))\n        ctx.customInspect = true;\n    if (ctx.colors)\n        ctx.stylize = stylizeWithColor;\n    return formatValue(ctx, obj, ctx.depth);\n}\ninspect.colors = prettyLogStyles_js_1.prettyLogStyles;\ninspect.styles = {\n    special: \"cyan\",\n    number: \"yellow\",\n    boolean: \"yellow\",\n    undefined: \"grey\",\n    null: \"bold\",\n    string: \"green\",\n    date: \"magenta\",\n    regexp: \"red\",\n};\nfunction isBoolean(arg) {\n    return typeof arg === \"boolean\";\n}\nfunction isUndefined(arg) {\n    return arg === undefined;\n}\nfunction stylizeNoColor(str) {\n    return str;\n}\nfunction stylizeWithColor(str, styleType) {\n    const style = inspect.styles[styleType];\n    if (style != null && inspect?.colors?.[style]?.[0] != null && inspect?.colors?.[style]?.[1] != null) {\n        return \"\\u001b[\" + inspect.colors[style][0] + \"m\" + str + \"\\u001b[\" + inspect.colors[style][1] + \"m\";\n    }\n    else {\n        return str;\n    }\n}\nfunction isFunction(arg) {\n    return typeof arg === \"function\";\n}\nfunction isString(arg) {\n    return typeof arg === \"string\";\n}\nfunction isNumber(arg) {\n    return typeof arg === \"number\";\n}\nfunction isNull(arg) {\n    return arg === null;\n}\nfunction hasOwn(obj, prop) {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n}\nfunction isRegExp(re) {\n    return isObject(re) && objectToString(re) === \"[object RegExp]\";\n}\nfunction isObject(arg) {\n    return typeof arg === \"object\" && arg !== null;\n}\nfunction isError(e) {\n    return isObject(e) && (objectToString(e) === \"[object Error]\" || e instanceof Error);\n}\nfunction isDate(d) {\n    return isObject(d) && objectToString(d) === \"[object Date]\";\n}\nfunction objectToString(o) {\n    return Object.prototype.toString.call(o);\n}\nfunction arrayToHash(array) {\n    const hash = {};\n    array.forEach((val) => {\n        hash[val] = true;\n    });\n    return hash;\n}\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n    const output = [];\n    for (let i = 0, l = value.length; i < l; ++i) {\n        if (hasOwn(value, String(i))) {\n            output.push(formatProperty(ctx, value, recurseTimes, visibleKeys, String(i), true));\n        }\n        else {\n            output.push(\"\");\n        }\n    }\n    keys.forEach((key) => {\n        if (!key.match(/^\\d+$/)) {\n            output.push(formatProperty(ctx, value, recurseTimes, visibleKeys, key, true));\n        }\n    });\n    return output;\n}\nfunction formatError(value) {\n    return \"[\" + Error.prototype.toString.call(value) + \"]\";\n}\nfunction formatValue(ctx, value, recurseTimes = 0) {\n    if (ctx.customInspect &&\n        value != null &&\n        isFunction(value) &&\n        value?.inspect !== inspect &&\n        !(value?.constructor && value?.constructor.prototype === value)) {\n        if (typeof value.inspect !== \"function\" && value.toString != null) {\n            return value.toString();\n        }\n        let ret = value?.inspect(recurseTimes, ctx);\n        if (!isString(ret)) {\n            ret = formatValue(ctx, ret, recurseTimes);\n        }\n        return ret;\n    }\n    const primitive = formatPrimitive(ctx, value);\n    if (primitive) {\n        return primitive;\n    }\n    let keys = Object.keys(value);\n    const visibleKeys = arrayToHash(keys);\n    try {\n        if (ctx.showHidden && Object.getOwnPropertyNames) {\n            keys = Object.getOwnPropertyNames(value);\n        }\n    }\n    catch {\n    }\n    if (isError(value) && (keys.indexOf(\"message\") >= 0 || keys.indexOf(\"description\") >= 0)) {\n        return formatError(value);\n    }\n    if (keys.length === 0) {\n        if (isFunction(ctx.stylize)) {\n            if (isFunction(value)) {\n                const name = value.name ? \": \" + value.name : \"\";\n                return ctx.stylize(\"[Function\" + name + \"]\", \"special\");\n            }\n            if (isRegExp(value)) {\n                return ctx.stylize(RegExp.prototype.toString.call(value), \"regexp\");\n            }\n            if (isDate(value)) {\n                return ctx.stylize(Date.prototype.toISOString.call(value), \"date\");\n            }\n            if (isError(value)) {\n                return formatError(value);\n            }\n        }\n        else {\n            return value;\n        }\n    }\n    let base = \"\";\n    let array = false;\n    let braces = [\"{\\n\", \"\\n}\"];\n    if (Array.isArray(value)) {\n        array = true;\n        braces = [\"[\\n\", \"\\n]\"];\n    }\n    if (isFunction(value)) {\n        const n = value.name ? \": \" + value.name : \"\";\n        base = \" [Function\" + n + \"]\";\n    }\n    if (isRegExp(value)) {\n        base = \" \" + RegExp.prototype.toString.call(value);\n    }\n    if (isDate(value)) {\n        base = \" \" + Date.prototype.toUTCString.call(value);\n    }\n    if (isError(value)) {\n        base = \" \" + formatError(value);\n    }\n    if (keys.length === 0 && (!array || value.length == 0)) {\n        return braces[0] + base + braces[1];\n    }\n    if (recurseTimes < 0) {\n        if (isRegExp(value)) {\n            return ctx.stylize(RegExp.prototype.toString.call(value), \"regexp\");\n        }\n        else {\n            return ctx.stylize(\"[Object]\", \"special\");\n        }\n    }\n    ctx.seen.push(value);\n    let output;\n    if (array) {\n        output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n    }\n    else {\n        output = keys.map((key) => {\n            return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n        });\n    }\n    ctx.seen.pop();\n    return reduceToSingleString(output, base, braces);\n}\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n    let name, str;\n    let desc = { value: void 0 };\n    try {\n        desc.value = value[key];\n    }\n    catch {\n    }\n    try {\n        if (Object.getOwnPropertyDescriptor) {\n            desc = Object.getOwnPropertyDescriptor(value, key) || desc;\n        }\n    }\n    catch {\n    }\n    if (desc.get) {\n        if (desc.set) {\n            str = ctx.stylize(\"[Getter/Setter]\", \"special\");\n        }\n        else {\n            str = ctx.stylize(\"[Getter]\", \"special\");\n        }\n    }\n    else {\n        if (desc.set) {\n            str = ctx.stylize(\"[Setter]\", \"special\");\n        }\n    }\n    if (!hasOwn(visibleKeys, key)) {\n        name = \"[\" + key + \"]\";\n    }\n    if (!str) {\n        if (ctx.seen.indexOf(desc.value) < 0) {\n            if (isNull(recurseTimes)) {\n                str = formatValue(ctx, desc.value, undefined);\n            }\n            else {\n                str = formatValue(ctx, desc.value, recurseTimes - 1);\n            }\n            if (str.indexOf(\"\\n\") > -1) {\n                if (array) {\n                    str = str\n                        .split(\"\\n\")\n                        .map((line) => {\n                        return \"  \" + line;\n                    })\n                        .join(\"\\n\")\n                        .substr(2);\n                }\n                else {\n                    str =\n                        \"\\n\" +\n                            str\n                                .split(\"\\n\")\n                                .map((line) => {\n                                return \"   \" + line;\n                            })\n                                .join(\"\\n\");\n                }\n            }\n        }\n        else {\n            str = ctx.stylize(\"[Circular]\", \"special\");\n        }\n    }\n    if (isUndefined(name)) {\n        if (array && key.match(/^\\d+$/)) {\n            return str;\n        }\n        name = JSON.stringify(\"\" + key);\n        if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n            name = name.substr(1, name.length - 2);\n            name = ctx.stylize(name, \"name\");\n        }\n        else {\n            name = name\n                .replace(/'/g, \"\\\\'\")\n                .replace(/\\\\\"/g, \"\\\\'\")\n                .replace(/(^\"|\"$)/g, \"'\");\n            name = ctx.stylize(name, \"string\");\n        }\n    }\n    return name + \": \" + str;\n}\nfunction formatPrimitive(ctx, value) {\n    if (isUndefined(value))\n        return ctx.stylize(\"undefined\", \"undefined\");\n    if (isString(value)) {\n        const simple = \"'\" + JSON.stringify(value).replace(/^\"|\"$/g, \"\").replace(/'/g, \"\\\\'\").replace(/\\\\\"/g, \"\\\\'\") + \"'\";\n        return ctx.stylize(simple, \"string\");\n    }\n    if (isNumber(value))\n        return ctx.stylize(\"\" + value, \"number\");\n    if (isBoolean(value))\n        return ctx.stylize(\"\" + value, \"boolean\");\n    if (isNull(value))\n        return ctx.stylize(\"null\", \"null\");\n}\nfunction reduceToSingleString(output, base, braces) {\n    return braces[0] + (base === \"\" ? \"\" : base + \"\\n\") + \"  \" + output.join(\",\\n  \") + \" \" + braces[1];\n}\nfunction _extend(origin, add) {\n    const typedOrigin = { ...origin };\n    if (!add || !isObject(add))\n        return origin;\n    const clonedAdd = { ...add };\n    const keys = Object.keys(add);\n    let i = keys.length;\n    while (i--) {\n        typedOrigin[keys[i]] = clonedAdd[keys[i]];\n    }\n    return typedOrigin;\n}\nfunction formatWithOptions(inspectOptions, ...args) {\n    const ctx = {\n        seen: [],\n        stylize: stylizeNoColor,\n    };\n    if (inspectOptions != null) {\n        _extend(ctx, inspectOptions);\n    }\n    const first = args[0];\n    let a = 0;\n    let str = \"\";\n    let join = \"\";\n    if (typeof first === \"string\") {\n        if (args.length === 1) {\n            return first;\n        }\n        let tempStr;\n        let lastPos = 0;\n        for (let i = 0; i < first.length - 1; i++) {\n            if (first.charCodeAt(i) === 37) {\n                const nextChar = first.charCodeAt(++i);\n                if (a + 1 !== args.length) {\n                    switch (nextChar) {\n                        case 115: {\n                            const tempArg = args[++a];\n                            if (typeof tempArg === \"number\") {\n                                tempStr = formatPrimitive(ctx, tempArg);\n                            }\n                            else if (typeof tempArg === \"bigint\") {\n                                tempStr = formatPrimitive(ctx, tempArg);\n                            }\n                            else if (typeof tempArg !== \"object\" || tempArg === null) {\n                                tempStr = String(tempArg);\n                            }\n                            else {\n                                tempStr = inspect(tempArg, {\n                                    ...inspectOptions,\n                                    compact: 3,\n                                    colors: false,\n                                    depth: 0,\n                                });\n                            }\n                            break;\n                        }\n                        case 106:\n                            tempStr = (0, jsonStringifyRecursive_js_1.jsonStringifyRecursive)(args[++a]);\n                            break;\n                        case 100: {\n                            const tempNum = args[++a];\n                            if (typeof tempNum === \"bigint\") {\n                                tempStr = formatPrimitive(ctx, tempNum);\n                            }\n                            else if (typeof tempNum === \"symbol\") {\n                                tempStr = \"NaN\";\n                            }\n                            else {\n                                tempStr = formatPrimitive(ctx, tempNum);\n                            }\n                            break;\n                        }\n                        case 79:\n                            tempStr = inspect(args[++a], inspectOptions);\n                            break;\n                        case 111:\n                            tempStr = inspect(args[++a], {\n                                ...inspectOptions,\n                                showHidden: true,\n                                showProxy: true,\n                                depth: 4,\n                            });\n                            break;\n                        case 105: {\n                            const tempInteger = args[++a];\n                            if (typeof tempInteger === \"bigint\") {\n                                tempStr = formatPrimitive(ctx, tempInteger);\n                            }\n                            else if (typeof tempInteger === \"symbol\") {\n                                tempStr = \"NaN\";\n                            }\n                            else {\n                                tempStr = formatPrimitive(ctx, parseInt(tempStr));\n                            }\n                            break;\n                        }\n                        case 102: {\n                            const tempFloat = args[++a];\n                            if (typeof tempFloat === \"symbol\") {\n                                tempStr = \"NaN\";\n                            }\n                            else {\n                                tempStr = formatPrimitive(ctx, parseInt(tempFloat));\n                            }\n                            break;\n                        }\n                        case 99:\n                            a += 1;\n                            tempStr = \"\";\n                            break;\n                        case 37:\n                            str += first.slice(lastPos, i);\n                            lastPos = i + 1;\n                            continue;\n                        default:\n                            continue;\n                    }\n                    if (lastPos !== i - 1) {\n                        str += first.slice(lastPos, i - 1);\n                    }\n                    str += tempStr;\n                    lastPos = i + 1;\n                }\n                else if (nextChar === 37) {\n                    str += first.slice(lastPos, i);\n                    lastPos = i + 1;\n                }\n            }\n        }\n        if (lastPos !== 0) {\n            a++;\n            join = \" \";\n            if (lastPos < first.length) {\n                str += first.slice(lastPos);\n            }\n        }\n    }\n    while (a < args.length) {\n        const value = args[a];\n        str += join;\n        str += typeof value !== \"string\" ? inspect(value, inspectOptions) : value;\n        join = \" \";\n        a++;\n    }\n    return str;\n}\n","\"use strict\";\n/**\n * Driver module exports\n *\n * Provides all driver-related constants, commands, events, and responses for the Eufy Security WebSocket Client.\n * This barrel file re-exports all driver-related modules for easy import.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\ntslib_1.__exportStar(require(\"./constants\"), exports);\ntslib_1.__exportStar(require(\"./commands\"), exports);\ntslib_1.__exportStar(require(\"./events\"), exports);\ntslib_1.__exportStar(require(\"./properties\"), exports);\ntslib_1.__exportStar(require(\"./responses\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.BaseLogger = exports.loggerEnvironment = void 0;\nexports.createLoggerEnvironment = createLoggerEnvironment;\nconst urlToObj_js_1 = require(\"./urlToObj.js\");\nconst metaFormatting_js_1 = require(\"./internal/metaFormatting.js\");\nconst errorUtils_js_1 = require(\"./internal/errorUtils.js\");\nconst formatTemplate_js_1 = require(\"./formatTemplate.js\");\nconst util_inspect_polyfill_js_1 = require(\"./internal/util.inspect.polyfill.js\");\nconst stackTrace_js_1 = require(\"./internal/stackTrace.js\");\nconst environment_js_1 = require(\"./internal/environment.js\");\nconst jsonStringifyRecursive_js_1 = require(\"./internal/jsonStringifyRecursive.js\");\nfunction createLoggerEnvironment() {\n    const runtimeInfo = detectRuntimeInfo();\n    const meta = createRuntimeMeta(runtimeInfo);\n    const usesBrowserStack = runtimeInfo.name === \"browser\" || runtimeInfo.name === \"worker\";\n    const callerIgnorePatterns = usesBrowserStack\n        ? [...(0, stackTrace_js_1.getDefaultIgnorePatterns)(), /node_modules[\\\\/].*tslog/i]\n        : [...(0, stackTrace_js_1.getDefaultIgnorePatterns)(), /node:(?:internal|vm)/i, /\\binternal[\\\\/]/i];\n    let cachedCwd;\n    const environment = {\n        getMeta(logLevelId, logLevelName, stackDepthLevel, hideLogPositionForPerformance, name, parentNames) {\n            return Object.assign({}, meta, {\n                name,\n                parentNames,\n                date: new Date(),\n                logLevelId,\n                logLevelName,\n                path: !hideLogPositionForPerformance ? environment.getCallerStackFrame(stackDepthLevel) : undefined,\n            });\n        },\n        getCallerStackFrame(stackDepthLevel, error = new Error()) {\n            const frames = (0, stackTrace_js_1.buildStackTrace)(error, (line) => parseStackLine(line));\n            if (frames.length === 0) {\n                return {};\n            }\n            const autoIndex = (0, stackTrace_js_1.findFirstExternalFrameIndex)(frames, callerIgnorePatterns);\n            const useManualIndex = Number.isFinite(stackDepthLevel) && stackDepthLevel >= 0;\n            const resolvedIndex = useManualIndex ? (0, stackTrace_js_1.clampIndex)(stackDepthLevel, frames.length) : (0, stackTrace_js_1.clampIndex)(autoIndex, frames.length);\n            return frames[resolvedIndex] ?? {};\n        },\n        getErrorTrace(error) {\n            return (0, stackTrace_js_1.buildStackTrace)(error, (line) => parseStackLine(line));\n        },\n        isError(value) {\n            return isNativeError(value);\n        },\n        isBuffer(value) {\n            return typeof Buffer !== \"undefined\" && typeof Buffer.isBuffer === \"function\" ? Buffer.isBuffer(value) : false;\n        },\n        prettyFormatLogObj(maskedArgs, settings) {\n            return maskedArgs.reduce((result, arg) => {\n                if (environment.isError(arg)) {\n                    result.errors.push(environment.prettyFormatErrorObj(arg, settings));\n                }\n                else {\n                    result.args.push(arg);\n                }\n                return result;\n            }, { args: [], errors: [] });\n        },\n        prettyFormatErrorObj(error, settings) {\n            const stackLines = formatStackFrames(environment.getErrorTrace(error), settings);\n            const causeSections = (0, errorUtils_js_1.collectErrorCauses)(error).map((cause, index) => {\n                const header = `Caused by (${index + 1}): ${cause.name ?? \"Error\"}${cause.message ? `: ${cause.message}` : \"\"}`;\n                const frames = formatStackFrames((0, stackTrace_js_1.buildStackTrace)(cause, (line) => parseStackLine(line)), settings);\n                return [header, ...frames].join(\"\\n\");\n            });\n            const placeholderValuesError = {\n                errorName: ` ${error.name} `,\n                errorMessage: formatErrorMessage(error),\n                errorStack: [...stackLines, ...causeSections].join(\"\\n\"),\n            };\n            return (0, formatTemplate_js_1.formatTemplate)(settings, settings.prettyErrorTemplate, placeholderValuesError);\n        },\n        transportFormatted(logMetaMarkup, logArgs, logErrors, logMeta, settings) {\n            const prettyLogs = settings.stylePrettyLogs !== false;\n            const logErrorsStr = (logErrors.length > 0 && logArgs.length > 0 ? \"\\n\" : \"\") + logErrors.join(\"\\n\");\n            const sanitizedMetaMarkup = stripAnsi(logMetaMarkup);\n            const metaMarkupForText = prettyLogs ? logMetaMarkup : sanitizedMetaMarkup;\n            if (shouldUseCss(prettyLogs)) {\n                settings.prettyInspectOptions.colors = false;\n                const formattedArgs = formatWithOptionsSafe(settings.prettyInspectOptions, logArgs);\n                const cssMeta = logMeta != null ? buildCssMetaOutput(settings, logMeta) : { text: sanitizedMetaMarkup, styles: [] };\n                const hasCssMeta = cssMeta.text.length > 0 && cssMeta.styles.length > 0;\n                const metaOutput = hasCssMeta ? cssMeta.text : sanitizedMetaMarkup;\n                const output = metaOutput + formattedArgs + logErrorsStr;\n                if (hasCssMeta) {\n                    console.log(output, ...cssMeta.styles);\n                }\n                else {\n                    console.log(output);\n                }\n                return;\n            }\n            settings.prettyInspectOptions.colors = prettyLogs;\n            const formattedArgs = formatWithOptionsSafe(settings.prettyInspectOptions, logArgs);\n            console.log(metaMarkupForText + formattedArgs + logErrorsStr);\n        },\n        transportJSON(json) {\n            console.log((0, jsonStringifyRecursive_js_1.jsonStringifyRecursive)(json));\n        },\n    };\n    if (getNodeEnv() === \"test\") {\n        environment.__resetWorkingDirectoryCacheForTests = () => {\n            cachedCwd = undefined;\n        };\n    }\n    return environment;\n    function parseStackLine(line) {\n        return usesBrowserStack ? parseBrowserStackLine(line) : parseServerStackLine(line);\n    }\n    function parseServerStackLine(rawLine) {\n        if (typeof rawLine !== \"string\" || rawLine.length === 0) {\n            return undefined;\n        }\n        const trimmedLine = rawLine.trim();\n        if (!trimmedLine.includes(\" at \") && !trimmedLine.startsWith(\"at \")) {\n            return undefined;\n        }\n        const line = trimmedLine.replace(/^at\\s+/, \"\");\n        let method;\n        let location = line;\n        const methodMatch = line.match(/^(.*?)\\s+\\((.*)\\)$/);\n        if (methodMatch) {\n            method = methodMatch[1];\n            location = methodMatch[2];\n        }\n        const sanitizedLocation = location.replace(/^\\(/, \"\").replace(/\\)$/, \"\");\n        const withoutQuery = sanitizedLocation.replace(/\\?.*$/, \"\");\n        let fileLine;\n        let fileColumn;\n        let filePathCandidate = withoutQuery;\n        const segments = withoutQuery.split(\":\");\n        if (segments.length >= 3 && /^\\d+$/.test(segments[segments.length - 1] ?? \"\")) {\n            fileColumn = segments.pop();\n            fileLine = segments.pop();\n            filePathCandidate = segments.join(\":\");\n        }\n        else if (segments.length >= 2 && /^\\d+$/.test(segments[segments.length - 1] ?? \"\")) {\n            fileLine = segments.pop();\n            filePathCandidate = segments.join(\":\");\n        }\n        let normalizedPath = filePathCandidate.replace(/^file:\\/\\//, \"\");\n        const cwd = getWorkingDirectory();\n        if (cwd != null && normalizedPath.startsWith(cwd)) {\n            normalizedPath = normalizedPath.slice(cwd.length);\n            normalizedPath = normalizedPath.replace(/^[\\\\/]/, \"\");\n        }\n        if (normalizedPath.length === 0) {\n            normalizedPath = filePathCandidate;\n        }\n        const normalizedPathWithoutLine = normalizeFilePath(normalizedPath);\n        const effectivePath = normalizedPathWithoutLine.length > 0 ? normalizedPathWithoutLine : normalizedPath;\n        const pathSegments = effectivePath.split(/\\\\|\\//);\n        const fileName = pathSegments[pathSegments.length - 1];\n        const fileNameWithLine = fileName && fileLine ? `${fileName}:${fileLine}` : undefined;\n        const filePathWithLine = effectivePath && fileLine ? `${effectivePath}:${fileLine}` : undefined;\n        return {\n            fullFilePath: sanitizedLocation,\n            fileName,\n            fileNameWithLine,\n            fileColumn,\n            fileLine,\n            filePath: effectivePath,\n            filePathWithLine,\n            method,\n        };\n    }\n    function parseBrowserStackLine(line) {\n        const href = globalThis.location?.origin;\n        if (line == null) {\n            return undefined;\n        }\n        const match = line.match(BROWSER_PATH_REGEX);\n        if (!match) {\n            return undefined;\n        }\n        const filePath = match[1]?.replace(/\\?.*$/, \"\");\n        if (filePath == null) {\n            return undefined;\n        }\n        const pathParts = filePath.split(\"/\");\n        const fileLine = match[2];\n        const fileColumn = match[3];\n        const fileName = pathParts[pathParts.length - 1];\n        return {\n            fullFilePath: href ? `${href}${filePath}` : filePath,\n            fileName,\n            fileNameWithLine: fileName && fileLine ? `${fileName}:${fileLine}` : undefined,\n            fileColumn,\n            fileLine,\n            filePath,\n            filePathWithLine: fileLine ? `${filePath}:${fileLine}` : undefined,\n            method: undefined,\n        };\n    }\n    function formatStackFrames(frames, settings) {\n        return frames.map((stackFrame) => (0, formatTemplate_js_1.formatTemplate)(settings, settings.prettyErrorStackTemplate, { ...stackFrame }, true));\n    }\n    function formatErrorMessage(error) {\n        return Object.getOwnPropertyNames(error)\n            .filter((key) => key !== \"stack\" && key !== \"cause\")\n            .reduce((result, key) => {\n            const value = error[key];\n            if (typeof value === \"function\") {\n                return result;\n            }\n            result.push(String(value));\n            return result;\n        }, [])\n            .join(\", \");\n    }\n    function shouldUseCss(prettyLogs) {\n        return prettyLogs && (runtimeInfo.name === \"browser\" || runtimeInfo.name === \"worker\") && (0, environment_js_1.consoleSupportsCssStyling)();\n    }\n    function stripAnsi(value) {\n        return value.replace(ANSI_REGEX, \"\");\n    }\n    function buildCssMetaOutput(settings, metaValue) {\n        if (metaValue == null) {\n            return { text: \"\", styles: [] };\n        }\n        const { template, placeholders } = (0, metaFormatting_js_1.buildPrettyMeta)(settings, metaValue);\n        const parts = [];\n        const styles = [];\n        let lastIndex = 0;\n        const placeholderRegex = /{{(.+?)}}/g;\n        let match;\n        while ((match = placeholderRegex.exec(template)) != null) {\n            if (match.index > lastIndex) {\n                parts.push(template.slice(lastIndex, match.index));\n            }\n            const key = match[1];\n            const rawValue = placeholders[key] != null ? String(placeholders[key]) : \"\";\n            const tokens = collectStyleTokens(settings.prettyLogStyles?.[key], rawValue);\n            const css = tokensToCss(tokens);\n            if (css.length > 0) {\n                parts.push(`%c${rawValue}%c`);\n                styles.push(css, \"\");\n            }\n            else {\n                parts.push(rawValue);\n            }\n            lastIndex = placeholderRegex.lastIndex;\n        }\n        if (lastIndex < template.length) {\n            parts.push(template.slice(lastIndex));\n        }\n        return {\n            text: parts.join(\"\"),\n            styles,\n        };\n    }\n    function collectStyleTokens(style, value) {\n        if (style == null) {\n            return [];\n        }\n        if (typeof style === \"string\") {\n            return [style];\n        }\n        if (Array.isArray(style)) {\n            return style.flatMap((token) => collectStyleTokens(token, value));\n        }\n        if (typeof style === \"object\") {\n            const normalizedValue = value.trim();\n            const nextStyle = style[normalizedValue] ?? style[\"*\"];\n            if (nextStyle == null) {\n                return [];\n            }\n            return collectStyleTokens(nextStyle, value);\n        }\n        return [];\n    }\n    function tokensToCss(tokens) {\n        const seen = new Set();\n        const cssParts = [];\n        for (const token of tokens) {\n            const css = styleTokenToCss(token);\n            if (css != null && css.length > 0 && !seen.has(css)) {\n                seen.add(css);\n                cssParts.push(css);\n            }\n        }\n        return cssParts.join(\"; \");\n    }\n    function styleTokenToCss(token) {\n        const color = COLOR_TOKENS[token];\n        if (color != null) {\n            return `color: ${color}`;\n        }\n        const background = BACKGROUND_TOKENS[token];\n        if (background != null) {\n            return `background-color: ${background}`;\n        }\n        switch (token) {\n            case \"bold\":\n                return \"font-weight: bold\";\n            case \"dim\":\n                return \"opacity: 0.75\";\n            case \"italic\":\n                return \"font-style: italic\";\n            case \"underline\":\n                return \"text-decoration: underline\";\n            case \"overline\":\n                return \"text-decoration: overline\";\n            case \"inverse\":\n                return \"filter: invert(1)\";\n            case \"hidden\":\n                return \"visibility: hidden\";\n            case \"strikethrough\":\n                return \"text-decoration: line-through\";\n            default:\n                return undefined;\n        }\n    }\n    function getWorkingDirectory() {\n        if (cachedCwd === undefined) {\n            cachedCwd = (0, environment_js_1.safeGetCwd)() ?? null;\n        }\n        return cachedCwd ?? undefined;\n    }\n    function shouldCaptureHostname() {\n        return runtimeInfo.name === \"node\" || runtimeInfo.name === \"deno\" || runtimeInfo.name === \"bun\";\n    }\n    function shouldCaptureRuntimeVersion() {\n        return runtimeInfo.name === \"node\" || runtimeInfo.name === \"deno\" || runtimeInfo.name === \"bun\";\n    }\n    function createRuntimeMeta(info) {\n        if (info.name === \"browser\" || info.name === \"worker\") {\n            return {\n                runtime: info.name,\n                browser: info.userAgent,\n            };\n        }\n        const metaStatic = {\n            runtime: info.name,\n        };\n        if (shouldCaptureRuntimeVersion()) {\n            metaStatic.runtimeVersion = info.version ?? \"unknown\";\n        }\n        if (shouldCaptureHostname()) {\n            metaStatic.hostname = info.hostname ?? \"unknown\";\n        }\n        return metaStatic;\n    }\n    function formatWithOptionsSafe(options, args) {\n        try {\n            return (0, util_inspect_polyfill_js_1.formatWithOptions)(options, ...args);\n        }\n        catch {\n            return args.map(stringifyFallback).join(\" \");\n        }\n    }\n    function stringifyFallback(value) {\n        if (typeof value === \"string\") {\n            return value;\n        }\n        try {\n            return JSON.stringify(value);\n        }\n        catch {\n            return String(value);\n        }\n    }\n    function normalizeFilePath(value) {\n        if (typeof value !== \"string\" || value.length === 0) {\n            return value;\n        }\n        const replaced = value.replace(/\\\\+/g, \"\\\\\").replace(/\\\\/g, \"/\");\n        const hasRootDoubleSlash = replaced.startsWith(\"//\");\n        const hasLeadingSlash = replaced.startsWith(\"/\") && !hasRootDoubleSlash;\n        const driveMatch = replaced.match(/^[A-Za-z]:/);\n        const drivePrefix = driveMatch ? driveMatch[0] : \"\";\n        const withoutDrive = drivePrefix ? replaced.slice(drivePrefix.length) : replaced;\n        const segments = withoutDrive.split(\"/\");\n        const normalizedSegments = [];\n        for (const segment of segments) {\n            if (segment === \"\" || segment === \".\") {\n                continue;\n            }\n            if (segment === \"..\") {\n                if (normalizedSegments.length > 0) {\n                    normalizedSegments.pop();\n                }\n                continue;\n            }\n            normalizedSegments.push(segment);\n        }\n        let normalized = normalizedSegments.join(\"/\");\n        if (hasRootDoubleSlash) {\n            normalized = `//${normalized}`;\n        }\n        else if (hasLeadingSlash) {\n            normalized = `/${normalized}`;\n        }\n        else if (drivePrefix !== \"\") {\n            normalized = `${drivePrefix}${normalized.length > 0 ? `/${normalized}` : \"\"}`;\n        }\n        if (normalized.length === 0) {\n            return value;\n        }\n        return normalized;\n    }\n    function detectRuntimeInfo() {\n        if ((0, environment_js_1.isBrowserEnvironment)()) {\n            const navigatorObj = globalThis.navigator;\n            return {\n                name: \"browser\",\n                userAgent: navigatorObj?.userAgent,\n            };\n        }\n        const globalScope = globalThis;\n        if (typeof globalScope.importScripts === \"function\") {\n            return {\n                name: \"worker\",\n                userAgent: globalScope.navigator?.userAgent,\n            };\n        }\n        const globalAny = globalThis;\n        if (globalAny.Bun != null) {\n            const bunVersion = globalAny.Bun.version;\n            return {\n                name: \"bun\",\n                version: bunVersion != null ? `bun/${bunVersion}` : undefined,\n                hostname: getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        if (globalAny.Deno != null) {\n            const denoHostname = resolveDenoHostname(globalAny.Deno);\n            const denoVersion = globalAny.Deno?.version?.deno;\n            return {\n                name: \"deno\",\n                version: denoVersion != null ? `deno/${denoVersion}` : undefined,\n                hostname: denoHostname ?? getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        if (globalAny.process?.versions?.node != null || globalAny.process?.version != null) {\n            return {\n                name: \"node\",\n                version: globalAny.process?.versions?.node ?? globalAny.process?.version,\n                hostname: getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        if (globalAny.process != null) {\n            return {\n                name: \"node\",\n                version: \"unknown\",\n                hostname: getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        return {\n            name: \"unknown\",\n        };\n    }\n    function getEnvironmentHostname(nodeProcess, deno, bun, location) {\n        const processHostname = nodeProcess?.env?.HOSTNAME ?? nodeProcess?.env?.HOST ?? nodeProcess?.env?.COMPUTERNAME;\n        if (processHostname != null && processHostname.length > 0) {\n            return processHostname;\n        }\n        const bunHostname = bun?.env?.HOSTNAME ?? bun?.env?.HOST ?? bun?.env?.COMPUTERNAME;\n        if (bunHostname != null && bunHostname.length > 0) {\n            return bunHostname;\n        }\n        try {\n            const denoEnvGet = deno?.env?.get;\n            if (typeof denoEnvGet === \"function\") {\n                const value = denoEnvGet(\"HOSTNAME\");\n                if (value != null && value.length > 0) {\n                    return value;\n                }\n            }\n        }\n        catch {\n        }\n        if (location?.hostname != null && location.hostname.length > 0) {\n            return location.hostname;\n        }\n        return undefined;\n    }\n    function resolveDenoHostname(deno) {\n        try {\n            if (typeof deno?.hostname === \"function\") {\n                const value = deno.hostname();\n                if (value != null && value.length > 0) {\n                    return value;\n                }\n            }\n        }\n        catch {\n        }\n        const locationHostname = globalThis.location?.hostname;\n        if (locationHostname != null && locationHostname.length > 0) {\n            return locationHostname;\n        }\n        return undefined;\n    }\n    function getNodeEnv() {\n        const globalProcess = globalThis?.process;\n        return globalProcess?.env?.NODE_ENV;\n    }\n    function isNativeError(value) {\n        if (value instanceof Error) {\n            return true;\n        }\n        if (value != null && typeof value === \"object\") {\n            const objectTag = Object.prototype.toString.call(value);\n            if (/\\[object .*Error\\]/.test(objectTag)) {\n                return true;\n            }\n            const name = value.name;\n            if (typeof name === \"string\" && name.endsWith(\"Error\")) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\nconst ANSI_REGEX = /\\u001b\\[[0-9;]*m/g;\nconst COLOR_TOKENS = {\n    black: \"#000000\",\n    red: \"#ef5350\",\n    green: \"#66bb6a\",\n    yellow: \"#fdd835\",\n    blue: \"#42a5f5\",\n    magenta: \"#ab47bc\",\n    cyan: \"#26c6da\",\n    white: \"#fafafa\",\n    blackBright: \"#424242\",\n    redBright: \"#ff7043\",\n    greenBright: \"#81c784\",\n    yellowBright: \"#ffe082\",\n    blueBright: \"#64b5f6\",\n    magentaBright: \"#ce93d8\",\n    cyanBright: \"#4dd0e1\",\n    whiteBright: \"#ffffff\",\n};\nconst BACKGROUND_TOKENS = {\n    bgBlack: \"#000000\",\n    bgRed: \"#ef5350\",\n    bgGreen: \"#66bb6a\",\n    bgYellow: \"#fdd835\",\n    bgBlue: \"#42a5f5\",\n    bgMagenta: \"#ab47bc\",\n    bgCyan: \"#26c6da\",\n    bgWhite: \"#fafafa\",\n    bgBlackBright: \"#424242\",\n    bgRedBright: \"#ff7043\",\n    bgGreenBright: \"#81c784\",\n    bgYellowBright: \"#ffe082\",\n    bgBlueBright: \"#64b5f6\",\n    bgMagentaBright: \"#ce93d8\",\n    bgCyanBright: \"#4dd0e1\",\n    bgWhiteBright: \"#ffffff\",\n};\nconst BROWSER_PATH_REGEX = /(?:(?:file|https?|global code|[^@]+)@)?(?:file:)?((?:\\/[^:/]+){2,})(?::(\\d+))?(?::(\\d+))?/;\nconst runtime = createLoggerEnvironment();\nexports.loggerEnvironment = runtime;\n__exportStar(require(\"./interfaces.js\"), exports);\nclass BaseLogger {\n    constructor(settings, logObj, stackDepthLevel = Number.NaN) {\n        this.logObj = logObj;\n        this.stackDepthLevel = stackDepthLevel;\n        this.runtime = runtime;\n        this.maxErrorCauseDepth = 5;\n        this.settings = {\n            type: settings?.type ?? \"pretty\",\n            name: settings?.name,\n            parentNames: settings?.parentNames,\n            minLevel: settings?.minLevel ?? 0,\n            argumentsArrayName: settings?.argumentsArrayName,\n            hideLogPositionForProduction: settings?.hideLogPositionForProduction ?? false,\n            prettyLogTemplate: settings?.prettyLogTemplate ??\n                \"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}\\t{{logLevelName}}\\t{{filePathWithLine}}{{nameWithDelimiterPrefix}}\\t\",\n            prettyErrorTemplate: settings?.prettyErrorTemplate ?? \"\\n{{errorName}} {{errorMessage}}\\nerror stack:\\n{{errorStack}}\",\n            prettyErrorStackTemplate: settings?.prettyErrorStackTemplate ?? \"   {{fileName}}\\t{{method}}\\n\\t{{filePathWithLine}}\",\n            prettyErrorParentNamesSeparator: settings?.prettyErrorParentNamesSeparator ?? \":\",\n            prettyErrorLoggerNameDelimiter: settings?.prettyErrorLoggerNameDelimiter ?? \"\\t\",\n            stylePrettyLogs: settings?.stylePrettyLogs ?? true,\n            prettyLogTimeZone: settings?.prettyLogTimeZone ?? \"UTC\",\n            prettyLogStyles: settings?.prettyLogStyles ?? {\n                logLevelName: {\n                    \"*\": [\"bold\", \"black\", \"bgWhiteBright\", \"dim\"],\n                    SILLY: [\"bold\", \"white\"],\n                    TRACE: [\"bold\", \"whiteBright\"],\n                    DEBUG: [\"bold\", \"green\"],\n                    INFO: [\"bold\", \"blue\"],\n                    WARN: [\"bold\", \"yellow\"],\n                    ERROR: [\"bold\", \"red\"],\n                    FATAL: [\"bold\", \"redBright\"],\n                },\n                dateIsoStr: \"white\",\n                filePathWithLine: \"white\",\n                name: [\"white\", \"bold\"],\n                nameWithDelimiterPrefix: [\"white\", \"bold\"],\n                nameWithDelimiterSuffix: [\"white\", \"bold\"],\n                errorName: [\"bold\", \"bgRedBright\", \"whiteBright\"],\n                fileName: [\"yellow\"],\n                fileNameWithLine: \"white\",\n            },\n            prettyInspectOptions: settings?.prettyInspectOptions ?? {\n                colors: true,\n                compact: false,\n                depth: Infinity,\n            },\n            metaProperty: settings?.metaProperty ?? \"_meta\",\n            maskPlaceholder: settings?.maskPlaceholder ?? \"[***]\",\n            maskValuesOfKeys: settings?.maskValuesOfKeys ?? [\"password\"],\n            maskValuesOfKeysCaseInsensitive: settings?.maskValuesOfKeysCaseInsensitive ?? false,\n            maskValuesRegEx: settings?.maskValuesRegEx,\n            prefix: [...(settings?.prefix ?? [])],\n            attachedTransports: [...(settings?.attachedTransports ?? [])],\n            overwrite: {\n                mask: settings?.overwrite?.mask,\n                toLogObj: settings?.overwrite?.toLogObj,\n                addMeta: settings?.overwrite?.addMeta,\n                addPlaceholders: settings?.overwrite?.addPlaceholders,\n                formatMeta: settings?.overwrite?.formatMeta,\n                formatLogObj: settings?.overwrite?.formatLogObj,\n                transportFormatted: settings?.overwrite?.transportFormatted,\n                transportJSON: settings?.overwrite?.transportJSON,\n            },\n        };\n        this.captureStackForMeta = this._shouldCaptureStack();\n    }\n    log(logLevelId, logLevelName, ...args) {\n        if (logLevelId < this.settings.minLevel) {\n            return;\n        }\n        const resolvedArgs = this._resolveLogArguments(args);\n        const logArgs = [...this.settings.prefix, ...resolvedArgs];\n        const maskedArgs = this.settings.overwrite?.mask != null\n            ? this.settings.overwrite?.mask(logArgs)\n            : this.settings.maskValuesOfKeys != null && this.settings.maskValuesOfKeys.length > 0\n                ? this._mask(logArgs)\n                : logArgs;\n        const thisLogObj = this.logObj != null ? this._recursiveCloneAndExecuteFunctions(this.logObj) : undefined;\n        const logObj = this.settings.overwrite?.toLogObj != null ? this.settings.overwrite?.toLogObj(maskedArgs, thisLogObj) : this._toLogObj(maskedArgs, thisLogObj);\n        const logObjWithMeta = this.settings.overwrite?.addMeta != null\n            ? this.settings.overwrite?.addMeta(logObj, logLevelId, logLevelName)\n            : this._addMetaToLogObj(logObj, logLevelId, logLevelName);\n        const logMeta = logObjWithMeta?.[this.settings.metaProperty];\n        let logMetaMarkup;\n        let logArgsAndErrorsMarkup = undefined;\n        if (this.settings.overwrite?.formatMeta != null) {\n            logMetaMarkup = this.settings.overwrite?.formatMeta(logObjWithMeta?.[this.settings.metaProperty]);\n        }\n        if (this.settings.overwrite?.formatLogObj != null) {\n            logArgsAndErrorsMarkup = this.settings.overwrite?.formatLogObj(maskedArgs, this.settings);\n        }\n        if (this.settings.type === \"pretty\") {\n            logMetaMarkup = logMetaMarkup ?? this._prettyFormatLogObjMeta(logObjWithMeta?.[this.settings.metaProperty]);\n            logArgsAndErrorsMarkup = logArgsAndErrorsMarkup ?? runtime.prettyFormatLogObj(maskedArgs, this.settings);\n        }\n        if (logMetaMarkup != null && logArgsAndErrorsMarkup != null) {\n            if (this.settings.overwrite?.transportFormatted != null) {\n                const transport = this.settings.overwrite.transportFormatted;\n                const declaredParams = transport.length;\n                if (declaredParams < 4) {\n                    transport(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors);\n                }\n                else if (declaredParams === 4) {\n                    transport(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors, logMeta);\n                }\n                else {\n                    transport(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors, logMeta, this.settings);\n                }\n            }\n            else {\n                runtime.transportFormatted(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors, logMeta, this.settings);\n            }\n        }\n        else {\n            if (this.settings.overwrite?.transportJSON != null) {\n                this.settings.overwrite.transportJSON(logObjWithMeta);\n            }\n            else if (this.settings.type !== \"hidden\") {\n                runtime.transportJSON(logObjWithMeta);\n            }\n        }\n        if (this.settings.attachedTransports != null && this.settings.attachedTransports.length > 0) {\n            this.settings.attachedTransports.forEach((transportLogger) => {\n                transportLogger(logObjWithMeta);\n            });\n        }\n        return logObjWithMeta;\n    }\n    attachTransport(transportLogger) {\n        this.settings.attachedTransports.push(transportLogger);\n    }\n    getSubLogger(settings, logObj) {\n        const subLoggerSettings = {\n            ...this.settings,\n            ...settings,\n            parentNames: this.settings?.parentNames != null && this.settings?.name != null\n                ? [...this.settings.parentNames, this.settings.name]\n                : this.settings?.name != null\n                    ? [this.settings.name]\n                    : undefined,\n            prefix: [...this.settings.prefix, ...(settings?.prefix ?? [])],\n        };\n        const subLogger = new this.constructor(subLoggerSettings, logObj ?? this.logObj, this.stackDepthLevel);\n        return subLogger;\n    }\n    _mask(args) {\n        const maskKeys = this._getMaskKeys();\n        return args?.map((arg) => {\n            return this._recursiveCloneAndMaskValuesOfKeys(arg, maskKeys);\n        });\n    }\n    _getMaskKeys() {\n        const maskKeys = this.settings.maskValuesOfKeys ?? [];\n        const signature = maskKeys.map(String).join(\"|\");\n        if (this.settings.maskValuesOfKeysCaseInsensitive === true) {\n            if (this.maskKeysCache?.source === maskKeys && this.maskKeysCache.caseInsensitive === true && this.maskKeysCache.signature === signature) {\n                return this.maskKeysCache.normalized;\n            }\n            const normalized = maskKeys.map((key) => (typeof key === \"string\" ? key.toLowerCase() : String(key).toLowerCase()));\n            this.maskKeysCache = {\n                source: maskKeys,\n                caseInsensitive: true,\n                normalized,\n                signature,\n            };\n            return normalized;\n        }\n        this.maskKeysCache = {\n            source: maskKeys,\n            caseInsensitive: false,\n            normalized: maskKeys,\n            signature,\n        };\n        return maskKeys;\n    }\n    _resolveLogArguments(args) {\n        if (args.length === 1 && typeof args[0] === \"function\") {\n            const candidate = args[0];\n            if (candidate.length === 0) {\n                const result = candidate();\n                return Array.isArray(result) ? result : [result];\n            }\n        }\n        return args;\n    }\n    _recursiveCloneAndMaskValuesOfKeys(source, keys, seen = []) {\n        if (seen.includes(source)) {\n            return { ...source };\n        }\n        if (typeof source === \"object\" && source !== null) {\n            seen.push(source);\n        }\n        if (runtime.isError(source) || runtime.isBuffer(source)) {\n            return source;\n        }\n        else if (source instanceof Map) {\n            return new Map(source);\n        }\n        else if (source instanceof Set) {\n            return new Set(source);\n        }\n        else if (Array.isArray(source)) {\n            return source.map((item) => this._recursiveCloneAndMaskValuesOfKeys(item, keys, seen));\n        }\n        else if (source instanceof Date) {\n            return new Date(source.getTime());\n        }\n        else if (source instanceof URL) {\n            return (0, urlToObj_js_1.urlToObject)(source);\n        }\n        else if (source !== null && typeof source === \"object\") {\n            const baseObject = runtime.isError(source) ? this._cloneError(source) : Object.create(Object.getPrototypeOf(source));\n            return Object.getOwnPropertyNames(source).reduce((o, prop) => {\n                const lookupKey = this.settings?.maskValuesOfKeysCaseInsensitive !== true\n                    ? prop\n                    : typeof prop === \"string\"\n                        ? prop.toLowerCase()\n                        : String(prop).toLowerCase();\n                o[prop] = keys.includes(lookupKey)\n                    ? this.settings.maskPlaceholder\n                    : (() => {\n                        try {\n                            return this._recursiveCloneAndMaskValuesOfKeys(source[prop], keys, seen);\n                        }\n                        catch {\n                            return null;\n                        }\n                    })();\n                return o;\n            }, baseObject);\n        }\n        else {\n            if (typeof source === \"string\") {\n                let modifiedSource = source;\n                for (const regEx of this.settings?.maskValuesRegEx || []) {\n                    modifiedSource = modifiedSource.replace(regEx, this.settings?.maskPlaceholder || \"\");\n                }\n                return modifiedSource;\n            }\n            return source;\n        }\n    }\n    _recursiveCloneAndExecuteFunctions(source, seen = []) {\n        if (this.isObjectOrArray(source) && seen.includes(source)) {\n            return this.shallowCopy(source);\n        }\n        if (this.isObjectOrArray(source)) {\n            seen.push(source);\n        }\n        if (Array.isArray(source)) {\n            return source.map((item) => this._recursiveCloneAndExecuteFunctions(item, seen));\n        }\n        else if (source instanceof Date) {\n            return new Date(source.getTime());\n        }\n        else if (this.isObject(source)) {\n            return Object.getOwnPropertyNames(source).reduce((o, prop) => {\n                const descriptor = Object.getOwnPropertyDescriptor(source, prop);\n                if (descriptor) {\n                    Object.defineProperty(o, prop, descriptor);\n                    const value = source[prop];\n                    o[prop] = typeof value === \"function\" ? value() : this._recursiveCloneAndExecuteFunctions(value, seen);\n                }\n                return o;\n            }, Object.create(Object.getPrototypeOf(source)));\n        }\n        else {\n            return source;\n        }\n    }\n    isObjectOrArray(value) {\n        return typeof value === \"object\" && value !== null;\n    }\n    isObject(value) {\n        return typeof value === \"object\" && !Array.isArray(value) && value !== null;\n    }\n    shallowCopy(source) {\n        if (Array.isArray(source)) {\n            return [...source];\n        }\n        else {\n            return { ...source };\n        }\n    }\n    _toLogObj(args, clonedLogObj = {}) {\n        args = args?.map((arg) => (runtime.isError(arg) ? this._toErrorObject(arg) : arg));\n        if (this.settings.argumentsArrayName == null) {\n            if (args.length === 1 && !Array.isArray(args[0]) && runtime.isBuffer(args[0]) !== true && !(args[0] instanceof Date)) {\n                clonedLogObj = typeof args[0] === \"object\" && args[0] != null ? { ...args[0], ...clonedLogObj } : { 0: args[0], ...clonedLogObj };\n            }\n            else {\n                clonedLogObj = { ...clonedLogObj, ...args };\n            }\n        }\n        else {\n            clonedLogObj = {\n                ...clonedLogObj,\n                [this.settings.argumentsArrayName]: args,\n            };\n        }\n        return clonedLogObj;\n    }\n    _cloneError(error) {\n        const cloned = new error.constructor();\n        Object.getOwnPropertyNames(error).forEach((key) => {\n            cloned[key] = error[key];\n        });\n        return cloned;\n    }\n    _toErrorObject(error, depth = 0, seen = new Set()) {\n        if (!seen.has(error)) {\n            seen.add(error);\n        }\n        const errorObject = {\n            nativeError: error,\n            name: error.name ?? \"Error\",\n            message: error.message,\n            stack: runtime.getErrorTrace(error),\n        };\n        if (depth >= this.maxErrorCauseDepth) {\n            return errorObject;\n        }\n        const causeValue = error.cause;\n        if (causeValue != null) {\n            const normalizedCause = (0, errorUtils_js_1.toError)(causeValue);\n            if (!seen.has(normalizedCause)) {\n                errorObject.cause = this._toErrorObject(normalizedCause, depth + 1, seen);\n            }\n        }\n        return errorObject;\n    }\n    _addMetaToLogObj(logObj, logLevelId, logLevelName) {\n        return {\n            ...logObj,\n            [this.settings.metaProperty]: runtime.getMeta(logLevelId, logLevelName, this.stackDepthLevel, !this.captureStackForMeta, this.settings.name, this.settings.parentNames),\n        };\n    }\n    _shouldCaptureStack() {\n        if (this.settings.hideLogPositionForProduction) {\n            return false;\n        }\n        if (this.settings.type === \"json\") {\n            return true;\n        }\n        const template = this.settings.prettyLogTemplate ?? \"\";\n        const stackPlaceholders = /{{\\s*(file(Name|Path|Line|PathWithLine|NameWithLine)|fullFilePath)\\s*}}/;\n        if (stackPlaceholders.test(template)) {\n            return true;\n        }\n        return false;\n    }\n    _prettyFormatLogObjMeta(logObjMeta) {\n        return (0, metaFormatting_js_1.buildPrettyMeta)(this.settings, logObjMeta).text;\n    }\n}\nexports.BaseLogger = BaseLogger;\n","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.formatNumberAddZeros = formatNumberAddZeros;\nfunction formatNumberAddZeros(value, digits = 2, addNumber = 0) {\n    if (value != null && isNaN(value)) {\n        return \"\";\n    }\n    value = value != null ? value + addNumber : value;\n    return digits === 2\n        ? value == null\n            ? \"--\"\n            : value < 10\n                ? \"0\" + value\n                : value.toString()\n        : value == null\n            ? \"---\"\n            : value < 10\n                ? \"00\" + value\n                : value < 100\n                    ? \"0\" + value\n                    : value.toString();\n}\n","\"use strict\";\n/**\n * WebSocket message and type definitions for Eufy Security WebSocket API\n *\n * Contains all message type constants, interfaces, and type definitions for WebSocket communication.\n * Used for type safety and message structure enforcement throughout the client.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MESSAGE_TYPES = void 0;\nexports.MESSAGE_TYPES = {\n    VERSION: \"version\",\n    RESULT: \"result\",\n    EVENT: \"event\",\n};\n//# sourceMappingURL=websocket-types.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.formatTemplate = formatTemplate;\nconst prettyLogStyles_js_1 = require(\"./prettyLogStyles.js\");\nfunction formatTemplate(settings, template, values, hideUnsetPlaceholder = false) {\n    const templateString = String(template);\n    const ansiColorWrap = (placeholderValue, code) => `\\u001b[${code[0]}m${placeholderValue}\\u001b[${code[1]}m`;\n    const styleWrap = (value, style) => {\n        if (style != null && typeof style === \"string\") {\n            return ansiColorWrap(value, prettyLogStyles_js_1.prettyLogStyles[style]);\n        }\n        else if (style != null && Array.isArray(style)) {\n            return style.reduce((prevValue, thisStyle) => styleWrap(prevValue, thisStyle), value);\n        }\n        else {\n            if (style != null && style[value.trim()] != null) {\n                return styleWrap(value, style[value.trim()]);\n            }\n            else if (style != null && style[\"*\"] != null) {\n                return styleWrap(value, style[\"*\"]);\n            }\n            else {\n                return value;\n            }\n        }\n    };\n    const defaultStyle = null;\n    return templateString.replace(/{{(.+?)}}/g, (_, placeholder) => {\n        const value = values[placeholder] != null ? String(values[placeholder]) : hideUnsetPlaceholder ? \"\" : _;\n        return settings.stylePrettyLogs\n            ? styleWrap(value, settings?.prettyLogStyles?.[placeholder] ?? defaultStyle) + ansiColorWrap(\"\", prettyLogStyles_js_1.prettyLogStyles.reset)\n            : value;\n    });\n}\n","'use strict';\n\nconst zlib = require('zlib');\n\nconst bufferUtil = require('./buffer-util');\nconst Limiter = require('./limiter');\nconst { kStatusCode } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\nconst TRAILER = Buffer.from([0x00, 0x00, 0xff, 0xff]);\nconst kPerMessageDeflate = Symbol('permessage-deflate');\nconst kTotalLength = Symbol('total-length');\nconst kCallback = Symbol('callback');\nconst kBuffers = Symbol('buffers');\nconst kError = Symbol('error');\n\n//\n// We limit zlib concurrency, which prevents severe memory fragmentation\n// as documented in https://github.com/nodejs/node/issues/8871#issuecomment-250915913\n// and https://github.com/websockets/ws/issues/1202\n//\n// Intentionally global; it's the global thread pool that's an issue.\n//\nlet zlibLimiter;\n\n/**\n * permessage-deflate implementation.\n */\nclass PerMessageDeflate {\n  /**\n   * Creates a PerMessageDeflate instance.\n   *\n   * @param {Object} [options] Configuration options\n   * @param {(Boolean|Number)} [options.clientMaxWindowBits] Advertise support\n   *     for, or request, a custom client window size\n   * @param {Boolean} [options.clientNoContextTakeover=false] Advertise/\n   *     acknowledge disabling of client context takeover\n   * @param {Number} [options.concurrencyLimit=10] The number of concurrent\n   *     calls to zlib\n   * @param {(Boolean|Number)} [options.serverMaxWindowBits] Request/confirm the\n   *     use of a custom server window size\n   * @param {Boolean} [options.serverNoContextTakeover=false] Request/accept\n   *     disabling of server context takeover\n   * @param {Number} [options.threshold=1024] Size (in bytes) below which\n   *     messages should not be compressed if context takeover is disabled\n   * @param {Object} [options.zlibDeflateOptions] Options to pass to zlib on\n   *     deflate\n   * @param {Object} [options.zlibInflateOptions] Options to pass to zlib on\n   *     inflate\n   * @param {Boolean} [isServer=false] Create the instance in either server or\n   *     client mode\n   * @param {Number} [maxPayload=0] The maximum allowed message length\n   */\n  constructor(options, isServer, maxPayload) {\n    this._maxPayload = maxPayload | 0;\n    this._options = options || {};\n    this._threshold =\n      this._options.threshold !== undefined ? this._options.threshold : 1024;\n    this._isServer = !!isServer;\n    this._deflate = null;\n    this._inflate = null;\n\n    this.params = null;\n\n    if (!zlibLimiter) {\n      const concurrency =\n        this._options.concurrencyLimit !== undefined\n          ? this._options.concurrencyLimit\n          : 10;\n      zlibLimiter = new Limiter(concurrency);\n    }\n  }\n\n  /**\n   * @type {String}\n   */\n  static get extensionName() {\n    return 'permessage-deflate';\n  }\n\n  /**\n   * Create an extension negotiation offer.\n   *\n   * @return {Object} Extension parameters\n   * @public\n   */\n  offer() {\n    const params = {};\n\n    if (this._options.serverNoContextTakeover) {\n      params.server_no_context_takeover = true;\n    }\n    if (this._options.clientNoContextTakeover) {\n      params.client_no_context_takeover = true;\n    }\n    if (this._options.serverMaxWindowBits) {\n      params.server_max_window_bits = this._options.serverMaxWindowBits;\n    }\n    if (this._options.clientMaxWindowBits) {\n      params.client_max_window_bits = this._options.clientMaxWindowBits;\n    } else if (this._options.clientMaxWindowBits == null) {\n      params.client_max_window_bits = true;\n    }\n\n    return params;\n  }\n\n  /**\n   * Accept an extension negotiation offer/response.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Object} Accepted configuration\n   * @public\n   */\n  accept(configurations) {\n    configurations = this.normalizeParams(configurations);\n\n    this.params = this._isServer\n      ? this.acceptAsServer(configurations)\n      : this.acceptAsClient(configurations);\n\n    return this.params;\n  }\n\n  /**\n   * Releases all resources used by the extension.\n   *\n   * @public\n   */\n  cleanup() {\n    if (this._inflate) {\n      this._inflate.close();\n      this._inflate = null;\n    }\n\n    if (this._deflate) {\n      const callback = this._deflate[kCallback];\n\n      this._deflate.close();\n      this._deflate = null;\n\n      if (callback) {\n        callback(\n          new Error(\n            'The deflate stream was closed while data was being processed'\n          )\n        );\n      }\n    }\n  }\n\n  /**\n   *  Accept an extension negotiation offer.\n   *\n   * @param {Array} offers The extension negotiation offers\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsServer(offers) {\n    const opts = this._options;\n    const accepted = offers.find((params) => {\n      if (\n        (opts.serverNoContextTakeover === false &&\n          params.server_no_context_takeover) ||\n        (params.server_max_window_bits &&\n          (opts.serverMaxWindowBits === false ||\n            (typeof opts.serverMaxWindowBits === 'number' &&\n              opts.serverMaxWindowBits > params.server_max_window_bits))) ||\n        (typeof opts.clientMaxWindowBits === 'number' &&\n          !params.client_max_window_bits)\n      ) {\n        return false;\n      }\n\n      return true;\n    });\n\n    if (!accepted) {\n      throw new Error('None of the extension offers can be accepted');\n    }\n\n    if (opts.serverNoContextTakeover) {\n      accepted.server_no_context_takeover = true;\n    }\n    if (opts.clientNoContextTakeover) {\n      accepted.client_no_context_takeover = true;\n    }\n    if (typeof opts.serverMaxWindowBits === 'number') {\n      accepted.server_max_window_bits = opts.serverMaxWindowBits;\n    }\n    if (typeof opts.clientMaxWindowBits === 'number') {\n      accepted.client_max_window_bits = opts.clientMaxWindowBits;\n    } else if (\n      accepted.client_max_window_bits === true ||\n      opts.clientMaxWindowBits === false\n    ) {\n      delete accepted.client_max_window_bits;\n    }\n\n    return accepted;\n  }\n\n  /**\n   * Accept the extension negotiation response.\n   *\n   * @param {Array} response The extension negotiation response\n   * @return {Object} Accepted configuration\n   * @private\n   */\n  acceptAsClient(response) {\n    const params = response[0];\n\n    if (\n      this._options.clientNoContextTakeover === false &&\n      params.client_no_context_takeover\n    ) {\n      throw new Error('Unexpected parameter \"client_no_context_takeover\"');\n    }\n\n    if (!params.client_max_window_bits) {\n      if (typeof this._options.clientMaxWindowBits === 'number') {\n        params.client_max_window_bits = this._options.clientMaxWindowBits;\n      }\n    } else if (\n      this._options.clientMaxWindowBits === false ||\n      (typeof this._options.clientMaxWindowBits === 'number' &&\n        params.client_max_window_bits > this._options.clientMaxWindowBits)\n    ) {\n      throw new Error(\n        'Unexpected or invalid parameter \"client_max_window_bits\"'\n      );\n    }\n\n    return params;\n  }\n\n  /**\n   * Normalize parameters.\n   *\n   * @param {Array} configurations The extension negotiation offers/reponse\n   * @return {Array} The offers/response with normalized parameters\n   * @private\n   */\n  normalizeParams(configurations) {\n    configurations.forEach((params) => {\n      Object.keys(params).forEach((key) => {\n        let value = params[key];\n\n        if (value.length > 1) {\n          throw new Error(`Parameter \"${key}\" must have only a single value`);\n        }\n\n        value = value[0];\n\n        if (key === 'client_max_window_bits') {\n          if (value !== true) {\n            const num = +value;\n            if (!Number.isInteger(num) || num < 8 || num > 15) {\n              throw new TypeError(\n                `Invalid value for parameter \"${key}\": ${value}`\n              );\n            }\n            value = num;\n          } else if (!this._isServer) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else if (key === 'server_max_window_bits') {\n          const num = +value;\n          if (!Number.isInteger(num) || num < 8 || num > 15) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n          value = num;\n        } else if (\n          key === 'client_no_context_takeover' ||\n          key === 'server_no_context_takeover'\n        ) {\n          if (value !== true) {\n            throw new TypeError(\n              `Invalid value for parameter \"${key}\": ${value}`\n            );\n          }\n        } else {\n          throw new Error(`Unknown parameter \"${key}\"`);\n        }\n\n        params[key] = value;\n      });\n    });\n\n    return configurations;\n  }\n\n  /**\n   * Decompress data. Concurrency limited.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  decompress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._decompress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Compress data. Concurrency limited.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @public\n   */\n  compress(data, fin, callback) {\n    zlibLimiter.add((done) => {\n      this._compress(data, fin, (err, result) => {\n        done();\n        callback(err, result);\n      });\n    });\n  }\n\n  /**\n   * Decompress data.\n   *\n   * @param {Buffer} data Compressed data\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _decompress(data, fin, callback) {\n    const endpoint = this._isServer ? 'client' : 'server';\n\n    if (!this._inflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._inflate = zlib.createInflateRaw({\n        ...this._options.zlibInflateOptions,\n        windowBits\n      });\n      this._inflate[kPerMessageDeflate] = this;\n      this._inflate[kTotalLength] = 0;\n      this._inflate[kBuffers] = [];\n      this._inflate.on('error', inflateOnError);\n      this._inflate.on('data', inflateOnData);\n    }\n\n    this._inflate[kCallback] = callback;\n\n    this._inflate.write(data);\n    if (fin) this._inflate.write(TRAILER);\n\n    this._inflate.flush(() => {\n      const err = this._inflate[kError];\n\n      if (err) {\n        this._inflate.close();\n        this._inflate = null;\n        callback(err);\n        return;\n      }\n\n      const data = bufferUtil.concat(\n        this._inflate[kBuffers],\n        this._inflate[kTotalLength]\n      );\n\n      if (this._inflate._readableState.endEmitted) {\n        this._inflate.close();\n        this._inflate = null;\n      } else {\n        this._inflate[kTotalLength] = 0;\n        this._inflate[kBuffers] = [];\n\n        if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n          this._inflate.reset();\n        }\n      }\n\n      callback(null, data);\n    });\n  }\n\n  /**\n   * Compress data.\n   *\n   * @param {(Buffer|String)} data Data to compress\n   * @param {Boolean} fin Specifies whether or not this is the last fragment\n   * @param {Function} callback Callback\n   * @private\n   */\n  _compress(data, fin, callback) {\n    const endpoint = this._isServer ? 'server' : 'client';\n\n    if (!this._deflate) {\n      const key = `${endpoint}_max_window_bits`;\n      const windowBits =\n        typeof this.params[key] !== 'number'\n          ? zlib.Z_DEFAULT_WINDOWBITS\n          : this.params[key];\n\n      this._deflate = zlib.createDeflateRaw({\n        ...this._options.zlibDeflateOptions,\n        windowBits\n      });\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      this._deflate.on('data', deflateOnData);\n    }\n\n    this._deflate[kCallback] = callback;\n\n    this._deflate.write(data);\n    this._deflate.flush(zlib.Z_SYNC_FLUSH, () => {\n      if (!this._deflate) {\n        //\n        // The deflate stream was closed while data was being processed.\n        //\n        return;\n      }\n\n      let data = bufferUtil.concat(\n        this._deflate[kBuffers],\n        this._deflate[kTotalLength]\n      );\n\n      if (fin) {\n        data = new FastBuffer(data.buffer, data.byteOffset, data.length - 4);\n      }\n\n      //\n      // Ensure that the callback will not be called again in\n      // `PerMessageDeflate#cleanup()`.\n      //\n      this._deflate[kCallback] = null;\n\n      this._deflate[kTotalLength] = 0;\n      this._deflate[kBuffers] = [];\n\n      if (fin && this.params[`${endpoint}_no_context_takeover`]) {\n        this._deflate.reset();\n      }\n\n      callback(null, data);\n    });\n  }\n}\n\nmodule.exports = PerMessageDeflate;\n\n/**\n * The listener of the `zlib.DeflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction deflateOnData(chunk) {\n  this[kBuffers].push(chunk);\n  this[kTotalLength] += chunk.length;\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction inflateOnData(chunk) {\n  this[kTotalLength] += chunk.length;\n\n  if (\n    this[kPerMessageDeflate]._maxPayload < 1 ||\n    this[kTotalLength] <= this[kPerMessageDeflate]._maxPayload\n  ) {\n    this[kBuffers].push(chunk);\n    return;\n  }\n\n  this[kError] = new RangeError('Max payload size exceeded');\n  this[kError].code = 'WS_ERR_UNSUPPORTED_MESSAGE_LENGTH';\n  this[kError][kStatusCode] = 1009;\n  this.removeListener('data', inflateOnData);\n\n  //\n  // The choice to employ `zlib.reset()` over `zlib.close()` is dictated by the\n  // fact that in Node.js versions prior to 13.10.0, the callback for\n  // `zlib.flush()` is not called if `zlib.close()` is used. Utilizing\n  // `zlib.reset()` ensures that either the callback is invoked or an error is\n  // emitted.\n  //\n  this.reset();\n}\n\n/**\n * The listener of the `zlib.InflateRaw` stream `'error'` event.\n *\n * @param {Error} err The emitted error\n * @private\n */\nfunction inflateOnError(err) {\n  //\n  // There is no need to call `Zlib#close()` as the handle is automatically\n  // closed when an error is emitted.\n  //\n  this[kPerMessageDeflate]._inflate = null;\n\n  if (this[kError]) {\n    this[kCallback](this[kError]);\n    return;\n  }\n\n  err[kStatusCode] = 1007;\n  this[kCallback](err);\n}\n","module.exports = require(\"crypto\");","module.exports = require(\"url\");","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Logger = void 0;\nconst BaseLogger_js_1 = require(\"./BaseLogger.js\");\n__exportStar(require(\"./interfaces.js\"), exports);\n__exportStar(require(\"./BaseLogger.js\"), exports);\nclass Logger extends BaseLogger_js_1.BaseLogger {\n    constructor(settings, logObj) {\n        const isBrowser = typeof window !== \"undefined\" && typeof document !== \"undefined\";\n        const normalizedSettings = { ...(settings ?? {}) };\n        if (isBrowser) {\n            normalizedSettings.stylePrettyLogs = settings?.stylePrettyLogs ?? true;\n        }\n        super(normalizedSettings, logObj, Number.NaN);\n    }\n    log(logLevelId, logLevelName, ...args) {\n        return super.log(logLevelId, logLevelName, ...args);\n    }\n    silly(...args) {\n        return super.log(0, \"SILLY\", ...args);\n    }\n    trace(...args) {\n        return super.log(1, \"TRACE\", ...args);\n    }\n    debug(...args) {\n        return super.log(2, \"DEBUG\", ...args);\n    }\n    info(...args) {\n        return super.log(3, \"INFO\", ...args);\n    }\n    warn(...args) {\n        return super.log(4, \"WARN\", ...args);\n    }\n    error(...args) {\n        return super.log(5, \"ERROR\", ...args);\n    }\n    fatal(...args) {\n        return super.log(6, \"FATAL\", ...args);\n    }\n    getSubLogger(settings, logObj) {\n        return super.getSubLogger(settings, logObj);\n    }\n}\nexports.Logger = Logger;\n","/* eslint no-unused-vars: [\"error\", { \"varsIgnorePattern\": \"^Duplex|Readable$\", \"caughtErrors\": \"none\" }] */\n\n'use strict';\n\nconst EventEmitter = require('events');\nconst https = require('https');\nconst http = require('http');\nconst net = require('net');\nconst tls = require('tls');\nconst { randomBytes, createHash } = require('crypto');\nconst { Duplex, Readable } = require('stream');\nconst { URL } = require('url');\n\nconst PerMessageDeflate = require('./permessage-deflate');\nconst Receiver = require('./receiver');\nconst Sender = require('./sender');\nconst { isBlob } = require('./validation');\n\nconst {\n  BINARY_TYPES,\n  EMPTY_BUFFER,\n  GUID,\n  kForOnEventAttribute,\n  kListener,\n  kStatusCode,\n  kWebSocket,\n  NOOP\n} = require('./constants');\nconst {\n  EventTarget: { addEventListener, removeEventListener }\n} = require('./event-target');\nconst { format, parse } = require('./extension');\nconst { toBuffer } = require('./buffer-util');\n\nconst closeTimeout = 30 * 1000;\nconst kAborted = Symbol('kAborted');\nconst protocolVersions = [8, 13];\nconst readyStates = ['CONNECTING', 'OPEN', 'CLOSING', 'CLOSED'];\nconst subprotocolRegex = /^[!#$%&'*+\\-.0-9A-Z^_`|a-z~]+$/;\n\n/**\n * Class representing a WebSocket.\n *\n * @extends EventEmitter\n */\nclass WebSocket extends EventEmitter {\n  /**\n   * Create a new `WebSocket`.\n   *\n   * @param {(String|URL)} address The URL to which to connect\n   * @param {(String|String[])} [protocols] The subprotocols\n   * @param {Object} [options] Connection options\n   */\n  constructor(address, protocols, options) {\n    super();\n\n    this._binaryType = BINARY_TYPES[0];\n    this._closeCode = 1006;\n    this._closeFrameReceived = false;\n    this._closeFrameSent = false;\n    this._closeMessage = EMPTY_BUFFER;\n    this._closeTimer = null;\n    this._errorEmitted = false;\n    this._extensions = {};\n    this._paused = false;\n    this._protocol = '';\n    this._readyState = WebSocket.CONNECTING;\n    this._receiver = null;\n    this._sender = null;\n    this._socket = null;\n\n    if (address !== null) {\n      this._bufferedAmount = 0;\n      this._isServer = false;\n      this._redirects = 0;\n\n      if (protocols === undefined) {\n        protocols = [];\n      } else if (!Array.isArray(protocols)) {\n        if (typeof protocols === 'object' && protocols !== null) {\n          options = protocols;\n          protocols = [];\n        } else {\n          protocols = [protocols];\n        }\n      }\n\n      initAsClient(this, address, protocols, options);\n    } else {\n      this._autoPong = options.autoPong;\n      this._isServer = true;\n    }\n  }\n\n  /**\n   * For historical reasons, the custom \"nodebuffer\" type is used by the default\n   * instead of \"blob\".\n   *\n   * @type {String}\n   */\n  get binaryType() {\n    return this._binaryType;\n  }\n\n  set binaryType(type) {\n    if (!BINARY_TYPES.includes(type)) return;\n\n    this._binaryType = type;\n\n    //\n    // Allow to change `binaryType` on the fly.\n    //\n    if (this._receiver) this._receiver._binaryType = type;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get bufferedAmount() {\n    if (!this._socket) return this._bufferedAmount;\n\n    return this._socket._writableState.length + this._sender._bufferedBytes;\n  }\n\n  /**\n   * @type {String}\n   */\n  get extensions() {\n    return Object.keys(this._extensions).join();\n  }\n\n  /**\n   * @type {Boolean}\n   */\n  get isPaused() {\n    return this._paused;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onclose() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onerror() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onopen() {\n    return null;\n  }\n\n  /**\n   * @type {Function}\n   */\n  /* istanbul ignore next */\n  get onmessage() {\n    return null;\n  }\n\n  /**\n   * @type {String}\n   */\n  get protocol() {\n    return this._protocol;\n  }\n\n  /**\n   * @type {Number}\n   */\n  get readyState() {\n    return this._readyState;\n  }\n\n  /**\n   * @type {String}\n   */\n  get url() {\n    return this._url;\n  }\n\n  /**\n   * Set up the socket and the internal resources.\n   *\n   * @param {Duplex} socket The network socket between the server and client\n   * @param {Buffer} head The first packet of the upgraded stream\n   * @param {Object} options Options object\n   * @param {Boolean} [options.allowSynchronousEvents=false] Specifies whether\n   *     any of the `'message'`, `'ping'`, and `'pong'` events can be emitted\n   *     multiple times in the same tick\n   * @param {Function} [options.generateMask] The function used to generate the\n   *     masking key\n   * @param {Number} [options.maxPayload=0] The maximum allowed message size\n   * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n   *     not to skip UTF-8 validation for text and close messages\n   * @private\n   */\n  setSocket(socket, head, options) {\n    const receiver = new Receiver({\n      allowSynchronousEvents: options.allowSynchronousEvents,\n      binaryType: this.binaryType,\n      extensions: this._extensions,\n      isServer: this._isServer,\n      maxPayload: options.maxPayload,\n      skipUTF8Validation: options.skipUTF8Validation\n    });\n\n    const sender = new Sender(socket, this._extensions, options.generateMask);\n\n    this._receiver = receiver;\n    this._sender = sender;\n    this._socket = socket;\n\n    receiver[kWebSocket] = this;\n    sender[kWebSocket] = this;\n    socket[kWebSocket] = this;\n\n    receiver.on('conclude', receiverOnConclude);\n    receiver.on('drain', receiverOnDrain);\n    receiver.on('error', receiverOnError);\n    receiver.on('message', receiverOnMessage);\n    receiver.on('ping', receiverOnPing);\n    receiver.on('pong', receiverOnPong);\n\n    sender.onerror = senderOnError;\n\n    //\n    // These methods may not be available if `socket` is just a `Duplex`.\n    //\n    if (socket.setTimeout) socket.setTimeout(0);\n    if (socket.setNoDelay) socket.setNoDelay();\n\n    if (head.length > 0) socket.unshift(head);\n\n    socket.on('close', socketOnClose);\n    socket.on('data', socketOnData);\n    socket.on('end', socketOnEnd);\n    socket.on('error', socketOnError);\n\n    this._readyState = WebSocket.OPEN;\n    this.emit('open');\n  }\n\n  /**\n   * Emit the `'close'` event.\n   *\n   * @private\n   */\n  emitClose() {\n    if (!this._socket) {\n      this._readyState = WebSocket.CLOSED;\n      this.emit('close', this._closeCode, this._closeMessage);\n      return;\n    }\n\n    if (this._extensions[PerMessageDeflate.extensionName]) {\n      this._extensions[PerMessageDeflate.extensionName].cleanup();\n    }\n\n    this._receiver.removeAllListeners();\n    this._readyState = WebSocket.CLOSED;\n    this.emit('close', this._closeCode, this._closeMessage);\n  }\n\n  /**\n   * Start a closing handshake.\n   *\n   *          +----------+   +-----------+   +----------+\n   *     - - -|ws.close()|-->|close frame|-->|ws.close()|- - -\n   *    |     +----------+   +-----------+   +----------+     |\n   *          +----------+   +-----------+         |\n   * CLOSING  |ws.close()|<--|close frame|<--+-----+       CLOSING\n   *          +----------+   +-----------+   |\n   *    |           |                        |   +---+        |\n   *                +------------------------+-->|fin| - - - -\n   *    |         +---+                      |   +---+\n   *     - - - - -|fin|<---------------------+\n   *              +---+\n   *\n   * @param {Number} [code] Status code explaining why the connection is closing\n   * @param {(String|Buffer)} [data] The reason why the connection is\n   *     closing\n   * @public\n   */\n  close(code, data) {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this.readyState === WebSocket.CLOSING) {\n      if (\n        this._closeFrameSent &&\n        (this._closeFrameReceived || this._receiver._writableState.errorEmitted)\n      ) {\n        this._socket.end();\n      }\n\n      return;\n    }\n\n    this._readyState = WebSocket.CLOSING;\n    this._sender.close(code, data, !this._isServer, (err) => {\n      //\n      // This error is handled by the `'error'` listener on the socket. We only\n      // want to know if the close frame has been sent here.\n      //\n      if (err) return;\n\n      this._closeFrameSent = true;\n\n      if (\n        this._closeFrameReceived ||\n        this._receiver._writableState.errorEmitted\n      ) {\n        this._socket.end();\n      }\n    });\n\n    setCloseTimer(this);\n  }\n\n  /**\n   * Pause the socket.\n   *\n   * @public\n   */\n  pause() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = true;\n    this._socket.pause();\n  }\n\n  /**\n   * Send a ping.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the ping is sent\n   * @public\n   */\n  ping(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.ping(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Send a pong.\n   *\n   * @param {*} [data] The data to send\n   * @param {Boolean} [mask] Indicates whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when the pong is sent\n   * @public\n   */\n  pong(data, mask, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof data === 'function') {\n      cb = data;\n      data = mask = undefined;\n    } else if (typeof mask === 'function') {\n      cb = mask;\n      mask = undefined;\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    if (mask === undefined) mask = !this._isServer;\n    this._sender.pong(data || EMPTY_BUFFER, mask, cb);\n  }\n\n  /**\n   * Resume the socket.\n   *\n   * @public\n   */\n  resume() {\n    if (\n      this.readyState === WebSocket.CONNECTING ||\n      this.readyState === WebSocket.CLOSED\n    ) {\n      return;\n    }\n\n    this._paused = false;\n    if (!this._receiver._writableState.needDrain) this._socket.resume();\n  }\n\n  /**\n   * Send a data message.\n   *\n   * @param {*} data The message to send\n   * @param {Object} [options] Options object\n   * @param {Boolean} [options.binary] Specifies whether `data` is binary or\n   *     text\n   * @param {Boolean} [options.compress] Specifies whether or not to compress\n   *     `data`\n   * @param {Boolean} [options.fin=true] Specifies whether the fragment is the\n   *     last one\n   * @param {Boolean} [options.mask] Specifies whether or not to mask `data`\n   * @param {Function} [cb] Callback which is executed when data is written out\n   * @public\n   */\n  send(data, options, cb) {\n    if (this.readyState === WebSocket.CONNECTING) {\n      throw new Error('WebSocket is not open: readyState 0 (CONNECTING)');\n    }\n\n    if (typeof options === 'function') {\n      cb = options;\n      options = {};\n    }\n\n    if (typeof data === 'number') data = data.toString();\n\n    if (this.readyState !== WebSocket.OPEN) {\n      sendAfterClose(this, data, cb);\n      return;\n    }\n\n    const opts = {\n      binary: typeof data !== 'string',\n      mask: !this._isServer,\n      compress: true,\n      fin: true,\n      ...options\n    };\n\n    if (!this._extensions[PerMessageDeflate.extensionName]) {\n      opts.compress = false;\n    }\n\n    this._sender.send(data || EMPTY_BUFFER, opts, cb);\n  }\n\n  /**\n   * Forcibly close the connection.\n   *\n   * @public\n   */\n  terminate() {\n    if (this.readyState === WebSocket.CLOSED) return;\n    if (this.readyState === WebSocket.CONNECTING) {\n      const msg = 'WebSocket was closed before the connection was established';\n      abortHandshake(this, this._req, msg);\n      return;\n    }\n\n    if (this._socket) {\n      this._readyState = WebSocket.CLOSING;\n      this._socket.destroy();\n    }\n  }\n}\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} CONNECTING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CONNECTING', {\n  enumerable: true,\n  value: readyStates.indexOf('CONNECTING')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} OPEN\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'OPEN', {\n  enumerable: true,\n  value: readyStates.indexOf('OPEN')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSING\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSING', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSING')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket\n */\nObject.defineProperty(WebSocket, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n/**\n * @constant {Number} CLOSED\n * @memberof WebSocket.prototype\n */\nObject.defineProperty(WebSocket.prototype, 'CLOSED', {\n  enumerable: true,\n  value: readyStates.indexOf('CLOSED')\n});\n\n[\n  'binaryType',\n  'bufferedAmount',\n  'extensions',\n  'isPaused',\n  'protocol',\n  'readyState',\n  'url'\n].forEach((property) => {\n  Object.defineProperty(WebSocket.prototype, property, { enumerable: true });\n});\n\n//\n// Add the `onopen`, `onerror`, `onclose`, and `onmessage` attributes.\n// See https://html.spec.whatwg.org/multipage/comms.html#the-websocket-interface\n//\n['open', 'error', 'close', 'message'].forEach((method) => {\n  Object.defineProperty(WebSocket.prototype, `on${method}`, {\n    enumerable: true,\n    get() {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) return listener[kListener];\n      }\n\n      return null;\n    },\n    set(handler) {\n      for (const listener of this.listeners(method)) {\n        if (listener[kForOnEventAttribute]) {\n          this.removeListener(method, listener);\n          break;\n        }\n      }\n\n      if (typeof handler !== 'function') return;\n\n      this.addEventListener(method, handler, {\n        [kForOnEventAttribute]: true\n      });\n    }\n  });\n});\n\nWebSocket.prototype.addEventListener = addEventListener;\nWebSocket.prototype.removeEventListener = removeEventListener;\n\nmodule.exports = WebSocket;\n\n/**\n * Initialize a WebSocket client.\n *\n * @param {WebSocket} websocket The client to initialize\n * @param {(String|URL)} address The URL to which to connect\n * @param {Array} protocols The subprotocols\n * @param {Object} [options] Connection options\n * @param {Boolean} [options.allowSynchronousEvents=true] Specifies whether any\n *     of the `'message'`, `'ping'`, and `'pong'` events can be emitted multiple\n *     times in the same tick\n * @param {Boolean} [options.autoPong=true] Specifies whether or not to\n *     automatically send a pong in response to a ping\n * @param {Function} [options.finishRequest] A function which can be used to\n *     customize the headers of each http request before it is sent\n * @param {Boolean} [options.followRedirects=false] Whether or not to follow\n *     redirects\n * @param {Function} [options.generateMask] The function used to generate the\n *     masking key\n * @param {Number} [options.handshakeTimeout] Timeout in milliseconds for the\n *     handshake request\n * @param {Number} [options.maxPayload=104857600] The maximum allowed message\n *     size\n * @param {Number} [options.maxRedirects=10] The maximum number of redirects\n *     allowed\n * @param {String} [options.origin] Value of the `Origin` or\n *     `Sec-WebSocket-Origin` header\n * @param {(Boolean|Object)} [options.perMessageDeflate=true] Enable/disable\n *     permessage-deflate\n * @param {Number} [options.protocolVersion=13] Value of the\n *     `Sec-WebSocket-Version` header\n * @param {Boolean} [options.skipUTF8Validation=false] Specifies whether or\n *     not to skip UTF-8 validation for text and close messages\n * @private\n */\nfunction initAsClient(websocket, address, protocols, options) {\n  const opts = {\n    allowSynchronousEvents: true,\n    autoPong: true,\n    protocolVersion: protocolVersions[1],\n    maxPayload: 100 * 1024 * 1024,\n    skipUTF8Validation: false,\n    perMessageDeflate: true,\n    followRedirects: false,\n    maxRedirects: 10,\n    ...options,\n    socketPath: undefined,\n    hostname: undefined,\n    protocol: undefined,\n    timeout: undefined,\n    method: 'GET',\n    host: undefined,\n    path: undefined,\n    port: undefined\n  };\n\n  websocket._autoPong = opts.autoPong;\n\n  if (!protocolVersions.includes(opts.protocolVersion)) {\n    throw new RangeError(\n      `Unsupported protocol version: ${opts.protocolVersion} ` +\n        `(supported versions: ${protocolVersions.join(', ')})`\n    );\n  }\n\n  let parsedUrl;\n\n  if (address instanceof URL) {\n    parsedUrl = address;\n  } else {\n    try {\n      parsedUrl = new URL(address);\n    } catch (e) {\n      throw new SyntaxError(`Invalid URL: ${address}`);\n    }\n  }\n\n  if (parsedUrl.protocol === 'http:') {\n    parsedUrl.protocol = 'ws:';\n  } else if (parsedUrl.protocol === 'https:') {\n    parsedUrl.protocol = 'wss:';\n  }\n\n  websocket._url = parsedUrl.href;\n\n  const isSecure = parsedUrl.protocol === 'wss:';\n  const isIpcUrl = parsedUrl.protocol === 'ws+unix:';\n  let invalidUrlMessage;\n\n  if (parsedUrl.protocol !== 'ws:' && !isSecure && !isIpcUrl) {\n    invalidUrlMessage =\n      'The URL\\'s protocol must be one of \"ws:\", \"wss:\", ' +\n      '\"http:\", \"https:\", or \"ws+unix:\"';\n  } else if (isIpcUrl && !parsedUrl.pathname) {\n    invalidUrlMessage = \"The URL's pathname is empty\";\n  } else if (parsedUrl.hash) {\n    invalidUrlMessage = 'The URL contains a fragment identifier';\n  }\n\n  if (invalidUrlMessage) {\n    const err = new SyntaxError(invalidUrlMessage);\n\n    if (websocket._redirects === 0) {\n      throw err;\n    } else {\n      emitErrorAndClose(websocket, err);\n      return;\n    }\n  }\n\n  const defaultPort = isSecure ? 443 : 80;\n  const key = randomBytes(16).toString('base64');\n  const request = isSecure ? https.request : http.request;\n  const protocolSet = new Set();\n  let perMessageDeflate;\n\n  opts.createConnection =\n    opts.createConnection || (isSecure ? tlsConnect : netConnect);\n  opts.defaultPort = opts.defaultPort || defaultPort;\n  opts.port = parsedUrl.port || defaultPort;\n  opts.host = parsedUrl.hostname.startsWith('[')\n    ? parsedUrl.hostname.slice(1, -1)\n    : parsedUrl.hostname;\n  opts.headers = {\n    ...opts.headers,\n    'Sec-WebSocket-Version': opts.protocolVersion,\n    'Sec-WebSocket-Key': key,\n    Connection: 'Upgrade',\n    Upgrade: 'websocket'\n  };\n  opts.path = parsedUrl.pathname + parsedUrl.search;\n  opts.timeout = opts.handshakeTimeout;\n\n  if (opts.perMessageDeflate) {\n    perMessageDeflate = new PerMessageDeflate(\n      opts.perMessageDeflate !== true ? opts.perMessageDeflate : {},\n      false,\n      opts.maxPayload\n    );\n    opts.headers['Sec-WebSocket-Extensions'] = format({\n      [PerMessageDeflate.extensionName]: perMessageDeflate.offer()\n    });\n  }\n  if (protocols.length) {\n    for (const protocol of protocols) {\n      if (\n        typeof protocol !== 'string' ||\n        !subprotocolRegex.test(protocol) ||\n        protocolSet.has(protocol)\n      ) {\n        throw new SyntaxError(\n          'An invalid or duplicated subprotocol was specified'\n        );\n      }\n\n      protocolSet.add(protocol);\n    }\n\n    opts.headers['Sec-WebSocket-Protocol'] = protocols.join(',');\n  }\n  if (opts.origin) {\n    if (opts.protocolVersion < 13) {\n      opts.headers['Sec-WebSocket-Origin'] = opts.origin;\n    } else {\n      opts.headers.Origin = opts.origin;\n    }\n  }\n  if (parsedUrl.username || parsedUrl.password) {\n    opts.auth = `${parsedUrl.username}:${parsedUrl.password}`;\n  }\n\n  if (isIpcUrl) {\n    const parts = opts.path.split(':');\n\n    opts.socketPath = parts[0];\n    opts.path = parts[1];\n  }\n\n  let req;\n\n  if (opts.followRedirects) {\n    if (websocket._redirects === 0) {\n      websocket._originalIpc = isIpcUrl;\n      websocket._originalSecure = isSecure;\n      websocket._originalHostOrSocketPath = isIpcUrl\n        ? opts.socketPath\n        : parsedUrl.host;\n\n      const headers = options && options.headers;\n\n      //\n      // Shallow copy the user provided options so that headers can be changed\n      // without mutating the original object.\n      //\n      options = { ...options, headers: {} };\n\n      if (headers) {\n        for (const [key, value] of Object.entries(headers)) {\n          options.headers[key.toLowerCase()] = value;\n        }\n      }\n    } else if (websocket.listenerCount('redirect') === 0) {\n      const isSameHost = isIpcUrl\n        ? websocket._originalIpc\n          ? opts.socketPath === websocket._originalHostOrSocketPath\n          : false\n        : websocket._originalIpc\n          ? false\n          : parsedUrl.host === websocket._originalHostOrSocketPath;\n\n      if (!isSameHost || (websocket._originalSecure && !isSecure)) {\n        //\n        // Match curl 7.77.0 behavior and drop the following headers. These\n        // headers are also dropped when following a redirect to a subdomain.\n        //\n        delete opts.headers.authorization;\n        delete opts.headers.cookie;\n\n        if (!isSameHost) delete opts.headers.host;\n\n        opts.auth = undefined;\n      }\n    }\n\n    //\n    // Match curl 7.77.0 behavior and make the first `Authorization` header win.\n    // If the `Authorization` header is set, then there is nothing to do as it\n    // will take precedence.\n    //\n    if (opts.auth && !options.headers.authorization) {\n      options.headers.authorization =\n        'Basic ' + Buffer.from(opts.auth).toString('base64');\n    }\n\n    req = websocket._req = request(opts);\n\n    if (websocket._redirects) {\n      //\n      // Unlike what is done for the `'upgrade'` event, no early exit is\n      // triggered here if the user calls `websocket.close()` or\n      // `websocket.terminate()` from a listener of the `'redirect'` event. This\n      // is because the user can also call `request.destroy()` with an error\n      // before calling `websocket.close()` or `websocket.terminate()` and this\n      // would result in an error being emitted on the `request` object with no\n      // `'error'` event listeners attached.\n      //\n      websocket.emit('redirect', websocket.url, req);\n    }\n  } else {\n    req = websocket._req = request(opts);\n  }\n\n  if (opts.timeout) {\n    req.on('timeout', () => {\n      abortHandshake(websocket, req, 'Opening handshake has timed out');\n    });\n  }\n\n  req.on('error', (err) => {\n    if (req === null || req[kAborted]) return;\n\n    req = websocket._req = null;\n    emitErrorAndClose(websocket, err);\n  });\n\n  req.on('response', (res) => {\n    const location = res.headers.location;\n    const statusCode = res.statusCode;\n\n    if (\n      location &&\n      opts.followRedirects &&\n      statusCode >= 300 &&\n      statusCode < 400\n    ) {\n      if (++websocket._redirects > opts.maxRedirects) {\n        abortHandshake(websocket, req, 'Maximum redirects exceeded');\n        return;\n      }\n\n      req.abort();\n\n      let addr;\n\n      try {\n        addr = new URL(location, address);\n      } catch (e) {\n        const err = new SyntaxError(`Invalid URL: ${location}`);\n        emitErrorAndClose(websocket, err);\n        return;\n      }\n\n      initAsClient(websocket, addr, protocols, options);\n    } else if (!websocket.emit('unexpected-response', req, res)) {\n      abortHandshake(\n        websocket,\n        req,\n        `Unexpected server response: ${res.statusCode}`\n      );\n    }\n  });\n\n  req.on('upgrade', (res, socket, head) => {\n    websocket.emit('upgrade', res);\n\n    //\n    // The user may have closed the connection from a listener of the\n    // `'upgrade'` event.\n    //\n    if (websocket.readyState !== WebSocket.CONNECTING) return;\n\n    req = websocket._req = null;\n\n    const upgrade = res.headers.upgrade;\n\n    if (upgrade === undefined || upgrade.toLowerCase() !== 'websocket') {\n      abortHandshake(websocket, socket, 'Invalid Upgrade header');\n      return;\n    }\n\n    const digest = createHash('sha1')\n      .update(key + GUID)\n      .digest('base64');\n\n    if (res.headers['sec-websocket-accept'] !== digest) {\n      abortHandshake(websocket, socket, 'Invalid Sec-WebSocket-Accept header');\n      return;\n    }\n\n    const serverProt = res.headers['sec-websocket-protocol'];\n    let protError;\n\n    if (serverProt !== undefined) {\n      if (!protocolSet.size) {\n        protError = 'Server sent a subprotocol but none was requested';\n      } else if (!protocolSet.has(serverProt)) {\n        protError = 'Server sent an invalid subprotocol';\n      }\n    } else if (protocolSet.size) {\n      protError = 'Server sent no subprotocol';\n    }\n\n    if (protError) {\n      abortHandshake(websocket, socket, protError);\n      return;\n    }\n\n    if (serverProt) websocket._protocol = serverProt;\n\n    const secWebSocketExtensions = res.headers['sec-websocket-extensions'];\n\n    if (secWebSocketExtensions !== undefined) {\n      if (!perMessageDeflate) {\n        const message =\n          'Server sent a Sec-WebSocket-Extensions header but no extension ' +\n          'was requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      let extensions;\n\n      try {\n        extensions = parse(secWebSocketExtensions);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      const extensionNames = Object.keys(extensions);\n\n      if (\n        extensionNames.length !== 1 ||\n        extensionNames[0] !== PerMessageDeflate.extensionName\n      ) {\n        const message = 'Server indicated an extension that was not requested';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      try {\n        perMessageDeflate.accept(extensions[PerMessageDeflate.extensionName]);\n      } catch (err) {\n        const message = 'Invalid Sec-WebSocket-Extensions header';\n        abortHandshake(websocket, socket, message);\n        return;\n      }\n\n      websocket._extensions[PerMessageDeflate.extensionName] =\n        perMessageDeflate;\n    }\n\n    websocket.setSocket(socket, head, {\n      allowSynchronousEvents: opts.allowSynchronousEvents,\n      generateMask: opts.generateMask,\n      maxPayload: opts.maxPayload,\n      skipUTF8Validation: opts.skipUTF8Validation\n    });\n  });\n\n  if (opts.finishRequest) {\n    opts.finishRequest(req, websocket);\n  } else {\n    req.end();\n  }\n}\n\n/**\n * Emit the `'error'` and `'close'` events.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {Error} The error to emit\n * @private\n */\nfunction emitErrorAndClose(websocket, err) {\n  websocket._readyState = WebSocket.CLOSING;\n  //\n  // The following assignment is practically useless and is done only for\n  // consistency.\n  //\n  websocket._errorEmitted = true;\n  websocket.emit('error', err);\n  websocket.emitClose();\n}\n\n/**\n * Create a `net.Socket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {net.Socket} The newly created socket used to start the connection\n * @private\n */\nfunction netConnect(options) {\n  options.path = options.socketPath;\n  return net.connect(options);\n}\n\n/**\n * Create a `tls.TLSSocket` and initiate a connection.\n *\n * @param {Object} options Connection options\n * @return {tls.TLSSocket} The newly created socket used to start the connection\n * @private\n */\nfunction tlsConnect(options) {\n  options.path = undefined;\n\n  if (!options.servername && options.servername !== '') {\n    options.servername = net.isIP(options.host) ? '' : options.host;\n  }\n\n  return tls.connect(options);\n}\n\n/**\n * Abort the handshake and emit an error.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {(http.ClientRequest|net.Socket|tls.Socket)} stream The request to\n *     abort or the socket to destroy\n * @param {String} message The error message\n * @private\n */\nfunction abortHandshake(websocket, stream, message) {\n  websocket._readyState = WebSocket.CLOSING;\n\n  const err = new Error(message);\n  Error.captureStackTrace(err, abortHandshake);\n\n  if (stream.setHeader) {\n    stream[kAborted] = true;\n    stream.abort();\n\n    if (stream.socket && !stream.socket.destroyed) {\n      //\n      // On Node.js >= 14.3.0 `request.abort()` does not destroy the socket if\n      // called after the request completed. See\n      // https://github.com/websockets/ws/issues/1869.\n      //\n      stream.socket.destroy();\n    }\n\n    process.nextTick(emitErrorAndClose, websocket, err);\n  } else {\n    stream.destroy(err);\n    stream.once('error', websocket.emit.bind(websocket, 'error'));\n    stream.once('close', websocket.emitClose.bind(websocket));\n  }\n}\n\n/**\n * Handle cases where the `ping()`, `pong()`, or `send()` methods are called\n * when the `readyState` attribute is `CLOSING` or `CLOSED`.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @param {*} [data] The data to send\n * @param {Function} [cb] Callback\n * @private\n */\nfunction sendAfterClose(websocket, data, cb) {\n  if (data) {\n    const length = isBlob(data) ? data.size : toBuffer(data).length;\n\n    //\n    // The `_bufferedAmount` property is used only when the peer is a client and\n    // the opening handshake fails. Under these circumstances, in fact, the\n    // `setSocket()` method is not called, so the `_socket` and `_sender`\n    // properties are set to `null`.\n    //\n    if (websocket._socket) websocket._sender._bufferedBytes += length;\n    else websocket._bufferedAmount += length;\n  }\n\n  if (cb) {\n    const err = new Error(\n      `WebSocket is not open: readyState ${websocket.readyState} ` +\n        `(${readyStates[websocket.readyState]})`\n    );\n    process.nextTick(cb, err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'conclude'` event.\n *\n * @param {Number} code The status code\n * @param {Buffer} reason The reason for closing\n * @private\n */\nfunction receiverOnConclude(code, reason) {\n  const websocket = this[kWebSocket];\n\n  websocket._closeFrameReceived = true;\n  websocket._closeMessage = reason;\n  websocket._closeCode = code;\n\n  if (websocket._socket[kWebSocket] === undefined) return;\n\n  websocket._socket.removeListener('data', socketOnData);\n  process.nextTick(resume, websocket._socket);\n\n  if (code === 1005) websocket.close();\n  else websocket.close(code, reason);\n}\n\n/**\n * The listener of the `Receiver` `'drain'` event.\n *\n * @private\n */\nfunction receiverOnDrain() {\n  const websocket = this[kWebSocket];\n\n  if (!websocket.isPaused) websocket._socket.resume();\n}\n\n/**\n * The listener of the `Receiver` `'error'` event.\n *\n * @param {(RangeError|Error)} err The emitted error\n * @private\n */\nfunction receiverOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._socket[kWebSocket] !== undefined) {\n    websocket._socket.removeListener('data', socketOnData);\n\n    //\n    // On Node.js < 14.0.0 the `'error'` event is emitted synchronously. See\n    // https://github.com/websockets/ws/issues/1940.\n    //\n    process.nextTick(resume, websocket._socket);\n\n    websocket.close(err[kStatusCode]);\n  }\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * The listener of the `Receiver` `'finish'` event.\n *\n * @private\n */\nfunction receiverOnFinish() {\n  this[kWebSocket].emitClose();\n}\n\n/**\n * The listener of the `Receiver` `'message'` event.\n *\n * @param {Buffer|ArrayBuffer|Buffer[])} data The message\n * @param {Boolean} isBinary Specifies whether the message is binary or not\n * @private\n */\nfunction receiverOnMessage(data, isBinary) {\n  this[kWebSocket].emit('message', data, isBinary);\n}\n\n/**\n * The listener of the `Receiver` `'ping'` event.\n *\n * @param {Buffer} data The data included in the ping frame\n * @private\n */\nfunction receiverOnPing(data) {\n  const websocket = this[kWebSocket];\n\n  if (websocket._autoPong) websocket.pong(data, !this._isServer, NOOP);\n  websocket.emit('ping', data);\n}\n\n/**\n * The listener of the `Receiver` `'pong'` event.\n *\n * @param {Buffer} data The data included in the pong frame\n * @private\n */\nfunction receiverOnPong(data) {\n  this[kWebSocket].emit('pong', data);\n}\n\n/**\n * Resume a readable stream\n *\n * @param {Readable} stream The readable stream\n * @private\n */\nfunction resume(stream) {\n  stream.resume();\n}\n\n/**\n * The `Sender` error event handler.\n *\n * @param {Error} The error\n * @private\n */\nfunction senderOnError(err) {\n  const websocket = this[kWebSocket];\n\n  if (websocket.readyState === WebSocket.CLOSED) return;\n  if (websocket.readyState === WebSocket.OPEN) {\n    websocket._readyState = WebSocket.CLOSING;\n    setCloseTimer(websocket);\n  }\n\n  //\n  // `socket.end()` is used instead of `socket.destroy()` to allow the other\n  // peer to finish sending queued data. There is no need to set a timer here\n  // because `CLOSING` means that it is already set or not needed.\n  //\n  this._socket.end();\n\n  if (!websocket._errorEmitted) {\n    websocket._errorEmitted = true;\n    websocket.emit('error', err);\n  }\n}\n\n/**\n * Set a timer to destroy the underlying raw socket of a WebSocket.\n *\n * @param {WebSocket} websocket The WebSocket instance\n * @private\n */\nfunction setCloseTimer(websocket) {\n  websocket._closeTimer = setTimeout(\n    websocket._socket.destroy.bind(websocket._socket),\n    closeTimeout\n  );\n}\n\n/**\n * The listener of the socket `'close'` event.\n *\n * @private\n */\nfunction socketOnClose() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('close', socketOnClose);\n  this.removeListener('data', socketOnData);\n  this.removeListener('end', socketOnEnd);\n\n  websocket._readyState = WebSocket.CLOSING;\n\n  let chunk;\n\n  //\n  // The close frame might not have been received or the `'end'` event emitted,\n  // for example, if the socket was destroyed due to an error. Ensure that the\n  // `receiver` stream is closed after writing any remaining buffered data to\n  // it. If the readable side of the socket is in flowing mode then there is no\n  // buffered data as everything has been already written and `readable.read()`\n  // will return `null`. If instead, the socket is paused, any possible buffered\n  // data will be read as a single chunk.\n  //\n  if (\n    !this._readableState.endEmitted &&\n    !websocket._closeFrameReceived &&\n    !websocket._receiver._writableState.errorEmitted &&\n    (chunk = websocket._socket.read()) !== null\n  ) {\n    websocket._receiver.write(chunk);\n  }\n\n  websocket._receiver.end();\n\n  this[kWebSocket] = undefined;\n\n  clearTimeout(websocket._closeTimer);\n\n  if (\n    websocket._receiver._writableState.finished ||\n    websocket._receiver._writableState.errorEmitted\n  ) {\n    websocket.emitClose();\n  } else {\n    websocket._receiver.on('error', receiverOnFinish);\n    websocket._receiver.on('finish', receiverOnFinish);\n  }\n}\n\n/**\n * The listener of the socket `'data'` event.\n *\n * @param {Buffer} chunk A chunk of data\n * @private\n */\nfunction socketOnData(chunk) {\n  if (!this[kWebSocket]._receiver.write(chunk)) {\n    this.pause();\n  }\n}\n\n/**\n * The listener of the socket `'end'` event.\n *\n * @private\n */\nfunction socketOnEnd() {\n  const websocket = this[kWebSocket];\n\n  websocket._readyState = WebSocket.CLOSING;\n  websocket._receiver.end();\n  this.end();\n}\n\n/**\n * The listener of the socket `'error'` event.\n *\n * @private\n */\nfunction socketOnError() {\n  const websocket = this[kWebSocket];\n\n  this.removeListener('error', socketOnError);\n  this.on('error', NOOP);\n\n  if (websocket) {\n    websocket._readyState = WebSocket.CLOSING;\n    this.destroy();\n  }\n}\n","'use strict';\n\nconst { EMPTY_BUFFER } = require('./constants');\n\nconst FastBuffer = Buffer[Symbol.species];\n\n/**\n * Merges an array of buffers into a new buffer.\n *\n * @param {Buffer[]} list The array of buffers to concat\n * @param {Number} totalLength The total length of buffers in the list\n * @return {Buffer} The resulting buffer\n * @public\n */\nfunction concat(list, totalLength) {\n  if (list.length === 0) return EMPTY_BUFFER;\n  if (list.length === 1) return list[0];\n\n  const target = Buffer.allocUnsafe(totalLength);\n  let offset = 0;\n\n  for (let i = 0; i < list.length; i++) {\n    const buf = list[i];\n    target.set(buf, offset);\n    offset += buf.length;\n  }\n\n  if (offset < totalLength) {\n    return new FastBuffer(target.buffer, target.byteOffset, offset);\n  }\n\n  return target;\n}\n\n/**\n * Masks a buffer using the given mask.\n *\n * @param {Buffer} source The buffer to mask\n * @param {Buffer} mask The mask to use\n * @param {Buffer} output The buffer where to store the result\n * @param {Number} offset The offset at which to start writing\n * @param {Number} length The number of bytes to mask.\n * @public\n */\nfunction _mask(source, mask, output, offset, length) {\n  for (let i = 0; i < length; i++) {\n    output[offset + i] = source[i] ^ mask[i & 3];\n  }\n}\n\n/**\n * Unmasks a buffer using the given mask.\n *\n * @param {Buffer} buffer The buffer to unmask\n * @param {Buffer} mask The mask to use\n * @public\n */\nfunction _unmask(buffer, mask) {\n  for (let i = 0; i < buffer.length; i++) {\n    buffer[i] ^= mask[i & 3];\n  }\n}\n\n/**\n * Converts a buffer to an `ArrayBuffer`.\n *\n * @param {Buffer} buf The buffer to convert\n * @return {ArrayBuffer} Converted buffer\n * @public\n */\nfunction toArrayBuffer(buf) {\n  if (buf.length === buf.buffer.byteLength) {\n    return buf.buffer;\n  }\n\n  return buf.buffer.slice(buf.byteOffset, buf.byteOffset + buf.length);\n}\n\n/**\n * Converts `data` to a `Buffer`.\n *\n * @param {*} data The data to convert\n * @return {Buffer} The buffer\n * @throws {TypeError}\n * @public\n */\nfunction toBuffer(data) {\n  toBuffer.readOnly = true;\n\n  if (Buffer.isBuffer(data)) return data;\n\n  let buf;\n\n  if (data instanceof ArrayBuffer) {\n    buf = new FastBuffer(data);\n  } else if (ArrayBuffer.isView(data)) {\n    buf = new FastBuffer(data.buffer, data.byteOffset, data.byteLength);\n  } else {\n    buf = Buffer.from(data);\n    toBuffer.readOnly = false;\n  }\n\n  return buf;\n}\n\nmodule.exports = {\n  concat,\n  mask: _mask,\n  toArrayBuffer,\n  toBuffer,\n  unmask: _unmask\n};\n\n/* istanbul ignore else  */\nif (!process.env.WS_NO_BUFFER_UTIL) {\n  try {\n    const bufferUtil = require('bufferutil');\n\n    module.exports.mask = function (source, mask, output, offset, length) {\n      if (length < 48) _mask(source, mask, output, offset, length);\n      else bufferUtil.mask(source, mask, output, offset, length);\n    };\n\n    module.exports.unmask = function (buffer, mask) {\n      if (buffer.length < 32) _unmask(buffer, mask);\n      else bufferUtil.unmask(buffer, mask);\n    };\n  } catch (e) {\n    // Continue regardless of the error.\n  }\n}\n","\"use strict\";\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    var desc = Object.getOwnPropertyDescriptor(m, k);\n    if (!desc || (\"get\" in desc ? !m.__esModule : desc.writable || desc.configurable)) {\n      desc = { enumerable: true, get: function() { return m[k]; } };\n    }\n    Object.defineProperty(o, k2, desc);\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __exportStar = (this && this.__exportStar) || function(m, exports) {\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(exports, p)) __createBinding(exports, m, p);\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.sdk = exports.MixinDeviceBase = exports.ScryptedDeviceBase = void 0;\n__exportStar(require(\"../types/gen/index\"), exports);\nconst fs_1 = __importDefault(require(\"fs\"));\nconst index_1 = require(\"../types/gen/index\");\nconst module_1 = require(\"module\");\n/**\n * @category Core Reference\n */\nclass ScryptedDeviceBase extends index_1.DeviceBase {\n    constructor(nativeId) {\n        super();\n        this.nativeId = nativeId;\n    }\n    get storage() {\n        if (!this._storage) {\n            this._storage = exports.sdk.deviceManager.getDeviceStorage(this.nativeId);\n        }\n        return this._storage;\n    }\n    get log() {\n        if (!this._log) {\n            this._log = exports.sdk.deviceManager.getDeviceLogger(this.nativeId);\n        }\n        return this._log;\n    }\n    get console() {\n        if (!this._console) {\n            this._console = exports.sdk.deviceManager.getDeviceConsole(this.nativeId);\n        }\n        return this._console;\n    }\n    async createMediaObject(data, mimeType) {\n        return exports.sdk.mediaManager.createMediaObject(data, mimeType, {\n            sourceId: this.id,\n        });\n    }\n    getMediaObjectConsole(mediaObject) {\n        if (typeof mediaObject.sourceId !== 'string')\n            return this.console;\n        return exports.sdk.deviceManager.getMixinConsole(mediaObject.sourceId, this.nativeId);\n    }\n    _lazyLoadDeviceState() {\n        if (!this._deviceState) {\n            if (this.nativeId) {\n                this._deviceState = exports.sdk.deviceManager.getDeviceState(this.nativeId);\n            }\n            else {\n                this._deviceState = exports.sdk.deviceManager.getDeviceState();\n            }\n        }\n    }\n    /**\n     * Fire an event for this device.\n     */\n    onDeviceEvent(eventInterface, eventData) {\n        return exports.sdk.deviceManager.onDeviceEvent(this.nativeId, eventInterface, eventData);\n    }\n}\nexports.ScryptedDeviceBase = ScryptedDeviceBase;\n/**\n * @category Mixin Reference\n */\nclass MixinDeviceBase extends index_1.DeviceBase {\n    constructor(options) {\n        super();\n        this._listeners = new Set();\n        this.mixinDevice = options.mixinDevice;\n        this.mixinDeviceInterfaces = options.mixinDeviceInterfaces;\n        this.mixinStorageSuffix = options.mixinStorageSuffix;\n        this._deviceState = options.mixinDeviceState;\n        this.nativeId = exports.sdk.systemManager.getDeviceById(this.id).nativeId;\n        this.mixinProviderNativeId = options.mixinProviderNativeId;\n        // RpcProxy will trap all properties, and the following check/hack will determine\n        // if the device state came from another node worker thread.\n        // This should ultimately be discouraged and warned at some point in the future.\n        if (this._deviceState.__rpcproxy_traps_all_properties && typeof this._deviceState.id === 'string') {\n            this._deviceState = exports.sdk.deviceManager.createDeviceState(this._deviceState.id, this._deviceState.setState);\n        }\n    }\n    get storage() {\n        if (!this._storage) {\n            const mixinStorageSuffix = this.mixinStorageSuffix;\n            const mixinStorageKey = this.id + (mixinStorageSuffix ? ':' + mixinStorageSuffix : '');\n            this._storage = exports.sdk.deviceManager.getMixinStorage(mixinStorageKey, this.mixinProviderNativeId);\n        }\n        return this._storage;\n    }\n    get console() {\n        if (!this._console) {\n            if (exports.sdk.deviceManager.getMixinConsole)\n                this._console = exports.sdk.deviceManager.getMixinConsole(this.id, this.mixinProviderNativeId);\n            else\n                this._console = exports.sdk.deviceManager.getDeviceConsole(this.mixinProviderNativeId);\n        }\n        return this._console;\n    }\n    async createMediaObject(data, mimeType) {\n        return exports.sdk.mediaManager.createMediaObject(data, mimeType, {\n            sourceId: this.id,\n        });\n    }\n    getMediaObjectConsole(mediaObject) {\n        if (typeof mediaObject.sourceId !== 'string')\n            return this.console;\n        return exports.sdk.deviceManager.getMixinConsole(mediaObject.sourceId, this.mixinProviderNativeId);\n    }\n    /**\n     * Fire an event for this device.\n     */\n    onDeviceEvent(eventInterface, eventData) {\n        return exports.sdk.deviceManager.onMixinEvent(this.id, this, eventInterface, eventData);\n    }\n    _lazyLoadDeviceState() {\n    }\n    manageListener(listener) {\n        this._listeners.add(listener);\n    }\n    release() {\n        for (const l of this._listeners) {\n            l.removeListener();\n        }\n    }\n}\nexports.MixinDeviceBase = MixinDeviceBase;\n(function () {\n    function _createGetState(state) {\n        return function () {\n            this._lazyLoadDeviceState();\n            // @ts-ignore: accessing private property\n            return this._deviceState?.[state];\n        };\n    }\n    function _createSetState(state) {\n        return function (value) {\n            this._lazyLoadDeviceState();\n            // @ts-ignore: accessing private property\n            if (!this._deviceState) {\n                console.warn('device state is unavailable. the device must be discovered with deviceManager.onDeviceDiscovered or deviceManager.onDevicesChanged before the state can be set.');\n            }\n            else {\n                // @ts-ignore: accessing private property\n                this._deviceState[state] = value;\n            }\n        };\n    }\n    for (const field of Object.values(index_1.ScryptedInterfaceProperty)) {\n        if (field === index_1.ScryptedInterfaceProperty.nativeId)\n            continue;\n        Object.defineProperty(ScryptedDeviceBase.prototype, field, {\n            set: _createSetState(field),\n            get: _createGetState(field),\n        });\n        Object.defineProperty(MixinDeviceBase.prototype, field, {\n            set: _createSetState(field),\n            get: _createGetState(field),\n        });\n    }\n})();\nexports.sdk = {};\ntry {\n    let loaded = false;\n    try {\n        // todo: remove usage of process.env.SCRYPTED_SDK_MODULE, only existed in prerelease builds.\n        // import.meta is not a reliable way to detect es module support in webpack since webpack\n        // evaluates that to true at runtime.\n        const esModule = process.env.SCRYPTED_SDK_ES_MODULE || process.env.SCRYPTED_SDK_MODULE;\n        const cjsModule = process.env.SCRYPTED_SDK_CJS_MODULE || process.env.SCRYPTED_SDK_MODULE;\n        // @ts-expect-error\n        if (esModule && typeof import.meta !== 'undefined') {\n            // @ts-expect-error\n            const require = (0, module_1.createRequire)(import.meta.url);\n            const sdkModule = require(esModule);\n            Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n            loaded = true;\n        }\n        else if (cjsModule) {\n            // @ts-expect-error\n            if (typeof __non_webpack_require__ !== 'undefined') {\n                // @ts-expect-error\n                const sdkModule = __non_webpack_require__(process.env.SCRYPTED_SDK_MODULE);\n                Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n                loaded = true;\n            }\n            else {\n                const sdkModule = require(cjsModule);\n                Object.assign(exports.sdk, sdkModule.getScryptedStatic());\n                loaded = true;\n            }\n        }\n    }\n    catch (e) {\n        console.warn(\"failed to load sdk module\", e);\n        throw e;\n    }\n    if (!loaded) {\n        let runtimeAPI;\n        try {\n            runtimeAPI = pluginRuntimeAPI;\n        }\n        catch (e) {\n        }\n        Object.assign(exports.sdk, {\n            log: deviceManager.getDeviceLogger(undefined),\n            deviceManager,\n            endpointManager,\n            mediaManager,\n            systemManager,\n            pluginHostAPI,\n            ...runtimeAPI,\n        });\n    }\n    try {\n        let descriptors = {\n            ...index_1.ScryptedInterfaceDescriptors,\n        };\n        try {\n            const sdkJson = JSON.parse(fs_1.default.readFileSync('../sdk.json').toString());\n            const customDescriptors = sdkJson.interfaceDescriptors;\n            if (customDescriptors) {\n                descriptors = {\n                    ...descriptors,\n                    ...customDescriptors,\n                };\n            }\n        }\n        catch (e) {\n            console.warn('failed to load custom interface descriptors', e);\n        }\n        exports.sdk.systemManager.setScryptedInterfaceDescriptors?.(index_1.TYPES_VERSION, descriptors)?.catch(() => { });\n    }\n    catch (e) {\n    }\n}\ncatch (e) {\n    console.error('sdk initialization error, import @scrypted/types or use @scrypted/client instead', e);\n}\nexports.default = exports.sdk;\n//# sourceMappingURL=index.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.collectErrorCauses = collectErrorCauses;\nexports.toError = toError;\nexports.toErrorObject = toErrorObject;\nconst stackTrace_js_1 = require(\"./stackTrace.js\");\nconst DEFAULT_CAUSE_DEPTH = 5;\nfunction collectErrorCauses(error, options = {}) {\n    const maxDepth = options.maxDepth ?? DEFAULT_CAUSE_DEPTH;\n    const causes = [];\n    const visited = new Set();\n    let current = error;\n    let depth = 0;\n    while (current != null && depth < maxDepth) {\n        const cause = current?.cause;\n        if (cause == null || visited.has(cause)) {\n            break;\n        }\n        visited.add(cause);\n        causes.push(toError(cause));\n        current = cause;\n        depth += 1;\n    }\n    return causes;\n}\nfunction toError(value) {\n    if (value instanceof Error) {\n        return value;\n    }\n    const error = new Error(typeof value === \"string\" ? value : JSON.stringify(value));\n    if (typeof value === \"object\" && value != null) {\n        Object.assign(error, value);\n    }\n    return error;\n}\nfunction toErrorObject(error, parseLine) {\n    return {\n        nativeError: error,\n        name: error.name ?? \"Error\",\n        message: error.message ?? \"\",\n        stack: (0, stackTrace_js_1.buildStackTrace)(error, parseLine),\n    };\n}\n","\"use strict\";\n/**\n * Unified driver properties interface for Eufy driver\n *\n * Contains all possible driver properties, including connection and log state fields.\n * Used for type safety and property mapping throughout the client and plugin.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=properties.js.map","module.exports = require(\"http\");","\"use strict\";\n/**\n * Centralized State Management for Eufy WebSocket Client\n *\n * Provides centralized state management for the entire WebSocket client lifecycle,\n * including connection states, schema negotiation, driver connection, and error handling.\n * This module ensures consistent state tracking across all client components and\n * provides reactive state change notifications.\n *\n * Key responsibilities:\n * - Track connection lifecycle states (disconnected -> connecting -> connected -> ready)\n * - Manage schema negotiation progress and compatibility information\n * - Monitor driver connection status and event listener counts\n * - Provide error state management and recovery tracking\n * - Offer reactive state change subscriptions for UI updates\n * - Ensure thread-safe state transitions and consistency\n *\n * The state manager is designed to be shared across WebSocket client, API manager,\n * and any other components that need to track or react to client state changes.\n *\n * @example Basic Usage\n * ```typescript\n * const stateManager = new ClientStateManager();\n *\n * // Subscribe to state changes\n * const unsubscribe = stateManager.onStateChange((state) => {\n *   console.log('Connection state:', state.connection);\n *   console.log('Driver connected:', state.driverConnected);\n * });\n *\n * // Update state\n * stateManager.setConnectionState(ConnectionState.CONNECTING);\n * stateManager.setDriverConnected(true);\n *\n * // Check readiness\n * if (stateManager.isReady()) {\n *   console.log('Client is ready for API calls');\n * }\n * ```\n *\n * @public\n * @since 1.0.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ClientStateManager = exports.ConnectionState = void 0;\n/**\n * Connection state enumeration for WebSocket client lifecycle\n *\n * Represents the various stages of connection establishment and readiness:\n * - DISCONNECTED: No connection established\n * - CONNECTING: Connection attempt in progress\n * - CONNECTED: WebSocket connected but not yet ready for API calls\n * - SCHEMA_NEGOTIATING: Version negotiation in progress\n * - READY: Fully connected and ready for API commands\n * - ERROR: Connection or operation error occurred\n */\nvar ConnectionState;\n(function (ConnectionState) {\n    ConnectionState[\"DISCONNECTED\"] = \"disconnected\";\n    ConnectionState[\"CONNECTING\"] = \"connecting\";\n    ConnectionState[\"CONNECTED\"] = \"connected\";\n    ConnectionState[\"SCHEMA_NEGOTIATING\"] = \"schema_negotiating\";\n    ConnectionState[\"READY\"] = \"ready\";\n    ConnectionState[\"ERROR\"] = \"error\";\n})(ConnectionState || (exports.ConnectionState = ConnectionState = {}));\n/**\n * Centralized State Manager for WebSocket Client\n *\n * Manages the complete state lifecycle of the Eufy WebSocket client with\n * thread-safe state updates and reactive change notifications. This class\n * serves as the single source of truth for client state across all components.\n *\n * Features:\n * - Thread-safe state updates with automatic change notifications\n * - Reactive state subscriptions for UI and component updates\n * - Automatic state consistency management (e.g., disconnection resets schema state)\n * - Error handling and recovery state tracking\n * - Connection lifecycle management with proper state transitions\n *\n * The state manager ensures that all state changes are properly propagated\n * and that dependent states are automatically updated (e.g., WebSocket\n * disconnection automatically clears schema and driver connection states).\n */\nclass ClientStateManager {\n    constructor(logger) {\n        this.state = {\n            connection: ConnectionState.DISCONNECTED,\n            wsConnected: false,\n            schemaSetupComplete: false,\n            driverConnected: false,\n            schemaInfo: null,\n            lastError: null,\n            reconnectAttempts: 0,\n            eventListenerCount: 0,\n        };\n        this.stateChangeCallbacks = [];\n        this.logger = logger;\n    }\n    /**\n     * Get current state snapshot\n     *\n     * Returns a read-only copy of the current state to prevent external\n     * modifications. The returned state is a snapshot and will not reflect\n     * future changes.\n     *\n     * @returns Immutable copy of current client state\n     */\n    getState() {\n        return { ...this.state };\n    }\n    /**\n     * Update the connection lifecycle state\n     *\n     * Updates the primary connection state and notifies subscribers if changed.\n     * This represents the high-level connection progress through the lifecycle.\n     *\n     * @param connectionState - New connection state to set\n     */\n    setConnectionState(connectionState) {\n        if (this.state.connection !== connectionState) {\n            this.state.connection = connectionState;\n            this.notifyStateChange();\n        }\n    }\n    /**\n     * Update WebSocket connection status with cascading effects\n     *\n     * Updates the raw WebSocket connection status and automatically resets\n     * dependent states when disconnected. This ensures state consistency\n     * when the underlying connection is lost.\n     *\n     * @param connected - Whether WebSocket is connected\n     */\n    setWebSocketConnected(connected) {\n        if (this.state.wsConnected !== connected) {\n            this.state.wsConnected = connected;\n            if (!connected) {\n                // Reset dependent states on disconnection\n                this.state.schemaSetupComplete = false;\n                this.state.driverConnected = false;\n                this.state.connection = ConnectionState.DISCONNECTED;\n            }\n            else {\n                // Check if we should transition to READY when reconnecting\n                this.updateConnectionStateFromConditions();\n            }\n            this.notifyStateChange();\n        }\n    }\n    /**\n     * Update schema negotiation completion status\n     *\n     * Marks schema negotiation as complete and automatically transitions\n     * to READY state if WebSocket is also connected. This represents\n     * successful API version negotiation.\n     *\n     * @param complete - Whether schema setup is complete\n     */\n    setSchemaSetupComplete(complete) {\n        if (this.state.schemaSetupComplete !== complete) {\n            this.state.schemaSetupComplete = complete;\n            this.updateConnectionStateFromConditions();\n            this.notifyStateChange();\n        }\n    }\n    /**\n     * Update Eufy driver connection status\n     *\n     * Tracks whether the driver.connect command has been successfully\n     * executed, which is required for most device operations.\n     *\n     * @param connected - Whether driver is connected\n     */\n    setDriverConnected(connected) {\n        if (this.state.driverConnected !== connected) {\n            this.state.driverConnected = connected;\n            this.notifyStateChange();\n        }\n    }\n    /**\n     * Update schema compatibility information\n     *\n     * Stores the results of schema negotiation including version details\n     * and compatibility status for debugging and monitoring purposes.\n     *\n     * @param schemaInfo - Schema negotiation results or null to clear\n     */\n    setSchemaInfo(schemaInfo) {\n        this.state.schemaInfo = schemaInfo;\n        this.notifyStateChange();\n    }\n    /**\n     * Update error state with automatic connection state handling\n     *\n     * Records the last error and automatically sets connection state to ERROR\n     * if an error is provided. Useful for error tracking and recovery.\n     *\n     * @param error - Error that occurred or null to clear error state\n     */\n    setError(error) {\n        this.state.lastError = error;\n        if (error) {\n            this.state.connection = ConnectionState.ERROR;\n        }\n        this.notifyStateChange();\n    }\n    /**\n     * Update reconnection attempt counter\n     *\n     * Tracks the number of reconnection attempts for exponential backoff\n     * and maximum retry limit enforcement.\n     *\n     * @param attempts - Current number of reconnection attempts\n     */\n    setReconnectAttempts(attempts) {\n        this.state.reconnectAttempts = attempts;\n        this.notifyStateChange();\n    }\n    /**\n     * Update event listener count for monitoring\n     *\n     * Tracks the number of registered event listeners for debugging\n     * and performance monitoring purposes.\n     *\n     * @param count - Current number of event listeners\n     */\n    setEventListenerCount(count) {\n        this.state.eventListenerCount = count;\n        this.notifyStateChange();\n    }\n    /**\n     * Update connection state based on current conditions\n     *\n     * Determines the appropriate connection state based on WebSocket and schema status.\n     * Ensures the connection state accurately reflects the current readiness level.\n     *\n     * @private\n     */\n    updateConnectionStateFromConditions() {\n        if (this.state.wsConnected && this.state.schemaSetupComplete) {\n            this.state.connection = ConnectionState.READY;\n        }\n    }\n    /**\n     * Check if client is fully ready for API operations\n     *\n     * Validates that all required setup steps are complete:\n     * - WebSocket connection established\n     * - Schema negotiation completed successfully\n     * - Connection state is READY\n     *\n     * @returns true if client is ready for API commands\n     */\n    isReady() {\n        return (this.state.connection === ConnectionState.READY &&\n            this.state.wsConnected &&\n            this.state.schemaSetupComplete);\n    }\n    /**\n     * Reset state to initial values for disconnection/restart\n     *\n     * Resets all state to initial values while preserving event listener count.\n     * Used when disconnecting or restarting the connection to ensure clean state.\n     */\n    reset() {\n        this.state = {\n            connection: ConnectionState.DISCONNECTED,\n            wsConnected: false,\n            schemaSetupComplete: false,\n            driverConnected: false,\n            schemaInfo: null,\n            lastError: null,\n            reconnectAttempts: 0,\n            eventListenerCount: this.state.eventListenerCount, // Keep listener count\n        };\n        this.notifyStateChange();\n    }\n    /**\n     * Subscribe to state changes with reactive updates\n     *\n     * Registers a callback function to be called whenever the state changes.\n     * Useful for UI updates, logging, or triggering dependent operations.\n     *\n     * @param callback - Function to call when state changes (receives new state)\n     * @returns Unsubscribe function to remove the callback\n     */\n    onStateChange(callback) {\n        this.stateChangeCallbacks.push(callback);\n        // Return unsubscribe function\n        return () => {\n            const index = this.stateChangeCallbacks.indexOf(callback);\n            if (index > -1) {\n                this.stateChangeCallbacks.splice(index, 1);\n            }\n        };\n    }\n    /**\n     * Notify all subscribers of state changes\n     *\n     * Internal method that calls all registered state change callbacks with\n     * the current state. Handles errors in callbacks gracefully to prevent\n     * cascading failures.\n     */\n    notifyStateChange() {\n        const currentState = this.getState();\n        this.stateChangeCallbacks.forEach((callback) => {\n            try {\n                callback(currentState);\n            }\n            catch (error) {\n                // Silently ignore callback errors to prevent cascading failures\n            }\n        });\n    }\n}\nexports.ClientStateManager = ClientStateManager;\n//# sourceMappingURL=client-state.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.buildPrettyMeta = buildPrettyMeta;\nconst formatTemplate_js_1 = require(\"../formatTemplate.js\");\nconst formatNumberAddZeros_js_1 = require(\"../formatNumberAddZeros.js\");\nfunction buildPrettyMeta(settings, meta) {\n    if (meta == null) {\n        return {\n            text: \"\",\n            template: settings.prettyLogTemplate,\n            placeholders: {},\n        };\n    }\n    let template = settings.prettyLogTemplate;\n    const placeholderValues = {};\n    if (template.includes(\"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}\")) {\n        template = template.replace(\"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}\", \"{{dateIsoStr}}\");\n    }\n    else {\n        if (settings.prettyLogTimeZone === \"UTC\") {\n            placeholderValues[\"yyyy\"] = meta.date?.getUTCFullYear() ?? \"----\";\n            placeholderValues[\"mm\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getUTCMonth(), 2, 1);\n            placeholderValues[\"dd\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getUTCDate(), 2);\n            placeholderValues[\"hh\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getUTCHours(), 2);\n            placeholderValues[\"MM\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getUTCMinutes(), 2);\n            placeholderValues[\"ss\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getUTCSeconds(), 2);\n            placeholderValues[\"ms\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getUTCMilliseconds(), 3);\n        }\n        else {\n            placeholderValues[\"yyyy\"] = meta.date?.getFullYear() ?? \"----\";\n            placeholderValues[\"mm\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getMonth(), 2, 1);\n            placeholderValues[\"dd\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getDate(), 2);\n            placeholderValues[\"hh\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getHours(), 2);\n            placeholderValues[\"MM\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getMinutes(), 2);\n            placeholderValues[\"ss\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getSeconds(), 2);\n            placeholderValues[\"ms\"] = (0, formatNumberAddZeros_js_1.formatNumberAddZeros)(meta.date?.getMilliseconds(), 3);\n        }\n    }\n    const dateInSettingsTimeZone = settings.prettyLogTimeZone === \"UTC\" ? meta.date : meta.date != null ? new Date(meta.date.getTime() - meta.date.getTimezoneOffset() * 60000) : undefined;\n    placeholderValues[\"rawIsoStr\"] = dateInSettingsTimeZone?.toISOString() ?? \"\";\n    placeholderValues[\"dateIsoStr\"] = dateInSettingsTimeZone?.toISOString().replace(\"T\", \" \").replace(\"Z\", \"\") ?? \"\";\n    placeholderValues[\"logLevelName\"] = meta.logLevelName;\n    placeholderValues[\"fileNameWithLine\"] = meta.path?.fileNameWithLine ?? \"\";\n    placeholderValues[\"filePathWithLine\"] = meta.path?.filePathWithLine ?? \"\";\n    placeholderValues[\"fullFilePath\"] = meta.path?.fullFilePath ?? \"\";\n    let parentNamesString = settings.parentNames?.join(settings.prettyErrorParentNamesSeparator);\n    parentNamesString = parentNamesString != null && meta.name != null ? parentNamesString + settings.prettyErrorParentNamesSeparator : undefined;\n    const combinedName = meta.name != null || parentNamesString != null ? `${parentNamesString ?? \"\"}${meta.name ?? \"\"}` : \"\";\n    placeholderValues[\"name\"] = combinedName;\n    placeholderValues[\"nameWithDelimiterPrefix\"] = combinedName.length > 0 ? settings.prettyErrorLoggerNameDelimiter + combinedName : \"\";\n    placeholderValues[\"nameWithDelimiterSuffix\"] = combinedName.length > 0 ? combinedName + settings.prettyErrorLoggerNameDelimiter : \"\";\n    if (settings.overwrite?.addPlaceholders != null) {\n        settings.overwrite.addPlaceholders(meta, placeholderValues);\n    }\n    return {\n        text: (0, formatTemplate_js_1.formatTemplate)(settings, template, placeholderValues),\n        template,\n        placeholders: placeholderValues,\n    };\n}\n","\"use strict\";\n/**\n * Unified station properties interface for Eufy stations\n *\n * Contains all possible station properties from all schema versions, including network, alarm, and security fields.\n * Used for type safety and property mapping throughout the client and plugin.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n//# sourceMappingURL=properties.js.map","module.exports = require(\"net\");","\"use strict\";\n/**\n * Common constants used across all command sources in the Eufy WebSocket API\n *\n * Consolidates all shared event source constants and type guards for type safety and validation.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.ALL_COMMANDS = exports.SERVER_COMMANDS = exports.DRIVER_COMMANDS = exports.STATION_COMMANDS = exports.DEVICE_COMMANDS = exports.EVENT_SOURCES = void 0;\nexports.isValidEventSource = isValidEventSource;\nexports.assertEventSource = assertEventSource;\n// ================= EVENT SOURCES =================\n/**\n * Event source constants for Eufy WebSocket API\n * Centralized definition of all event sources to ensure type safety\n */\nexports.EVENT_SOURCES = {\n    SERVER: \"server\", // Events originating from the server\n    DRIVER: \"driver\", // Events originating from the driver\n    DEVICE: \"device\", // Events originating from the device\n    STATION: \"station\", // Events originating from the station\n};\n// Type guards for event sources\nfunction isValidEventSource(source) {\n    return Object.values(exports.EVENT_SOURCES).includes(source);\n}\nfunction assertEventSource(source) {\n    if (!isValidEventSource(source)) {\n        throw new Error(`Invalid event source: ${source}. Valid sources are: ${Object.values(exports.EVENT_SOURCES).join(\", \")}`);\n    }\n}\n// ================= ALL COMMAND CONSTANTS =================\n// Re-export all command constants from individual sources for convenience\nvar constants_1 = require(\"../device/constants\");\nObject.defineProperty(exports, \"DEVICE_COMMANDS\", { enumerable: true, get: function () { return constants_1.DEVICE_COMMANDS; } });\nvar constants_2 = require(\"../station/constants\");\nObject.defineProperty(exports, \"STATION_COMMANDS\", { enumerable: true, get: function () { return constants_2.STATION_COMMANDS; } });\nvar constants_3 = require(\"../driver/constants\");\nObject.defineProperty(exports, \"DRIVER_COMMANDS\", { enumerable: true, get: function () { return constants_3.DRIVER_COMMANDS; } });\nvar constants_4 = require(\"../server/constants\");\nObject.defineProperty(exports, \"SERVER_COMMANDS\", { enumerable: true, get: function () { return constants_4.SERVER_COMMANDS; } });\n// Import for local use\nconst constants_5 = require(\"../device/constants\");\nconst constants_6 = require(\"../station/constants\");\nconst constants_7 = require(\"../driver/constants\");\nconst constants_8 = require(\"../server/constants\");\n/**\n * All command constants in a single object for easy access\n */\nexports.ALL_COMMANDS = {\n    DEVICE: constants_5.DEVICE_COMMANDS,\n    STATION: constants_6.STATION_COMMANDS,\n    DRIVER: constants_7.DRIVER_COMMANDS,\n    SERVER: constants_8.SERVER_COMMANDS,\n};\n//# sourceMappingURL=constants.js.map","\"use strict\";\n/**\n * Response types for driver-level commands in the Eufy WebSocket API\n *\n * Defines all response types for driver commands, based on the API documentation.\n * Driver responses are direct WebSocket protocol responses, not BaseApiResponse wrappers.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// ================= COMMAND-RESPONSE MAPPING =================\nconst constants_1 = require(\"./constants\");\n//# sourceMappingURL=responses.js.map","\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.urlToObject = urlToObject;\nfunction urlToObject(url) {\n    return {\n        href: url.href,\n        protocol: url.protocol,\n        username: url.username,\n        password: url.password,\n        host: url.host,\n        hostname: url.hostname,\n        port: url.port,\n        pathname: url.pathname,\n        search: url.search,\n        searchParams: [...url.searchParams].map(([key, value]) => ({ key, value })),\n        hash: url.hash,\n        origin: url.origin,\n    };\n}\n","\"use strict\";\n/**\n * Response types for station-level commands\n * Based on API documentation in eufy-security-ws/docs/api_cmds.md\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\n// ================= COMMAND-RESPONSE MAPPING =================\nconst constants_1 = require(\"./constants\");\n//# sourceMappingURL=responses.js.map","\"use strict\";\n/**\n * Device Detection and Type Registry for Eufy Security Devices\n *\n * This module provides comprehensive device type detection, classification, and capability\n * mapping for Eufy security devices. It serves as the central registry for all supported\n * device types and their corresponding capabilities.\n *\n * Key Features:\n * - Device type classification (cameras, doorbells, sensors, locks, etc.)\n * - Capability detection (battery, pan/tilt, floodlight, etc.)\n * - Human-readable model name resolution\n * - Support validation for device compatibility\n *\n * Architecture:\n * - Static device type sets for efficient lookup operations\n * - Helper functions for device capability detection\n * - Model name registry for user-friendly device identification\n * - Compatibility layer between Eufy device types and client interfaces\n *\n * Performance Optimizations:\n * - Uses Set data structures for O(1) device type lookups\n * - Minimizes memory footprint with shared type constants\n * - Efficient capability detection through bitwise operations where applicable\n *\n * @public\n * @since 1.0.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.MODEL_NAMES = exports.ERROR_RESILIENT_CAMERA_TYPES = exports.KEYPAD_TYPES = exports.SMART_DROP_TYPES = exports.SMART_TRACK_TYPES = exports.SMART_SAFE_TYPES = exports.GARAGE_CAMERA_TYPES = exports.CAMERA_3_TYPES = exports.CAMERA_2_TYPES = exports.CAMERA_E_TYPES = exports.CAMERA_1_TYPES = exports.LOCK_KEYPAD_TYPES = exports.LOCK_WIFI_TYPES = exports.LOCK_BLE_TYPES = exports.DUAL_DOORBELL_TYPES = exports.BATTERY_DOORBELL_TYPES = exports.WIRED_DOORBELL_TYPES = exports.INDOOR_CAMERA_TYPES = exports.SOLO_CAMERA_TYPES = exports.SUPPORTED_DEVICE_TYPES = exports.PAN_TILT_DEVICE_TYPES = exports.BATTERY_DEVICE_TYPES = exports.BASE_STATION_DEVICE_TYPES = exports.LOCK_DEVICE_TYPES = exports.SENSOR_DEVICE_TYPES = exports.FLOODLIGHT_DEVICE_TYPES = exports.DOORBELL_DEVICE_TYPES = exports.CAMERA_DEVICE_TYPES = void 0;\nexports.isCamera = isCamera;\nexports.isDoorbell = isDoorbell;\nexports.isWiredDoorbell = isWiredDoorbell;\nexports.isBatteryDoorbell = isBatteryDoorbell;\nexports.isDoorbellDual = isDoorbellDual;\nexports.isFloodlight = isFloodlight;\nexports.isSensor = isSensor;\nexports.isEntrySensor = isEntrySensor;\nexports.isMotionSensor = isMotionSensor;\nexports.isLock = isLock;\nexports.isLockBle = isLockBle;\nexports.isLockWifi = isLockWifi;\nexports.isLockKeypad = isLockKeypad;\nexports.isBaseStation = isBaseStation;\nexports.isIndoorCamera = isIndoorCamera;\nexports.isSoloCameras = isSoloCameras;\nexports.isPanAndTiltCamera = isPanAndTiltCamera;\nexports.isGarageCamera = isGarageCamera;\nexports.isSmartSafe = isSmartSafe;\nexports.isSmartTrack = isSmartTrack;\nexports.isSmartDrop = isSmartDrop;\nexports.isKeyPad = isKeyPad;\nexports.isCamera1Product = isCamera1Product;\nexports.isCamera2Product = isCamera2Product;\nexports.isCamera3Product = isCamera3Product;\nexports.hasBattery = hasBattery;\nexports.canPanTilt = canPanTilt;\nexports.isDeviceSupported = isDeviceSupported;\nexports.requiresErrorResilience = requiresErrorResilience;\nexports.getDeviceCapabilities = getDeviceCapabilities;\nexports.getProductName = getProductName;\nexports.getDeviceTypeName = getDeviceTypeName;\nconst constants_1 = require(\"../device/constants\");\n/**\n * Camera device types supported by the client - Matching original eufy-security-client Device.isCamera()\n * These devices provide video streaming capabilities\n */\nexports.CAMERA_DEVICE_TYPES = new Set([\n    constants_1.DeviceType.CAMERA, // Basic camera\n    constants_1.DeviceType.CAMERA2, // eufyCam 2\n    constants_1.DeviceType.CAMERA_E, // eufyCam E\n    constants_1.DeviceType.CAMERA2C, // eufyCam 2C\n    constants_1.DeviceType.CAMERA2C_PRO, // eufyCam 2C Pro\n    constants_1.DeviceType.CAMERA2_PRO, // eufyCam 2 Pro\n    constants_1.DeviceType.CAMERA3, // eufyCam 3\n    constants_1.DeviceType.CAMERA3C, // eufyCam 3C\n    constants_1.DeviceType.CAMERA3_PRO, // eufyCam 3 Pro\n    constants_1.DeviceType.PROFESSIONAL_247, // T8600 Professional\n    constants_1.DeviceType.SOLO_CAMERA, // SoloCam series\n    constants_1.DeviceType.SOLO_CAMERA_PRO, // SoloCam Pro\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_1080, // SoloCam Spotlight 1080\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_2K, // SoloCam Spotlight 2K\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_SOLAR, // SoloCam Spotlight Solar\n    constants_1.DeviceType.SOLO_CAMERA_SOLAR, // SoloCam Solar\n    constants_1.DeviceType.SOLO_CAMERA_C210, // SoloCam C210\n    constants_1.DeviceType.SOLO_CAMERA_E30, // SoloCam E30\n    constants_1.DeviceType.INDOOR_CAMERA, // Indoor cameras\n    constants_1.DeviceType.INDOOR_PT_CAMERA, // Indoor pan/tilt cameras\n    constants_1.DeviceType.INDOOR_PT_CAMERA_S350, // Indoor pan/tilt S350\n    constants_1.DeviceType.INDOOR_PT_CAMERA_C220, // Indoor pan/tilt C220\n    constants_1.DeviceType.INDOOR_PT_CAMERA_C210, // Indoor pan/tilt C210\n    constants_1.DeviceType.INDOOR_PT_CAMERA_E30, // Indoor pan/tilt E30\n    constants_1.DeviceType.INDOOR_CAMERA_1080, // Indoor 1080p\n    constants_1.DeviceType.INDOOR_PT_CAMERA_1080, // Indoor PT 1080p\n    constants_1.DeviceType.INDOOR_OUTDOOR_CAMERA_1080P, // Indoor/outdoor 1080p\n    constants_1.DeviceType.INDOOR_OUTDOOR_CAMERA_1080P_NO_LIGHT, // Indoor/outdoor 1080p no light\n    constants_1.DeviceType.INDOOR_OUTDOOR_CAMERA_2K, // Indoor/outdoor 2K\n    constants_1.DeviceType.INDOOR_COST_DOWN_CAMERA, // Indoor cost down camera\n    constants_1.DeviceType.OUTDOOR_PT_CAMERA, // S340 outdoor pan/tilt\n    constants_1.DeviceType.CAMERA_FG, // T8150 4G Starlight cameras\n    constants_1.DeviceType.CAMERA_GARAGE_T8453_COMMON, // Garage camera common\n    constants_1.DeviceType.CAMERA_GARAGE_T8452, // Garage camera T8452\n    constants_1.DeviceType.CAMERA_GARAGE_T8453, // Garage camera T8453\n    constants_1.DeviceType.CAMERA_GUN, // Gun camera\n    constants_1.DeviceType.CAMERA_SNAIL, // Snail camera\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8426, // Floodlight E30\n]);\n/**\n * Doorbell device types supported by the client - Matching original eufy-security-client Device.isDoorbell()\n * These devices provide video streaming AND doorbell functionality\n */\nexports.DOORBELL_DEVICE_TYPES = new Set([\n    constants_1.DeviceType.DOORBELL, // Basic wired doorbell\n    constants_1.DeviceType.BATTERY_DOORBELL, // Battery doorbell\n    constants_1.DeviceType.BATTERY_DOORBELL_2, // Battery doorbell 2\n    constants_1.DeviceType.BATTERY_DOORBELL_PLUS, // Battery doorbell plus\n    constants_1.DeviceType.DOORBELL_SOLO, // Solo doorbell (dual)\n    constants_1.DeviceType.BATTERY_DOORBELL_PLUS_E340, // E340 doorbell\n    constants_1.DeviceType.BATTERY_DOORBELL_C30, // C30 doorbell\n    constants_1.DeviceType.BATTERY_DOORBELL_C31, // C31 doorbell\n]);\n/**\n * Floodlight camera device types supported by the client - Matching original eufy-security-client Device.isFloodLight()\n * These combine camera functionality with light functionality\n */\nexports.FLOODLIGHT_DEVICE_TYPES = new Set([\n    constants_1.DeviceType.FLOODLIGHT, // Basic floodlight\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8422, // T8422\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8423, // T8423\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8424, // T8424\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8425, // T8425\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8426, // T8426 (E30)\n    constants_1.DeviceType.WALL_LIGHT_CAM, // Wall light cam\n    constants_1.DeviceType.WALL_LIGHT_CAM_81A0, // Wall light cam 81A0\n    // these are SoloCam floodlights\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_1080,\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_2K,\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_SOLAR,\n]);\n/**\n * Motion sensor device types supported by the client - Matching original eufy-security-client Device.isSensor()\n */\nexports.SENSOR_DEVICE_TYPES = new Set([\n    constants_1.DeviceType.SENSOR, // Basic entry sensor\n    constants_1.DeviceType.MOTION_SENSOR, // Motion sensor\n]);\n/**\n * Smart lock device types supported by the client - Matching original eufy-security-client Device.isLock()\n */\nexports.LOCK_DEVICE_TYPES = new Set([\n    constants_1.DeviceType.LOCK_BLE, // Bluetooth lock\n    constants_1.DeviceType.LOCK_BLE_NO_FINGER, // Bluetooth lock without fingerprint\n    constants_1.DeviceType.LOCK_WIFI, // WiFi lock\n    constants_1.DeviceType.LOCK_WIFI_NO_FINGER, // WiFi lock without fingerprint\n    constants_1.DeviceType.LOCK_8503, // Smart Lock R10\n    constants_1.DeviceType.LOCK_8504, // Smart Lock R20\n    constants_1.DeviceType.LOCK_8530, // Video Smart Lock\n    constants_1.DeviceType.LOCK_8592, // Smart Lock R20 Keypad\n    constants_1.DeviceType.LOCK_85A3, // Smart Lock R10 Keypad\n    constants_1.DeviceType.LOCK_8506, // Lock 8506\n    constants_1.DeviceType.LOCK_8502, // Lock 8502\n]);\n/**\n * Base station device types - Matching original eufy-security-client Device.isStation()\n * These are hub devices that manage other devices\n */\nexports.BASE_STATION_DEVICE_TYPES = new Set([\n    constants_1.DeviceType.STATION, // Basic station\n    constants_1.DeviceType.MINIBASE_CHIME, // MiniBase Chime\n]);\n/**\n * Battery-powered device types - Matching original eufy-security-client Device.hasBattery()\n * Used to determine if Battery interface should be added\n */\nexports.BATTERY_DEVICE_TYPES = new Set([\n    // Battery cameras (based on original hasBattery() method)\n    constants_1.DeviceType.CAMERA, // Basic camera\n    constants_1.DeviceType.CAMERA_E, // eufyCam E\n    constants_1.DeviceType.CAMERA2C, // eufyCam 2C\n    constants_1.DeviceType.CAMERA2, // eufyCam 2\n    constants_1.DeviceType.CAMERA2_PRO, // eufyCam 2 Pro\n    constants_1.DeviceType.CAMERA2C_PRO, // eufyCam 2C Pro\n    constants_1.DeviceType.CAMERA3, // eufyCam 3\n    constants_1.DeviceType.CAMERA3C, // eufyCam 3C\n    constants_1.DeviceType.CAMERA3_PRO, // eufyCam 3 Pro\n    constants_1.DeviceType.SOLO_CAMERA, // SoloCam series\n    constants_1.DeviceType.SOLO_CAMERA_PRO, // SoloCam Pro\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_1080,\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_2K,\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_SOLAR,\n    constants_1.DeviceType.SOLO_CAMERA_SOLAR,\n    constants_1.DeviceType.SOLO_CAMERA_C210,\n    constants_1.DeviceType.SOLO_CAMERA_E30,\n    constants_1.DeviceType.OUTDOOR_PT_CAMERA, // S340 outdoor pan/tilt\n    constants_1.DeviceType.CAMERA_FG, // T8150 4G Starlight\n    constants_1.DeviceType.WALL_LIGHT_CAM_81A0, // Wall light cam 81A0\n    constants_1.DeviceType.SMART_DROP, // T8790\n    // All battery doorbells\n    constants_1.DeviceType.BATTERY_DOORBELL,\n    constants_1.DeviceType.BATTERY_DOORBELL_2,\n    constants_1.DeviceType.BATTERY_DOORBELL_PLUS,\n    constants_1.DeviceType.DOORBELL_SOLO,\n    constants_1.DeviceType.BATTERY_DOORBELL_PLUS_E340,\n    constants_1.DeviceType.BATTERY_DOORBELL_C30,\n    constants_1.DeviceType.BATTERY_DOORBELL_C31,\n    // Battery locks (from original hasBattery())\n    constants_1.DeviceType.LOCK_WIFI,\n    constants_1.DeviceType.LOCK_BLE_NO_FINGER,\n    constants_1.DeviceType.LOCK_8503,\n    constants_1.DeviceType.LOCK_8504,\n    constants_1.DeviceType.LOCK_8530,\n    constants_1.DeviceType.LOCK_8592,\n    constants_1.DeviceType.LOCK_85A3,\n    constants_1.DeviceType.LOCK_8506,\n    constants_1.DeviceType.LOCK_8502,\n    // Smart safes (from original hasBattery())\n    constants_1.DeviceType.SMART_SAFE_7400,\n    constants_1.DeviceType.SMART_SAFE_7401,\n    constants_1.DeviceType.SMART_SAFE_7402,\n    constants_1.DeviceType.SMART_SAFE_7403,\n]);\n/**\n * Pan/tilt capable device types - Matching original eufy-security-client Device.isPanAndTiltCamera()\n * These support pan and tilt camera controls\n */\nexports.PAN_TILT_DEVICE_TYPES = new Set([\n    constants_1.DeviceType.INDOOR_PT_CAMERA,\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8423,\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8425,\n    constants_1.DeviceType.FLOODLIGHT_CAMERA_8426,\n    constants_1.DeviceType.INDOOR_COST_DOWN_CAMERA,\n    constants_1.DeviceType.OUTDOOR_PT_CAMERA,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_S350,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_E30,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_C220,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_C210,\n]);\n/**\n * All device types that the client can support\n * Combination of cameras, doorbells, floodlights, sensors, and locks\n */\nexports.SUPPORTED_DEVICE_TYPES = new Set([\n    ...Array.from(exports.CAMERA_DEVICE_TYPES),\n    ...Array.from(exports.DOORBELL_DEVICE_TYPES),\n    ...Array.from(exports.FLOODLIGHT_DEVICE_TYPES),\n    ...Array.from(exports.SENSOR_DEVICE_TYPES),\n    ...Array.from(exports.LOCK_DEVICE_TYPES),\n]);\n// Additional device type sets for more precise classification\nexports.SOLO_CAMERA_TYPES = new Set([\n    constants_1.DeviceType.SOLO_CAMERA,\n    constants_1.DeviceType.SOLO_CAMERA_PRO,\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_1080,\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_2K,\n    constants_1.DeviceType.SOLO_CAMERA_SPOTLIGHT_SOLAR,\n    constants_1.DeviceType.SOLO_CAMERA_SOLAR,\n    constants_1.DeviceType.SOLO_CAMERA_C210,\n    constants_1.DeviceType.SOLO_CAMERA_E30,\n    constants_1.DeviceType.OUTDOOR_PT_CAMERA, // S340 is considered SoloCam\n]);\nexports.INDOOR_CAMERA_TYPES = new Set([\n    constants_1.DeviceType.INDOOR_CAMERA,\n    constants_1.DeviceType.INDOOR_PT_CAMERA,\n    constants_1.DeviceType.INDOOR_OUTDOOR_CAMERA_1080P_NO_LIGHT,\n    constants_1.DeviceType.INDOOR_OUTDOOR_CAMERA_2K,\n    constants_1.DeviceType.INDOOR_OUTDOOR_CAMERA_1080P,\n    constants_1.DeviceType.INDOOR_COST_DOWN_CAMERA,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_S350,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_E30,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_C220,\n    constants_1.DeviceType.INDOOR_PT_CAMERA_C210,\n]);\nexports.WIRED_DOORBELL_TYPES = new Set([\n    constants_1.DeviceType.DOORBELL, // Basic wired doorbell\n]);\nexports.BATTERY_DOORBELL_TYPES = new Set([\n    constants_1.DeviceType.BATTERY_DOORBELL,\n    constants_1.DeviceType.BATTERY_DOORBELL_2,\n    constants_1.DeviceType.BATTERY_DOORBELL_PLUS,\n    constants_1.DeviceType.BATTERY_DOORBELL_PLUS_E340,\n    constants_1.DeviceType.BATTERY_DOORBELL_C30,\n    constants_1.DeviceType.BATTERY_DOORBELL_C31,\n]);\nexports.DUAL_DOORBELL_TYPES = new Set([\n    constants_1.DeviceType.DOORBELL_SOLO, // Solo doorbell (dual)\n    constants_1.DeviceType.BATTERY_DOORBELL_PLUS, // Battery doorbell plus (dual)\n]);\nexports.LOCK_BLE_TYPES = new Set([\n    constants_1.DeviceType.LOCK_BLE,\n    constants_1.DeviceType.LOCK_BLE_NO_FINGER,\n]);\nexports.LOCK_WIFI_TYPES = new Set([\n    constants_1.DeviceType.LOCK_WIFI,\n    constants_1.DeviceType.LOCK_WIFI_NO_FINGER,\n    constants_1.DeviceType.LOCK_8503,\n    constants_1.DeviceType.LOCK_8530,\n    constants_1.DeviceType.LOCK_8504,\n    constants_1.DeviceType.LOCK_8502,\n    constants_1.DeviceType.LOCK_8506,\n]);\nexports.LOCK_KEYPAD_TYPES = new Set([\n    constants_1.DeviceType.LOCK_85A3, // Smart Lock R10 Keypad\n    constants_1.DeviceType.LOCK_8592, // Smart Lock R20 Keypad\n]);\nexports.CAMERA_1_TYPES = new Set([constants_1.DeviceType.CAMERA]);\nexports.CAMERA_E_TYPES = new Set([constants_1.DeviceType.CAMERA_E]);\nexports.CAMERA_2_TYPES = new Set([\n    constants_1.DeviceType.CAMERA2C,\n    constants_1.DeviceType.CAMERA2,\n    constants_1.DeviceType.CAMERA2_PRO,\n    constants_1.DeviceType.CAMERA2C_PRO,\n]);\nexports.CAMERA_3_TYPES = new Set([\n    constants_1.DeviceType.CAMERA3,\n    constants_1.DeviceType.CAMERA3C,\n    constants_1.DeviceType.PROFESSIONAL_247,\n    constants_1.DeviceType.CAMERA3_PRO,\n]);\nexports.GARAGE_CAMERA_TYPES = new Set([\n    constants_1.DeviceType.CAMERA_GARAGE_T8453_COMMON,\n    constants_1.DeviceType.CAMERA_GARAGE_T8452,\n    constants_1.DeviceType.CAMERA_GARAGE_T8453,\n]);\nexports.SMART_SAFE_TYPES = new Set([\n    constants_1.DeviceType.SMART_SAFE_7400,\n    constants_1.DeviceType.SMART_SAFE_7401,\n    constants_1.DeviceType.SMART_SAFE_7402,\n    constants_1.DeviceType.SMART_SAFE_7403,\n]);\nexports.SMART_TRACK_TYPES = new Set([\n    120, // SMART_TRACK_LINK - not in DeviceType enum yet\n    121, // SMART_TRACK_CARD - not in DeviceType enum yet\n]);\nexports.SMART_DROP_TYPES = new Set([constants_1.DeviceType.SMART_DROP]);\nexports.KEYPAD_TYPES = new Set([constants_1.DeviceType.KEYPAD]);\n/**\n * Camera device types that require FFmpeg error resilience for H.264 data partitioning.\n * Currently includes SoloCam S340, but may be extended to other cameras with similar issues.\n */\nexports.ERROR_RESILIENT_CAMERA_TYPES = new Set([\n    constants_1.DeviceType.OUTDOOR_PT_CAMERA, // SoloCam S340\n]);\n/**\n * Device Detection Functions\n *\n * These functions provide efficient device type classification and capability detection\n * for Eufy security devices. They match the original eufy-security-client Device static\n * methods while optimizing for client-specific use cases.\n */\n/**\n * Determines if a device type represents a camera-capable device.\n *\n * This includes traditional cameras, video doorbells, and floodlight cameras\n * that can provide video streaming functionality.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device can provide video streaming capabilities\n */\nfunction isCamera(deviceType) {\n    return (exports.CAMERA_DEVICE_TYPES.has(deviceType) ||\n        exports.DOORBELL_DEVICE_TYPES.has(deviceType) ||\n        exports.FLOODLIGHT_DEVICE_TYPES.has(deviceType));\n}\n/**\n * Determines if a device type represents a video doorbell.\n *\n * Video doorbells combine camera functionality with doorbell-specific features\n * like chime integration and visitor detection.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a video doorbell\n */\nfunction isDoorbell(deviceType) {\n    return exports.DOORBELL_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a wired video doorbell.\n *\n * Wired doorbells have continuous power and don't require battery management.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a wired doorbell\n */\nfunction isWiredDoorbell(deviceType) {\n    return exports.WIRED_DOORBELL_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a battery-powered video doorbell.\n *\n * Battery doorbells require power management and charging monitoring.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is battery-powered\n */\nfunction isBatteryDoorbell(deviceType) {\n    return exports.BATTERY_DOORBELL_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a dual-camera doorbell.\n *\n * Dual doorbells have both front-facing and package detection cameras.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device has dual camera functionality\n */\nfunction isDoorbellDual(deviceType) {\n    return exports.DUAL_DOORBELL_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a floodlight camera.\n *\n * Floodlight cameras combine video recording with powerful LED lighting\n * for enhanced security and visibility.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device has integrated floodlight functionality\n */\nfunction isFloodlight(deviceType) {\n    return exports.FLOODLIGHT_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a sensor device.\n *\n * Sensors include motion detectors and entry sensors for security monitoring.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a sensor\n */\nfunction isSensor(deviceType) {\n    return exports.SENSOR_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents an entry sensor.\n *\n * Entry sensors detect door/window opening and closing events.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is an entry sensor\n */\nfunction isEntrySensor(deviceType) {\n    return deviceType === constants_1.DeviceType.SENSOR;\n}\n/**\n * Determines if a device type represents a motion sensor.\n *\n * Motion sensors detect movement within their detection range.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a motion sensor\n */\nfunction isMotionSensor(deviceType) {\n    return deviceType === constants_1.DeviceType.MOTION_SENSOR;\n}\n/**\n * Determines if a device type represents a smart lock.\n *\n * Smart locks provide keyless entry with remote control capabilities.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a smart lock\n */\nfunction isLock(deviceType) {\n    return exports.LOCK_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a Bluetooth-enabled smart lock.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a Bluetooth smart lock\n */\nfunction isLockBle(deviceType) {\n    return exports.LOCK_BLE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a WiFi-enabled smart lock.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a WiFi smart lock\n */\nfunction isLockWifi(deviceType) {\n    return exports.LOCK_WIFI_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a smart lock with keypad functionality.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device has keypad input capabilities\n */\nfunction isLockKeypad(deviceType) {\n    return exports.LOCK_KEYPAD_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a base station or hub device.\n *\n * Base stations coordinate other devices but don't have direct client interfaces.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a base station\n */\nfunction isBaseStation(deviceType) {\n    return exports.BASE_STATION_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents an indoor camera.\n *\n * Indoor cameras are optimized for interior use and may have different\n * features compared to outdoor cameras.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is designed for indoor use\n */\nfunction isIndoorCamera(deviceType) {\n    return exports.INDOOR_CAMERA_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a SoloCam series camera.\n *\n * SoloCam devices are standalone cameras that don't require a base station.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is part of the SoloCam series\n */\nfunction isSoloCameras(deviceType) {\n    return exports.SOLO_CAMERA_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type supports pan and tilt functionality.\n *\n * Pan/tilt cameras can be remotely controlled to change viewing direction.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device supports pan and tilt controls\n */\nfunction isPanAndTiltCamera(deviceType) {\n    return exports.PAN_TILT_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a garage-specific camera.\n *\n * Garage cameras are designed for monitoring garage doors and vehicles.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a garage camera\n */\nfunction isGarageCamera(deviceType) {\n    return exports.GARAGE_CAMERA_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a smart safe.\n *\n * Smart safes provide secure storage with digital access controls.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a smart safe\n */\nfunction isSmartSafe(deviceType) {\n    return exports.SMART_SAFE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a smart tracking device.\n *\n * Smart trackers help locate lost items or monitor movement.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a smart tracker\n */\nfunction isSmartTrack(deviceType) {\n    return exports.SMART_TRACK_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a smart drop box.\n *\n * Smart drop boxes provide secure package delivery reception.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a smart drop box\n */\nfunction isSmartDrop(deviceType) {\n    return exports.SMART_DROP_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a security keypad.\n *\n * Keypads provide numeric input for security system control.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a keypad\n */\nfunction isKeyPad(deviceType) {\n    return exports.KEYPAD_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a first-generation camera product.\n *\n * Includes original eufyCam and eufyCam E models.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a generation 1 camera\n */\nfunction isCamera1Product(deviceType) {\n    return exports.CAMERA_1_TYPES.has(deviceType) || exports.CAMERA_E_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a second-generation camera product.\n *\n * Includes eufyCam 2, 2C, and Pro variants.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a generation 2 camera\n */\nfunction isCamera2Product(deviceType) {\n    return exports.CAMERA_2_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type represents a third-generation camera product.\n *\n * Includes eufyCam 3, 3C, and Professional variants.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is a generation 3 camera\n */\nfunction isCamera3Product(deviceType) {\n    return exports.CAMERA_3_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type includes battery power capability.\n *\n * Battery-powered devices require power management and charging monitoring.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device has battery power\n */\nfunction hasBattery(deviceType) {\n    return exports.BATTERY_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type supports pan and tilt camera controls.\n *\n * Alias for isPanAndTiltCamera() for consistency with capability naming.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device supports pan and tilt functionality\n */\nfunction canPanTilt(deviceType) {\n    return exports.PAN_TILT_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type is supported by this client.\n *\n * This is the primary compatibility check for device registration.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device is supported by the client\n */\nfunction isDeviceSupported(deviceType) {\n    return exports.SUPPORTED_DEVICE_TYPES.has(deviceType);\n}\n/**\n * Determines if a device type requires FFmpeg error resilience for H.264 data partitioning.\n *\n * These cameras may have streaming issues with H.264 data partitioning that require\n * special FFmpeg flags (-enable_er 1) to handle corrupted or incomplete frames.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns True if the device requires error resilience settings\n */\nfunction requiresErrorResilience(deviceType) {\n    return exports.ERROR_RESILIENT_CAMERA_TYPES.has(deviceType);\n}\n/**\n * Analyzes a device type and returns a comprehensive capability profile.\n *\n * This function provides a complete overview of what features and interfaces\n * a device supports, enabling efficient interface assignment and feature\n * detection throughout the client.\n *\n * Performance Optimization: Uses efficient Set.has() lookups for O(1) complexity\n * across all capability checks.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns Object containing boolean flags for each device capability\n */\nfunction getDeviceCapabilities(deviceType) {\n    return {\n        camera: isCamera(deviceType) ||\n            isDoorbell(deviceType) ||\n            isFloodlight(deviceType),\n        doorbell: isDoorbell(deviceType),\n        floodlight: isFloodlight(deviceType),\n        sensor: isSensor(deviceType),\n        lock: isLock(deviceType),\n        battery: hasBattery(deviceType),\n        panTilt: canPanTilt(deviceType),\n        supported: isDeviceSupported(deviceType),\n    };\n}\n// Human-readable product names for Eufy device models\nexports.MODEL_NAMES = {\n    // Base Stations\n    T8001: \"HomeBase\",\n    T8002: \"HomeBase E\",\n    T8010: \"HomeBase S280 (Homebase 2)\",\n    T8030: \"HomeBase S380 (HomeBase 3)\",\n    T8021: \"Smart Lock Wi-Fi Bridge\",\n    T8023: \"MiniBase Chime\",\n    // EufyCam Series\n    T8111: \"eufyCam\",\n    T8112: \"eufyCam E\",\n    T8114: \"eufyCam 2\",\n    T8113: \"eufyCam S210 (eufyCam 2C)\",\n    T8140: \"eufyCam S221 (eufyCam 2 Pro)\",\n    T8141: \"eufyCam S220 (eufyCam 2C Pro)\",\n    T8160: \"eufyCam S330 (eufyCam 3)\",\n    T8161: \"eufyCam S300 (eufyCam 3C)\",\n    T8162: \"eufyCam S3 Pro\",\n    T8600: \"eufyCam E330 (Professional)\",\n    // SoloCam Series\n    T8130: \"SoloCam E20\",\n    T8131: \"SoloCam C120 (SoloCam E40)\",\n    T8122: \"SoloCam L20\",\n    T8123: \"SoloCam L40\",\n    T8B0: \"SoloCam C210\",\n    T8124: \"SoloCam S230 (SoloCam S40)\",\n    T8134: \"SoloCam S220\",\n    T8170: \"SoloCam S340\",\n    T8171: \"SoloCam E30\",\n    // Floodlight Cameras\n    T8420: \"Floodlight Camera\",\n    T8420X: \"Floodlight Camera\",\n    T8422: \"Floodlight Cam\",\n    T8423: \"Floodlight Cam S330 (Floodlight Cam 2 Pro)\",\n    T8424: \"Floodlight Cam E221 (Floodlight Cam 2)\",\n    T8425: \"Floodlight Cam E340\",\n    // Wall Light Cameras\n    T84A1: \"Wired Wall Light Cam S100\",\n    T84A0: \"Solar Wall Light Cam S120\",\n    // Video Doorbells - Wired\n    T8200: \"Video Doorbell 2K (Wired)\",\n    T8200X: \"Wired Doorbell 2k\",\n    T8201: \"Wired Doorbell 1080p\",\n    T8203: \"Video Doorbell (Wired) S330 (Video Doorbell Dual)\",\n    // Video Doorbells - Battery\n    T8210: \"Video Doorbell S220 (Battery Doorbell 2K)\",\n    T8213: \"Video Doorbell S330 (Battery Doorbell 2K Dual)\",\n    T8214: \"Video Doorbell E340 (Battery Powered)\",\n    T8222: \"Video Doorbell C210 (Battery Doorbell 1080p)\",\n    T8224: \"Video Doorbell C30 (Battery Powered)\",\n    T8223: \"Video Doorbell C31 (Battery Powered)\",\n    // Indoor Cameras\n    T8410: \"Indoor Cam E220 (Indoor Cam Pan&Tilt 2K)\",\n    // Sensors\n    T8900: \"Entry Sensor\",\n    T8910: \"Motion Sensor\",\n};\n/**\n * Retrieves a human-readable product name for a given device model identifier.\n *\n * This function maps Eufy's internal model codes (like T8114, T8210) to\n * user-friendly product names that are displayed in the client interface.\n *\n * @param model - The Eufy device model identifier (e.g., \"T8114\", \"T8210\")\n * @returns Human-readable product name, or the original model if not found\n */\nfunction getProductName(model) {\n    return exports.MODEL_NAMES[model] || model;\n}\n/**\n * Gets a human-readable device type name based on device type number.\n *\n * This function provides a simple mapping from device type numbers to\n * user-friendly type names for display purposes.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns Human-readable device type name\n */\nfunction getDeviceTypeName(deviceType) {\n    if (isDoorbell(deviceType)) {\n        return \"Doorbell\";\n    }\n    else if (isCamera(deviceType) || isFloodlight(deviceType)) {\n        return \"Camera\";\n    }\n    else if (isSensor(deviceType)) {\n        return \"Sensor\";\n    }\n    else if (isLock(deviceType)) {\n        return \"Lock\";\n    }\n    else if (isBaseStation(deviceType)) {\n        return \"Base Station\";\n    }\n    else {\n        return \"Unknown\";\n    }\n}\n//# sourceMappingURL=device-detection.js.map","\"use strict\";\n/**\n * Station module exports\n *\n * Provides all station-related constants, commands, events, and responses for the Eufy Security WebSocket Client.\n * This barrel file re-exports all station-related modules for easy import.\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nconst tslib_1 = require(\"tslib\");\ntslib_1.__exportStar(require(\"./constants\"), exports);\ntslib_1.__exportStar(require(\"./commands\"), exports);\ntslib_1.__exportStar(require(\"./events\"), exports);\ntslib_1.__exportStar(require(\"./properties\"), exports);\ntslib_1.__exportStar(require(\"./responses\"), exports);\n//# sourceMappingURL=index.js.map","\"use strict\";\n/**\n * Authentication Manager\n *\n * Handles all authentication-related logic for Eufy Security clients,\n * including CAPTCHA challenges, 2FA verification, and authentication state management.\n *\n * This service encapsulates:\n * - Authentication state tracking (none, captcha_required, mfa_required)\n * - CAPTCHA and MFA data management\n * - User input handling for auth challenges\n * - WebSocket event listeners for auth events\n * - Post-authentication device discovery coordination\n *\n * @module authentication-manager\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.AuthenticationManager = exports.AUTH_STATE = void 0;\n/**\n * Authentication state constants\n */\nexports.AUTH_STATE = {\n    NONE: \"none\",\n    CAPTCHA_REQUIRED: \"captcha_required\",\n    MFA_REQUIRED: \"mfa_required\",\n};\n/**\n * Authentication Manager\n *\n * Centralizes all authentication logic, making it easier to:\n * - Test authentication flows independently\n * - Reuse authentication logic across different client implementations\n * - Maintain clear separation of concerns\n *\n * @example\n * ```typescript\n * const authManager = new AuthenticationManager(\n *   wsClient,\n *   logger, // tslog Logger instance\n *   () => updateUI(),\n *   async (result) => await registerDevices(result)\n * );\n *\n * // Check for pending auth after connection\n * await authManager.checkPendingAuth();\n *\n * // Get auth state for UI\n * const state = authManager.getAuthState();\n * const message = authManager.getAuthStatusMessage(true);\n *\n * // Handle user input\n * authManager.updateCaptchaCode(\"ABC123\");\n * await authManager.submitCaptcha();\n * ```\n */\nclass AuthenticationManager {\n    constructor(wsClient, logger, onStateChange, onDeviceRegistration) {\n        // Authentication state\n        this.authState = exports.AUTH_STATE.NONE;\n        this.captchaData = null;\n        this.mfaData = null;\n        // Current user input (not persisted)\n        this.currentCaptchaCode = \"\";\n        this.currentVerifyCode = \"\";\n        this.wsClient = wsClient;\n        this.logger = logger;\n        this.onStateChange = onStateChange;\n        this.onDeviceRegistration = onDeviceRegistration;\n        this.setupEventListeners();\n    }\n    // =================== PUBLIC API ===================\n    /**\n     * Get current authentication state\n     */\n    getAuthState() {\n        return this.authState;\n    }\n    /**\n     * Get current CAPTCHA data (if any)\n     */\n    getCaptchaData() {\n        return this.captchaData;\n    }\n    /**\n     * Get current MFA data (if any)\n     */\n    getMfaData() {\n        return this.mfaData;\n    }\n    /**\n     * Get current CAPTCHA code input\n     */\n    getCurrentCaptchaCode() {\n        return this.currentCaptchaCode;\n    }\n    /**\n     * Get current verification code input\n     */\n    getCurrentVerifyCode() {\n        return this.currentVerifyCode;\n    }\n    /**\n     * Update CAPTCHA code input (called on every keystroke)\n     */\n    updateCaptchaCode(code) {\n        this.currentCaptchaCode = code;\n    }\n    /**\n     * Update verification code input (called on every keystroke)\n     */\n    updateVerifyCode(code) {\n        this.currentVerifyCode = code;\n    }\n    /**\n     * Get a user-friendly authentication status message\n     */\n    getAuthStatusMessage(isDriverConnected) {\n        if (this.authState === exports.AUTH_STATE.CAPTCHA_REQUIRED) {\n            return \" CAPTCHA required - check settings below\";\n        }\n        if (this.authState === exports.AUTH_STATE.MFA_REQUIRED) {\n            return \" 2FA code required - check settings below\";\n        }\n        if (isDriverConnected) {\n            return \" Authenticated\";\n        }\n        return \" Not connected - click Connect Account button\";\n    }\n    /**\n     * Check for pending authentication challenges after connection attempt\n     */\n    async checkPendingAuth() {\n        const pendingCaptcha = this.wsClient.getPendingCaptcha();\n        if (pendingCaptcha) {\n            this.captchaData = pendingCaptcha;\n            this.authState = exports.AUTH_STATE.CAPTCHA_REQUIRED;\n            this.wsClient.clearPendingCaptcha();\n            this.onStateChange();\n            return;\n        }\n        const pendingMfa = this.wsClient.getPendingMfa();\n        if (pendingMfa) {\n            this.mfaData = pendingMfa;\n            this.authState = exports.AUTH_STATE.MFA_REQUIRED;\n            this.wsClient.clearPendingMfa();\n            this.onStateChange();\n            return;\n        }\n    }\n    /**\n     * Submit CAPTCHA code\n     */\n    async submitCaptcha() {\n        const captchaCode = this.currentCaptchaCode;\n        if (!captchaCode || captchaCode.trim() === \"\") {\n            this.logger.warn(\" CAPTCHA code is empty\");\n            throw new Error(\"Please enter a CAPTCHA code\");\n        }\n        if (!this.captchaData) {\n            this.logger.warn(\" No CAPTCHA data available\");\n            throw new Error(\"No CAPTCHA challenge found\");\n        }\n        this.logger.info(` Submitting CAPTCHA code for ID: ${this.captchaData.captchaId}`);\n        try {\n            await this.wsClient.commands.driver().setCaptcha({\n                captchaId: this.captchaData.captchaId,\n                captcha: captchaCode.trim(),\n            });\n            this.logger.info(\" CAPTCHA submitted successfully\");\n            // Clear CAPTCHA state\n            this.captchaData = null;\n            this.currentCaptchaCode = \"\";\n            // Check post-CAPTCHA state (may need 2FA, or authentication complete)\n            await this.checkPostCaptchaState();\n            this.onStateChange();\n        }\n        catch (error) {\n            this.logger.error(\" CAPTCHA submission failed:\", error);\n            throw error;\n        }\n    }\n    /**\n     * Submit 2FA verification code\n     */\n    async submitVerifyCode() {\n        const verifyCode = this.currentVerifyCode;\n        if (!verifyCode || verifyCode.trim() === \"\") {\n            this.logger.warn(\" Verification code is empty\");\n            throw new Error(\"Please enter a verification code\");\n        }\n        const captchaId = this.captchaData?.captchaId || \"\";\n        this.logger.info(\" Submitting 2FA verification code\");\n        try {\n            await this.wsClient.commands.driver().setVerifyCode({\n                verifyCode: verifyCode,\n                captchaId: captchaId,\n            });\n            this.logger.info(\" Verification code submitted successfully\");\n            // Clear MFA state\n            this.mfaData = null;\n            this.currentVerifyCode = \"\";\n            // Check post-verification state\n            await this.checkPostVerificationState();\n            this.onStateChange();\n        }\n        catch (error) {\n            this.logger.error(\" Verification code submission failed:\", error);\n            throw error;\n        }\n    }\n    /**\n     * Request a new verification code\n     */\n    async requestNewCode() {\n        this.logger.info(\" Requesting new verification code\");\n        try {\n            // The driver should send a new code\n            // This typically triggers another \"verify code\" event\n            await this.wsClient.commands.driver().setVerifyCode({\n                verifyCode: \"\", // Empty code requests a new one\n                captchaId: this.captchaData?.captchaId || \"\",\n            });\n            this.logger.info(\" New verification code requested\");\n            this.onStateChange();\n        }\n        catch (error) {\n            this.logger.error(\" Failed to request new code:\", error);\n            throw error;\n        }\n    }\n    /**\n     * Reset authentication state (on successful connection)\n     */\n    resetAuthState() {\n        this.authState = exports.AUTH_STATE.NONE;\n        this.captchaData = null;\n        this.mfaData = null;\n        this.currentCaptchaCode = \"\";\n        this.currentVerifyCode = \"\";\n    }\n    // =================== PRIVATE METHODS ===================\n    /**\n     * Set up WebSocket event listeners for authentication events\n     */\n    setupEventListeners() {\n        // Listen for CAPTCHA requests\n        this.wsClient.addEventListener(\"captcha request\", (event) => {\n            this.logger.info(\" CAPTCHA requested\");\n            this.captchaData = {\n                captchaId: event.captchaId,\n                captcha: event.captcha,\n            };\n            this.authState = exports.AUTH_STATE.CAPTCHA_REQUIRED;\n            this.onStateChange();\n        }, { source: \"driver\" });\n        // Listen for MFA requests\n        this.wsClient.addEventListener(\"verify code\", (event) => {\n            this.logger.info(\" 2FA verification requested\");\n            this.mfaData = { methods: event.methods || [] };\n            this.authState = exports.AUTH_STATE.MFA_REQUIRED;\n            this.onStateChange();\n        }, { source: \"driver\" });\n        // Listen for driver connected events\n        this.wsClient.addEventListener(\"connected\", () => {\n            this.logger.info(\" Driver connected\");\n            this.resetAuthState();\n            this.onStateChange();\n        }, { source: \"driver\" });\n    }\n    /**\n     * Check authentication state after CAPTCHA submission\n     * May transition to 2FA if required, or complete authentication\n     */\n    async checkPostCaptchaState() {\n        const pendingMfa = this.wsClient.getPendingMfa();\n        if (pendingMfa) {\n            this.mfaData = pendingMfa;\n            this.authState = exports.AUTH_STATE.MFA_REQUIRED;\n            this.wsClient.clearPendingMfa();\n            return;\n        }\n        const listeningResult = await this.wsClient.startListening();\n        if (listeningResult.state.driver.connected) {\n            this.authState = exports.AUTH_STATE.NONE;\n            this.logger.info(\" Authentication complete (CAPTCHA flow)\");\n            // Trigger device registration\n            await this.onDeviceRegistration(listeningResult);\n        }\n    }\n    /**\n     * Check authentication state after 2FA verification\n     * Completes authentication and discovers devices if successful\n     */\n    async checkPostVerificationState() {\n        const listeningResult = await this.wsClient.startListening();\n        if (listeningResult.state.driver.connected) {\n            this.authState = exports.AUTH_STATE.NONE;\n            this.logger.info(\" Authentication complete (2FA flow)\");\n            // Trigger device registration\n            await this.onDeviceRegistration(listeningResult);\n        }\n    }\n}\nexports.AuthenticationManager = AuthenticationManager;\n//# sourceMappingURL=authentication-manager.js.map","\"use strict\";\n/**\n * WebSocket Client for Eufy Security WebSocket API\n *\n * Provides a robust WebSocket connection with automatic reconnection, state management,\n * and proper message handling. This client handles:\n * - Connection lifecycle management (connect, disconnect, reconnect)\n * - Message queuing and timeout handling\n * - Event-driven architecture for version negotiation and event streaming\n * - Centralized state management integration\n * - Error handling and connection recovery\n *\n * The client is designed to be used by higher-level API managers and provides\n * a clean abstraction over the raw WebSocket connection.\n *\n * @example Basic Usage\n * ```typescript\n * const client = new WebSocketClient(\"ws://localhost:3000\");\n * client.onConnected(() => console.log(\"Connected\"));\n * client.onEventMessage((event) => console.log(\"Event:\", event));\n * await client.connect();\n * ```\n *\n * @public\n * @since 1.0.0\n */\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.WebSocketClient = void 0;\nconst tslib_1 = require(\"tslib\");\nconst ws_1 = tslib_1.__importDefault(require(\"ws\"));\nconst websocket_types_1 = require(\"./websocket-types\");\nconst client_state_1 = require(\"./client-state\");\nconst websocket_message_processor_1 = require(\"./utils/websocket-message-processor\");\n/**\n * WebSocket Client with State Management and Automatic Reconnection\n *\n * Core WebSocket client that handles the low-level connection to the eufy-security-ws\n * container. Provides reliable message delivery, automatic reconnection with exponential\n * backoff, and proper state management integration.\n *\n * Features:\n * - Automatic reconnection with configurable retry limits\n * - Message correlation and timeout handling with efficient cleanup\n * - Event-driven architecture for different message types\n * - Integration with centralized state management\n * - Connection state tracking and error handling\n * - Memory-efficient message processing\n *\n * @public\n * @since 1.0.0\n */\nclass WebSocketClient {\n    /**\n     * Creates a new WebSocket client instance\n     *\n     * @param wsUrl - WebSocket server URL (e.g., 'ws://localhost:3000')\n     * @param stateManager - State manager instance for centralized state tracking\n     * @param logger - Logger instance for logging messages\n     *\n     * @example\n     * ```typescript\n     * const stateManager = new ClientStateManager(logger);\n     * const client = new WebSocketClient(\"ws://localhost:3000\", stateManager, logger);\n     * ```\n     */\n    constructor(wsUrl, stateManager, logger) {\n        this.ws = null;\n        this.pendingMessages = new Map();\n        this.reconnectTimeout = null;\n        this.maxReconnectAttempts = 10;\n        this.messageTimeout = 30000; // 30 seconds\n        // Performance monitoring (optional)\n        this.messageCount = 0;\n        this.lastMessageTime = 0;\n        this.wsUrl = wsUrl;\n        this.stateManager = stateManager;\n        this.logger = logger;\n        this.messageProcessor = new websocket_message_processor_1.WebSocketMessageProcessor(logger);\n    }\n    /**\n     * Get the current state manager instance\n     *\n     * @returns The ClientStateManager instance used by this client\n     */\n    getStateManager() {\n        return this.stateManager;\n    }\n    /**\n     * Register handler for successful WebSocket connection\n     * Called when the WebSocket connection is established and ready\n     *\n     * @param handler - Callback function to execute on connection\n     */\n    onConnected(handler) {\n        this.onConnectedHandler = handler;\n    }\n    /**\n     * Register handler for WebSocket disconnection\n     * Called when the WebSocket connection is closed or lost\n     *\n     * @param handler - Callback function to execute on disconnection\n     */\n    onDisconnected(handler) {\n        this.onDisconnectedHandler = handler;\n    }\n    /**\n     * Register handler for version/schema negotiation messages\n     * Called when the server sends version information for API compatibility\n     *\n     * @param handler - Callback function to process version messages\n     */\n    onVersionMessage(handler) {\n        this.onVersionHandler = handler;\n    }\n    /**\n     * Register handler for event messages from the server\n     * Called when the server pushes real-time events (device updates, etc.)\n     *\n     * @param handler - Callback function to process event messages\n     */\n    onEventMessage(handler) {\n        this.onEventHandler = handler;\n    }\n    /**\n     * Register handler for WebSocket errors\n     * Called when connection errors or message parsing errors occur\n     *\n     * @param handler - Callback function to handle errors\n     */\n    onError(handler) {\n        this.onErrorHandler = handler;\n    }\n    /**\n     * Establish WebSocket connection to the server\n     *\n     * Initiates connection to the configured WebSocket URL and sets up all event handlers.\n     * Updates connection state throughout the process and handles connection errors.\n     *\n     * @returns Promise that resolves when connection is established, rejects on failure\n     * @throws Error if connection fails or times out\n     */\n    async connect() {\n        this.stateManager.setConnectionState(client_state_1.ConnectionState.CONNECTING);\n        return new Promise((resolve, reject) => {\n            try {\n                this.ws = new ws_1.default(this.wsUrl);\n                this.ws.on(\"open\", () => {\n                    this.stateManager.setWebSocketConnected(true);\n                    this.stateManager.setConnectionState(client_state_1.ConnectionState.CONNECTED);\n                    this.stateManager.setReconnectAttempts(0);\n                    this.onConnectedHandler?.();\n                    resolve();\n                });\n                this.ws.on(\"message\", (data) => {\n                    // Use message processor for validation and parsing\n                    const result = this.messageProcessor.processMessage(data);\n                    if (!result.valid) {\n                        this.logger.warn(`Invalid message dropped: ${result.error}`);\n                        // Don't set error state for invalid messages - just log and continue\n                        return;\n                    }\n                    try {\n                        this.handleMessage(result.message);\n                    }\n                    catch (error) {\n                        const err = error;\n                        this.logger.error(\"Error handling processed message:\", err);\n                        this.stateManager.setError(err);\n                        this.onErrorHandler?.(err);\n                    }\n                });\n                this.ws.on(\"close\", (code, _reason) => {\n                    this.stateManager.setWebSocketConnected(false);\n                    this.clearPendingMessages();\n                    this.onDisconnectedHandler?.();\n                    if (code !== 1000) {\n                        // Not a normal closure\n                        this.scheduleReconnect();\n                    }\n                });\n                this.ws.on(\"error\", (error) => {\n                    this.stateManager.setError(error);\n                    this.onErrorHandler?.(error);\n                    if (!this.isConnected()) {\n                        reject(error);\n                    }\n                });\n            }\n            catch (error) {\n                const err = error;\n                this.stateManager.setError(err);\n                reject(err);\n            }\n        });\n    }\n    /**\n     * Gracefully disconnect from WebSocket server\n     *\n     * Closes the WebSocket connection with normal closure code, cancels any pending\n     * reconnection attempts, and cleans up all pending messages and state.\n     */\n    disconnect() {\n        if (this.reconnectTimeout) {\n            clearTimeout(this.reconnectTimeout);\n            this.reconnectTimeout = null;\n        }\n        if (this.ws) {\n            this.ws.close(1000, \"Normal closure\");\n            this.ws = null;\n        }\n        this.stateManager.reset();\n        this.clearPendingMessages();\n    }\n    /**\n     * Check if WebSocket is currently connected and ready\n     *\n     * @returns true if WebSocket is connected and ready to send/receive messages\n     */\n    isConnected() {\n        return (this.stateManager.getState().wsConnected &&\n            this.ws?.readyState === ws_1.default.OPEN);\n    }\n    /**\n     * Send a command message to the WebSocket server and wait for response\n     *\n     * Sends a command message with correlation ID and waits for the corresponding\n     * response. Handles message timeouts and connection state validation.\n     *\n     * @param message - Command message to send (must include messageId for correlation)\n     * @returns Promise that resolves with the server response or rejects on error/timeout\n     * @throws Error if not connected, message times out, or server returns an error\n     */\n    async sendMessage(message) {\n        return new Promise((resolve, reject) => {\n            if (!this.isConnected()) {\n                reject(new Error(\"WebSocket is not connected\"));\n                return;\n            }\n            const timeout = setTimeout(() => {\n                this.pendingMessages.delete(message.messageId);\n                reject(new Error(`Message timeout: ${message.messageId}`));\n            }, this.messageTimeout);\n            this.pendingMessages.set(message.messageId, {\n                resolve,\n                reject,\n                timeout,\n            });\n            try {\n                this.ws.send(JSON.stringify(message));\n            }\n            catch (error) {\n                this.pendingMessages.delete(message.messageId);\n                clearTimeout(timeout);\n                reject(error);\n            }\n        });\n    }\n    /**\n     * Process incoming WebSocket messages based on type\n     *\n     * Routes different message types to appropriate handlers:\n     * - VERSION: Schema negotiation messages\n     * - EVENT: Real-time event notifications\n     * - RESULT/RESPONSE: Command response correlation\n     *\n     * Optimized for performance with early type checking and minimal object creation.\n     *\n     * @param message - Parsed WebSocket message from server\n     * @private\n     */\n    handleMessage(message) {\n        // Performance tracking\n        this.messageCount++;\n        this.lastMessageTime = Date.now();\n        // Early type-based routing for performance\n        const messageType = message.type;\n        if (messageType === websocket_types_1.MESSAGE_TYPES.VERSION) {\n            this.stateManager.setConnectionState(client_state_1.ConnectionState.SCHEMA_NEGOTIATING);\n            this.onVersionHandler?.(message);\n            return;\n        }\n        if (messageType === websocket_types_1.MESSAGE_TYPES.EVENT) {\n            this.onEventHandler?.(message);\n            return;\n        }\n        // Handle command responses with message correlation\n        const messageId = message.messageId;\n        if (messageId && this.pendingMessages.has(messageId)) {\n            const pending = this.pendingMessages.get(messageId);\n            this.pendingMessages.delete(messageId);\n            clearTimeout(pending.timeout);\n            const success = message.success;\n            if (success === false) {\n                const errorCode = message.errorCode || \"Unknown error\";\n                pending.reject(new Error(`Command failed: ${errorCode}`));\n            }\n            else {\n                const result = message.result || message;\n                pending.resolve(result);\n            }\n            return;\n        }\n        // Log unhandled messages only if logging is enabled\n        if (this.logger) {\n            this.logger.info(\"Unhandled message type:\", messageType);\n        }\n    }\n    /**\n     * Schedule automatic reconnection with exponential backoff\n     *\n     * Implements exponential backoff strategy for reconnection attempts to avoid\n     * overwhelming the server. Respects maximum retry limits and existing reconnection\n     * attempts to prevent multiple concurrent reconnection processes.\n     *\n     * Backoff formula: min(1000 * 2^attempts, 30000) milliseconds + jitter\n     *\n     * @private\n     */\n    scheduleReconnect() {\n        const state = this.stateManager.getState();\n        if (this.reconnectTimeout ||\n            state.reconnectAttempts >= this.maxReconnectAttempts) {\n            return;\n        }\n        // Exponential backoff with jitter to prevent thundering herd\n        const baseDelay = Math.min(1000 * Math.pow(2, state.reconnectAttempts), 30000);\n        const jitter = Math.random() * 0.1 * baseDelay; // 10% jitter\n        const delay = baseDelay + jitter;\n        this.stateManager.setReconnectAttempts(state.reconnectAttempts + 1);\n        if (this.logger) {\n            this.logger.info(`Scheduling reconnection attempt ${state.reconnectAttempts + 1}/${this.maxReconnectAttempts} in ${Math.round(delay)}ms`);\n        }\n        this.reconnectTimeout = setTimeout(async () => {\n            this.reconnectTimeout = null;\n            try {\n                await this.connect();\n            }\n            catch (error) {\n                if (this.logger) {\n                    this.logger.info(\"Reconnection attempt failed:\", error);\n                }\n                // Will trigger another reconnect attempt if under limit\n            }\n        }, delay);\n    }\n    /**\n     * Clean up all pending message promises on disconnection\n     *\n     * Rejects all pending message promises with connection error and clears\n     * their timeout handlers to prevent memory leaks. Called during disconnection\n     * or connection loss to ensure no promises remain hanging.\n     *\n     * @private\n     */\n    clearPendingMessages() {\n        for (const pending of this.pendingMessages.values()) {\n            clearTimeout(pending.timeout);\n            pending.reject(new Error(\"Connection closed\"));\n        }\n        this.pendingMessages.clear();\n    }\n    /**\n     * Get performance metrics for monitoring and debugging\n     *\n     * @returns Performance metrics object\n     * @public\n     */\n    getPerformanceMetrics() {\n        const state = this.stateManager.getState();\n        return {\n            messageCount: this.messageCount,\n            lastMessageTime: this.lastMessageTime,\n            pendingMessageCount: this.pendingMessages.size,\n            isConnected: this.isConnected(),\n            reconnectAttempts: state.reconnectAttempts,\n        };\n    }\n    /**\n     * Reset performance metrics\n     *\n     * @public\n     */\n    resetPerformanceMetrics() {\n        this.messageCount = 0;\n        this.lastMessageTime = 0;\n        this.messageProcessor.resetStats();\n    }\n    /**\n     * Get message processing statistics\n     *\n     * @public\n     */\n    getMessageProcessingStats() {\n        return this.messageProcessor.getStats();\n    }\n}\nexports.WebSocketClient = WebSocketClient;\n//# sourceMappingURL=websocket-client.js.map","module.exports = require(\"fs\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export const prettyLogStyles = {\n    reset: [0, 0],\n    bold: [1, 22],\n    dim: [2, 22],\n    italic: [3, 23],\n    underline: [4, 24],\n    overline: [53, 55],\n    inverse: [7, 27],\n    hidden: [8, 28],\n    strikethrough: [9, 29],\n    black: [30, 39],\n    red: [31, 39],\n    green: [32, 39],\n    yellow: [33, 39],\n    blue: [34, 39],\n    magenta: [35, 39],\n    cyan: [36, 39],\n    white: [37, 39],\n    blackBright: [90, 39],\n    redBright: [91, 39],\n    greenBright: [92, 39],\n    yellowBright: [93, 39],\n    blueBright: [94, 39],\n    magentaBright: [95, 39],\n    cyanBright: [96, 39],\n    whiteBright: [97, 39],\n    bgBlack: [40, 49],\n    bgRed: [41, 49],\n    bgGreen: [42, 49],\n    bgYellow: [43, 49],\n    bgBlue: [44, 49],\n    bgMagenta: [45, 49],\n    bgCyan: [46, 49],\n    bgWhite: [47, 49],\n    bgBlackBright: [100, 49],\n    bgRedBright: [101, 49],\n    bgGreenBright: [102, 49],\n    bgYellowBright: [103, 49],\n    bgBlueBright: [104, 49],\n    bgMagentaBright: [105, 49],\n    bgCyanBright: [106, 49],\n    bgWhiteBright: [107, 49],\n};\n","import { prettyLogStyles } from \"./prettyLogStyles.js\";\nexport function formatTemplate(settings, template, values, hideUnsetPlaceholder = false) {\n    const templateString = String(template);\n    const ansiColorWrap = (placeholderValue, code) => `\\u001b[${code[0]}m${placeholderValue}\\u001b[${code[1]}m`;\n    const styleWrap = (value, style) => {\n        if (style != null && typeof style === \"string\") {\n            return ansiColorWrap(value, prettyLogStyles[style]);\n        }\n        else if (style != null && Array.isArray(style)) {\n            return style.reduce((prevValue, thisStyle) => styleWrap(prevValue, thisStyle), value);\n        }\n        else {\n            if (style != null && style[value.trim()] != null) {\n                return styleWrap(value, style[value.trim()]);\n            }\n            else if (style != null && style[\"*\"] != null) {\n                return styleWrap(value, style[\"*\"]);\n            }\n            else {\n                return value;\n            }\n        }\n    };\n    const defaultStyle = null;\n    return templateString.replace(/{{(.+?)}}/g, (_, placeholder) => {\n        const value = values[placeholder] != null ? String(values[placeholder]) : hideUnsetPlaceholder ? \"\" : _;\n        return settings.stylePrettyLogs\n            ? styleWrap(value, settings?.prettyLogStyles?.[placeholder] ?? defaultStyle) + ansiColorWrap(\"\", prettyLogStyles.reset)\n            : value;\n    });\n}\n","export function formatNumberAddZeros(value, digits = 2, addNumber = 0) {\n    if (value != null && isNaN(value)) {\n        return \"\";\n    }\n    value = value != null ? value + addNumber : value;\n    return digits === 2\n        ? value == null\n            ? \"--\"\n            : value < 10\n                ? \"0\" + value\n                : value.toString()\n        : value == null\n            ? \"---\"\n            : value < 10\n                ? \"00\" + value\n                : value < 100\n                    ? \"0\" + value\n                    : value.toString();\n}\n","import { formatTemplate } from \"../formatTemplate.js\";\nimport { formatNumberAddZeros } from \"../formatNumberAddZeros.js\";\nexport function buildPrettyMeta(settings, meta) {\n    if (meta == null) {\n        return {\n            text: \"\",\n            template: settings.prettyLogTemplate,\n            placeholders: {},\n        };\n    }\n    let template = settings.prettyLogTemplate;\n    const placeholderValues = {};\n    if (template.includes(\"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}\")) {\n        template = template.replace(\"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}\", \"{{dateIsoStr}}\");\n    }\n    else {\n        if (settings.prettyLogTimeZone === \"UTC\") {\n            placeholderValues[\"yyyy\"] = meta.date?.getUTCFullYear() ?? \"----\";\n            placeholderValues[\"mm\"] = formatNumberAddZeros(meta.date?.getUTCMonth(), 2, 1);\n            placeholderValues[\"dd\"] = formatNumberAddZeros(meta.date?.getUTCDate(), 2);\n            placeholderValues[\"hh\"] = formatNumberAddZeros(meta.date?.getUTCHours(), 2);\n            placeholderValues[\"MM\"] = formatNumberAddZeros(meta.date?.getUTCMinutes(), 2);\n            placeholderValues[\"ss\"] = formatNumberAddZeros(meta.date?.getUTCSeconds(), 2);\n            placeholderValues[\"ms\"] = formatNumberAddZeros(meta.date?.getUTCMilliseconds(), 3);\n        }\n        else {\n            placeholderValues[\"yyyy\"] = meta.date?.getFullYear() ?? \"----\";\n            placeholderValues[\"mm\"] = formatNumberAddZeros(meta.date?.getMonth(), 2, 1);\n            placeholderValues[\"dd\"] = formatNumberAddZeros(meta.date?.getDate(), 2);\n            placeholderValues[\"hh\"] = formatNumberAddZeros(meta.date?.getHours(), 2);\n            placeholderValues[\"MM\"] = formatNumberAddZeros(meta.date?.getMinutes(), 2);\n            placeholderValues[\"ss\"] = formatNumberAddZeros(meta.date?.getSeconds(), 2);\n            placeholderValues[\"ms\"] = formatNumberAddZeros(meta.date?.getMilliseconds(), 3);\n        }\n    }\n    const dateInSettingsTimeZone = settings.prettyLogTimeZone === \"UTC\" ? meta.date : meta.date != null ? new Date(meta.date.getTime() - meta.date.getTimezoneOffset() * 60000) : undefined;\n    placeholderValues[\"rawIsoStr\"] = dateInSettingsTimeZone?.toISOString() ?? \"\";\n    placeholderValues[\"dateIsoStr\"] = dateInSettingsTimeZone?.toISOString().replace(\"T\", \" \").replace(\"Z\", \"\") ?? \"\";\n    placeholderValues[\"logLevelName\"] = meta.logLevelName;\n    placeholderValues[\"fileNameWithLine\"] = meta.path?.fileNameWithLine ?? \"\";\n    placeholderValues[\"filePathWithLine\"] = meta.path?.filePathWithLine ?? \"\";\n    placeholderValues[\"fullFilePath\"] = meta.path?.fullFilePath ?? \"\";\n    let parentNamesString = settings.parentNames?.join(settings.prettyErrorParentNamesSeparator);\n    parentNamesString = parentNamesString != null && meta.name != null ? parentNamesString + settings.prettyErrorParentNamesSeparator : undefined;\n    const combinedName = meta.name != null || parentNamesString != null ? `${parentNamesString ?? \"\"}${meta.name ?? \"\"}` : \"\";\n    placeholderValues[\"name\"] = combinedName;\n    placeholderValues[\"nameWithDelimiterPrefix\"] = combinedName.length > 0 ? settings.prettyErrorLoggerNameDelimiter + combinedName : \"\";\n    placeholderValues[\"nameWithDelimiterSuffix\"] = combinedName.length > 0 ? combinedName + settings.prettyErrorLoggerNameDelimiter : \"\";\n    if (settings.overwrite?.addPlaceholders != null) {\n        settings.overwrite.addPlaceholders(meta, placeholderValues);\n    }\n    return {\n        text: formatTemplate(settings, template, placeholderValues),\n        template,\n        placeholders: placeholderValues,\n    };\n}\n","import { buildStackTrace } from \"./stackTrace.js\";\nconst DEFAULT_CAUSE_DEPTH = 5;\nexport function collectErrorCauses(error, options = {}) {\n    const maxDepth = options.maxDepth ?? DEFAULT_CAUSE_DEPTH;\n    const causes = [];\n    const visited = new Set();\n    let current = error;\n    let depth = 0;\n    while (current != null && depth < maxDepth) {\n        const cause = current?.cause;\n        if (cause == null || visited.has(cause)) {\n            break;\n        }\n        visited.add(cause);\n        causes.push(toError(cause));\n        current = cause;\n        depth += 1;\n    }\n    return causes;\n}\nexport function toError(value) {\n    if (value instanceof Error) {\n        return value;\n    }\n    const error = new Error(typeof value === \"string\" ? value : JSON.stringify(value));\n    if (typeof value === \"object\" && value != null) {\n        Object.assign(error, value);\n    }\n    return error;\n}\nexport function toErrorObject(error, parseLine) {\n    return {\n        nativeError: error,\n        name: error.name ?? \"Error\",\n        message: error.message ?? \"\",\n        stack: buildStackTrace(error, parseLine),\n    };\n}\n","export function jsonStringifyRecursive(obj) {\n    const cache = new Set();\n    return JSON.stringify(obj, (key, value) => {\n        if (typeof value === \"object\" && value !== null) {\n            if (cache.has(value)) {\n                return \"[Circular]\";\n            }\n            cache.add(value);\n        }\n        if (typeof value === \"bigint\") {\n            return `${value}`;\n        }\n        if (typeof value === \"undefined\") {\n            return \"[undefined]\";\n        }\n        return value;\n    });\n}\n","import { prettyLogStyles } from \"../prettyLogStyles.js\";\nimport { jsonStringifyRecursive } from \"./jsonStringifyRecursive.js\";\nexport function inspect(obj, opts) {\n    const ctx = {\n        seen: [],\n        stylize: stylizeNoColor,\n    };\n    if (opts != null) {\n        _extend(ctx, opts);\n    }\n    if (isUndefined(ctx.showHidden))\n        ctx.showHidden = false;\n    if (isUndefined(ctx.depth))\n        ctx.depth = 2;\n    if (isUndefined(ctx.colors))\n        ctx.colors = true;\n    if (isUndefined(ctx.customInspect))\n        ctx.customInspect = true;\n    if (ctx.colors)\n        ctx.stylize = stylizeWithColor;\n    return formatValue(ctx, obj, ctx.depth);\n}\ninspect.colors = prettyLogStyles;\ninspect.styles = {\n    special: \"cyan\",\n    number: \"yellow\",\n    boolean: \"yellow\",\n    undefined: \"grey\",\n    null: \"bold\",\n    string: \"green\",\n    date: \"magenta\",\n    regexp: \"red\",\n};\nfunction isBoolean(arg) {\n    return typeof arg === \"boolean\";\n}\nfunction isUndefined(arg) {\n    return arg === undefined;\n}\nfunction stylizeNoColor(str) {\n    return str;\n}\nfunction stylizeWithColor(str, styleType) {\n    const style = inspect.styles[styleType];\n    if (style != null && inspect?.colors?.[style]?.[0] != null && inspect?.colors?.[style]?.[1] != null) {\n        return \"\\u001b[\" + inspect.colors[style][0] + \"m\" + str + \"\\u001b[\" + inspect.colors[style][1] + \"m\";\n    }\n    else {\n        return str;\n    }\n}\nfunction isFunction(arg) {\n    return typeof arg === \"function\";\n}\nfunction isString(arg) {\n    return typeof arg === \"string\";\n}\nfunction isNumber(arg) {\n    return typeof arg === \"number\";\n}\nfunction isNull(arg) {\n    return arg === null;\n}\nfunction hasOwn(obj, prop) {\n    return Object.prototype.hasOwnProperty.call(obj, prop);\n}\nfunction isRegExp(re) {\n    return isObject(re) && objectToString(re) === \"[object RegExp]\";\n}\nfunction isObject(arg) {\n    return typeof arg === \"object\" && arg !== null;\n}\nfunction isError(e) {\n    return isObject(e) && (objectToString(e) === \"[object Error]\" || e instanceof Error);\n}\nfunction isDate(d) {\n    return isObject(d) && objectToString(d) === \"[object Date]\";\n}\nfunction objectToString(o) {\n    return Object.prototype.toString.call(o);\n}\nfunction arrayToHash(array) {\n    const hash = {};\n    array.forEach((val) => {\n        hash[val] = true;\n    });\n    return hash;\n}\nfunction formatArray(ctx, value, recurseTimes, visibleKeys, keys) {\n    const output = [];\n    for (let i = 0, l = value.length; i < l; ++i) {\n        if (hasOwn(value, String(i))) {\n            output.push(formatProperty(ctx, value, recurseTimes, visibleKeys, String(i), true));\n        }\n        else {\n            output.push(\"\");\n        }\n    }\n    keys.forEach((key) => {\n        if (!key.match(/^\\d+$/)) {\n            output.push(formatProperty(ctx, value, recurseTimes, visibleKeys, key, true));\n        }\n    });\n    return output;\n}\nfunction formatError(value) {\n    return \"[\" + Error.prototype.toString.call(value) + \"]\";\n}\nexport function formatValue(ctx, value, recurseTimes = 0) {\n    if (ctx.customInspect &&\n        value != null &&\n        isFunction(value) &&\n        value?.inspect !== inspect &&\n        !(value?.constructor && value?.constructor.prototype === value)) {\n        if (typeof value.inspect !== \"function\" && value.toString != null) {\n            return value.toString();\n        }\n        let ret = value?.inspect(recurseTimes, ctx);\n        if (!isString(ret)) {\n            ret = formatValue(ctx, ret, recurseTimes);\n        }\n        return ret;\n    }\n    const primitive = formatPrimitive(ctx, value);\n    if (primitive) {\n        return primitive;\n    }\n    let keys = Object.keys(value);\n    const visibleKeys = arrayToHash(keys);\n    try {\n        if (ctx.showHidden && Object.getOwnPropertyNames) {\n            keys = Object.getOwnPropertyNames(value);\n        }\n    }\n    catch {\n    }\n    if (isError(value) && (keys.indexOf(\"message\") >= 0 || keys.indexOf(\"description\") >= 0)) {\n        return formatError(value);\n    }\n    if (keys.length === 0) {\n        if (isFunction(ctx.stylize)) {\n            if (isFunction(value)) {\n                const name = value.name ? \": \" + value.name : \"\";\n                return ctx.stylize(\"[Function\" + name + \"]\", \"special\");\n            }\n            if (isRegExp(value)) {\n                return ctx.stylize(RegExp.prototype.toString.call(value), \"regexp\");\n            }\n            if (isDate(value)) {\n                return ctx.stylize(Date.prototype.toISOString.call(value), \"date\");\n            }\n            if (isError(value)) {\n                return formatError(value);\n            }\n        }\n        else {\n            return value;\n        }\n    }\n    let base = \"\";\n    let array = false;\n    let braces = [\"{\\n\", \"\\n}\"];\n    if (Array.isArray(value)) {\n        array = true;\n        braces = [\"[\\n\", \"\\n]\"];\n    }\n    if (isFunction(value)) {\n        const n = value.name ? \": \" + value.name : \"\";\n        base = \" [Function\" + n + \"]\";\n    }\n    if (isRegExp(value)) {\n        base = \" \" + RegExp.prototype.toString.call(value);\n    }\n    if (isDate(value)) {\n        base = \" \" + Date.prototype.toUTCString.call(value);\n    }\n    if (isError(value)) {\n        base = \" \" + formatError(value);\n    }\n    if (keys.length === 0 && (!array || value.length == 0)) {\n        return braces[0] + base + braces[1];\n    }\n    if (recurseTimes < 0) {\n        if (isRegExp(value)) {\n            return ctx.stylize(RegExp.prototype.toString.call(value), \"regexp\");\n        }\n        else {\n            return ctx.stylize(\"[Object]\", \"special\");\n        }\n    }\n    ctx.seen.push(value);\n    let output;\n    if (array) {\n        output = formatArray(ctx, value, recurseTimes, visibleKeys, keys);\n    }\n    else {\n        output = keys.map((key) => {\n            return formatProperty(ctx, value, recurseTimes, visibleKeys, key, array);\n        });\n    }\n    ctx.seen.pop();\n    return reduceToSingleString(output, base, braces);\n}\nfunction formatProperty(ctx, value, recurseTimes, visibleKeys, key, array) {\n    let name, str;\n    let desc = { value: void 0 };\n    try {\n        desc.value = value[key];\n    }\n    catch {\n    }\n    try {\n        if (Object.getOwnPropertyDescriptor) {\n            desc = Object.getOwnPropertyDescriptor(value, key) || desc;\n        }\n    }\n    catch {\n    }\n    if (desc.get) {\n        if (desc.set) {\n            str = ctx.stylize(\"[Getter/Setter]\", \"special\");\n        }\n        else {\n            str = ctx.stylize(\"[Getter]\", \"special\");\n        }\n    }\n    else {\n        if (desc.set) {\n            str = ctx.stylize(\"[Setter]\", \"special\");\n        }\n    }\n    if (!hasOwn(visibleKeys, key)) {\n        name = \"[\" + key + \"]\";\n    }\n    if (!str) {\n        if (ctx.seen.indexOf(desc.value) < 0) {\n            if (isNull(recurseTimes)) {\n                str = formatValue(ctx, desc.value, undefined);\n            }\n            else {\n                str = formatValue(ctx, desc.value, recurseTimes - 1);\n            }\n            if (str.indexOf(\"\\n\") > -1) {\n                if (array) {\n                    str = str\n                        .split(\"\\n\")\n                        .map((line) => {\n                        return \"  \" + line;\n                    })\n                        .join(\"\\n\")\n                        .substr(2);\n                }\n                else {\n                    str =\n                        \"\\n\" +\n                            str\n                                .split(\"\\n\")\n                                .map((line) => {\n                                return \"   \" + line;\n                            })\n                                .join(\"\\n\");\n                }\n            }\n        }\n        else {\n            str = ctx.stylize(\"[Circular]\", \"special\");\n        }\n    }\n    if (isUndefined(name)) {\n        if (array && key.match(/^\\d+$/)) {\n            return str;\n        }\n        name = JSON.stringify(\"\" + key);\n        if (name.match(/^\"([a-zA-Z_][a-zA-Z_0-9]*)\"$/)) {\n            name = name.substr(1, name.length - 2);\n            name = ctx.stylize(name, \"name\");\n        }\n        else {\n            name = name\n                .replace(/'/g, \"\\\\'\")\n                .replace(/\\\\\"/g, \"\\\\'\")\n                .replace(/(^\"|\"$)/g, \"'\");\n            name = ctx.stylize(name, \"string\");\n        }\n    }\n    return name + \": \" + str;\n}\nfunction formatPrimitive(ctx, value) {\n    if (isUndefined(value))\n        return ctx.stylize(\"undefined\", \"undefined\");\n    if (isString(value)) {\n        const simple = \"'\" + JSON.stringify(value).replace(/^\"|\"$/g, \"\").replace(/'/g, \"\\\\'\").replace(/\\\\\"/g, \"\\\\'\") + \"'\";\n        return ctx.stylize(simple, \"string\");\n    }\n    if (isNumber(value))\n        return ctx.stylize(\"\" + value, \"number\");\n    if (isBoolean(value))\n        return ctx.stylize(\"\" + value, \"boolean\");\n    if (isNull(value))\n        return ctx.stylize(\"null\", \"null\");\n}\nfunction reduceToSingleString(output, base, braces) {\n    return braces[0] + (base === \"\" ? \"\" : base + \"\\n\") + \"  \" + output.join(\",\\n  \") + \" \" + braces[1];\n}\nfunction _extend(origin, add) {\n    const typedOrigin = { ...origin };\n    if (!add || !isObject(add))\n        return origin;\n    const clonedAdd = { ...add };\n    const keys = Object.keys(add);\n    let i = keys.length;\n    while (i--) {\n        typedOrigin[keys[i]] = clonedAdd[keys[i]];\n    }\n    return typedOrigin;\n}\nexport function formatWithOptions(inspectOptions, ...args) {\n    const ctx = {\n        seen: [],\n        stylize: stylizeNoColor,\n    };\n    if (inspectOptions != null) {\n        _extend(ctx, inspectOptions);\n    }\n    const first = args[0];\n    let a = 0;\n    let str = \"\";\n    let join = \"\";\n    if (typeof first === \"string\") {\n        if (args.length === 1) {\n            return first;\n        }\n        let tempStr;\n        let lastPos = 0;\n        for (let i = 0; i < first.length - 1; i++) {\n            if (first.charCodeAt(i) === 37) {\n                const nextChar = first.charCodeAt(++i);\n                if (a + 1 !== args.length) {\n                    switch (nextChar) {\n                        case 115: {\n                            const tempArg = args[++a];\n                            if (typeof tempArg === \"number\") {\n                                tempStr = formatPrimitive(ctx, tempArg);\n                            }\n                            else if (typeof tempArg === \"bigint\") {\n                                tempStr = formatPrimitive(ctx, tempArg);\n                            }\n                            else if (typeof tempArg !== \"object\" || tempArg === null) {\n                                tempStr = String(tempArg);\n                            }\n                            else {\n                                tempStr = inspect(tempArg, {\n                                    ...inspectOptions,\n                                    compact: 3,\n                                    colors: false,\n                                    depth: 0,\n                                });\n                            }\n                            break;\n                        }\n                        case 106:\n                            tempStr = jsonStringifyRecursive(args[++a]);\n                            break;\n                        case 100: {\n                            const tempNum = args[++a];\n                            if (typeof tempNum === \"bigint\") {\n                                tempStr = formatPrimitive(ctx, tempNum);\n                            }\n                            else if (typeof tempNum === \"symbol\") {\n                                tempStr = \"NaN\";\n                            }\n                            else {\n                                tempStr = formatPrimitive(ctx, tempNum);\n                            }\n                            break;\n                        }\n                        case 79:\n                            tempStr = inspect(args[++a], inspectOptions);\n                            break;\n                        case 111:\n                            tempStr = inspect(args[++a], {\n                                ...inspectOptions,\n                                showHidden: true,\n                                showProxy: true,\n                                depth: 4,\n                            });\n                            break;\n                        case 105: {\n                            const tempInteger = args[++a];\n                            if (typeof tempInteger === \"bigint\") {\n                                tempStr = formatPrimitive(ctx, tempInteger);\n                            }\n                            else if (typeof tempInteger === \"symbol\") {\n                                tempStr = \"NaN\";\n                            }\n                            else {\n                                tempStr = formatPrimitive(ctx, parseInt(tempStr));\n                            }\n                            break;\n                        }\n                        case 102: {\n                            const tempFloat = args[++a];\n                            if (typeof tempFloat === \"symbol\") {\n                                tempStr = \"NaN\";\n                            }\n                            else {\n                                tempStr = formatPrimitive(ctx, parseInt(tempFloat));\n                            }\n                            break;\n                        }\n                        case 99:\n                            a += 1;\n                            tempStr = \"\";\n                            break;\n                        case 37:\n                            str += first.slice(lastPos, i);\n                            lastPos = i + 1;\n                            continue;\n                        default:\n                            continue;\n                    }\n                    if (lastPos !== i - 1) {\n                        str += first.slice(lastPos, i - 1);\n                    }\n                    str += tempStr;\n                    lastPos = i + 1;\n                }\n                else if (nextChar === 37) {\n                    str += first.slice(lastPos, i);\n                    lastPos = i + 1;\n                }\n            }\n        }\n        if (lastPos !== 0) {\n            a++;\n            join = \" \";\n            if (lastPos < first.length) {\n                str += first.slice(lastPos);\n            }\n        }\n    }\n    while (a < args.length) {\n        const value = args[a];\n        str += join;\n        str += typeof value !== \"string\" ? inspect(value, inspectOptions) : value;\n        join = \" \";\n        a++;\n    }\n    return str;\n}\n","const DEFAULT_IGNORE_PATTERNS = [\n    /(?:^|[\\\\/])node_modules[\\\\/].*tslog/i,\n    /(?:^|[\\\\/])deps[\\\\/].*tslog/i,\n    /tslog[\\\\/]+src[\\\\/]+internal[\\\\/]/i,\n    /tslog[\\\\/]+src[\\\\/]BaseLogger/i,\n    /tslog[\\\\/]+src[\\\\/]index/i,\n];\nexport function splitStackLines(error) {\n    const stack = typeof error?.stack === \"string\" ? error.stack : undefined;\n    if (stack == null || stack.length === 0) {\n        return [];\n    }\n    return stack.split(\"\\n\").map((line) => line.trimEnd());\n}\nexport function sanitizeStackLines(lines) {\n    return lines.filter((line) => line.length > 0 && !/^\\s*Error\\b/.test(line));\n}\nexport function toStackFrames(lines, parseLine) {\n    const frames = [];\n    for (const line of lines) {\n        const frame = parseLine(line);\n        if (frame != null) {\n            frames.push(frame);\n        }\n    }\n    return frames;\n}\nexport function findFirstExternalFrameIndex(frames, ignorePatterns = DEFAULT_IGNORE_PATTERNS) {\n    for (let index = 0; index < frames.length; index += 1) {\n        const frame = frames[index];\n        const filePathCandidate = frame.filePath ?? \"\";\n        const fullPathCandidate = frame.fullFilePath ?? \"\";\n        if (!ignorePatterns.some((pattern) => pattern.test(filePathCandidate) || pattern.test(fullPathCandidate))) {\n            return index;\n        }\n    }\n    return 0;\n}\nexport function getFrameAt(frames, index) {\n    if (index < 0 || index >= frames.length) {\n        return undefined;\n    }\n    return frames[index];\n}\nexport function getCleanStackLines(error) {\n    return sanitizeStackLines(splitStackLines(error));\n}\nexport function buildStackTrace(error, parseLine) {\n    return toStackFrames(getCleanStackLines(error), parseLine);\n}\nexport function isIgnorableFrame(frame, ignorePatterns) {\n    const filePathCandidate = frame.filePath ?? \"\";\n    const fullPathCandidate = frame.fullFilePath ?? \"\";\n    return ignorePatterns.some((pattern) => pattern.test(filePathCandidate) || pattern.test(fullPathCandidate));\n}\nexport function clampIndex(index, maxExclusive) {\n    if (index < 0) {\n        return 0;\n    }\n    if (index >= maxExclusive) {\n        return Math.max(0, maxExclusive - 1);\n    }\n    return index;\n}\nexport function pickCallerStackFrame(error, parseLine, options = {}) {\n    const lines = getCleanStackLines(error);\n    const frames = toStackFrames(lines, parseLine);\n    if (frames.length === 0) {\n        return undefined;\n    }\n    const ignorePatterns = options.ignorePatterns ?? DEFAULT_IGNORE_PATTERNS;\n    const autoIndex = findFirstExternalFrameIndex(frames, ignorePatterns);\n    const resolvedIndex = options.stackDepthLevel != null ? options.stackDepthLevel : autoIndex;\n    return getFrameAt(frames, clampIndex(resolvedIndex, frames.length));\n}\nexport function getDefaultIgnorePatterns() {\n    return [...DEFAULT_IGNORE_PATTERNS];\n}\n","export function safeGetCwd() {\n    try {\n        const nodeProcess = globalThis?.process;\n        if (typeof nodeProcess?.cwd === \"function\") {\n            return nodeProcess.cwd();\n        }\n    }\n    catch {\n    }\n    try {\n        const deno = globalThis?.[\"Deno\"];\n        if (typeof deno?.cwd === \"function\") {\n            return deno.cwd();\n        }\n    }\n    catch {\n    }\n    return undefined;\n}\nexport function isBrowserEnvironment() {\n    return typeof window !== \"undefined\" && typeof document !== \"undefined\";\n}\nexport function consoleSupportsCssStyling() {\n    if (!isBrowserEnvironment()) {\n        return false;\n    }\n    const navigatorObj = globalThis?.navigator;\n    const userAgent = navigatorObj?.userAgent ?? \"\";\n    if (/firefox/i.test(userAgent)) {\n        return true;\n    }\n    const windowObj = globalThis;\n    if (windowObj?.CSS?.supports?.(\"color\", \"#000\")) {\n        return true;\n    }\n    return /safari/i.test(userAgent) && !/chrome/i.test(userAgent);\n}\n","import { urlToObject } from \"./urlToObj.js\";\nimport { buildPrettyMeta } from \"./internal/metaFormatting.js\";\nimport { toError, collectErrorCauses } from \"./internal/errorUtils.js\";\nimport { formatTemplate } from \"./formatTemplate.js\";\nimport { formatWithOptions } from \"./internal/util.inspect.polyfill.js\";\nimport { buildStackTrace, findFirstExternalFrameIndex, clampIndex, getDefaultIgnorePatterns } from \"./internal/stackTrace.js\";\nimport { safeGetCwd, consoleSupportsCssStyling, isBrowserEnvironment } from \"./internal/environment.js\";\nimport { jsonStringifyRecursive } from \"./internal/jsonStringifyRecursive.js\";\nexport function createLoggerEnvironment() {\n    const runtimeInfo = detectRuntimeInfo();\n    const meta = createRuntimeMeta(runtimeInfo);\n    const usesBrowserStack = runtimeInfo.name === \"browser\" || runtimeInfo.name === \"worker\";\n    const callerIgnorePatterns = usesBrowserStack\n        ? [...getDefaultIgnorePatterns(), /node_modules[\\\\/].*tslog/i]\n        : [...getDefaultIgnorePatterns(), /node:(?:internal|vm)/i, /\\binternal[\\\\/]/i];\n    let cachedCwd;\n    const environment = {\n        getMeta(logLevelId, logLevelName, stackDepthLevel, hideLogPositionForPerformance, name, parentNames) {\n            return Object.assign({}, meta, {\n                name,\n                parentNames,\n                date: new Date(),\n                logLevelId,\n                logLevelName,\n                path: !hideLogPositionForPerformance ? environment.getCallerStackFrame(stackDepthLevel) : undefined,\n            });\n        },\n        getCallerStackFrame(stackDepthLevel, error = new Error()) {\n            const frames = buildStackTrace(error, (line) => parseStackLine(line));\n            if (frames.length === 0) {\n                return {};\n            }\n            const autoIndex = findFirstExternalFrameIndex(frames, callerIgnorePatterns);\n            const useManualIndex = Number.isFinite(stackDepthLevel) && stackDepthLevel >= 0;\n            const resolvedIndex = useManualIndex ? clampIndex(stackDepthLevel, frames.length) : clampIndex(autoIndex, frames.length);\n            return frames[resolvedIndex] ?? {};\n        },\n        getErrorTrace(error) {\n            return buildStackTrace(error, (line) => parseStackLine(line));\n        },\n        isError(value) {\n            return isNativeError(value);\n        },\n        isBuffer(value) {\n            return typeof Buffer !== \"undefined\" && typeof Buffer.isBuffer === \"function\" ? Buffer.isBuffer(value) : false;\n        },\n        prettyFormatLogObj(maskedArgs, settings) {\n            return maskedArgs.reduce((result, arg) => {\n                if (environment.isError(arg)) {\n                    result.errors.push(environment.prettyFormatErrorObj(arg, settings));\n                }\n                else {\n                    result.args.push(arg);\n                }\n                return result;\n            }, { args: [], errors: [] });\n        },\n        prettyFormatErrorObj(error, settings) {\n            const stackLines = formatStackFrames(environment.getErrorTrace(error), settings);\n            const causeSections = collectErrorCauses(error).map((cause, index) => {\n                const header = `Caused by (${index + 1}): ${cause.name ?? \"Error\"}${cause.message ? `: ${cause.message}` : \"\"}`;\n                const frames = formatStackFrames(buildStackTrace(cause, (line) => parseStackLine(line)), settings);\n                return [header, ...frames].join(\"\\n\");\n            });\n            const placeholderValuesError = {\n                errorName: ` ${error.name} `,\n                errorMessage: formatErrorMessage(error),\n                errorStack: [...stackLines, ...causeSections].join(\"\\n\"),\n            };\n            return formatTemplate(settings, settings.prettyErrorTemplate, placeholderValuesError);\n        },\n        transportFormatted(logMetaMarkup, logArgs, logErrors, logMeta, settings) {\n            const prettyLogs = settings.stylePrettyLogs !== false;\n            const logErrorsStr = (logErrors.length > 0 && logArgs.length > 0 ? \"\\n\" : \"\") + logErrors.join(\"\\n\");\n            const sanitizedMetaMarkup = stripAnsi(logMetaMarkup);\n            const metaMarkupForText = prettyLogs ? logMetaMarkup : sanitizedMetaMarkup;\n            if (shouldUseCss(prettyLogs)) {\n                settings.prettyInspectOptions.colors = false;\n                const formattedArgs = formatWithOptionsSafe(settings.prettyInspectOptions, logArgs);\n                const cssMeta = logMeta != null ? buildCssMetaOutput(settings, logMeta) : { text: sanitizedMetaMarkup, styles: [] };\n                const hasCssMeta = cssMeta.text.length > 0 && cssMeta.styles.length > 0;\n                const metaOutput = hasCssMeta ? cssMeta.text : sanitizedMetaMarkup;\n                const output = metaOutput + formattedArgs + logErrorsStr;\n                if (hasCssMeta) {\n                    console.log(output, ...cssMeta.styles);\n                }\n                else {\n                    console.log(output);\n                }\n                return;\n            }\n            settings.prettyInspectOptions.colors = prettyLogs;\n            const formattedArgs = formatWithOptionsSafe(settings.prettyInspectOptions, logArgs);\n            console.log(metaMarkupForText + formattedArgs + logErrorsStr);\n        },\n        transportJSON(json) {\n            console.log(jsonStringifyRecursive(json));\n        },\n    };\n    if (getNodeEnv() === \"test\") {\n        environment.__resetWorkingDirectoryCacheForTests = () => {\n            cachedCwd = undefined;\n        };\n    }\n    return environment;\n    function parseStackLine(line) {\n        return usesBrowserStack ? parseBrowserStackLine(line) : parseServerStackLine(line);\n    }\n    function parseServerStackLine(rawLine) {\n        if (typeof rawLine !== \"string\" || rawLine.length === 0) {\n            return undefined;\n        }\n        const trimmedLine = rawLine.trim();\n        if (!trimmedLine.includes(\" at \") && !trimmedLine.startsWith(\"at \")) {\n            return undefined;\n        }\n        const line = trimmedLine.replace(/^at\\s+/, \"\");\n        let method;\n        let location = line;\n        const methodMatch = line.match(/^(.*?)\\s+\\((.*)\\)$/);\n        if (methodMatch) {\n            method = methodMatch[1];\n            location = methodMatch[2];\n        }\n        const sanitizedLocation = location.replace(/^\\(/, \"\").replace(/\\)$/, \"\");\n        const withoutQuery = sanitizedLocation.replace(/\\?.*$/, \"\");\n        let fileLine;\n        let fileColumn;\n        let filePathCandidate = withoutQuery;\n        const segments = withoutQuery.split(\":\");\n        if (segments.length >= 3 && /^\\d+$/.test(segments[segments.length - 1] ?? \"\")) {\n            fileColumn = segments.pop();\n            fileLine = segments.pop();\n            filePathCandidate = segments.join(\":\");\n        }\n        else if (segments.length >= 2 && /^\\d+$/.test(segments[segments.length - 1] ?? \"\")) {\n            fileLine = segments.pop();\n            filePathCandidate = segments.join(\":\");\n        }\n        let normalizedPath = filePathCandidate.replace(/^file:\\/\\//, \"\");\n        const cwd = getWorkingDirectory();\n        if (cwd != null && normalizedPath.startsWith(cwd)) {\n            normalizedPath = normalizedPath.slice(cwd.length);\n            normalizedPath = normalizedPath.replace(/^[\\\\/]/, \"\");\n        }\n        if (normalizedPath.length === 0) {\n            normalizedPath = filePathCandidate;\n        }\n        const normalizedPathWithoutLine = normalizeFilePath(normalizedPath);\n        const effectivePath = normalizedPathWithoutLine.length > 0 ? normalizedPathWithoutLine : normalizedPath;\n        const pathSegments = effectivePath.split(/\\\\|\\//);\n        const fileName = pathSegments[pathSegments.length - 1];\n        const fileNameWithLine = fileName && fileLine ? `${fileName}:${fileLine}` : undefined;\n        const filePathWithLine = effectivePath && fileLine ? `${effectivePath}:${fileLine}` : undefined;\n        return {\n            fullFilePath: sanitizedLocation,\n            fileName,\n            fileNameWithLine,\n            fileColumn,\n            fileLine,\n            filePath: effectivePath,\n            filePathWithLine,\n            method,\n        };\n    }\n    function parseBrowserStackLine(line) {\n        const href = globalThis.location?.origin;\n        if (line == null) {\n            return undefined;\n        }\n        const match = line.match(BROWSER_PATH_REGEX);\n        if (!match) {\n            return undefined;\n        }\n        const filePath = match[1]?.replace(/\\?.*$/, \"\");\n        if (filePath == null) {\n            return undefined;\n        }\n        const pathParts = filePath.split(\"/\");\n        const fileLine = match[2];\n        const fileColumn = match[3];\n        const fileName = pathParts[pathParts.length - 1];\n        return {\n            fullFilePath: href ? `${href}${filePath}` : filePath,\n            fileName,\n            fileNameWithLine: fileName && fileLine ? `${fileName}:${fileLine}` : undefined,\n            fileColumn,\n            fileLine,\n            filePath,\n            filePathWithLine: fileLine ? `${filePath}:${fileLine}` : undefined,\n            method: undefined,\n        };\n    }\n    function formatStackFrames(frames, settings) {\n        return frames.map((stackFrame) => formatTemplate(settings, settings.prettyErrorStackTemplate, { ...stackFrame }, true));\n    }\n    function formatErrorMessage(error) {\n        return Object.getOwnPropertyNames(error)\n            .filter((key) => key !== \"stack\" && key !== \"cause\")\n            .reduce((result, key) => {\n            const value = error[key];\n            if (typeof value === \"function\") {\n                return result;\n            }\n            result.push(String(value));\n            return result;\n        }, [])\n            .join(\", \");\n    }\n    function shouldUseCss(prettyLogs) {\n        return prettyLogs && (runtimeInfo.name === \"browser\" || runtimeInfo.name === \"worker\") && consoleSupportsCssStyling();\n    }\n    function stripAnsi(value) {\n        return value.replace(ANSI_REGEX, \"\");\n    }\n    function buildCssMetaOutput(settings, metaValue) {\n        if (metaValue == null) {\n            return { text: \"\", styles: [] };\n        }\n        const { template, placeholders } = buildPrettyMeta(settings, metaValue);\n        const parts = [];\n        const styles = [];\n        let lastIndex = 0;\n        const placeholderRegex = /{{(.+?)}}/g;\n        let match;\n        while ((match = placeholderRegex.exec(template)) != null) {\n            if (match.index > lastIndex) {\n                parts.push(template.slice(lastIndex, match.index));\n            }\n            const key = match[1];\n            const rawValue = placeholders[key] != null ? String(placeholders[key]) : \"\";\n            const tokens = collectStyleTokens(settings.prettyLogStyles?.[key], rawValue);\n            const css = tokensToCss(tokens);\n            if (css.length > 0) {\n                parts.push(`%c${rawValue}%c`);\n                styles.push(css, \"\");\n            }\n            else {\n                parts.push(rawValue);\n            }\n            lastIndex = placeholderRegex.lastIndex;\n        }\n        if (lastIndex < template.length) {\n            parts.push(template.slice(lastIndex));\n        }\n        return {\n            text: parts.join(\"\"),\n            styles,\n        };\n    }\n    function collectStyleTokens(style, value) {\n        if (style == null) {\n            return [];\n        }\n        if (typeof style === \"string\") {\n            return [style];\n        }\n        if (Array.isArray(style)) {\n            return style.flatMap((token) => collectStyleTokens(token, value));\n        }\n        if (typeof style === \"object\") {\n            const normalizedValue = value.trim();\n            const nextStyle = style[normalizedValue] ?? style[\"*\"];\n            if (nextStyle == null) {\n                return [];\n            }\n            return collectStyleTokens(nextStyle, value);\n        }\n        return [];\n    }\n    function tokensToCss(tokens) {\n        const seen = new Set();\n        const cssParts = [];\n        for (const token of tokens) {\n            const css = styleTokenToCss(token);\n            if (css != null && css.length > 0 && !seen.has(css)) {\n                seen.add(css);\n                cssParts.push(css);\n            }\n        }\n        return cssParts.join(\"; \");\n    }\n    function styleTokenToCss(token) {\n        const color = COLOR_TOKENS[token];\n        if (color != null) {\n            return `color: ${color}`;\n        }\n        const background = BACKGROUND_TOKENS[token];\n        if (background != null) {\n            return `background-color: ${background}`;\n        }\n        switch (token) {\n            case \"bold\":\n                return \"font-weight: bold\";\n            case \"dim\":\n                return \"opacity: 0.75\";\n            case \"italic\":\n                return \"font-style: italic\";\n            case \"underline\":\n                return \"text-decoration: underline\";\n            case \"overline\":\n                return \"text-decoration: overline\";\n            case \"inverse\":\n                return \"filter: invert(1)\";\n            case \"hidden\":\n                return \"visibility: hidden\";\n            case \"strikethrough\":\n                return \"text-decoration: line-through\";\n            default:\n                return undefined;\n        }\n    }\n    function getWorkingDirectory() {\n        if (cachedCwd === undefined) {\n            cachedCwd = safeGetCwd() ?? null;\n        }\n        return cachedCwd ?? undefined;\n    }\n    function shouldCaptureHostname() {\n        return runtimeInfo.name === \"node\" || runtimeInfo.name === \"deno\" || runtimeInfo.name === \"bun\";\n    }\n    function shouldCaptureRuntimeVersion() {\n        return runtimeInfo.name === \"node\" || runtimeInfo.name === \"deno\" || runtimeInfo.name === \"bun\";\n    }\n    function createRuntimeMeta(info) {\n        if (info.name === \"browser\" || info.name === \"worker\") {\n            return {\n                runtime: info.name,\n                browser: info.userAgent,\n            };\n        }\n        const metaStatic = {\n            runtime: info.name,\n        };\n        if (shouldCaptureRuntimeVersion()) {\n            metaStatic.runtimeVersion = info.version ?? \"unknown\";\n        }\n        if (shouldCaptureHostname()) {\n            metaStatic.hostname = info.hostname ?? \"unknown\";\n        }\n        return metaStatic;\n    }\n    function formatWithOptionsSafe(options, args) {\n        try {\n            return formatWithOptions(options, ...args);\n        }\n        catch {\n            return args.map(stringifyFallback).join(\" \");\n        }\n    }\n    function stringifyFallback(value) {\n        if (typeof value === \"string\") {\n            return value;\n        }\n        try {\n            return JSON.stringify(value);\n        }\n        catch {\n            return String(value);\n        }\n    }\n    function normalizeFilePath(value) {\n        if (typeof value !== \"string\" || value.length === 0) {\n            return value;\n        }\n        const replaced = value.replace(/\\\\+/g, \"\\\\\").replace(/\\\\/g, \"/\");\n        const hasRootDoubleSlash = replaced.startsWith(\"//\");\n        const hasLeadingSlash = replaced.startsWith(\"/\") && !hasRootDoubleSlash;\n        const driveMatch = replaced.match(/^[A-Za-z]:/);\n        const drivePrefix = driveMatch ? driveMatch[0] : \"\";\n        const withoutDrive = drivePrefix ? replaced.slice(drivePrefix.length) : replaced;\n        const segments = withoutDrive.split(\"/\");\n        const normalizedSegments = [];\n        for (const segment of segments) {\n            if (segment === \"\" || segment === \".\") {\n                continue;\n            }\n            if (segment === \"..\") {\n                if (normalizedSegments.length > 0) {\n                    normalizedSegments.pop();\n                }\n                continue;\n            }\n            normalizedSegments.push(segment);\n        }\n        let normalized = normalizedSegments.join(\"/\");\n        if (hasRootDoubleSlash) {\n            normalized = `//${normalized}`;\n        }\n        else if (hasLeadingSlash) {\n            normalized = `/${normalized}`;\n        }\n        else if (drivePrefix !== \"\") {\n            normalized = `${drivePrefix}${normalized.length > 0 ? `/${normalized}` : \"\"}`;\n        }\n        if (normalized.length === 0) {\n            return value;\n        }\n        return normalized;\n    }\n    function detectRuntimeInfo() {\n        if (isBrowserEnvironment()) {\n            const navigatorObj = globalThis.navigator;\n            return {\n                name: \"browser\",\n                userAgent: navigatorObj?.userAgent,\n            };\n        }\n        const globalScope = globalThis;\n        if (typeof globalScope.importScripts === \"function\") {\n            return {\n                name: \"worker\",\n                userAgent: globalScope.navigator?.userAgent,\n            };\n        }\n        const globalAny = globalThis;\n        if (globalAny.Bun != null) {\n            const bunVersion = globalAny.Bun.version;\n            return {\n                name: \"bun\",\n                version: bunVersion != null ? `bun/${bunVersion}` : undefined,\n                hostname: getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        if (globalAny.Deno != null) {\n            const denoHostname = resolveDenoHostname(globalAny.Deno);\n            const denoVersion = globalAny.Deno?.version?.deno;\n            return {\n                name: \"deno\",\n                version: denoVersion != null ? `deno/${denoVersion}` : undefined,\n                hostname: denoHostname ?? getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        if (globalAny.process?.versions?.node != null || globalAny.process?.version != null) {\n            return {\n                name: \"node\",\n                version: globalAny.process?.versions?.node ?? globalAny.process?.version,\n                hostname: getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        if (globalAny.process != null) {\n            return {\n                name: \"node\",\n                version: \"unknown\",\n                hostname: getEnvironmentHostname(globalAny.process, globalAny.Deno, globalAny.Bun, globalAny.location),\n            };\n        }\n        return {\n            name: \"unknown\",\n        };\n    }\n    function getEnvironmentHostname(nodeProcess, deno, bun, location) {\n        const processHostname = nodeProcess?.env?.HOSTNAME ?? nodeProcess?.env?.HOST ?? nodeProcess?.env?.COMPUTERNAME;\n        if (processHostname != null && processHostname.length > 0) {\n            return processHostname;\n        }\n        const bunHostname = bun?.env?.HOSTNAME ?? bun?.env?.HOST ?? bun?.env?.COMPUTERNAME;\n        if (bunHostname != null && bunHostname.length > 0) {\n            return bunHostname;\n        }\n        try {\n            const denoEnvGet = deno?.env?.get;\n            if (typeof denoEnvGet === \"function\") {\n                const value = denoEnvGet(\"HOSTNAME\");\n                if (value != null && value.length > 0) {\n                    return value;\n                }\n            }\n        }\n        catch {\n        }\n        if (location?.hostname != null && location.hostname.length > 0) {\n            return location.hostname;\n        }\n        return undefined;\n    }\n    function resolveDenoHostname(deno) {\n        try {\n            if (typeof deno?.hostname === \"function\") {\n                const value = deno.hostname();\n                if (value != null && value.length > 0) {\n                    return value;\n                }\n            }\n        }\n        catch {\n        }\n        const locationHostname = globalThis.location?.hostname;\n        if (locationHostname != null && locationHostname.length > 0) {\n            return locationHostname;\n        }\n        return undefined;\n    }\n    function getNodeEnv() {\n        const globalProcess = globalThis?.process;\n        return globalProcess?.env?.NODE_ENV;\n    }\n    function isNativeError(value) {\n        if (value instanceof Error) {\n            return true;\n        }\n        if (value != null && typeof value === \"object\") {\n            const objectTag = Object.prototype.toString.call(value);\n            if (/\\[object .*Error\\]/.test(objectTag)) {\n                return true;\n            }\n            const name = value.name;\n            if (typeof name === \"string\" && name.endsWith(\"Error\")) {\n                return true;\n            }\n        }\n        return false;\n    }\n}\nconst ANSI_REGEX = /\\u001b\\[[0-9;]*m/g;\nconst COLOR_TOKENS = {\n    black: \"#000000\",\n    red: \"#ef5350\",\n    green: \"#66bb6a\",\n    yellow: \"#fdd835\",\n    blue: \"#42a5f5\",\n    magenta: \"#ab47bc\",\n    cyan: \"#26c6da\",\n    white: \"#fafafa\",\n    blackBright: \"#424242\",\n    redBright: \"#ff7043\",\n    greenBright: \"#81c784\",\n    yellowBright: \"#ffe082\",\n    blueBright: \"#64b5f6\",\n    magentaBright: \"#ce93d8\",\n    cyanBright: \"#4dd0e1\",\n    whiteBright: \"#ffffff\",\n};\nconst BACKGROUND_TOKENS = {\n    bgBlack: \"#000000\",\n    bgRed: \"#ef5350\",\n    bgGreen: \"#66bb6a\",\n    bgYellow: \"#fdd835\",\n    bgBlue: \"#42a5f5\",\n    bgMagenta: \"#ab47bc\",\n    bgCyan: \"#26c6da\",\n    bgWhite: \"#fafafa\",\n    bgBlackBright: \"#424242\",\n    bgRedBright: \"#ff7043\",\n    bgGreenBright: \"#81c784\",\n    bgYellowBright: \"#ffe082\",\n    bgBlueBright: \"#64b5f6\",\n    bgMagentaBright: \"#ce93d8\",\n    bgCyanBright: \"#4dd0e1\",\n    bgWhiteBright: \"#ffffff\",\n};\nconst BROWSER_PATH_REGEX = /(?:(?:file|https?|global code|[^@]+)@)?(?:file:)?((?:\\/[^:/]+){2,})(?::(\\d+))?(?::(\\d+))?/;\nconst runtime = createLoggerEnvironment();\nexport const loggerEnvironment = runtime;\nexport * from \"./interfaces.js\";\nexport class BaseLogger {\n    constructor(settings, logObj, stackDepthLevel = Number.NaN) {\n        this.logObj = logObj;\n        this.stackDepthLevel = stackDepthLevel;\n        this.runtime = runtime;\n        this.maxErrorCauseDepth = 5;\n        this.settings = {\n            type: settings?.type ?? \"pretty\",\n            name: settings?.name,\n            parentNames: settings?.parentNames,\n            minLevel: settings?.minLevel ?? 0,\n            argumentsArrayName: settings?.argumentsArrayName,\n            hideLogPositionForProduction: settings?.hideLogPositionForProduction ?? false,\n            prettyLogTemplate: settings?.prettyLogTemplate ??\n                \"{{yyyy}}.{{mm}}.{{dd}} {{hh}}:{{MM}}:{{ss}}:{{ms}}\\t{{logLevelName}}\\t{{filePathWithLine}}{{nameWithDelimiterPrefix}}\\t\",\n            prettyErrorTemplate: settings?.prettyErrorTemplate ?? \"\\n{{errorName}} {{errorMessage}}\\nerror stack:\\n{{errorStack}}\",\n            prettyErrorStackTemplate: settings?.prettyErrorStackTemplate ?? \"   {{fileName}}\\t{{method}}\\n\\t{{filePathWithLine}}\",\n            prettyErrorParentNamesSeparator: settings?.prettyErrorParentNamesSeparator ?? \":\",\n            prettyErrorLoggerNameDelimiter: settings?.prettyErrorLoggerNameDelimiter ?? \"\\t\",\n            stylePrettyLogs: settings?.stylePrettyLogs ?? true,\n            prettyLogTimeZone: settings?.prettyLogTimeZone ?? \"UTC\",\n            prettyLogStyles: settings?.prettyLogStyles ?? {\n                logLevelName: {\n                    \"*\": [\"bold\", \"black\", \"bgWhiteBright\", \"dim\"],\n                    SILLY: [\"bold\", \"white\"],\n                    TRACE: [\"bold\", \"whiteBright\"],\n                    DEBUG: [\"bold\", \"green\"],\n                    INFO: [\"bold\", \"blue\"],\n                    WARN: [\"bold\", \"yellow\"],\n                    ERROR: [\"bold\", \"red\"],\n                    FATAL: [\"bold\", \"redBright\"],\n                },\n                dateIsoStr: \"white\",\n                filePathWithLine: \"white\",\n                name: [\"white\", \"bold\"],\n                nameWithDelimiterPrefix: [\"white\", \"bold\"],\n                nameWithDelimiterSuffix: [\"white\", \"bold\"],\n                errorName: [\"bold\", \"bgRedBright\", \"whiteBright\"],\n                fileName: [\"yellow\"],\n                fileNameWithLine: \"white\",\n            },\n            prettyInspectOptions: settings?.prettyInspectOptions ?? {\n                colors: true,\n                compact: false,\n                depth: Infinity,\n            },\n            metaProperty: settings?.metaProperty ?? \"_meta\",\n            maskPlaceholder: settings?.maskPlaceholder ?? \"[***]\",\n            maskValuesOfKeys: settings?.maskValuesOfKeys ?? [\"password\"],\n            maskValuesOfKeysCaseInsensitive: settings?.maskValuesOfKeysCaseInsensitive ?? false,\n            maskValuesRegEx: settings?.maskValuesRegEx,\n            prefix: [...(settings?.prefix ?? [])],\n            attachedTransports: [...(settings?.attachedTransports ?? [])],\n            overwrite: {\n                mask: settings?.overwrite?.mask,\n                toLogObj: settings?.overwrite?.toLogObj,\n                addMeta: settings?.overwrite?.addMeta,\n                addPlaceholders: settings?.overwrite?.addPlaceholders,\n                formatMeta: settings?.overwrite?.formatMeta,\n                formatLogObj: settings?.overwrite?.formatLogObj,\n                transportFormatted: settings?.overwrite?.transportFormatted,\n                transportJSON: settings?.overwrite?.transportJSON,\n            },\n        };\n        this.captureStackForMeta = this._shouldCaptureStack();\n    }\n    log(logLevelId, logLevelName, ...args) {\n        if (logLevelId < this.settings.minLevel) {\n            return;\n        }\n        const resolvedArgs = this._resolveLogArguments(args);\n        const logArgs = [...this.settings.prefix, ...resolvedArgs];\n        const maskedArgs = this.settings.overwrite?.mask != null\n            ? this.settings.overwrite?.mask(logArgs)\n            : this.settings.maskValuesOfKeys != null && this.settings.maskValuesOfKeys.length > 0\n                ? this._mask(logArgs)\n                : logArgs;\n        const thisLogObj = this.logObj != null ? this._recursiveCloneAndExecuteFunctions(this.logObj) : undefined;\n        const logObj = this.settings.overwrite?.toLogObj != null ? this.settings.overwrite?.toLogObj(maskedArgs, thisLogObj) : this._toLogObj(maskedArgs, thisLogObj);\n        const logObjWithMeta = this.settings.overwrite?.addMeta != null\n            ? this.settings.overwrite?.addMeta(logObj, logLevelId, logLevelName)\n            : this._addMetaToLogObj(logObj, logLevelId, logLevelName);\n        const logMeta = logObjWithMeta?.[this.settings.metaProperty];\n        let logMetaMarkup;\n        let logArgsAndErrorsMarkup = undefined;\n        if (this.settings.overwrite?.formatMeta != null) {\n            logMetaMarkup = this.settings.overwrite?.formatMeta(logObjWithMeta?.[this.settings.metaProperty]);\n        }\n        if (this.settings.overwrite?.formatLogObj != null) {\n            logArgsAndErrorsMarkup = this.settings.overwrite?.formatLogObj(maskedArgs, this.settings);\n        }\n        if (this.settings.type === \"pretty\") {\n            logMetaMarkup = logMetaMarkup ?? this._prettyFormatLogObjMeta(logObjWithMeta?.[this.settings.metaProperty]);\n            logArgsAndErrorsMarkup = logArgsAndErrorsMarkup ?? runtime.prettyFormatLogObj(maskedArgs, this.settings);\n        }\n        if (logMetaMarkup != null && logArgsAndErrorsMarkup != null) {\n            if (this.settings.overwrite?.transportFormatted != null) {\n                const transport = this.settings.overwrite.transportFormatted;\n                const declaredParams = transport.length;\n                if (declaredParams < 4) {\n                    transport(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors);\n                }\n                else if (declaredParams === 4) {\n                    transport(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors, logMeta);\n                }\n                else {\n                    transport(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors, logMeta, this.settings);\n                }\n            }\n            else {\n                runtime.transportFormatted(logMetaMarkup, logArgsAndErrorsMarkup.args, logArgsAndErrorsMarkup.errors, logMeta, this.settings);\n            }\n        }\n        else {\n            if (this.settings.overwrite?.transportJSON != null) {\n                this.settings.overwrite.transportJSON(logObjWithMeta);\n            }\n            else if (this.settings.type !== \"hidden\") {\n                runtime.transportJSON(logObjWithMeta);\n            }\n        }\n        if (this.settings.attachedTransports != null && this.settings.attachedTransports.length > 0) {\n            this.settings.attachedTransports.forEach((transportLogger) => {\n                transportLogger(logObjWithMeta);\n            });\n        }\n        return logObjWithMeta;\n    }\n    attachTransport(transportLogger) {\n        this.settings.attachedTransports.push(transportLogger);\n    }\n    getSubLogger(settings, logObj) {\n        const subLoggerSettings = {\n            ...this.settings,\n            ...settings,\n            parentNames: this.settings?.parentNames != null && this.settings?.name != null\n                ? [...this.settings.parentNames, this.settings.name]\n                : this.settings?.name != null\n                    ? [this.settings.name]\n                    : undefined,\n            prefix: [...this.settings.prefix, ...(settings?.prefix ?? [])],\n        };\n        const subLogger = new this.constructor(subLoggerSettings, logObj ?? this.logObj, this.stackDepthLevel);\n        return subLogger;\n    }\n    _mask(args) {\n        const maskKeys = this._getMaskKeys();\n        return args?.map((arg) => {\n            return this._recursiveCloneAndMaskValuesOfKeys(arg, maskKeys);\n        });\n    }\n    _getMaskKeys() {\n        const maskKeys = this.settings.maskValuesOfKeys ?? [];\n        const signature = maskKeys.map(String).join(\"|\");\n        if (this.settings.maskValuesOfKeysCaseInsensitive === true) {\n            if (this.maskKeysCache?.source === maskKeys && this.maskKeysCache.caseInsensitive === true && this.maskKeysCache.signature === signature) {\n                return this.maskKeysCache.normalized;\n            }\n            const normalized = maskKeys.map((key) => (typeof key === \"string\" ? key.toLowerCase() : String(key).toLowerCase()));\n            this.maskKeysCache = {\n                source: maskKeys,\n                caseInsensitive: true,\n                normalized,\n                signature,\n            };\n            return normalized;\n        }\n        this.maskKeysCache = {\n            source: maskKeys,\n            caseInsensitive: false,\n            normalized: maskKeys,\n            signature,\n        };\n        return maskKeys;\n    }\n    _resolveLogArguments(args) {\n        if (args.length === 1 && typeof args[0] === \"function\") {\n            const candidate = args[0];\n            if (candidate.length === 0) {\n                const result = candidate();\n                return Array.isArray(result) ? result : [result];\n            }\n        }\n        return args;\n    }\n    _recursiveCloneAndMaskValuesOfKeys(source, keys, seen = []) {\n        if (seen.includes(source)) {\n            return { ...source };\n        }\n        if (typeof source === \"object\" && source !== null) {\n            seen.push(source);\n        }\n        if (runtime.isError(source) || runtime.isBuffer(source)) {\n            return source;\n        }\n        else if (source instanceof Map) {\n            return new Map(source);\n        }\n        else if (source instanceof Set) {\n            return new Set(source);\n        }\n        else if (Array.isArray(source)) {\n            return source.map((item) => this._recursiveCloneAndMaskValuesOfKeys(item, keys, seen));\n        }\n        else if (source instanceof Date) {\n            return new Date(source.getTime());\n        }\n        else if (source instanceof URL) {\n            return urlToObject(source);\n        }\n        else if (source !== null && typeof source === \"object\") {\n            const baseObject = runtime.isError(source) ? this._cloneError(source) : Object.create(Object.getPrototypeOf(source));\n            return Object.getOwnPropertyNames(source).reduce((o, prop) => {\n                const lookupKey = this.settings?.maskValuesOfKeysCaseInsensitive !== true\n                    ? prop\n                    : typeof prop === \"string\"\n                        ? prop.toLowerCase()\n                        : String(prop).toLowerCase();\n                o[prop] = keys.includes(lookupKey)\n                    ? this.settings.maskPlaceholder\n                    : (() => {\n                        try {\n                            return this._recursiveCloneAndMaskValuesOfKeys(source[prop], keys, seen);\n                        }\n                        catch {\n                            return null;\n                        }\n                    })();\n                return o;\n            }, baseObject);\n        }\n        else {\n            if (typeof source === \"string\") {\n                let modifiedSource = source;\n                for (const regEx of this.settings?.maskValuesRegEx || []) {\n                    modifiedSource = modifiedSource.replace(regEx, this.settings?.maskPlaceholder || \"\");\n                }\n                return modifiedSource;\n            }\n            return source;\n        }\n    }\n    _recursiveCloneAndExecuteFunctions(source, seen = []) {\n        if (this.isObjectOrArray(source) && seen.includes(source)) {\n            return this.shallowCopy(source);\n        }\n        if (this.isObjectOrArray(source)) {\n            seen.push(source);\n        }\n        if (Array.isArray(source)) {\n            return source.map((item) => this._recursiveCloneAndExecuteFunctions(item, seen));\n        }\n        else if (source instanceof Date) {\n            return new Date(source.getTime());\n        }\n        else if (this.isObject(source)) {\n            return Object.getOwnPropertyNames(source).reduce((o, prop) => {\n                const descriptor = Object.getOwnPropertyDescriptor(source, prop);\n                if (descriptor) {\n                    Object.defineProperty(o, prop, descriptor);\n                    const value = source[prop];\n                    o[prop] = typeof value === \"function\" ? value() : this._recursiveCloneAndExecuteFunctions(value, seen);\n                }\n                return o;\n            }, Object.create(Object.getPrototypeOf(source)));\n        }\n        else {\n            return source;\n        }\n    }\n    isObjectOrArray(value) {\n        return typeof value === \"object\" && value !== null;\n    }\n    isObject(value) {\n        return typeof value === \"object\" && !Array.isArray(value) && value !== null;\n    }\n    shallowCopy(source) {\n        if (Array.isArray(source)) {\n            return [...source];\n        }\n        else {\n            return { ...source };\n        }\n    }\n    _toLogObj(args, clonedLogObj = {}) {\n        args = args?.map((arg) => (runtime.isError(arg) ? this._toErrorObject(arg) : arg));\n        if (this.settings.argumentsArrayName == null) {\n            if (args.length === 1 && !Array.isArray(args[0]) && runtime.isBuffer(args[0]) !== true && !(args[0] instanceof Date)) {\n                clonedLogObj = typeof args[0] === \"object\" && args[0] != null ? { ...args[0], ...clonedLogObj } : { 0: args[0], ...clonedLogObj };\n            }\n            else {\n                clonedLogObj = { ...clonedLogObj, ...args };\n            }\n        }\n        else {\n            clonedLogObj = {\n                ...clonedLogObj,\n                [this.settings.argumentsArrayName]: args,\n            };\n        }\n        return clonedLogObj;\n    }\n    _cloneError(error) {\n        const cloned = new error.constructor();\n        Object.getOwnPropertyNames(error).forEach((key) => {\n            cloned[key] = error[key];\n        });\n        return cloned;\n    }\n    _toErrorObject(error, depth = 0, seen = new Set()) {\n        if (!seen.has(error)) {\n            seen.add(error);\n        }\n        const errorObject = {\n            nativeError: error,\n            name: error.name ?? \"Error\",\n            message: error.message,\n            stack: runtime.getErrorTrace(error),\n        };\n        if (depth >= this.maxErrorCauseDepth) {\n            return errorObject;\n        }\n        const causeValue = error.cause;\n        if (causeValue != null) {\n            const normalizedCause = toError(causeValue);\n            if (!seen.has(normalizedCause)) {\n                errorObject.cause = this._toErrorObject(normalizedCause, depth + 1, seen);\n            }\n        }\n        return errorObject;\n    }\n    _addMetaToLogObj(logObj, logLevelId, logLevelName) {\n        return {\n            ...logObj,\n            [this.settings.metaProperty]: runtime.getMeta(logLevelId, logLevelName, this.stackDepthLevel, !this.captureStackForMeta, this.settings.name, this.settings.parentNames),\n        };\n    }\n    _shouldCaptureStack() {\n        if (this.settings.hideLogPositionForProduction) {\n            return false;\n        }\n        if (this.settings.type === \"json\") {\n            return true;\n        }\n        const template = this.settings.prettyLogTemplate ?? \"\";\n        const stackPlaceholders = /{{\\s*(file(Name|Path|Line|PathWithLine|NameWithLine)|fullFilePath)\\s*}}/;\n        if (stackPlaceholders.test(template)) {\n            return true;\n        }\n        return false;\n    }\n    _prettyFormatLogObjMeta(logObjMeta) {\n        return buildPrettyMeta(this.settings, logObjMeta).text;\n    }\n}\n","export function urlToObject(url) {\n    return {\n        href: url.href,\n        protocol: url.protocol,\n        username: url.username,\n        password: url.password,\n        host: url.host,\n        hostname: url.hostname,\n        port: url.port,\n        pathname: url.pathname,\n        search: url.search,\n        searchParams: [...url.searchParams].map(([key, value]) => ({ key, value })),\n        hash: url.hash,\n        origin: url.origin,\n    };\n}\n","import { BaseLogger } from \"./BaseLogger.js\";\nexport * from \"./interfaces.js\";\nexport * from \"./BaseLogger.js\";\nexport class Logger extends BaseLogger {\n    constructor(settings, logObj) {\n        const isBrowser = typeof window !== \"undefined\" && typeof document !== \"undefined\";\n        const normalizedSettings = { ...(settings ?? {}) };\n        if (isBrowser) {\n            normalizedSettings.stylePrettyLogs = settings?.stylePrettyLogs ?? true;\n        }\n        super(normalizedSettings, logObj, Number.NaN);\n    }\n    log(logLevelId, logLevelName, ...args) {\n        return super.log(logLevelId, logLevelName, ...args);\n    }\n    silly(...args) {\n        return super.log(0, \"SILLY\", ...args);\n    }\n    trace(...args) {\n        return super.log(1, \"TRACE\", ...args);\n    }\n    debug(...args) {\n        return super.log(2, \"DEBUG\", ...args);\n    }\n    info(...args) {\n        return super.log(3, \"INFO\", ...args);\n    }\n    warn(...args) {\n        return super.log(4, \"WARN\", ...args);\n    }\n    error(...args) {\n        return super.log(5, \"ERROR\", ...args);\n    }\n    fatal(...args) {\n        return super.log(6, \"FATAL\", ...args);\n    }\n    getSubLogger(settings, logObj) {\n        return super.getSubLogger(settings, logObj);\n    }\n}\n","/**\n * Property Mapper\n *\n * Utilities for mapping between Eufy device properties and Scrypted settings.\n * Handles type conversions, state mappings, and metadata parsing.\n *\n * @module utils\n */\n\nimport { Setting, SettingValue, SecuritySystemMode } from \"@scrypted/sdk\";\nimport {\n  AlarmMode,\n  GuardMode,\n  PropertyMetadataAny,\n  DeviceProperties,\n  CommonEufyProperties,\n} from \"@caplaz/eufy-security-client\";\n\n/**\n * Maps Eufy alarm/guard modes to Scrypted security system modes\n */\nexport const ALARM_MODE_MAP: Record<AlarmMode, SecuritySystemMode> = {\n  [GuardMode.AWAY]: SecuritySystemMode.AwayArmed,\n  [GuardMode.HOME]: SecuritySystemMode.HomeArmed,\n  [GuardMode.DISARMED]: SecuritySystemMode.Disarmed,\n  [GuardMode.CUSTOM1]: SecuritySystemMode.NightArmed,\n  [GuardMode.CUSTOM2]: SecuritySystemMode.NightArmed,\n  [GuardMode.CUSTOM3]: SecuritySystemMode.NightArmed,\n};\n\n/**\n * Maps Scrypted security system modes to Eufy guard modes\n */\nexport const SECURITY_SYSTEM_MAP: Record<SecuritySystemMode, GuardMode> = {\n  [SecuritySystemMode.AwayArmed]: GuardMode.AWAY,\n  [SecuritySystemMode.HomeArmed]: GuardMode.HOME,\n  [SecuritySystemMode.NightArmed]: GuardMode.HOME,\n  [SecuritySystemMode.Disarmed]: GuardMode.DISARMED,\n};\n\n/**\n * PropertyMapper provides utilities for mapping device properties to Scrypted settings\n */\nexport class PropertyMapper {\n  /**\n   * Convert Eufy property metadata to a Scrypted Setting\n   *\n   * @param metadata - Property metadata from Eufy API\n   * @param value - Current property value\n   * @param description - Optional description override\n   * @param group - Optional group name for UI organization\n   * @returns Scrypted Setting object\n   */\n  static toSetting(\n    metadata: PropertyMetadataAny,\n    value?: SettingValue,\n    description?: string,\n    group?: string\n  ): Setting {\n    let setting: Setting = {\n      key: metadata.name,\n      title: metadata.label,\n      type: metadata.type,\n      value: value !== undefined ? value : metadata.default,\n      placeholder: metadata.default ? String(metadata.default) : undefined,\n      readonly: !metadata.writeable,\n      description,\n      group,\n    };\n\n    // Handle number types with state mappings (enum-like)\n    if (metadata.type === \"number\" && metadata.states) {\n      if (metadata.writeable) {\n        // Convert to choice list for writable properties\n        const choices = Object.entries(metadata.states)\n          .sort(([a], [b]) => {\n            const aNum = Number(a);\n            const bNum = Number(b);\n            if (!isNaN(aNum) && !isNaN(bNum)) {\n              return aNum - bNum;\n            }\n            return a.localeCompare(b);\n          })\n          .map(([, value]) => String(value));\n\n        setting = {\n          ...setting,\n          type: \"string\",\n          choices,\n          value: metadata.states[value as number],\n        };\n      } else {\n        // Convert to string for readonly properties\n        setting = {\n          ...setting,\n          type: \"string\",\n          value: metadata.states[value as number],\n        };\n      }\n    }\n    // Handle number types with min/max range\n    else if (\n      metadata.type === \"number\" &&\n      metadata.min !== undefined &&\n      metadata.max !== undefined\n    ) {\n      setting = {\n        ...setting,\n        range: [metadata.min, metadata.max],\n        placeholder: undefined,\n        description: `Value must be between ${metadata.min}${\n          metadata.unit || \"\"\n        } and ${metadata.max}${metadata.unit || \"\"}`,\n      };\n    }\n\n    return setting;\n  }\n\n  /**\n   * Adjust value based on metadata for API submission\n   *\n   * Converts UI values back to API-compatible format.\n   * For example, converts string choice to numeric index.\n   *\n   * @param value - Value from UI\n   * @param metadata - Property metadata\n   * @returns Adjusted value for API\n   */\n  static adjustValueForAPI(\n    value: SettingValue,\n    metadata: PropertyMetadataAny\n  ): any {\n    if (metadata.type === \"number\" && metadata.states) {\n      // For number types with states, find the index of the value in the states map\n      const stateValues = Object.values(metadata.states);\n      return stateValues.indexOf(value as string);\n    }\n    return value;\n  }\n\n  /**\n   * Determine appropriate UI group for a property\n   *\n   * @param propertyName - Name of the property\n   * @returns Group name for UI organization\n   */\n  static getPropertyGroup(propertyName: string): string {\n    const name = propertyName.toLowerCase();\n\n    if (name.includes(\"motion\") && !name.includes(\"light\")) {\n      return \"Motion\";\n    }\n\n    if (name.includes(\"light\")) {\n      return \"Light\";\n    }\n\n    if (\n      name.includes(\"battery\") ||\n      name.includes(\"charge\") ||\n      name.includes(\"power\")\n    ) {\n      return \"Power\";\n    }\n\n    if (name.includes(\"clip\") || name.includes(\"record\")) {\n      return \"Recording\";\n    }\n\n    if (\n      name.includes(\"video\") ||\n      name.includes(\"stream\") ||\n      name.includes(\"vision\")\n    ) {\n      return \"Video\";\n    }\n\n    if (\n      name.includes(\"microphone\") ||\n      name.includes(\"speaker\") ||\n      name.includes(\"notification\")\n    ) {\n      return \"Communication\";\n    }\n\n    return \"Configuration\";\n  }\n\n  /**\n   * Get all writable device properties as Settings\n   *\n   * @param properties - Current device properties\n   * @param metadata - Property metadata map\n   * @returns Array of Setting objects for writable properties\n   */\n  static getWritableSettings(\n    properties: DeviceProperties,\n    metadata: Record<string, PropertyMetadataAny>\n  ): Setting[] {\n    return Object.values(metadata)\n      .filter((meta) => meta.writeable)\n      .filter((meta) => !/test/i.test(meta.name))\n      .filter((meta) => meta.name !== \"light\") // Hide light property (controlled via OnOff interface)\n      .map((meta) =>\n        PropertyMapper.toSetting(\n          meta,\n          properties[meta.name as keyof DeviceProperties],\n          undefined,\n          PropertyMapper.getPropertyGroup(meta.name)\n        )\n      );\n  }\n\n  /**\n   * Get generic device information as Settings\n   *\n   * @param device - Device information object\n   * @param metadata - Property metadata map\n   * @returns Array of Setting objects for device info\n   */\n  static getDeviceInfoSettings(\n    device: { model: string; serialNumber: string; firmware: string },\n    metadata: Record<keyof CommonEufyProperties, PropertyMetadataAny>\n  ): Setting[] {\n    return [\n      PropertyMapper.toSetting(\n        metadata[\"model\"],\n        device.model,\n        \"The full product name and model of the device.\"\n      ),\n      PropertyMapper.toSetting(\n        metadata[\"serialNumber\"],\n        device.serialNumber,\n        \"The unique serial number assigned to the device.\"\n      ),\n      PropertyMapper.toSetting(\n        metadata[\"softwareVersion\"],\n        device.firmware,\n        \"The current software version running on the device.\"\n      ),\n    ];\n  }\n\n  /**\n   * Check if a property should be hidden from settings UI\n   *\n   * @param propertyName - Name of the property\n   * @returns true if property should be hidden\n   */\n  static shouldHideProperty(propertyName: string): boolean {\n    const hiddenProperties = [\n      \"light\", // Controlled via OnOff interface\n      \"test\", // Test properties\n    ];\n\n    return hiddenProperties.some((hidden) =>\n      propertyName.toLowerCase().includes(hidden.toLowerCase())\n    );\n  }\n}\n","/**\n * Device Settings Service\n *\n * Manages device settings operations.\n * Handles both device property settings and custom Scrypted settings.\n *\n * @module services/device\n */\n\nimport { Setting, SettingValue } from \"@scrypted/sdk\";\nimport { DeviceProperties } from \"@caplaz/eufy-security-client\";\nimport { Logger, ILogObj } from \"tslog\";\nimport { PropertyMapper } from \"../../utils/property-mapper\";\n\n/**\n * Device info with metadata\n */\nexport interface DeviceInfo {\n  metadata: Record<string, any>;\n  [key: string]: any;\n}\n\n/**\n * Settings change callback\n */\nexport type SettingsChangeCallback = () => void;\n\n/**\n * Device command API interface\n */\nexport interface IDeviceCommandAPI {\n  setProperty(propertyName: keyof DeviceProperties, value: any): Promise<void>;\n}\n\n/**\n * DeviceSettingsService handles device settings operations\n *\n * This service manages:\n * - Device property settings\n * - Custom Scrypted settings (e.g., device name)\n * - Settings UI generation\n * - Property updates via API\n */\nexport class DeviceSettingsService {\n  private customSettings: Map<string, SettingValue> = new Map();\n  private settingsChangeCallbacks = new Set<SettingsChangeCallback>();\n\n  constructor(\n    private deviceApi: IDeviceCommandAPI,\n    private logger: Logger<ILogObj>\n  ) {}\n\n  /**\n   * Get all device settings\n   *\n   * Combines device properties, metadata, and custom settings\n   * into a list of Setting objects for the Scrypted UI.\n   *\n   * @param deviceInfo - Device information with metadata\n   * @param properties - Current device properties\n   * @param deviceName - Current device name\n   * @returns Array of settings for the UI\n   */\n  getSettings(\n    deviceInfo: DeviceInfo,\n    properties: DeviceProperties,\n    deviceName: string\n  ): Setting[] {\n    const { metadata } = deviceInfo;\n\n    return [\n      // Custom Scrypted settings\n      {\n        key: \"scryptedName\",\n        title: \"Device Name\",\n        description: \"Name shown in Scrypted (can be customized)\",\n        value: deviceName,\n        type: \"string\",\n        readonly: false,\n      },\n\n      // Generic device information\n      ...this.getGenericDeviceInfo(deviceInfo, metadata),\n\n      // All writable device properties\n      ...this.getWritableProperties(properties, metadata),\n    ];\n  }\n\n  /**\n   * Update a device setting\n   *\n   * Handles both device properties and custom settings.\n   * Notifies callbacks after successful update.\n   *\n   * @param key - Setting key\n   * @param value - New value\n   * @param properties - Current device properties\n   * @param metadata - Property metadata for value adjustment\n   * @param onSuccess - Callback for successful update\n   * @returns Promise that resolves when update is complete\n   */\n  async putSetting(\n    key: string,\n    value: SettingValue,\n    properties: DeviceProperties,\n    metadata: Record<string, any>,\n    onSuccess?: (key: string, value: SettingValue) => void\n  ): Promise<void> {\n    try {\n      // Handle device properties\n      if (key in properties) {\n        await this.updateDeviceProperty(\n          key as keyof DeviceProperties,\n          value,\n          metadata[key]\n        );\n        if (onSuccess) {\n          onSuccess(key, value);\n        }\n        this.notifySettingsChanged();\n        return;\n      }\n\n      // Handle custom settings\n      if (this.isCustomSetting(key)) {\n        this.customSettings.set(key, value);\n        if (onSuccess) {\n          onSuccess(key, value);\n        }\n        this.notifySettingsChanged();\n        return;\n      }\n\n      // Unknown setting\n      this.logger.warn(`Unknown setting: ${key}`);\n      throw new Error(`Unknown setting: ${key}`);\n    } catch (error) {\n      // Still notify UI even on error to reset button state\n      this.notifySettingsChanged();\n      throw error;\n    }\n  }\n\n  /**\n   * Get a custom setting value\n   *\n   * @param key - Setting key\n   * @returns Setting value or undefined\n   */\n  getCustomSetting(key: string): SettingValue | undefined {\n    return this.customSettings.get(key);\n  }\n\n  /**\n   * Subscribe to settings changes\n   *\n   * @param callback - Callback to invoke when settings change\n   * @returns Unsubscribe function\n   */\n  onSettingsChange(callback: SettingsChangeCallback): () => void {\n    this.settingsChangeCallbacks.add(callback);\n    return () => this.settingsChangeCallbacks.delete(callback);\n  }\n\n  /**\n   * Update a device property via API\n   */\n  private async updateDeviceProperty(\n    propertyName: keyof DeviceProperties,\n    value: SettingValue,\n    metadata: any\n  ): Promise<void> {\n    // Adjust the value based on metadata (e.g., convert state to index)\n    const adjustedValue = metadata\n      ? PropertyMapper.adjustValueForAPI(value, metadata)\n      : value;\n\n    this.logger.info(`Updating property ${propertyName} to ${adjustedValue}`);\n\n    try {\n      await this.deviceApi.setProperty(propertyName, adjustedValue);\n      this.logger.info(`Property ${propertyName} updated successfully`);\n    } catch (error) {\n      this.logger.warn(`Failed to set property ${propertyName}: ${error}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Check if a key is a custom setting\n   */\n  private isCustomSetting(key: string): boolean {\n    return key === \"scryptedName\";\n  }\n\n  /**\n   * Get generic device information settings\n   */\n  private getGenericDeviceInfo(\n    deviceInfo: DeviceInfo,\n    _metadata: Record<string, any>\n  ): Setting[] {\n    const settings: Setting[] = [];\n\n    // Add device type\n    if (deviceInfo.type !== undefined) {\n      settings.push({\n        key: \"deviceType\",\n        title: \"Device Type\",\n        description: \"Type of Eufy device\",\n        value: deviceInfo.type,\n        type: \"string\",\n        readonly: true,\n      });\n    }\n\n    // Add model\n    if (deviceInfo.model !== undefined) {\n      settings.push({\n        key: \"model\",\n        title: \"Model\",\n        description: \"Device model number\",\n        value: deviceInfo.model,\n        type: \"string\",\n        readonly: true,\n      });\n    }\n\n    // Add serial number\n    if (deviceInfo.serialNumber !== undefined) {\n      settings.push({\n        key: \"serialNumber\",\n        title: \"Serial Number\",\n        description: \"Device serial number\",\n        value: deviceInfo.serialNumber,\n        type: \"string\",\n        readonly: true,\n      });\n    }\n\n    return settings;\n  }\n\n  /**\n   * Get writable device properties as settings\n   */\n  private getWritableProperties(\n    properties: DeviceProperties,\n    metadata: Record<string, any>\n  ): Setting[] {\n    return PropertyMapper.getWritableSettings(properties, metadata);\n  }\n\n  /**\n   * Notify all callbacks that settings have changed\n   */\n  private notifySettingsChanged(): void {\n    this.settingsChangeCallbacks.forEach((callback) => {\n      try {\n        callback();\n      } catch (error) {\n        this.logger.error(`Error in settings change callback: ${error}`);\n      }\n    });\n  }\n\n  /**\n   * Clean up resources\n   */\n  dispose(): void {\n    this.settingsChangeCallbacks.clear();\n    this.customSettings.clear();\n  }\n}\n","/**\n * Device State Service\n *\n * Manages device state updates from properties.\n * Handles conversion of Eufy properties to Scrypted device state.\n *\n * @module services/device\n */\n\nimport { ChargeState, ScryptedInterface } from \"@scrypted/sdk\";\nimport { ChargingStatus, DeviceProperties } from \"@caplaz/eufy-security-client\";\nimport { Logger, ILogObj } from \"tslog\";\n\n/**\n * Device state that maps to Scrypted interfaces\n */\nexport interface DeviceState {\n  motionDetected?: boolean;\n  binaryState?: boolean;\n  brightness?: number;\n  on?: boolean;\n  batteryLevel?: number;\n  chargeState?: ChargeState;\n  sensors?: Record<string, any>;\n}\n\n/**\n * State change event\n */\nexport interface StateChangeEvent {\n  interface: ScryptedInterface;\n  value: any;\n}\n\n/**\n * State change callback\n */\nexport type StateChangeCallback = (event: StateChangeEvent) => void;\n\n/**\n * DeviceStateService handles device state management\n *\n * This service:\n * - Converts Eufy properties to Scrypted state\n * - Tracks device state (motion, battery, sensors, etc.)\n * - Notifies listeners of state changes\n * - Provides state accessors\n */\nexport class DeviceStateService {\n  private state: DeviceState = {};\n  private stateChangeCallbacks = new Set<StateChangeCallback>();\n\n  constructor(private logger: Logger<ILogObj>) {}\n\n  /**\n   * Get current device state\n   *\n   * @returns Current state object\n   */\n  getState(): DeviceState {\n    return { ...this.state };\n  }\n\n  /**\n   * Update state from device properties\n   *\n   * Converts Eufy device properties to Scrypted-compatible state\n   * and notifies listeners of changes.\n   *\n   * @param properties - Device properties from Eufy\n   */\n  updateFromProperties(properties?: DeviceProperties): void {\n    if (!properties) return;\n\n    const changes: StateChangeEvent[] = [];\n\n    // Motion detection\n    if (properties.motionDetected !== undefined) {\n      const newValue = properties.motionDetected;\n      if (this.state.motionDetected !== newValue) {\n        this.state.motionDetected = newValue;\n        changes.push({\n          interface: ScryptedInterface.MotionSensor,\n          value: newValue,\n        });\n      }\n    }\n\n    // Light settings\n    if (properties.lightSettingsBrightnessManual !== undefined) {\n      const newValue = properties.lightSettingsBrightnessManual;\n      if (this.state.brightness !== newValue) {\n        this.state.brightness = newValue;\n        changes.push({\n          interface: ScryptedInterface.Brightness,\n          value: newValue,\n        });\n      }\n    } else if (this.state.brightness === undefined) {\n      this.state.brightness = 100; // Default\n    }\n\n    if (properties.light !== undefined) {\n      const newValue = properties.light;\n      if (this.state.on !== newValue) {\n        this.state.on = newValue;\n        changes.push({\n          interface: ScryptedInterface.OnOff,\n          value: newValue,\n        });\n      }\n    }\n\n    // Battery state\n    if (properties.battery !== undefined) {\n      const newValue = properties.battery;\n      if (this.state.batteryLevel !== newValue) {\n        this.state.batteryLevel = newValue;\n        changes.push({\n          interface: ScryptedInterface.Battery,\n          value: newValue,\n        });\n      }\n    } else if (this.state.batteryLevel === undefined) {\n      this.state.batteryLevel = 100; // Default\n    }\n\n    // Charging status\n    if (properties.chargingStatus !== undefined) {\n      const newValue = this.convertChargingStatus(properties.chargingStatus);\n      if (this.state.chargeState !== newValue) {\n        this.state.chargeState = newValue;\n        changes.push({\n          interface: ScryptedInterface.Charger,\n          value: newValue,\n        });\n      }\n    }\n\n    // WiFi sensors\n    if (properties.wifiRssi !== undefined) {\n      const newSensors = {\n        ...this.state.sensors,\n        wifiRssi: {\n          name: \"wifiRssi\",\n          value: properties.wifiRssi,\n          unit: \"dBm\",\n        },\n      };\n      this.state.sensors = newSensors;\n      changes.push({\n        interface: ScryptedInterface.Sensors,\n        value: newSensors,\n      });\n    }\n\n    // Notify all changes\n    changes.forEach((change) => this.notifyStateChange(change));\n  }\n\n  /**\n   * Update a single property and notify listeners\n   *\n   * @param propertyName - Name of the property that changed\n   * @param value - New value\n   */\n  updateProperty(propertyName: keyof DeviceProperties, value: any): void {\n    this.logger.debug(`Property changed: ${propertyName} = ${value}`);\n\n    let change: StateChangeEvent | undefined;\n\n    switch (propertyName) {\n      case \"light\":\n        this.state.on = value as boolean;\n        change = {\n          interface: ScryptedInterface.OnOff,\n          value: this.state.on,\n        };\n        break;\n\n      case \"battery\":\n        this.state.batteryLevel = value as number;\n        change = {\n          interface: ScryptedInterface.Battery,\n          value: this.state.batteryLevel,\n        };\n        break;\n\n      case \"chargingStatus\":\n        this.state.chargeState = this.convertChargingStatus(\n          value as ChargingStatus\n        );\n        change = {\n          interface: ScryptedInterface.Charger,\n          value: this.state.chargeState,\n        };\n        break;\n\n      case \"wifiRssi\":\n        this.state.sensors = {\n          ...this.state.sensors,\n          wifiRssi: {\n            name: propertyName,\n            value: value as number,\n            unit: \"dBm\",\n          },\n        };\n        change = {\n          interface: ScryptedInterface.Sensors,\n          value: this.state.sensors,\n        };\n        break;\n\n      case \"motionDetected\":\n        this.state.motionDetected = value as boolean;\n        change = {\n          interface: ScryptedInterface.MotionSensor,\n          value: this.state.motionDetected,\n        };\n        break;\n\n      case \"lightSettingsBrightnessManual\":\n        this.state.brightness = value as number;\n        change = {\n          interface: ScryptedInterface.Brightness,\n          value: this.state.brightness,\n        };\n        break;\n\n      default:\n        this.logger.debug(\n          `Property ${propertyName} does not affect device state`\n        );\n    }\n\n    if (change) {\n      this.notifyStateChange(change);\n    }\n  }\n\n  /**\n   * Subscribe to state changes\n   *\n   * @param callback - Callback to invoke on state changes\n   * @returns Unsubscribe function\n   */\n  onStateChange(callback: StateChangeCallback): () => void {\n    this.stateChangeCallbacks.add(callback);\n    return () => this.stateChangeCallbacks.delete(callback);\n  }\n\n  /**\n   * Update device state directly (not from properties)\n   * Used for events that don't correspond to device properties\n   */\n  updateState(stateKey: keyof DeviceState, value: any): void {\n    let change: StateChangeEvent | undefined;\n\n    switch (stateKey) {\n      case \"binaryState\":\n        this.state.binaryState = value as boolean;\n        change = {\n          interface: ScryptedInterface.BinarySensor,\n          value: this.state.binaryState,\n        };\n        break;\n\n      default:\n        this.logger.debug(`State key ${stateKey} not handled`);\n    }\n\n    if (change) {\n      this.notifyStateChange(change);\n    }\n  }\n\n  /**\n   * Convert Eufy charging status to Scrypted ChargeState\n   */\n  private convertChargingStatus(\n    status: ChargingStatus\n  ): ChargeState | undefined {\n    switch (status) {\n      case ChargingStatus.NOT_CHARGING:\n        return ChargeState.NotCharging;\n      case ChargingStatus.CHARGING:\n        return ChargeState.Charging;\n      default:\n        return undefined;\n    }\n  }\n\n  /**\n   * Notify listeners of state change\n   */\n  private notifyStateChange(event: StateChangeEvent): void {\n    this.stateChangeCallbacks.forEach((callback) => {\n      try {\n        callback(event);\n      } catch (error) {\n        this.logger.error(`Error in state change callback: ${error}`);\n      }\n    });\n  }\n\n  /**\n   * Clean up resources\n   */\n  dispose(): void {\n    this.stateChangeCallbacks.clear();\n    this.state = {};\n  }\n}\n","/**\n * Refresh Service\n *\n * Manages device property refresh operations.\n * Handles scheduled and user-initiated refreshes.\n *\n * @module services/device\n */\n\nimport { DeviceProperties } from \"@caplaz/eufy-security-client\";\nimport { Logger, ILogObj } from \"tslog\";\n\n/**\n * Device command API interface for refresh operations\n */\nexport interface IDeviceRefreshAPI {\n  getProperties(): Promise<{ properties: DeviceProperties }>;\n}\n\n/**\n * Refresh complete callback\n */\nexport type RefreshCompleteCallback = (properties: DeviceProperties) => void;\n\n/**\n * Refresh error callback\n */\nexport type RefreshErrorCallback = (error: Error) => void;\n\n/**\n * RefreshService handles device property refresh operations\n *\n * This service:\n * - Manages refresh frequency\n * - Handles property retrieval from API\n * - Notifies listeners of successful/failed refreshes\n * - Supports both scheduled and manual refreshes\n */\nexport class RefreshService {\n  private readonly DEFAULT_REFRESH_FREQUENCY = 600; // 10 minutes in seconds\n  private refreshCompleteCallbacks = new Set<RefreshCompleteCallback>();\n  private refreshErrorCallbacks = new Set<RefreshErrorCallback>();\n\n  constructor(\n    private deviceApi: IDeviceRefreshAPI,\n    private logger: Logger<ILogObj>\n  ) {}\n\n  /**\n   * Get refresh frequency in seconds\n   *\n   * @returns Refresh interval in seconds\n   */\n  getRefreshFrequency(): number {\n    return this.DEFAULT_REFRESH_FREQUENCY;\n  }\n\n  /**\n   * Refresh device properties\n   *\n   * Fetches latest properties from the device API.\n   * Notifies listeners on success or failure.\n   *\n   * @param refreshInterface - Specific interface to refresh (currently unused, refreshes all)\n   * @param userInitiated - Whether refresh was initiated by user\n   * @returns Promise that resolves when refresh is complete\n   */\n  async refresh(\n    refreshInterface?: string,\n    userInitiated?: boolean\n  ): Promise<DeviceProperties | undefined> {\n    // Currently we don't have a way to refresh a single property,\n    // so we always refresh everything\n    if (refreshInterface) {\n      this.logger.debug(\n        `Refresh requested for interface ${refreshInterface}, but refreshing all properties`\n      );\n    }\n\n    try {\n      const logPrefix = userInitiated ? \"User-initiated\" : \"Scheduled\";\n      this.logger.info(`${logPrefix} refresh starting`);\n\n      const response = await this.deviceApi.getProperties();\n      const properties = response.properties;\n\n      this.logger.info(`${logPrefix} refresh completed successfully`);\n\n      // Notify success callbacks\n      this.notifyRefreshComplete(properties);\n\n      return properties;\n    } catch (error) {\n      const errorObj =\n        error instanceof Error ? error : new Error(String(error));\n      this.logger.warn(\n        `Failed to refresh device properties: ${errorObj.message}, user initiated: ${userInitiated}`\n      );\n\n      // Notify error callbacks\n      this.notifyRefreshError(errorObj);\n\n      return undefined;\n    }\n  }\n\n  /**\n   * Subscribe to successful refresh events\n   *\n   * @param callback - Callback to invoke when refresh completes successfully\n   * @returns Unsubscribe function\n   */\n  onRefreshComplete(callback: RefreshCompleteCallback): () => void {\n    this.refreshCompleteCallbacks.add(callback);\n    return () => this.refreshCompleteCallbacks.delete(callback);\n  }\n\n  /**\n   * Subscribe to refresh error events\n   *\n   * @param callback - Callback to invoke when refresh fails\n   * @returns Unsubscribe function\n   */\n  onRefreshError(callback: RefreshErrorCallback): () => void {\n    this.refreshErrorCallbacks.add(callback);\n    return () => this.refreshErrorCallbacks.delete(callback);\n  }\n\n  /**\n   * Notify listeners of successful refresh\n   */\n  private notifyRefreshComplete(properties: DeviceProperties): void {\n    this.refreshCompleteCallbacks.forEach((callback) => {\n      try {\n        callback(properties);\n      } catch (error) {\n        this.logger.error(`Error in refresh complete callback: ${error}`);\n      }\n    });\n  }\n\n  /**\n   * Notify listeners of refresh error\n   */\n  private notifyRefreshError(error: Error): void {\n    this.refreshErrorCallbacks.forEach((callback) => {\n      try {\n        callback(error);\n      } catch (err) {\n        this.logger.error(`Error in refresh error callback: ${err}`);\n      }\n    });\n  }\n\n  /**\n   * Clean up resources\n   */\n  dispose(): void {\n    this.refreshCompleteCallbacks.clear();\n    this.refreshErrorCallbacks.clear();\n  }\n}\n","/**\n * FFmpeg Utilities\n *\n * Utilities for FFmpeg operations including H.264 to JPEG conversion.\n *\n * @module utils\n */\n\nimport { Logger, ILogObj } from \"tslog\";\n\n/**\n * FFmpegUtils provides utilities for video/image processing using FFmpeg\n */\nexport class FFmpegUtils {\n  private static logger: Logger<ILogObj> = new Logger<ILogObj>({\n    name: \"FFmpegUtils\",\n    type: \"hidden\",\n    minLevel: 3,\n  });\n\n  /**\n   * Convert H.264 video data to JPEG image\n   *\n   * Extracts the first frame from H.264 encoded data and converts it to JPEG format.\n   * Useful for creating snapshots from video keyframes.\n   *\n   * @param h264Data - Buffer containing H.264 encoded video data (typically a keyframe)\n   * @param quality - JPEG quality setting (1-31, lower is better quality, default: 2)\n   * @returns Promise resolving to Buffer containing JPEG image data\n   * @throws Error if FFmpeg fails or returns invalid output\n   *\n   * @example\n   * ```typescript\n   * const h264Keyframe = await captureKeyframe();\n   * const jpegBuffer = await FFmpegUtils.convertH264ToJPEG(h264Keyframe, 2);\n   * ```\n   */\n  static async convertH264ToJPEG(\n    h264Data: Buffer,\n    quality: number = 2\n  ): Promise<Buffer> {\n    const child_process = await import(\"child_process\");\n\n    return new Promise<Buffer>((resolve, reject) => {\n      // Validate quality parameter\n      if (quality < 1 || quality > 31) {\n        reject(\n          new Error(\"JPEG quality must be between 1 and 31 (lower is better)\")\n        );\n        return;\n      }\n\n      // Use FFmpeg to decode H.264 and encode as JPEG\n      const ffmpeg = child_process.spawn(\"ffmpeg\", [\n        \"-f\",\n        \"h264\", // Input format\n        \"-i\",\n        \"pipe:0\", // Read from stdin\n        \"-frames:v\",\n        \"1\", // Extract only the first frame\n        \"-f\",\n        \"image2\", // Output format\n        \"-c:v\",\n        \"mjpeg\", // JPEG codec\n        \"-q:v\",\n        quality.toString(), // Quality setting (1-31, lower is better)\n        \"pipe:1\", // Write to stdout\n      ]);\n\n      const chunks: Buffer[] = [];\n      const errorChunks: Buffer[] = [];\n\n      ffmpeg.stdout.on(\"data\", (chunk) => {\n        chunks.push(chunk);\n      });\n\n      ffmpeg.stderr.on(\"data\", (chunk) => {\n        errorChunks.push(chunk);\n      });\n\n      ffmpeg.on(\"close\", (code) => {\n        if (code === 0 && chunks.length > 0) {\n          const jpegBuffer = Buffer.concat(chunks);\n          this.logger.debug(\n            `Successfully converted H.264 to JPEG: ${jpegBuffer.length} bytes`\n          );\n          resolve(jpegBuffer);\n        } else {\n          const errorOutput = Buffer.concat(errorChunks).toString();\n          const errorMessage = this.parseFFmpegError(code, errorOutput);\n          this.logger.error(`FFmpeg conversion failed: ${errorMessage}`);\n          reject(new Error(errorMessage));\n        }\n      });\n\n      ffmpeg.on(\"error\", (error) => {\n        const errnoError = error as NodeJS.ErrnoException;\n        if (errnoError.code === \"ENOENT\") {\n          const message =\n            \"FFmpeg executable not found. Please ensure FFmpeg is installed and available in PATH.\";\n          this.logger.error(message);\n          reject(new Error(message));\n        } else {\n          this.logger.error(`Failed to spawn FFmpeg: ${error.message}`);\n          reject(new Error(`Failed to spawn FFmpeg: ${error.message}`));\n        }\n      });\n\n      // Write H.264 data to FFmpeg stdin\n      ffmpeg.stdin.write(h264Data);\n      ffmpeg.stdin.end();\n    });\n  }\n\n  /**\n   * Parse FFmpeg error output and provide helpful error messages\n   */\n  private static parseFFmpegError(\n    code: number | null,\n    errorOutput: string\n  ): string {\n    if (errorOutput.includes(\"Invalid data found when processing input\")) {\n      return `Invalid H.264 data provided. The data may be corrupted or incomplete.`;\n    }\n\n    if (errorOutput.includes(\"No such file or directory\")) {\n      return \"FFmpeg executable not found. Please ensure FFmpeg is installed.\";\n    }\n\n    if (errorOutput.includes(\"Permission denied\")) {\n      return \"Permission denied accessing FFmpeg executable.\";\n    }\n\n    if (errorOutput.includes(\"Decoder\") && errorOutput.includes(\"not found\")) {\n      return \"H.264 decoder not available in your FFmpeg installation.\";\n    }\n\n    return `FFmpeg conversion failed with code ${code}: ${errorOutput || \"Unknown error\"}`;\n  }\n\n  /**\n   * Check if FFmpeg is available in the system\n   *\n   * @returns Promise<boolean> indicating if FFmpeg is available\n   */\n  static async isFFmpegAvailable(): Promise<boolean> {\n    const child_process = await import(\"child_process\");\n\n    return new Promise<boolean>((resolve) => {\n      const ffmpeg = child_process.spawn(\"ffmpeg\", [\"-version\"]);\n\n      ffmpeg.on(\"error\", (error) => {\n        const errnoError = error as NodeJS.ErrnoException;\n        if (errnoError.code === \"ENOENT\") {\n          resolve(false);\n        } else {\n          resolve(false);\n        }\n      });\n\n      ffmpeg.on(\"close\", (code) => {\n        resolve(code === 0);\n      });\n    });\n  }\n\n  /**\n   * Get FFmpeg version information\n   *\n   * @returns Promise<string> containing FFmpeg version string\n   */\n  static async getFFmpegVersion(): Promise<string> {\n    const child_process = await import(\"child_process\");\n\n    return new Promise<string>((resolve, reject) => {\n      const ffmpeg = child_process.spawn(\"ffmpeg\", [\"-version\"]);\n      const chunks: Buffer[] = [];\n\n      ffmpeg.stdout.on(\"data\", (chunk) => {\n        chunks.push(chunk);\n      });\n\n      ffmpeg.on(\"error\", (error) => {\n        reject(error);\n      });\n\n      ffmpeg.on(\"close\", (code) => {\n        if (code === 0) {\n          const output = Buffer.concat(chunks).toString();\n          // Extract version from first line (e.g., \"ffmpeg version 4.4.2\")\n          const firstLine = output.split(\"\\n\")[0];\n          resolve(firstLine);\n        } else {\n          reject(new Error(\"Failed to get FFmpeg version\"));\n        }\n      });\n    });\n  }\n}\n","/**\n * Snapshot Service\n *\n * Handles camera snapshot/picture capture operations.\n * Captures H.264 keyframes from stream and converts to JPEG.\n *\n * @module services/device\n */\n\nimport { MediaObject, RequestPictureOptions } from \"@scrypted/sdk\";\nimport sdk from \"@scrypted/sdk\";\nimport { Logger, ILogObj } from \"tslog\";\nimport { FFmpegUtils } from \"../../utils/ffmpeg-utils\";\nimport { IStreamServer } from \"./types\";\n\n/**\n * SnapshotService handles camera snapshot and picture operations\n *\n * This service captures H.264 keyframes from the camera stream\n * and converts them to JPEG images using FFmpeg.\n */\nexport class SnapshotService {\n  constructor(\n    private serialNumber: string,\n    private streamServer: IStreamServer,\n    private logger: Logger<ILogObj>\n  ) {}\n\n  /**\n   * Get picture options supported by this device\n   *\n   * @returns Picture options with default timeout\n   */\n  getPictureOptions(): RequestPictureOptions {\n    return {\n      timeout: 15000, // 15 seconds default\n    };\n  }\n\n  /**\n   * Take a picture/snapshot from the camera\n   *\n   * Captures an H.264 keyframe from the camera stream and converts it to JPEG.\n   *\n   * @param options - Snapshot options (timeout, etc.)\n   * @returns MediaObject containing the JPEG image\n   */\n  async takePicture(options?: RequestPictureOptions): Promise<MediaObject> {\n    this.logger.info(\" Taking snapshot from camera stream\");\n\n    try {\n      // Use timeout from options or default to 15 seconds\n      const timeout = options?.timeout || 15000;\n\n      this.logger.info(`Using timeout: ${timeout}ms for snapshot capture`);\n\n      // The stream server handles starting/stopping the camera stream automatically\n      // It starts the camera stream, waits for a keyframe, captures it, then stops the stream\n      const h264Keyframe = await this.streamServer.captureSnapshot(timeout);\n\n      this.logger.info(\n        `Captured H.264 keyframe: ${h264Keyframe.length} bytes - converting to JPEG`\n      );\n\n      // Convert H.264 keyframe to JPEG using FFmpeg\n      const jpegBuffer = await FFmpegUtils.convertH264ToJPEG(h264Keyframe);\n\n      this.logger.info(\n        ` Snapshot converted to JPEG: ${jpegBuffer.length} bytes`\n      );\n\n      // Create MediaObject with JPEG image\n      return sdk.mediaManager.createMediaObject(jpegBuffer, \"image/jpeg\", {\n        sourceId: this.serialNumber,\n      });\n    } catch (error) {\n      this.logger.error(`Failed to capture snapshot: ${error}`);\n      throw error;\n    }\n  }\n\n  /**\n   * Clean up resources\n   */\n  dispose(): void {\n    this.logger.debug(\"Snapshot service disposed\");\n  }\n}\n","/**\n * Stream Service\n *\n * Manages video streaming operations for Eufy devices.\n * Handles stream server lifecycle, FFmpeg configuration, and media object creation.\n *\n * @module services/device\n */\n\nimport {\n  FFmpegInput,\n  MediaObject,\n  RequestMediaStreamOptions,\n  ResponseMediaStreamOptions,\n} from \"@scrypted/sdk\";\nimport sdk from \"@scrypted/sdk\";\nimport {\n  VideoQuality,\n  requiresErrorResilience,\n} from \"@caplaz/eufy-security-client\";\nimport { Logger, ILogObj } from \"tslog\";\nimport { IStreamServer } from \"./types\";\n\n/**\n * Video dimensions based on quality\n */\nexport interface VideoDimensions {\n  width: number;\n  height: number;\n}\n\n/**\n * Stream configuration options\n */\nexport interface StreamConfig {\n  quality?: VideoQuality;\n  container?: string;\n  codec?: string;\n}\n\n/**\n * StreamService handles video streaming operations\n *\n * This service manages the video stream lifecycle, including:\n * - Stream server startup/shutdown\n * - FFmpeg configuration for low-latency streaming\n * - Media object creation for Scrypted\n * - Video dimension calculation based on quality\n */\nexport class StreamService {\n  private streamServerStarted = false;\n\n  constructor(\n    private serialNumber: string,\n    private streamServer: IStreamServer,\n    private logger: Logger<ILogObj>,\n    private deviceType?: number\n  ) {}\n\n  /**\n   * Update the device type (called after properties are loaded)\n   */\n  setDeviceType(deviceType: number): void {\n    this.deviceType = deviceType;\n  }\n\n  /**\n   * Get video dimensions based on quality setting\n   *\n   * @param quality - Video quality setting\n   * @returns Video dimensions (width and height)\n   */\n  getVideoDimensions(quality?: VideoQuality): VideoDimensions {\n    switch (quality) {\n      case VideoQuality.LOW:\n        return { width: 640, height: 480 };\n      case VideoQuality.MEDIUM:\n        return { width: 1280, height: 720 };\n      case VideoQuality.HIGH:\n        return { width: 1920, height: 1080 };\n      case VideoQuality.ULTRA:\n        return { width: 2560, height: 1440 };\n      default:\n        return { width: 1920, height: 1080 };\n    }\n  }\n\n  /**\n   * Get available video stream options\n   *\n   * @param quality - Current video quality setting\n   * @returns Array of stream options for Scrypted\n   */\n  getVideoStreamOptions(quality?: VideoQuality): ResponseMediaStreamOptions[] {\n    const { width, height } = this.getVideoDimensions(quality);\n\n    return [\n      {\n        id: \"p2p\",\n        name: \"P2P Stream\",\n        container: \"h264\", // Raw H.264 stream (not MP4 container)\n        video: {\n          codec: \"h264\",\n          width,\n          height,\n        },\n      },\n    ];\n  }\n\n  /**\n   * Get video stream media object\n   *\n   * Starts the stream server if needed and creates a MediaObject\n   * configured for low-latency H.264 streaming via FFmpeg.\n   *\n   * @param quality - Video quality setting\n   * @param options - Request options from Scrypted\n   * @returns MediaObject for FFmpeg streaming\n   */\n  async getVideoStream(\n    quality: VideoQuality | undefined,\n    options?: RequestMediaStreamOptions\n  ): Promise<MediaObject> {\n    this.logger.info(\"Getting video stream, starting stream server if needed\");\n\n    if (!this.streamServerStarted) {\n      this.logger.info(\"Starting stream server...\");\n      await this.streamServer.start();\n      this.streamServerStarted = true;\n      this.logger.info(\"Stream server started\");\n    }\n\n    const port = this.streamServer.getPort();\n    if (!port) {\n      throw new Error(\"Failed to get stream server port\");\n    }\n\n    this.logger.info(`Stream server is listening on port ${port}`);\n    this.logger.info(\n      \"Creating MediaObject with fallback dimensions (metadata will be updated when stream starts)\"\n    );\n\n    return await this.createOptimizedMediaObject(port, quality, options);\n  }\n\n  /**\n   * Stop the video stream\n   *\n   * @returns Promise that resolves when stream is stopped\n   */\n  async stopStream(): Promise<void> {\n    if (this.streamServerStarted) {\n      this.logger.info(\"Stopping stream server\");\n      await this.streamServer.stop();\n      this.streamServerStarted = false;\n      this.logger.info(\"Stream server stopped\");\n    }\n  }\n\n  /**\n   * Check if stream is currently active\n   *\n   * @returns true if stream server is running\n   */\n  isStreaming(): boolean {\n    return this.streamServerStarted;\n  }\n\n  /**\n   * Create an optimized MediaObject for FFmpeg streaming\n   *\n   * Configures FFmpeg with low-latency H.264 settings optimized for\n   * Eufy camera streams, including special handling for battery cameras\n   * and front cameras that require longer analysis time.\n   *\n   * @param port - TCP port where stream server is listening\n   * @param quality - Video quality setting\n   * @param options - Request options from Scrypted\n   * @returns MediaObject configured for FFmpeg\n   */\n  private async createOptimizedMediaObject(\n    port: number,\n    quality: VideoQuality | undefined,\n    options?: RequestMediaStreamOptions\n  ): Promise<MediaObject> {\n    const { width, height } = this.getVideoDimensions(quality);\n\n    // FFmpeg configuration optimized for low-latency H.264 streaming with balanced error handling\n    const ffmpegInput: FFmpegInput = {\n      url: undefined,\n      inputArguments: [\n        \"-f\",\n        \"h264\", // Default to h264, will be updated when metadata is available\n        \"-framerate\",\n        \"25\", // Default framerate, will be updated when metadata is available\n        \"-analyzeduration\",\n        \"5000000\", // Increased analysis time (5M) to find SPS/PPS for front camera\n        \"-probesize\",\n        \"5000000\", // Increased probe size (5M) to find SPS/PPS for front camera\n        \"-fflags\",\n        \"+nobuffer+fastseek+flush_packets+discardcorrupt+igndts+genpts\", // Low-latency flags + ignore timestamps\n        \"-flags\",\n        \"low_delay\", // Minimize buffering delay\n        \"-avioflags\",\n        \"direct\", // Direct I/O access\n        \"-max_delay\",\n        \"1000\", // Allow more delay for stream analysis\n        \"-thread_queue_size\",\n        \"768\", // Balanced thread queue size\n        \"-hwaccel\",\n        \"auto\", // Enable hardware acceleration if available\n        \"-err_detect\",\n        \"ignore_err+crccheck\", // Selective error tolerance for battery cameras\n        \"-c:v\",\n        \"h264\", // Explicitly specify H.264 decoder\n        // Enable error resilience only for cameras that require it (e.g., SoloCam S340 with data partitioning)\n        ...(this.deviceType && requiresErrorResilience(this.deviceType)\n          ? [\"-enable_er\", \"1\"]\n          : []),\n        \"-i\",\n        `tcp://127.0.0.1:${port}`, // TCP input source\n      ],\n      mediaStreamOptions: {\n        id: options?.id || \"main\",\n        name: options?.name || \"Eufy Camera Stream\",\n        container: options?.container,\n        video: {\n          codec: \"h264\",\n          width,\n          height,\n          ...options?.video, // Use provided video options\n        },\n        // Audio support can be added later when needed\n      },\n    };\n\n    return await sdk.mediaManager.createFFmpegMediaObject(ffmpegInput);\n  }\n\n  /**\n   * Clean up resources\n   */\n  async dispose(): Promise<void> {\n    await this.stopStream();\n    this.logger.debug(\"Stream service disposed\");\n  }\n}\n","/**\n * Video Clips Service\n *\n * Manages video clip retrieval from both local storage (P2P) and cloud API.\n * Handles metadata caching, thumbnail pre-downloading, and clip downloads.\n *\n * @module services/video\n */\n\nimport {\n  EufyWebSocketClient,\n  StorageType,\n  DEVICE_EVENTS,\n} from \"@caplaz/eufy-security-client\";\nimport { VideoClip, MediaObject } from \"@scrypted/sdk\";\nimport sdk from \"@scrypted/sdk\";\nimport { Logger, ILogObj } from \"tslog\";\nimport { VideoClipMetadata, VideoClipQuery } from \"./types\";\n\n/**\n * VideoClipsService handles all video clip operations including:\n * - Querying clips from station database (P2P)\n * - Fallback to cloud API\n * - Pre-downloading thumbnails to avoid URL expiration\n * - P2P downloads of videos and thumbnails\n */\nexport class VideoClipsService {\n  /** Cache of video clip metadata for efficient retrieval */\n  private clipMetadataCache = new Map<string, VideoClipMetadata>();\n\n  constructor(\n    private wsClient: EufyWebSocketClient,\n    private logger: Logger<ILogObj>\n  ) {}\n\n  /**\n   * Get video clips for a device within a time range\n   *\n   * @param query - Query parameters including device serial, station, and time range\n   * @returns Array of video clips with metadata\n   */\n  async getClips(query: VideoClipQuery): Promise<VideoClip[]> {\n    try {\n      this.logger.debug(\n        `Fetching video clips for device ${query.serialNumber} on station ${query.stationSerialNumber}`\n      );\n\n      // Try station database first (local P2P)\n      const clips = await this.getClipsFromStationDatabase(query);\n\n      if (clips.length > 0) {\n        return clips;\n      }\n\n      // Fallback to cloud API\n      this.logger.debug(\"No local recordings found, falling back to cloud API\");\n      return await this.getClipsFromCloudAPI(query);\n    } catch (error) {\n      this.logger.error(\"Error fetching video clips:\", error);\n\n      // Try cloud API as fallback on error\n      try {\n        return await this.getClipsFromCloudAPI(query);\n      } catch (fallbackError) {\n        this.logger.error(\"Cloud API fallback also failed:\", fallbackError);\n        return [];\n      }\n    }\n  }\n\n  /**\n   * Download a video clip by ID\n   *\n   * @param videoId - Unique video clip identifier\n   * @param serialNumber - Device serial number\n   * @returns MediaObject containing the video data\n   */\n  async downloadClip(\n    videoId: string,\n    serialNumber: string\n  ): Promise<MediaObject> {\n    this.logger.debug(`Fetching video clip: ${videoId}`);\n\n    const metadata = this.clipMetadataCache.get(videoId);\n    if (!metadata) {\n      throw new Error(`Video clip metadata not found for ID: ${videoId}`);\n    }\n\n    // Check for P2P download capability\n    if (metadata.storage_path && metadata.cipher_id !== undefined) {\n      return await this.downloadClipViaP2P(videoId, serialNumber, metadata);\n    }\n\n    // Fallback to cloud path\n    if (metadata.cloud_path) {\n      this.logger.debug(`Using cloud path: ${metadata.cloud_path}`);\n      return sdk.mediaManager.createMediaObject(\n        Buffer.from(metadata.cloud_path),\n        \"text/plain\",\n        { sourceId: serialNumber }\n      );\n    }\n\n    throw new Error(\n      `No storage path, cipher ID, or cloud path available for video: ${videoId}`\n    );\n  }\n\n  /**\n   * Download a thumbnail for a video clip\n   *\n   * @param thumbnailId - Unique thumbnail identifier\n   * @param serialNumber - Device serial number\n   * @returns MediaObject containing the thumbnail image\n   */\n  async downloadThumbnail(\n    thumbnailId: string,\n    serialNumber: string\n  ): Promise<MediaObject> {\n    this.logger.debug(`Fetching thumbnail: ${thumbnailId}`);\n\n    const metadata = this.clipMetadataCache.get(thumbnailId);\n    if (!metadata) {\n      throw new Error(`Thumbnail metadata not found for ID: ${thumbnailId}`);\n    }\n\n    // Check for pre-downloaded cached thumbnail\n    if (metadata.cached_thumbnail) {\n      this.logger.debug(\n        `Using pre-downloaded cached thumbnail for ${thumbnailId}`\n      );\n      return sdk.mediaManager.createMediaObject(\n        metadata.cached_thumbnail,\n        \"image/jpeg\",\n        { sourceId: serialNumber }\n      );\n    }\n\n    // Check for P2P download capability\n    if (metadata.thumb_path && metadata.cipher_id !== undefined) {\n      return await this.downloadThumbnailViaP2P(\n        thumbnailId,\n        serialNumber,\n        metadata\n      );\n    }\n\n    // Fallback to cloud thumbnail\n    if (metadata.cloud_thumbnail) {\n      this.logger.debug(`Attempting to download cloud thumbnail from URL`);\n      try {\n        const thumbnailBuffer = await this.downloadFromUrl(\n          metadata.cloud_thumbnail\n        );\n        return sdk.mediaManager.createMediaObject(\n          thumbnailBuffer,\n          \"image/jpeg\",\n          { sourceId: serialNumber }\n        );\n      } catch (error) {\n        this.logger.error(\"Failed to download cloud thumbnail:\", error);\n        throw new Error(\n          `Cloud thumbnail URL expired or inaccessible for: ${thumbnailId}`\n        );\n      }\n    }\n\n    throw new Error(\n      `No thumbnail path, cipher ID, or cloud thumbnail available for: ${thumbnailId}`\n    );\n  }\n\n  /**\n   * Clear the metadata cache\n   */\n  clearCache(): void {\n    this.clipMetadataCache.clear();\n  }\n\n  /**\n   * Get clips from station database (local P2P storage)\n   */\n  private async getClipsFromStationDatabase(\n    query: VideoClipQuery\n  ): Promise<VideoClip[]> {\n    const queryParams = {\n      serialNumbers: [query.serialNumber],\n      startDate: this.formatDate(query.startTime),\n      endDate: this.formatDate(query.endTime),\n      eventType: 0, // All event types\n      detectionType: 0, // All detection types\n      storageType: 1, // Local storage\n    };\n\n    this.logger.debug(\n      \"Querying station database with params:\",\n      JSON.stringify(queryParams, null, 2)\n    );\n\n    await this.wsClient.commands\n      .station(query.stationSerialNumber)\n      .databaseQueryLocal(queryParams);\n\n    // Wait for database query response\n    const databaseRecords = await this.waitForDatabaseQueryResponse(\n      query.stationSerialNumber\n    );\n\n    if (databaseRecords.length === 0) {\n      this.logger.warn(\"No local recordings found in station database\");\n      return [];\n    }\n\n    this.logger.debug(\n      `Found ${databaseRecords.length} records from station database`\n    );\n\n    return this.mapDatabaseRecordsToClips(databaseRecords, query.serialNumber);\n  }\n\n  /**\n   * Get clips from Eufy cloud API\n   */\n  private async getClipsFromCloudAPI(\n    query: VideoClipQuery\n  ): Promise<VideoClip[]> {\n    this.logger.debug(\n      `Fetching video clips from cloud API for time range: ${new Date(query.startTime).toISOString()} to ${new Date(query.endTime).toISOString()}`\n    );\n\n    const { events } = await this.wsClient.commands.driver().getHistoryEvents({\n      startTimestampMs: query.startTime,\n      endTimestampMs: query.endTime,\n      filter: {\n        stationSN: query.stationSerialNumber,\n        storageType: StorageType.LOCAL_AND_CLOUD,\n      },\n    });\n\n    this.logger.debug(`Received ${events.length} events from cloud API`);\n\n    const deviceEvents = events.filter(\n      (event) => event.stationSN === query.stationSerialNumber\n    );\n\n    if (deviceEvents.length === 0) {\n      this.logger.warn(\"No recordings found in cloud API for this device\");\n      return [];\n    }\n\n    // Pre-download thumbnails to avoid URL expiration\n    await this.preDownloadThumbnails(deviceEvents, query.serialNumber);\n\n    return this.mapCloudEventsToClips(deviceEvents, query.serialNumber);\n  }\n\n  /**\n   * Download a video clip via P2P\n   */\n  private async downloadClipViaP2P(\n    videoId: string,\n    serialNumber: string,\n    metadata: VideoClipMetadata\n  ): Promise<MediaObject> {\n    this.logger.debug(\"Starting P2P download for video clip\", {\n      storage_path: metadata.storage_path,\n      cipher_id: metadata.cipher_id,\n    });\n\n    const api = this.wsClient.commands.device(serialNumber);\n    await api.startDownload({\n      path: metadata.storage_path!,\n      cipherId: metadata.cipher_id!,\n    });\n\n    const videoBuffer = await this.collectDownloadData(serialNumber, 60000);\n\n    return sdk.mediaManager.createMediaObject(videoBuffer, \"video/mp4\", {\n      sourceId: serialNumber,\n    });\n  }\n\n  /**\n   * Download a thumbnail via P2P\n   */\n  private async downloadThumbnailViaP2P(\n    thumbnailId: string,\n    serialNumber: string,\n    metadata: VideoClipMetadata\n  ): Promise<MediaObject> {\n    this.logger.debug(\"Starting P2P download for thumbnail\", {\n      thumb_path: metadata.thumb_path,\n      cipher_id: metadata.cipher_id,\n    });\n\n    const api = this.wsClient.commands.device(serialNumber);\n    await api.startDownload({\n      path: metadata.thumb_path!,\n      cipherId: metadata.cipher_id!,\n    });\n\n    const thumbnailBuffer = await this.collectDownloadData(serialNumber, 30000);\n\n    return sdk.mediaManager.createMediaObject(thumbnailBuffer, \"image/jpeg\", {\n      sourceId: serialNumber,\n    });\n  }\n\n  /**\n   * Collect download data from WebSocket events\n   */\n  private collectDownloadData(\n    serialNumber: string,\n    timeout: number\n  ): Promise<Buffer> {\n    const chunks: Buffer[] = [];\n    let downloadComplete = false;\n\n    return new Promise<Buffer>((resolve, reject) => {\n      const timer = setTimeout(() => {\n        this.logger.error(`Download timed out after ${timeout}ms`);\n        removeListeners();\n        reject(new Error(`Download timed out`));\n      }, timeout);\n\n      const removeVideoDataListener = this.wsClient.addEventListener(\n        DEVICE_EVENTS.DOWNLOAD_VIDEO_DATA,\n        (event) => {\n          if (event.serialNumber === serialNumber) {\n            const buffer = Array.isArray(event.buffer)\n              ? Buffer.from(event.buffer as number[])\n              : Buffer.from(event.buffer as string, \"base64\");\n\n            chunks.push(buffer);\n            this.logger.debug(\n              `Received chunk: ${buffer.length} bytes (total: ${chunks.reduce((sum, b) => sum + b.length, 0)} bytes)`\n            );\n          }\n        },\n        { source: \"device\" as any }\n      );\n\n      const removeFinishedListener = this.wsClient.addEventListener(\n        DEVICE_EVENTS.DOWNLOAD_FINISHED,\n        (event) => {\n          if (event.serialNumber === serialNumber && !downloadComplete) {\n            downloadComplete = true;\n            clearTimeout(timer);\n            removeListeners();\n\n            this.logger.debug(\n              `Download complete: ${chunks.length} chunks, ${chunks.reduce((sum, b) => sum + b.length, 0)} total bytes`\n            );\n\n            if (chunks.length === 0) {\n              reject(new Error(\"No data received\"));\n              return;\n            }\n\n            resolve(Buffer.concat(chunks));\n          }\n        },\n        { source: \"device\" as any }\n      );\n\n      const removeListeners = () => {\n        removeVideoDataListener();\n        removeFinishedListener();\n      };\n    });\n  }\n\n  /**\n   * Wait for database query response from WebSocket\n   */\n  private waitForDatabaseQueryResponse(\n    stationSerialNumber: string\n  ): Promise<any[]> {\n    return new Promise<any[]>((resolve) => {\n      const timeout = setTimeout(() => {\n        this.logger.warn(\"Station database query timed out after 10 seconds\");\n        resolve([]);\n      }, 10000);\n\n      const removeListener = this.wsClient.addEventListener(\n        \"database query local\" as any,\n        (event: any) => {\n          if (event.serialNumber === stationSerialNumber) {\n            clearTimeout(timeout);\n            removeListener();\n\n            if (Array.isArray(event.data)) {\n              resolve(event.data);\n            } else {\n              this.logger.error(\n                \"Unexpected data format from station database query\"\n              );\n              resolve([]);\n            }\n          }\n        },\n        { source: \"station\" as any }\n      );\n    });\n  }\n\n  /**\n   * Pre-download thumbnails from cloud to avoid URL expiration\n   */\n  private async preDownloadThumbnails(\n    events: any[],\n    serialNumber: string\n  ): Promise<void> {\n    const thumbnailPromises = events\n      .filter((event) => event.thumbnailUrl)\n      .map(async (event) => {\n        const clipId = `cloud-${serialNumber}-${event.startTime}-${event.eventType}`;\n        try {\n          this.logger.debug(`Pre-downloading thumbnail for ${clipId}`);\n          const thumbnailBuffer = await this.downloadFromUrl(\n            event.thumbnailUrl!\n          );\n          return { clipId, thumbnailBuffer };\n        } catch (error) {\n          this.logger.warn(\n            `Failed to pre-download thumbnail for ${clipId}:`,\n            error\n          );\n          return { clipId, thumbnailBuffer: null };\n        }\n      });\n\n    const results = await Promise.all(thumbnailPromises);\n\n    results.forEach(({ clipId, thumbnailBuffer }) => {\n      if (thumbnailBuffer) {\n        const metadata = this.clipMetadataCache.get(clipId) || {};\n        metadata.cached_thumbnail = thumbnailBuffer;\n        this.clipMetadataCache.set(clipId, metadata);\n      }\n    });\n\n    this.logger.debug(\n      `Successfully pre-downloaded ${results.filter((r) => r.thumbnailBuffer).length} thumbnails`\n    );\n  }\n\n  /**\n   * Download content from URL\n   */\n  private async downloadFromUrl(url: string): Promise<Buffer> {\n    const response = await fetch(url);\n    if (!response.ok) {\n      throw new Error(`HTTP ${response.status}: ${response.statusText}`);\n    }\n    const arrayBuffer = await response.arrayBuffer();\n    return Buffer.from(arrayBuffer);\n  }\n\n  /**\n   * Map database records to VideoClip objects\n   */\n  private mapDatabaseRecordsToClips(\n    records: any[],\n    serialNumber: string\n  ): VideoClip[] {\n    return records.map((record) => {\n      const startTimeMs =\n        typeof record.start_time === \"string\"\n          ? new Date(record.start_time).getTime()\n          : record.start_time;\n\n      const endTimeMs =\n        typeof record.end_time === \"string\"\n          ? new Date(record.end_time).getTime()\n          : record.end_time;\n\n      const clipId = record.record_id\n        ? `${serialNumber}-${record.record_id}`\n        : `${serialNumber}-${startTimeMs}-${record.video_type}`;\n\n      // Store metadata\n      this.clipMetadataCache.set(clipId, {\n        storage_path: record.storage_path,\n        cipher_id: record.cipher_id,\n        thumb_path: record.thumb_path,\n        cloud_path: record.cloud_path,\n        storage_type: record.storage_type,\n        record_id: record.record_id,\n      });\n\n      const duration =\n        endTimeMs && endTimeMs > startTimeMs\n          ? endTimeMs - startTimeMs\n          : undefined;\n\n      return {\n        id: clipId,\n        startTime: startTimeMs,\n        duration,\n        event: this.mapEventType(record.video_type || 0),\n        description: this.getEventDescription(record.video_type || 0),\n        thumbnailId: record.thumb_path ? clipId : undefined,\n        videoId: record.storage_path ? clipId : undefined,\n      };\n    });\n  }\n\n  /**\n   * Map cloud events to VideoClip objects\n   */\n  private mapCloudEventsToClips(\n    events: any[],\n    serialNumber: string\n  ): VideoClip[] {\n    return events.map((event) => {\n      const clipId = `cloud-${serialNumber}-${event.startTime}-${event.eventType}`;\n\n      // Store metadata\n      this.clipMetadataCache.set(clipId, {\n        cloud_path: event.videoUrl,\n        storage_type: event.storageType,\n        cloud_thumbnail: event.thumbnailUrl,\n      });\n\n      const duration = event.endTime\n        ? event.endTime - event.startTime\n        : undefined;\n\n      return {\n        id: clipId,\n        startTime: event.startTime,\n        duration,\n        event: this.mapEventType(event.eventType || 0),\n        description: this.getEventDescription(event.eventType || 0),\n        thumbnailId: event.thumbnailUrl ? clipId : undefined,\n        videoId: event.videoUrl ? clipId : undefined,\n      };\n    });\n  }\n\n  /**\n   * Format timestamp to YYYYMMDD\n   */\n  private formatDate(timestamp: number): string {\n    const date = new Date(timestamp);\n    const year = date.getFullYear();\n    const month = String(date.getMonth() + 1).padStart(2, \"0\");\n    const day = String(date.getDate()).padStart(2, \"0\");\n    return `${year}${month}${day}`;\n  }\n\n  /**\n   * Map Eufy event type to human-readable description\n   */\n  private getEventDescription(eventType: number): string {\n    const descriptions: Record<number, string> = {\n      1: \"Motion detected\",\n      2: \"Person detected\",\n      3: \"Doorbell pressed\",\n      4: \"Crying detected\",\n      5: \"Sound detected\",\n      6: \"Pet detected\",\n      7: \"Vehicle detected\",\n      8: \"Package delivered\",\n      9: \"Package stranded\",\n      10: \"Package taken\",\n      11: \"Someone loitering\",\n      12: \"Radar motion\",\n      13: \"Dog detected\",\n      14: \"Dog lick detected\",\n      15: \"Dog poop detected\",\n      16: \"Stranger detected\",\n    };\n    return descriptions[eventType] || `Event ${eventType}`;\n  }\n\n  /**\n   * Map Eufy event type to Scrypted event type\n   */\n  private mapEventType(eventType: number): string | undefined {\n    const typeMap: Record<number, string> = {\n      1: \"motion\",\n      2: \"person\",\n      3: \"ring\",\n      4: \"crying\",\n      5: \"sound\",\n      6: \"pet\",\n      7: \"vehicle\",\n      8: \"package\",\n      9: \"package\",\n      10: \"package\",\n      11: \"loitering\",\n      12: \"motion\",\n      13: \"pet\",\n      14: \"pet\",\n      15: \"pet\",\n      16: \"stranger\",\n    };\n    return typeMap[eventType];\n  }\n}\n","/**\n * PTZ Control Service\n *\n * Manages pan/tilt/zoom operations for Eufy devices.\n * Handles PTZ capability detection and command execution.\n *\n * @module services/control\n */\n\nimport { PanTiltZoomCommand } from \"@scrypted/sdk\";\nimport {\n  PanTiltDirection,\n  getDeviceCapabilities,\n} from \"@caplaz/eufy-security-client\";\nimport { Logger, ILogObj } from \"tslog\";\nimport { DeviceApi, PtzCapabilities } from \"./types\";\n\n/**\n * PtzControlService handles pan/tilt/zoom operations\n *\n * This service manages PTZ control for compatible Eufy cameras:\n * - Capability detection based on device type\n * - Command routing to appropriate API methods\n * - Direction mapping for pan and tilt operations\n */\nexport class PtzControlService {\n  constructor(\n    private deviceApi: DeviceApi,\n    private getDeviceType: () => number | undefined,\n    private logger: Logger<ILogObj>\n  ) {}\n\n  /**\n   * Update PTZ capabilities based on device type\n   *\n   * @returns PTZ capabilities for the device\n   */\n  updateCapabilities(): PtzCapabilities {\n    const deviceType = this.getDeviceType();\n    const capabilities = getDeviceCapabilities(deviceType || 0);\n\n    return {\n      pan: capabilities.panTilt,\n      tilt: capabilities.panTilt,\n      zoom: false, // No Eufy cameras currently support zoom\n    };\n  }\n\n  /**\n   * Execute a PTZ command\n   *\n   * Handles pan and tilt commands by routing to the appropriate\n   * device API method. Tilt commands are prioritized over pan\n   * commands when both are provided.\n   *\n   * @param command - PTZ command from Scrypted\n   * @throws Error if command is not implemented or unsupported\n   */\n  async executeCommand(command: PanTiltZoomCommand): Promise<void> {\n    // Tilt has priority over pan if both are provided\n    if (command.tilt !== undefined) {\n      await this.executeTilt(command.tilt);\n      return;\n    }\n\n    if (command.pan !== undefined) {\n      await this.executePan(command.pan);\n      return;\n    }\n\n    throw new Error(\"Method not implemented.\");\n  }\n\n  /**\n   * Execute tilt command\n   *\n   * @param tiltValue - Positive for up, negative for down\n   */\n  private async executeTilt(tiltValue: number): Promise<void> {\n    const direction =\n      tiltValue > 0 ? PanTiltDirection.UP : PanTiltDirection.DOWN;\n\n    await this.deviceApi.panAndTilt({ direction });\n\n    this.logger.info(`Tilted camera ${tiltValue > 0 ? \"up\" : \"down\"}`);\n  }\n\n  /**\n   * Execute pan command\n   *\n   * @param panValue - Positive for right, negative for left\n   */\n  private async executePan(panValue: number): Promise<void> {\n    const direction =\n      panValue > 0 ? PanTiltDirection.RIGHT : PanTiltDirection.LEFT;\n\n    await this.deviceApi.panAndTilt({ direction });\n\n    this.logger.info(`Panned camera ${panValue > 0 ? \"right\" : \"left\"}`);\n  }\n\n  /**\n   * Clean up resources\n   */\n  dispose(): void {\n    this.logger.debug(\"PTZ control service disposed\");\n  }\n}\n","/**\n * Light Control Service\n *\n * Manages light operations for Eufy devices with spotlight/floodlight capabilities.\n * Handles on/off control and brightness adjustment.\n *\n * @module services/control\n */\n\nimport { Logger, ILogObj } from \"tslog\";\nimport { DeviceApi } from \"./types\";\n\n/**\n * LightControlService handles light operations\n *\n * This service manages light control for Eufy devices:\n * - Turn light on/off\n * - Adjust brightness level\n * - Property updates via device API\n *\n * Note: State updates are received via property change events\n * from the WebSocket connection, so these methods don't update\n * local state directly.\n */\nexport class LightControlService {\n  constructor(\n    private deviceApi: DeviceApi,\n    private logger: Logger<ILogObj>\n  ) {}\n\n  /**\n   * Turn light on\n   *\n   * State will be updated via property change event from WebSocket\n   */\n  async turnOn(): Promise<void> {\n    await this.deviceApi.setProperty(\"light\", true);\n    this.logger.info(\"Light turned on\");\n  }\n\n  /**\n   * Turn light off\n   *\n   * State will be updated via property change event from WebSocket\n   */\n  async turnOff(): Promise<void> {\n    await this.deviceApi.setProperty(\"light\", false);\n    this.logger.info(\"Light turned off\");\n  }\n\n  /**\n   * Set brightness level\n   *\n   * @param brightness - Brightness level (0-100)\n   * State will be updated via property change event from WebSocket\n   */\n  async setBrightness(brightness: number): Promise<void> {\n    // Validate brightness range\n    if (brightness < 0 || brightness > 100) {\n      throw new Error(\n        `Invalid brightness value: ${brightness}. Must be between 0 and 100.`\n      );\n    }\n\n    await this.deviceApi.setProperty(\n      \"lightSettingsBrightnessManual\",\n      brightness\n    );\n    this.logger.info(`Light brightness set to ${brightness}%`);\n  }\n\n  /**\n   * Clean up resources\n   */\n  dispose(): void {\n    this.logger.debug(\"Light control service disposed\");\n  }\n}\n","/**\n * Eufy Device for VideoCamera functionality in Scrypted\n *\n * Implements Scrypted VideoCamera, MotionSensor, Settings, Refresh, and Online interfaces.\n * Provides TCP server for H.264 video streaming to FFmpeg, robust memory control, and event-driven updates.\n *\n * Performance Optimizations:\n * - Lazy stream session creation to minimize memory footprint when not streaming\n * - Efficient event listener management with automatic cleanup on disposal\n * - Smart buffer management through MemoryManager integration\n * - Optimized property caching to reduce API calls\n * - Stream session reuse for multiple concurrent consumers\n * - Memory-conscious video chunk buffering with configurable limits\n *\n * Streaming Performance Features:\n * - TCP server with efficient H.264 NAL unit parsing\n * - Audio streaming support with AAC codec detection\n * - Smart keyframe detection for stream initialization\n * - Configurable buffer limits for memory management\n * - Progressive cleanup strategies during memory pressure\n *\n * Architecture Optimizations:\n * - Single stream session per device with multiple consumer support\n * - Event-driven property updates to minimize polling\n * - Efficient device capability detection using Set lookups\n * - Optimized settings interface with grouped configurations\n */\n\nimport {\n  Battery,\n  BinarySensor,\n  Brightness,\n  Camera,\n  Charger,\n  MediaObject,\n  MotionSensor,\n  OnOff,\n  PanTiltZoom,\n  PanTiltZoomCommand,\n  Refresh,\n  RequestMediaStreamOptions,\n  RequestPictureOptions,\n  ResponseMediaStreamOptions,\n  ResponsePictureOptions,\n  ScryptedDeviceBase,\n  ScryptedInterface,\n  Sensors,\n  Setting,\n  SettingValue,\n  Settings,\n  VideoCamera,\n  VideoClip,\n  VideoClipOptions,\n  VideoClipThumbnailOptions,\n  VideoClips,\n} from \"@scrypted/sdk\";\n\nimport {\n  DEVICE_EVENTS,\n  DeviceEventSource,\n  DeviceEventType,\n  DeviceMotionDetectedEventPayload,\n  DeviceRingsEventPayload,\n  DeviceProperties,\n  DevicePropertyChangedEventPayload,\n  EVENT_SOURCES,\n  EufyWebSocketClient,\n  EventCallbackForType,\n} from \"@caplaz/eufy-security-client\";\n\nimport { Logger, ILogObj } from \"tslog\";\nimport { StreamServer } from \"@caplaz/eufy-stream-server\";\n\n// Device Services\nimport {\n  DeviceSettingsService,\n  DeviceStateService,\n  RefreshService,\n  SnapshotService,\n  StreamService,\n  StateChangeEvent,\n} from \"./services/device\";\nimport { PropertyMapper } from \"./utils/property-mapper\";\nimport { VideoClipsService } from \"./services/video\";\nimport { PtzControlService, LightControlService } from \"./services/control\";\n\n// Helper to create a transport function for routing tslog to Scrypted console\nfunction createConsoleTransport(console: Console) {\n  return (logObj: any) => {\n    const meta = logObj._meta;\n    if (!meta) return;\n    const prefix = meta.name ? `[${meta.name}] ` : \"\";\n\n    // Extract all non-meta properties as the log arguments\n    const args = Object.keys(logObj)\n      .filter((key) => key !== \"_meta\" && key !== \"toJSON\")\n      .map((key) => logObj[key]);\n\n    const msg = args\n      .map((a: any) => (typeof a === \"object\" ? JSON.stringify(a) : String(a)))\n      .join(\" \");\n\n    const level = meta.logLevelName?.toLowerCase();\n    if (level === \"warn\") console.warn(`${prefix}${msg}`);\n    else if (level === \"error\" || level === \"fatal\")\n      console.error(`${prefix}${msg}`);\n    else console.log(`${prefix}${msg}`);\n  };\n}\n\n/**\n * EufyDevice - TCP server implementation for VideoCamera\n */\nexport class EufyDevice\n  extends ScryptedDeviceBase\n  implements\n    VideoCamera,\n    VideoClips,\n    Camera,\n    MotionSensor,\n    BinarySensor,\n    Battery,\n    Charger,\n    PanTiltZoom,\n    OnOff,\n    Brightness,\n    Sensors,\n    Settings,\n    Refresh\n{\n  private wsClient: EufyWebSocketClient;\n  private logger: Logger<ILogObj>;\n\n  // Device info and state\n  private latestProperties?: DeviceProperties;\n  private propertiesLoaded: Promise<void>;\n\n  // Services\n  private settingsService!: DeviceSettingsService;\n  private stateService!: DeviceStateService;\n  private refreshService!: RefreshService;\n  private videoClipsService!: VideoClipsService;\n  private snapshotService!: SnapshotService;\n  private streamService!: StreamService;\n  private ptzControlService!: PtzControlService;\n  private lightControlService!: LightControlService;\n\n  private streamServer!: StreamServer;\n\n  /**\n   * Get the serial number for this station.\n   * @returns {string} Serial number from device info, or 'unknown' if not set.\n   */\n  get serialNumber(): string {\n    return this.info?.serialNumber || \"unknown\";\n  }\n\n  /**\n   * Get the API command interface for this device.\n   * @returns {any} API command object for this device's serial number.\n   */\n  get api() {\n    return this.wsClient.commands.device(this.serialNumber);\n  }\n\n  constructor(\n    nativeId: string,\n    wsClient: EufyWebSocketClient,\n    parentLogger: Logger<ILogObj>\n  ) {\n    super(nativeId);\n    this.wsClient = wsClient;\n\n    // Create a sub-logger with this device's console\n    // This ensures device logs appear in the device's log window in Scrypted\n    // Use attachedTransports: [] to prevent inheriting parent's transport\n    const loggerName = nativeId.charAt(0).toUpperCase() + nativeId.slice(1);\n    this.logger = parentLogger.getSubLogger({\n      name: loggerName,\n      attachedTransports: [],\n    });\n    this.logger.attachTransport(createConsoleTransport(this.console));\n\n    this.logger.info(`Created EufyDevice for ${nativeId}`);\n\n    this.createStreamServer();\n    this.initializeServices();\n\n    // Properties changed event listener\n    this.addEventListener(\n      DEVICE_EVENTS.PROPERTY_CHANGED,\n      this.handlePropertyChangedEvent.bind(this)\n    );\n\n    this.addEventListener(\n      DEVICE_EVENTS.MOTION_DETECTED,\n      this.handleMotionDetectedEvent.bind(this)\n    );\n\n    this.addEventListener(\n      DEVICE_EVENTS.RINGS,\n      this.handleDoorbellRingsEvent.bind(this)\n    );\n\n    // Listen for stream started/stopped events\n    this.wsClient.addEventListener(\n      DEVICE_EVENTS.LIVESTREAM_STARTED,\n      () => {\n        this.logger.info(\"Stream started\");\n      },\n      {\n        serialNumber: this.info?.serialNumber,\n      }\n    );\n    this.wsClient.addEventListener(\n      DEVICE_EVENTS.LIVESTREAM_STOPPED,\n      () => {\n        this.logger.debug(\" WebSocket livestream stopped event received\");\n      },\n      {\n        serialNumber: this.info?.serialNumber,\n      }\n    );\n    // Begin loading initial properties\n    this.propertiesLoaded = this.loadInitialProperties();\n  }\n\n  /**\n   * Initialize services for settings, state, refresh, and control management\n   */\n  private initializeServices() {\n    // Initialize device API interface for services\n    const deviceApi = {\n      setProperty: async (propertyName: keyof DeviceProperties, value: any) => {\n        await this.api.setProperty(propertyName, value);\n      },\n      getProperties: () => this.api.getProperties(),\n      panAndTilt: async (options: any) => {\n        await this.api.panAndTilt(options);\n      },\n    };\n\n    // Initialize services\n    this.settingsService = new DeviceSettingsService(deviceApi, this.logger);\n    this.stateService = new DeviceStateService(this.logger);\n    this.refreshService = new RefreshService(deviceApi, this.logger);\n    this.videoClipsService = new VideoClipsService(this.wsClient, this.logger);\n    this.snapshotService = new SnapshotService(\n      this.serialNumber,\n      this.streamServer,\n      this.logger\n    );\n    this.streamService = new StreamService(\n      this.serialNumber,\n      this.streamServer,\n      this.logger,\n      this.latestProperties?.type\n    );\n    this.ptzControlService = new PtzControlService(\n      deviceApi,\n      () => this.latestProperties?.type,\n      this.logger\n    );\n    this.lightControlService = new LightControlService(deviceApi, this.logger);\n\n    // Subscribe to state changes from the state service\n    this.stateService.onStateChange((change: StateChangeEvent) => {\n      this.logger.debug(`State changed: ${change.interface} = ${change.value}`);\n\n      // Update device properties from state service (for Scrypted framework)\n      this.syncStateToProperties();\n\n      // Notify Scrypted of the change\n      this.onDeviceEvent(change.interface, change.value);\n    });\n\n    // Subscribe to refresh completion\n    this.refreshService.onRefreshComplete((properties) => {\n      this.logger.debug(\"Refresh completed successfully\");\n      this.latestProperties = properties;\n      this.streamService.setDeviceType(properties.type);\n      this.stateService.updateFromProperties(properties);\n      this.updatePtzCapabilities();\n    });\n\n    // Subscribe to refresh errors\n    this.refreshService.onRefreshError((error) => {\n      this.logger.warn(`Refresh failed: ${error.message}`);\n    });\n\n    // Subscribe to settings changes\n    this.settingsService.onSettingsChange(() => {\n      this.logger.debug(\"Settings changed, notifying Scrypted\");\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n    });\n  }\n\n  private async loadInitialProperties() {\n    try {\n      this.latestProperties = (await this.api.getProperties()).properties;\n      this.streamService.setDeviceType(this.latestProperties.type);\n      this.updateStateFromProperties(this.latestProperties);\n      this.updatePtzCapabilities(); // Update PTZ capabilities based on device type\n    } catch (e) {\n      this.logger.warn(`Failed to load initial properties: ${e}`);\n    }\n  }\n\n  /**\n   * Sync state from state service to device properties\n   * Required because ScryptedDeviceBase properties need to be updated\n   */\n  private syncStateToProperties() {\n    const state = this.stateService.getState();\n    if (state.motionDetected !== undefined)\n      this.motionDetected = state.motionDetected;\n    if (state.binaryState !== undefined) this.binaryState = state.binaryState;\n    if (state.brightness !== undefined) this.brightness = state.brightness;\n    if (state.on !== undefined) this.on = state.on;\n    if (state.batteryLevel !== undefined)\n      this.batteryLevel = state.batteryLevel;\n    if (state.chargeState !== undefined) this.chargeState = state.chargeState;\n    if (state.sensors) this.sensors = state.sensors as any;\n  }\n\n  /**\n   * Update device state from properties using DeviceStateService\n   * This delegates to the state service which manages state conversion and notifications\n   */\n  private updateStateFromProperties(properties?: DeviceProperties) {\n    if (!properties) return;\n\n    // Delegate to state service for conversion and notifications\n    this.stateService.updateFromProperties(properties);\n\n    // Sync state to device properties once\n    this.syncStateToProperties();\n  }\n  // =================== EVENTs ===================\n\n  private addEventListener<T extends DeviceEventType>(\n    eventType: T,\n    eventCallback: EventCallbackForType<T, DeviceEventSource>\n  ): () => boolean {\n    return this.wsClient.addEventListener(eventType, eventCallback, {\n      source: EVENT_SOURCES.DEVICE,\n      serialNumber: this.serialNumber,\n    });\n  }\n\n  /**\n   * Handle property changed events using DeviceStateService\n   * The state service handles state conversion and notifications\n   */\n  private handlePropertyChangedEvent({\n    name,\n    value,\n  }: DevicePropertyChangedEventPayload) {\n    // Update cached properties\n    this.latestProperties = this.latestProperties && {\n      ...this.latestProperties,\n      [name]: value,\n    };\n\n    // Delegate to state service for state updates and notifications\n    // The state service will call onDeviceEvent via our subscription\n    // State is now accessed via getters, no need to sync back\n    this.stateService.updateProperty(name, value);\n  }\n\n  /**\n   * Handle motion detected events\n   * Updates state via state service which handles notifications\n   */\n  private handleMotionDetectedEvent(event: DeviceMotionDetectedEventPayload) {\n    // Update state service - it will notify via onStateChange callback\n    this.stateService.updateProperty(\"motionDetected\", event.state);\n  }\n\n  /**\n   * Handle doorbell rings events\n   * Updates binary state via state service which handles notifications\n   */\n  private handleDoorbellRingsEvent(event: DeviceRingsEventPayload) {\n    // Update state service - it will notify via onStateChange callback\n    this.stateService.updateState(\"binaryState\", event.state);\n  }\n\n  // =================== SETTINGS INTERFACE ===================\n\n  /**\n   * Get device settings using DeviceSettingsService\n   * Delegates to the settings service for UI generation\n   */\n  async getSettings(): Promise<Setting[]> {\n    await this.propertiesLoaded;\n\n    // Delegate to settings service\n    return this.settingsService.getSettings(\n      this.info! as any,\n      this.latestProperties!,\n      this.name || \"Unknown Device\"\n    );\n  }\n\n  /**\n   * Update device settings using DeviceSettingsService\n   * Delegates to the settings service for property updates and custom settings\n   */\n  async putSetting(key: string, value: SettingValue): Promise<void> {\n    // Callback to handle successful property updates\n    const onSuccess = (settingKey: string, settingValue: SettingValue) => {\n      // Update local properties if it's a device property\n      if (settingKey in this.latestProperties!) {\n        const propertyName = settingKey as keyof DeviceProperties;\n        const metadata = this.info?.metadata?.[propertyName];\n        const adjustedValue = metadata\n          ? PropertyMapper.adjustValueForAPI(settingValue, metadata)\n          : settingValue;\n\n        this.latestProperties = this.latestProperties && {\n          ...this.latestProperties,\n          [propertyName]: adjustedValue,\n        };\n      }\n\n      // Handle custom settings locally\n      if (settingKey === \"scryptedName\") {\n        this.name = settingValue as string;\n      }\n    };\n\n    // Delegate to settings service\n    await this.settingsService.putSetting(\n      key,\n      value,\n      this.latestProperties!,\n      this.info?.metadata || {},\n      onSuccess\n    );\n\n    // Settings service will notify via onSettingsChange callback\n  }\n\n  // =================== PAN/TILT/ZOOM INTERFACE ===================\n\n  /**\n   * Update PTZ capabilities using PtzControlService\n   */\n  private updatePtzCapabilities() {\n    // Delegate to PTZ control service\n    (this as any).ptzCapabilities = this.ptzControlService.updateCapabilities();\n  }\n\n  /**\n   * Execute PTZ command using PtzControlService\n   * Delegates to the PTZ control service which handles command routing\n   */\n  async ptzCommand(command: PanTiltZoomCommand): Promise<void> {\n    return this.ptzControlService.executeCommand(command);\n  }\n\n  // =================== LIGHT INTERFACE ===================\n\n  /**\n   * Turn light on using LightControlService\n   * State will be updated via property change event\n   */\n  async turnOn(): Promise<void> {\n    return this.lightControlService.turnOn();\n  }\n\n  /**\n   * Turn light off using LightControlService\n   * State will be updated via property change event\n   */\n  async turnOff(): Promise<void> {\n    return this.lightControlService.turnOff();\n  }\n\n  /**\n   * Set brightness using LightControlService\n   * State will be updated via property change event\n   */\n  async setBrightness(brightness: number): Promise<void> {\n    return this.lightControlService.setBrightness(brightness);\n  }\n\n  // =================== VIDEO CAMERA INTERFACE ===================\n\n  /**\n   * Get video stream options using StreamService\n   * Delegates to the stream service which handles stream configuration\n   */\n  async getVideoStreamOptions(): Promise<ResponseMediaStreamOptions[]> {\n    await this.propertiesLoaded;\n    const quality = this.latestProperties?.videoStreamingQuality;\n    return this.streamService.getVideoStreamOptions(quality);\n  }\n\n  /**\n   * Get video stream using StreamService\n   * Delegates to the stream service which handles stream server lifecycle and FFmpeg configuration\n   */\n  async getVideoStream(\n    options?: RequestMediaStreamOptions\n  ): Promise<MediaObject> {\n    await this.propertiesLoaded;\n    const quality = this.latestProperties?.videoStreamingQuality;\n    return this.streamService.getVideoStream(quality, options);\n  }\n\n  // =================== CAMERA INTERFACE ===================\n\n  /**\n   * Get picture options using StreamService for dimensions\n   */\n  async getPictureOptions(): Promise<ResponsePictureOptions[]> {\n    await this.propertiesLoaded;\n\n    // Get video dimensions based on device properties\n    const quality = this.latestProperties?.videoStreamingQuality;\n    const { width, height } = this.streamService.getVideoDimensions(quality);\n\n    return [\n      {\n        id: \"snapshot\",\n        name: \"Snapshot\",\n        picture: {\n          width,\n          height,\n          // JPEG will be created by converting the H.264 keyframe\n        },\n      },\n    ];\n  }\n\n  /**\n   * Take a picture/snapshot using SnapshotService\n   * Delegates to the snapshot service which handles stream capture and JPEG conversion\n   */\n  async takePicture(options?: RequestPictureOptions): Promise<MediaObject> {\n    return this.snapshotService.takePicture(options);\n  }\n\n  // =================== REFRESH INTERFACE ===================\n\n  /**\n   * Get refresh frequency using RefreshService\n   */\n  async getRefreshFrequency(): Promise<number> {\n    return this.refreshService.getRefreshFrequency();\n  }\n\n  /**\n   * Refresh device properties using RefreshService\n   * Delegates to the refresh service which handles API calls and notifications\n   */\n  async refresh(\n    refreshInterface?: string,\n    userInitiated?: boolean\n  ): Promise<void> {\n    // Delegate to refresh service\n    // The service will call our subscribed callbacks on success/error\n    await this.refreshService.refresh(refreshInterface, userInitiated);\n  }\n\n  // =================== VIDEO CLIPS ===================\n\n  // =================== VIDEO CLIPS ===================\n\n  /**\n   * Get video clips using VideoClipsService\n   * Delegates to the video clips service which handles both P2P and cloud API retrieval\n   */\n  async getVideoClips(options?: VideoClipOptions): Promise<VideoClip[]> {\n    try {\n      // Ensure properties are loaded\n      await this.propertiesLoaded;\n\n      const stationSN = this.latestProperties?.stationSerialNumber;\n      if (!stationSN) {\n        this.logger.error(\"Station serial number not available\");\n        return [];\n      }\n\n      const startTime =\n        options?.startTime || Date.now() - 7 * 24 * 60 * 60 * 1000; // Default to last 7 days\n      const endTime = options?.endTime || Date.now();\n\n      // Delegate to video clips service\n      return await this.videoClipsService.getClips({\n        serialNumber: this.serialNumber,\n        stationSerialNumber: stationSN,\n        startTime,\n        endTime,\n      });\n    } catch (error) {\n      this.logger.error(`Error fetching video clips: ${error}`);\n      return [];\n    }\n  }\n\n  /**\n   * Get a video clip by ID using VideoClipsService\n   * Delegates to the service which handles P2P and cloud downloads\n   */\n  async getVideoClip(videoId: string): Promise<MediaObject> {\n    return this.videoClipsService.downloadClip(videoId, this.serialNumber);\n  }\n\n  /**\n   * Get a video clip thumbnail by ID using VideoClipsService\n   * Delegates to the service which handles cached and P2P thumbnails\n   */\n  async getVideoClipThumbnail(\n    thumbnailId: string,\n    _options?: VideoClipThumbnailOptions\n  ): Promise<MediaObject> {\n    return this.videoClipsService.downloadThumbnail(\n      thumbnailId,\n      this.serialNumber\n    );\n  }\n\n  /**\n   * Remove video clips (not supported by Eufy API)\n   */\n  async removeVideoClips(...videoClipIds: string[]): Promise<void> {\n    this.logger.warn(\n      `Video clip deletion not currently supported by Eufy API: ${videoClipIds.join(\", \")}`\n    );\n    throw new Error(\n      \"Video clip deletion is not supported by the Eufy Security API\"\n    );\n  }\n\n  // =================== UTILITY METHODS ===================\n\n  /**\n   * Creates a new stream server.\n   * Stream server lifecycle is now managed by StreamService.\n   */\n  private createStreamServer(): void {\n    this.streamServer = new StreamServer({\n      port: 0, // Let the system assign a free port\n      host: \"127.0.0.1\", // Only allow connections from localhost\n      logger: this.logger, // Pass tslog Logger directly\n      wsClient: this.wsClient,\n      serialNumber: this.serialNumber,\n    });\n\n    this.logger.debug(\n      \"Stream server created with WebSocket client integration\"\n    );\n  }\n\n  /**\n   * Clean up resources on disposal\n   */\n  dispose(): void {\n    // Dispose stream service (will stop stream server if running)\n    this.streamService\n      .dispose()\n      .catch((e: unknown) =>\n        this.logger.warn(`Error disposing stream service: ${e}`)\n      );\n\n    // Clean up all event listeners for this device\n    // This removes video data, and other device event listeners\n    const removedCount = this.wsClient.removeEventListenersBySerialNumber(\n      this.serialNumber,\n      EVENT_SOURCES.DEVICE\n    );\n\n    this.logger.debug(\n      `Removed ${removedCount} event listeners during disposal`\n    );\n  }\n}\n","/**\n * device-utils.ts\n *\n * Utility functions and helpers for Eufy device management, Scrypted device manifest creation, device type detection, and property mapping.\n * This file provides core logic for translating Eufy device data into Scrypted-compatible device manifests, settings, and metadata.\n * It also includes helpers for device validation, support checks, and minimal device object creation.\n */\n\nimport {\n  Device,\n  DeviceInformation,\n  ScryptedDeviceType,\n  ScryptedInterface,\n  SecuritySystemMode,\n  Setting,\n  SettingValue,\n} from \"@scrypted/sdk\";\nimport {\n  AlarmMode,\n  CommonEufyProperties,\n  DeviceProperties,\n  EufyWebSocketClient,\n  GuardMode,\n  PropertyMetadataAny,\n} from \"@caplaz/eufy-security-client\";\nimport {\n  MODEL_NAMES,\n  getDeviceCapabilities,\n  isDoorbell,\n} from \"@caplaz/eufy-security-client\";\nimport { getScryptedDeviceType } from \"./scrypted-device-detection\";\n\n// Maps Eufy alarm/guard modes to Scrypted security system modes\nexport const alarmModeMap: Record<AlarmMode, SecuritySystemMode> = {\n  [GuardMode.AWAY]: SecuritySystemMode.AwayArmed,\n  [GuardMode.HOME]: SecuritySystemMode.HomeArmed,\n  [GuardMode.DISARMED]: SecuritySystemMode.Disarmed,\n  [GuardMode.CUSTOM1]: SecuritySystemMode.NightArmed,\n  [GuardMode.CUSTOM2]: SecuritySystemMode.NightArmed,\n  [GuardMode.CUSTOM3]: SecuritySystemMode.NightArmed,\n};\n\n// Maps Scrypted security system modes to Eufy guard modes\nexport const securitySystemMap: Record<SecuritySystemMode, GuardMode> = {\n  [SecuritySystemMode.AwayArmed]: GuardMode.AWAY,\n  [SecuritySystemMode.HomeArmed]: GuardMode.HOME,\n  [SecuritySystemMode.NightArmed]: GuardMode.HOME,\n  [SecuritySystemMode.Disarmed]: GuardMode.DISARMED,\n};\n\n/**\n * DeviceUtils\n *\n * Static utility class for Eufy device and station manifest creation, settings mapping, device validation,\n * and support detection. Used throughout the plugin to standardize device handling and Scrypted integration.\n */\nexport class DeviceUtils {\n  /**\n   * Generates an array of device settings based on the provided device information and property metadata.\n   *\n   * This method extracts and formats the following settings:\n   * - Model: The hardware model identifier of the device.\n   * - Serial Number: The unique serial number assigned to the device.\n   * - Software Version: The current firmware or software version running on the device.\n   *\n   * @param device - The device information object containing model, serial number, and firmware details.\n   * @param metadata - A mapping of common Eufy property keys to their corresponding metadata definitions.\n   * @returns An array of `Setting` objects representing the device's model, serial number, and software version.\n   */\n  static genericDeviceInformation(\n    device: DeviceInformation,\n    metadata: Record<keyof CommonEufyProperties, PropertyMetadataAny>\n  ): Setting[] {\n    return [\n      DeviceUtils.settingFromMetadata(\n        metadata[\"model\"],\n        device.model,\n        \"The full product name and model of the device.\"\n      ),\n      DeviceUtils.settingFromMetadata(\n        metadata[\"serialNumber\"],\n        device.serialNumber,\n        \"The unique serial number assigned to the device.\"\n      ),\n      DeviceUtils.settingFromMetadata(\n        metadata[\"softwareVersion\"],\n        device.firmware,\n        \"The current software version running on the device.\"\n      ),\n    ];\n  }\n\n  static allWriteableDeviceProperties(\n    properties: DeviceProperties,\n    metadata: Record<string, PropertyMetadataAny>\n  ): Setting[] {\n    return Object.values(metadata)\n      .filter((meta) => meta.writeable)\n      .filter((meta) => !/test/i.test(meta.name))\n      .filter((meta) => meta.name !== \"light\")\n      .map((meta) =>\n        DeviceUtils.settingFromMetadata(\n          meta,\n          properties[meta.name as keyof DeviceProperties],\n          undefined,\n          // Default group for all settings\n          DeviceUtils.groupForPropertyName(meta.name)\n        )\n      );\n  }\n\n  static groupForPropertyName(name: string): string {\n    const n = name.toLowerCase();\n    if (n.includes(\"motion\") && !n.includes(\"light\")) return \"Motion\";\n\n    if (n.includes(\"light\")) return \"Light\";\n\n    if (n.includes(\"battery\") || n.includes(\"charge\") || n.includes(\"power\"))\n      return \"Power\";\n\n    if (n.includes(\"clip\") || n.includes(\"record\")) return \"Recording\";\n\n    if (n.includes(\"video\") || n.includes(\"stream\") || n.includes(\"vision\"))\n      return \"Video\";\n\n    if (\n      n.includes(\"microphone\") ||\n      n.includes(\"speaker\") ||\n      n.includes(\"notification\")\n    )\n      return \"Communication\";\n    return \"Configuration\";\n  }\n\n  static valueAdjustedWithMetadata(\n    value: SettingValue,\n    metadata: PropertyMetadataAny\n  ): any {\n    if (metadata.type === \"number\" && metadata.states) {\n      // For number types with states, find the index of the value in the states map\n      const stateValues = Object.values(metadata.states);\n      return stateValues.indexOf(value as string);\n    }\n    return value;\n  }\n\n  /**\n   * Converts Eufy property metadata into a Scrypted Setting object for UI/configuration.\n   * Handles type conversion and value/choice mapping for Scrypted settings.\n   */\n  static settingFromMetadata(\n    metadata: PropertyMetadataAny,\n    value?: SettingValue,\n    description?: string,\n    group?: string\n  ): Setting {\n    let setting: Setting = {\n      key: metadata.name,\n      title: metadata.label,\n      type: metadata.type,\n      value: value !== undefined ? value : metadata.default,\n      placeholder: metadata.default ? String(metadata.default) : undefined,\n      readonly: !metadata.writeable,\n      description,\n      group,\n    };\n\n    // If the property is a number with states, convert to a string choice list for Scrypted\n    if (metadata.type === \"number\" && metadata.states) {\n      if (metadata.writeable) {\n        // Convert the states map to an array of values, sorted by key\n        const choices = Object.entries(metadata.states)\n          .sort(([a], [b]) => {\n            const aNum = Number(a);\n            const bNum = Number(b);\n            if (!isNaN(aNum) && !isNaN(bNum)) {\n              return aNum - bNum;\n            }\n            return a.localeCompare(b);\n          })\n          .map(([, value]) => String(value));\n\n        setting = {\n          ...setting,\n          type: \"string\",\n          choices,\n          value: metadata.states[value as number],\n        };\n      } else {\n        setting = {\n          ...setting,\n          type: \"string\",\n          value: metadata.states[value as number],\n        };\n      }\n    } else if (\n      metadata.type === \"number\" &&\n      metadata.min !== undefined &&\n      metadata.max !== undefined\n    ) {\n      setting = {\n        ...setting,\n        range: [metadata.min, metadata.max],\n        placeholder: undefined,\n        description: `Value must be between ${metadata.min}${\n          metadata.unit || \"\"\n        } and ${metadata.max}${metadata.unit || \"\"}`,\n      };\n    }\n\n    return setting;\n  }\n\n  /**\n   * Creates a Scrypted device manifest for a Eufy station (base station/hub).\n   * Fetches properties and metadata from the Eufy WebSocket API and maps them to Scrypted fields.\n   * Includes security system state and device info for Scrypted registration.\n   */\n  static async createStationManifest(\n    wsClient: EufyWebSocketClient,\n    serialNumber: string\n  ): Promise<Device> {\n    const api = wsClient.commands.station(serialNumber);\n    const properties = (await api.getProperties()).properties;\n    const metadata = (await api.getPropertiesMetadata()).properties;\n\n    // Human-readable model name resolution\n    const humanModel = properties.model\n      ? MODEL_NAMES[properties.model] || properties.model\n      : metadata.type?.type === \"number\" && metadata.type.states\n        ? metadata.type.states[properties.type]\n        : \"Unknown Model\";\n\n    // Return Scrypted device manifest for the station\n    return {\n      nativeId: `station_${serialNumber}`,\n      type: ScryptedDeviceType.DeviceProvider,\n      interfaces: [\n        \"DeviceProvider\",\n        \"Settings\",\n        \"SecuritySystem\",\n        \"Refresh\",\n        \"Reboot\",\n      ],\n      name: properties.name || `Eufy ${properties.model}`,\n      info: {\n        model: humanModel,\n        manufacturer: \"Eufy\",\n        version: properties.hardwareVersion,\n        firmware: properties.softwareVersion,\n        serialNumber,\n        // ip: properties.lanIpAddress,\n        mac: properties.macAddress,\n        metadata,\n      },\n    };\n  }\n\n  /**\n   * Creates a Scrypted device manifest for a Eufy camera or device.\n   * Determines device type, supported interfaces, and info fields for Scrypted registration.\n   */\n  static async createDeviceManifest(\n    wsClient: EufyWebSocketClient,\n    serialNumber: string\n  ): Promise<Device> {\n    const api = wsClient.commands.device(serialNumber);\n    const properties = (await api.getProperties()).properties;\n    const metadata = (await api.getPropertiesMetadata()).properties;\n    // Validate required properties\n    const capabilities = getDeviceCapabilities(properties.type);\n    const deviceType = getScryptedDeviceType(properties.type);\n\n    // Base interfaces that all camera devices should have\n    const interfaces = [\n      ScryptedInterface.Camera,\n      ScryptedInterface.VideoCamera,\n      // ScryptedInterface.VideoClips,\n      ScryptedInterface.MotionSensor,\n      ScryptedInterface.Settings,\n      ScryptedInterface.Refresh,\n    ];\n\n    // Add Battery interface only for battery-powered devices\n    if (capabilities.battery) {\n      if (properties.battery !== undefined)\n        interfaces.push(ScryptedInterface.Battery);\n      if (properties.chargingStatus !== undefined)\n        interfaces.push(ScryptedInterface.Charger);\n    }\n\n    if (capabilities.floodlight) {\n      if (properties.light !== undefined)\n        interfaces.push(ScryptedInterface.OnOff);\n      if (properties.lightSettingsBrightnessManual !== undefined)\n        interfaces.push(ScryptedInterface.Brightness);\n    }\n\n    // Add Pan/Tilt/Zoom interface for PTZ capable devices\n    if (capabilities.panTilt) {\n      interfaces.push(ScryptedInterface.PanTiltZoom);\n    }\n\n    // Add BinarySensor interface for doorbell devices\n    if (isDoorbell(properties.type)) {\n      interfaces.push(ScryptedInterface.BinarySensor);\n    }\n\n    if (properties.wifiRssi !== undefined) {\n      interfaces.push(ScryptedInterface.Sensors);\n    }\n\n    // Human-readable model name resolution\n    const humanModel = properties.model\n      ? MODEL_NAMES[properties.model] || properties.model\n      : metadata.type?.type === \"number\" && metadata.type.states\n        ? metadata.type.states[properties.type]\n        : \"Unknown Model\";\n\n    // Return Scrypted device manifest for the camera/device\n    return {\n      nativeId: `device_${serialNumber}`,\n      name: properties.name || `Eufy ${properties.model}`,\n      type: deviceType,\n      interfaces,\n      info: {\n        manufacturer: \"Eufy\",\n        model: humanModel,\n        serialNumber: properties.serialNumber,\n        firmware: properties.softwareVersion,\n        metadata,\n      },\n      // link to the base station for this device\n      providerNativeId: properties.stationSerialNumber\n        ? `station_${properties.stationSerialNumber}`\n        : undefined,\n    };\n  }\n\n  /**\n   * Converts H.264 video data to JPEG image using FFmpeg.\n   * This is a synchronous operation that pipes H.264 data to FFmpeg and captures the JPEG output.\n   *\n   * @param h264Data - Buffer containing H.264 encoded video data (typically a keyframe)\n   * @param quality - JPEG quality setting (1-31, lower is better quality, default: 2)\n   * @returns Promise resolving to Buffer containing JPEG image data\n   * @throws Error if FFmpeg fails or returns invalid output\n   */\n  static async convertH264ToJPEG(\n    h264Data: Buffer,\n    quality: number = 2\n  ): Promise<Buffer> {\n    const child_process = await import(\"child_process\");\n\n    return new Promise<Buffer>((resolve, reject) => {\n      // Use FFmpeg to decode H.264 and encode as JPEG\n      const ffmpeg = child_process.spawn(\"ffmpeg\", [\n        \"-f\",\n        \"h264\", // Input format\n        \"-i\",\n        \"pipe:0\", // Read from stdin\n        \"-frames:v\",\n        \"1\", // Extract only the first frame\n        \"-f\",\n        \"image2\", // Output format\n        \"-c:v\",\n        \"mjpeg\", // JPEG codec\n        \"-q:v\",\n        quality.toString(), // Quality setting (1-31, lower is better)\n        \"pipe:1\", // Write to stdout\n      ]);\n\n      const chunks: Buffer[] = [];\n      const errorChunks: Buffer[] = [];\n\n      ffmpeg.stdout.on(\"data\", (chunk) => {\n        chunks.push(chunk);\n      });\n\n      ffmpeg.stderr.on(\"data\", (chunk) => {\n        errorChunks.push(chunk);\n      });\n\n      ffmpeg.on(\"close\", (code) => {\n        if (code === 0 && chunks.length > 0) {\n          const jpegBuffer = Buffer.concat(chunks);\n          resolve(jpegBuffer);\n        } else {\n          const errorOutput = Buffer.concat(errorChunks).toString();\n          const errorMessage = `FFmpeg conversion failed with code ${code}: ${\n            errorOutput || \"Unknown error\"\n          }`;\n\n          // Provide more specific error messages based on common FFmpeg errors\n          if (\n            errorOutput.includes(\"Invalid data found when processing input\")\n          ) {\n            reject(new Error(`Invalid H.264 data provided: ${errorOutput}`));\n          } else if (errorOutput.includes(\"No such file or directory\")) {\n            reject(\n              new Error(\n                \"FFmpeg executable not found. Please ensure FFmpeg is installed.\"\n              )\n            );\n          } else if (errorOutput.includes(\"Permission denied\")) {\n            reject(new Error(\"Permission denied accessing FFmpeg executable.\"));\n          } else {\n            reject(new Error(errorMessage));\n          }\n        }\n      });\n\n      ffmpeg.on(\"error\", (error) => {\n        const errnoError = error as NodeJS.ErrnoException;\n        if (errnoError.code === \"ENOENT\") {\n          reject(\n            new Error(\n              \"FFmpeg executable not found. Please ensure FFmpeg is installed and available in PATH.\"\n            )\n          );\n        } else {\n          reject(new Error(`Failed to spawn FFmpeg: ${error.message}`));\n        }\n      });\n\n      // Write H.264 data to FFmpeg stdin\n      ffmpeg.stdin.write(h264Data);\n      ffmpeg.stdin.end();\n    });\n  }\n}\n","/**\n * Scrypted-specific device detection utilities\n *\n * This module contains device detection functions that are specific to the Scrypted\n * integration and cannot be moved to the client package.\n */\n\nimport { ScryptedDeviceType } from \"@scrypted/sdk\";\nimport {\n  isCamera,\n  isDoorbell,\n  isSensor,\n  isLock,\n} from \"@caplaz/eufy-security-client\";\n\n/**\n * Maps a Eufy device type to the appropriate Scrypted device type.\n *\n * This function determines which Scrypted device type should be used\n * for a given Eufy device, enabling proper interface assignment and\n * device categorization within the Scrypted ecosystem.\n *\n * @param deviceType - The Eufy device type identifier\n * @returns The corresponding Scrypted device type\n */\nexport function getScryptedDeviceType(deviceType: number): ScryptedDeviceType {\n  if (isDoorbell(deviceType)) return ScryptedDeviceType.Doorbell;\n  else if (isCamera(deviceType)) return ScryptedDeviceType.Camera;\n  else if (isSensor(deviceType)) return ScryptedDeviceType.Sensor;\n  else if (isLock(deviceType)) return ScryptedDeviceType.Lock;\n  else return ScryptedDeviceType.Unknown;\n}\n","/**\n * Barebone Eufy Station Device for Scrypted\n *\n * Implements Scrypted DeviceProvider, Settings, SecuritySystem, Reboot, and Refresh interfaces.\n * Manages child device registration, station alarm/guard mode, and station configuration.\n */\n\nimport {\n  DeviceProvider,\n  Reboot,\n  Refresh,\n  ScryptedDeviceBase,\n  ScryptedInterface,\n  ScryptedNativeId,\n  SecuritySystem,\n  SecuritySystemMode,\n  Setting,\n  Settings,\n  SettingValue,\n} from \"@scrypted/sdk\";\n\nimport {\n  AlarmMode,\n  EufyWebSocketClient,\n  EVENT_SOURCES,\n  EventCallbackForType,\n  STATION_EVENTS,\n  StationEventSource,\n  StationEventType,\n  StationProperties,\n  StationPropertyChangedEventPayload,\n} from \"@caplaz/eufy-security-client\";\n\nimport { Logger, ILogObj } from \"tslog\";\nimport { EufyDevice } from \"./eufy-device\";\nimport {\n  alarmModeMap,\n  DeviceUtils,\n  securitySystemMap,\n} from \"./utils/device-utils\";\n\n// Helper to create a transport function for routing tslog to Scrypted console\nfunction createConsoleTransport(console: Console) {\n  return (logObj: any) => {\n    const meta = logObj._meta;\n    if (!meta) return;\n    const prefix = meta.name ? `[${meta.name}] ` : \"\";\n\n    // Extract all non-meta properties as the log arguments\n    const args = Object.keys(logObj)\n      .filter((key) => key !== \"_meta\" && key !== \"toJSON\")\n      .map((key) => logObj[key]);\n\n    const msg = args\n      .map((a: any) => (typeof a === \"object\" ? JSON.stringify(a) : String(a)))\n      .join(\" \");\n\n    const level = meta.logLevelName?.toLowerCase();\n    if (level === \"warn\") console.warn(`${prefix}${msg}`);\n    else if (level === \"error\" || level === \"fatal\")\n      console.error(`${prefix}${msg}`);\n    else console.log(`${prefix}${msg}`);\n  };\n}\n\n/**\n * EufyStation - Barebone station implementation\n */\nexport class EufyStation\n  extends ScryptedDeviceBase\n  implements DeviceProvider, Settings, SecuritySystem, Reboot, Refresh\n{\n  private wsClient: EufyWebSocketClient;\n  private childDevices = new Map<string, EufyDevice>();\n  private logger: Logger<ILogObj>;\n\n  // Device info and state\n  private latestProperties?: StationProperties;\n  private propertiesLoaded: Promise<void>;\n\n  /**\n   * Get the serial number for this station.\n   * @returns {string} Serial number from device info, or 'unknown' if not set.\n   */\n  get serialNumber(): string {\n    return this.info?.serialNumber || \"unknown\";\n  }\n\n  /**\n   * Get the API command interface for this station.\n   * @returns {any} API command object for this station's serial number.\n   */\n  get api() {\n    return this.wsClient.commands.station(this.serialNumber);\n  }\n\n  /**\n   * Construct a new EufyStation.\n   * @param nativeId - Scrypted nativeId for this station.\n   * @param wsClient - EufyWebSocketClient instance for API access.\n   * @param parentLogger - Parent logger for hierarchical logging (from provider).\n   */\n  constructor(\n    nativeId: string,\n    wsClient: EufyWebSocketClient,\n    parentLogger: Logger<ILogObj>\n  ) {\n    super(nativeId);\n    this.wsClient = wsClient;\n\n    // Create a sub-logger with this station's console\n    // This ensures station logs appear in the station's log window\n    // Use attachedTransports: [] to prevent inheriting parent's transport\n    const loggerName = nativeId.charAt(0).toUpperCase() + nativeId.slice(1);\n    this.logger = parentLogger.getSubLogger({\n      name: loggerName,\n      attachedTransports: [],\n    });\n    this.logger.attachTransport(createConsoleTransport(this.console));\n\n    this.logger.info(`Created EufyStation for ${nativeId}`);\n\n    this.addEventListener(\n      STATION_EVENTS.PROPERTY_CHANGED,\n      ((event: StationPropertyChangedEventPayload) => {\n        this.handlePropertyChangedEvent(event);\n      }).bind(this)\n    );\n\n    this.addEventListener(STATION_EVENTS.GUARD_MODE_CHANGED, (_event) => {\n      // this.handlePropertyChangedEvent(event);\n    });\n\n    this.addEventListener(STATION_EVENTS.CURRENT_MODE_CHANGED, (_event) => {\n      this.handlePropertyChangedEvent.bind(this);\n    });\n\n    // Begin loading initial properties\n    this.propertiesLoaded = this.loadInitialProperties();\n  }\n\n  private async loadInitialProperties() {\n    try {\n      this.latestProperties = (await this.api.getProperties()).properties;\n      this.updateStateFromProperties(this.latestProperties);\n    } catch (e) {\n      this.logger.warn(`Failed to load initial properties: ${e}`);\n    }\n  }\n\n  // =================== PROPERTY MANAGEMENT ===================\n\n  private updateStateFromProperties(properties?: StationProperties) {\n    if (!properties) return;\n  }\n\n  // =================== EVENTs ===================\n\n  private addEventListener<T extends StationEventType>(\n    eventType: T,\n    eventCallback: EventCallbackForType<T, StationEventSource>\n  ): () => boolean {\n    return this.wsClient.addEventListener(eventType, eventCallback, {\n      source: EVENT_SOURCES.STATION,\n      serialNumber: this.serialNumber,\n    });\n  }\n\n  private handlePropertyChangedEvent({\n    name,\n    value,\n  }: StationPropertyChangedEventPayload) {\n    this.latestProperties = this.latestProperties && {\n      ...this.latestProperties,\n      [name]: value,\n    };\n\n    switch (name) {\n      case \"alarm\":\n      case \"currentMode\":\n        this.onDeviceEvent(\n          ScryptedInterface.SecuritySystem,\n          this.securitySystemState\n        );\n        break;\n      case \"guardMode\":\n        this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n        break;\n      default:\n        this.logger.info(`Property changed: ${name} = ${value}`);\n    }\n  }\n\n  // =================== DEVICE PROVIDER INTERFACE ===================\n\n  /**\n   * Get or create a child device by nativeId.\n   * @param nativeId - Scrypted nativeId for the child device.\n   * @returns {Promise<EufyDevice>} The child device instance.\n   */\n  async getDevice(nativeId: ScryptedNativeId): Promise<any> {\n    if (nativeId && nativeId.startsWith(\"device_\")) {\n      this.logger.debug(`Getting device ${nativeId}`);\n\n      // Return existing device or create new EufyDevice\n      let device = this.childDevices.get(nativeId);\n      if (!device) {\n        device = new EufyDevice(nativeId, this.wsClient, this.logger);\n        this.childDevices.set(nativeId, device);\n        this.logger.info(`Created new device ${nativeId}`);\n      }\n      return device;\n    }\n    return undefined;\n  }\n\n  /**\n   * Release a child device by nativeId.\n   * @param id - Device id (unused).\n   * @param nativeId - Scrypted nativeId for the child device.\n   * @returns {Promise<void>}\n   */\n  async releaseDevice(id: string, nativeId: ScryptedNativeId): Promise<void> {\n    const deviceId = nativeId || \"\";\n    this.logger.debug(`Releasing device ${deviceId}`);\n    this.childDevices.delete(deviceId);\n  }\n\n  // =================== SETTINGS INTERFACE ===================\n\n  /**\n   * Get the settings for this station.\n   * @returns {Promise<Setting[]>} Array of Scrypted Setting objects.\n   */\n  /**\n   * Retrieves the settings for the Eufy station, including the station name,\n   * generic device information, and security system-specific settings such as\n   * current mode and guard mode. The settings are returned as an array of\n   * `Setting` objects, which can be used for configuration in Scrypted.\n   *\n   * @returns A promise that resolves to an array of `Setting` objects representing\n   * the configurable properties and metadata of the Eufy station.\n   */\n  async getSettings(): Promise<Setting[]> {\n    await this.propertiesLoaded;\n\n    const { info } = this;\n    const { metadata } = info || {};\n\n    const securitySystemGroup = \"Security System\";\n\n    return [\n      {\n        key: \"scryptedName\",\n        title: \"Station Name\",\n        description: \"Name shown in Scrypted (can be customized)\",\n        value: this.name,\n        type: \"string\",\n        readonly: false,\n      },\n\n      // generic info about this device\n      ...DeviceUtils.genericDeviceInformation(info!, metadata),\n\n      // Security system settings\n      DeviceUtils.settingFromMetadata(\n        metadata[\"currentMode\"],\n        this.latestProperties?.currentMode,\n        \"Indicates the current operating mode of the security system (e.g., Home, Away, Disarmed). This field is read-only and reflects the system's present state.\",\n        securitySystemGroup\n      ),\n      DeviceUtils.settingFromMetadata(\n        metadata[\"guardMode\"],\n        this.latestProperties?.guardMode,\n        \"Guard mode determines how the security system responds to events. For example: 'Home' arms only outdoor sensors, 'Away' arms all sensors, and 'Disarmed' disables alarms. Other modes include 'Geofencing' (automatically arms/disarms based on your phone's location) and 'Schedule' (arms/disarms according to a set timetable). Select the mode that matches your current needs.\",\n        securitySystemGroup\n      ),\n    ];\n  }\n\n  /**\n   * Update a setting for this station.\n   * @param key - Setting key to update.\n   * @param value - New value for the setting.\n   * @returns {Promise<void>}\n   */\n  async putSetting(key: string, value: SettingValue): Promise<void> {\n    this.logger.debug(`Setting ${key} = ${value}`);\n\n    switch (key) {\n      case \"scryptedName\":\n        this.name = String(value);\n        break;\n      case \"guardMode\":\n        this.api\n          .setProperty(\n            \"guardMode\",\n            DeviceUtils.valueAdjustedWithMetadata(\n              value,\n              this.info?.metadata[\"guardMode\"]\n            )\n          )\n          .catch((error) => {\n            this.logger.warn(`Failed to set guardMode: ${error}`);\n          });\n        break;\n      default:\n        this.logger.warn(`Unknown setting: ${key}`);\n    }\n  }\n\n  // =================== SECURITY SYSTEM INTERFACE ===================\n\n  securitySystemState? = {\n    mode: alarmModeMap[\n      this.latestProperties?.currentMode ?? AlarmMode.DISARMED\n    ],\n    triggered: this.latestProperties?.alarm,\n    supportedModes: [\n      SecuritySystemMode.HomeArmed,\n      SecuritySystemMode.AwayArmed,\n      SecuritySystemMode.Disarmed,\n    ],\n  };\n\n  /**\n   * Arm the security system to a specific mode.\n   * @param mode - SecuritySystemMode to arm to.\n   * @returns {Promise<void>}\n   */\n  async armSecuritySystem(mode: SecuritySystemMode): Promise<void> {\n    if (mode === SecuritySystemMode.Disarmed) {\n      this.logger.debug(`Disarming`);\n    } else {\n      this.logger.debug(`Arming to mode ${mode}`);\n    }\n\n    if (this.securitySystemState) {\n      this.securitySystemState.mode = mode;\n    }\n\n    this.api.setProperty(\"guardMode\", securitySystemMap[mode]);\n  }\n\n  /**\n   * Disarm the security system.\n   * @returns {Promise<void>}\n   */\n  async disarmSecuritySystem(): Promise<void> {\n    return this.armSecuritySystem(SecuritySystemMode.Disarmed);\n  }\n\n  // =================== REFRESH ===================\n\n  /**\n   * Get the refresh frequency for this station.\n   * @returns {Promise<number>} Refresh interval in ms.\n   */\n  async getRefreshFrequency(): Promise<number> {\n    return 1800; // 30 minutes\n  }\n\n  async refresh(\n    refreshInterface?: string,\n    userInitiated?: boolean\n  ): Promise<void> {\n    // since I don't have a way to get a single property, we just refresh everything\n    if (!refreshInterface) {\n      try {\n        this.latestProperties = (await this.api.getProperties()).properties;\n        this.updateStateFromProperties(this.latestProperties);\n      } catch (error) {\n        this.logger.warn(\n          `Failed to get station properties: ${error}, user initiated: ${userInitiated}`\n        );\n      }\n    }\n  }\n\n  // =================== REBOOT INTERFACE ===================\n\n  /**\n   * Reboot the station.\n   * @returns {Promise<void>}\n   */\n  async reboot(): Promise<void> {\n    this.logger.info(\"Rebooting\");\n    await this.api.reboot();\n  }\n\n  // =================== UTILITY METHODS ===================\n\n  /**\n   * Dispose of all child devices and clean up resources.\n   */\n  dispose(): void {\n    this.childDevices.forEach((device) => {\n      device.dispose();\n    });\n    this.childDevices.clear();\n    this.logger.debug(`Disposed`);\n  }\n}\n","/**\n * MemoryManager: Centralized memory monitoring and cleanup system\n *\n * This module provides:\n * - System-wide memory monitoring with configurable thresholds\n * - Progressive cleanup strategies (gentle -> aggressive -> emergency)\n * - Callback-based cleanup system allowing components to register their own cleanup logic\n * - Shared singleton instance to prevent multiple monitoring intervals\n * - Detailed memory usage tracking and logging\n *\n * Architecture:\n * 1. Components register cleanup callbacks with unique IDs\n * 2. MemoryManager monitors system memory at regular intervals\n * 3. When thresholds are exceeded, registered callbacks are invoked with cleanup levels\n * 4. Components handle their own cleanup logic based on the requested level\n */\n\nimport { Logger, ILogObj } from \"tslog\";\n\n/**\n * Memory cleanup severity levels for progressive cleanup strategies\n */\nexport enum CleanupLevel {\n  /** Gentle cleanup - trim buffers moderately */\n  GENTLE = \"gentle\",\n  /** Aggressive cleanup - keep only essential data */\n  AGGRESSIVE = \"aggressive\",\n  /** Emergency cleanup - minimal data retention */\n  EMERGENCY = \"emergency\",\n}\n\n/**\n * Memory usage information provided to cleanup callbacks\n */\nexport interface MemoryInfo {\n  /** Current RSS memory usage in MB */\n  rssMB: number;\n  /** Current heap usage in MB */\n  heapMB: number;\n  /** The cleanup level being requested */\n  level: CleanupLevel;\n  /** The threshold that triggered this cleanup */\n  threshold: number;\n}\n\n/**\n * Callback function signature for memory cleanup operations\n */\nexport type MemoryCleanupCallback = (info: MemoryInfo) => void;\n\n/**\n * Configuration for memory monitoring thresholds and behavior\n */\nexport interface MemoryManagerConfig {\n  /** Base memory threshold in MB (default: 120) */\n  baseThresholdMB: number;\n  /** Monitoring interval in milliseconds (default: 10000) */\n  monitorIntervalMs: number;\n  /** Enable detailed memory logging (default: false) */\n  enableDetailedLogging: boolean;\n  /** Minimum time between cleanup attempts in milliseconds (default: 30000) */\n  cleanupCooldownMs: number;\n}\n\n/**\n * Information about a registered cleanup callback\n */\ninterface CleanupRegistration {\n  id: string;\n  callback: MemoryCleanupCallback;\n  description?: string;\n}\n\n/**\n * Centralized memory management system with progressive cleanup strategies.\n *\n * This singleton class monitors system memory usage and coordinates cleanup\n * across multiple components through a callback-based system.\n */\nexport class MemoryManager {\n  private static instance?: MemoryManager;\n\n  private readonly logger: Logger<ILogObj>;\n  private readonly config: MemoryManagerConfig;\n  private readonly cleanupCallbacks = new Map<string, CleanupRegistration>();\n  private monitorInterval?: ReturnType<typeof setTimeout>;\n  private isMonitoring = false;\n  private lastCleanupTime = 0;\n  private lastCleanupLevel?: CleanupLevel;\n\n  private constructor(\n    logger: Logger<ILogObj>,\n    config: Partial<MemoryManagerConfig> = {}\n  ) {\n    this.logger = logger;\n    this.config = {\n      baseThresholdMB: 120,\n      monitorIntervalMs: 10000,\n      enableDetailedLogging: false,\n      cleanupCooldownMs: 30000,\n      ...config,\n    };\n  }\n\n  /**\n   * Gets the singleton MemoryManager instance, creating it if necessary.\n   *\n   * @param logger Logger instance for memory manager operations\n   * @param config Optional configuration overrides\n   * @returns The singleton MemoryManager instance\n   */\n  static getInstance(\n    logger: Logger<ILogObj>,\n    config?: Partial<MemoryManagerConfig>\n  ): MemoryManager {\n    if (!MemoryManager.instance) {\n      MemoryManager.instance = new MemoryManager(logger, config);\n    }\n    return MemoryManager.instance;\n  }\n\n  /**\n   * Gets the current memory threshold from the singleton instance.\n   * Safe to call even if instance doesn't exist yet.\n   *\n   * @returns Current memory threshold in MB\n   */\n  static getMemoryThreshold(): number {\n    return MemoryManager.instance?.config.baseThresholdMB ?? 120;\n  }\n\n  /**\n   * Updates the memory threshold in the singleton instance.\n   * Creates instance with default config if it doesn't exist.\n   *\n   * @param thresholdMB New threshold in MB\n   * @param logger Optional logger for creating instance if needed\n   */\n  static setMemoryThreshold(\n    thresholdMB: number,\n    logger?: Logger<ILogObj>\n  ): void {\n    if (MemoryManager.instance) {\n      MemoryManager.instance.updateThreshold(thresholdMB);\n    } else if (logger) {\n      // Create instance with the new threshold\n      MemoryManager.instance = new MemoryManager(logger, {\n        baseThresholdMB: thresholdMB,\n      });\n    }\n    // If no instance and no logger, the threshold will be applied when instance is created\n  }\n\n  /**\n   * Registers a cleanup callback with the memory manager.\n   *\n   * @param id Unique identifier for this callback\n   * @param callback Function to call when cleanup is needed\n   * @param description Optional description for logging\n   */\n  registerCleanupCallback(\n    id: string,\n    callback: MemoryCleanupCallback,\n    description?: string\n  ): void {\n    this.cleanupCallbacks.set(id, { id, callback, description });\n    this.logger.debug(\n      ` Registered memory cleanup callback: ${id}${description ? ` (${description})` : \"\"}`\n    );\n\n    // Start monitoring when first callback is registered\n    if (this.cleanupCallbacks.size === 1) {\n      this.startMonitoring();\n    }\n  }\n\n  /**\n   * Unregisters a cleanup callback.\n   *\n   * @param id The ID of the callback to remove\n   */\n  unregisterCleanupCallback(id: string): void {\n    const removed = this.cleanupCallbacks.delete(id);\n    if (removed) {\n      this.logger.debug(` Unregistered memory cleanup callback: ${id}`);\n    }\n\n    // Stop monitoring when no callbacks remain\n    if (this.cleanupCallbacks.size === 0) {\n      this.stopMonitoring();\n    }\n  }\n\n  /**\n   * Manually trigger immediate memory pressure check and cleanup if needed.\n   * Useful for components that want to check memory pressure during intensive operations.\n   *\n   * @returns True if cleanup was triggered, false otherwise\n   */\n  checkMemoryPressure(): boolean {\n    const usage = process.memoryUsage();\n    const rssMB = Math.round(usage.rss / 1024 / 1024);\n    const heapMB = Math.round(usage.heapUsed / 1024 / 1024);\n\n    // Calculate dynamic thresholds based on configured base\n    const gentleThreshold = Math.max(50, this.config.baseThresholdMB * 0.75);\n    const aggressiveThreshold = this.config.baseThresholdMB;\n    const emergencyThreshold = this.config.baseThresholdMB * 1.25;\n\n    // Determine cleanup level needed\n    let cleanupLevel: CleanupLevel | null = null;\n    let threshold = 0;\n\n    if (rssMB > emergencyThreshold) {\n      cleanupLevel = CleanupLevel.EMERGENCY;\n      threshold = emergencyThreshold;\n    } else if (rssMB > aggressiveThreshold) {\n      cleanupLevel = CleanupLevel.AGGRESSIVE;\n      threshold = aggressiveThreshold;\n    } else if (rssMB > gentleThreshold) {\n      cleanupLevel = CleanupLevel.GENTLE;\n      threshold = gentleThreshold;\n    }\n\n    if (cleanupLevel) {\n      // Check cooldown: prevent too frequent cleanups of the same level\n      const now = Date.now();\n      const timeSinceLastCleanup = now - this.lastCleanupTime;\n\n      // Allow emergency cleanups immediately, but enforce cooldown for gentle/aggressive\n      const needsCooldown =\n        cleanupLevel !== CleanupLevel.EMERGENCY &&\n        this.lastCleanupLevel === cleanupLevel &&\n        timeSinceLastCleanup < this.config.cleanupCooldownMs;\n\n      if (needsCooldown) {\n        this.logger.debug(\n          ` Cleanup cooldown active: ${Math.round(\n            timeSinceLastCleanup / 1000\n          )}s / ${Math.round(this.config.cleanupCooldownMs / 1000)}s`\n        );\n        return false;\n      }\n\n      // Escalation logic: if we just did a gentle cleanup but memory is still high,\n      // escalate to aggressive cleanup sooner\n      if (\n        cleanupLevel === CleanupLevel.GENTLE &&\n        this.lastCleanupLevel === CleanupLevel.GENTLE &&\n        timeSinceLastCleanup < this.config.cleanupCooldownMs * 2 &&\n        timeSinceLastCleanup > this.config.cleanupCooldownMs * 0.5\n      ) {\n        this.logger.warn(\n          ` Escalating to aggressive cleanup - gentle cleanup wasn't sufficient`\n        );\n        cleanupLevel = CleanupLevel.AGGRESSIVE;\n        threshold = aggressiveThreshold;\n      }\n\n      this.triggerCleanup({\n        rssMB,\n        heapMB,\n        level: cleanupLevel,\n        threshold,\n      });\n      return true;\n    }\n\n    return false;\n  }\n\n  /**\n   * Updates the base memory threshold for all cleanup levels.\n   *\n   * @param thresholdMB New base threshold in MB\n   */\n  updateThreshold(thresholdMB: number): void {\n    this.config.baseThresholdMB = Math.max(50, thresholdMB);\n    this.logger.debug(\n      ` Updated memory threshold to ${this.config.baseThresholdMB}MB`\n    );\n  }\n\n  /**\n   * Gets current memory usage information.\n   *\n   * @returns Object containing current memory statistics\n   */\n  getCurrentMemoryUsage(): {\n    rssMB: number;\n    heapMB: number;\n    thresholds: { gentle: number; aggressive: number; emergency: number };\n  } {\n    const usage = process.memoryUsage();\n    return {\n      rssMB: Math.round(usage.rss / 1024 / 1024),\n      heapMB: Math.round(usage.heapUsed / 1024 / 1024),\n      thresholds: {\n        gentle: Math.max(50, this.config.baseThresholdMB * 0.75),\n        aggressive: this.config.baseThresholdMB,\n        emergency: this.config.baseThresholdMB * 1.25,\n      },\n    };\n  }\n\n  /**\n   * Starts the memory monitoring interval.\n   */\n  private startMonitoring(): void {\n    if (this.isMonitoring) {\n      return;\n    }\n\n    this.isMonitoring = true;\n    this.logger.debug(\n      ` Starting memory monitoring (threshold: ${this.config.baseThresholdMB}MB, interval: ${this.config.monitorIntervalMs}ms)`\n    );\n\n    this.monitorInterval = setInterval(() => {\n      this.performMemoryCheck();\n    }, this.config.monitorIntervalMs);\n  }\n\n  /**\n   * Stops the memory monitoring interval.\n   */\n  private stopMonitoring(): void {\n    if (this.monitorInterval) {\n      clearInterval(this.monitorInterval);\n      this.monitorInterval = undefined;\n    }\n\n    this.isMonitoring = false;\n    this.logger.debug(\" Stopped memory monitoring\");\n  }\n\n  /**\n   * Performs a periodic memory check and triggers cleanup if needed.\n   *\n   * Performance Optimizations:\n   * - Uses efficient process.memoryUsage() for minimal overhead\n   * - Conditional logging to avoid string concatenation when disabled\n   * - Single memory pressure check per interval to minimize CPU usage\n   * - Optimized memory calculations using bitwise operations where applicable\n   */\n  private performMemoryCheck(): void {\n    const usage = process.memoryUsage();\n    const rssMB = Math.round(usage.rss / 1024 / 1024);\n    const heapMB = Math.round(usage.heapUsed / 1024 / 1024);\n\n    // Log detailed memory info if enabled (performance: conditional string building)\n    if (this.config.enableDetailedLogging) {\n      this.logger.debug(\n        ` Memory check: ${rssMB}MB RSS, ${heapMB}MB heap, ` +\n          `${this.cleanupCallbacks.size} registered callbacks`\n      );\n    }\n\n    // Check if cleanup is needed (single call for efficiency)\n    this.checkMemoryPressure();\n  }\n\n  /**\n   * Triggers cleanup callbacks at the specified level.\n   *\n   * @param memoryInfo Information about current memory state and cleanup level\n   */\n  private triggerCleanup(memoryInfo: MemoryInfo): void {\n    const { level, rssMB, threshold } = memoryInfo;\n\n    // Update cleanup tracking\n    this.lastCleanupTime = Date.now();\n    this.lastCleanupLevel = level;\n\n    // Log cleanup trigger\n    const levelIcon = {\n      [CleanupLevel.GENTLE]: \"\",\n      [CleanupLevel.AGGRESSIVE]: \"\",\n      [CleanupLevel.EMERGENCY]: \"\",\n    }[level];\n\n    this.logger.warn(\n      `${levelIcon} ${level.toUpperCase()} memory cleanup triggered: ${rssMB}MB > ${threshold}MB`\n    );\n\n    // Call all registered cleanup callbacks\n    let callbacksExecuted = 0;\n    for (const registration of this.cleanupCallbacks.values()) {\n      try {\n        registration.callback(memoryInfo);\n        callbacksExecuted++;\n      } catch (error) {\n        this.logger.error(\n          ` Error in cleanup callback ${registration.id}: ${error}`\n        );\n      }\n    }\n\n    this.logger.debug(` Executed ${callbacksExecuted} cleanup callbacks`);\n\n    // Force garbage collection if available\n    if (global.gc) {\n      global.gc();\n      this.logger.debug(\" Forced garbage collection\");\n    }\n  }\n\n  /**\n   * Disposes of the memory manager, stopping monitoring and clearing callbacks.\n   * Used for testing or shutdown scenarios.\n   */\n  dispose(): void {\n    this.stopMonitoring();\n    this.cleanupCallbacks.clear();\n    MemoryManager.instance = undefined;\n    this.logger.debug(\" MemoryManager disposed\");\n  }\n}\n\n/**\n * Convenience function to get the singleton MemoryManager instance.\n *\n * @param logger Logger instance\n * @param config Optional configuration\n * @returns The MemoryManager singleton\n */\nexport function getMemoryManager(\n  logger: Logger<ILogObj>,\n  config?: Partial<MemoryManagerConfig>\n): MemoryManager {\n  return MemoryManager.getInstance(logger, config);\n}\n","/**\n * Eufy Security Provider for Scrypted\n *\n * Main entry point for the Eufy Security Scrypted plugin. This class serves as the\n * central coordinator for all Eufy device interactions within the Scrypted ecosystem.\n *\n * Core Responsibilities:\n * - WebSocket connection management to eufy-security-ws server\n * - Device discovery and automatic registration with Scrypted\n * - Station hierarchy maintenance\n * - Authentication handling (captcha, 2FA) with user-friendly UI\n * - Memory management coordination across all devices\n * - Settings management with real-time status monitoring\n * - Driver connection lifecycle management\n *\n * Architecture:\n * - Implements Scrypted's DeviceProvider interface for device management\n * - Implements Settings interface for configuration UI\n * - Implements Refresh interface for connection health monitoring\n * - Uses singleton MemoryManager for system-wide resource coordination\n * - Provides centralized logging and debug control\n *\n * The provider automatically handles the complex authentication flow required\n * by Eufy's cloud services, including captcha challenges and 2FA verification,\n * presenting a user-friendly interface through Scrypted's settings system.\n *\n * @implements {DeviceProvider}\n * @implements {Readme}\n * @implements {Settings}\n * @implements {Refresh}\n * @public\n * @since 1.0.0\n */\n\nimport sdk, {\n  DeviceProvider,\n  Readme,\n  Refresh,\n  ScryptedDeviceBase,\n  ScryptedInterface,\n  ScryptedNativeId,\n  Setting,\n  SettingValue,\n  Settings,\n} from \"@scrypted/sdk\";\nimport {\n  AUTH_STATE,\n  AuthenticationManager,\n  EufyWebSocketClient,\n  StartListeningResponse,\n} from \"@caplaz/eufy-security-client\";\nimport { Logger, ILogObj, ILogObjMeta } from \"tslog\";\nimport { EufyStation } from \"./eufy-station\";\nimport { DeviceUtils } from \"./utils/device-utils\";\nimport { MemoryManager } from \"./utils/memory-manager\";\n\nconst { deviceManager } = sdk;\n\n/**\n * Create a transport function for routing tslog output to a Scrypted console\n */\nfunction createConsoleTransport(console: Console) {\n  return (logObj: ILogObj & ILogObjMeta) => {\n    const meta = (logObj as any)._meta;\n    if (!meta) return;\n    const prefix = meta.name ? `[${meta.name}] ` : \"\";\n\n    // Extract all non-meta properties as the log arguments\n    const args = Object.keys(logObj)\n      .filter((key) => key !== \"_meta\" && key !== \"toJSON\")\n      .map((key) => (logObj as any)[key]);\n\n    const msg = args\n      .map((a: any) => (typeof a === \"object\" ? JSON.stringify(a) : String(a)))\n      .join(\" \");\n\n    const level = meta.logLevelName?.toLowerCase();\n    if (level === \"warn\") console.warn(`${prefix}${msg}`);\n    else if (level === \"error\" || level === \"fatal\")\n      console.error(`${prefix}${msg}`);\n    else console.log(`${prefix}${msg}`);\n  };\n}\n\nexport class EufySecurityProvider\n  extends ScryptedDeviceBase\n  implements DeviceProvider, Readme, Settings, Refresh\n{\n  // Core dependencies\n  wsClient: EufyWebSocketClient;\n  wsLogger: Logger<ILogObj>;\n  private logger: Logger<ILogObj>;\n\n  // Device management\n  stations = new Map<string, EufyStation>();\n\n  // Settings state\n  debugLogging = false;\n\n  // Connection state tracking\n  pushConnected = false;\n  mqttConnected = false;\n\n  // Connection in progress flag (true during initial startup or reconnection)\n  private isConnecting = true;\n\n  // Track if we've already logged the ready state to avoid spam\n  private hasLoggedReady = false;\n  private isWaitingForReady = false;\n\n  // Authentication manager (handles all auth logic)\n  private authManager: AuthenticationManager;\n\n  /**\n   * Construct a new EufySecurityProvider.\n   * @param nativeId - Optional Scrypted nativeId for the provider.\n   */\n  constructor(nativeId?: string) {\n    super(nativeId);\n\n    // Initialize the root logger with this provider's console\n    // This controls the global debug setting for all sublogs\n    this.debugLogging = this.storage.getItem(\"debugLogging\") === \"true\";\n    this.logger = new Logger<ILogObj>({\n      name: \"EufySecurity\",\n      minLevel: this.debugLogging ? 0 : 3, // 0=all, 3=info+\n      type: \"hidden\",\n    });\n    this.logger.attachTransport(createConsoleTransport(this.console));\n\n    // Create a logger for the WebSocket client using the same console\n    // (WebSocket events are part of the provider's responsibility)\n    this.wsLogger = this.logger.getSubLogger({ name: \"WebSocketClient\" });\n    this.wsClient = new EufyWebSocketClient(\n      this.storage.getItem(\"wsUrl\") || \"ws://localhost:3000\",\n      this.wsLogger\n    );\n\n    // Initialize system memory threshold from storage\n    const memoryThreshold = Math.max(\n      50,\n      parseInt(this.storage.getItem(\"memoryThresholdMB\") || \"120\")\n    );\n    const memoryLogger = this.logger.getSubLogger({ name: \"Memory\" });\n    MemoryManager.setMemoryThreshold(memoryThreshold, memoryLogger);\n\n    // Initialize authentication manager\n    const authLogger = this.logger.getSubLogger({ name: \"Auth\" });\n    this.authManager = new AuthenticationManager(\n      this.wsClient,\n      authLogger,\n      () => this.onDeviceEvent(ScryptedInterface.Settings, undefined),\n      async (result: StartListeningResponse) => {\n        this.displayConnectResult(true, true);\n        this.logger.info(\" Discovering devices after authentication...\");\n        await this.registerStationsFromServerState(result);\n        await this.registerDevicesFromServerState(result);\n        this.logger.info(\" Device discovery complete\");\n\n        // Mark connection as complete\n        this.isConnecting = false;\n      }\n    );\n\n    this.logger.info(\" EufySecurityProvider initialized\");\n\n    // Start connection automatically\n    this.startConnection().catch((error) => {\n      this.logger.error(\" Failed to start connection:\", error);\n    });\n  }\n\n  /**\n   * Get the settings for this provider.\n   * @returns {Promise<Setting[]>} Array of Scrypted Setting objects.\n   */\n  async getSettings(): Promise<Setting[]> {\n    const clientState = this.wsClient.getState();\n\n    // Get some additional status information\n    const memoryThreshold = MemoryManager.getMemoryThreshold();\n    const currentMemory = Math.round(process.memoryUsage().rss / 1024 / 1024);\n\n    // Check authentication status\n    const captchaStatus = this.authManager.getAuthStatusMessage(\n      clientState?.driverConnected || false\n    );\n\n    return [\n      // WebSocket Server Connection Settings\n      {\n        group: \"WebSocket Server Connection\",\n        key: \"wsUrl\",\n        title: \"WebSocket URL\",\n        description: \"URL of the eufy-security-ws container\",\n        value: this.storage.getItem(\"wsUrl\") || \"ws://localhost:3000\",\n        placeholder: \"ws://localhost:3000\",\n      },\n      {\n        group: \"WebSocket Server Connection\",\n        key: \"debugLogging\",\n        title: \"Debug Logging\",\n        description: \"Enable verbose logging for troubleshooting\",\n        value: this.debugLogging,\n        type: \"boolean\",\n        immediate: true, // Apply immediately without restart\n      },\n\n      // Memory Management Settings\n      {\n        group: \"Memory Management\",\n        key: \"currentMemoryMB\",\n        title: \"Current Memory Usage\",\n        description: `Current RSS memory usage vs threshold (${memoryThreshold}MB)`,\n        value: `${currentMemory}MB ${currentMemory > memoryThreshold ? \"\" : \"\"}`,\n        type: \"string\",\n        readonly: true,\n      },\n      {\n        group: \"Memory Management\",\n        key: \"memoryThresholdMB\",\n        title: \"Memory Threshold (MB)\",\n        description:\n          \"System-wide memory threshold for buffer cleanup across all devices (default: 120MB)\",\n        type: \"number\",\n        value: parseInt(this.storage.getItem(\"memoryThresholdMB\") || \"120\"),\n      },\n\n      // Eufy Cloud Account Settings\n      {\n        group: \"Eufy Cloud Account\",\n        key: \"driverConnectionStatus\",\n        title: \"Account Connection Status\",\n        description: \"Current Eufy cloud account connection state\",\n        value: clientState?.driverConnected\n          ? \" Connected\"\n          : \" Disconnected\",\n        type: \"string\",\n        readonly: true,\n      },\n      {\n        group: \"Eufy Cloud Account\",\n        key: \"pushConnectionStatus\",\n        title: \"Push Notifications\",\n        description:\n          \"Push notification connection (requires push service in eufy-security-ws)\",\n        value: this.pushConnected\n          ? \" Connected\"\n          : \" Disconnected (may be normal)\",\n        type: \"string\",\n        readonly: true,\n      },\n      {\n        group: \"Eufy Cloud Account\",\n        key: \"mqttConnectionStatus\",\n        title: \"MQTT Connection\",\n        description:\n          \"MQTT connection for real-time updates (requires MQTT in eufy-security-ws)\",\n        value: this.mqttConnected\n          ? \" Connected\"\n          : \" Disconnected (may be normal)\",\n        type: \"string\",\n        readonly: true,\n      },\n      {\n        group: \"Eufy Cloud Account\",\n        key: \"captchaStatus\",\n        title: \"Authentication Status\",\n        description: \"Current authentication/captcha status\",\n        value: captchaStatus,\n        type: \"string\",\n        readonly: true,\n      },\n      // Dynamic connect/disconnect buttons based on connection status\n      ...(clientState?.driverConnected\n        ? [\n            {\n              group: \"Eufy Cloud Account\",\n              key: \"disconnectDriver\",\n              title: \"Disconnect from Eufy Cloud\",\n              description: \"Disconnect from Eufy cloud services\",\n              value: \"Disconnect Account\",\n              type: \"button\" as const,\n            },\n          ]\n        : [\n            {\n              group: \"Eufy Cloud Account\",\n              key: \"connectDriver\",\n              title: \"Connect to Eufy Cloud\",\n              description: \"Establish connection to Eufy cloud services\",\n              value: \"Connect Account\",\n              type: \"button\" as const,\n            },\n          ]),\n\n      // CAPTCHA Authentication UI\n      ...(this.authManager.getAuthState() === \"captcha_required\" &&\n      this.authManager.getCaptchaData()\n        ? [\n            {\n              group: \"Eufy Cloud Account\",\n              key: \"captchaImage\",\n              title: \"CAPTCHA Challenge\",\n              description: \"Solve the CAPTCHA to continue authentication\",\n              value: `<div style=\"text-align: center; padding: 20px;\"><img src=\"${this.authManager.getCaptchaData()!.captcha.startsWith(\"data:\") ? this.authManager.getCaptchaData()!.captcha : `data:image/png;base64,${this.authManager.getCaptchaData()!.captcha}`}\" alt=\"CAPTCHA\" style=\"max-width: 100%; border: 2px solid #ccc; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.1);\"/></div>`,\n              type: \"html\" as const,\n              readonly: true,\n            },\n            {\n              group: \"Eufy Cloud Account\",\n              key: \"captchaCodeInput\",\n              title: \"CAPTCHA Code\",\n              description: `ID: ${this.authManager.getCaptchaData()!.captchaId} - Enter the code from the image above`,\n              value: this.authManager.getCurrentCaptchaCode(),\n              placeholder: \"Enter CAPTCHA code\",\n              immediate: true,\n            },\n            {\n              group: \"Eufy Cloud Account\",\n              key: \"submitCaptchaButton\",\n              title: \"Submit CAPTCHA\",\n              description: \"Click to submit the CAPTCHA code entered above\",\n              value: \"Submit CAPTCHA Code\",\n              type: \"button\" as const,\n            },\n          ]\n        : []),\n\n      // MFA Authentication UI\n      ...(this.authManager.getAuthState() === AUTH_STATE.MFA_REQUIRED\n        ? [\n            {\n              group: \"Eufy Cloud Account\",\n              key: \"verifyCodeInput\",\n              title: \"2FA Verification Code\",\n              description: this.authManager.getMfaData()?.methods?.length\n                ? `Methods: ${this.authManager.getMfaData()!.methods.join(\", \")} - Enter your 6-digit code`\n                : \"Check your email or SMS for the 6-digit verification code\",\n              value: this.authManager.getCurrentVerifyCode(),\n              placeholder: \"Enter 6-digit code\",\n              immediate: true,\n            },\n            {\n              group: \"Eufy Cloud Account\",\n              key: \"submitVerifyCodeButton\",\n              title: \"Submit 2FA Code\",\n              description:\n                \"Click to submit the verification code entered above\",\n              value: \"Submit Verification Code\",\n              type: \"button\" as const,\n            },\n          ]\n        : []),\n\n      // WebSocket Server Status Monitoring (Read-only) - Complete ClientState interface data\n      {\n        group: \"WebSocket Server Status\",\n        key: \"connectionState\",\n        title: \"Connection State\",\n        description: \"Current connection lifecycle state\",\n        value: `${this.getConnectionStateIcon(clientState?.connection)} ${\n          clientState?.connection || \"Unknown\"\n        }`,\n        type: \"string\" as const,\n        readonly: true,\n      },\n      {\n        group: \"WebSocket Server Status\",\n        key: \"wsConnected\",\n        title: \"WebSocket Connected\",\n        description: \"Whether WebSocket connection is established\",\n        value: clientState?.wsConnected ? \" Connected\" : \" Disconnected\",\n        type: \"string\" as const,\n        readonly: true,\n      },\n      {\n        group: \"WebSocket Server Status\",\n        key: \"schemaSetupComplete\",\n        title: \"Schema Setup Complete\",\n        description: \"Whether API schema negotiation is complete\",\n        value: clientState?.schemaSetupComplete ? \" Complete\" : \" Pending\",\n        type: \"string\" as const,\n        readonly: true,\n      },\n      {\n        group: \"WebSocket Server Status\",\n        key: \"schemaInfo\",\n        title: \"Schema Negotiation\",\n        description: \"API version compatibility and negotiation results\",\n        value: clientState?.schemaInfo\n          ? `v${clientState.schemaInfo.negotiatedSchema} (compatible: ${\n              clientState.schemaInfo.isCompatible ? \"\" : \"\"\n            })`\n          : \"Not negotiated\",\n        type: \"string\" as const,\n        readonly: true,\n      },\n      {\n        group: \"WebSocket Server Status\",\n        key: \"lastError\",\n        title: \"Last Error\",\n        description: \"Most recent error that occurred, if any\",\n        value: clientState?.lastError\n          ? ` ${clientState.lastError.message}`\n          : \" None\",\n        type: \"string\" as const,\n        readonly: true,\n      },\n      {\n        group: \"WebSocket Server Status\",\n        key: \"reconnectAttempts\",\n        title: \"Reconnect Attempts\",\n        description: \"Number of reconnection attempts made\",\n        value: clientState?.reconnectAttempts || 0,\n        type: \"number\" as const,\n        readonly: true,\n      },\n      {\n        group: \"WebSocket Server Status\",\n        key: \"eventListenerCount\",\n        title: \"Event Listeners\",\n        description: \"Number of registered event listeners\",\n        value: clientState?.eventListenerCount || 0,\n        type: \"number\" as const,\n        readonly: true,\n      },\n    ];\n  }\n\n  /**\n   * Update a setting for this provider.\n   * @param key - Setting key to update.\n   * @param value - New value for the setting.\n   * @returns {Promise<void>}\n   */\n  async putSetting(key: string, value: SettingValue): Promise<void> {\n    // Handle button clicks (they can have null values)\n    if (key === \"connectDriver\") {\n      this.logger.info(\" Button clicked: Connect to Eufy cloud\");\n\n      // Mark connection as in progress\n      this.isConnecting = true;\n\n      try {\n        // Send connect command to the driver\n        await this.wsClient.commands.driver().connect();\n        this.logger.info(\" Driver connect command sent\");\n\n        // Wait a moment for the server to process the connect command\n        await new Promise((resolve) => setTimeout(resolve, 1000));\n\n        // Check current state and pending authentication\n        const result = await this.wsClient.startListening();\n\n        if (result.state.driver.connected) {\n          // Successfully connected\n          this.logger.info(\n            \" Driver fully connected - authentication complete\"\n          );\n          this.authManager.resetAuthState();\n          this.displayConnectResult(true, true);\n\n          // Register devices after successful connection\n          this.logger.info(\" Discovering devices...\");\n          await this.registerStationsFromServerState(result);\n          await this.registerDevicesFromServerState(result);\n          this.logger.info(\" Device discovery complete\");\n\n          // Mark connection as complete\n          this.isConnecting = false;\n        } else {\n          // Not connected - check for pending authentication\n          this.logger.info(\n            \" Driver not connected - checking for authentication challenges\"\n          );\n          await this.authManager.checkPendingAuth();\n\n          // If no pending auth was found, the connection might just need more time\n          if (this.authManager.getAuthState() === AUTH_STATE.NONE) {\n            this.logger.info(\n              \" No authentication challenges detected. The connection may be in progress.\"\n            );\n            this.logger.info(\n              \" If you have 2FA enabled, you may need to check your email or app.\"\n            );\n            this.logger.info(\"\");\n            this.logger.info(\" Troubleshooting tips:\");\n            this.logger.info(\n              \"   1. Check the eufy-security-ws container logs for errors\"\n            );\n            this.logger.info(\n              \"   2. Verify your Eufy account credentials in the container config\"\n            );\n            this.logger.info(\n              \"   3. Ensure the container has internet access to connect to Eufy cloud\"\n            );\n            this.logger.info(\n              \"   4. Try restarting the eufy-security-ws container\"\n            );\n            this.logger.info(\"\");\n            this.logger.info(\"   Container logs command:\");\n            this.logger.info(\"   docker logs eufy-security-ws\");\n\n            // Set up a listener for when connection succeeds\n            const removeListener = this.wsClient.addEventListener(\n              \"connected\",\n              async () => {\n                removeListener();\n                this.logger.info(\" Driver connected event received\");\n                this.authManager.resetAuthState();\n\n                // Get updated state and register devices\n                const updatedResult = await this.wsClient.startListening();\n                if (updatedResult.state.driver.connected) {\n                  this.displayConnectResult(true, true);\n                  await this.registerStationsFromServerState(updatedResult);\n                  await this.registerDevicesFromServerState(updatedResult);\n                  this.logger.info(\" Device discovery complete\");\n\n                  // Mark connection as complete\n                  this.isConnecting = false;\n                }\n                this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n              },\n              { source: \"driver\" }\n            );\n          }\n        }\n      } catch (error) {\n        this.logger.error(\" Connection failed:\", error);\n        // Check if it's an authentication error\n        await this.authManager.checkPendingAuth();\n      }\n\n      // Refresh the settings UI to show updated connection state\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n      return;\n    }\n\n    if (key === \"disconnectDriver\") {\n      this.logger.info(\" Button clicked: Disconnect from Eufy cloud\");\n      try {\n        await this.wsClient.commands.driver().disconnect();\n        this.logger.info(\" Driver disconnected successfully\");\n\n        // Mark as ready for new connection\n        this.isConnecting = true;\n\n        // Refresh the settings UI to show updated connection state\n        this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n      } catch (error) {\n        this.logger.error(\" Failed to disconnect driver:\", error);\n\n        // Refresh the settings UI even on error to show any state changes\n        this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n        throw error;\n      }\n      return;\n    }\n\n    // Handle CAPTCHA code input (called on every keystroke with immediate:true)\n    if (key === \"captchaCodeInput\") {\n      this.authManager.updateCaptchaCode(value?.toString() || \"\");\n      this.storage.setItem(\"captchaCodeInput\", value?.toString() || \"\");\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n      return;\n    }\n\n    // Handle CAPTCHA submit button\n    if (key === \"submitCaptchaButton\") {\n      try {\n        await this.authManager.submitCaptcha();\n        this.storage.removeItem(\"captchaCodeInput\");\n      } catch (error) {\n        this.logger.error(\" CAPTCHA submission failed:\", error);\n      }\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n      return;\n    }\n\n    // Handle verification code input (called on every keystroke with immediate:true)\n    if (key === \"verifyCodeInput\") {\n      this.authManager.updateVerifyCode(value?.toString() || \"\");\n      this.storage.setItem(\"verifyCodeInput\", value?.toString() || \"\");\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n      return;\n    }\n\n    // Handle verification code submit button\n    if (key === \"submitVerifyCodeButton\") {\n      try {\n        await this.authManager.submitVerifyCode();\n        this.storage.removeItem(\"verifyCodeInput\");\n      } catch (error) {\n        this.logger.error(\" Verification code submission failed:\", error);\n      }\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n      return;\n    }\n\n    if (key === \"requestNewCode\") {\n      try {\n        await this.authManager.requestNewCode();\n      } catch (error) {\n        this.logger.error(\" Failed to request new code:\", error);\n      }\n      return;\n    }\n\n    // Handle regular settings (require non-null values)\n    if (value === undefined || value === null) {\n      this.logger.warn(\n        ` Ignoring setting update for ${key}: value is null/undefined`\n      );\n      return;\n    }\n\n    // Store the setting value\n    this.storage.setItem(key, value.toString());\n\n    if (key === \"wsUrl\") {\n      try {\n        // Reconnect with new URL\n        this.wsClient.disconnect();\n        this.wsClient = new EufyWebSocketClient(\n          value.toString(),\n          this.wsLogger\n        );\n\n        // Note: Auth manager was initialized with the old wsClient\n        // For full reconnection support, we'd need to recreate the auth manager\n        // or make it support client replacement. For now, this edge case is acceptable.\n\n        await this.startConnection();\n        this.logger.info(\" Reconnected with new WebSocket URL\");\n      } catch (error) {\n        this.logger.error(\n          \" Failed to connect with new WebSocket URL:\",\n          error\n        );\n        throw error;\n      }\n    } else if (key === \"debugLogging\") {\n      // Handle boolean conversion more robustly\n      const newDebugValue =\n        value === true || value === \"true\" || value === 1 || value === \"1\";\n      this.debugLogging = newDebugValue;\n\n      // Update root logger minLevel - this propagates to all sub-loggers via tslog's hierarchy\n      this.logger.settings.minLevel = this.debugLogging ? 0 : 3;\n\n      // Update WebSocket logger level\n      this.wsLogger.settings.minLevel = this.debugLogging ? 0 : 3;\n\n      this.storage.setItem(\"debugLogging\", this.debugLogging.toString());\n      this.logger.info(\n        `Debug logging ${this.debugLogging ? \"enabled\" : \"disabled\"}`\n      );\n      // Refresh the settings UI to reflect the immediate change\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n    } else if (key === \"memoryThresholdMB\") {\n      const memMB = Math.max(50, parseInt(value as string) || 120);\n      this.storage.setItem(\"memoryThresholdMB\", memMB.toString());\n      const memoryLogger = this.logger.getSubLogger({ name: \"MemoryManager\" });\n      memoryLogger.attachTransport(createConsoleTransport(this.console));\n      MemoryManager.setMemoryThreshold(memMB, memoryLogger);\n      this.logger.info(`Memory threshold updated to ${memMB}MB`);\n      this.onDeviceEvent(ScryptedInterface.Settings, undefined);\n    }\n  }\n  async getRefreshFrequency(): Promise<number> {\n    return 300; // 5 minutes\n  }\n\n  /**\n   * Refresh the provider (connection health check).\n   * @returns {Promise<void>}\n   */\n  async refresh(): Promise<void> {\n    this.logger.info(\" Connection health check\");\n\n    if (!this.wsClient.isConnected()) {\n      this.logger.warn(\n        \" WebSocket not connected, attempting to reconnect...\"\n      );\n      try {\n        await this.startConnection();\n        this.logger.info(\" Successfully reconnected\");\n      } catch (error) {\n        this.logger.error(\" Failed to reconnect:\", error);\n        throw error;\n      }\n    } else {\n      this.logger.info(\" WebSocket connection healthy\");\n    }\n  }\n\n  /**\n   * Get or create a device (station or child device) by nativeId.\n   * @param nativeId - Scrypted nativeId for the device.\n   * @returns {Promise<EufyStation | any | undefined>} The device instance or undefined if not found.\n   */\n  async getDevice(nativeId: ScryptedNativeId): Promise<any> {\n    // Wait for client to be ready on restore (schema negotiation, etc.)\n    await this.waitForClientReady();\n\n    // Check if driver is connected before creating devices\n    const clientState = this.wsClient.getState();\n    if (!clientState.driverConnected) {\n      // During connection, this is expected - devices will be registered after auth\n      if (this.isConnecting) {\n        this.logger.debug(\n          ` Driver connecting, device ${nativeId} will be available after authentication`\n        );\n      } else {\n        this.logger.warn(\n          ` Driver not connected, cannot create device ${nativeId}`\n        );\n      }\n      return undefined;\n    }\n\n    if (nativeId && nativeId.startsWith(\"station_\")) {\n      this.logger.info(`Getting station ${nativeId}`);\n\n      // Return existing station or create new EufyStation\n      let station = this.stations.get(nativeId);\n      if (!station) {\n        station = new EufyStation(nativeId, this.wsClient, this.logger);\n        this.stations.set(nativeId, station);\n        this.logger.info(`Created new station ${nativeId}`);\n      }\n      return station;\n    }\n    return undefined;\n  }\n\n  /**\n   * Release a device (station or child device) by nativeId.\n   * @param id - Device id (unused).\n   * @param nativeId - Scrypted nativeId for the device.\n   * @returns {Promise<void>}\n   */\n  async releaseDevice(id: string, nativeId: string): Promise<void> {\n    // Handle station release\n    if (nativeId.startsWith(\"station_\")) {\n      const station = this.stations.get(nativeId);\n      if (station) {\n        station.dispose();\n        this.stations.delete(nativeId);\n        this.logger.info(` Released station ${nativeId}`);\n      }\n    }\n  }\n\n  /**\n   * Start the WebSocket connection and register stations/devices from server state.\n   * @returns {Promise<void>}\n   */\n  private async startConnection(): Promise<void> {\n    // Reset ready flags when starting a new connection\n    this.hasLoggedReady = false;\n    this.isWaitingForReady = false;\n    await this.wsClient.connect();\n    await this.waitForClientReady();\n\n    const serverState: StartListeningResponse =\n      await this.wsClient.startListening();\n\n    // Only register stations and devices if the driver is connected\n    if (serverState.state.driver.connected) {\n      // Register stations and devices from server state\n      // IMPORTANT: Register stations first so they exist as parents for devices\n      await this.registerStationsFromServerState(serverState);\n      await this.registerDevicesFromServerState(serverState);\n\n      // Connection completed successfully\n      this.isConnecting = false;\n    } else {\n      this.logger.info(\n        \" Driver not connected yet - authentication may be required. Check settings to connect.\"\n      );\n      // Keep isConnecting = true until successful connection\n    }\n  }\n\n  /**\n   * Register stations from the server state.\n   * @param serverState - StartListeningResponse from the server.\n   * @returns {Promise<void>}\n   */\n  private async registerStationsFromServerState(\n    serverState: StartListeningResponse\n  ): Promise<void> {\n    // Extract station serial numbers from server state (string array)\n    const stationSerials: string[] = serverState.state.stations || [];\n    this.logger.info(\n      ` Found ${stationSerials.length} station serials from server:`,\n      stationSerials\n    );\n\n    if (stationSerials.length === 0) {\n      this.logger.warn(\" No stations found in server state\");\n      return;\n    }\n\n    // Create manifests for each station serial number\n    const manifests = stationSerials.map(async (stationSerial: string) => {\n      return DeviceUtils.createStationManifest(this.wsClient, stationSerial);\n    });\n\n    await deviceManager.onDevicesChanged({\n      providerNativeId: this.nativeId,\n      devices: await Promise.all(manifests),\n    });\n\n    this.logger.info(\n      ` Registered ${manifests.length} stations from server state`\n    );\n  }\n\n  /**\n   * Register devices from the server state.\n   * @param serverState - StartListeningResponse from the server.\n   * @returns {Promise<void>}\n   */\n  private async registerDevicesFromServerState(\n    serverState: StartListeningResponse\n  ): Promise<void> {\n    // Extract device serial numbers from server state (string array)\n    const deviceSerials: string[] = serverState.state.devices || [];\n    this.logger.info(\n      ` Found ${deviceSerials.length} device serials from server:`,\n      deviceSerials\n    );\n\n    if (deviceSerials.length === 0) {\n      this.logger.warn(\" No devices found in server state\");\n      return;\n    }\n\n    deviceSerials.forEach((deviceSerial) =>\n      DeviceUtils.createDeviceManifest(this.wsClient, deviceSerial).then(\n        (manifest) =>\n          deviceManager.onDevicesChanged({\n            providerNativeId: manifest.providerNativeId,\n            devices: [manifest],\n          })\n      )\n    );\n\n    this.logger.info(\n      ` Registered ${deviceSerials.length} devices from server state`\n    );\n  }\n\n  /**\n   * Wait for the WebSocket client to be ready for API calls.\n   * @returns {Promise<void>}\n   */\n  private async waitForClientReady(): Promise<void> {\n    const maxWaitTime = 15000; // 15 seconds max wait (increased from 10)\n    const checkInterval = 500; // Check every 500ms\n    let waitTime = 0;\n\n    // Only log if we haven't already logged AND we're not currently waiting\n    if (!this.hasLoggedReady && !this.isWaitingForReady) {\n      this.logger.info(\n        \" Waiting for WebSocket client to be ready for API calls...\"\n      );\n      this.isWaitingForReady = true;\n    }\n\n    return new Promise<void>((resolve, reject) => {\n      const checkReady = () => {\n        // Check if client is ready for API calls - isConnected() calls stateManager.isReady()\n        if (this.wsClient.isConnected()) {\n          // Only log once when transitioning to ready\n          if (!this.hasLoggedReady) {\n            this.logger.info(\" WebSocket client ready for API calls\");\n            this.hasLoggedReady = true;\n            this.isWaitingForReady = false;\n          }\n          resolve();\n        } else if (waitTime >= maxWaitTime) {\n          const state = this.wsClient.getState();\n          reject(\n            new Error(\n              `Timeout waiting for client to be ready. Current state: ${state.connection}`\n            )\n          );\n        } else {\n          waitTime += checkInterval;\n          setTimeout(checkReady, checkInterval);\n        }\n      };\n      checkReady();\n    });\n  }\n\n  /**\n   * Get an appropriate icon for the connection state.\n   * @param connectionState - The connection state to get an icon for.\n   * @returns {string} Emoji icon representing the state.\n   */\n  private getConnectionStateIcon(connectionState?: string): string {\n    switch (connectionState) {\n      case \"disconnected\":\n        return \"\";\n      case \"connecting\":\n        return \"\";\n      case \"connected\":\n        return \"\";\n      case \"schema_negotiating\":\n        return \"\";\n      case \"ready\":\n        return \"\";\n      case \"error\":\n        return \"\";\n      default:\n        return \"\";\n    }\n  }\n\n  /**\n   * Dispose of the provider and clean up resources.\n   */\n  dispose(): void {\n    this.wsClient.disconnect();\n    this.stations.clear();\n  }\n\n  /**\n   * Execute a promise with a timeout\n   */\n  private async withTimeout<T>(\n    promise: Promise<T>,\n    timeoutMs: number,\n    timeoutMessage: string\n  ): Promise<T> {\n    return new Promise((resolve, reject) => {\n      const timeoutId = setTimeout(() => {\n        reject(new Error(timeoutMessage));\n      }, timeoutMs);\n\n      promise\n        .then((result) => {\n          clearTimeout(timeoutId);\n          resolve(result);\n        })\n        .catch((error) => {\n          clearTimeout(timeoutId);\n          reject(error);\n        });\n    });\n  }\n\n  /**\n   * Display the result of a connection attempt\n   */\n  private displayConnectResult(\n    isWebSocketConnected: boolean,\n    isDriverConnected: boolean\n  ): void {\n    if (!isWebSocketConnected) {\n      this.logger.error(\" Connection Failed: WEBSOCKET DISCONNECTED\");\n      this.logger.error(\"   Cannot connect to the eufy-security-ws server.\");\n      this.logger.error(\"   This may indicate:\");\n      this.logger.error(\"    The eufy-security-ws server is not running\");\n      this.logger.error(\"    Network connectivity issues\");\n      this.logger.error(\"    Incorrect WebSocket host/port configuration\");\n      this.logger.error(\"    Server configuration issues\");\n      throw new Error(\" WebSocket connection failed\");\n    } else if (!isDriverConnected) {\n      this.logger.warn(\n        \"  Connection Established: DRIVER NEEDS AUTHENTICATION\"\n      );\n      this.logger.warn(\n        \"   WebSocket connection established, but Eufy driver is not authenticated.\"\n      );\n      this.logger.warn(\"   This typically means:\");\n      this.logger.warn(\n        \"    2FA authentication is required (captcha/verification code)\"\n      );\n      this.logger.warn(\"    Eufy account credentials need verification\");\n      this.logger.warn(\n        \"    Check the settings page for authentication prompts\"\n      );\n    } else {\n      this.logger.info(\" Connection Successful: FULLY CONNECTED\");\n      this.logger.info(\n        \"   WebSocket connection established and Eufy driver is authenticated.\"\n      );\n      this.logger.info(\n        \"   You can now use other Scrypted features to interact with your devices.\"\n      );\n    }\n  }\n\n  /**\n   * Generate a custom README focused on the main plugin settings and configuration\n   * @implements {Readme}\n   */\n  async getReadmeMarkdown(): Promise<string> {\n    const memoryManager = MemoryManager.getInstance(this.logger);\n    const memoryUsage = memoryManager.getCurrentMemoryUsage();\n    const memoryThreshold = MemoryManager.getMemoryThreshold();\n\n    return `![Eufy Security Plugin](https://raw.githubusercontent.com/caplaz/eufy-security-scrypted/main/packages/eufy-security-scrypted/public/banner.png)\n\n##  Quick Setup\n\n### 1. Start the eufy-security-ws Server\n\nThis plugin requires a companion WebSocket server to communicate with Eufy cloud services.\n\n#### Option A: Docker (Recommended)\n\nCreate a \\`docker-compose.yml\\` file:\n\n\\`\\`\\`yaml\nservices:\n  eufy-security-ws:\n    image: bropat/eufy-security-ws:latest\n    container_name: eufy-security-ws\n    ports:\n      - \"3000:3000\"\n    environment:\n      - USERNAME=your_eufy_email@example.com\n      - PASSWORD=your_eufy_password\n      - COUNTRY=US\n    restart: unless-stopped\n\\`\\`\\`\n\nStart the server:\n\\`\\`\\`bash\ndocker-compose up -d\n\\`\\`\\`\n\n#### Option B: NPM Installation\n\n\\`\\`\\`bash\nnpm install -g eufy-security-ws\n\\`\\`\\`\n\nCreate a \\`config.json\\`:\n\\`\\`\\`json\n{\n  \"username\": \"your_eufy_email@example.com\",\n  \"password\": \"your_eufy_password\",\n  \"country\": \"US\"\n}\n\\`\\`\\`\n\nRun the server:\n\\`\\`\\`bash\neufy-security-ws\n\\`\\`\\`\n\n### 2. Configure Plugin Settings\n\nAfter starting the server, configure the plugin:\n\n- **WebSocket URL**: \\`ws://localhost:3000\\` (default)\n- **Debug Logging**: Enable for troubleshooting\n- **Memory Management**: Configure memory thresholds\n\n##  WebSocket Connection\n\n**Status**: ${this.wsClient?.isConnected() ? \" Connected\" : \" Disconnected\"}\n\nConfigure the connection to your eufy-security-ws server:\n\n- **WebSocket URL**: \\`ws://localhost:3000\\` (default)\n- **Connection State**: ${this.getConnectionStateDescription()}\n\n### Connection States\n- ** Ready**: Fully connected and operational\n- ** Connected**: WebSocket connected, waiting for auth\n- ** Connecting**: Establishing connection\n- ** Disconnected**: Not connected\n\n##  Cloud Account\n\n**Authentication Status**: ${this.getAuthStatusDescription()}\n\n### Authentication Flow\n1. Click **\"Connect Account\"** in plugin settings\n2. Complete CAPTCHA challenge (if required)\n3. Enter 2FA verification code (if enabled)\n4. Devices will automatically appear\n\n### Troubleshooting Authentication\n- **CAPTCHA Issues**: Refresh settings page if CAPTCHA doesn't appear\n- **2FA Problems**: Check email/SMS for verification codes\n- **Connection Errors**: Verify eufy-security-ws server is running\n\n##  Memory Management\n\n**Current Usage**: ${memoryUsage.heapMB} MB (RSS: ${memoryUsage.rssMB} MB)\n**Threshold**: ${memoryThreshold} MB\n**Status**: ${memoryUsage.heapMB < memoryThreshold ? \" Normal\" : \" High\"}\n\n### Memory Settings\n- **Automatic Cleanup**: Enabled when threshold exceeded\n- **Optimized Buffers**: Memory-conscious video streaming\n- **Crash Prevention**: Monitors and manages memory usage\n\n### Performance Tips\n- **Low Memory Systems** (4GB RAM): Set threshold to 80-100MB\n- **Normal Systems** (8GB RAM): Default 120-150MB threshold\n- **High Memory Systems** (16GB RAM): Can use 200-300MB threshold\n\n##  System Status\n\n**Push Connected**: ${this.pushConnected ? \"\" : \"\"}\n**MQTT Connected**: ${this.mqttConnected ? \"\" : \"\"}\n**Debug Logging**: ${this.debugLogging ? \"Enabled\" : \"Disabled\"}\n\n##  Quick Actions\n\n- **Reconnect**: Use if connection is lost\n- **Refresh Devices**: Sync latest device list from Eufy\n- **Debug Toggle**: Enable for troubleshooting logs\n\n---\n\n*This README is dynamically generated based on your current plugin configuration.*`;\n  }\n\n  /**\n   * Get a human-readable description of the current connection state\n   */\n  private getConnectionStateDescription(): string {\n    if (!this.wsClient) return \"Not initialized\";\n\n    const wsConnected = this.wsClient.isConnected();\n    const driverConnected = this.wsClient.isDriverConnected();\n\n    if (wsConnected && driverConnected) return \"Fully Connected\";\n    if (wsConnected && !driverConnected)\n      return \"WebSocket Connected (Auth Required)\";\n    if (!wsConnected) return \"Disconnected\";\n\n    return \"Unknown\";\n  }\n\n  /**\n   * Get a human-readable description of the authentication status\n   */\n  private getAuthStatusDescription(): string {\n    const authState = this.authManager.getAuthState();\n    switch (authState) {\n      case AUTH_STATE.NONE:\n        return \"Not Authenticated \";\n      case AUTH_STATE.CAPTCHA_REQUIRED:\n        return \"CAPTCHA Required \";\n      case AUTH_STATE.MFA_REQUIRED:\n        return \"2FA Required \";\n      default:\n        return \"Unknown\";\n    }\n  }\n}\n","/**\n * Main entry point for the Eufy Security Scrypted plugin\n *\n * This file exports the main provider class that Scrypted will instantiate\n * when the plugin is loaded. The plugin provides comprehensive integration\n * with Eufy security devices through the eufy-security-ws WebSocket server.\n *\n * Features:\n * - Device discovery and management\n * - Video streaming with H.264 support\n * - Audio streaming with AAC support\n * - Motion detection and sensor monitoring\n * - Device control (lights, pan/tilt, etc.)\n * - Memory management and performance optimization\n * - HomeKit Secure Video compatibility\n *\n * @public\n * @since 1.0.0\n */\n\nimport { EufySecurityProvider } from './eufy-provider';\n\nexport default EufySecurityProvider;\n"],"names":["leafPrototypes","getProto","Object","defineProperty","exports","value","MESSAGE_TYPES","WebSocketMessageProcessor","AuthenticationManager","AUTH_STATE","ConnectionState","ClientStateManager","EufySecurityClient","WebSocketClient","EufyWebSocketClient","tslib_1","api_manager_1","enumerable","get","ApiManager","websocket_client_1","eufy_security_client_1","client_state_1","__exportStar","authentication_manager_1","websocket_message_processor_1","websocket_types_1","isSupportedCommand","command","values","constants_1","DEVICE_COMMANDS","STATION_COMMANDS","DRIVER_COMMANDS","SERVER_COMMANDS","includes","module","require","ownKeys","__createBinding","this","create","o","m","k","k2","undefined","desc","getOwnPropertyDescriptor","__esModule","writable","configurable","__setModuleDefault","v","__importStar","getOwnPropertyNames","ar","prototype","hasOwnProperty","call","length","mod","result","i","StreamServer","net","events_1","tslog_1","connection_manager_1","h264_parser_1","EventEmitter","constructor","options","super","isActive","livestreamIntendedState","livestreamActualState","videoMetadata","metadataReceived","lastClientActivity","ACTIVITY_TIMEOUT","stats","framesProcessed","bytesTransferred","lastFrameTime","snapshotResolvers","cachedSPS","cachedPPS","port","host","maxConnections","debug","logger","wsClient","serialNumber","Logger","name","minLevel","connectionManager","ConnectionManager","h264Parser","H264Parser","setupEventHandlers","setupWebSocketListener","on","async","connectionId","connectionInfo","previousCount","getActiveConnectionCount","info","remoteAddress","remotePort","emit","sendCachedHeaders","Date","now","startActivityMonitoring","ensureLivestreamState","stopActivityMonitoring","sendToClient","activityCheckInterval","setInterval","timeSinceActivity","cleanupStaleConnections","activeClients","Math","round","clearInterval","connectionStats","getConnectionStats","cleanedCount","entries","connectionAge","connectedAt","getTime","eventRemover","addEventListener","DEVICE_EVENTS","LIVESTREAM_VIDEO_DATA","event","buffer","data","metadata","videoCodec","videoWidth","videoHeight","videoFPS","videoBuffer","Buffer","isBuffer","from","streamVideo","source","startStopTimeout","clearTimeout","attempt","actualStreamingStatus","commands","device","isLivestreaming","livestreaming","error","warn","message","startLivestream","setTimeout","stopLivestream","Promise","resolve","start","Error","reject","server","createServer","socket","handleConnection","listen","startTime","stop","close","timestamp","isKeyFrame","validateH264Data","nalUnits","extractNALUnits","nalInfo","map","nal","getNALTypeName","type","join","forEach","snapshotsHandled","resolvers","broadcast","getVideoMetadata","waitForVideoMetadata","timeoutMs","timeout","once","isRunning","getStats","uptime","connections","active","total","keys","streaming","getPort","address","resetStats","captureSnapshot","wasStreamRunning","snapshotBuffer","timeoutHandle","filter","r","push","catch","constants_2","commands_1","api_manager_commands_1","wsUrl","CLIENT_MIN_SCHEMA","CLIENT_PREFERRED_SCHEMA","eventListeners","Map","listenerIdCounter","errorHandlers","pendingCaptcha","pendingMfa","stateManager","client","getState","onStateChange","callback","_enhancedCommands","EnhancedCommandAPI","eventType","eventCallback","listenerId","listener","id","set","setEventListenerCount","size","removed","delete","removeEventListener","removeEventListenersByType","removedCount","removeEventListenersByTypes","eventTypes","eventTypeSet","Set","has","removeEventListenersBySerialNumber","removeAllEventListeners","count","clear","getEventListeners","Array","connect","setError","disconnect","isConnected","isReady","isDriverConnected","driverConnected","getSchemaInfo","schemaInfo","sendCommand","params","SET_API_SCHEMA","fullCommand","messageId","generateMessageId","lastError","sendMessage","delay","pow","jitter","random","connectDriver","CONNECT","setDriverConnected","startListening","START_LISTENING","state","driver","connected","onConnected","onDisconnected","onVersionMessage","handleVersionMessage","handler","handlerError","onEventMessage","handleEventMessage","onError","versionMessage","serverMinSchema","minSchemaVersion","serverMaxSchema","maxSchemaVersion","isCompatible","negotiatedSchema","max","clientMinSchema","clientPreferredSchema","setSchemaInfo","targetSchema","schemaVersion","setSchemaSetupComplete","eventPayload","handleDriverConnectionStateEvents","matchingListeners","console","DRIVER_EVENTS","CONNECTED","DISCONNECTED","CAPTCHA_REQUEST","handleCaptchaRequest","VERIFY_CODE","handleMfaRequest","captchaId","captcha","methods","toString","substr","getPendingCaptcha","clearPendingCaptcha","getPendingMfa","clearPendingMfa","WebSocket","createWebSocketStream","Server","Receiver","Sender","WebSocketServer","connectionCounter","end","bytesWritten","handleDisconnection","setNoDelay","setKeepAlive","removeAllListeners","destroy","write","successCount","totalConnections","Duplex","randomFillSync","PerMessageDeflate","EMPTY_BUFFER","kWebSocket","NOOP","isBlob","isValidStatusCode","mask","applyMask","toBuffer","kByteLength","Symbol","maskBuffer","alloc","RANDOM_POOL_SIZE","randomPool","randomPoolPointer","extensions","generateMask","_extensions","_generateMask","_maskBuffer","_socket","_firstFragment","_compress","_bufferedBytes","_queue","_state","onerror","frame","dataLength","merge","offset","skipMasking","readOnly","payloadLength","target","allocUnsafe","fin","opcode","rsv1","writeUInt16BE","writeUIntBE","code","cb","buf","TypeError","byteLength","RangeError","enqueue","dispatch","sendFrame","ping","getBlobData","pong","send","perMessageDeflate","extensionName","binary","compress","_isServer","_threshold","opts","blob","arrayBuffer","then","destroyed","err","process","nextTick","callCallbacks","dequeue","_","shift","Reflect","apply","slice","list","cork","uncork","sender","prettyLogStyles","reset","bold","dim","italic","underline","overline","inverse","hidden","strikethrough","black","red","green","yellow","blue","magenta","cyan","white","blackBright","redBright","greenBright","yellowBright","blueBright","magentaBright","cyanBright","whiteBright","bgBlack","bgRed","bgGreen","bgYellow","bgBlue","bgMagenta","bgCyan","bgWhite","bgBlackBright","bgRedBright","bgGreenBright","bgYellowBright","bgBlueBright","bgMagentaBright","bgCyanBright","bgWhiteBright","DeviceType","PowerWorkingMode","ChargingStatus","NotificationType","ContinuousRecordingType","LockStatus","MotionDetectionType","SoundDetectionType","VideoQuality","WatermarkMode","PanTiltDirection","GET_PROPERTIES_METADATA","GET_PROPERTIES","SET_PROPERTY","HAS_PROPERTY","GET_COMMANDS","HAS_COMMAND","START_LIVESTREAM","STOP_LIVESTREAM","IS_LIVESTREAMING","START_RTSP_LIVESTREAM","STOP_RTSP_LIVESTREAM","IS_RTSP_LIVESTREAMING","START_DOWNLOAD","CANCEL_DOWNLOAD","IS_DOWNLOADING","TRIGGER_ALARM","RESET_ALARM","PAN_AND_TILT","CALIBRATE","QUICK_RESPONSE","GET_VOICES","START_TALKBACK","STOP_TALKBACK","IS_TALKBACK_ONGOING","TALKBACK_AUDIO_DATA","CALIBRATE_LOCK","UNLOCK","SNOOZE","ADD_USER","DELETE_USER","GET_USERS","UPDATE_USER","UPDATE_USER_PASSCODE","UPDATE_USER_SCHEDULE","VERIFY_PIN","OPEN","SET_STATUS_LED","SET_AUTO_NIGHT_VISION","SET_MOTION_DETECTION","SET_SOUND_DETECTION","SET_PET_DETECTION","SET_RTSP_STREAM","SET_ANTI_THEFT_DETECTION","SET_WATERMARK","ENABLE_DEVICE","LOCK_DEVICE","DEVICE_ADDED","DEVICE_REMOVED","PROPERTY_CHANGED","COMMAND_RESULT","LIVESTREAM_STARTED","LIVESTREAM_STOPPED","LIVESTREAM_AUDIO_DATA","GOT_RTSP_URL","DOWNLOAD_STARTED","DOWNLOAD_FINISHED","DOWNLOAD_VIDEO_DATA","DOWNLOAD_AUDIO_DATA","MOTION_DETECTED","PERSON_DETECTED","STRANGER_PERSON_DETECTED","CRYING_DETECTED","SOUND_DETECTED","PET_DETECTED","VEHICLE_DETECTED","DOG_DETECTED","DOG_LICK_DETECTED","DOG_POOP_DETECTED","RADAR_MOTION_DETECTED","RINGS","SENSOR_OPEN","PACKAGE_DELIVERED","PACKAGE_STRANDED","PACKAGE_TAKEN","SOMEONE_LOITERING","LOCKED","WRONG_TRY_PROTECT_ALARM","LONG_TIME_NOT_CLOSE","LOW_BATTERY","JAMMED","ALARM_911","SHAKE_ALARM","TAMPERING","LOW_TEMPERATURE","HIGH_TEMPERATURE","PIN_INCORRECT","LID_STUCK","BATTERY_FULLY_CHARGED","TALKBACK_STARTED","TALKBACK_STOPPED","USER_ADDED","USER_DELETED","USER_ERROR","USER_USERNAME_UPDATED","USER_SCHEDULE_UPDATED","USER_PASSCODE_UPDATED","PIN_VERIFIED","emitClose","stream","duplexOnEnd","_writableState","finished","duplexOnError","removeListener","listenerCount","ws","terminateOnDestroy","duplex","autoDestroy","objectMode","writableObjectMode","msg","isBinary","_readableState","pause","_destroy","readyState","CLOSED","called","terminate","_final","CONNECTING","endEmitted","_read","isPaused","resume","_write","chunk","encoding","Writable","BINARY_TYPES","kStatusCode","concat","toArrayBuffer","unmask","isValidUTF8","FastBuffer","species","_allowSynchronousEvents","allowSynchronousEvents","_binaryType","binaryType","isServer","_maxPayload","maxPayload","_skipUTF8Validation","skipUTF8Validation","_buffers","_compressed","_payloadLength","_mask","_fragmented","_masked","_fin","_opcode","_totalPayloadLength","_messageLength","_fragments","_errored","_loop","startLoop","consume","n","byteOffset","dst","Uint8Array","getInfo","getPayloadLength16","getPayloadLength64","getMask","getData","createError","compressed","haveLength","readUInt16BE","num","readUInt32BE","controlMessage","decompress","dataMessage","messageLength","fragments","Blob","setImmediate","ErrorCtor","prefix","statusCode","errorCode","captureStackTrace","tokenChars","dest","elem","format","extension","configurations","isArray","parse","header","offers","paramName","mustUnescape","isEscaping","inQuotes","charCodeAt","SyntaxError","replace","token","isBrowserEnvironment","window","document","safeGetCwd","nodeProcess","globalThis","cwd","deno","consoleSupportsCssStyling","navigatorObj","navigator","userAgent","test","windowObj","CSS","supports","AlarmEvent","AlarmMode","GuardMode","STATION_EVENTS","REBOOT","IS_CONNECTED","DISCONNECT","SET_GUARD_MODE","CHIME","DOWNLOAD_IMAGE","DATABASE_QUERY_LATEST_INFO","DATABASE_QUERY_LOCAL","DATABASE_COUNT_BY_DATE","DATABASE_DELETE","STATION_ADDED","STATION_REMOVED","ALARM_EVENT","ALARM_DELAY_EVENT","ALARM_ARMED_EVENT","ALARM_ARM_DELAY_EVENT","GUARD_MODE_CHANGED","CURRENT_MODE_CHANGED","IMAGE_DOWNLOADED","DATABASE_QUERY_LATEST","MessageRateLimiter","maxMessages","windowMs","messageCount","windowStart","canProcess","config","processedMessages","invalidMessages","rateLimitedMessages","maxMessageSize","rateLimiter","maxMessagesPerSecond","rateLimitWindowMs","processMessage","valid","messageStr","parsedMessage","messageType","allowLargeMessage","preview","JSON","substring","EVENT","RESULT","some","e","isEventMessage","isResultMessage","validation","validateMessageStructure","stringify","protocols","protocol","add","webpackEmptyContext","req","isUtf8","hasBlob","_isValidUTF8","len","toStringTag","env","WS_NO_UTF_8_VALIDATE","GUID","kForOnEventAttribute","kListener","ScryptedMimeTypes","ScryptedInterface","MediaPlayerState","SecuritySystemObstruction","SecuritySystemMode","AirQuality","AirPurifierMode","AirPurifierStatus","ChargeState","LockState","PanTiltZoomMovement","ThermostatMode","TemperatureUnit","FanMode","HumidityMode","ScryptedDeviceType","ScryptedInterfaceDescriptors","ScryptedInterfaceMethod","ScryptedInterfaceProperty","DeviceBase","TYPES_VERSION","kCode","kData","kError","kMessage","kReason","kTarget","kType","kWasClean","Event","CloseEvent","reason","wasClean","ErrorEvent","MessageEvent","EventTarget","listeners","wrapper","callListener","_closeFrameReceived","_closeFrameSent","thisArg","handleEvent","startCodeInfo","findStartCode","position","nalStart","nalEnd","nextStartCode","nalData","subarray","nalType","isKeyFrameNAL","startOffset","ServerCommandBuilder","DriverCommandBuilder","StationCommandBuilder","DeviceCommandBuilder","constants_3","constants_4","apiManager","args","station","api","getProperties","getPropertiesMetadata","hasProperty","propertyName","hasCommand","commandName","getCommands","isRtspLivestreaming","startRtspLivestream","stopRtspLivestream","isDownloading","startDownload","cancelDownload","triggerAlarm","seconds","resetAlarm","panAndTilt","calibrate","setProperty","quickResponse","getVoices","startTalkback","stopTalkback","isTalkbackOngoing","calibrateLock","unlock","snooze","addUser","deleteUser","getUsers","updateUser","updateUserPasscode","updateUserSchedule","verifyPin","open","setStatusLed","setAutoNightVision","setMotionDetection","setSoundDetection","setPetDetection","setRtspStream","setAntiTheftDetection","setWatermark","enableDevice","lockDevice","reboot","chime","downloadImage","databaseQueryLatestInfo","databaseQueryLocal","databaseCountByDate","databaseDelete","isPushConnected","IS_PUSH_CONNECTED","isMqttConnected","IS_MQTT_CONNECTED","setVerifyCode","SET_VERIFY_CODE","setCaptcha","SET_CAPTCHA","pollRefresh","POLL_REFRESH","getVideoEvents","GET_VIDEO_EVENTS","getAlarmEvents","GET_ALARM_EVENTS","getHistoryEvents","GET_HISTORY_EVENTS","setLogLevel","SET_LOG_LEVEL","getLogLevel","GET_LOG_LEVEL","startListeningLogs","START_LISTENING_LOGS","stopListeningLogs","STOP_LISTENING_LOGS","isListeningLogs","IS_LISTENING_LOGS","setApiSchema","stream_server_1","kDone","kRun","concurrency","pending","Infinity","jobs","job","device_detection_1","devices","isConnectedFlag","eventListenerCleanup","waitForReady","loadDevices","cleanup","getDevices","startStream","deviceSerial","deviceCommand","stopStream","addDevice","removeDevice","bufferSize","startListeningResult","deviceSerials","deviceProps","properties","props","deviceInfo","deviceName","getDeviceTypeName","deviceType","stationSerial","station_sn","model","deviceModel","hardwareVersion","main_hw_version","softwareVersion","main_sw_version","deviceError","deviceData","splitStackLines","sanitizeStackLines","toStackFrames","findFirstExternalFrameIndex","getFrameAt","getCleanStackLines","buildStackTrace","parseLine","isIgnorableFrame","ignorePatterns","filePathCandidate","filePath","fullPathCandidate","fullFilePath","pattern","clampIndex","pickCallerStackFrame","frames","DEFAULT_IGNORE_PATTERNS","autoIndex","resolvedIndex","stackDepthLevel","getDefaultIgnorePatterns","stack","split","line","trimEnd","lines","index","maxExclusive","SERVER_EVENTS","SHUTDOWN","extendStatics","d","b","setPrototypeOf","__proto__","p","__extends","String","__","__assign","assign","t","s","arguments","__rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__decorate","decorators","key","c","decorate","__param","paramIndex","decorator","__esDecorate","ctor","descriptorIn","contextIn","initializers","extraInitializers","accept","f","kind","descriptor","done","context","access","addInitializer","init","unshift","__runInitializers","useValue","__propKey","x","__setFunctionName","description","__metadata","metadataKey","metadataValue","__awaiter","_arguments","P","generator","fulfilled","step","next","rejected","__generator","body","y","label","sent","trys","ops","g","Iterator","verb","iterator","op","pop","__values","__read","__spread","__spreadArrays","il","a","j","jl","__spreadArray","to","pack","l","__await","__asyncGenerator","asyncIterator","q","AsyncIterator","fulfill","settle","__asyncDelegator","__asyncValues","__makeTemplateObject","cooked","raw","__importDefault","default","__classPrivateFieldGet","receiver","__classPrivateFieldSet","__classPrivateFieldIn","__addDisposableResource","dispose","inner","asyncDispose","_SuppressedError","SuppressedError","suppressed","__disposeResources","fail","hasError","__rewriteRelativeImportExtension","path","preserveJsx","tsx","ext","cm","toLowerCase","StorageType","PUSH_CONNECTED","PUSH_DISCONNECTED","MQTT_CONNECTED","MQTT_DISCONNECTED","LOG_LEVEL_CHANGED","LOGGING","CONNECTION_ERROR","http","createHash","subprotocol","keyRegex","socketOnError","abortHandshake","headers","STATUS_CODES","Connection","h","abortHandshakeOrEmitwsClientError","autoPong","handleProtocols","clientTracking","verifyClient","noServer","backlog","_server","res","writeHead","emitConnection","bind","_removeListeners","addListeners","listening","upgrade","head","handleUpgrade","clients","_shouldEmitClose","shouldHandle","url","version","method","secWebSocketProtocol","secWebSocketExtensions","origin","secure","authorized","encrypted","verified","completeUpgrade","readable","update","digest","_protocol","setSocket","jsonStringifyRecursive","obj","cache","inspect","formatValue","formatWithOptions","inspectOptions","ctx","seen","stylize","stylizeNoColor","_extend","first","str","tempStr","lastPos","nextChar","tempArg","formatPrimitive","compact","colors","depth","jsonStringifyRecursive_js_1","tempNum","showHidden","showProxy","tempInteger","parseInt","tempFloat","prettyLogStyles_js_1","isUndefined","customInspect","stylizeWithColor","arg","styleType","style","styles","isFunction","isString","isNull","hasOwn","prop","isRegExp","re","isObject","objectToString","isError","isDate","formatError","recurseTimes","ret","primitive","visibleKeys","array","hash","val","arrayToHash","RegExp","toISOString","output","base","braces","toUTCString","formatProperty","match","formatArray","reduceToSingleString","simple","isBoolean","typedOrigin","clonedAdd","special","number","boolean","null","string","date","regexp","BaseLogger","loggerEnvironment","createLoggerEnvironment","urlToObj_js_1","metaFormatting_js_1","errorUtils_js_1","formatTemplate_js_1","util_inspect_polyfill_js_1","stackTrace_js_1","environment_js_1","runtimeInfo","globalScope","importScripts","globalAny","Bun","bunVersion","hostname","getEnvironmentHostname","Deno","location","denoHostname","locationHostname","resolveDenoHostname","denoVersion","versions","node","detectRuntimeInfo","meta","runtime","browser","metaStatic","runtimeVersion","createRuntimeMeta","usesBrowserStack","callerIgnorePatterns","cachedCwd","environment","getMeta","logLevelId","logLevelName","hideLogPositionForPerformance","parentNames","getCallerStackFrame","parseStackLine","Number","isFinite","getErrorTrace","objectTag","endsWith","isNativeError","prettyFormatLogObj","maskedArgs","settings","reduce","errors","prettyFormatErrorObj","stackLines","formatStackFrames","causeSections","collectErrorCauses","cause","placeholderValuesError","errorName","errorMessage","formatErrorMessage","errorStack","formatTemplate","prettyErrorTemplate","transportFormatted","logMetaMarkup","logArgs","logErrors","logMeta","prettyLogs","stylePrettyLogs","logErrorsStr","sanitizedMetaMarkup","ANSI_REGEX","metaMarkupForText","shouldUseCss","prettyInspectOptions","formattedArgs","formatWithOptionsSafe","cssMeta","metaValue","text","template","placeholders","buildPrettyMeta","parts","lastIndex","placeholderRegex","exec","rawValue","css","tokensToCss","collectStyleTokens","buildCssMetaOutput","hasCssMeta","log","transportJSON","json","globalProcess","NODE_ENV","getNodeEnv","__resetWorkingDirectoryCacheForTests","href","BROWSER_PATH_REGEX","pathParts","fileLine","fileColumn","fileName","fileNameWithLine","filePathWithLine","parseBrowserStackLine","rawLine","trimmedLine","trim","startsWith","methodMatch","sanitizedLocation","withoutQuery","segments","normalizedPath","getWorkingDirectory","normalizedPathWithoutLine","replaced","hasRootDoubleSlash","hasLeadingSlash","driveMatch","drivePrefix","normalizedSegments","segment","normalized","normalizeFilePath","effectivePath","pathSegments","parseServerStackLine","stackFrame","prettyErrorStackTemplate","flatMap","nextStyle","tokens","cssParts","styleTokenToCss","color","COLOR_TOKENS","background","BACKGROUND_TOKENS","stringifyFallback","bun","processHostname","HOSTNAME","HOST","COMPUTERNAME","bunHostname","denoEnvGet","logObj","NaN","maxErrorCauseDepth","argumentsArrayName","hideLogPositionForProduction","prettyLogTemplate","prettyErrorParentNamesSeparator","prettyErrorLoggerNameDelimiter","prettyLogTimeZone","SILLY","TRACE","DEBUG","INFO","WARN","ERROR","FATAL","dateIsoStr","nameWithDelimiterPrefix","nameWithDelimiterSuffix","metaProperty","maskPlaceholder","maskValuesOfKeys","maskValuesOfKeysCaseInsensitive","maskValuesRegEx","attachedTransports","overwrite","toLogObj","addMeta","addPlaceholders","formatMeta","formatLogObj","captureStackForMeta","_shouldCaptureStack","resolvedArgs","_resolveLogArguments","thisLogObj","_recursiveCloneAndExecuteFunctions","_toLogObj","logObjWithMeta","_addMetaToLogObj","logArgsAndErrorsMarkup","_prettyFormatLogObjMeta","transport","declaredParams","transportLogger","attachTransport","getSubLogger","subLoggerSettings","maskKeys","_getMaskKeys","_recursiveCloneAndMaskValuesOfKeys","signature","maskKeysCache","caseInsensitive","candidate","item","URL","urlToObject","baseObject","_cloneError","getPrototypeOf","lookupKey","modifiedSource","regEx","isObjectOrArray","shallowCopy","clonedLogObj","_toErrorObject","cloned","errorObject","nativeError","causeValue","normalizedCause","toError","logObjMeta","formatNumberAddZeros","digits","addNumber","isNaN","VERSION","hideUnsetPlaceholder","templateString","ansiColorWrap","placeholderValue","styleWrap","prevValue","thisStyle","placeholder","zlib","bufferUtil","Limiter","TRAILER","kPerMessageDeflate","kTotalLength","kCallback","kBuffers","zlibLimiter","deflateOnData","inflateOnData","inflateOnError","_inflate","_options","threshold","_deflate","concurrencyLimit","offer","serverNoContextTakeover","server_no_context_takeover","clientNoContextTakeover","client_no_context_takeover","serverMaxWindowBits","server_max_window_bits","clientMaxWindowBits","client_max_window_bits","normalizeParams","acceptAsServer","acceptAsClient","accepted","find","response","isInteger","_decompress","endpoint","windowBits","Z_DEFAULT_WINDOWBITS","createInflateRaw","zlibInflateOptions","flush","createDeflateRaw","zlibDeflateOptions","Z_SYNC_FLUSH","BaseLogger_js_1","normalizedSettings","silly","trace","fatal","https","tls","randomBytes","Readable","kAborted","protocolVersions","readyStates","subprotocolRegex","_closeCode","_closeMessage","_closeTimer","_errorEmitted","_paused","_readyState","_receiver","_sender","_bufferedAmount","_redirects","initAsClient","_autoPong","bufferedAmount","onclose","onopen","onmessage","_url","receiverOnConclude","receiverOnDrain","receiverOnError","receiverOnMessage","receiverOnPing","receiverOnPong","senderOnError","socketOnClose","socketOnData","socketOnEnd","_req","CLOSING","errorEmitted","setCloseTimer","sendAfterClose","needDrain","websocket","protocolVersion","followRedirects","maxRedirects","socketPath","parsedUrl","isSecure","isIpcUrl","invalidUrlMessage","pathname","emitErrorAndClose","defaultPort","request","protocolSet","createConnection","tlsConnect","netConnect","Upgrade","search","handshakeTimeout","Origin","username","password","auth","_originalIpc","_originalSecure","_originalHostOrSocketPath","isSameHost","authorization","cookie","addr","abort","serverProt","protError","extensionNames","finishRequest","servername","isIP","setHeader","receiverOnFinish","read","property","_unmask","totalLength","ArrayBuffer","isView","WS_NO_BUFFER_UTIL","sdk","MixinDeviceBase","ScryptedDeviceBase","fs_1","index_1","nativeId","storage","_storage","deviceManager","getDeviceStorage","_log","getDeviceLogger","_console","getDeviceConsole","createMediaObject","mimeType","mediaManager","sourceId","getMediaObjectConsole","mediaObject","getMixinConsole","_lazyLoadDeviceState","_deviceState","getDeviceState","onDeviceEvent","eventInterface","eventData","_listeners","mixinDevice","mixinDeviceInterfaces","mixinStorageSuffix","mixinDeviceState","systemManager","getDeviceById","mixinProviderNativeId","__rpcproxy_traps_all_properties","createDeviceState","setState","mixinStorageKey","getMixinStorage","onMixinEvent","manageListener","release","_createGetState","_createSetState","field","loaded","SCRYPTED_SDK_ES_MODULE","SCRYPTED_SDK_MODULE","cjsModule","SCRYPTED_SDK_CJS_MODULE","sdkModule","getScryptedStatic","runtimeAPI","pluginRuntimeAPI","endpointManager","pluginHostAPI","descriptors","customDescriptors","readFileSync","interfaceDescriptors","setScryptedInterfaceDescriptors","maxDepth","DEFAULT_CAUSE_DEPTH","causes","visited","current","toErrorObject","connection","wsConnected","schemaSetupComplete","reconnectAttempts","eventListenerCount","stateChangeCallbacks","setConnectionState","connectionState","notifyStateChange","setWebSocketConnected","updateConnectionStateFromConditions","complete","setReconnectAttempts","attempts","READY","splice","currentState","placeholderValues","getUTCFullYear","formatNumberAddZeros_js_1","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","getFullYear","getMonth","getDate","getHours","getMinutes","getSeconds","getMilliseconds","dateInSettingsTimeZone","getTimezoneOffset","parentNamesString","combinedName","isValidEventSource","EVENT_SOURCES","ALL_COMMANDS","assertEventSource","SERVER","DRIVER","DEVICE","STATION","constants_5","constants_6","constants_7","constants_8","searchParams","MODEL_NAMES","ERROR_RESILIENT_CAMERA_TYPES","KEYPAD_TYPES","SMART_DROP_TYPES","SMART_TRACK_TYPES","SMART_SAFE_TYPES","GARAGE_CAMERA_TYPES","CAMERA_3_TYPES","CAMERA_2_TYPES","CAMERA_E_TYPES","CAMERA_1_TYPES","LOCK_KEYPAD_TYPES","LOCK_WIFI_TYPES","LOCK_BLE_TYPES","DUAL_DOORBELL_TYPES","BATTERY_DOORBELL_TYPES","WIRED_DOORBELL_TYPES","INDOOR_CAMERA_TYPES","SOLO_CAMERA_TYPES","SUPPORTED_DEVICE_TYPES","PAN_TILT_DEVICE_TYPES","BATTERY_DEVICE_TYPES","BASE_STATION_DEVICE_TYPES","LOCK_DEVICE_TYPES","SENSOR_DEVICE_TYPES","FLOODLIGHT_DEVICE_TYPES","DOORBELL_DEVICE_TYPES","CAMERA_DEVICE_TYPES","isCamera","isDoorbell","isWiredDoorbell","isBatteryDoorbell","isDoorbellDual","isFloodlight","isSensor","isEntrySensor","SENSOR","isMotionSensor","MOTION_SENSOR","isLock","isLockBle","isLockWifi","isLockKeypad","isBaseStation","isIndoorCamera","isSoloCameras","isPanAndTiltCamera","isGarageCamera","isSmartSafe","isSmartTrack","isSmartDrop","isKeyPad","isCamera1Product","isCamera2Product","isCamera3Product","hasBattery","canPanTilt","isDeviceSupported","requiresErrorResilience","getDeviceCapabilities","camera","doorbell","floodlight","sensor","lock","battery","panTilt","supported","getProductName","CAMERA","CAMERA2","CAMERA_E","CAMERA2C","CAMERA2C_PRO","CAMERA2_PRO","CAMERA3","CAMERA3C","CAMERA3_PRO","PROFESSIONAL_247","SOLO_CAMERA","SOLO_CAMERA_PRO","SOLO_CAMERA_SPOTLIGHT_1080","SOLO_CAMERA_SPOTLIGHT_2K","SOLO_CAMERA_SPOTLIGHT_SOLAR","SOLO_CAMERA_SOLAR","SOLO_CAMERA_C210","SOLO_CAMERA_E30","INDOOR_CAMERA","INDOOR_PT_CAMERA","INDOOR_PT_CAMERA_S350","INDOOR_PT_CAMERA_C220","INDOOR_PT_CAMERA_C210","INDOOR_PT_CAMERA_E30","INDOOR_CAMERA_1080","INDOOR_PT_CAMERA_1080","INDOOR_OUTDOOR_CAMERA_1080P","INDOOR_OUTDOOR_CAMERA_1080P_NO_LIGHT","INDOOR_OUTDOOR_CAMERA_2K","INDOOR_COST_DOWN_CAMERA","OUTDOOR_PT_CAMERA","CAMERA_FG","CAMERA_GARAGE_T8453_COMMON","CAMERA_GARAGE_T8452","CAMERA_GARAGE_T8453","CAMERA_GUN","CAMERA_SNAIL","FLOODLIGHT_CAMERA_8426","DOORBELL","BATTERY_DOORBELL","BATTERY_DOORBELL_2","BATTERY_DOORBELL_PLUS","DOORBELL_SOLO","BATTERY_DOORBELL_PLUS_E340","BATTERY_DOORBELL_C30","BATTERY_DOORBELL_C31","FLOODLIGHT","FLOODLIGHT_CAMERA_8422","FLOODLIGHT_CAMERA_8423","FLOODLIGHT_CAMERA_8424","FLOODLIGHT_CAMERA_8425","WALL_LIGHT_CAM","WALL_LIGHT_CAM_81A0","LOCK_BLE","LOCK_BLE_NO_FINGER","LOCK_WIFI","LOCK_WIFI_NO_FINGER","LOCK_8503","LOCK_8504","LOCK_8530","LOCK_8592","LOCK_85A3","LOCK_8506","LOCK_8502","MINIBASE_CHIME","SMART_DROP","SMART_SAFE_7400","SMART_SAFE_7401","SMART_SAFE_7402","SMART_SAFE_7403","KEYPAD","T8001","T8002","T8010","T8030","T8021","T8023","T8111","T8112","T8114","T8113","T8140","T8141","T8160","T8161","T8162","T8600","T8130","T8131","T8122","T8123","T8B0","T8124","T8134","T8170","T8171","T8420","T8420X","T8422","T8423","T8424","T8425","T84A1","T84A0","T8200","T8200X","T8201","T8203","T8210","T8213","T8214","T8222","T8224","T8223","T8410","T8900","T8910","NONE","CAPTCHA_REQUIRED","MFA_REQUIRED","onDeviceRegistration","authState","captchaData","mfaData","currentCaptchaCode","currentVerifyCode","setupEventListeners","getAuthState","getCaptchaData","getMfaData","getCurrentCaptchaCode","getCurrentVerifyCode","updateCaptchaCode","updateVerifyCode","getAuthStatusMessage","checkPendingAuth","submitCaptcha","captchaCode","checkPostCaptchaState","submitVerifyCode","verifyCode","checkPostVerificationState","requestNewCode","resetAuthState","listeningResult","ws_1","pendingMessages","reconnectTimeout","maxReconnectAttempts","messageTimeout","lastMessageTime","messageProcessor","getStateManager","onConnectedHandler","onDisconnectedHandler","onVersionHandler","onEventHandler","onErrorHandler","handleMessage","_reason","clearPendingMessages","scheduleReconnect","SCHEMA_NEGOTIATING","success","baseDelay","min","getPerformanceMetrics","pendingMessageCount","resetPerformanceMetrics","getMessageProcessingStats","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","getter","mode","ns","def","definition","AWAY","AwayArmed","HOME","HomeArmed","DISARMED","Disarmed","CUSTOM1","NightArmed","CUSTOM2","CUSTOM3","PropertyMapper","toSetting","group","setting","title","readonly","writeable","states","choices","sort","aNum","bNum","localeCompare","range","unit","adjustValueForAPI","getPropertyGroup","getWritableSettings","getDeviceInfoSettings","firmware","shouldHideProperty","DeviceSettingsService","deviceApi","customSettings","settingsChangeCallbacks","getSettings","getGenericDeviceInfo","getWritableProperties","putSetting","onSuccess","updateDeviceProperty","notifySettingsChanged","isCustomSetting","getCustomSetting","onSettingsChange","adjustedValue","_metadata","DeviceStateService","updateFromProperties","changes","motionDetected","newValue","interface","MotionSensor","lightSettingsBrightnessManual","brightness","Brightness","light","OnOff","batteryLevel","Battery","chargingStatus","convertChargingStatus","chargeState","Charger","wifiRssi","newSensors","sensors","Sensors","change","updateProperty","updateState","stateKey","binaryState","BinarySensor","status","NOT_CHARGING","NotCharging","CHARGING","Charging","RefreshService","DEFAULT_REFRESH_FREQUENCY","refreshCompleteCallbacks","refreshErrorCallbacks","getRefreshFrequency","refresh","refreshInterface","userInitiated","logPrefix","notifyRefreshComplete","errorObj","notifyRefreshError","onRefreshComplete","onRefreshError","FFmpegUtils","static","convertH264ToJPEG","h264Data","quality","child_process","ffmpeg","spawn","chunks","errorChunks","stdout","stderr","jpegBuffer","errorOutput","parseFFmpegError","stdin","isFFmpegAvailable","getFFmpegVersion","firstLine","SnapshotService","streamServer","getPictureOptions","takePicture","h264Keyframe","StreamService","streamServerStarted","setDeviceType","getVideoDimensions","LOW","width","height","MEDIUM","HIGH","ULTRA","getVideoStreamOptions","container","video","codec","getVideoStream","createOptimizedMediaObject","isStreaming","ffmpegInput","inputArguments","mediaStreamOptions","createFFmpegMediaObject","VideoClipsService","clipMetadataCache","getClips","query","stationSerialNumber","clips","getClipsFromStationDatabase","getClipsFromCloudAPI","fallbackError","downloadClip","videoId","storage_path","cipher_id","downloadClipViaP2P","cloud_path","downloadThumbnail","thumbnailId","cached_thumbnail","thumb_path","downloadThumbnailViaP2P","cloud_thumbnail","thumbnailBuffer","downloadFromUrl","clearCache","queryParams","serialNumbers","startDate","formatDate","endDate","endTime","detectionType","storageType","databaseRecords","waitForDatabaseQueryResponse","mapDatabaseRecordsToClips","events","startTimestampMs","endTimestampMs","stationSN","LOCAL_AND_CLOUD","deviceEvents","preDownloadThumbnails","mapCloudEventsToClips","cipherId","collectDownloadData","downloadComplete","timer","removeListeners","removeVideoDataListener","sum","removeFinishedListener","thumbnailPromises","thumbnailUrl","clipId","results","all","fetch","ok","statusText","records","record","startTimeMs","start_time","endTimeMs","end_time","record_id","video_type","storage_type","duration","mapEventType","getEventDescription","videoUrl","padStart","PtzControlService","getDeviceType","updateCapabilities","capabilities","pan","tilt","zoom","executeCommand","executePan","executeTilt","tiltValue","direction","UP","DOWN","panValue","RIGHT","LEFT","LightControlService","turnOn","turnOff","setBrightness","EufyDevice","latestProperties","propertiesLoaded","settingsService","stateService","refreshService","videoClipsService","snapshotService","streamService","ptzControlService","lightControlService","parentLogger","loggerName","charAt","toUpperCase","_meta","level","createConsoleTransport","createStreamServer","initializeServices","handlePropertyChangedEvent","handleMotionDetectedEvent","handleDoorbellRingsEvent","loadInitialProperties","syncStateToProperties","updatePtzCapabilities","Settings","updateStateFromProperties","settingKey","settingValue","ptzCapabilities","ptzCommand","videoStreamingQuality","picture","getVideoClips","getVideoClip","getVideoClipThumbnail","removeVideoClips","videoClipIds","alarmModeMap","securitySystemMap","DeviceUtils","genericDeviceInformation","settingFromMetadata","allWriteableDeviceProperties","groupForPropertyName","valueAdjustedWithMetadata","createStationManifest","humanModel","DeviceProvider","interfaces","manufacturer","mac","macAddress","createDeviceManifest","Doorbell","Camera","Sensor","Lock","Unknown","getScryptedDeviceType","VideoCamera","Refresh","PanTiltZoom","providerNativeId","EufyStation","childDevices","_event","SecuritySystem","securitySystemState","getDevice","releaseDevice","deviceId","securitySystemGroup","currentMode","guardMode","triggered","alarm","supportedModes","armSecuritySystem","disarmSecuritySystem","CleanupLevel","MemoryManager","cleanupCallbacks","monitorInterval","isMonitoring","lastCleanupTime","lastCleanupLevel","baseThresholdMB","monitorIntervalMs","enableDetailedLogging","cleanupCooldownMs","getInstance","instance","getMemoryThreshold","setMemoryThreshold","thresholdMB","updateThreshold","registerCleanupCallback","startMonitoring","unregisterCleanupCallback","stopMonitoring","checkMemoryPressure","usage","memoryUsage","rssMB","rss","heapMB","heapUsed","gentleThreshold","aggressiveThreshold","emergencyThreshold","cleanupLevel","EMERGENCY","AGGRESSIVE","GENTLE","timeSinceLastCleanup","triggerCleanup","getCurrentMemoryUsage","thresholds","gentle","aggressive","emergency","performMemoryCheck","memoryInfo","levelIcon","callbacksExecuted","registration","global","gc","EufySecurityProvider","wsLogger","stations","debugLogging","pushConnected","mqttConnected","isConnecting","hasLoggedReady","isWaitingForReady","authManager","getItem","memoryThreshold","memoryLogger","authLogger","displayConnectResult","registerStationsFromServerState","registerDevicesFromServerState","startConnection","clientState","currentMemory","captchaStatus","immediate","getConnectionStateIcon","setItem","newDebugValue","memMB","removeItem","updatedResult","waitForClientReady","serverState","stationSerials","manifests","onDevicesChanged","manifest","waitTime","checkReady","withTimeout","promise","timeoutMessage","timeoutId","isWebSocketConnected","getReadmeMarkdown","getConnectionStateDescription","getAuthStatusDescription"],"sourceRoot":""}